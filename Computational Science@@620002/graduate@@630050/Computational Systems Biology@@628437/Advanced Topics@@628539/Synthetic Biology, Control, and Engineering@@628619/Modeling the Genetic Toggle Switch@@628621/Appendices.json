{"hands_on_practices": [{"introduction": "Understanding a system like the genetic toggle switch means mapping its behavior as conditions change. This first practice is a foundational numerical exercise where you will construct a bifurcation diagram, revealing how cooperativity gives rise to the switch's hallmark bistability and memory (hysteresis). This hands-on analysis connects the abstract mathematics of stability theory to the concrete function of a core synthetic circuit. [@problem_id:3328029]", "problem": "Consider a deterministic model for a two-gene toggle switch with mutual repression, in which each gene product represses the transcription of the other via a cooperative binding mechanism. Begin from a minimal gene regulation framework grounded in the Central Dogma of Molecular Biology (DNA to RNA to Protein) and standard chemical kinetics for synthesis and degradation: the time-evolution of the concentration of a gene product is given by synthesis minus degradation, and transcriptional repression is represented by a decreasing Hill function that arises from equilibrium occupancy of a promoter with $n$-cooperative repressor binding sites. Specifically, derive a coupled ordinary differential equation system for the concentrations $x$ and $y$ of the two gene products, justify the choice of a Hill repression function on scientific grounds, and define a control parameter $u$ that biases the two synthesis rates in opposite directions while keeping all rates nonnegative. Use these equations to compute steady states, assess their linear stability via the Jacobian, and construct a bifurcation diagram by scanning the control parameter $u$. Quantify hysteresis width as the difference between the high and low control parameter values delimiting the region of bistability (two distinct linearly stable steady states separated by an unstable one).\n\nLet $x$ and $y$ denote concentrations, with synthesis rates modulated by a control parameter $u$ that tilts the system: let $\\alpha_{1}(u) = \\alpha\\,(1+u)$ and $\\alpha_{2}(u) = \\alpha\\,(1-u)$, with $u \\in [-u_{\\max}, u_{\\max}]$ and $0 \\le \\alpha_{i}(u)$ for all admissible $u$. Let degradation be linear with a rate constant $\\gamma > 0$. Let repression have a Hill-form dependence with half-saturation $K > 0$ and Hill coefficient $n \\ge 1$. The task is to implement the system\n$$\n\\frac{dx}{dt} = \\frac{\\alpha_{1}(u)}{1 + \\left(\\frac{y}{K}\\right)^{n}} - \\gamma\\,x,\\qquad\n\\frac{dy}{dt} = \\frac{\\alpha_{2}(u)}{1 + \\left(\\frac{x}{K}\\right)^{n}} - \\gamma\\,y,\n$$\nand rigorously analyze it. For each fixed $u$, compute all nonnegative steady states $(x^{\\ast}, y^{\\ast})$ that solve\n$$\n0 = \\frac{\\alpha_{1}(u)}{1 + \\left(\\frac{y}{K}\\right)^{n}} - \\gamma\\,x,\\qquad\n0 = \\frac{\\alpha_{2}(u)}{1 + \\left(\\frac{x}{K}\\right)^{n}} - \\gamma\\,y.\n$$\nEstablish linear stability by evaluating the Jacobian matrix\n$$\nJ(x,y;u) =\n\\begin{pmatrix}\n-\\gamma & \\frac{\\partial}{\\partial y}\\left[\\frac{\\alpha_{1}(u)}{1 + \\left(\\frac{y}{K}\\right)^{n}}\\right] \\\\\n\\frac{\\partial}{\\partial x}\\left[\\frac{\\alpha_{2}(u)}{1 + \\left(\\frac{x}{K}\\right)^{n}}\\right] & -\\gamma\n\\end{pmatrix},\n$$\nand determining the eigenvalues of $J$ at the steady state; a steady state is linearly stable if and only if all eigenvalues of $J$ have strictly negative real parts. Construct the bifurcation diagram by scanning $u \\in [-u_{\\max}, u_{\\max}]$ over a uniform grid, and for each $u$ computing the number of distinct linearly stable steady states. Define the hysteresis width $W$ as $W = u_{\\text{high}} - u_{\\text{low}}$, where $u_{\\text{low}}$ is the smallest value of $u$ for which the system exhibits two linearly stable steady states, and $u_{\\text{high}}$ is the largest value of $u$ for which the system exhibits two linearly stable steady states. If no bistability is present for any $u$ in the scan, report $W = 0$ and set $u_{\\text{low}} = 0$ and $u_{\\text{high}} = 0$.\n\nUse the following test suite of parameter values to ensure coverage of different regimes:\n- Case $1$ (strong cooperativity, expected bistability): $\\alpha = 12$, $\\gamma = 1$, $K = 1$, $n = 3$, $u_{\\max} = 0.9$.\n- Case $2$ (no cooperativity, expected monostability): $\\alpha = 4$, $\\gamma = 1$, $K = 1$, $n = 1$, $u_{\\max} = 0.9$.\n- Case $3$ (moderate cooperativity, near boundary): $\\alpha = 8$, $\\gamma = 1$, $K = 1$, $n = 2$, $u_{\\max} = 0.9$.\n\nFor each case, scan $u$ uniformly over the interval $[-u_{\\max}, u_{\\max}]$ using a grid of at least $M = 161$ points. For each $u$, compute all distinct nonnegative steady states and classify them by linear stability. Then, compute and return a list of four values per case: $[W, u_{\\text{low}}, u_{\\text{high}}, B]$, where $W$ is the hysteresis width as a real number, $u_{\\text{low}}$ and $u_{\\text{high}}$ are the lowest and highest $u$ values (real numbers) at which two linearly stable steady states are found, and $B$ is a boolean indicating whether bistability was found anywhere in the scan. If no bistability occurs, return $[0.0, 0.0, 0.0, \\text{False}]$.\n\nYour program should produce a single line of output containing the results for the three test cases as a comma-separated list enclosed in square brackets and arranged in order Case $1$, Case $2$, Case $3$. For example, the output should look like $[[W_{1},u_{\\text{low},1},u_{\\text{high},1},B_{1}],[W_{2},u_{\\text{low},2},u_{\\text{high},2},B_{2}],[W_{3},u_{\\text{low},3},u_{\\text{high},3},B_{3}]]$. No physical units are involved; all quantities are dimensionless real numbers.", "solution": "The problem presents a deterministic model of a genetic toggle switch, a foundational synthetic biology circuit. The task is to analyze its dynamics, specifically its steady states and their stability, as a function of a control parameter $u$. The analysis begins with a justification of the model's form, followed by a computational procedure to determine the region of bistability and the associated hysteresis width.\n\n**1. Scientific Justification of the Hill Repression Function**\n\nThe model employs a Hill function to describe transcriptional repression. This functional form is not arbitrary but arises from the physical chemistry of transcription factor binding to DNA. Consider one of the genes in the switch, say the gene producing protein $X$, which is repressed by protein $Y$. The rate of synthesis of $X$ is proportional to the fraction of its promoters that are not bound by the repressor $Y$.\n\nLet $P$ be the promoter region of the gene for $X$, and let $R$ be the repressor protein $Y$. The binding of $n$ molecules of the repressor to the promoter occurs via a cooperative reaction:\n$$\nP + nR \\rightleftharpoons PR_n\n$$\nwhere $PR_n$ is the inactive promoter-repressor complex. At chemical equilibrium, the law of mass action gives the dissociation constant $K_d$ as:\n$$\nK_d = \\frac{[P][R]^n}{[PR_n]}\n$$\nHere, $[P]$ is the concentration of free promoters, $[R]$ is the concentration of the repressor (denoted by $y$ in the problem), and $[PR_n]$ is the concentration of the bound complex. The total concentration of promoters, $[P]_{\\text{total}}$, is the sum of free and bound promoters: $[P]_{\\text{total}} = [P] + [PR_n]$.\n\nThe rate of transcription is assumed to be proportional to the fraction of promoters that are free (active), which we denote by $\\theta_{\\text{active}}$:\n$$\n\\theta_{\\text{active}} = \\frac{[P]}{[P]_{\\text{total}}} = \\frac{[P]}{[P] + [PR_n]}\n$$\nBy rearranging the equilibrium equation, we have $[PR_n] = \\frac{[P][R]^n}{K_d}$. Substituting this into the expression for $\\theta_{\\text{active}}$ yields:\n$$\n\\theta_{\\text{active}} = \\frac{[P]}{[P] + \\frac{[P][R]^n}{K_d}} = \\frac{1}{1 + \\frac{[R]^n}{K_d}}\n$$\nBy defining a constant $K = K_d^{1/n}$, known as the half-saturation constant or Hill constant, this expression takes the canonical Hill form:\n$$\n\\theta_{\\text{active}} = \\frac{1}{1 + \\left(\\frac{[R]}{K}\\right)^n}\n$$\nThe synthesis rate of protein $X$ is the maximal synthesis rate, $\\alpha_1(u)$, multiplied by this fraction of active promoters. This justifies the synthesis term in the first differential equation. An analogous argument applies to the repression of gene $Y$ by protein $X$. The integer $n$ is the Hill coefficient, representing the degree of cooperativity in repressor binding. A value of $n>1$ signifies cooperative binding, leading to a steeper, switch-like response.\n\n**2. Steady-State Analysis**\n\nThe steady states $(x^{\\ast}, y^{\\ast})$ of the system are the non-negative solutions to the coupled algebraic equations where the time derivatives are zero:\n$$\n\\frac{dx}{dt} = 0 \\implies \\gamma x^{\\ast} = \\frac{\\alpha_1(u)}{1 + (y^{\\ast}/K)^n}\n$$\n$$\n\\frac{dy}{dt} = 0 \\implies \\gamma y^{\\ast} = \\frac{\\alpha_2(u)}{1 + (x^{\\ast}/K)^n}\n$$\nThese equations define the nullclines of the system. The steady states are the intersection points of these two nullclines in the $x,y$-plane. To find these points, we can express one variable in terms of the other from one equation and substitute it into the second. From the second equation, we solve for $y^{\\ast}$:\n$$\ny^{\\ast} = \\frac{\\alpha_2(u)/\\gamma}{1 + (x^{\\ast}/K)^n}\n$$\nSubstituting this into the first equation gives a single equation for $x^{\\ast}$:\n$$\nx^{\\ast} = \\frac{\\alpha_1(u)/\\gamma}{1 + \\left( \\frac{1}{K} \\left( \\frac{\\alpha_2(u)/\\gamma}{1 + (x^{\\ast}/K)^n} \\right) \\right)^n}\n$$\nThis is a highly nonlinear equation in $x^{\\ast}$. For a given set of parameters $(u, \\alpha, \\gamma, K, n)$, the roots of this equation correspond to the $x$-coordinates of the steady states. Due to the sigmoidal nature of the right-hand side as a function of $x^{\\ast}$, there can be one or three positive solutions, corresponding to monostability or bistability, respectively. These roots are found numerically.\n\n**3. Linear Stability Analysis**\n\nTo determine the stability of each steady state $(x^{\\ast}, y^{\\ast})$, we linearize the system by evaluating the Jacobian matrix $J$ at that state:\n$$\nJ(x^{\\ast}, y^{\\ast}) =\n\\begin{pmatrix}\n\\frac{\\partial}{\\partial x}(\\dot{x}) & \\frac{\\partial}{\\partial y}(\\dot{x}) \\\\\n\\frac{\\partial}{\\partial x}(\\dot{y}) & \\frac{\\partial}{\\partial y}(\\dot{y})\n\\end{pmatrix}_{(x^{\\ast}, y^{\\ast})}\n=\n\\begin{pmatrix}\n-\\gamma & J_{12} \\\\\nJ_{21} & -\\gamma\n\\end{pmatrix}\n$$\nThe off-diagonal elements are:\n$$\nJ_{12} = \\frac{\\partial}{\\partial y}\\left[\\frac{\\alpha_{1}(u)}{1 + (y/K)^n}\\right]\\bigg|_{y=y^{\\ast}} = -\\frac{n \\alpha_{1}(u) (y^{\\ast})^{n-1}}{K^n (1 + (y^{\\ast}/K)^n)^2}\n$$\n$$\nJ_{21} = \\frac{\\partial}{\\partial x}\\left[\\frac{\\alpha_{2}(u)}{1 + (x/K)^n}\\right]\\bigg|_{x=x^{\\ast}} = -\\frac{n \\alpha_{2}(u) (x^{\\ast})^{n-1}}{K^n (1 + (x^{\\ast}/K)^n)^2}\n$$\nThe eigenvalues $\\lambda$ of the Jacobian are given by the characteristic equation $\\det(J - \\lambda I) = 0$, which simplifies to $(-\\gamma - \\lambda)^2 - J_{12}J_{21} = 0$. The solutions are $\\lambda = -\\gamma \\pm \\sqrt{J_{12}J_{21}}$. Since $\\alpha_i(u) \\ge 0$, $n \\ge 1$, and $K > 0$, both $J_{12}$ and $J_{21}$ are non-positive, making their product $J_{12}J_{21}$ non-negative. Thus, the eigenvalues are always real. A steady state is linearly stable if and only if all eigenvalues have strictly negative real parts. The eigenvalue $\\lambda_2 = -\\gamma - \\sqrt{J_{12}J_{21}}$ is always negative because $\\gamma > 0$. Stability is therefore determined by the sign of $\\lambda_1 = -\\gamma + \\sqrt{J_{12}J_{21}}$. For stability, we require $\\lambda_1 < 0$, which implies $\\sqrt{J_{12}J_{21}} < \\gamma$, or $J_{12}J_{21} < \\gamma^2$.\n\nThis condition can be simplified. Using the steady-state equations, the Jacobian elements can be rewritten as:\n$$\nJ_{12} = -n \\frac{\\gamma x^{\\ast}}{y^{\\ast}} \\frac{(y^{\\ast}/K)^n}{1+(y^{\\ast}/K)^n} \\quad \\text{and} \\quad J_{21} = -n \\frac{\\gamma y^{\\ast}}{x^{\\ast}} \\frac{(x^{\\ast}/K)^n}{1+(x^{\\ast}/K)^n}\n$$\nTheir product is $J_{12}J_{21} = n^2 \\gamma^2 A_x A_y$, where $A_x = \\frac{(x^{\\ast}/K)^n}{1+(x^{\\ast}/K)^n}$ and $A_y = \\frac{(y^{\\ast}/K)^n}{1+(y^{\\ast}/K)^n}$. The stability criterion becomes $n^2 \\gamma^2 A_x A_y < \\gamma^2$, which simplifies to:\n$$\nn^2 A_x A_y < 1\n$$\nThis elegant condition, relating the Hill coefficient and the saturation levels of the repressors, is used to classify each steady state.\n\n**4. Numerical Algorithm for Hysteresis Analysis**\n\nThe final task is to compute the hysteresis width $W$ for the given parameter sets. This is achieved through the following numerical procedure:\n1.  Discretize the control parameter range $[-u_{\\max}, u_{\\max}]$ into a uniform grid of $M \\ge 161$ points, denoted $\\{u_i\\}$.\n2.  For each value $u_i$ in the grid:\n    a.  Numerically find all non-negative roots $x^{\\ast}$ of the steady-state equation $x - F(x; u_i) = 0$, where $F(x; u_i) = \\frac{\\alpha_1(u_i)/\\gamma}{1 + \\left( \\frac{\\alpha_2(u_i)/(\\gamma K)}{1 + (x/K)^n} \\right)^n}$. This is accomplished by scanning a fine grid of $x$ values for sign changes in $x - F(x; u_i)$ to bracket the roots, followed by a precise root-finding algorithm like the Brent-Dekker method for each bracketed interval.\n    b.  For each root $x^{\\ast}$, calculate the corresponding $y^{\\ast} = \\frac{\\alpha_2(u_i)/\\gamma}{1+(x^{\\ast}/K)^n}$.\n    c.  Evaluate the stability of each steady state $(x^{\\ast}, y^{\\ast})$ using the condition $n^2 A_x A_y < 1$.\n    d.  Count the number of distinct, linearly stable steady states.\n3.  Identify the set of all $u_i$ values for which exactly two stable steady states were found.\n4.  If this set is empty, no bistability exists in the scanned range. Report $W=0.0$, $u_{\\text{low}}=0.0$, $u_{\\text{high}}=0.0$, and a boolean flag for bistability as False.\n5.  If the set is non-empty, determine $u_{\\text{low}}$ as the minimum value and $u_{\\text{high}}$ as the maximum value in the set. The hysteresis width is then $W = u_{\\text{high}} - u_{\\text{low}}$. Report $[W, u_{\\text{low}}, u_{\\text{high}}, \\text{True}]$.\nThis algorithm robustly determines the bistable region and quantifies the hysteresis width as required.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef compute_hysteresis(alpha, gamma, K, n, u_max):\n    \"\"\"\n    Computes the hysteresis width for the genetic toggle switch model.\n\n    Args:\n        alpha (float): Basal synthesis rate parameter.\n        gamma (float): Degradation rate constant.\n        K (float): Half-saturation constant (Hill constant).\n        n (float): Hill coefficient.\n        u_max (float): Maximum value of the control parameter u.\n\n    Returns:\n        list: A list containing [W, u_low, u_high, B], where W is the\n              hysteresis width, u_low and u_high are the boundaries of the\n              bistable region, and B is a boolean indicating if bistability\n              was found.\n    \"\"\"\n    \n    # Define the steady state function whose roots we need to find.\n    # We solve x - F(x) = 0.\n    def F(x, u, alpha, gamma, K, n):\n        alpha1_u = alpha * (1 + u)\n        alpha2_u = alpha * (1 - u)\n        \n        # Avoid division by zero or invalid operations if x is negative, though we only search x >= 0.\n        if isinstance(x, np.ndarray):\n            x[x0] = 0\n        elif x  0:\n            x = 0\n\n        y_val_term = (alpha2_u / gamma) / (1 + (x / K)**n)\n        return (alpha1_u / gamma) / (1 + (y_val_term / K)**n)\n\n    M = 161\n    u_grid = np.linspace(-u_max, u_max, M)\n    bistable_u_points = []\n\n    # Define a safe upper bound for the root search range of x.\n    # The max possible value of x is alpha * (1 + u_max) / gamma. Add a margin.\n    x_search_max = alpha * (1 + u_max) / gamma + 5.0\n    x_search_grid_size = 10000\n    x_grid = np.linspace(0, x_search_max, x_search_grid_size)\n\n    for u in u_grid:\n        \n        # Function for root finding: g(x) = x - F(x) = 0\n        g = lambda x: x - F(x, u, alpha, gamma, K, n)\n        \n        roots = set()\n        \n        # Scan for sign changes to bracket roots\n        g_vals = g(x_grid)\n        for i in range(len(x_grid) - 1):\n            if np.sign(g_vals[i]) != np.sign(g_vals[i+1]):\n                try:\n                    root = brentq(g, x_grid[i], x_grid[i+1])\n                    # Add root rounded to a certain precision to avoid duplicates\n                    roots.add(round(root, 8)) \n                except (RuntimeError, ValueError):\n                    # brentq can fail if the signs are not different at endpoints,\n                    # which can happen with floating point inaccuracies.\n                    pass\n        \n        n_stable_states = 0\n        for x_star in roots:\n            if x_star  0: continue\n            \n            alpha2_u = alpha * (1 - u)\n            y_star = (alpha2_u / gamma) / (1 + (x_star / K)**n)\n            \n            if y_star  0: continue\n\n            # Stability condition: n^2 * Ax * Ay  1\n            # Handle potential division by zero if K=0 (not in test cases) or x_star/y_star= -1 (not possible)\n            Ax_num = (x_star / K)**n\n            Ax = Ax_num / (1 + Ax_num)\n\n            Ay_num = (y_star / K)**n\n            Ay = Ay_num / (1 + Ay_num)\n            \n            if (n**2) * Ax * Ay  1:\n                n_stable_states += 1\n        \n        if n_stable_states == 2:\n            bistable_u_points.append(u)\n\n    if not bistable_u_points:\n        return [0.0, 0.0, 0.0, False]\n    else:\n        u_low = min(bistable_u_points)\n        u_high = max(bistable_u_points)\n        W = u_high - u_low\n        return [W, u_low, u_high, True]\n\n\ndef solve():\n    \"\"\"\n    Main function to run the analysis for all test cases and print results.\n    \"\"\"\n    test_cases = [\n        # Case 1 (strong cooperativity, expected bistability)\n        (12.0, 1.0, 1.0, 3.0, 0.9),\n        # Case 2 (no cooperativity, expected monostability)\n        (4.0, 1.0, 1.0, 1.0, 0.9),\n        # Case 3 (moderate cooperativity, near boundary)\n        (8.0, 1.0, 1.0, 2.0, 0.9)\n    ]\n\n    results = []\n    for case_params in test_cases:\n        result = compute_hysteresis(*case_params)\n        results.append(result)\n\n    # Format output to be a single-line list of lists with no spaces\n    # e.g., [[W1,ulow1,uhigh1,B1],[W2,ulow2,uhigh2,B2],...]\n    result_strings = []\n    for res in results:\n        # Format boolean as required (True/False)\n        bool_str = str(res[3])\n        # Manually construct string for each inner list to control spacing\n        res_str = f\"[{res[0]},{res[1]},{res[2]},{bool_str}]\"\n        result_strings.append(res_str)\n        \n    final_output = f\"[{','.join(result_strings)}]\"\n    print(final_output)\n\nsolve()\n```", "id": "3328029"}, {"introduction": "Now that we have established the existence of two distinct stable states, a natural question arises: from which initial protein concentrations does the system evolve to each state? This practice moves beyond local stability analysis to the global landscape of the system's dynamics. You will numerically compute the basins of attraction, visualizing the \"watersheds\" in the state space that separate the two outcomes and quantifying the global robustness of a target state by measuring its basin size. [@problem_id:3328034]", "problem": "You are to model a symmetric genetic toggle switch in which two repressor proteins mutually inhibit each other’s expression. The dynamical system is represented in nondimensional form by two ordinary differential equations based on the Hill repression form for transcriptional regulation and linear first-order degradation. The model state is the pair of protein concentrations $\\left(x(t), y(t)\\right)$, where $x(t) \\ge 0$ and $y(t) \\ge 0$ for all $t \\ge 0$. The parameter $n$ is the Hill coefficient (cooperativity), $K$ is the repression threshold, and $\\alpha$ is the maximal nondimensional production rate (identical for both genes). The state evolution is given by\n$$\n\\frac{dx}{dt} \\;=\\; \\frac{\\alpha}{1 + \\left(\\frac{y}{K}\\right)^{n}} \\;-\\; x, \n\\qquad\n\\frac{dy}{dt} \\;=\\; \\frac{\\alpha}{1 + \\left(\\frac{x}{K}\\right)^{n}} \\;-\\; y.\n$$\nThe biological justification of the right-hand side uses two well-tested facts: transcriptional repression can be modeled by a Hill function with exponent $n$ and half-effect concentration $K$, and protein degradation/dilution is often well approximated by a first-order linear process after nondimensionalization.\n\nYour task is to compute the basins of attraction for the two asymmetric steady states typically present in a bistable genetic toggle switch (“$x$-high, $y$-low” and “$y$-high, $x$-low”), quantify a global robustness metric for a target state, and study how this metric varies with $(n, K)$. The following principles must be used for design and justification:\n- Start from the above dynamical model and the monotone systems perspective for competitive systems to argue the absence of periodic or chaotic attractors; equivalently, justify that almost all trajectories converge to equilibria by appealing to order-preserving properties and the consequent structure of $\\omega$-limit sets. You may use as a Lyapunov-like surrogate the fact that, for such systems under boundedness and inward-pointing vector fields on a compact positively invariant set, $\\omega$-limit sets consist of equilibria.\n- Use this to justify that the numerical classification of initial conditions by long-time integration is a valid method to approximate basin volumes, since trajectories converge to equilibria and do not exhibit persistent oscillations.\n\nTo define a computable, dimensionless global robustness metric, let the target be the “$x$-high” attractor. For a given parameter pair $(n, K)$, define the robustness $R(n, K)$ as the fraction (area measure on a uniform grid) of initial conditions $(x(0), y(0))$ in a compact domain $\\mathcal{D}$ that converge to the “$x$-high” attractor. Because the system is symmetric and $\\alpha$ is fixed, choose the square domain $\\mathcal{D} = [0,\\alpha] \\times [0,\\alpha]$, which contains all equilibria for the model specified above. Let $\\alpha$ be fixed to $\\alpha = 10$.\n\nNumerically approximate $R(n, K)$ as follows:\n- Use a uniform grid of $M \\times M$ initial conditions over $\\mathcal{D}$ with $M = 25$.\n- For each initial condition, integrate the system from $t = 0$ to $t = T_{\\max}$ with $T_{\\max} = 100$. Use a relative tolerance of $\\mathrm{rtol} = 10^{-8}$ and an absolute tolerance of $\\mathrm{atol} = 10^{-10}$ for numerical integration.\n- Classify a trajectory as converging to the “$x$-high” attractor if its terminal state at $t = T_{\\max}$ satisfies $x(T_{\\max}) - y(T_{\\max}) \\ge \\varepsilon$, and as converging to the “$y$-high” attractor if $y(T_{\\max}) - x(T_{\\max}) \\ge \\varepsilon$, where $\\varepsilon = 10^{-3}$. Trajectories with $|x(T_{\\max}) - y(T_{\\max})|  \\varepsilon$ are considered convergent to a symmetric equilibrium and do not contribute to $R(n, K)$.\n- The approximation of $R(n, K)$ is then the count of initial conditions classified as “$x$-high” divided by $M^2$.\n\nTest suite and required output:\n- Fix $\\alpha = 10$ and $M = 25$, $T_{\\max} = 100$, $\\varepsilon = 10^{-3}$, $\\mathrm{rtol} = 10^{-8}$, $\\mathrm{atol} = 10^{-10}$.\n- Compute $R(n, K)$ for the following $(n, K)$ test cases:\n  1. $(n, K) = (1.0, 1.0)$, a low-cooperativity case expected to be monostable.\n  2. $(n, K) = (2.0, 10.0)$, weak repression (large $K$) expected to be monostable.\n  3. $(n, K) = (3.5, 1.0)$, moderate cooperativity with moderate threshold, typically bistable.\n  4. $(n, K) = (4.0, 0.2)$, strong cooperativity and low threshold, typically bistable.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the same order as above, with each entry being the decimal fraction $R(n, K)$ rounded to four digits after the decimal point. For example, a syntactically valid output would be of the form $[0.0000,0.0000,0.5000,0.5000]$ (this is just an example, not necessarily the correct values).\n\nAll mathematical symbols and numbers in this problem statement are presented in LaTeX notation. No physical units are involved; all quantities are nondimensional. Angles are not used. Percentages must be given as decimal fractions as specified.", "solution": "This problem requires computing a robustness metric, $R(n, K)$, for a genetic toggle switch model by numerically approximating the area of a basin of attraction. The validity of this numerical approach rests on the theoretical properties of the underlying dynamical system.\n\n**Theoretical Foundation**\n\nThe system is given by the equations:\n$$\n\\frac{dx}{dt} = f_1(x, y) = \\frac{\\alpha}{1 + (y/K)^n} - x\n$$\n$$\n\\frac{dy}{dt} = f_2(x, y) = \\frac{\\alpha}{1 + (x/K)^n} - y\n$$\nThis system is a **competitive dynamical system**. This can be formally established by examining the Jacobian matrix of the vector field, $J(x, y)$:\n$$\nJ(x, y) = \\begin{pmatrix} \\frac{\\partial f_1}{\\partial x}  \\frac{\\partial f_1}{\\partial y} \\\\ \\frac{\\partial f_2}{\\partial x}  \\frac{\\partial f_2}{\\partial y} \\end{pmatrix} = \\begin{pmatrix} -1  -\\frac{\\alpha n y^{n-1}}{K^n(1 + (y/K)^n)^2} \\\\ -\\frac{\\alpha n x^{n-1}}{K^n(1 + (x/K)^n)^2}  -1 \\end{pmatrix}\n$$\nSince $x, y \\ge 0$ and all parameters are positive, the off-diagonal elements $\\frac{\\partial f_1}{\\partial y}$ and $\\frac{\\partial f_2}{\\partial x}$ are non-positive for all $(x, y)$ in the domain. A system with a Jacobian matrix having non-positive off-diagonal entries is, by definition, a competitive system.\n\nFor such systems, powerful theoretical results constrain the possible long-term behaviors. The domain $\\mathcal{D} = [0, \\alpha] \\times [0, \\alpha]$ is a compact and positively invariant set for the flow. This is because on its boundaries, the vector field points inwards or is tangent to the boundary. For instance, if $x=0$, $\\frac{dx}{dt} = \\frac{\\alpha}{1+(y/K)^n}  0$. If $x=\\alpha$, $\\frac{dx}{dt} = \\frac{\\alpha}{1+(y/K)^n} - \\alpha \\le 0$. Similar logic holds for the boundaries $y=0$ and $y=\\alpha$.\n\nAccording to the theory of monotone dynamical systems (specifically, results by M.W. Hirsch), for a competitive system on a compact, convex, positively invariant set, the $\\omega$-limit set (the set of accumulation points) of any trajectory is simple. It cannot contain stable periodic orbits or chaotic attractors. For almost all initial conditions, trajectories converge to a stable equilibrium point (a steady state of the system).\n\nThis theoretical guarantee is crucial: it validates the proposed numerical method. By integrating the ODEs for a sufficiently long time $T_{\\max}$, we can be confident that the state of the system $(x(T_{\\max}), y(T_{\\max}))$ will be arbitrarily close to one of the stable equilibria. Therefore, classifying initial conditions based on their final state after a long integration is a sound method for approximating their basins of attraction. The specified integration time $T_{\\max} = 100$ is much larger than the system's characteristic timescale of $\\tau=1$ (from the linear degradation terms), ensuring convergence.\n\n**Numerical Strategy**\n\nThe robustness metric $R(n, K)$ is the fractional area of the basin of attraction for the \"$x$-high\" state within the domain $\\mathcal{D}$. We approximate this using a grid-based approach.\n\n1.  **Discretize Domain**: A uniform grid of $M \\times M$ initial conditions $(x_0, y_0)$ is constructed over the domain $\\mathcal{D} = [0, \\alpha] \\times [0, \\alpha]$, with $M=25$ and $\\alpha=10$.\n\n2.  **Numerical Integration**: For each initial condition $(x_0, y_0)$ from the grid, the system of ODEs is numerically integrated from $t=0$ to $t=T_{\\max}=100$. We use a high-precision ODE solver with the specified relative tolerance $\\mathrm{rtol}=10^{-8}$ and absolute tolerance $\\mathrm{atol}=10^{-10}$ to ensure accuracy.\n\n3.  **Classification**: The final state of each trajectory, $(x(T_{\\max}), y(T_{\\max}))$, is classified. If $x(T_{\\max}) - y(T_{\\max}) \\ge \\varepsilon$ (with $\\varepsilon=10^{-3}$), the initial condition is considered to belong to the basin of the \"$x$-high\" attractor. A counter for such trajectories is incremented.\n\n4.  **Robustness Calculation**: After simulating all $M^2$ initial conditions, the robustness $R(n, K)$ is calculated as the ratio of the number of trajectories that converged to the \"$x$-high\" state to the total number of initial conditions, $M^2$.\n\nThis procedure is systematically applied to the four specified $(n, K)$ test cases. For the bistable cases, the system's symmetry implies that the basins for the \"$x$-high\" and \"$y$-high\" states should be approximately equal in size, separated by the basin of the unstable symmetric state. The separatrix should lie close to the diagonal $y=x$. Given a grid of $25 \\times 25 = 625$ points, $25$ lie on the diagonal, and $300$ lie on either side. Thus, for strongly bistable cases, we expect $R(n, K) \\approx 300 / 625 = 0.48$. For monostable cases, where only a symmetric equilibrium exists, we expect $R(n, K) = 0$.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Models a symmetric genetic toggle switch, computes a robustness metric for its\n    bistable behavior, and evaluates this metric for several parameter sets.\n    \"\"\"\n    \n    # Define the fixed parameters from the problem statement.\n    alpha = 10.0\n    M = 25\n    T_max = 100.0\n    epsilon = 1e-3\n    rtol = 1e-8\n    atol = 1e-10\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        (1.0, 1.0),   # Low cooperativity, expected monostable\n        (2.0, 10.0),  # Weak repression, expected monostable\n        (3.5, 1.0),   # Moderate cooperativity, expected bistable\n        (4.0, 0.2)    # Strong cooperativity, expected bistable\n    ]\n\n    def toggle_switch_ode(t, state, n, K):\n        \"\"\"\n        Defines the system of ordinary differential equations for the genetic toggle switch.\n        \n        Args:\n            t (float): Time (required by solve_ivp, but not used in this autonomous system).\n            state (list or np.ndarray): A list [x, y] representing the protein concentrations.\n            n (float): The Hill coefficient.\n            K (float): The repression threshold.\n        \n        Returns:\n            list: A list [dx/dt, dy/dt] of the rates of change.\n        \"\"\"\n        x, y = state\n        dx_dt = alpha / (1.0 + (y / K)**n) - x\n        dy_dt = alpha / (1.0 + (x / K)**n) - y\n        return [dx_dt, dy_dt]\n\n    results = []\n    \n    # Generate the grid of initial conditions over the domain D = [0, alpha] x [0, alpha]\n    initial_conditions_x = np.linspace(0, alpha, M)\n    initial_conditions_y = np.linspace(0, alpha, M)\n\n    # Iterate through each parameter set (n, K)\n    for n, K in test_cases:\n        x_high_count = 0\n        \n        # Iterate through each initial condition on the grid\n        for x0 in initial_conditions_x:\n            for y0 in initial_conditions_y:\n                # Numerically integrate the ODE from t=0 to t=T_max\n                solution = solve_ivp(\n                    toggle_switch_ode,\n                    [0, T_max],\n                    [x0, y0],\n                    args=(n, K),\n                    rtol=rtol,\n                    atol=atol,\n                    dense_output=False  # We only need the final point\n                )\n                \n                # Extract the final state at t=T_max\n                x_final, y_final = solution.y[:, -1]\n                \n                # Classify the trajectory based on the final state\n                # If it converges to the \"x-high\" attractor, increment the counter.\n                if x_final - y_final >= epsilon:\n                    x_high_count += 1\n        \n        # Calculate the robustness metric R(n, K)\n        total_points = M * M\n        robustness = x_high_count / total_points\n        \n        # Append the formatted result to the list\n        results.append(f\"{robustness:.4f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "3328034"}, {"introduction": "Idealized models often assume perfect symmetry, but real biological components are never identical. This practice addresses the crucial question of how such imperfections affect the toggle switch's function. Using the powerful technique of perturbation analysis, you will analytically derive how small asymmetries in repression thresholds or protein degradation rates break the system's symmetry, causing a quantifiable \"skew\" in the steady-state protein levels. This exercise provides deep insight into the robustness of the switch design and the impact of component mismatch. [@problem_id:3328087]", "problem": "Consider a two-gene transcriptional repression circuit known as the genetic toggle switch. Each gene produces a protein that represses the other’s expression through cooperative binding, represented by a Hill function. Let $x(t)$ and $y(t)$ denote the protein concentrations of the two genes as functions of time $t$. The dynamics obey mass-balance Ordinary Differential Equations (ODEs) of production and loss, with repression modeled by Hill-type functions:\n$$\n\\frac{dx}{dt} \\;=\\; \\frac{\\beta_x}{1 + \\left(\\frac{y}{K_y}\\right)^{n}} \\;-\\; \\gamma_x \\, x,\n\\qquad\n\\frac{dy}{dt} \\;=\\; \\frac{\\beta_y}{1 + \\left(\\frac{x}{K_x}\\right)^{n}} \\;-\\; \\gamma_y \\, y,\n$$\nwhere $\\beta_x$ and $\\beta_y$ are maximal production rates, $K_x$ and $K_y$ are repression thresholds (dissociation-like constants), $\\gamma_x$ and $\\gamma_y$ are effective first-order loss rates (e.g., degradation plus dilution), and $n \\ge 2$ is the Hill coefficient representing cooperativity in repression. Assume $\\beta_x = \\beta_y$ to isolate the impact of asymmetries in thresholds and loss rates.\n\nIntroduce nondimensional variables using common geometric-mean scales to avoid biasing either gene: define a concentration scale $K = \\sqrt{K_x K_y}$, a loss-rate scale $G = \\sqrt{\\gamma_x \\gamma_y}$, and let the dimensionless state variables and time be $X = x/K$, $Y = y/K$, and $\\tau = Gt$. Let the dimensionless production amplitude be $a = \\beta_x/(GK)$, and the dimensionless asymmetry parameters\n$$\n\\kappa_x \\;=\\; \\frac{K}{K_x}, \\quad \\kappa_y \\;=\\; \\frac{K}{K_y}, \\quad r_x \\;=\\; \\frac{\\gamma_x}{G}, \\quad r_y \\;=\\; \\frac{\\gamma_y}{G}.\n$$\nIn these variables, the nondimensional ODEs are\n$$\n\\frac{dX}{d\\tau} \\;=\\; \\frac{a}{1 + \\left(\\kappa_y Y\\right)^{n}} \\;-\\; r_x \\, X,\n\\qquad\n\\frac{dY}{d\\tau} \\;=\\; \\frac{a}{1 + \\left(\\kappa_x X\\right)^{n}} \\;-\\; r_y \\, Y.\n$$\nIn the perfectly symmetric case ($K_x = K_y$ and $\\gamma_x = \\gamma_y$), one has $\\kappa_x = \\kappa_y = 1$ and $r_x = r_y = 1$, and a symmetric steady state $X = Y = s$ exists, with $s$ determined implicitly by the balance\n$$\ns \\;=\\; \\frac{a}{1 + s^{n}}.\n$$\n\nNow consider a small asymmetry in repression thresholds and loss rates, with $K_x \\neq K_y$ and $\\gamma_x \\neq \\gamma_y$. Parameterize the asymmetry by writing $\\kappa_x = \\exp(-\\varepsilon)$, $\\kappa_y = \\exp(\\varepsilon)$ and $r_x = \\exp(\\eta)$, $r_y = \\exp(-\\eta)$, where $\\varepsilon$ and $\\eta$ are small dimensionless parameters (i.e., $|\\varepsilon| \\ll 1$, $|\\eta| \\ll 1$) that quantify threshold and loss-rate asymmetries, respectively. Working to first order in $\\varepsilon$ and $\\eta$, let the perturbed steady state be $X^{\\ast} = s + \\delta$ and $Y^{\\ast} = s - \\delta$, with $\\delta$ small. Define the fractional skew relative to the symmetric steady-state level $s$ as\n$$\n\\phi \\;=\\; \\frac{X^{\\ast} - Y^{\\ast}}{2s} \\;=\\; \\frac{\\delta}{s}.\n$$\n\nUsing the nondimensional ODEs and the definitions above, derive and simplify the analytic first-order expression for $\\phi$ in terms of $s$, $n$, $\\varepsilon$, and $\\eta$. Your final answer must be a single closed-form analytic expression. The sign of $\\phi$ indicates the direction of symmetry breaking (positive $\\phi$ implies $X^{\\ast}  Y^{\\ast}$). No numerical evaluation is required.", "solution": "The goal is to derive a first-order expression for the fractional skew $\\phi$ of a genetic toggle switch steady state under small asymmetries in the repression thresholds and loss rates.\n\nWe begin with the steady-state equations, where the time derivatives are zero:\n$$\nr_x X^{\\ast} = \\frac{a}{1 + (\\kappa_y Y^{\\ast})^n} \\quad (1)\n$$\n$$\nr_y Y^{\\ast} = \\frac{a}{1 + (\\kappa_x X^{\\ast})^n} \\quad (2)\n$$\n\nWe are working to first order in the small parameters $\\varepsilon$, $\\eta$, and the resulting perturbation $\\delta$. We can approximate the exponential terms using a first-order Taylor expansion:\n$r_x = \\exp(\\eta) \\approx 1 + \\eta$\n$r_y = \\exp(-\\eta) \\approx 1 - \\eta$\n$\\kappa_x = \\exp(-\\varepsilon) \\approx 1 - \\varepsilon$\n$\\kappa_y = \\exp(\\varepsilon) \\approx 1 + \\varepsilon$\n\nThe perturbed steady state is given by $X^{\\ast} = s + \\delta$ and $Y^{\\ast} = s - \\delta$. To find an equation for $\\delta$, we subtract equation $(2)$ from equation $(1)$:\n$$\nr_x X^{\\ast} - r_y Y^{\\ast} = a \\left( \\frac{1}{1 + (\\kappa_y Y^{\\ast})^n} - \\frac{1}{1 + (\\kappa_x X^{\\ast})^n} \\right)\n$$\nWe expand the left-hand side (LHS) and right-hand side (RHS) to first order in the small parameters, neglecting products of small quantities (e.g., $\\eta\\delta$, $\\varepsilon\\delta$).\n\nFor the LHS:\n$$\nLHS = (1+\\eta)(s+\\delta) - (1-\\eta)(s-\\delta) \\approx (s + \\delta + s\\eta) - (s - \\delta - s\\eta) = 2\\delta + 2s\\eta\n$$\n\nFor the RHS, we first expand the terms inside the parentheses. The term $(\\kappa_y Y^{\\ast})^n$ becomes:\n$$\n(\\kappa_y Y^{\\ast})^n = ((1+\\varepsilon)(s-\\delta))^n = (1+\\varepsilon)^n (s-\\delta)^n \\approx (1+n\\varepsilon) s^n\\left(1 - \\frac{\\delta}{s}\\right)^n \\approx (1+n\\varepsilon)s^n\\left(1 - n\\frac{\\delta}{s}\\right) \\approx s^n - ns^{n-1}\\delta + n\\varepsilon s^n\n$$\nSimilarly, the term $(\\kappa_x X^{\\ast})^n$ becomes:\n$$\n(\\kappa_x X^{\\ast})^n = ((1-\\varepsilon)(s+\\delta))^n \\approx (1-n\\varepsilon)s^n\\left(1 + n\\frac{\\delta}{s}\\right) \\approx s^n + ns^{n-1}\\delta - n\\varepsilon s^n\n$$\nNow we use the approximation $1/(A+B) \\approx A^{-1} - A^{-2}B$ for small $B$. Let $A=1+s^n$. The first term on the RHS is:\n$$\n\\frac{a}{1 + s^n - ns^{n-1}\\delta + n\\varepsilon s^n} = \\frac{a}{A + (-ns^{n-1}\\delta + n\\varepsilon s^n)} \\approx \\frac{a}{A} - \\frac{a}{A^2}(-ns^{n-1}\\delta + n\\varepsilon s^n)\n$$\nUsing the symmetric steady-state relation $s = a/(1+s^n) = a/A$, we have $a/A^2 = s/A = s/(1+s^n)$. So, the first term is:\n$$\ns - \\frac{s}{1+s^n}(-ns^{n-1}\\delta + n\\varepsilon s^n) = s + \\frac{ns^n\\delta - n\\varepsilon s^{n+1}}{1+s^n}\n$$\nThe second term on the RHS is:\n$$\n\\frac{a}{1 + s^n + ns^{n-1}\\delta - n\\varepsilon s^n} \\approx s - \\frac{s}{1+s^n}(ns^{n-1}\\delta - n\\varepsilon s^n) = s - \\frac{ns^n\\delta - n\\varepsilon s^{n+1}}{1+s^n}\n$$\nSubtracting the second term from the first gives the RHS:\n$$\nRHS = \\left(s + \\frac{ns^n\\delta - n\\varepsilon s^{n+1}}{1+s^n}\\right) - \\left(s - \\frac{ns^n\\delta - n\\varepsilon s^{n+1}}{1+s^n}\\right) = \\frac{2(ns^n\\delta - n\\varepsilon s^{n+1})}{1+s^n}\n$$\nEquating the expanded LHS and RHS:\n$$\n2\\delta + 2s\\eta = \\frac{2ns^n\\delta - 2n\\varepsilon s^{n+1}}{1+s^n}\n$$\nDividing by 2 and rearranging to solve for $\\delta$:\n$$\n\\delta + s\\eta = \\frac{ns^n\\delta}{1+s^n} - \\frac{n\\varepsilon s^{n+1}}{1+s^n}\n$$\n$$\n\\delta \\left(1 - \\frac{ns^n}{1+s^n}\\right) = -s\\eta - \\frac{n\\varepsilon s^{n+1}}{1+s^n}\n$$\n$$\n\\delta \\left(\\frac{1+s^n-ns^n}{1+s^n}\\right) = \\frac{-s\\eta(1+s^n) - n\\varepsilon s^{n+1}}{1+s^n}\n$$\n$$\n\\delta \\left(1+(1-n)s^n\\right) = -s\\eta(1+s^n) - n\\varepsilon s^{n+1}\n$$\n$$\n\\delta = - \\frac{s\\eta(1+s^n) + n\\varepsilon s^{n+1}}{1+(1-n)s^n}\n$$\nThe fractional skew is $\\phi = \\delta/s$. Dividing the expression for $\\delta$ by $s$ yields the final result:\n$$\n\\phi = - \\frac{\\eta(1+s^n) + n\\varepsilon s^n}{1+(1-n)s^n}\n$$", "answer": "$$\\boxed{-\\frac{(1+s^n)\\eta + ns^n\\varepsilon}{1+(1-n)s^n}}$$", "id": "3328087"}]}