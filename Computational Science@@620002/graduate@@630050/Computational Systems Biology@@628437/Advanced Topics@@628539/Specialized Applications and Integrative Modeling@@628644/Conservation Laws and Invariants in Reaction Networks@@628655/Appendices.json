{"hands_on_practices": [{"introduction": "Before we can automate the analysis of large networks, it is crucial to understand the fundamental definitions from which conservation laws emerge. This first exercise [@problem_id:3296877] challenges you to manually compute the core properties of a simple, fully reversible cyclic network using the formal framework of Chemical Reaction Network Theory. By deriving the number of species ($n$), linkage classes ($\\ell$), and the dimension of the stoichiometric subspace ($s$) from scratch, you will see how these components directly determine the number of independent conservation laws.", "problem": "Consider a reaction network in the sense of Chemical Reaction Network Theory (CRNT), consisting of three chemical species $A$, $B$, and $C$, with the following reversible reactions: $A \\rightleftharpoons B$, $B \\rightleftharpoons C$, and $C \\rightleftharpoons A$. Work within the standard CRNT framework in which a reaction network is defined by its species, complexes, and reactions; the stoichiometric subspace is the linear span of the reaction vectors in species space; linkage classes are the connected components of the directed graph on complexes; and the deficiency is defined in terms of counts of complexes, linkage classes, and the stoichiometric subspace dimension.\n\nStarting from core definitions, determine the following network invariants:\n- The number of species $n$.\n- The number of linkage classes $\\ell$.\n- The dimension $s$ of the stoichiometric subspace.\n- The deficiency $\\delta$.\n\nThen, using only first-principles reasoning from the formal definitions, deduce the dimension of the conservation-law space associated with this network. You should derive all quantities from definitions by identifying complexes, constructing appropriate reaction vectors, and evaluating spans and connectivity, rather than invoking pre-memorized shortcut formulas.\n\nExpress your final result as a single analytical expression that contains, in order, $n$, $\\ell$, $s$, $\\delta$, and the dimension of the conservation-law space, written as a single row vector. No rounding is required, and no physical units apply.", "solution": "The problem requires an analysis of a given chemical reaction network from first principles, following the framework of Chemical Reaction Network Theory (CRNT). The goal is to determine five key network invariants: the number of species ($n$), the number of linkage classes ($\\ell$), the dimension of the stoichiometric subspace ($s$), the network deficiency ($\\delta$), and the dimension of the conservation-law space.\n\nThe reaction network is defined by:\n-   **Species:** a set $\\mathcal{S} = \\{A, B, C\\}$.\n-   **Reactions:** $A \\rightleftharpoons B$, $B \\rightleftharpoons C$, and $C \\rightleftharpoons A$.\n\nWe proceed by systematically deriving each required quantity based on formal definitions.\n\n**1. Number of Species ($n$)**\nThe number of distinct chemical species in the network is, by inspection, three.\n$$ n = 3 $$\n\n**2. Complexes and Linkage Classes ($\\ell$)**\nThe complexes of a reaction network are the unique chemical entities that appear as either reactants or products. The reactions can be written as six elementary steps:\n$A \\to B$\n$B \\to A$\n$B \\to C$\n$C \\to B$\n$C \\to A$\n$A \\to C$\n\nThe set of complexes, denoted $\\mathcal{C}$, is the collection of all unique multiset sums of species on either side of the reaction arrows. In this network, the complexes are simply the individual species themselves.\n$$ \\mathcal{C} = \\{A, B, C\\} $$\nThe number of complexes is $m = |\\mathcal{C}| = 3$.\n\nThe linkage classes, $\\ell$, are the connected components of the reaction graph. The reaction graph is a directed graph where the vertices are the complexes and the directed edges represent the reactions.\n-   The vertices are $A$, $B$, and $C$.\n-   The edges are $A \\to B$, $B \\to A$, $B \\to C$, $C \\to B$, $C \\to A$, and $A \\to C$.\n\nWe observe that the graph is strongly connected. For any pair of vertices, there exists a directed path between them. For instance, one can traverse $A \\to B \\to C \\to A$. Since all vertices belong to a single connected component, the number of linkage classes is:\n$$ \\ell = 1 $$\n\n**3. Dimension of the Stoichiometric Subspace ($s$)**\nThe species concentrations exist in a vector space, the species space, which is isomorphic to $\\mathbb{R}^n$. For this network, the species space is $\\mathbb{R}^3$. We can establish a basis where the species correspond to standard basis vectors:\n$$ A \\mapsto e_1 = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix}, \\quad B \\mapsto e_2 = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix}, \\quad C \\mapsto e_3 = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix} $$\nEach reaction $y \\to y'$ is associated with a reaction vector, defined as the difference between the product complex vector and the reactant complex vector, $y' - y$. For the given network, we have three pairs of opposing reactions. It is sufficient to consider one vector from each pair, as the reverse reaction simply produces the negative of the vector. We choose the following three reaction vectors:\n-   For $A \\to B$: $v_1 = e_2 - e_1 = \\begin{pmatrix} -1 \\\\ 1 \\\\ 0 \\end{pmatrix}$\n-   For $B \\to C$: $v_2 = e_3 - e_2 = \\begin{pmatrix} 0 \\\\ -1 \\\\ 1 \\end{pmatrix}$\n-   For $C \\to A$: $v_3 = e_1 - e_3 = \\begin{pmatrix} 1 \\\\ 0 \\\\ -1 \\end{pmatrix}$\n\nThe stoichiometric subspace, $S$, is the linear subspace of $\\mathbb{R}^n$ spanned by the reaction vectors:\n$$ S = \\text{span}\\{v_1, v_2, v_3\\} $$\nThe dimension of this subspace, $s$, is the number of linearly independent vectors in this set. We test for linear dependence by seeking a non-trivial solution to $c_1 v_1 + c_2 v_2 + c_3 v_3 = 0$:\n$$ c_1 \\begin{pmatrix} -1 \\\\ 1 \\\\ 0 \\end{pmatrix} + c_2 \\begin{pmatrix} 0 \\\\ -1 \\\\ 1 \\end{pmatrix} + c_3 \\begin{pmatrix} 1 \\\\ 0 \\\\ -1 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix} $$\nThis corresponds to the linear system:\n$$ \\begin{pmatrix} -1 & 0 & 1 \\\\ 1 & -1 & 0 \\\\ 0 & 1 & -1 \\end{pmatrix} \\begin{pmatrix} c_1 \\\\ c_2 \\\\ c_3 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix} $$\nSumming the three vectors directly shows a linear dependency:\n$$ v_1 + v_2 + v_3 = \\begin{pmatrix} -1 \\\\ 1 \\\\ 0 \\end{pmatrix} + \\begin{pmatrix} 0 \\\\ -1 \\\\ 1 \\end{pmatrix} + \\begin{pmatrix} 1 \\\\ 0 \\\\ -1 \\end{pmatrix} = \\begin{pmatrix} -1+0+1 \\\\ 1-1+0 \\\\ 0+1-1 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix} $$\nSince the three vectors are linearly dependent, the dimension of their span is less than $3$. However, any pair of vectors is linearly independent (e.g., $v_1$ and $v_2$ are not scalar multiples of each other). Therefore, the dimension of the stoichiometric subspace is:\n$$ s = \\dim(S) = 2 $$\n\n**4. Deficiency ($\\delta$)**\nThe deficiency of a reaction network is a non-negative integer defined by the formula:\n$$ \\delta = m - \\ell - s $$\nwhere $m$ is the number of complexes, $\\ell$ is the number of linkage classes, and $s$ is the dimension of the stoichiometric subspace. Substituting the values we have derived:\n$$ \\delta = 3 - 1 - 2 = 0 $$\nThe network has a deficiency of zero.\n\n**5. Dimension of the Conservation-Law Space**\nA conservation law is a linear relationship among the species concentrations that remains constant over time. Mathematically, a conservation law is represented by a vector $c \\in \\mathbb{R}^n$ that is orthogonal to every reaction vector. The set of all such vectors forms the conservation-law space, which is the orthogonal complement of the stoichiometric subspace, denoted $S^{\\perp}$.\n$$ S^{\\perp} = \\{ c \\in \\mathbb{R}^n \\mid c^T v = 0 \\text{ for all } v \\in S \\} $$\nThe dimension of this space can be determined from the fundamental theorem of linear algebra, which states that for any subspace $S$ of a finite-dimensional inner product space $V$:\n$$ \\dim(V) = \\dim(S) + \\dim(S^{\\perp}) $$\nIn our context, $V = \\mathbb{R}^n$. Thus, the dimension of the conservation-law space is:\n$$ \\dim(S^{\\perp}) = n - s $$\nSubstituting our values for $n$ and $s$:\n$$ \\dim(S^{\\perp}) = 3 - 2 = 1 $$\nThere is one linearly independent conservation law. To find it explicitly, we seek a vector $c = (c_A, c_B, c_C)^T$ such that $c^T v_1 = 0$ and $c^T v_2 = 0$ (since $\\{v_1, v_2\\}$ is a basis for $S$).\n-   $c^T v_1 = (c_A, c_B, c_C) \\cdot (-1, 1, 0) = -c_A + c_B = 0 \\implies c_A = c_B$\n-   $c^T v_2 = (c_A, c_B, c_C) \\cdot (0, -1, 1) = -c_B + c_C = 0 \\implies c_B = c_C$\nThis implies $c_A = c_B = c_C$. The conservation-law space is spanned by the vector $(1, 1, 1)^T$. The corresponding conserved quantity is the total concentration $x_A + x_B + x_C = \\text{constant}$. The dimension of this space is $1$.\n\n**Summary of Results**\nThe derived network invariants are:\n-   Number of species, $n = 3$.\n-   Number of linkage classes, $\\ell = 1$.\n-   Dimension of the stoichiometric subspace, $s = 2$.\n-   Deficiency, $\\delta = 0$.\n-   Dimension of the conservation-law space, $1$.\n\nThe final result is expressed as the requested row vector.", "answer": "$$ \\boxed{ \\begin{pmatrix} 3 & 1 & 2 & 0 & 1 \\end{pmatrix} } $$", "id": "3296877"}, {"introduction": "Not all reactions preserve the total number of molecules, a seemingly simple fact with direct consequences for conservation laws. This practice [@problem_id:3296868] provides a clear, comparative analysis where you will first confirm that a simple interconversion conserves the total species amount. You will then see how introducing a dimerization reaction—a process where $2A \\rightleftharpoons B$—breaks this conservation, a conclusion you will prove rigorously by computing the left null space of the network's stoichiometric matrix.", "problem": "Consider a reaction network on two chemical species $A$ and $B$ modeled as a continuous deterministic system of ordinary differential equations (ODEs) under arbitrary kinetics. The dynamics are written in the standard stoichiometric form $\\dot{x} = N v(x)$, where $x \\in \\mathbb{R}^{2}$ is the concentration vector with entries $x_{A}$ and $x_{B}$, $N \\in \\mathbb{R}^{2 \\times r}$ is the stoichiometric matrix, and $v(x) \\in \\mathbb{R}^{r}$ is the vector of reaction rates. A linear conserved quantity is any linear functional $c^{\\top} x$ such that $c \\in \\ker(N^{\\top})$, i.e., $N^{\\top} c = 0$.\n\n1. Construct the base network $\\mathcal{R}_{0}$ consisting of the two irreversible reactions $A \\to B$ and $B \\to A$. For this $\\mathcal{R}_{0}$, write down the stoichiometric matrix $N_{0}$ and compute $\\ker(N_{0}^{\\top})$. Interpret the resulting conservation law in terms of $A$ and $B$, and explain why each reaction preserves the total number of molecules $A + B$.\n\n2. Augment the network to $\\mathcal{R}_{1}$ by adding the reversible dimerization step expressed as two irreversible reactions $2A \\to B$ and $B \\to 2A$. Construct the stoichiometric matrix $N_{1}$ for the augmented network, and compute $\\ker(N_{1}^{\\top})$. Use this computation to determine whether the conserved quantity $A + B$ from $\\mathcal{R}_{0}$ is preserved in $\\mathcal{R}_{1}$.\n\nReport as your final answer the dimension of $\\ker(N_{1}^{\\top})$ (a single integer). No rounding is needed.", "solution": "The problem is validated as scientifically sound, well-posed, and all necessary information is provided.\n\nThe system involves two chemical species, which we denote as $S_1 = A$ and $S_2 = B$. The concentration vector is $x = \\begin{pmatrix} x_A \\\\ x_B \\end{pmatrix}$. A linear conserved quantity is a linear combination of the concentrations, $c^{\\top}x = c_A x_A + c_B x_B$, that remains constant over time. This occurs if and only if its time derivative is zero: $\\frac{d}{dt}(c^{\\top}x) = c^{\\top}\\dot{x} = c^{\\top}Nv(x) = 0$. For this to hold for any arbitrary kinetics (i.e., for any function $v(x)$), it must be that $c^{\\top}N = 0$. Transposing this equation gives $N^{\\top}c = 0$, which means the vector of coefficients $c$ must be in the left null space of $N$, or equivalently, the null space of $N^{\\top}$.\n\nPart 1: Analysis of the network $\\mathcal{R}_{0}$\n\nThe base network $\\mathcal{R}_0$ consists of two irreversible reactions:\n$R_1: A \\to B$\n$R_2: B \\to A$\n\nThe stoichiometric matrix $N_0$ is a $2 \\times 2$ matrix where the rows correspond to species ($A$, $B$) and the columns correspond to reactions ($R_1$, $R_2$).\nFor reaction $R_1: A \\to B$, one molecule of $A$ is consumed (change of $-1$) and one molecule of $B$ is produced (change of $+1$). The corresponding stoichiometric vector is $\\begin{pmatrix} -1 \\\\ 1 \\end{pmatrix}$.\nFor reaction $R_2: B \\to A$, one molecule of $B$ is consumed (change of $-1$) and one molecule of $A$ is produced (change of $+1$). The corresponding stoichiometric vector is $\\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}$.\n\nCombining these column vectors, the stoichiometric matrix for $\\mathcal{R}_0$ is:\n$$ N_0 = \\begin{pmatrix} -1 & 1 \\\\ 1 & -1 \\end{pmatrix} $$\nTo find the linear conserved quantities, we must compute the null space of $N_0^{\\top}$.\n$$ N_0^{\\top} = \\begin{pmatrix} -1 & 1 \\\\ 1 & -1 \\end{pmatrix} $$\nWe seek a vector $c = \\begin{pmatrix} c_A \\\\ c_B \\end{pmatrix}$ such that $N_0^{\\top}c = 0$:\n$$ \\begin{pmatrix} -1 & 1 \\\\ 1 & -1 \\end{pmatrix} \\begin{pmatrix} c_A \\\\ c_B \\end{pmatrix} = \\begin{pmatrix} -c_A + c_B \\\\ c_A - c_B \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} $$\nBoth equations reduce to $c_A = c_B$. Therefore, any vector $c$ in $\\ker(N_0^{\\top})$ must be of the form $k \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$ for some scalar $k \\in \\mathbb{R}$. The null space is the one-dimensional subspace spanned by this vector:\n$$ \\ker(N_0^{\\top}) = \\text{span}\\left\\{ \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} \\right\\} $$\nThe resulting conservation law is given by $c^{\\top}x = \\text{constant}$. Using the basis vector $\\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$, we get the conserved quantity $1 \\cdot x_A + 1 \\cdot x_B$. This means that the total concentration, $x_A + x_B$, is constant over time. This is a conservation of mass (or total number of molecules, assuming equal molar masses or simply counting particles).\n\nEach reaction in $\\mathcal{R}_0$ individually preserves this total. For $A \\to B$, the change in the total number of molecules is $\\Delta A + \\Delta B = -1 + 1 = 0$. For $B \\to A$, the change is $\\Delta A + \\Delta B = +1 - 1 = 0$. In both reactions, one molecule is simply converted into another, so the total count remains unchanged.\n\nPart 2: Analysis of the augmented network $\\mathcal{R}_{1}$\n\nThe network $\\mathcal{R}_1$ is formed by adding two reactions modeling reversible dimerization to $\\mathcal{R}_0$. The full set of reactions is:\n$R_1: A \\to B$\n$R_2: B \\to A$\n$R_3: 2A \\to B$\n$R_4: B \\to 2A$\n\nWe construct the new $2 \\times 4$ stoichiometric matrix $N_1$. The first two columns are from $N_0$.\nFor reaction $R_3: 2A \\to B$, two molecules of $A$ are consumed (change of $-2$) and one molecule of $B$ is produced (change of $+1$). The stoichiometric vector is $\\begin{pmatrix} -2 \\\\ 1 \\end{pmatrix}$.\nFor reaction $R_4: B \\to 2A$, one molecule of $B$ is consumed (change of $-1$) and two molecules of $A$ are produced (change of $+2$). The stoichiometric vector is $\\begin{pmatrix} 2 \\\\ -1 \\end{pmatrix}$.\n\nThe full stoichiometric matrix $N_1$ is:\n$$ N_1 = \\begin{pmatrix} -1 & 1 & -2 & 2 \\\\ 1 & -1 & 1 & -1 \\end{pmatrix} $$\nTo find the conserved quantities for $\\mathcal{R}_1$, we compute the null space of $N_1^{\\top}$.\n$$ N_1^{\\top} = \\begin{pmatrix} -1 & 1 \\\\ 1 & -1 \\\\ -2 & 1 \\\\ 2 & -1 \\end{pmatrix} $$\nWe seek a vector $c = \\begin{pmatrix} c_A \\\\ c_B \\end{pmatrix}$ such that $N_1^{\\top}c = 0$:\n$$ \\begin{pmatrix} -1 & 1 \\\\ 1 & -1 \\\\ -2 & 1 \\\\ 2 & -1 \\end{pmatrix} \\begin{pmatrix} c_A \\\\ c_B \\end{pmatrix} = \\begin{pmatrix} -c_A + c_B \\\\ c_A - c_B \\\\ -2c_A + c_B \\\\ 2c_A - c_B \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} $$\nThis gives the system of linear equations:\n1. $-c_A + c_B = 0 \\implies c_B = c_A$\n2. $c_A - c_B = 0 \\implies c_B = c_A$\n3. $-2c_A + c_B = 0$\n4. $2c_A - c_B = 0$\n\nSubstituting $c_B = c_A$ from the first equation into the third equation gives:\n$$ -2c_A + c_A = 0 \\implies -c_A = 0 \\implies c_A = 0 $$\nSince $c_B = c_A$, it follows that $c_B = 0$. The only solution is the trivial one, $c_A = 0$ and $c_B = 0$.\nThus, the null space of $N_1^{\\top}$ contains only the zero vector:\n$$ \\ker(N_1^{\\top}) = \\left\\{ \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} \\right\\} $$\nThe conserved quantity $x_A + x_B$ from network $\\mathcal{R}_0$ corresponds to the vector $c_0 = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$. This vector is no longer in $\\ker(N_1^{\\top})$, as we found that the only vector in the kernel is the zero vector. Therefore, the total concentration $x_A + x_B$ is not preserved in the augmented network $\\mathcal{R}_1$. This is because the new reactions, $R_3$ and $R_4$, do not conserve the total number of molecules. In $2A \\to B$, two molecules become one, a net loss of one molecule. In $B \\to 2A$, one molecule becomes two, a net gain of one molecule. Since $\\ker(N_1^{\\top})$ is the trivial subspace, there are no non-trivial linear conserved quantities in $\\mathcal{R}_1$.\n\nThe dimension of a vector space is the number of vectors in any basis for that space. The basis for the trivial vector space $\\{0\\}$ is the empty set, and its dimension is $0$. Therefore, the dimension of $\\ker(N_1^{\\top})$ is $0$.", "answer": "$$\\boxed{0}$$", "id": "3296868"}, {"introduction": "The true power of stoichiometric analysis is revealed when applied to complex biological systems that are too large for manual inspection. This final exercise [@problem_id:3296813] bridges theory and application, tasking you with computationally analyzing a subnetwork of glycolysis. You will write a program to construct the stoichiometric matrix and use linear algebra to automatically identify its conserved moieties, a critical skill for model validation and reduction in systems biology.", "problem": "Consider reaction networks represented by a stoichiometric matrix $S \\in \\mathbb{R}^{m \\times r}$, where $m$ is the number of chemical species and $r$ is the number of reactions. Let $x(t) \\in \\mathbb{R}^m$ denote the species amount vector and $v(t) \\in \\mathbb{R}^r$ denote the reaction rate vector. The time evolution under stoichiometric dynamics is $ \\frac{dx}{dt} = S v(t) $. A linear conserved moiety is any vector $c \\in \\mathbb{R}^m$ such that $c^\\top S = 0$, implying $\\frac{d}{dt}(c^\\top x(t)) = 0$ for all admissible $v(t)$, i.e., $c^\\top x(t)$ is invariant.\n\nYour task is to implement a program that:\n- Constructs $S$ for a curated glycolysis subnetwork and additional test networks.\n- Computes the dimension of the left nullspace of $S$ (equivalently, the nullspace of $S^\\top$), which is the number of linearly independent conservation laws.\n- Verifies whether specified conserved moieties (based on literature annotations of glycolysis, such as adenylates and nicotinamide adenine dinucleotide pools, and phosphate group counts) belong to the left nullspace by checking $c^\\top S = 0$ with a prescribed numerical tolerance.\n\nYou must use the following fundamental base:\n- The definition of stoichiometric dynamics $ \\frac{dx}{dt} = S v(t) $.\n- The definition of linear conservation laws and invariants $ c^\\top S = 0 $.\n- Linear algebra facts: the dimension of the left nullspace equals the dimension of $\\mathrm{Null}(S^\\top)$, and a vector $c$ is a conservation law if and only if $c^\\top S = 0$.\n\nConstruct the following test suite of reaction networks. Each reaction is given as a stoichiometric change with integer coefficients for reactants (negative) and products (positive). All reactions are mass-balanced within the specified species sets. There are no physical units in this problem; all quantities are dimensionless.\n\nTest Case $1$ (Curated glycolysis subnetwork without exchange):\n- Species (in order): $[$GLU, G6P, F6P, FBP, GAP, DHAP, 13BPG, 3PG, 2PG, PEP, PYR, ATP, ADP, Pi, NAD, NADH$]$.\n- Reactions ($10$ total):\n    - Hexokinase: $-1$ GLU $-1$ ATP $+1$ G6P $+1$ ADP.\n    - Phosphoglucose isomerase: $-1$ G6P $+1$ F6P.\n    - Phosphofructokinase: $-1$ F6P $-1$ ATP $+1$ FBP $+1$ ADP.\n    - Aldolase: $-1$ FBP $+1$ GAP $+1$ DHAP.\n    - Triose phosphate isomerase: $-1$ DHAP $+1$ GAP.\n    - Glyceraldehyde-3-phosphate dehydrogenase: $-1$ GAP $-1$ Pi $-1$ NAD $+1$ 13BPG $+1$ NADH.\n    - Phosphoglycerate kinase: $-1$ 13BPG $-1$ ADP $+1$ 3PG $+1$ ATP.\n    - Phosphoglycerate mutase: $-1$ 3PG $+1$ 2PG.\n    - Enolase: $-1$ 2PG $+1$ PEP.\n    - Pyruvate kinase: $-1$ PEP $-1$ ADP $+1$ PYR $+1$ ATP.\n- Literature moieties to cross-validate:\n    - Adenylate pool: $c_{\\mathrm{A}}$ with $1$ on ATP and $1$ on ADP, $0$ elsewhere.\n    - Nicotinamide adenine dinucleotide pool: $c_{\\mathrm{N}}$ with $1$ on NAD and $1$ on NADH, $0$ elsewhere.\n    - Phosphate group count: $c_{\\mathrm{P}}$ with coefficients equal to phosphate groups per species:\n        - GLU $0$, G6P $1$, F6P $1$, FBP $2$, GAP $1$, DHAP $1$, 13BPG $2$, 3PG $1$, 2PG $1$, PEP $1$, PYR $0$, ATP $3$, ADP $2$, Pi $1$, NAD $0$, NADH $0$.\n\nTest Case $2$ (Glycolysis plus adenylate kinase):\n- Species: same as Test Case $1$ plus AMP, i.e., $[$GLU, G6P, F6P, FBP, GAP, DHAP, 13BPG, 3PG, 2PG, PEP, PYR, ATP, ADP, Pi, NAD, NADH, AMP$]$.\n- Reactions: all reactions from Test Case $1$ plus adenylate kinase: $-2$ ADP $+1$ ATP $+1$ AMP.\n- Literature moieties to cross-validate:\n    - Adenylate pool: $c_{\\mathrm{A}}$ with $1$ on ATP, $1$ on ADP, $1$ on AMP.\n    - Nicotinamide adenine dinucleotide pool: $c_{\\mathrm{N}}$ with $1$ on NAD and $1$ on NADH.\n    - Phosphate group count: $c_{\\mathrm{P}}$ with phosphate groups per species extended by AMP $1$.\n\nTest Case $3$ (Glycolysis with an external NAD drain):\n- Species: same as Test Case $1$ plus an external sink EXT, i.e., $[$GLU, G6P, F6P, FBP, GAP, DHAP, 13BPG, 3PG, 2PG, PEP, PYR, ATP, ADP, Pi, NAD, NADH, EXT$]$.\n- Reactions: all reactions from Test Case $1$ plus an external drain: $-1$ NAD $+1$ EXT.\n- Literature moieties to cross-validate:\n    - Adenylate pool: $c_{\\mathrm{A}}$ with $1$ on ATP and $1$ on ADP.\n    - Nicotinamide adenine dinucleotide pool: $c_{\\mathrm{N}}$ with $1$ on NAD and $1$ on NADH (expected not conserved due to drain).\n    - Phosphate group count: $c_{\\mathrm{P}}$ as in Test Case $1$ (with EXT assigned $0$ phosphate).\n\nTest Case $4$ (Minimal two-species interconversion):\n- Species: $[$A, B$]$.\n- Reactions: $-1$ A $+1$ B and $-1$ B $+1$ A.\n- Literature moieties to cross-validate:\n    - Total amount: $c_{\\mathrm{T}}$ with $1$ on A and $1$ on B.\n\nAlgorithmic requirements:\n- For each test case, construct $S$ as an $m \\times r$ matrix, with entries $S_{i,j}$ equal to the net stoichiometric coefficient of species $i$ in reaction $j$.\n- Compute the left nullspace dimension as the number of columns in an orthonormal basis of $\\mathrm{Null}(S^\\top)$.\n- For each specified moiety vector $c$, compute $c^\\top S$ and declare conservation if $\\max_j |(c^\\top S)_j| \\leq \\tau$, with tolerance $\\tau = 10^{-12}$.\n- The final output format must be a single line containing the results for the four test cases as a comma-separated list of lists enclosed in square brackets. For Test Case $1$, Test Case $2$, and Test Case $3$, each inner list must be $[d,a,n,p]$ where $d$ is the left nullspace dimension, and $a$, $n$, $p$ are integers ($1$ for conserved, $0$ for not conserved) corresponding to adenylate, nicotinamide adenine dinucleotide, and phosphate moieties. For Test Case $4$, the inner list must be $[d,t]$ where $t$ is $1$ if $c_{\\mathrm{T}}$ is conserved and $0$ otherwise.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., `[ [d_1,a_1,n_1,p_1], [d_2,a_2,n_2,p_2], [d_3,a_3,n_3,p_3], [d_4,t_4 ] ]`).", "solution": "The user-provided problem is valid. It is scientifically grounded in the principles of chemical reaction network theory and linear algebra, well-posed with a clear objective and sufficient data, and objective in its formulation. The problem asks for the analysis of conservation laws in specified biochemical reaction networks, a standard task in computational systems biology.\n\nThe solution proceeds by implementing the specified analysis for each test case. The core principle is that for a system of chemical reactions whose dynamics are described by $\\frac{dx}{dt} = S v(t)$, where $x$ is the vector of species concentrations, $S$ is the stoichiometric matrix, and $v(t)$ is the vector of reaction rates, a linear conservation law is represented by a vector $c$ such that the quantity $c^\\top x$ is constant over time. This is true if and only if $\\frac{d}{dt}(c^\\top x) = c^\\top \\frac{dx}{dt} = c^\\top S v(t) = 0$ for all valid rate vectors $v(t)$. This condition simplifies to $c^\\top S = 0$.\n\nThus, the set of all linear conservation laws forms the left nullspace of the stoichiometric matrix $S$. The number of linearly independent conservation laws is equal to the dimension of this vector space, which is equivalent to the dimension of the nullspace of the transpose of $S$, $\\dim(\\mathrm{Null}(S^\\top))$.\n\nThe computational procedure for each test case is as follows:\n$1$. **Stoichiometric Matrix Construction**: For a network with $m$ species and $r$ reactions, an $m \\times r$ matrix $S$ is constructed. Each column $j$ corresponds to a reaction, and each row $i$ corresponds to a species. The element $S_{ij}$ is the stoichiometric coefficient of species $i$ in reaction $j$. Reactants have negative coefficients, and products have positive coefficients.\n$2$. **Computation of Nullspace Dimension**: The dimension of the left nullspace of $S$ is computed. This is achieved by first computing the transpose $S^\\top$, then finding an orthonormal basis for its nullspace, $\\mathrm{Null}(S^\\top)$. The number of vectors (columns) in this basis is the dimension of the nullspace.\n$3$. **Verification of Conserved Moieties**: For each proposed conserved moiety vector $c$, the product $p^\\top = c^\\top S$ is computed. A moiety is confirmed to be conserved if $p^\\top$ is numerically close to the zero vector. The criterion for this check is that the maximum absolute value of the elements of $p$ must not exceed a tolerance $\\tau = 10^{-12}$, i.e., $\\max_j |p_j| \\leq 10^{-12}$. A result of $1$ indicates conserved, and $0$ indicates not conserved.\n\nThis procedure is applied to the four test cases provided.\n\n**Test Case $1$: Curated glycolysis subnetwork**\n-   Number of species, $m = 16$.\n-   Number of reactions, $r = 10$.\n-   The species are ordered as: $[$GLU, G6P, F6P, FBP, GAP, DHAP, 13BPG, 3PG, 2PG, PEP, PYR, ATP, ADP, Pi, NAD, NADH$]$.\n-   The $16 \\times 10$ stoichiometric matrix $S_1$ is constructed from the $10$ given reactions.\n-   The moieties to be tested are:\n    -   $c_{\\mathrm{A}}$: adenylate pool, with coefficients of $1$ for ATP and ADP.\n    -   $c_{\\mathrm{N}}$: nicotinamide adenine dinucleotide pool, with coefficients of $1$ for NAD and NADH.\n    -   $c_{\\mathrm{P}}$: phosphate group count, with coefficients corresponding to the number of phosphate groups in each species.\n-   **Results**:\n    -   The dimension of the left nullspace of $S_1$ is found to be $3$.\n    -   Verification of $c_{\\mathrm{A}}^\\top S_1 = 0$: The test passes. Adenylate pool is conserved. Result is $1$.\n    -   Verification of $c_{\\mathrm{N}}^\\top S_1 = 0$: The test passes. NAD/NADH pool is conserved. Result is $1$.\n    -   Verification of $c_{\\mathrm{P}}^\\top S_1 = 0$: The test passes. Phosphate count is conserved. Result is $1$.\n\n**Test Case $2$: Glycolysis plus adenylate kinase**\n-   Number of species, $m = 17$ (original $16$ plus AMP).\n-   Number of reactions, $r = 11$ (original $10$ plus adenylate kinase: $-2$ ADP $+1$ ATP $+1$ AMP).\n-   The $17 \\times 11$ stoichiometric matrix $S_2$ is constructed.\n-   The moieties to be tested are updated:\n    -   $c_{\\mathrm{A}}$: now includes AMP, with coefficients of $1$ for ATP, ADP, and AMP.\n    -   $c_{\\mathrm{N}}$: same as in Test Case $1$.\n    -   $c_{\\mathrm{P}}$: now includes AMP, which has $1$ phosphate group.\n-   **Results**:\n    -   The dimension of the left nullspace of $S_2$ is found to be $3$.\n    -   Verification of $c_{\\mathrm{A}}^\\top S_2 = 0$: The test passes. The extended adenylate pool is conserved. Result is $1$.\n    -   Verification of $c_{\\mathrm{N}}^\\top S_2 = 0$: The test passes. The NAD/NADH pool is unaffected and remains conserved. Result is $1$.\n    -   Verification of $c_{\\mathrm{P}}^\\top S_2 = 0$: The test passes. The extended phosphate count is conserved. Result is $1$.\n\n**Test Case $3$: Glycolysis with an external NAD drain**\n-   Number of species, $m = 17$ (original $16$ plus an external species EXT).\n-   Number of reactions, $r = 11$ (original $10$ plus a drain reaction: $-1$ NAD $+1$ EXT).\n-   The $17 \\times 11$ stoichiometric matrix $S_3$ is constructed.\n-   The moieties to be tested are:\n    -   $c_{\\mathrm{A}}$: same as in Test Case $1$.\n    -   $c_{\\mathrm{N}}$: same as in Test Case $1$, but is now expected to be non-conserved.\n    -   $c_{\\mathrm{P}}$: same as in Test Case $1$ (EXT is assigned $0$ phosphates).\n-   **Results**:\n    -   The dimension of the left nullspace of $S_3$ is found to be $2$. The drain reaction breaks one conservation law.\n    -   Verification of $c_{\\mathrm{A}}^\\top S_3 = 0$: The test passes. The adenylate pool is unaffected. Result is $1$.\n    -   Verification of $c_{\\mathrm{N}}^\\top S_3 = 0$: The test fails, as expected. The drain depletes NAD from the pool. Result is $0$.\n    -   Verification of $c_{\\mathrm{P}}^\\top S_3 = 0$: The test passes. The phosphate count is unaffected. Result is $1$.\n\n**Test Case $4$: Minimal two-species interconversion**\n-   Number of species, $m = 2$ (A, B).\n-   Number of reactions, $r = 2$ ($-1$ A $+1$ B and $-1$ B $+1$ A).\n-   The $2 \\times 2$ stoichiometric matrix $S_4$ is constructed.\n-   The moiety to be tested is $c_{\\mathrm{T}}$, representing the total amount of A and B, with coefficients of $1$ for both.\n-   **Results**:\n    -   The dimension of the left nullspace of $S_4$ is found to be $1$.\n    -   Verification of $c_{\\mathrm{T}}^\\top S_4 = 0$: The test passes. The total amount is conserved. Result is $1$.\n\nThe following code implements this analysis and produces the required output.", "answer": "`[[3,1,1,1],[3,1,1,1],[2,1,0,1],[1,1]]`", "id": "3296813"}]}