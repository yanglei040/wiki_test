{"hands_on_practices": [{"introduction": "To quantitatively analyze biological networks where interactions have varying strengths, we model them as weighted graphs. This practice provides foundational skills in translating a weighted undirected network into its fundamental matrix representations: the adjacency matrix $A$, the degree matrix $D$, and the graph Laplacian $L$. Mastering these constructions is the first step toward applying powerful techniques from spectral graph theory to understand network structure and dynamics, such as quantifying the smoothness of a signal across the network using the Laplacian quadratic form [@problem_id:3302969].", "problem": "In computational systems biology, interaction or coupling strengths between molecular entities are often modeled as positive edge weights on an undirected graph, yielding a weighted network representation of system-level relationships. Consider a network of four enzymes labeled $\\{1,2,3,4\\}$ where the undirected edge between enzymes $i$ and $j$ has a positive coupling strength $w_{ij}$ with symmetry $w_{ij} = w_{ji} > 0$. The weighted adjacency matrix $A$ and the (weighted) degree matrix $D$ are foundational graph constructs: $A$ encodes the edge weights, and $D$ encodes the sum of incident weights at each node. The combinatorial Laplacian is defined by $L = D - A$ and is widely used to quantify diffusive coupling and smoothness of signals defined on nodes. Starting from the core definitions that for an undirected weighted graph $A$ is symmetric with $a_{ij} = w_{ij}$ for $i \\neq j$ and $a_{ii} = 0$, and $D$ is diagonal with $d_{i} = \\sum_{j=1}^{n} a_{ij}$, derive how $A$ and $D$ are constructed from $\\{w_{ij}\\}$ and hence construct $L$. Then, compute a scalar derived from $L$ by evaluating the quadratic form $x^{\\top} L x$ for a specified node signal $x$.\n\nThe biological network is given by the following undirected positive weights:\n- $w_{12} = 3.2$, $w_{13} = 0.7$, $w_{14} = 4.1$,\n- $w_{23} = 1.8$, $w_{24} = 3.3$,\n- $w_{34} = 2.5$,\n\nwith $w_{ij} = w_{ji}$ and $w_{ii} = 0$ for all $i$. Let the node signal (for instance, log-fold changes in enzyme activity) be $x = (1,\\,-1,\\,2,\\,0)^{\\top}$.\n\nTasks:\n1. Using the fundamental definitions for undirected weighted graphs, explicitly construct the weighted adjacency matrix $A$ and the degree matrix $D$.\n2. Compute the Laplacian $L = D - A$.\n3. Evaluate the quadratic form $x^{\\top} L x$.\n\nExpress your final answer as a single real number. No rounding is required; report the exact value.", "solution": "The problem statement is validated as scientifically grounded, well-posed, and objective. It provides a complete and consistent set of definitions and data from the field of computational systems biology and graph theory. The tasks are computationally straightforward and lead to a unique, verifiable result. We proceed with the solution.\n\nThe problem requires the construction of three matrices—the weighted adjacency matrix $A$, the degree matrix $D$, and the combinatorial Laplacian $L$—for a network of four enzymes, and the subsequent evaluation of a quadratic form $x^{\\top} L x$.\n\n**Task 1: Construct the weighted adjacency matrix $A$ and the degree matrix $D$.**\n\nThe weighted adjacency matrix $A$ for an undirected graph with $n$ nodes is an $n \\times n$ symmetric matrix. Its elements, $a_{ij}$, are defined based on the edge weights $w_{ij}$ between nodes $i$ and $j$. For $i \\neq j$, $a_{ij} = w_{ij}$. The diagonal elements are zero, i.e., $a_{ii} = 0$.\n\nGiven the network of $n=4$ enzymes and the provided weights:\n$w_{12} = 3.2$, $w_{13} = 0.7$, $w_{14} = 4.1$,\n$w_{23} = 1.8$, $w_{24} = 3.3$,\n$w_{34} = 2.5$.\nAnd the symmetry condition $w_{ij} = w_{ji}$.\n\nThe $4 \\times 4$ adjacency matrix $A$ is constructed as follows:\n$$ A = \\begin{pmatrix} a_{11} & a_{12} & a_{13} & a_{14} \\\\ a_{21} & a_{22} & a_{23} & a_{24} \\\\ a_{31} & a_{32} & a_{33} & a_{34} \\\\ a_{41} & a_{42} & a_{43} & a_{44} \\end{pmatrix} = \\begin{pmatrix} 0 & w_{12} & w_{13} & w_{14} \\\\ w_{21} & 0 & w_{23} & w_{24} \\\\ w_{31} & w_{32} & 0 & w_{34} \\\\ w_{41} & w_{42} & w_{43} & 0 \\end{pmatrix} $$\nSubstituting the given numerical values:\n$$ A = \\begin{pmatrix} 0 & 3.2 & 0.7 & 4.1 \\\\ 3.2 & 0 & 1.8 & 3.3 \\\\ 0.7 & 1.8 & 0 & 2.5 \\\\ 4.1 & 3.3 & 2.5 & 0 \\end{pmatrix} $$\n\nThe degree matrix $D$ is a diagonal matrix where each diagonal element $d_i$ (also denoted as $d_{ii}$) represents the degree of node $i$. For a weighted graph, the degree of a node is the sum of the weights of all edges incident to it. This can be calculated by summing the elements in the corresponding row (or column) of the adjacency matrix $A$:\n$$ d_i = \\sum_{j=1}^{n} a_{ij} $$\nThe degree matrix $D$ is then:\n$$ D = \\begin{pmatrix} d_1 & 0 & 0 & 0 \\\\ 0 & d_2 & 0 & 0 \\\\ 0 & 0 & d_3 & 0 \\\\ 0 & 0 & 0 & d_4 \\end{pmatrix} $$\nWe compute the individual degrees:\n$d_1 = a_{12} + a_{13} + a_{14} = 3.2 + 0.7 + 4.1 = 8.0$\n$d_2 = a_{21} + a_{23} + a_{24} = 3.2 + 1.8 + 3.3 = 8.3$\n$d_3 = a_{31} + a_{32} + a_{34} = 0.7 + 1.8 + 2.5 = 5.0$\n$d_4 = a_{41} + a_{42} + a_{43} = 4.1 + 3.3 + 2.5 = 9.9$\n\nThus, the degree matrix $D$ is:\n$$ D = \\begin{pmatrix} 8.0 & 0 & 0 & 0 \\\\ 0 & 8.3 & 0 & 0 \\\\ 0 & 0 & 5.0 & 0 \\\\ 0 & 0 & 0 & 9.9 \\end{pmatrix} $$\n\n**Task 2: Compute the Laplacian $L = D - A$.**\n\nThe combinatorial Laplacian matrix $L$ is defined as the difference between the degree matrix $D$ and the adjacency matrix $A$.\n$$ L = D - A $$\n$$ L = \\begin{pmatrix} 8.0 & 0 & 0 & 0 \\\\ 0 & 8.3 & 0 & 0 \\\\ 0 & 0 & 5.0 & 0 \\\\ 0 & 0 & 0 & 9.9 \\end{pmatrix} - \\begin{pmatrix} 0 & 3.2 & 0.7 & 4.1 \\\\ 3.2 & 0 & 1.8 & 3.3 \\\\ 0.7 & 1.8 & 0 & 2.5 \\\\ 4.1 & 3.3 & 2.5 & 0 \\end{pmatrix} $$\n$$ L = \\begin{pmatrix} 8.0 - 0 & 0 - 3.2 & 0 - 0.7 & 0 - 4.1 \\\\ 0 - 3.2 & 8.3 - 0 & 0 - 1.8 & 0 - 3.3 \\\\ 0 - 0.7 & 0 - 1.8 & 5.0 - 0 & 0 - 2.5 \\\\ 0 - 4.1 & 0 - 3.3 & 0 - 2.5 & 9.9 - 0 \\end{pmatrix} $$\n$$ L = \\begin{pmatrix} 8.0 & -3.2 & -0.7 & -4.1 \\\\ -3.2 & 8.3 & -1.8 & -3.3 \\\\ -0.7 & -1.8 & 5.0 & -2.5 \\\\ -4.1 & -3.3 & -2.5 & 9.9 \\end{pmatrix} $$\n\n**Task 3: Evaluate the quadratic form $x^{\\top} L x$.**\n\nThe node signal is given by the column vector $x = \\begin{pmatrix} 1 & -1 & 2 & 0 \\end{pmatrix}^{\\top}$. Its transpose is $x^{\\top} = \\begin{pmatrix} 1 & -1 & 2 & 0 \\end{pmatrix}$.\nThe quadratic form $x^{\\top} L x$ is computed by matrix multiplication. First, we compute the product $L x$:\n$$ L x = \\begin{pmatrix} 8.0 & -3.2 & -0.7 & -4.1 \\\\ -3.2 & 8.3 & -1.8 & -3.3 \\\\ -0.7 & -1.8 & 5.0 & -2.5 \\\\ -4.1 & -3.3 & -2.5 & 9.9 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ -1 \\\\ 2 \\\\ 0 \\end{pmatrix} $$\n$$ L x = \\begin{pmatrix} (8.0)(1) + (-3.2)(-1) + (-0.7)(2) + (-4.1)(0) \\\\ (-3.2)(1) + (8.3)(-1) + (-1.8)(2) + (-3.3)(0) \\\\ (-0.7)(1) + (-1.8)(-1) + (5.0)(2) + (-2.5)(0) \\\\ (-4.1)(1) + (-3.3)(-1) + (-2.5)(2) + (9.9)(0) \\end{pmatrix} $$\n$$ L x = \\begin{pmatrix} 8.0 + 3.2 - 1.4 \\\\ -3.2 - 8.3 - 3.6 \\\\ -0.7 + 1.8 + 10.0 \\\\ -4.1 + 3.3 - 5.0 \\end{pmatrix} = \\begin{pmatrix} 9.8 \\\\ -15.1 \\\\ 11.1 \\\\ -5.8 \\end{pmatrix} $$\nNext, we compute the dot product of $x^{\\top}$ with the resulting vector $L x$:\n$$ x^{\\top} L x = x^{\\top} (L x) = \\begin{pmatrix} 1 & -1 & 2 & 0 \\end{pmatrix} \\begin{pmatrix} 9.8 \\\\ -15.1 \\\\ 11.1 \\\\ -5.8 \\end{pmatrix} $$\n$$ x^{\\top} L x = (1)(9.8) + (-1)(-15.1) + (2)(11.1) + (0)(-5.8) $$\n$$ x^{\\top} L x = 9.8 + 15.1 + 22.2 + 0 $$\n$$ x^{\\top} L x = 24.9 + 22.2 = 47.1 $$\nThe value of the quadratic form is $47.1$.", "answer": "$$\n\\boxed{47.1}\n$$", "id": "3302969"}, {"introduction": "Many biological systems, such as gene regulatory cascades, are inherently directional. We model these using directed graphs, where edges represent influence or precedence. When these networks lack feedback loops, they form Directed Acyclic Graphs (DAGs), which possess a clear hierarchical structure. This exercise explores topological sorting, a fundamental algorithm for uncovering this hierarchy and understanding the sequential constraints it imposes on biological processes [@problem_id:3303015].", "problem": "In a gene regulatory network used in computational systems biology, genes and transcription factors can be represented as vertices of a directed graph, where a directed edge from vertex $i$ to vertex $j$ signifies that the product of gene $i$ regulates the expression of gene $j$. Consider the following model assumptions as the fundamental base: gene regulation proceeds according to the Central Dogma of molecular biology (deoxyribonucleic acid to ribonucleic acid to protein), regulatory influence propagates along directed edges, and a directed cycle corresponds to a feedback loop. A directed graph with no directed cycles is a directed acyclic graph (DAG), and such graphs admit a topological sorting, which lists vertices so that all directed edges point from earlier to later positions.\n\nYou are given a small directed gene regulatory network over the vertex set $V=\\{A,B,C,D,E,F\\}$ representing transcriptional regulation, where the direction of edges encodes precedence constraints in regulatory influence. The weighted adjacency matrix is provided, but for the purposes of hierarchical ordering, only the topology (location of nonzero entries) matters. The vertices are ordered as $(A,B,C,D,E,F)$ and the adjacency matrix $M$ is\n$$\nM \\;=\\; \\begin{pmatrix}\n0 & 1 & 1 & 0 & 0 & 0 \\\\\n0 & 0 & 0 & 1 & 1 & 0 \\\\\n0 & 0 & 0 & 0 & 1 & 1 \\\\\n0 & 0 & 0 & 0 & 0 & 1 \\\\\n0 & 0 & 0 & 0 & 0 & 1 \\\\\n0 & 0 & 0 & 0 & 0 & 0\n\\end{pmatrix}.\n$$\nAn entry $M_{ij}=1$ indicates a directed edge $i\\to j$ and encodes that $i$ must precede $j$ in any valid hierarchical ordering; an entry $M_{ij}=0$ indicates the absence of a direct regulatory edge. Assume all nonzero entries correspond to positive weights whose magnitudes are irrelevant for precedence.\n\nTasks:\n1. Starting only from the definitions of a directed graph, directed acyclic graph, partial order, and topological sorting, explain why topological sorting of this network captures hierarchical regulation in the absence of feedback loops, and why the existence of such a sorting is equivalent to acyclicity in the directed graph.\n2. Using the given adjacency matrix $M$, verify that the directed graph is acyclic and compute:\n   - one valid topological ordering of $V$ consistent with $M$, and\n   - the total number of distinct valid topological orderings (linear extensions) of the precedence constraints encoded by $M$.\n\nAnswer specification: For the purposes of grading, report only the total number of valid topological orderings as a single integer without units. Do not round. You may find it helpful to produce a valid ordering as an intermediate step, but do not include it in the final answer.", "solution": "The problem is divided into a conceptual explanation and a computational task involving a specific directed graph.\n\n**Part 1: Conceptual Framework**\n\nA directed graph, $G=(V, E)$, consists of a set of vertices $V$ and a set of edges $E$, where each edge is an ordered pair of vertices $(u, v)$ representing a directed connection from $u$ to $v$. In the context of a gene regulatory network, vertices represent genes and a directed edge $(i, j)$ means the product of gene $i$ regulates gene $j$. This establishes a precedence constraint: the regulatory action of $i$ must logically precede its effect on $j$.\n\nThe collection of all such precedence constraints can be extended by transitivity. If there is a directed path from vertex $u$ to vertex $v$, we say $u$ is an ancestor of $v$, or $u$ precedes $v$, denoted $u \\prec v$. This precedence relation forms a strict partial order if and only if the graph is a Directed Acyclic Graph (DAG). A strict partial order is a binary relation that is irreflexive, asymmetric, and transitive.\n1.  **Irreflexivity**: For any vertex $v$, $v \\not\\prec v$. This means there is no path from $v$ back to itself, which is the definition of a graph having no cycles of length $1$ or greater.\n2.  **Asymmetry**: If $u \\prec v$, then $v \\not\\prec u$. If there were a path from $u$ to $v$ and a path from $v$ to $u$, their concatenation would form a directed cycle. Thus, asymmetry is a direct consequence of acyclicity.\n3.  **Transitivity**: If $u \\prec v$ and $v \\prec w$, then $u \\prec w$. If there's a path from $u$ to $v$ and one from $v$ to $w$, concatenating them forms a path from $u$ to $w$. This is inherent to the definition of path-based precedence.\n\nThe problem states that a directed cycle corresponds to a feedback loop. The absence of feedback loops is therefore equivalent to the graph being acyclic. In such a system, regulation is hierarchical: there are \"upstream\" regulators and \"downstream\" targets without the targets feeding back to influence their own regulators. This hierarchical structure is precisely what is captured by the partial order relation $\\prec$ on a DAG.\n\nA topological sorting of a directed graph is a linear ordering of all its vertices such that for every directed edge from vertex $u$ to vertex $v$, $u$ comes before $v$ in the ordering. Such an ordering is a \"flattening\" of the partial order into a total order, representing one possible valid sequence for the unfolding of regulatory events.\n\nThe existence of a topological sorting is equivalent to the graph being a DAG.\n-   **(DAG $\\implies$ Topological Sort)**: A finite DAG must have at least one vertex with an in-degree of $0$. Such a vertex can be placed first in the ordering. Removing this vertex and its outgoing edges results in a smaller subgraph which is also a DAG. This process can be repeated, selecting a vertex of in-degree $0$ from the remaining graph at each step, until all vertices are ordered. This constructive algorithm (Kahn's algorithm) always succeeds for a DAG.\n-   **(Topological Sort $\\implies$ DAG)**: Assume a topological sort exists. Let the ordering be $v_1, v_2, \\ldots, v_n$. For any edge $(v_i, v_j)$, the definition of the sort requires $i < j$. Any directed path $v_{k_1} \\to v_{k_2} \\to \\ldots \\to v_{k_m}$ must therefore satisfy $k_1 < k_2 < \\ldots < k_m$. A cycle is a path that starts and ends at the same vertex, say $v_i \\to \\ldots \\to v_i$. This would imply an index sequence $i < \\ldots < i$, a contradiction. Therefore, no cycles can exist.\n\nThus, a topological sort represents a valid temporal or hierarchical sequence of gene expression events, and its existence is a guarantee that the network is free of feedback loops.\n\n**Part 2: Analysis of the Given Network**\n\nThe vertex set is $V=\\{A,B,C,D,E,F\\}$. The adjacency matrix $M$ defines the edges:\n$A \\to B$, $A \\to C$\n$B \\to D$, $B \\to E$\n$C \\to E$, $C \\to F$\n$D \\to F$\n$E \\to F$\n\n**Verification of Acyclicity and finding one Topological Ordering**\nWe use Kahn's algorithm. We first compute the in-degrees of all vertices:\n-   $\\text{in-degree}(A) = 0$\n-   $\\text{in-degree}(B) = 1$\n-   $\\text{in-degree}(C) = 1$\n-   $\\text{in-degree}(D) = 1$\n-   $\\text{in-degree}(E) = 2$\n-   $\\text{in-degree}(F) = 3$\n\n1.  Initialize a queue with all vertices of in-degree $0$: $Q = [A]$.\n2.  Dequeue $A$. Add to sorted list $L$: $L=(A)$. Decrease in-degree of its neighbors ($B$, $C$).\n    -   $\\text{in-degree}(B)$ becomes $0$. Enqueue $B$.\n    -   $\\text{in-degree}(C)$ becomes $0$. Enqueue $C$.\n    -   $Q = [B, C]$.\n3.  Dequeue $B$. $L=(A, B)$. Decrease in-degree of its neighbors ($D$, $E$).\n    -   $\\text{in-degree}(D)$ becomes $0$. Enqueue $D$.\n    -   $\\text{in-degree}(E)$ becomes $2-1=1$.\n    -   $Q = [C, D]$.\n4.  Dequeue $C$. $L=(A, B, C)$. Decrease in-degree of its neighbors ($E$, $F$).\n    -   $\\text{in-degree}(E)$ becomes $1-1=0$. Enqueue $E$.\n    -   $\\text{in-degree}(F)$ becomes $3-1=2$.\n    -   $Q = [D, E]$.\n5.  Dequeue $D$. $L=(A, B, C, D)$. Decrease in-degree of its neighbor ($F$).\n    -   $\\text{in-degree}(F)$ becomes $2-1=1$.\n    -   $Q = [E]$.\n6.  Dequeue $E$. $L=(A, B, C, D, E)$. Decrease in-degree of its neighbor ($F$).\n    -   $\\text{in-degree}(F)$ becomes $1-1=0$. Enqueue $F$.\n    -   $Q = [F]$.\n7.  Dequeue $F$. $L=(A, B, C, D, E, F)$. $F$ has no neighbors.\n    -   $Q = []$.\n\nThe algorithm terminates, and the sorted list $L$ contains all $6$ vertices. This verifies that the graph is a DAG. One valid topological ordering is $(A, B, C, D, E, F)$.\n\n**Computation of the Total Number of Distinct Topological Orderings**\n\nThe number of distinct topological orderings can be calculated by considering the number of choices available at each step of the sorting process. This is equivalent to enumerating all paths in a decision-tree representation of Kahn's algorithm.\n\n1.  **Position 1**: The only vertex with in-degree $0$ is $A$. There is only $1$ choice.\n    -   Order: $(A, \\ldots)$. Available for next step: $\\{B, C\\}$.\n\n2.  **Position 2**: We can choose either $B$ or $C$. This creates two main branches.\n\n    -   **Branch 1: Choose $B$ for Position 2.**\n        -   Order prefix: $(A, B)$.\n        -   Now, the set of available vertices (in-degree $0$ in the remaining graph) is $\\{C, D\\}$.\n        -   **Sub-branch 1.1: Choose $C$ for Position 3.**\n            -   Order prefix: $(A, B, C)$.\n            -   Available set: $\\{D, E\\}$ (since $E$'s predecessors $B$ and $C$ are placed).\n            -   For positions $4$ and $5$, we can place $D$ and $E$ in any order, as they are now independent (no edge between them). This gives $2! = 2$ permutations: $(D, E)$ or $(E, D)$.\n            -   Position $6$ must be $F$.\n            -   This sub-branch yields $2$ orderings: $(A, B, C, D, E, F)$ and $(A, B, C, E, D, F)$.\n        -   **Sub-branch 1.2: Choose $D$ for Position 3.**\n            -   Order prefix: $(A, B, D)$.\n            -   The only available vertex is $C$ ( $E$ still needs $C$; $F$ needs $C$, $D$, $E$).\n            -   **Position 4**: Must be $C$. Order prefix: $(A, B, D, C)$.\n            -   Now $E$ is available (predecessors $B, C$ are placed).\n            -   **Position 5**: Must be $E$. Order prefix: $(A, B, D, C, E)$.\n            -   **Position 6**: Must be $F$.\n            -   This sub-branch yields $1$ ordering: $(A, B, D, C, E, F)$.\n        -   Total for Branch 1 (starting with $A, B$): $2 + 1 = 3$ orderings.\n\n    -   **Branch 2: Choose $C$ for Position 2.**\n        -   Order prefix: $(A, C)$.\n        -   The only available vertex is $B$ ($D$ and $E$ still need $B$).\n        -   **Position 3**: Must be $B$. Order prefix: $(A, C, B)$.\n        -   The set of available vertices is now $\\{D, E\\}$.\n        -   This situation is symmetric to Sub-branch 1.1. We have placed $\\{A, B, C\\}$ and must now order $\\{D, E, F\\}$ where $D \\prec F$ and $E \\prec F$. The available choices are $D$ and $E$, which are independent.\n        -   We can place them in $2! = 2$ ways: $(D,E)$ or $(E,D)$, followed by $F$.\n        -   This branch yields $2$ orderings: $(A, C, B, D, E, F)$ and $(A, C, B, E, D, F)$.\n        -   Total for Branch 2 (starting with $A, C$): $2$ orderings.\n\n3.  **Total Count**: The total number of distinct topological orderings is the sum of the counts from all initial branches: $3 + 2 = 5$.\n\nThe $5$ distinct valid topological orderings are:\n-   $(A,B,C,D,E,F)$\n-   $(A,B,C,E,D,F)$\n-   $(A,B,D,C,E,F)$\n-   $(A,C,B,D,E,F)$\n-   $(A,C,B,E,D,F)$\nThe total number is $5$.", "answer": "$$\n\\boxed{5}\n$$", "id": "3303015"}, {"introduction": "A central goal of systems biology is to understand and control the behavior of complex biological networks. This advanced practice integrates graph theory with dynamical systems to analyze network stability and design interventions. By investigating concepts such as the feedback vertex set and the spectral radius of the weighted adjacency matrix, you will learn how to identify the structural origins of feedback and predict how targeted node removals can dismantle pathological cycles to control system dynamics, a task with direct relevance to therapeutic strategy [@problem_id:3303023].", "problem": "You are given weighted directed graphs representing linearized signaling networks, where each node represents a signaling entity and each directed edge from node $i$ to node $j$ has a nonnegative weight $w_{ij}$ interpreted as a phospho-transfer rate from $i$ to $j$. For such a graph on $n$ nodes, define the weighted adjacency matrix $A \\in \\mathbb{R}_{\\ge 0}^{n \\times n}$ by $A_{ij} = w_{ij}$. Consider the linear discrete-time approximation $x_{t+1} = A x_t$ of signal propagation near a fixed point, where $x_t \\in \\mathbb{R}^n$ denotes activity levels. The spectral radius $\\rho(A)$ of $A$ is defined as $\\rho(A) = \\max\\{|\\lambda| : \\lambda \\in \\mathbb{C} \\text{ is an eigenvalue of } A\\}$. It quantifies the asymptotic amplification factor per time step. If $\\rho(A) < 1$, linearized activity decays; if $\\rho(A) > 1$, it grows; if $\\rho(A) = 0$, the matrix is nilpotent.\n\nA feedback vertex set (FVS) is a subset of nodes whose removal destroys all directed cycles. Formally, for a directed graph $G = (V,E)$ with $|V| = n$, a subset $S \\subseteq V$ is a feedback vertex set if the induced subgraph on $V \\setminus S$ is a directed acyclic graph (DAG). A minimum feedback vertex set (minimum FVS) is an FVS of smallest possible cardinality. In a weighted directed graph with nonnegative weights, removing a set $S$ of nodes corresponds to forming the principal submatrix $A[V \\setminus S]$ by deleting the rows and columns indexed by $S$ in $A$. For any DAG $H$, its adjacency matrix $A_H$ is strictly upper triangular under a suitable topological ordering and thus nilpotent, implying $\\rho(A_H) = 0$.\n\nYour task is to implement a program that, for each test case, performs the following computations from first principles:\n\n1) Compute a minimum feedback vertex set $S^\\star$ by enumerating node subsets and testing acyclicity of the induced unweighted structure, where an edge $i \\to j$ is considered present if and only if $w_{ij} > 0$. Among all minimum-cardinality FVSs, report the lexicographically smallest one when nodes are labeled by integers in ascending order starting at $0$.\n\n2) Given an intervention budget $b \\in \\mathbb{Z}_{\\ge 0}$, compute a subset $T \\subseteq V$ with $|T| \\le b$ that minimizes $\\rho(A[V \\setminus T])$. If multiple subsets achieve the same minimal spectral radius under the budget, choose among them the one with the smallest cardinality; if there remains a tie, pick the lexicographically smallest subset. For empty matrices (all nodes removed), define $\\rho(\\cdot) = 0$.\n\nImplementation details and precision requirements:\n\n- Nodes are labeled by integers $0,1,\\dots,n-1$.\n\n- Consider an edge present if and only if its weight $w_{ij}$ satisfies $w_{ij} > 0$; do not introduce any other thresholding.\n\n- Spectral radii must be computed numerically from eigenvalues of the real nonnegative matrices and then rounded to six decimal places using conventional rounding.\n\n- All outputs that are floats must be rounded as above. Integers and lists of integers must be exact.\n\n- When checking acyclicity, you must test the unweighted directed structure induced by positive weights using, for example, a topological sort criterion.\n\nTest suite:\n\nProvide code that solves the tasks for the following three test cases. For each case, specify the node set $V = \\{0,1,\\dots,n-1\\}$ and weighted edges $(i,j,w_{ij})$.\n\n- Test case A:\n  - Nodes: $V = \\{0,1,2,3\\}$.\n  - Edges with weights:\n    - $(0,1,0.9)$, $(1,0,0.8)$,\n    - $(2,3,1.1)$, $(3,2,0.7)$.\n  - Budgets: $b_1 = 1$, $b_2 = 2$.\n\n- Test case B:\n  - Nodes: $V = \\{0,1,2,3,4\\}$.\n  - Edges with weights:\n    - $(0,1,0.5)$, $(1,2,1.2)$, $(2,0,0.6)$, $(2,3,0.4)$, $(3,4,0.3)$.\n  - Budgets: $b_1 = 0$, $b_2 = 1$.\n\n- Test case C:\n  - Nodes: $V = \\{0,1,2,3,4\\}$.\n  - Edges with weights:\n    - $(0,1,0.2)$, $(0,2,0.1)$, $(1,3,0.4)$, $(2,3,0.3)$, $(3,4,0.5)$.\n  - Budgets: $b_1 = 0$, $b_2 = 1$.\n\nFinal output format:\n\nFor each test case, your program must produce a list with six entries:\n- the minimum FVS size (an integer),\n- one minimum FVS (a list of integers, lexicographically smallest among minima),\n- the minimal spectral radius under budget $b_1$ (a float rounded to six decimals),\n- the chosen subset for $b_1$ (a list of integers),\n- the minimal spectral radius under budget $b_2$ (a float rounded to six decimals),\n- the chosen subset for $b_2$ (a list of integers).\n\nAggregate the per-test-case results into a single list in the same order A, B, C. Your program should produce a single line of output containing the results as a list literal, for example:\n[[minFVS_A,[...],rhoA_b1,[...],rhoA_b2,[...]],[minFVS_B,[...],rhoB_b1,[...],rhoB_b2,[...]],[minFVS_C,[...],rhoC_b1,[...],rhoC_b2,[...]]]", "solution": "The problem statement has been meticulously validated and is determined to be sound. It is scientifically grounded in the principles of linear systems theory and graph theory as applied to computational systems biology. The problem is well-posed, with clear objectives, constraints, and deterministic tie-breaking rules, ensuring a unique solution. The provided test cases are computationally feasible using the specified enumeration-based approach, given the small size of the graphs.\n\nThe solution is divided into two primary tasks: finding a minimum feedback vertex set (FVS) and optimizing an intervention strategy to minimize the spectral radius of the network's adjacency matrix.\n\n**Task 1: Minimum Feedback Vertex Set (FVS)**\n\nThe goal is to find a minimum feedback vertex set $S^\\star$, which is a subset of nodes $S \\subseteq V$ of the smallest possible cardinality such that its removal renders the graph acyclic. The problem specifies that among all FVSs of minimum size, the one that is lexicographically smallest should be reported.\n\nThe algorithm proceeds by systematically searching for an FVS, prioritizing minimum cardinality and then lexicographical order.\n$1$. We iterate through possible FVS sizes $k$, starting from $k=0$ up to the total number of nodes $n = |V|$.\n$2$. For each size $k$, we generate all possible subsets $S \\subseteq V$ of cardinality $|S|=k$. These subsets are generated in lexicographical order.\n$3$. For each candidate subset $S$, we test if it is a valid FVS. This is done by constructing the induced subgraph on the remaining vertices, $G[V \\setminus S]$, and checking if this subgraph is a Directed Acyclic Graph (DAG).\n$4$. The first subset $S$ that is found to be an FVS is guaranteed to be of minimum cardinality (because we iterate on $k$ upwards) and lexicographically smallest among all minimum FVSs (because we generate subsets in lexicographical order for a fixed $k$).\n\nTo check if a graph is a DAG, we employ Kahn's algorithm, a standard method based on topological sorting. For a given subgraph on a set of nodes $V'$, the algorithm works as follows:\na. Compute the in-degree for every node $v \\in V'$. The in-degree of a node is the number of incoming edges from other nodes within $V'$.\nb. Initialize a queue with all nodes in $V'$ that have an in-degree of $0$.\nc. Maintain a count of visited nodes, initialized to $0$.\nd. While the queue is not empty, dequeue a node $u$, increment the visited nodes count, and for each neighbor $v$ of $u$ that is in $V'$, decrement the in-degree of $v$. If the in-degree of $v$ becomes $0$, enqueue $v$.\ne. After the loop terminates, if the count of visited nodes equals the number of nodes in the subgraph, $|V'|$, the subgraph is a DAG. Otherwise, it contains at least one cycle.\n\nThe unweighted graph structure for this task is defined by the rule that an edge from $i$ to $j$ exists if and only if the weight $w_{ij} > 0$.\n\n**Task 2: Optimal Intervention to Minimize Spectral Radius**\n\nThe second task is to find a subset of nodes $T \\subseteq V$ to remove, subject to a budget constraint $|T| \\le b$, such that the spectral radius $\\rho(A[V \\setminus T])$ is minimized. The spectral radius $\\rho(M)$ of a matrix $M$ is the maximum absolute value among its eigenvalues, $\\rho(M) = \\max_i |\\lambda_i|$. For a non-negative matrix, the Perron-Frobenius theorem guarantees that $\\rho(M)$ is a non-negative real eigenvalue.\n\nThe tie-breaking rules require selecting the subset $T$ with the smallest cardinality $|T|$ among those that achieve the minimum spectral radius; if a tie persists, the lexicographically smallest subset is chosen.\n\nThis optimization problem is solved by enumerating all valid candidate subsets $T$ and comparing the resulting spectral radii. The search is organized to naturally respect the tie-breaking rules:\n$1$. We iterate through possible subset sizes $k$ for the set $T$, from $k=0$ up to the budget $b$. This prioritizes smaller cardinality.\n$2$. For each size $k$, we generate all subsets $T \\subseteq V$ of cardinality $|T|=k$ in lexicographical order.\n$3$. For each subset $T$, we define the set of remaining nodes $V' = V \\setminus T$. We then construct the principal submatrix $A[V']$ by selecting the rows and columns of the original adjacency matrix $A$ that correspond to the nodes in $V'$.\n$4$. We compute the eigenvalues of $A[V']$ numerically. If $V'$ is empty, the resulting matrix is empty, and its spectral radius is defined as $0$. Otherwise, we use standard numerical libraries to find the eigenvalues $\\lambda_i$.\n$5$. The spectral radius is calculated as $\\rho(A[V']) = \\max_i |\\lambda_i|$ and rounded to six decimal places as specified.\n$6$. We maintain a variable for the minimum spectral radius found so far, $\\rho_{min}$, and the corresponding optimal subset, $T_{opt}$. The first time we compute a spectral radius $\\rho$ for a subset $T$, we set $\\rho_{min} = \\rho$ and $T_{opt} = T$. Subsequently, we only update these if we find a new subset $T'$ that yields a strictly smaller spectral radius, $\\rho' < \\rho_{min}$. Because of the ordered enumeration (by size, then lexicographically), this simple update rule is sufficient to guarantee that the final $T_{opt}$ satisfies all tie-breaking conditions.\n\nThe implementation will use `numpy` for linear algebra operations, including matrix creation and eigenvalue computation, and `itertools.combinations` for efficient and ordered generation of subsets.", "answer": "```\n[[2,[0,2],0.848528,[2],0.0,[0,2]],[1,[0],0.711386,[],0.0,[0]],[0,[],0.0,[],0.0,[]]]\n```", "id": "3303023"}]}