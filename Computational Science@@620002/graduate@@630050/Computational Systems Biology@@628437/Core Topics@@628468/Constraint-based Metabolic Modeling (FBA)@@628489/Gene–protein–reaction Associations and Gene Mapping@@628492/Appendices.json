{"hands_on_practices": [{"introduction": "Gene–Protein–Reaction (GPR) associations form the logical blueprint connecting a cell's genotype to its metabolic capabilities. To understand this connection, we must first learn to parse the language of GPRs, which uses Boolean logic to describe how gene products combine to form functional enzymes. This practice [@problem_id:3315734] will guide you through converting a GPR into its Disjunctive Normal Form (DNF) to identify all minimal sets of genes that can enable a reaction, and then determining the minimal gene deletion strategies that can shut it down, a foundational skill for analyzing genetic robustness and synthetic lethality.", "problem": "In genome-scale metabolic modeling, gene–protein–reaction (GPR) rules encode the logical relationship between gene products and enzyme complexes mediating reactions. The canonical mapping is: genes that encode alternative isoenzymes are connected by logical disjunction ($\\lor$), and genes that encode required subunits of a protein complex are connected by logical conjunction ($\\land$). A reaction is functionally enabled if and only if its GPR Boolean formula evaluates to true. Disjunctive normal form (DNF) is a logical expression written as a disjunction of conjunctions, where each conjunction corresponds to a distinct minimal catalytically competent gene set.\n\nConsider a reaction with the GPR\n$$(g_1 \\lor g_2) \\land (g_3 \\lor g_4),$$\nwhere $g_i$ denotes the presence of a functional gene product for gene $i$. Starting from the above canonical mapping rules and Boolean algebra (associativity, commutativity, distributivity, identity, and annihilator laws), do the following:\n\n1. Expand the GPR into disjunctive normal form (DNF), interpreting each conjunction as a minimal catalytically competent gene set that can enable the reaction.\n2. Using the principle that blocking a reaction requires deleting genes so that every DNF conjunction is disrupted, enumerate all minimal gene deletion sets that block the reaction. A gene deletion set is minimal if removing any proper subset of its genes fails to block the reaction.\n\nProvide as your final answer the total number of minimal gene deletion sets that block the reaction. Express your final answer as a single integer. No rounding is required.", "solution": "The problem requires us to analyze a given gene–protein–reaction (GPR) association, first by determining the minimal sets of genes that can enable the reaction, and second, by determining the minimal sets of gene deletions that will block it.\n\nThe GPR for the reaction is given as:\n$$ (g_1 \\lor g_2) \\land (g_3 \\lor g_4) $$\nHere, $g_i$ is a Boolean variable representing the presence ($g_i = \\text{true}$) or absence ($g_i = \\text{false}$) of a functional gene product from gene $i$. The reaction is enabled if this expression evaluates to true.\n\n### Part 1: Expansion to Disjunctive Normal Form (DNF)\n\nThe first step is to expand the GPR into disjunctive normal form (DNF). A DNF expression is a disjunction (OR) of conjunctions (ANDs). Each conjunction represents a minimal set of genes that, if all are functional, is sufficient to catalyze the reaction. These are the \"minimal catalytically competent gene sets\".\n\nWe start with the given GPR expression:\n$$ R = (g_1 \\lor g_2) \\land (g_3 \\lor g_4) $$\nWe apply the distributive law of Boolean algebra, which states that $ (A \\lor B) \\land C = (A \\land C) \\lor (B \\land C) $. We can extend this to $ (A \\lor B) \\land (C \\lor D) $. Let $X = (g_1 \\lor g_2)$. The expression becomes $X \\land (g_3 \\lor g_4) $.\nApplying the distributive law:\n$$ X \\land (g_3 \\lor g_4) = (X \\land g_3) \\lor (X \\land g_4) $$\nNow, we substitute $X = (g_1 \\lor g_2)$ back into the expression:\n$$ ((g_1 \\lor g_2) \\land g_3) \\lor ((g_1 \\lor g_2) \\land g_4) $$\nWe apply the distributive law again to each of the two terms:\n$$ ( (g_1 \\land g_3) \\lor (g_2 \\land g_3) ) \\lor ( (g_1 \\land g_4) \\lor (g_2 \\land g_4) ) $$\nBy the associativity of $\\lor$, we can remove the outer parentheses to obtain the DNF:\n$$ R_{DNF} = (g_1 \\land g_3) \\lor (g_2 \\land g_3) \\lor (g_1 \\land g_4) \\lor (g_2 \\land g_4) $$\nThe order of terms does not matter due to the commutativity of $\\lor$. Each term in this disjunction is a conjunction representing a minimal catalytically competent gene set. These sets are:\n1.  $\\{g_1, g_3\\}$\n2.  $\\{g_2, g_3\\}$\n3.  $\\{g_1, g_4\\}$\n4.  $\\{g_2, g_4\\}$\nThe presence of all genes in any one of these four sets is sufficient to enable the reaction.\n\n### Part 2: Enumeration of Minimal Gene Deletion Sets\n\nThe second step is to find all minimal gene deletion sets that block the reaction. According to the problem statement, blocking the reaction requires deleting genes such that every DNF conjunction is disrupted. A DNF conjunction like $(g_i \\land g_j)$ is disrupted if at least one of its constituent gene products is absent (i.e., the corresponding gene is deleted).\n\nLet $d_i$ be a Boolean variable that is true if gene $g_i$ is deleted (which means $g_i$ is false). To disrupt the DNF we derived, every conjunction must be made false.\nLet the four conjunctions be $C_1, C_2, C_3, C_4$:\n- $C_1 = g_1 \\land g_3$\n- $C_2 = g_2 \\land g_3$\n- $C_3 = g_1 \\land g_4$\n- $C_4 = g_2 \\land g_4$\n\nFor the reaction to be blocked, the DNF expression must be false, which means every term must be false: $C_1$ must be false AND $C_2$ must be false AND $C_3$ must be false AND $C_4$ must be false.\nThis can be written as the condition that $\\neg C_1 \\land \\neg C_2 \\land \\neg C_3 \\land \\neg C_4$ must be true.\nUsing De Morgan's laws on each term, where $\\neg(A \\land B) = \\neg A \\lor \\neg B$:\n- $\\neg C_1 = \\neg(g_1 \\land g_3) = \\neg g_1 \\lor \\neg g_3 \\equiv d_1 \\lor d_3$\n- $\\neg C_2 = \\neg(g_2 \\land g_3) = \\neg g_2 \\lor \\neg g_3 \\equiv d_2 \\lor d_3$\n- $\\neg C_3 = \\neg(g_1 \\land g_4) = \\neg g_1 \\lor \\neg g_4 \\equiv d_1 \\lor d_4$\n- $\\neg C_4 = \\neg(g_2 \\land g_4) = \\neg g_2 \\lor \\neg g_4 \\equiv d_2 \\lor d_4$\n\nThe condition for blocking the reaction is that the conjunction of these disruption conditions must be true:\n$$ (d_1 \\lor d_3) \\land (d_2 \\lor d_3) \\land (d_1 \\lor d_4) \\land (d_2 \\lor d_4) $$\nThis expression is in Conjunctive Normal Form (CNF). To find the minimal sets of deletions, we convert this expression into its DNF. Each term in the resulting DNF will correspond to a minimal gene deletion set.\n\nWe can simplify this expression by grouping terms using the commutative and associative laws:\n$$ [ (d_1 \\lor d_3) \\land (d_2 \\lor d_3) ] \\land [ (d_1 \\lor d_4) \\land (d_2 \\lor d_4) ] $$\nWe apply the distributive law $(A \\lor C) \\land (B \\lor C) = (A \\land B) \\lor C$ to each bracketed part:\n- For the first bracket: Let $A=d_1$, $B=d_2$, $C=d_3$. We get $(d_1 \\land d_2) \\lor d_3$.\n- For the second bracket: Let $A=d_1$, $B=d_2$, $C=d_4$. We get $(d_1 \\land d_2) \\lor d_4$.\n\nSubstituting these back into the expression:\n$$ ( (d_1 \\land d_2) \\lor d_3 ) \\land ( (d_1 \\land d_2) \\lor d_4 ) $$\nLet $X = (d_1 \\land d_2)$. The expression becomes $(X \\lor d_3) \\land (X \\lor d_4)$.\nWe apply the distributive law $(A \\lor B) \\land (A \\lor C) = A \\lor (B \\land C)$:\n$$ X \\lor (d_3 \\land d_4) $$\nFinally, we substitute $X = (d_1 \\land d_2)$ back:\n$$ (d_1 \\land d_2) \\lor (d_3 \\land d_4) $$\nThis is the DNF for the blocking condition. Each conjunction represents a minimal set of gene deletions that guarantees the reaction is blocked. The two terms correspond to two minimal deletion sets:\n1.  From $d_1 \\land d_2$: The set of deleted genes is $\\{g_1, g_2\\}$.\n2.  From $d_3 \\land d_4$: The set of deleted genes is $\\{g_3, g_4\\}$.\n\nThese two sets are minimal. For example, for the set $\\{g_1, g_2\\}$, if we remove $g_1$ (i.e., only delete $g_2$), the GPR becomes $(g_1 \\lor 0) \\land (g_3 \\lor g_4) = g_1 \\land (g_3 \\lor g_4)$, which is not necessarily false. A symmetric argument holds for removing $g_2$. The same logic applies to the set $\\{g_3, g_4\\}$.\n\nThus, there are two minimal gene deletion sets that block the reaction. The total number of such sets is $2$.", "answer": "$$\\boxed{2}$$", "id": "3315734"}, {"introduction": "While Boolean logic tells us *if* a reaction can be active, quantitative models are needed to predict *how active* it can be based on gene expression levels. This exercise [@problem_id:3315645] introduces a widely-used method to map continuous gene expression data onto the maximum capacity of a reaction, using the `min` function for protein complexes and `sum` for isoenzymes. By working through a gene knockout and compensatory upregulation scenario, you will gain hands-on experience in quantitatively linking genetic states to metabolic phenotypes.", "problem": "A gene–protein–reaction association (GPR) encodes the logical relationship between genes and the protein complexes or isoenzymes that catalyze a biochemical reaction. In a constraint-based model, the Central Dogma of molecular biology (DNA transcribed to RNA, translated to protein) motivates a mapping from gene expression to enzyme abundance, and from enzyme abundance to reaction capacity. Consider the GPR for a reaction:\n$$(g_1 \\land g_3) \\lor (g_2 \\land g_4) \\lor g_5,$$\nwhich states that the reaction can be catalyzed by either the protein complex formed by gene products of $g_1$ and $g_3$, or the complex formed by gene products of $g_2$ and $g_4$, or the isoenzyme encoded by $g_5$ alone.\n\nAdopt the following widely used mapping principles: for a conjunctive complex $g_i \\land g_j$, the effective complex abundance is the limiting subunit abundance, modeled as the minimum of the corresponding gene expression levels; for disjunctive isoenzymes $A_1 \\lor A_2 \\lor \\dots$, the effective enzyme abundance is the sum of the abundances of each alternative. Let the reaction’s maximum capacity be proportional to the total effective enzyme abundance, with proportionality constant $k$:\n$$V_{\\max} = k \\times \\big(\\min(E_1,E_3) + \\min(E_2,E_4) + E_5\\big),$$\nwhere $E_i$ denotes the expression level of gene $g_i$.\n\nSuppose the baseline (pre-knockout) gene expression levels (in consistent arbitrary units) are:\n$$E_1 = 4,\\quad E_2 = 6,\\quad E_3 = 10,\\quad E_4 = 3,\\quad E_5 = 2,$$\nand the proportionality constant is $k = 2$. The model requires maintaining at least a fraction $\\rho = 0.75$ of a baseline flux $F_{\\mathrm{baseline}} = 12$ for viability, that is, the target capacity is\n$$F_{\\mathrm{target}} = \\rho \\times F_{\\mathrm{baseline}}.$$\n\nA double knockout of $g_1$ and $g_2$ is introduced, which sets $E_1 = 0$ and $E_2 = 0$. To compensate, $g_5$ can be upregulated by a multiplicative fold-change $\\alpha$, so its post-knockout expression becomes $E_5' = \\alpha E_5$, while $E_3$ and $E_4$ remain at their baseline values.\n\nUsing the above assumptions, determine whether the reaction remains active under the double knockout and compute the minimal fold-change $\\alpha$ required so that the post-knockout maximum capacity satisfies $V_{\\max}^{\\mathrm{KO}} \\ge F_{\\mathrm{target}}$. Report the minimal $\\alpha$ as your final numeric answer, rounded to four significant figures. No units are required for the final fold-change.", "solution": "The problem asks to calculate the minimum upregulation fold-change ($\\alpha$) for gene $g_5$ to compensate for a double knockout of $g_1$ and $g_2$ and maintain a target reaction capacity.\n\nFirst, we calculate the target reaction capacity, $F_{\\mathrm{target}}$, required for viability. Given the viability fraction threshold $\\rho = 0.75$ and a baseline flux $F_{\\mathrm{baseline}} = 12$, the target capacity is:\n$$F_{\\mathrm{target}} = \\rho \\times F_{\\mathrm{baseline}} = 0.75 \\times 12 = 9$$\n\nNext, we determine the post-knockout gene expression levels. The double knockout of $g_1$ and $g_2$ sets their expression to zero. Genes $g_3$ and $g_4$ are unaffected. Gene $g_5$ is upregulated by a fold-change of $\\alpha$. The post-knockout expression levels, denoted by $E_i'$, are:\n- $E_1' = 0$\n- $E_2' = 0$\n- $E_3' = E_3 = 10$\n- $E_4' = E_4 = 3$\n- $E_5' = \\alpha \\times E_5 = \\alpha \\times 2 = 2\\alpha$\n\nThe post-knockout maximum capacity, $V_{\\max}^{\\mathrm{KO}}$, is given by the GPR mapping rule:\n$$V_{\\max}^{\\mathrm{KO}}(\\alpha) = k \\times \\big(\\min(E_1',E_3') + \\min(E_2',E_4') + E_5'\\big)$$\nSubstituting the post-knockout expression levels and $k=2$:\n$$V_{\\max}^{\\mathrm{KO}}(\\alpha) = 2 \\times \\big(\\min(0, 10) + \\min(0, 3) + 2\\alpha\\big)$$\nA protein complex requires all its subunits, so if one subunit's expression is 0, the complex's effective abundance is 0. Thus, $\\min(0, 10) = 0$ and $\\min(0, 3) = 0$.\n$$V_{\\max}^{\\mathrm{KO}}(\\alpha) = 2 \\times (0 + 0 + 2\\alpha) = 4\\alpha$$\n\nThe reaction remains active after the knockout (since $V_{\\max}^{\\mathrm{KO}} > 0$ for $\\alpha > 0$, and basal expression implies $\\alpha \\ge 1$), but we need to find the minimal $\\alpha$ to meet the target capacity. The condition is:\n$$V_{\\max}^{\\mathrm{KO}}(\\alpha) \\ge F_{\\mathrm{target}}$$\nSubstituting our derived expressions:\n$$4\\alpha \\ge 9$$\nSolving for $\\alpha$:\n$$\\alpha \\ge \\frac{9}{4}$$\n$$\\alpha \\ge 2.25$$\n\nThe minimal value for the fold-change is $\\alpha = 2.25$. The problem requires rounding to four significant figures.\n$$\\alpha_{\\min} = 2.250$$\nThis means the expression of gene $g_5$ must be increased by a factor of at least $2.250$ to compensate for the loss of the two protein complexes and ensure the reaction capacity meets the minimum viability target.", "answer": "$$\\boxed{2.250}$$", "id": "3315645"}, {"introduction": "To leverage GPR logic in genome-scale metabolic models, we must translate the on/off state of enzyme availability into a mathematical form compatible with optimization frameworks like Flux Balance Analysis. This is typically achieved using Mixed-Integer Linear Programming (MILP) and so-called \"big-$M$\" constraints. This practice [@problem_id:3315631] focuses on the critical details of this implementation, challenging you to select the correct formulation that is both logically sound and numerically robust, a crucial skill for accurate computational systems biology.", "problem": "A genome-scale metabolic model is represented by a stoichiometric matrix $S$ and flux vector $v$ with the steady-state constraint $S v = 0$. Reaction-wise flux bounds $L_j \\le v_j \\le U_j$ arise from physicochemical directionality and capacity limits. Gene–Protein–Reaction (GPR) associations map genes to enzyme complexes that catalyze reactions; when an essential enzyme is absent, the catalyzed reaction cannot carry flux. To capture enzyme availability in a Mixed-Integer Linear Programming (MILP) formulation, introduce a binary variable $z_e \\in \\{0,1\\}$ for the availability of the enzyme catalyzing reaction $j$ and couple it to the reaction flux so that (i) if $z_e = 0$ then $v_j = 0$, and (ii) if $z_e = 1$ then $v_j$ is permitted within its physicochemical bounds.\n\nConsider two reactions under Flux Balance Analysis (FBA): reaction $j$ is reversible with bounds $L_j = -10$ and $U_j = 8$, and reaction $k$ is irreversible with bounds $L_k = 0$ and $U_k = 12$. You must select a coupling strategy that enforces the biological logic above and choose appropriate big-$M$ parameters where needed so that constraints are tight and numerically well-conditioned. All strategies must respect $S v = 0$ and the reaction-wise bounds.\n\nWhich option correctly couples enzyme availability to flux for both reactions and makes an appropriate big-$M$ choice for reversible versus irreversible cases?\n\nA. Impose reaction-specific scaled bounds $L_j z_e \\le v_j \\le U_j z_e$ for each enzyme-controlled reaction. If symmetric big-$M$ constraints are used instead, keep the baseline bounds $L_j \\le v_j \\le U_j$ and choose $M_j = \\max\\{ |L_j|, |U_j| \\}$ for reversible reactions, and $M_k = U_k$ for irreversible reactions, maintaining $v_k \\ge 0$.\n\nB. Impose only an upper coupling $v_j \\le M z_e$ with a single large $M$ (for example $M = 10^6$) for all reactions, and do not constrain the lower side; rely on $S v = 0$ to prevent negative or excessive flux.\n\nC. For irreversible reactions, couple with $-M z_e \\le v_k \\le M z_e$ using $M = U_k$, and for reversible reactions, couple with $-M z_e \\le v_j \\le M z_e$ using $M = U_j + |L_j|$; do not also impose the original reaction-wise bounds.\n\nD. Set a single global $M$ equal to the sum of all model upper bounds and apply $-M z_e \\le v_r \\le M z_e$ uniformly to every reaction $r$ without regard to its directionality; omit reaction-specific bounds to simplify the MILP.", "solution": "The problem asks us to identify the correct set of Mixed-Integer Linear Programming (MILP) constraints to couple enzyme availability (represented by a binary variable $z_e$) to reaction flux ($v_j$). The required logic is:\n- If $z_e = 0$, then $v_j = 0$.\n- If $z_e = 1$, then the flux is permitted within its original bounds, $L_j \\le v_j \\le U_j$.\n\nLet's analyze the common correct formulations and then evaluate the given options.\n\n**1. Scaled Bounds Formulation:**\nThis method directly multiplies the flux bounds by the binary variable:\n$$ L_j z_e \\le v_j \\le U_j z_e $$\nIf $z_e = 0$, the inequality becomes $0 \\le v_j \\le 0$, which correctly forces $v_j = 0$. If $z_e = 1$, it becomes $L_j \\le v_j \\le U_j$, correctly restoring the original bounds. This method is concise and provides the tightest possible formulation, which is numerically ideal.\n\n**2. \"Big-M\" Formulation:**\nThis method uses a large constant, $M$, to formulate the logic. The key is to choose an $M$ that is \"big enough\" to be non-restrictive when the enzyme is present ($z_e=1$), but not so big that it causes numerical instability. The tightest (best) choice for $M$ is critical. The formulation involves keeping the original bounds and adding new constraints. A common symmetric formulation is:\n$$ L_j \\le v_j \\le U_j $$\n$$ -M z_e \\le v_j \\le M z_e $$\n- If $z_e = 0$: The new constraints become $0 \\le v_j \\le 0$, forcing $v_j=0$. This is correct.\n- If $z_e = 1$: The new constraints become $-M \\le v_j \\le M$. To not interfere with the original bounds, we must have $M \\ge U_j$ and $-M \\le L_j$ (i.e., $M \\ge -L_j$). Therefore, the tightest possible choice for M is $M_{tight} = \\max(U_j, -L_j)$, which is equivalent to $\\max(|U_j|, |L_j|)$.\n\nApplying this to the specific reactions:\n- **Reaction j (Reversible):** $L_j = -10, U_j = 8$. The tightest big-M is $M_j = \\max(8, -(-10)) = 10$. This equals $\\max(|L_j|, |U_j|)$.\n- **Reaction k (Irreversible):** $L_k = 0, U_k = 12$. The tightest big-M is $M_k = \\max(12, -0) = 12$. This equals $U_k$.\n\nNow let's evaluate the options.\n\n*   **A.** This option presents two strategies. The first, $L_j z_e \\le v_j \\le U_j z_e$, is the correct \"scaled bounds\" formulation. The second, a big-M formulation, correctly states that baseline bounds are kept and proposes $M_j = \\max\\{ |L_j|, |U_j| \\}$ for reversible reactions and $M_k = U_k$ for irreversible ones. Both descriptions are correct and represent best practices for creating a tight, well-conditioned model.\n\n*   **B.** This option is flawed. For the reversible reaction $j$ with $L_j=-10$, if $z_e=0$, the constraint $v_j \\le M z_e$ becomes $v_j \\le 0$. This does not force $v_j=0$; it incorrectly allows flux to be as low as $-10$.\n\n*   **C.** This option is flawed because it states \"do not also impose the original reaction-wise bounds.\" This is a critical error. Without the original bounds, if $z_e=1$, the constraints for irreversible reaction $k$ would become $-12 \\le v_k \\le 12$, incorrectly allowing negative flux.\n\n*   **D.** This option has the same fatal flaw as C (\"omit reaction-specific bounds\"). Additionally, it proposes using a single, global, non-tight big-M, which is poor numerical practice and goes against the problem's requirement for a well-conditioned formulation.\n\n**Conclusion:**\nOption A is the only choice that accurately describes correct and numerically sound methods for implementing the desired logic in an MILP framework.", "answer": "$$\\boxed{A}$$", "id": "3315631"}]}