{"hands_on_practices": [{"introduction": "The first step in a rigorous analysis of any biochemical network is to translate its reaction structure into a precise mathematical object. The stoichiometric matrix, denoted by $S$, serves this purpose by encoding the net change of each species in every reaction. This exercise [@problem_id:3291006] provides foundational practice in constructing $S$ from a given set of reactions and exploring its fundamental linear algebraic properties, such as its rank and the dimensions of its kernel and cokernel, which reveal the system's conservation laws and the dimension of the space its dynamics can explore.", "problem": "Consider a well-mixed biochemical system with species set $\\{A,B,C,D\\}$ undergoing the reactions $2A + B \\to C$, $C \\to A + D$, and $D \\to B$ in a fixed volume. Adopt the species ordering $(A,B,C,D)$ and the reaction ordering $(R_{1},R_{2},R_{3})$ corresponding to the three reactions as written. Using the core definition of the stoichiometric matrix in reaction network theory, where each column is the net stoichiometric change vector (product stoichiometric coefficients minus reactant stoichiometric coefficients) arranged according to the specified species ordering, construct the stoichiometric matrix $S \\in \\mathbb{R}^{m \\times r}$ for this network, where $m$ is the number of species and $r$ is the number of reactions. Then, using linear algebra from first principles and the structure of $S$, determine $\\operatorname{rank}(S)$, $\\dim(\\ker S)$, and $\\dim(\\ker S^{\\top})$. Express your final answer as a row matrix in the order $(\\operatorname{rank}(S),\\ \\dim(\\ker S),\\ \\dim(\\ker S^{\\top}))$. No numerical rounding is required. No units are required.", "solution": "The problem as stated is scientifically grounded, well-posed, and objective. It is a standard exercise in computational systems biology involving the construction and analysis of a stoichiometric matrix. All necessary information is provided, and the premises are consistent with the principles of chemical reaction network theory. We may therefore proceed with the solution.\n\nThe system consists of $m=4$ species, which, according to the specified ordering $(A,B,C,D)$, can be represented by a concentration vector $\\mathbf{x} = \\begin{pmatrix} [A] & [B] & [C] & [D] \\end{pmatrix}^{\\top}$. There are $r=3$ reactions, ordered as $(R_1, R_2, R_3)$.\n\nThe stoichiometric matrix $S \\in \\mathbb{R}^{m \\times r}$ is constructed such that its $(i,j)$ entry, $S_{ij}$, represents the net change in the number of molecules of species $i$ due to one instance of reaction $j$. Each column of $S$ is the stoichiometric vector for the corresponding reaction.\n\nFor Reaction $R_1: 2A + B \\to C$:\nThe change in species counts is $\\Delta A = -2$, $\\Delta B = -1$, $\\Delta C = +1$, and $\\Delta D = 0$. The first column of $S$, corresponding to $R_1$, is thus:\n$$ \\mathbf{s}_1 = \\begin{pmatrix} -2 \\\\ -1 \\\\ 1 \\\\ 0 \\end{pmatrix} $$\n\nFor Reaction $R_2: C \\to A + D$:\nThe change in species counts is $\\Delta A = +1$, $\\Delta B = 0$, $\\Delta C = -1$, and $\\Delta D = +1$. The second column of $S$, corresponding to $R_2$, is:\n$$ \\mathbf{s}_2 = \\begin{pmatrix} 1 \\\\ 0 \\\\ -1 \\\\ 1 \\end{pmatrix} $$\n\nFor Reaction $R_3: D \\to B$:\nThe change in species counts is $\\Delta A = 0$, $\\Delta B = +1$, $\\Delta C = 0$, and $\\Delta D = -1$. The third column of $S$, corresponding to $R_3$, is:\n$$ \\mathbf{s}_3 = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\\\ -1 \\end{pmatrix} $$\n\nCombining these column vectors in the specified order $(R_1, R_2, R_3)$ yields the $4 \\times 3$ stoichiometric matrix $S$:\n$$ S = \\begin{pmatrix} \\mathbf{s}_1 & \\mathbf{s}_2 & \\mathbf{s}_3 \\end{pmatrix} = \\begin{pmatrix} -2 & 1 & 0 \\\\ -1 & 0 & 1 \\\\ 1 & -1 & 0 \\\\ 0 & 1 & -1 \\end{pmatrix} $$\n\nNext, we determine the rank of $S$ and the dimensions of its kernel and the kernel of its transpose. The rank of a matrix is the dimension of its column space, which is equal to the number of linearly independent columns. The columns $\\mathbf{s}_1, \\mathbf{s}_2, \\mathbf{s}_3$ are linearly independent if the only solution to the equation $c_1\\mathbf{s}_1 + c_2\\mathbf{s}_2 + c_3\\mathbf{s}_3 = \\mathbf{0}$ is the trivial solution $c_1=c_2=c_3=0$. This is equivalent to finding the kernel (null space) of $S$.\nThe equation $S\\mathbf{c} = \\mathbf{0}$, where $\\mathbf{c} = \\begin{pmatrix} c_1 & c_2 & c_3 \\end{pmatrix}^{\\top}$, corresponds to the system of linear equations:\n$$-2c_1 + c_2 = 0$$\n$$-c_1 + c_3 = 0$$\n$$c_1 - c_2 = 0$$\n$$c_2 - c_3 = 0$$\nFrom the third equation, we have $c_1 = c_2$. Substituting this into the first equation gives $-2c_1 + c_1 = 0$, which implies $-c_1 = 0$, so $c_1 = 0$.\nSince $c_1=c_2$, we have $c_2 = 0$.\nFrom the second equation, $c_3 = c_1$, so $c_3 = 0$.\nThe only solution is $c_1 = c_2 = c_3 = 0$. This demonstrates that the columns of $S$ are linearly independent.\nSince there are $3$ linearly independent columns, the dimension of the column space is $3$. Therefore, $\\operatorname{rank}(S) = 3$.\n\nThe kernel of $S$, denoted $\\ker S$, is the set of all vectors $\\mathbf{c}$ such that $S\\mathbf{c} = \\mathbf{0}$. We have just shown that the only such vector is the zero vector, $\\mathbf{c} = \\mathbf{0}$. The kernel is the trivial subspace $\\{\\mathbf{0}\\}$, and its dimension is $0$.\nThus, $\\dim(\\ker S) = 0$.\nThis result is also consistent with the Rank-Nullity Theorem, which states that for a matrix with $r$ columns, $\\operatorname{rank}(S) + \\dim(\\ker S) = r$. Here, $r=3$, and we found $\\operatorname{rank}(S)=3$, so $3 + \\dim(\\ker S) = 3$, which confirms $\\dim(\\ker S) = 0$.\n\nFinally, we determine $\\dim(\\ker S^{\\top})$. The matrix $S^{\\top}$ is an $r \\times m$ matrix, which is a $3 \\times 4$ matrix in this case. The Rank-Nullity Theorem applied to $S^{\\top}$ states that $\\operatorname{rank}(S^{\\top}) + \\dim(\\ker S^{\\top}) = m$, where $m$ is the number of columns of $S^{\\top}$ (which is the number of rows of $S$).\nA fundamental theorem of linear algebra states that the rank of a matrix is equal to the rank of its transpose, i.e., $\\operatorname{rank}(S) = \\operatorname{rank}(S^{\\top})$.\nWe have $m=4$ and $\\operatorname{rank}(S) = 3$, so $\\operatorname{rank}(S^{\\top}) = 3$.\nSubstituting these values into the Rank-Nullity Theorem for $S^{\\top}$:\n$$ 3 + \\dim(\\ker S^{\\top}) = 4 $$\nSolving for $\\dim(\\ker S^{\\top})$, we find:\n$$ \\dim(\\ker S^{\\top}) = 1 $$\nThe vectors in $\\ker S^{\\top}$ represent the conservation laws of the system. The fact that its dimension is $1$ implies there is one linearly independent conservation law.\n\nIn summary, the calculated values are:\n$\\operatorname{rank}(S) = 3$\n$\\dim(\\ker S) = 0$\n$\\dim(\\ker S^{\\top}) = 1$\n\nThe final answer should be presented as a row matrix in the order $(\\operatorname{rank}(S),\\ \\dim(\\ker S),\\ \\dim(\\ker S^{\\top}))$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n3 & 0 & 1\n\\end{pmatrix}\n}\n$$", "id": "3291006"}, {"introduction": "A primary goal of network modeling is to predict the long-term behavior of the system, particularly its steady-state concentrations. By combining the stoichiometric matrix $S$ with a kinetic law, such as the law of mass-action, we can formulate the condition for a steady state as the algebraic equation $S v(x^*) = 0$, where $v(x^*)$ is the vector of reaction rates at the equilibrium concentrations $x^*$. This practice problem [@problem_id:3291003] demonstrates how to solve this system of equations, in conjunction with system-wide conservation laws, to determine the unique positive equilibrium of a network within a specific compatibility class.", "problem": "Consider the closed, well-mixed mass-action reaction network with three chemical species $A$, $B$, and $C$:\n$$A \\;\\xrightleftharpoons[k_{-1}]{k_{1}}\\; B \\;\\xrightleftharpoons[k_{-2}]{k_{2}}\\; C,$$\ninterpreted as four elementary reaction channels $r_{1}: A \\to B$, $r_{2}: B \\to A$, $r_{3}: B \\to C$, and $r_{4}: C \\to B$. The system is isothermal, with constant volume, and follows mass-action kinetics.\n\nThe rate constants are $k_{1} = 2.4\\,\\mathrm{s}^{-1}$, $k_{-1} = 1.2\\,\\mathrm{s}^{-1}$, $k_{2} = 3.6\\,\\mathrm{s}^{-1}$, and $k_{-2} = 1.2\\,\\mathrm{s}^{-1}$. The initial condition defines a stoichiometric compatibility class determined by the conserved total $T = x_{A}(0) + x_{B}(0) + x_{C}(0) = 95\\,\\mu\\mathrm{M}$, which remains invariant for all time due to the network’s stoichiometry.\n\nStarting only from the definitions of mass-action kinetics and the stoichiometric formulation of biochemical reaction networks, do the following:\n- Write the steady-state equations in the compact form $S\\,v(x^{*}) = 0$ with $x^{*} \\in \\mathbb{R}_{>0}^{3}$, where $S$ is the stoichiometric matrix and $v(x)$ is the vector of reaction rates under mass-action kinetics.\n- Impose the conservation constraint that characterizes the specified stoichiometric compatibility class.\n- Solve these equations to obtain all positive equilibria in that class.\n\nFinally, report the steady-state concentration $x_{C}^{*}$ corresponding to that class. Round your final numerical answer for $x_{C}^{*}$ to four significant figures and express it in micromolar (μM).", "solution": "The problem requires finding the steady-state concentration of species $C$, denoted $x_C^*$, for a closed chemical reaction network. The solution must be derived from the fundamental principles of mass-action kinetics and stoichiometric network analysis.\n\nThe network consists of three species, $S_1 = A$, $S_2 = B$, $S_3 = C$, and four reversible elementary reactions:\n$r_1: A \\to B$\n$r_2: B \\to A$\n$r_3: B \\to C$\n$r_4: C \\to B$\n\nLet the concentration vector be $x = (x_A, x_B, x_C)^T$. Under the law of mass-action, the rates of the four reactions are given by:\n$v_1(x) = k_1 x_A$\n$v_2(x) = k_{-1} x_B$\n$v_3(x) = k_2 x_B$\n$v_4(x) = k_{-2} x_C$\nWe can write these rates as a vector $v(x) = (v_1, v_2, v_3, v_4)^T$.\n\nThe stoichiometry of the network is captured by the stoichiometric matrix $S$, an $m \\times n$ matrix where $m=3$ is the number of species and $n=4$ is the number of reactions. Each column of $S$ represents the net change in species concentrations for a given reaction.\nFor $r_1: A \\to B$, the species change vector is $(-1, 1, 0)^T$.\nFor $r_2: B \\to A$, the species change vector is $(1, -1, 0)^T$.\nFor $r_3: B \\to C$, the species change vector is $(0, -1, 1)^T$.\nFor $r_4: C \\to B$, the species change vector is $(0, 1, -1)^T$.\n\nCombining these column vectors, the stoichiometric matrix $S$ is:\n$$ S = \\begin{pmatrix} -1 & 1 & 0 & 0 \\\\ 1 & -1 & -1 & 1 \\\\ 0 & 0 & 1 & -1 \\end{pmatrix} $$\n\nThe dynamic evolution of the system is described by the system of ordinary differential equations (ODEs) $\\frac{dx}{dt} = S v(x)$:\n$$ \\frac{dx_A}{dt} = -v_1 + v_2 = -k_1 x_A + k_{-1} x_B $$\n$$ \\frac{dx_B}{dt} = v_1 - v_2 - v_3 + v_4 = k_1 x_A - k_{-1} x_B - k_2 x_B + k_{-2} x_C $$\n$$ \\frac{dx_C}{dt} = v_3 - v_4 = k_2 x_B - k_{-2} x_C $$\n\nAt steady state (equilibrium), the concentrations are constant, so $\\frac{dx}{dt} = 0$. We seek a positive equilibrium vector $x^* = (x_A^*, x_B^*, x_C^*)^T$ with $x_i^* > 0$ that satisfies the algebraic system $S v(x^*) = 0$:\n1.  $-k_1 x_A^* + k_{-1} x_B^* = 0$\n2.  $k_1 x_A^* - (k_{-1} + k_2) x_B^* + k_{-2} x_C^* = 0$\n3.  $k_2 x_B^* - k_{-2} x_C^* = 0$\n\nThe rows of the stoichiometric matrix $S$ are linearly dependent, as their sum is the zero vector. This means the system of three equations has only two independent equations. We can choose the first and third equations, which are simpler:\nFrom (1): $k_1 x_A^* = k_{-1} x_B^*$\nFrom (3): $k_2 x_B^* = k_{-2} x_C^*$\n\nThese two equations define a line of possible equilibrium points. A unique solution is found by imposing the conservation law specified in the problem. The network is closed, and the stoichiometry implies that for any reaction, the total number of molecules is conserved. Thus, the total concentration $T$ is constant over time:\n4. $x_A(t) + x_B(t) + x_C(t) = T$\nThe problem states this conserved quantity is $T = 95\\,\\mu\\mathrm{M}$. At equilibrium, we have:\n$x_A^* + x_B^* + x_C^* = T$\n\nWe now have a system of three independent linear equations for the three unknowns $x_A^*, x_B^*, x_C^*$. We express $x_A^*$ and $x_C^*$ in terms of $x_B^*$:\n$$ x_A^* = \\frac{k_{-1}}{k_1} x_B^* $$\n$$ x_C^* = \\frac{k_2}{k_{-2}} x_B^* $$\nSubstitute these expressions into the conservation equation (4):\n$$ \\left(\\frac{k_{-1}}{k_1}\\right) x_B^* + x_B^* + \\left(\\frac{k_2}{k_{-2}}\\right) x_B^* = T $$\nFactor out $x_B^*$:\n$$ x_B^* \\left(1 + \\frac{k_{-1}}{k_1} + \\frac{k_2}{k_{-2}}\\right) = T $$\nSolving for $x_B^*$:\n$$ x_B^* = \\frac{T}{1 + \\frac{k_{-1}}{k_1} + \\frac{k_2}{k_{-2}}} $$\nThe problem asks for $x_C^*$. We use the expression for $x_C^*$ in terms of $x_B^*$:\n$$ x_C^* = \\frac{k_2}{k_{-2}} x_B^* = \\frac{k_2}{k_{-2}} \\left( \\frac{T}{1 + \\frac{k_{-1}}{k_1} + \\frac{k_2}{k_{-2}}} \\right) $$\nNow, we substitute the provided numerical values: $k_1 = 2.4$, $k_{-1} = 1.2$, $k_2 = 3.6$, $k_{-2} = 1.2$ (in units of $\\mathrm{s}^{-1}$), and $T = 95\\,\\mu\\mathrm{M}$.\nFirst, calculate the dimensionless ratios:\n$$ \\frac{k_{-1}}{k_1} = \\frac{1.2}{2.4} = 0.5 $$\n$$ \\frac{k_2}{k_{-2}} = \\frac{3.6}{1.2} = 3 $$\nSubstitute these ratios into the expression for $x_C^*$:\n$$ x_C^* = 3 \\left( \\frac{95}{1 + 0.5 + 3} \\right) = 3 \\left( \\frac{95}{4.5} \\right) $$\n$$ x_C^* = \\frac{285}{4.5} = \\frac{2850}{45} = \\frac{570}{9} = 63.333\\ldots $$\nThe value of $x_C^*$ must be reported in micromolar ($\\mu\\mathrm{M}$) and rounded to four significant figures.\n$$ x_C^* \\approx 63.33\\,\\mu\\mathrm{M} $$\nThe final numerical answer is $63.33$.", "answer": "$$\n\\boxed{63.33}\n$$", "id": "3291003"}, {"introduction": "Beyond calculating specific equilibria, Chemical Reaction Network Theory (CRNT) offers powerful tools to predict the qualitative dynamic behavior of a network based on its structure alone, irrespective of specific rate constants. This is achieved by analyzing topological properties like the number of complexes ($n$), linkage classes ($l$), and the dimension of the stoichiometric subspace ($s$) to compute the network deficiency, $\\delta = n - l - s$. This exercise [@problem_id:3291054] will guide you through the process of computing this crucial invariant and applying the celebrated Deficiency Zero Theorem to make robust predictions about the existence and uniqueness of steady states.", "problem": "Consider the biochemical reaction network on species $A$ and $B$ given by the reactions $A \\rightleftharpoons B$ and $2B \\to A + B$. Use the framework of mass-action kinetics and stoichiometric analysis.\n\nStarting from the core definitions of complexes, linkage classes, and stoichiometric subspace, perform the following steps without invoking any pre-stated shortcut formulas:\n\n- Identify the set of complexes and determine the number of distinct complexes.\n- Determine the number of linkage classes by forming the undirected graph on complexes where an undirected edge is drawn if a reaction exists between the corresponding complexes.\n- Construct the stoichiometric change vectors for each reaction and determine the dimension of the stoichiometric subspace spanned by these vectors.\n- Using the definition of network deficiency as a property determined by the number of complexes, linkage classes, and the stoichiometric subspace, compute the deficiency $\\delta$.\n- Using the definition of weak reversibility as strong connectivity at the level of linkage classes in the directed reaction graph on complexes, determine whether the network is weakly reversible.\n- Using the standard criteria of the Deficiency Zero Theorem from chemical reaction network theory (namely, deficiency zero and weak reversibility), deduce whether the network satisfies these conditions.\n\nTo ensure the final answer is a single numerical value, encode your conclusions into the integer\n$$C \\;=\\; \\delta \\;+\\; 2\\,\\chi_{\\mathrm{WR}} \\;+\\; 4\\,\\chi_{\\mathrm{DZ}},$$\nwhere $\\chi_{\\mathrm{WR}}$ equals $1$ if the network is weakly reversible and $0$ otherwise, and $\\chi_{\\mathrm{DZ}}$ equals $1$ if the network satisfies the conditions of the Deficiency Zero Theorem and $0$ otherwise. Report only the value of $C$ as your final answer. No rounding is required and no units are to be reported.", "solution": "We proceed from first principles in chemical reaction network theory. A complex is a formal linear combination of species that appears as a reactant or product in at least one reaction. A linkage class is a connected component of the undirected graph whose vertices are complexes, with an undirected edge between two complexes if there is at least one reaction between them (in either direction). The stoichiometric subspace is the linear subspace spanned by the stoichiometric change vectors of the reactions. The deficiency is the nonnegative integer determined by the numbers of complexes, linkage classes, and the dimension of the stoichiometric subspace. A network is weakly reversible if every connected component of the directed reaction graph on complexes is strongly connected. The Deficiency Zero Theorem in chemical reaction network theory requires that the network has deficiency zero and is weakly reversible.\n\nStep $1$: Identify complexes. The reactions are $A \\to B$, $B \\to A$, and $2B \\to A + B$. The complexes that appear are $A$, $B$, $2B$, and $A + B$. Therefore, the set of complexes is $\\{A, B, 2B, A + B\\}$, and the number of complexes is $n = 4$.\n\nStep $2$: Determine linkage classes. Form the undirected graph on the $n = 4$ complexes with edges if a reaction connects them in either direction. There is an undirected edge between $A$ and $B$ because both $A \\to B$ and $B \\to A$ exist. There is an undirected edge between $2B$ and $A + B$ because of the reaction $2B \\to A + B$. There are no reactions connecting $\\{A, B\\}$ to $\\{2B, A + B\\}$, hence no edges between these pairs across the sets. Thus, the undirected graph has two connected components, namely $\\{A, B\\}$ and $\\{2B, A + B\\}$. Therefore, the number of linkage classes is $l = 2$.\n\nStep $3$: Construct stoichiometric change vectors and compute the stoichiometric subspace dimension. Let the species order be $(A, B)$. For each reaction, the stoichiometric change vector is product complex minus reactant complex, interpreted componentwise in $(A, B)$.\n\n- For $A \\to B$, the reactant complex corresponds to $(1, 0)$ and the product complex to $(0, 1)$, so the change vector is $(0, 1) - (1, 0) = (-1, 1)$.\n- For $B \\to A$, the change vector is $(1, 0) - (0, 1) = (1, -1)$.\n- For $2B \\to A + B$, the reactant complex corresponds to $(0, 2)$ and the product complex to $(1, 1)$, so the change vector is $(1, 1) - (0, 2) = (1, -1)$.\n\nThe set of change vectors is $\\{(-1, 1), (1, -1), (1, -1)\\}$. All these vectors lie in the span of $(1, -1)$, because $(-1, 1) = - (1, -1)$. Hence, the stoichiometric subspace is one-dimensional, and its dimension is $s = 1$.\n\nStep $4$: Compute the deficiency $\\delta$. By definition, the deficiency is determined by the number of complexes, the number of linkage classes, and the dimension of the stoichiometric subspace. Using $n = 4$, $l = 2$, and $s = 1$, we obtain\n$$\\delta \\;=\\; n - l - s \\;=\\; 4 - 2 - 1 \\;=\\; 1.$$\n\nStep $5$: Determine weak reversibility. A network is weakly reversible if in the directed reaction graph on complexes, every linkage class is strongly connected. Consider the two linkage classes:\n\n- The first linkage class $\\{A, B\\}$ has directed edges $A \\to B$ and $B \\to A$. This class is strongly connected.\n- The second linkage class $\\{2B, A + B\\}$ has the directed edge $2B \\to A + B$ and no reaction from $A + B$ to $2B$. Therefore, there is no directed path from $A + B$ back to $2B$, so this class is not strongly connected.\n\nBecause at least one linkage class is not strongly connected, the network is not weakly reversible. Therefore, $\\chi_{\\mathrm{WR}} = 0$.\n\nStep $6$: Deduce whether the conditions of the Deficiency Zero Theorem are satisfied. The Deficiency Zero Theorem requires that the network be weakly reversible and have deficiency zero. Here, $\\delta = 1 \\neq 0$, and the network is not weakly reversible. Therefore, the conditions are not satisfied, and $\\chi_{\\mathrm{DZ}} = 0$.\n\nStep $7$: Compute the encoded integer $C$. Using the encoding\n$$C \\;=\\; \\delta \\;+\\; 2\\,\\chi_{\\mathrm{WR}} \\;+\\; 4\\,\\chi_{\\mathrm{DZ}},$$\nwe substitute $\\delta = 1$, $\\chi_{\\mathrm{WR}} = 0$, and $\\chi_{\\mathrm{DZ}} = 0$ to obtain\n$$C \\;=\\; 1 \\;+\\; 2 \\cdot 0 \\;+\\; 4 \\cdot 0 \\;=\\; 1.$$\n\nThus, the required single numerical output is $1$.", "answer": "$$\\boxed{1}$$", "id": "3291054"}]}