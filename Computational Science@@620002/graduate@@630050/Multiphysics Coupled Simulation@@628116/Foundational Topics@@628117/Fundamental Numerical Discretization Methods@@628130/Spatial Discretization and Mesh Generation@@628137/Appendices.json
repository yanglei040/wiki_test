{"hands_on_practices": [{"introduction": "The quality of a finite element mesh is paramount to the accuracy and stability of a numerical simulation. This practice focuses on the fundamental building block of the mesh: the individual element. By calculating key geometric metrics such as the minimum internal angle and aspect ratio for a given triangle [@problem_id:3526260], you will develop a concrete understanding of how element shape directly influences the mathematical properties of the discrete operators, which is crucial for ensuring a well-conditioned and reliable multiphysics model.", "problem": "A thermoelastic flowâ€“structure interaction discretization couples an incompressible fluid and a heat equation on a shared unstructured triangular mesh using the Finite Element Method (FEM) and a mixed stabilization. For coercivity and operator conditioning, a local element quality requirement is imposed: the minimum internal angle must exceed a prescribed threshold and the aspect ratio must be bounded. Consider the triangle with vertices at $A = (0, 0)$, $B = (1.8, 0.6)$, and $C = (0.2, 2.0)$ in a plane. You will compute the minimum internal angle and an aspect ratio defined by the circumradius-to-inradius ratio, then form a scalar stability metric.\n\nStarting from core Euclidean geometry definitions and well-tested formulas, do the following:\n- Compute the side lengths using the Euclidean norm.\n- Compute the area using the cross product magnitude.\n- Compute each internal angle using the dot product definition of the angle between two vectors.\n- Compute the inradius and circumradius from the area and side lengths via fundamental relations.\n- Define the aspect ratio as $\\rho = \\dfrac{R}{r}$, where $R$ is the circumradius and $r$ is the inradius.\n- Let the stability metric be $q = \\dfrac{\\theta_{\\min}}{\\rho}$, where $\\theta_{\\min}$ is the minimum internal angle in radians.\n- The prescribed thresholds for stability are $\\theta_{\\min} \\geq \\theta_{0}$ with $\\theta_{0} = 0.6$ and $\\rho \\leq \\rho_{0}$ with $\\rho_{0} = 3.0$. Assess whether the triangle meets both thresholds, but report only the scalar $q$.\n\nRound your final stability metric $q$ to four significant figures. Express all angles in radians. The final answer must be a single real-valued number.", "solution": "The problem requires the calculation of a stability metric, $q$, for a given triangular element defined by its vertices in a 2D plane. The process involves computing several geometric properties of the triangle: side lengths, area, internal angles, inradius, and circumradius.\n\nThe vertices of the triangle are given as $A = (0, 0)$, $B = (1.8, 0.6)$, and $C = (0.2, 2.0)$.\n\nFirst, we define the vectors corresponding to the sides of the triangle.\nThe vector from $A$ to $B$ is $\\vec{AB} = B - A = (1.8 - 0, 0.6 - 0) = (1.8, 0.6)$.\nThe vector from $A$ to $C$ is $\\vec{AC} = C - A = (0.2 - 0, 2.0 - 0) = (0.2, 2.0)$.\nThe vector from $B$ to $C$ is $\\vec{BC} = C - B = (0.2 - 1.8, 2.0 - 0.6) = (-1.6, 1.4)$.\n\nNext, we compute the lengths of the sides, which are the Euclidean norms of these vectors. Let $a$, $b$, and $c$ be the lengths of the sides opposite to vertices $A$, $B$, and $C$, respectively.\n$c = |\\vec{AB}| = \\sqrt{(1.8)^{2} + (0.6)^{2}} = \\sqrt{3.24 + 0.36} = \\sqrt{3.6} \\approx 1.897367$.\n$b = |\\vec{AC}| = \\sqrt{(0.2)^{2} + (2.0)^{2}} = \\sqrt{0.04 + 4.0} = \\sqrt{4.04} \\approx 2.009975$.\n$a = |\\vec{BC}| = \\sqrt{(-1.6)^{2} + (1.4)^{2}} = \\sqrt{2.56 + 1.96} = \\sqrt{4.52} \\approx 2.126029$.\n\nThe area of the triangle, $\\mathcal{A}$, can be computed as half the magnitude of the 2D cross product of the vectors forming two of its sides, for instance $\\vec{AB}$ and $\\vec{AC}$.\n$$ \\mathcal{A} = \\frac{1}{2} |\\det(\\vec{AB}, \\vec{AC})| = \\frac{1}{2} |(1.8)(2.0) - (0.6)(0.2)| $$\n$$ \\mathcal{A} = \\frac{1}{2} |3.6 - 0.12| = \\frac{1}{2} (3.48) = 1.74 $$\nThe area is exactly $1.74$.\n\nThe internal angles are computed using the dot product formula: $\\vec{u} \\cdot \\vec{v} = |\\vec{u}| |\\vec{v}| \\cos(\\theta)$, which gives $\\theta = \\arccos\\left(\\frac{\\vec{u} \\cdot \\vec{v}}{|\\vec{u}| |\\vec{v}|}\\right)$. All angles are expressed in radians.\n\nAngle $\\theta_A$ at vertex $A$ is the angle between $\\vec{AB}$ and $\\vec{AC}$:\n$$ \\vec{AB} \\cdot \\vec{AC} = (1.8)(0.2) + (0.6)(2.0) = 0.36 + 1.2 = 1.56 $$\n$$ \\cos(\\theta_A) = \\frac{1.56}{c \\cdot b} = \\frac{1.56}{\\sqrt{3.6} \\sqrt{4.04}} = \\frac{1.56}{\\sqrt{14.544}} \\approx 0.409048 $$\n$$ \\theta_A = \\arccos(0.409048) \\approx 1.14918 \\text{ rad} $$\n\nAngle $\\theta_B$ at vertex $B$ is the angle between $\\vec{BA} = -\\vec{AB}$ and $\\vec{BC}$:\n$$ \\vec{BA} \\cdot \\vec{BC} = (-1.8)(-1.6) + (-0.6)(1.4) = 2.88 - 0.84 = 2.04 $$\n$$ \\cos(\\theta_B) = \\frac{2.04}{c \\cdot a} = \\frac{2.04}{\\sqrt{3.6} \\sqrt{4.52}} = \\frac{2.04}{\\sqrt{16.272}} \\approx 0.505716 $$\n$$ \\theta_B = \\arccos(0.505716) \\approx 1.04073 \\text{ rad} $$\n\nAngle $\\theta_C$ at vertex $C$ is the angle between $\\vec{CA} = -\\vec{AC}$ and $\\vec{CB} = -\\vec{BC}$:\n$$ \\vec{CA} \\cdot \\vec{CB} = (-0.2)(1.6) + (-2.0)(-1.4) = -0.32 + 2.8 = 2.48 $$\n$$ \\cos(\\theta_C) = \\frac{2.48}{b \\cdot a} = \\frac{2.48}{\\sqrt{4.04} \\sqrt{4.52}} = \\frac{2.48}{\\sqrt{18.2608}} \\approx 0.580350 $$\n$$ \\theta_C = \\arccos(0.580350) \\approx 0.95168 \\text{ rad} $$\n\nThe minimum internal angle is $\\theta_{\\min} = \\theta_C \\approx 0.95168$ radians. The problem requires an assessment against the threshold $\\theta_0 = 0.6$, and since $0.95168 \\ge 0.6$, this condition is met.\n\nNext, we compute the inradius $r$ and circumradius $R$. The semi-perimeter, $s$, is:\n$s = \\frac{a+b+c}{2} = \\frac{\\sqrt{4.52} + \\sqrt{4.04} + \\sqrt{3.6}}{2} \\approx \\frac{2.126029 + 2.009975 + 1.897367}{2} \\approx 3.016686$.\n\nThe inradius $r$ is given by $r = \\frac{\\mathcal{A}}{s}$:\n$$ r \\approx \\frac{1.74}{3.016686} \\approx 0.576850 $$\n\nThe circumradius $R$ is given by $R = \\frac{abc}{4\\mathcal{A}}$:\n$$ R = \\frac{\\sqrt{4.52} \\sqrt{4.04} \\sqrt{3.6}}{4(1.74)} = \\frac{\\sqrt{65.73888}}{6.96} \\approx \\frac{8.107952}{6.96} \\approx 1.164936 $$\n\nThe aspect ratio is defined as $\\rho = \\frac{R}{r}$:\n$$ \\rho \\approx \\frac{1.164936}{0.576850} \\approx 2.019528 $$\nThe problem requires an assessment against the threshold $\\rho_0 = 3.0$, and since $2.019528 \\le 3.0$, this condition is also met.\n\nFinally, the stability metric $q$ is defined as $q = \\frac{\\theta_{\\min}}{\\rho}$:\n$$ q \\approx \\frac{0.95168}{2.019528} \\approx 0.471241 $$\nRounding the result to $4$ significant figures gives $q = 0.4712$.", "answer": "$$\\boxed{0.4712}$$", "id": "3526260"}, {"introduction": "A critical step in computational modeling is verification: ensuring the code correctly solves the mathematical equations. This exercise introduces a cornerstone of verification, the Grid Convergence Index (GCI), which quantifies the uncertainty due to spatial discretization. By analyzing solution data from a sequence of systematically refined meshes [@problem_id:3526279], you will learn to calculate the observed order of accuracy and estimate the error in your numerical result, a vital skill for establishing the credibility of any simulation.", "problem": "A multiphysics coupled simulation of electrochemically driven heat transfer in a lithium-ion battery pouch cell is performed using the finite element method (FEM). The cell is modeled as a layered solid with anisotropic thermal conductivity and volumetric Joule heating supplied by an electrochemical submodel. Spatial discretization uses three systematically refined, unstructured tetrahedral meshes with characteristic element sizes $h_1$, $h_2$, and $h_3$ satisfying $h_1/h_2 = h_2/h_3 = r$ and with $r$ constant. The quantity of interest is the domain-integrated Joule heat $Q(h)$, obtained from steady-state coupled solutions at each mesh level. The following data are recorded:\n- $h_1 = 0.008\\,\\text{m}$, $Q_1 = 5.432\\,\\text{W}$;\n- $h_2 = 0.004\\,\\text{m}$, $Q_2 = 5.308\\,\\text{W}$;\n- $h_3 = 0.002\\,\\text{m}$, $Q_3 = 5.276\\,\\text{W}$.\n\nAssume the solution error is asymptotic and can be represented by the leading-order Richardson expansion $Q(h) = Q^{\\ast} + C h^{p} + \\mathcal{O}(h^{p+1})$, where $Q^{\\ast}$ is the mesh-independent value, $C$ is a constant, and $p$ is the observed order of accuracy. Using only this base representation and the given data:\n1. Determine the observed order $p$ from the three solutions and the refinement ratio $r$.\n2. Based on the observed order, compute the Grid Convergence Index (GCI) for the finest-grid solution, defined on the pair $(h_2,h_3)$ with a safety factor $F_s = 1.25$, to estimate the fractional uncertainty of $Q_3$ due to spatial discretization.\n\nProvide the GCI as a dimensionless fraction (no percent sign). If you choose to express the final number in decimal form, round your answer to four significant figures. Also, briefly interpret whether the triplet of solutions is consistent with monotonic, asymptotic convergence and what the computed GCI implies about the uncertainty in $Q_3$ due to discretization.", "solution": "The problem is valid as it presents a well-posed set of conditions and data for performing a standard grid convergence study using Richardson extrapolation, a cornerstone of verification and validation in computational science and engineering. The physical context is scientifically grounded, and all necessary parameters are provided without contradiction.\n\nThe analysis proceeds in three parts: first, a brief check for monotonic convergence; second, the determination of the observed order of accuracy $p$; and third, the calculation of the Grid Convergence Index (GCI).\n\nThe given data for the domain-integrated Joule heat $Q$ at three levels of mesh refinement are:\n- Mesh 1 (coarse): $h_1 = 0.008$, $Q_1 = 5.432$\n- Mesh 2 (medium): $h_2 = 0.004$, $Q_2 = 5.308$\n- Mesh 3 (fine): $h_3 = 0.002$, $Q_3 = 5.276$\n\nFirst, we assess the convergence behavior. The mesh refinement is systematic, with a constant refinement ratio $r = h_1/h_2 = 0.008/0.004 = 2$ and $h_2/h_3 = 0.004/0.002 = 2$. The solutions are $Q_1 > Q_2 > Q_3$. Since the solution values decrease monotonically as the characteristic element size $h$ decreases, the solution exhibits monotonic convergence. This is a desirable property, suggesting the numerical scheme is stable and not exhibiting oscillatory error behavior.\n\nThe core of the analysis relies on the assumed Richardson error expansion for the quantity of interest, $Q(h)$, which states that the solution on a grid with characteristic size $h$ is related to the exact or grid-independent solution $Q^{\\ast}$ by:\n$$Q(h) = Q^{\\ast} + C h^{p} + \\mathcal{O}(h^{p+1})$$\nwhere $p$ is the order of accuracy and $C$ is a constant. Neglecting the higher-order terms for the three mesh levels, we have:\n$$Q_1 \\approx Q^{\\ast} + C h_1^{p}$$\n$$Q_2 \\approx Q^{\\ast} + C h_2^{p}$$\n$$Q_3 \\approx Q^{\\ast} + C h_3^{p}$$\nTo find the observed order of accuracy $p$, we form differences between successive solutions to eliminate the unknown $Q^{\\ast}$:\n$$Q_1 - Q_2 \\approx C(h_1^{p} - h_2^{p})$$\n$$Q_2 - Q_3 \\approx C(h_2^{p} - h_3^{p})$$\nTaking the ratio of these two differences eliminates the constant $C$:\n$$\\frac{Q_1 - Q_2}{Q_2 - Q_3} \\approx \\frac{h_1^{p} - h_2^{p}}{h_2^{p} - h_3^{p}}$$\nUsing the constant refinement ratio $r = h_1/h_2 = h_2/h_3$, we can express $h_1$ and $h_2$ in terms of coarser mesh sizes: $h_1 = r h_2$ and $h_2 = r h_3$. Substituting these into the ratio gives:\n$$\\frac{Q_1 - Q_2}{Q_2 - Q_3} \\approx \\frac{(r h_2)^{p} - h_2^{p}}{(r h_3)^{p} - h_3^{p}} = \\frac{h_2^{p}(r^p - 1)}{h_3^{p}(r^p - 1)} = \\left(\\frac{h_2}{h_3}\\right)^p = r^p$$\nWe can now solve for $p$:\n$$p = \\frac{\\ln\\left(\\frac{Q_1 - Q_2}{Q_2 - Q_3}\\right)}{\\ln(r)}$$\nSubstituting the given numerical values:\n$$Q_1 - Q_2 = 5.432 - 5.308 = 0.124$$\n$$Q_2 - Q_3 = 5.308 - 5.276 = 0.032$$\nAnd the refinement ratio is $r=2$. Therefore,\n$$p = \\frac{\\ln\\left(\\frac{0.124}{0.032}\\right)}{\\ln(2)} = \\frac{\\ln(3.875)}{\\ln(2)} \\approx \\frac{1.35455}{0.69315} \\approx 1.95418$$\nThe observed order of accuracy is $p \\approx 1.954$. This value is close to $2$, which is the theoretical order for many common finite element schemes, indicating that the solutions are in the asymptotic range of convergence.\n\nNext, we calculate the Grid Convergence Index (GCI) for the finest-grid solution, based on the pair of solutions $(Q_2, Q_3)$. The GCI provides an estimate of the fractional error in the fine-grid solution. The formula is:\n$$\\text{GCI}_{\\text{fine}} = \\text{GCI}_{23} = \\frac{F_s}{|r^p - 1|} \\left| \\frac{Q_3 - Q_2}{Q_3} \\right|$$\nWe are given the safety factor $F_s = 1.25$. We use the refinement ratio for this pair, $r = h_2/h_3 = 2$, and the value of $p$ we just calculated.\nThe term $r^p$ is simply the ratio of solution differences we found earlier:\n$$r^p = 2^{p} = \\frac{Q_1 - Q_2}{Q_2 - Q_3} = 3.875$$\nThe relative difference term is:\n$$\\left| \\frac{Q_3 - Q_2}{Q_3} \\right| = \\left| \\frac{5.276 - 5.308}{5.276} \\right| = \\left| \\frac{-0.032}{5.276} \\right| \\approx 0.006065201$$\nNow, we can substitute all values into the GCI formula:\n$$\\text{GCI}_{23} = \\frac{1.25}{|3.875 - 1|} \\times 0.006065201 = \\frac{1.25}{2.875} \\times 0.006065201 \\approx 0.00263695$$\nRounding the result to four significant figures as requested:\n$$\\text{GCI}_{23} \\approx 0.002637$$\n\nThe triplet of solutions is consistent with monotonic, asymptotic convergence, as evidenced by the ordered solution values ($Q_1 > Q_2 > Q_3$) and an observed order of accuracy $p \\approx 1.954$ that is stable and close to the theoretical integer value of $2$. The computed value $\\text{GCI}_{23} \\approx 0.002637$ (or $0.2637\\%$) implies that the discretization uncertainty in the fine-grid solution $Q_3$ is estimated to be approximately $0.26\\%$. This low value suggests that the solution on the finest mesh is quite accurate and that further mesh refinement would yield only minor changes to the domain-integrated Joule heat. The numerical result is robust.", "answer": "$$\\boxed{0.002637}$$", "id": "3526279"}, {"introduction": "Tackling complex multiphysics simulations often demands the power of parallel computing, which requires the computational domain to be effectively distributed across many processors. This hands-on practice addresses the core challenge of mesh partitioning: balancing the computational load while minimizing the communication overhead between processors. Implementing a greedy partitioning heuristic [@problem_id:3526228] will give you practical insight into the algorithms that enable large-scale scientific computing and the trade-offs inherent in domain decomposition.", "problem": "Consider a domain discretized into a conforming quadrilateral finite element mesh for a multiphysics coupled simulation. The mesh is described by an element-to-node connectivity. Let the set of elements be denoted by $E=\\{0,1,\\dots,N_e-1\\}$, the set of nodes by $V=\\{0,1,\\dots,N_v-1\\}$, and the connectivity by a function $C:E\\to \\mathcal{P}(V)$ assigning to each element the set of its corner nodes. Let each element $e\\in E$ have a positive computational weight $w_e\\in \\mathbb{R}_{>0}$, representing the expected cost to assemble and solve local physics for that element. The objective is to partition the elements into $p$ processor sets $\\{P_0,P_1,\\dots,P_{p-1}\\}$ for parallel execution using the Message Passing Interface (MPI), attempting to minimize communication while respecting a load balance tolerance.\n\nFundamental base definitions to use:\n- A face adjacency between two distinct elements $e_i$ and $e_j$ exists if and only if $|C(e_i)\\cap C(e_j)|=2$, which represents a shared edge in the quadrilateral mesh. Let the undirected adjacency graph be $G=(E,\\mathcal{A})$ where $\\mathcal{A}\\subseteq \\{\\{e_i,e_j\\}\\mid e_i\\neq e_j\\}$ contains an edge if and only if the face adjacency holds.\n- The total computational load is $W=\\sum_{e\\in E} w_e$. The average per-processor load is $L_{\\mathrm{avg}}=W/p$.\n- A load balance tolerance $t\\in \\mathbb{R}_{\\ge 0}$ specifies the admissible upper bound on per-processor load: $L_{\\max}=(1+t)\\,L_{\\mathrm{avg}}$. A partition is declared feasible if and only if for all processors $k\\in\\{0,1,\\dots,p-1\\}$ the sum of weights assigned to $P_k$ is less than or equal to $L_{\\max}$.\n- The edge cut of a partition is the number of adjacency edges in $\\mathcal{A}$ whose endpoints are assigned to different processors. Formally, given an assignment function $a:E\\to \\{0,1,\\dots,p-1\\}$, the edge cut is $\\mathrm{cut}(a)=\\left|\\left\\{\\{e_i,e_j\\}\\in \\mathcal{A}\\mid a(e_i)\\neq a(e_j)\\right\\}\\right|$.\n\nYour program must implement a greedy partitioning heuristic grounded in these definitions:\n- Begin from a set of seed elements, one per processor, given as a list $S=[s_0,s_1,\\dots,s_{p-1}]$, where $s_k\\in \\{-1\\}\\cup E$. A seed of $-1$ indicates no initial element for that processor. If multiple processors request the same seed index, only the earliest processor in index order receives it; others with duplicate seeds are treated as having $-1$.\n- Iteratively assign unassigned elements to processors to grow connected subdomains. At each step, form for each processor $k$ a frontier consisting of unassigned neighbors of elements already assigned to $P_k$. For a candidate element $e$ in processor $k$'s frontier, define a local connectivity score $s_{k}(e)$ equal to the number of already assigned neighbors of $e$ in $P_k$. Prefer assignments that maximize $s_{k}(e)$ to promote locality. In the event of ties, prefer assignments that minimize the number of neighbors of $e$ assigned to other processors, then prefer smaller $w_e$, and then smaller element index.\n- Only accept assignments that do not cause the processor's load to exceed $L_{\\max}$. If no frontier candidate is admissible for any processor, choose the lightest remaining element and assign it to the least-loaded processor that can accommodate it. If no processor can accommodate any remaining element within $L_{\\max}$, continue assigning to the least-loaded processor anyway, and declare the final partition infeasible.\n- Continue until all elements are assigned. Finally, report whether the tolerance was satisfied, the maximum load ratio $\\max_k \\left(\\sum_{e\\in P_k} w_e\\right)/L_{\\mathrm{avg}}$, and the edge cut of the partition.\n\nMesh and indexing convention:\n- The mesh is structured as an $n_x\\times n_y$ array of quadrilateral elements. Nodes lie on a grid of size $(n_x+1)\\times(n_y+1)$ and each element has four nodes: the lower-left, lower-right, upper-right, and upper-left corners. Elements are indexed in row-major order: an element at column $i\\in\\{0,\\dots,n_x-1\\}$ and row $j\\in\\{0,\\dots,n_y-1\\}$ has index $e=j\\cdot n_x+i$.\n\nTest suite:\nImplement the heuristic and run it on the following four test cases. For each, you must construct the structured mesh connectivity $C$ programmatically from $n_x$ and $n_y$ as described above, derive face adjacency $\\mathcal{A}$, and apply the greedy algorithm with the provided $w_e$, $p$, $t$, and $S$.\n\n- Case $1$ (happy path):\n  - $n_x=3$, $n_y=2$.\n  - $p=2$, $t=0.2$.\n  - Seeds $S=[0,5]$.\n  - Uniform weights $w_e=1$ for all $e$.\n- Case $2$ (boundary tolerance $0$):\n  - $n_x=2$, $n_y=2$.\n  - $p=2$, $t=0.0$.\n  - Seeds $S=[0,3]$.\n  - Uniform weights $w_e=1$ for all $e$.\n- Case $3$ (infeasible due to a heavy element):\n  - $n_x=1$, $n_y=4$.\n  - $p=2$, $t=0.0$.\n  - Seeds $S=[0,3]$.\n  - Weights $w=[5,1,1,1]$ assigned to elements in index order.\n- Case $4$ (more processors than elements, feasible with large tolerance):\n  - $n_x=2$, $n_y=1$.\n  - $p=3$, $t=1.0$.\n  - Seeds $S=[0,1,-1]$ where $-1$ denotes no seed.\n  - Weights $w=[2,1]$ assigned to elements in index order.\n\nAnswer specification:\n- For each test case, compute and return a list $[b,r,c]$ where $b$ is a boolean feasibility indicator, $r$ is the floating-point maximum load ratio $\\max_k \\left(\\sum_{e\\in P_k} w_e\\right)/L_{\\mathrm{avg}}$, and $c$ is the integer edge cut $\\mathrm{cut}(a)$.\n- Your program should produce a single line of output containing the results for all test cases as a comma-separated list enclosed in square brackets, with each test case's triple itself enclosed in square brackets. For example, the printed output should look like $[[b_1,r_1,c_1],[b_2,r_2,c_2],[b_3,r_3,c_3],[b_4,r_4,c_4]]$ where each $b_i$ is either $\\mathrm{True}$ or $\\mathrm{False}$, each $r_i$ is a real number, and each $c_i$ is an integer.", "solution": "The problem statement has been validated and is deemed valid. It is scientifically grounded in the principles of parallel computing and computational mechanics, specifically regarding mesh partitioning for finite element analysis. The problem is well-posed, providing a deterministic greedy heuristic with explicit rules for initialization, iteration, tie-breaking, and exceptional/fallback cases. All terms are formally defined, and the test cases are well-specified. The problem is a non-trivial implementation task that correctly formalizes a standard approach to domain decomposition.\n\nThe solution proceeds by first constructing the mesh data structures, then implementing the specified greedy partitioning algorithm, and finally calculating the required output metrics for each test case.\n\n### Step 1: Mesh and Adjacency Graph Construction\n\nThe problem defines a structured mesh of $n_x \\times n_y$ quadrilateral elements. The total number of elements is $N_e = n_x \\cdot n_y$. Elements are indexed $e \\in \\{0, 1, \\dots, N_e-1\\}$ in row-major order, where an element at grid position $(i, j)$ with $i \\in \\{0, \\dots, n_x-1\\}$ and $j \\in \\{0, \\dots, n_y-1\\}$ has index $e = j \\cdot n_x + i$.\n\nThe adjacency graph $G=(E, \\mathcal{A})$ is defined by face adjacencies, where two elements are adjacent if they share two nodes (an edge). For a structured grid, this simplifies to identifying neighbors in the four cardinal directions (left, right, top, bottom). For an element $e = j \\cdot n_x + i$:\n- Its left neighbor is $(j \\cdot n_x + i) - 1$, if $i > 0$.\n- Its right neighbor is $(j \\cdot n_x + i) + 1$, if $i < n_x-1$.\n- Its bottom neighbor is $(j-1) \\cdot n_x + i$, if $j > 0$.\n- Its top neighbor is $(j+1) \\cdot n_x + i$, if $j < n_y-1$.\nThis information is used to build an adjacency list representation, where for each element $e$, we store a list of its adjacent elements.\n\n### Step 2: Algorithm Initialization\n\nFor a given number of processors $p$ and a set of element weights $\\{w_e\\}_{e\\in E}$, we compute the total weight $W = \\sum_{e \\in E} w_e$ and the average load per processor $L_{\\mathrm{avg}} = W/p$. The load balance tolerance $t$ defines the maximum permissible load for any processor as $L_{\\max} = (1+t)L_{\\mathrm{avg}}$.\n\nThe partitioning process is initialized with the following data structures:\n- An assignment array $a$ of size $N_e$, where $a[e]$ will store the processor index for element $e$. Initially, all entries are set to a value indicating \"unassigned,\" e.g., $-1$.\n- A processor loads array of size $p$, tracking the current sum of weights for each processor partition $P_k$. Initially all loads are $0$.\n- A set of unassigned elements, initially containing all elements $E$.\n\nThe initial seeds $S=[s_0, s_1, \\dots, s_{p-1}]$ are processed. For each processor $k \\in \\{0, \\dots, p-1\\}$, if its seed $s_k$ is a valid, unassigned element index (i.e., $s_k \\neq -1$ and has not been claimed by a lower-indexed processor), element $s_k$ is assigned to processor $k$. The assignment array, processor loads, and the set of unassigned elements are updated accordingly.\n\n### Step 3: Iterative Greedy Assignment\n\nThe algorithm proceeds in a loop until all elements are assigned. In each step, it attempts to find the \"best\" element to assign based on a multi-criteria score.\n\n1.  **Frontier-Based Candidate Selection**: For each processor $k$, a frontier is formed, consisting of all unassigned elements that are adjacent to at least one element already assigned to processor $k$. Each element in each processor's frontier becomes a candidate for assignment.\n\n2.  **Candidate Scoring and Tie-Breaking**: A candidate assignment of element $e$ to processor $k$ is evaluated only if it is admissible, i.e., if adding $w_e$ to processor $k$'s current load does not exceed $L_{\\max}$. Admissible candidates are scored based on a lexicographical ordering to find the globally best move:\n    a. Maximize the local connectivity score $s_k(e)$, defined as the number of neighbors of $e$ already assigned to processor $k$.\n    b. Minimize the number of neighbors of $e$ that have been assigned to any other processor $j \\neq k$.\n    c. Minimize the element weight $w_e$.\n    d. Minimize the element index $e$.\n\n    The best move is the one with the lexicographically largest score tuple $(s_k(e), \\text{-external\\_neighbors}, -w_e, -e)$.\n\n3.  **Move Execution**:\n    - If a best admissible move is found from the frontiers, the corresponding element is assigned to its new processor, and all state variables are updated.\n    - If no admissible moves are available on any frontier, a fallback strategy is employed:\n        i. Identify the unassigned element $e_{\\text{lightest}}$ with the minimum weight $w_e$, breaking ties with the smallest element index $e$.\n        ii. Find the processor $k_{\\text{best}}$ that can accommodate this element (i.e., `load` $+ w_{e_{\\text{lightest}}} \\le L_{\\max}$) and currently has the minimum load. Ties are broken by the smallest processor index $k$. If such a processor exists, $e_{\\text{lightest}}$ is assigned to $k_{\\text{best}}$.\n        iii. If no processor can accommodate $e_{\\text{lightest}}$, the problem requires assigning it to the processor with the absolute minimum load, even though this violates the $L_{\\max}$ constraint. The problem states that such an assignment renders the final partition infeasible.\n\n### Step 4: Final Result Calculation\n\nOnce all elements have been assigned, the final partition is evaluated:\n- **Feasibility ($b$)**: The partition is feasible if and only if the final load of every processor $k$ is less than or equal to $L_{\\max}$. This is a direct application of the definition provided in the problem statement.\n- **Maximum Load Ratio ($r$)**: This is computed as $\\frac{\\max_k(\\sum_{e \\in P_k} w_e)}{L_{\\mathrm{avg}}}$. If $L_{\\mathrm{avg}}=0$, this ratio is taken to be $0$ (though not possible with $w_e > 0$).\n- **Edge Cut ($c$)**: This is the total number of edges $\\{e_i, e_j\\}$ in the adjacency graph $\\mathcal{A}$ such that $a[e_i] \\neq a[e_j]$. This is calculated by iterating through all elements and their neighbors, taking care to count each cut edge only once.\n\nThis comprehensive procedure is applied to each test case to produce the required results.", "answer": "[[True,1.0,3],[True,1.0,2],[False,1.25,1],[True,2.0,1]]", "id": "3526228"}]}