{"hands_on_practices": [{"introduction": "The conservation laws are most powerfully illustrated when applied to phenomena involving sharp discontinuities, such as shock waves. This exercise guides you through the foundational derivation of the Rankine-Hugoniot relations, which govern the changes in fluid properties across a normal shock. By starting from the integral form of the conservation of mass, momentum, and energy, you will develop the essential analytical skills to connect the pre-shock and post-shock states, a fundamental capability required for modeling and understanding supersonic flows ([@problem_id:3521200]).", "problem": "Consider a one-dimensional, planar, stationary shock in a compressible ideal gas with adiabatic index $\\gamma$, modeled by the compressible Euler equations in conservation form. The upstream state, far to the left of the shock, is uniform with pressure $p_1$, density $\\rho_1$, and velocity $u_1$ directed toward the shock. The upstream Mach number is defined by $M_1 = u_1 / c_1$, where the upstream sound speed is $c_1 = \\sqrt{\\gamma p_1 / \\rho_1}$. Assume the shock is steady in the chosen frame and that the gas satisfies the ideal-gas equation of state. \n\nStarting from the conservation laws of mass, momentum, and energy across a steady discontinuity (the Rankine–Hugoniot conditions, RH), and using only the ideal-gas equation of state and the definition of Mach number, derive closed-form expressions for the downstream pressure $p_2$, velocity $u_2$, and density $\\rho_2$ in terms of $p_1$, $u_1$, $\\rho_1$, $M_1$, and $\\gamma$. Clearly state any physical admissibility conditions you use in the derivation. Do not assume isentropic flow across the shock. \n\nExpress your final answer as analytic expressions for $(p_2, u_2, \\rho_2)$ depending only on $(p_1, u_1, \\rho_1, M_1, \\gamma)$. No numerical evaluation is required, and no rounding is necessary. The answer must be provided as a single row matrix containing $p_2$, $u_2$, and $\\rho_2$, in that order.", "solution": "The problem statement has been validated and is deemed valid. It is a well-posed, scientifically grounded problem from the field of gas dynamics, which is a core component of computational astrophysics. The problem is self-contained and provides all necessary information to derive the requested expressions.\n\nThe derivation begins with the Rankine-Hugoniot conditions, which express the conservation of mass, momentum, and energy across a steady, one-dimensional shock front. In the frame where the shock is stationary, these are:\n$1$. Conservation of mass:\n$$ \\rho_1 u_1 = \\rho_2 u_2 \\quad (1) $$\n$2$. Conservation of momentum:\n$$ p_1 + \\rho_1 u_1^2 = p_2 + \\rho_2 u_2^2 \\quad (2) $$\n$3$. Conservation of energy:\n$$ \\rho_1 u_1 \\left( e_1 + \\frac{p_1}{\\rho_1} + \\frac{1}{2}u_1^2 \\right) = \\rho_2 u_2 \\left( e_2 + \\frac{p_2}{\\rho_2} + \\frac{1}{2}u_2^2 \\right) \\quad (3) $$\nwhere $\\rho$, $u$, $p$, and $e$ are the density, velocity, pressure, and specific internal energy, respectively. The subscripts $1$ and $2$ denote the upstream (pre-shock) and downstream (post-shock) states.\n\nUsing the mass conservation equation $(1)$, the energy equation $(3)$ simplifies to the conservation of specific total enthalpy:\n$$ h_1 + \\frac{1}{2}u_1^2 = h_2 + \\frac{1}{2}u_2^2 \\quad (4) $$\nwhere $h = e + p/\\rho$ is the specific enthalpy.\n\nFor an ideal gas, the specific internal energy is $e = \\frac{p}{(\\gamma-1)\\rho}$, where $\\gamma$ is the adiabatic index. The specific enthalpy is therefore:\n$$ h = \\frac{p}{(\\gamma-1)\\rho} + \\frac{p}{\\rho} = \\frac{\\gamma p}{(\\gamma-1)\\rho} $$\n\nTo relate the thermodynamic states across the shock, we first manipulate the conservation laws. Let the constant mass flux be $J = \\rho_1 u_1 = \\rho_2 u_2$.\nFrom $(1)$, $u_2 = u_1 (\\rho_1/\\rho_2)$.\nFrom $(2)$, the pressure difference is $p_2 - p_1 = \\rho_1 u_1^2 - \\rho_2 u_2^2 = J u_1 - J u_2 = J(u_1 - u_2)$.\nAlso from $(2)$, $p_2 - p_1 = \\rho_1 u_1^2 - \\rho_2 (\\frac{\\rho_1 u_1}{\\rho_2})^2 = \\rho_1 u_1^2 - \\frac{(\\rho_1 u_1)^2}{\\rho_2} = (\\rho_1 u_1)^2 (\\frac{1}{\\rho_1} - \\frac{1}{\\rho_2}) = J^2 (\\frac{1}{\\rho_1} - \\frac{1}{\\rho_2})$.\n\nFrom $(4)$, the change in specific enthalpy is $h_2 - h_1 = \\frac{1}{2}(u_1^2 - u_2^2) = \\frac{1}{2}(u_1 - u_2)(u_1 + u_2)$.\nSubstituting $u_1 = J/\\rho_1$ and $u_2 = J/\\rho_2$, we have $u_1 - u_2 = J(\\frac{1}{\\rho_1} - \\frac{1}{\\rho_2})$ and $u_1 + u_2 = J(\\frac{1}{\\rho_1} + \\frac{1}{\\rho_2})$.\nThus, $h_2 - h_1 = \\frac{1}{2} J^2 (\\frac{1}{\\rho_1} - \\frac{1}{\\rho_2})(\\frac{1}{\\rho_1} + \\frac{1}{\\rho_2})$.\nSubstituting $J^2(\\frac{1}{\\rho_1} - \\frac{1}{\\rho_2}) = p_2 - p_1$, we arrive at the Rankine-Hugoniot relation for thermodynamic variables:\n$$ h_2 - h_1 = \\frac{1}{2} (p_2 - p_1)\\left(\\frac{1}{\\rho_1} + \\frac{1}{\\rho_2}\\right) $$\nSubstituting the ideal gas enthalpy $h = \\frac{\\gamma p}{(\\gamma-1)\\rho}$:\n$$ \\frac{\\gamma}{\\gamma-1}\\left(\\frac{p_2}{\\rho_2} - \\frac{p_1}{\\rho_1}\\right) = \\frac{1}{2}(p_2 - p_1)\\left(\\frac{1}{\\rho_1} + \\frac{1}{\\rho_2}\\right) $$\nTo find the relation between the density ratio $\\rho_2/\\rho_1$ and the pressure ratio $p_2/p_1$, we rearrange this equation. Let $Y = p_2/p_1$ and $X = \\rho_2/\\rho_1$.\n$$ \\frac{\\gamma}{\\gamma-1}\\left(\\frac{p_1 Y}{\\rho_1 X} - \\frac{p_1}{\\rho_1}\\right) = \\frac{1}{2}(p_1 Y - p_1)\\left(\\frac{1}{\\rho_1} + \\frac{1}{\\rho_1 X}\\right) $$\nDividing by $p_1/\\rho_1$, we get:\n$$ \\frac{\\gamma}{\\gamma-1}\\left(\\frac{Y}{X} - 1\\right) = \\frac{1}{2}(Y-1)\\left(1 + \\frac{1}{X}\\right) $$\n$$ \\frac{2\\gamma}{\\gamma-1}\\frac{Y-X}{X} = (Y-1)\\frac{X+1}{X} $$\n$$ 2\\gamma(Y-X) = (\\gamma-1)(Y-1)(X+1) $$\nSolving for $X$ in terms of $Y$:\n$$ 2\\gamma Y - 2\\gamma X = (\\gamma-1)(YX + Y - X - 1) $$\n$$ X[-2\\gamma - (\\gamma-1)Y + (\\gamma-1)] = -2\\gamma Y + (\\gamma-1)Y - (\\gamma-1) $$\n$$ X[-(\\gamma+1) - (\\gamma-1)Y] = -(\\gamma+1)Y - (\\gamma-1) $$\n$$ X[(\\gamma-1)Y + (\\gamma+1)] = (\\gamma+1)Y + (\\gamma-1) $$\nThis yields the expression for the density ratio in terms of the pressure ratio:\n$$ \\frac{\\rho_2}{\\rho_1} = \\frac{(\\gamma+1)\\frac{p_2}{p_1} + (\\gamma-1)}{(\\gamma-1)\\frac{p_2}{p_1} + (\\gamma+1)} \\quad (5) $$\nNext, we relate the pressure ratio to the upstream Mach number, $M_1 = u_1/c_1$, where $c_1^2 = \\gamma p_1 / \\rho_1$. From the momentum equation $(2)$:\n$$ p_2 - p_1 = \\rho_1 u_1^2 - \\rho_2 u_2^2 = \\rho_1 u_1^2 (1 - \\frac{\\rho_2 u_2^2}{\\rho_1 u_1^2}) $$\nUsing $\\rho_1 u_1 = \\rho_2 u_2$, we can write $\\frac{\\rho_2 u_2^2}{\\rho_1 u_1^2} = \\frac{(\\rho_2 u_2)u_2}{(\\rho_1 u_1)u_1} = \\frac{u_2}{u_1} = \\frac{\\rho_1}{\\rho_2}$.\n$$ p_2 - p_1 = \\rho_1 u_1^2 \\left(1 - \\frac{\\rho_1}{\\rho_2}\\right) $$\nDividing by $p_1$:\n$$ \\frac{p_2}{p_1} - 1 = \\frac{\\rho_1 u_1^2}{p_1} \\left(1 - \\frac{\\rho_1}{\\rho_2}\\right) $$\nThe term $\\frac{\\rho_1 u_1^2}{p_1}$ can be rewritten using the definitions of $M_1$ and $c_1$:\n$$ \\frac{\\rho_1 u_1^2}{p_1} = \\frac{\\gamma \\rho_1 u_1^2}{\\gamma p_1} = \\gamma \\frac{u_1^2}{c_1^2} = \\gamma M_1^2 $$\nSo, we have:\n$$ \\frac{p_2}{p_1} - 1 = \\gamma M_1^2 \\left(1 - \\frac{\\rho_1}{\\rho_2}\\right) \\quad (6) $$\nWe now solve the system of equations $(5)$ and $(6)$ for $p_2/p_1$ and $\\rho_2/\\rho_1$. From $(6)$, we express $\\rho_1/\\rho_2$ and substitute it into the inverted form of $(5)$:\n$$ \\frac{\\rho_1}{\\rho_2} = \\frac{(\\gamma-1)\\frac{p_2}{p_1} + (\\gamma+1)}{(\\gamma+1)\\frac{p_2}{p_1} + (\\gamma-1)} $$\n$$ 1 - \\frac{1}{\\gamma M_1^2}\\left(\\frac{p_2}{p_1} - 1\\right) = \\frac{(\\gamma-1)\\frac{p_2}{p_1} + (\\gamma+1)}{(\\gamma+1)\\frac{p_2}{p_1} + (\\gamma-1)} $$\nLet $Y = p_2/p_1$.\nA physical shock requires $p_2 > p_1$ and $\\rho_2 > \\rho_1$. This implies that entropy increases, which is only possible for a compressive shock if the upstream flow is supersonic, i.e., $M_1 > 1$. This is the physical admissibility condition. The trivial solution $M_1=1$ leads to $p_2=p_1$, $\\rho_2=\\rho_1$, $u_2=u_1$, i.e., no shock.\nAssuming $Y \\neq 1$, we can solve for $Y$. A more direct path is to substitute $\\rho_2/\\rho_1$ from $(5)$ into $(6)$.\n$$ Y-1 = \\gamma M_1^2 \\left(1 - \\frac{(\\gamma-1)Y + (\\gamma+1)}{(\\gamma+1)Y + (\\gamma-1)}\\right) = \\gamma M_1^2 \\left(\\frac{(\\gamma+1)Y + (\\gamma-1) - ((\\gamma-1)Y + (\\gamma+1))}{(\\gamma+1)Y + (\\gamma-1)}\\right) $$\n$$ Y-1 = \\gamma M_1^2 \\left(\\frac{2Y - 2}{(\\gamma+1)Y + (\\gamma-1)}\\right) = \\frac{2\\gamma M_1^2(Y-1)}{(\\gamma+1)Y + \\gamma-1} $$\nFor a shock, $Y \\neq 1$, so we can divide by $(Y-1)$:\n$$ 1 = \\frac{2\\gamma M_1^2}{(\\gamma+1)Y + \\gamma-1} $$\n$$ (\\gamma+1)Y + \\gamma-1 = 2\\gamma M_1^2 $$\n$$ (\\gamma+1)Y = 2\\gamma M_1^2 - (\\gamma-1) $$\n$$ \\frac{p_2}{p_1} = \\frac{2\\gamma M_1^2 - (\\gamma-1)}{\\gamma+1} $$\nThus, the downstream pressure is:\n$$ p_2 = p_1 \\left( \\frac{2\\gamma M_1^2 - (\\gamma-1)}{\\gamma+1} \\right) $$\nTo find the density $\\rho_2$, we use equation $(6)$:\n$$ \\frac{\\rho_1}{\\rho_2} = 1 - \\frac{1}{\\gamma M_1^2}\\left(\\frac{p_2}{p_1} - 1\\right) $$\n$$ \\frac{p_2}{p_1} - 1 = \\frac{2\\gamma M_1^2 - (\\gamma-1) - (\\gamma+1)}{\\gamma+1} = \\frac{2\\gamma M_1^2 - 2\\gamma}{\\gamma+1} = \\frac{2\\gamma(M_1^2-1)}{\\gamma+1} $$\n$$ \\frac{\\rho_1}{\\rho_2} = 1 - \\frac{1}{\\gamma M_1^2}\\frac{2\\gamma(M_1^2-1)}{\\gamma+1} = 1 - \\frac{2(M_1^2-1)}{M_1^2(\\gamma+1)} = \\frac{M_1^2(\\gamma+1) - 2M_1^2 + 2}{M_1^2(\\gamma+1)} = \\frac{(\\gamma-1)M_1^2 + 2}{(\\gamma+1)M_1^2} $$\nInverting this gives the density ratio:\n$$ \\frac{\\rho_2}{\\rho_1} = \\frac{(\\gamma+1)M_1^2}{(\\gamma-1)M_1^2 + 2} $$\nSo the downstream density is:\n$$ \\rho_2 = \\rho_1 \\left( \\frac{(\\gamma+1)M_1^2}{(\\gamma-1)M_1^2 + 2} \\right) $$\nFinally, the downstream velocity $u_2$ is found from the mass conservation equation $(1)$:\n$$ u_2 = u_1 \\left( \\frac{\\rho_1}{\\rho_2} \\right) = u_1 \\left( \\frac{(\\gamma-1)M_1^2 + 2}{(\\gamma+1)M_1^2} \\right) $$\nThese three expressions provide the downstream state $(p_2, u_2, \\rho_2)$ in terms of the upstream state $(p_1, u_1, \\rho_1)$, the Mach number $M_1$, and the adiabatic index $\\gamma$.", "answer": "$$ \\boxed{\\begin{pmatrix} p_1 \\left( \\frac{2\\gamma M_1^2 - (\\gamma-1)}{\\gamma+1} \\right) & u_1 \\left( \\frac{(\\gamma-1)M_1^2 + 2}{(\\gamma+1)M_1^2} \\right) & \\rho_1 \\left( \\frac{(\\gamma+1)M_1^2}{(\\gamma-1)M_1^2 + 2} \\right) \\end{pmatrix}} $$", "id": "3521200"}, {"introduction": "A physically realistic simulation must satisfy not only the conservation of energy but also the second law of thermodynamics. This practice explores the intimate connection between these two principles by calculating the entropy generated by an irreversible process—heat conduction. By first solving the steady-state energy equation to find the heat flow, you will then use the result to quantify the total entropy production rate, verifying that it is always non-negative ([@problem_id:3499241]). This analysis is a crucial tool for ensuring that numerical models do not violate the fundamental directionality of physical processes.", "problem": "A rigid, homogeneous rod of length $L$ and constant cross-sectional area $A$ conducts heat in one-dimensional (1D) steady state along the $x$-axis from $x=0$ to $x=L$. The lateral surface is perfectly insulated. The temperature at the ends is fixed at $T(0)=T_{0}$ and $T(L)=T_{L}$ with $T_{0}>T_{L}>0$. The temperature-dependent thermal conductivity is a known positive function $k(T)$ that is continuous on the closed interval between $T_{L}$ and $T_{0}$. There are no internal heat sources, no mass flow, and no mechanical work; the medium is at rest.\n\nStarting only from the local conservation of energy, Fourier’s law of heat conduction, and the second-law entropy balance with entropy flux defined by heat flux divided by temperature, derive a closed-form analytical expression for the total entropy production rate in the rod at steady state. Then verify that this expression is nonnegative for all admissible data and identify when it is exactly zero. Express the final entropy production rate in watts per kelvin (W/K). Provide your final result as a single closed-form analytic expression in terms of $A$, $L$, $T_{0}$, $T_{L}$, and $k(T)$. No numerical evaluation is required, and no inequalities are to be given as the final answer.", "solution": "The problem is deemed valid as it is scientifically grounded, well-posed, and objective, with a complete and consistent setup based on established principles of thermodynamics and heat transfer.\n\nWe begin by applying the local conservation of energy for the specified system. The problem states that the heat conduction is one-dimensional (along the $x$-axis), at steady state, and there are no internal heat sources, no mass flow, and no mechanical work. The energy conservation equation for a differential control volume $dV = A\\,dx$ simplifies to the statement that the heat flow rate, $\\dot{Q}$, is constant along the rod. The heat flow rate is the product of the heat flux, $\\dot{q}_x$, and the cross-sectional area, $A$. Thus, $\\dot{Q} = A \\dot{q}_x = \\text{constant}$.\n\nFourier's law of heat conduction relates the heat flux to the temperature gradient. In one dimension, this is given by:\n$$\n\\dot{q}_x = -k(T) \\frac{dT}{dx}\n$$\nwhere $k(T)$ is the temperature-dependent thermal conductivity. The total heat flow rate is therefore:\n$$\n\\dot{Q} = -A k(T) \\frac{dT}{dx}\n$$\nSince $\\dot{Q}$ and $A$ are constant, we can separate variables to solve for $\\dot{Q}$. We rearrange the equation as:\n$$\n\\dot{Q} \\, dx = -A k(T) \\, dT\n$$\nWe integrate this expression over the length of the rod, from $x=0$ to $x=L$. The corresponding temperature limits are from $T(0)=T_0$ to $T(L)=T_L$:\n$$\n\\int_{0}^{L} \\dot{Q} \\, dx = \\int_{T_0}^{T_L} -A k(T) \\, dT\n$$\nSince $\\dot{Q}$ is constant, it can be taken out of the integral on the left side. We can also reverse the limits of integration on the right side, which changes the sign:\n$$\n\\dot{Q} \\int_{0}^{L} dx = A \\int_{T_L}^{T_0} k(T) \\, dT\n$$\nPerforming the integration on the left side yields:\n$$\n\\dot{Q}L = A \\int_{T_L}^{T_0} k(T) \\, dT\n$$\nFrom this, we obtain an expression for the constant heat flow rate:\n$$\n\\dot{Q} = \\frac{A}{L} \\int_{T_L}^{T_0} k(T) \\, dT\n$$\nNext, we apply the second-law entropy balance to the entire rod, which we treat as a single control volume. For a steady-state process, the rate of change of entropy within the control volume is zero. The entropy balance equation is:\n$$\n\\frac{dS_{CV}}{dt} = \\sum_{\\text{in}} \\dot{S} - \\sum_{\\text{out}} \\dot{S} + \\dot{S}_{gen, total} = 0\n$$\nwhere $\\dot{S}_{gen, total}$ is the total rate of entropy production within the rod. The entropy transfer, $\\dot{S}$, occurs solely by heat transfer at the boundaries, as there is no mass flow. The problem statement defines the entropy flux as the heat flux divided by temperature. Therefore, the rate of entropy transfer associated with a heat flow rate $\\dot{Q}$ at a boundary with temperature $T$ is $\\frac{\\dot{Q}}{T}$.\n\nHeat flows from the hot end to the cold end, so $\\dot{Q}$ enters the control volume at $x=0$ (temperature $T_0$) and exits at $x=L$ (temperature $T_L$). The entropy balance for the rod is:\n$$\n0 = \\frac{\\dot{Q}}{T_0} - \\frac{\\dot{Q}}{T_L} + \\dot{S}_{gen, total}\n$$\nSolving for the total entropy production rate, we get:\n$$\n\\dot{S}_{gen, total} = \\frac{\\dot{Q}}{T_L} - \\frac{\\dot{Q}}{T_0} = \\dot{Q} \\left( \\frac{1}{T_L} - \\frac{1}{T_0} \\right)\n$$\nThis expression is the fundamental result from the global entropy balance. Now, we substitute the previously derived expression for the heat flow rate $\\dot{Q}$:\n$$\n\\dot{S}_{gen, total} = \\left( \\frac{A}{L} \\int_{T_L}^{T_0} k(T) \\, dT \\right) \\left( \\frac{1}{T_L} - \\frac{1}{T_0} \\right)\n$$\nThis is the final closed-form analytical expression for the total entropy production rate in the rod.\n\nFinally, we must verify that this expression is non-negative, as required by the second law of thermodynamics. We analyze the sign of each term in the expression:\n1. The physical dimensions $A$ and $L$ are positive, so $\\frac{A}{L} > 0$.\n2. The problem states that the thermal conductivity $k(T)$ is a positive function. The integration is performed from $T_L$ to $T_0$. According to the problem statement, $T_0 > T_L > 0$. Since the integrand $k(T)$ is positive over the entire interval of integration $[T_L, T_0]$, and the interval has a positive width ($T_0-T_L > 0$), the definite integral $\\int_{T_L}^{T_0} k(T) \\, dT$ must be positive.\n3. For the term $\\left(\\frac{1}{T_L} - \\frac{1}{T_0}\\right)$, since $T_0 > T_L > 0$, it follows that $\\frac{1}{T_L} > \\frac{1}{T_0}$. Therefore, this term is also positive.\n\nThe total entropy production rate $\\dot{S}_{gen, total}$ is a product of terms that are all positive. Thus, $\\dot{S}_{gen, total} > 0$ whenever there is a temperature difference.\n\nThe entropy production rate is exactly zero, $\\dot{S}_{gen, total}=0$, if and only if one of the multiplicative factors is zero. Since $A>0$ and $L>0$, this can only happen if either $\\int_{T_L}^{T_0} k(T) \\, dT = 0$ or $\\left(\\frac{1}{T_L} - \\frac{1}{T_0}\\right) = 0$. Since $k(T)$ is positive and continuous, its integral is zero only if the interval of integration is of zero width, i.e., $T_0 = T_L$. The second term is also zero only if $T_0 = T_L$. This physical condition corresponds to thermal equilibrium, where there is no temperature gradient, no heat flow ($\\dot{Q}=0$), and thus no entropy production, which is consistent with the principles of thermodynamics.", "answer": "$$\n\\boxed{\\left( \\frac{A}{L} \\int_{T_L}^{T_0} k(T) \\, dT \\right) \\left( \\frac{1}{T_L} - \\frac{1}{T_0} \\right)}\n$$", "id": "3499241"}, {"introduction": "Applying conservation laws becomes particularly challenging in multiphysics problems involving moving interfaces and phase change, where they manifest as jump conditions. This practice moves from pure theory to the realm of computational simulation, focusing on an evaporating liquid-vapor interface. You will first apply mass and energy conservation to determine the interface dynamics, and then confront a common numerical artifact—mass loss from algorithmic procedures—and develop a correction to restore global conservation ([@problem_id:3499248]). This exercise highlights the critical need for vigilance in ensuring that numerical schemes honor the physical principles they are meant to solve.", "problem": "Consider a one-dimensional two-phase domain of length $L$ (in $\\mathrm{m}$) with unit cross-sectional area $A = 1\\,\\mathrm{m}^2$, consisting of a liquid and a vapor separated by a moving sharp interface. The interface is tracked by a Level Set Method (LSM), with a level set function $\\phi(x,t)$ that is negative in the liquid and positive in the vapor, and initially equal to the signed distance $\\phi(x,0) = x - x_0$, where $x_0$ (in $\\mathrm{m}$) denotes the initial interface location. The unit normal $\\mathbf{n}$ points from liquid toward vapor. The liquid has constant density $\\rho_l$ (in $\\mathrm{kg}/\\mathrm{m}^3$), and the vapor has constant density $\\rho_v$ (in $\\mathrm{kg}/\\mathrm{m}^3$). The bulk liquid velocity satisfies $u_l = 0$ (in $\\mathrm{m}/\\mathrm{s}$). The latent heat of vaporization is $h_{lv}$ (in $\\mathrm{J}/\\mathrm{kg}$). The heat fluxes normal to the interface on the vapor and liquid sides are given as constants $q_v$ and $q_l$ (in $\\mathrm{W}/\\mathrm{m}^2$). The interfacial mass transfer rate per unit area is $\\dot{m}$ (in $\\mathrm{kg}/(\\mathrm{m}^2\\,\\mathrm{s})$), and the interfacial normal speed is $V_n$ (in $\\mathrm{m}/\\mathrm{s}$). Assume a short time step $\\Delta t$ (in $\\mathrm{s}$) such that the interface remains inside the domain. The level set advection is modeled by the Hamilton-Jacobi form consistent with signed distance, $\\phi_t + V_n \\lvert \\nabla \\phi \\rvert = 0$, and for the signed-distance initial condition one may use $\\lvert \\nabla \\phi \\rvert = 1$ to update $\\phi$ as $\\phi^{n+1}(x) = \\phi^n(x) - \\Delta t\\, V_n$, thereby updating the interface position from $x_{\\mathrm{int}}^n$ to $x_{\\mathrm{int}}^{n+1} = x_{\\mathrm{int}}^n + \\Delta t\\, V_n$. The vapor-side velocity $u_v$ (in $\\mathrm{m}/\\mathrm{s}$) is unknown and must be consistent with conservation of mass. After advection, a reinitialization step is known to cause spurious mass loss by perturbing the zero level set. To emulate this, define a reinitialized level set as $\\phi^{\\mathrm{re}}(x) = \\phi^{n+1}(x) + \\gamma$, where $\\gamma$ (in $\\mathrm{m}$) is a small constant offset. This shifts the interface location to $x_{\\mathrm{int}}^{\\mathrm{re}} = x_{\\mathrm{int}}^{n+1} - \\gamma$, potentially changing the total mass.\n\nStarting from conservation of energy and conservation of mass applied to an infinitesimal control volume straddling the interface, and the definition of latent heat of vaporization, derive expressions that determine $\\dot{m}$ and $V_n$ consistently with the given data, and determine $u_v$ such that the interfacial mass conservation condition is satisfied. Using these, perform one advection step of the level set to compute $x_{\\mathrm{int}}^{n+1}$, then apply the reinitialization $\\gamma$ and compute the total mass before and after reinitialization:\n- $M_{\\mathrm{before}} = \\rho_l\\, x_{\\mathrm{int}}^{n+1}\\, A + \\rho_v\\, \\left(L - x_{\\mathrm{int}}^{n+1}\\right) A$,\n- $M_{\\mathrm{after}} = \\rho_l\\, x_{\\mathrm{int}}^{\\mathrm{re}}\\, A + \\rho_v\\, \\left(L - x_{\\mathrm{int}}^{\\mathrm{re}}\\right) A$,\n\nand quantify the mass error $\\Delta M = M_{\\mathrm{after}} - M_{\\mathrm{before}}$ (in $\\mathrm{kg}$). Propose and implement a conservative correction that applies a constant shift $\\delta_c$ (in $\\mathrm{m}$) to the reinitialized level set (i.e., replace $\\phi^{\\mathrm{re}}(x)$ by $\\phi^{\\mathrm{re}}(x) - \\delta_c$) so that the corrected total mass $M_{\\mathrm{corr}}$ exactly equals $M_{\\mathrm{before}}$. Report the corrected mass error $\\Delta M_{\\mathrm{corr}} = M_{\\mathrm{corr}} - M_{\\mathrm{before}}$ (in $\\mathrm{kg}$).\n\nYour program must compute, for each test case, three quantities:\n- the interfacial mass transfer rate $\\dot{m}$ in $\\mathrm{kg}/(\\mathrm{m}^2\\,\\mathrm{s})$,\n- the uncorrected mass error $\\Delta M$ in $\\mathrm{kg}$ due to reinitialization,\n- the corrected mass error $\\Delta M_{\\mathrm{corr}}$ in $\\mathrm{kg}$ after applying the conservative correction.\n\nExpress all three outputs as decimal floating-point numbers. The normal direction is from liquid to vapor; evaporation corresponds to $\\dot{m} > 0$, condensation to $\\dot{m} < 0$.\n\nTest suite parameter sets:\n- Case $1$ (happy path, evaporation): $L = 0.1\\,\\mathrm{m}$, $x_0 = 0.06\\,\\mathrm{m}$, $\\rho_l = 1000\\,\\mathrm{kg}/\\mathrm{m}^3$, $\\rho_v = 0.6\\,\\mathrm{kg}/\\mathrm{m}^3$, $h_{lv} = 2.26\\times 10^6\\,\\mathrm{J}/\\mathrm{kg}$, $q_v = 1200\\,\\mathrm{W}/\\mathrm{m}^2$, $q_l = 200\\,\\mathrm{W}/\\mathrm{m}^2$, $\\Delta t = 0.01\\,\\mathrm{s}$, $\\gamma = 1\\times 10^{-4}\\,\\mathrm{m}$.\n- Case $2$ (boundary: zero energy jump): $L = 0.12\\,\\mathrm{m}$, $x_0 = 0.05\\,\\mathrm{m}$, $\\rho_l = 950\\,\\mathrm{kg}/\\mathrm{m}^3$, $\\rho_v = 0.7\\,\\mathrm{kg}/\\mathrm{m}^3$, $h_{lv} = 2.26\\times 10^6\\,\\mathrm{J}/\\mathrm{kg}$, $q_v = 1000\\,\\mathrm{W}/\\mathrm{m}^2$, $q_l = 1000\\,\\mathrm{W}/\\mathrm{m}^2$, $\\Delta t = 0.01\\,\\mathrm{s}$, $\\gamma = 5\\times 10^{-4}\\,\\mathrm{m}$.\n- Case $3$ (condensation: negative energy jump): $L = 0.2\\,\\mathrm{m}$, $x_0 = 0.15\\,\\mathrm{m}$, $\\rho_l = 1000\\,\\mathrm{kg}/\\mathrm{m}^3$, $\\rho_v = 0.6\\,\\mathrm{kg}/\\mathrm{m}^3$, $h_{lv} = 2.26\\times 10^6\\,\\mathrm{J}/\\mathrm{kg}$, $q_v = 500\\,\\mathrm{W}/\\mathrm{m}^2$, $q_l = 1000\\,\\mathrm{W}/\\mathrm{m}^2$, $\\Delta t = 0.02\\,\\mathrm{s}$, $\\gamma = 2\\times 10^{-4}\\,\\mathrm{m}$.\n- Case $4$ (near-density match): $L = 0.08\\,\\mathrm{m}$, $x_0 = 0.04\\,\\mathrm{m}$, $\\rho_l = 10\\,\\mathrm{kg}/\\mathrm{m}^3$, $\\rho_v = 8\\,\\mathrm{kg}/\\mathrm{m}^3$, $h_{lv} = 1.0\\times 10^6\\,\\mathrm{J}/\\mathrm{kg}$, $q_v = 300\\,\\mathrm{W}/\\mathrm{m}^2$, $q_l = 0\\,\\mathrm{W}/\\mathrm{m}^2$, $\\Delta t = 0.005\\,\\mathrm{s}$, $\\gamma = 1\\times 10^{-4}\\,\\mathrm{m}$.\n- Case $5$ (edge: no reinitialization perturbation): $L = 0.1\\,\\mathrm{m}$, $x_0 = 0.03\\,\\mathrm{m}$, $\\rho_l = 1000\\,\\mathrm{kg}/\\mathrm{m}^3$, $\\rho_v = 0.6\\,\\mathrm{kg}/\\mathrm{m}^3$, $h_{lv} = 2.26\\times 10^6\\,\\mathrm{J}/\\mathrm{kg}$, $q_v = 1100\\,\\mathrm{W}/\\mathrm{m}^2$, $q_l = 900\\,\\mathrm{W}/\\mathrm{m}^2$, $\\Delta t = 0.01\\,\\mathrm{s}$, $\\gamma = 0\\,\\mathrm{m}$.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with elements ordered by test case and, for each case, the three quantities in order $\\left[\\dot{m}, \\Delta M, \\Delta M_{\\mathrm{corr}}\\right]$. Specifically, print\n$[\\dot{m}_1, \\Delta M_1, \\Delta M_{\\mathrm{corr},1}, \\dot{m}_2, \\Delta M_2, \\Delta M_{\\mathrm{corr},2}, \\ldots, \\dot{m}_5, \\Delta M_5, \\Delta M_{\\mathrm{corr},5}]$,\nwith $\\dot{m}$ in $\\mathrm{kg}/(\\mathrm{m}^2\\,\\mathrm{s})$ and both mass errors in $\\mathrm{kg}$, expressed as decimal numbers.", "solution": "The problem requires an analysis of mass conservation in a one-dimensional, two-phase system undergoing phase change, specifically in the context of numerical errors introduced by a Level Set Method (LSM). We must first derive the physical quantities governing the interface dynamics from fundamental conservation principles, then quantify a numerically-induced mass error, and finally devise and apply a correction to restore mass conservation. The cross-sectional area of the domain is specified as $A = 1\\,\\mathrm{m}^2$.\n\n### 1. Interfacial Conservation Laws\n\nThe dynamics at the sharp interface between the liquid and vapor phases are governed by the Rankine-Hugoniot jump conditions, which represent the conservation of mass, momentum, and energy across the interface. We consider a one-dimensional domain where the interface is located at $x=x_{\\mathrm{int}}(t)$. The unit normal vector $\\mathbf{n}$ points from the liquid (phase $l$) to the vapor (phase $v$) and is taken as the positive $x$-direction.\n\n### 2. Conservation of Energy and Mass Transfer Rate\n\nThe first step is to determine the mass transfer rate per unit area, $\\dot{m}$. This is derived from the energy balance at the interface. The balance states that the net heat flux into the interface is converted into latent heat of vaporization. The energy jump condition across the interface is $\\dot{m} h_{lv} = q_v - q_l$. A positive $\\dot{m}$ signifies evaporation (liquid to vapor), and a negative $\\dot{m}$ signifies condensation (vapor to liquid). This equation allows for the direct calculation of the mass transfer rate:\n$$\n\\dot{m} = \\frac{q_v - q_l}{h_{lv}}\n$$\nThe units are $(\\mathrm{W}/\\mathrm{m}^2) / (\\mathrm{J}/\\mathrm{kg}) = (\\mathrm{J}/(\\mathrm{s} \\cdot \\mathrm{m}^2)) / (\\mathrm{J}/\\mathrm{kg}) = \\mathrm{kg}/(\\mathrm{m}^2 \\cdot \\mathrm{s})$, as required.\n\n### 3. Conservation of Mass and Interface Velocity\n\nThe conservation of mass across the interface relates the mass transfer rate $\\dot{m}$ to the fluid velocities and the interface velocity. The 1D mass jump condition is:\n$$\n\\rho_l (u_l - V_n) = \\rho_v (u_v - V_n)\n$$\nwhere $u_l$ and $u_v$ are the material velocities of the liquid and vapor phases in the $x$-direction, and $V_n$ is the normal velocity of the interface itself. This common quantity is also related to $\\dot{m}$. The mass flux leaving the liquid and entering the vapor is defined as $\\dot{m}$. Thus, we have:\n$$\n\\dot{m} = \\rho_l(V_n - u_l) = \\rho_v(V_n - u_v)\n$$\nGiven that the liquid is stationary, $u_l = 0\\,\\mathrm{m/s}$, the first equality gives a direct expression for the interface velocity $V_n$:\n$$\n\\dot{m} = \\rho_l V_n \\implies V_n = \\frac{\\dot{m}}{\\rho_l}\n$$\nThis determines the speed at which the interface moves. For consistency, the vapor velocity $u_v$ must satisfy the second equality:\n$$\n\\dot{m} = \\rho_v(V_n - u_v) \\implies u_v = V_n - \\frac{\\dot{m}}{\\rho_v} = \\frac{\\dot{m}}{\\rho_l} - \\frac{\\dot{m}}{\\rho_v} = \\dot{m} \\left( \\frac{1}{\\rho_l} - \\frac{1}{\\rho_v} \\right)\n$$\nWhile $u_v$ is determined for completeness, its value is not required for a direct calculation of the mass error.\n\n### 4. Interface Advection and Mass Calculation\n\nThe problem describes a numerical procedure for tracking the interface. Starting with an initial interface position $x_{\\mathrm{int}}^n = x_0$, the position is updated after a time step $\\Delta t$ using the computed interface velocity $V_n$:\n$$\nx_{\\mathrm{int}}^{n+1} = x_{\\mathrm{int}}^n + \\Delta t \\cdot V_n = x_0 + \\Delta t \\frac{\\dot{m}}{\\rho_l}\n$$\nThe total mass in the domain before any numerical correction is the sum of the mass of the liquid and vapor. The liquid occupies the volume from $x=0$ to $x=x_{\\mathrm{int}}^{n+1}$, and the vapor occupies the rest of the domain from $x=x_{\\mathrm{int}}^{n+1}$ to $x=L$.\n$$\nM_{\\mathrm{before}} = \\rho_l \\cdot (x_{\\mathrm{int}}^{n+1} \\cdot A) + \\rho_v \\cdot (L - x_{\\mathrm{int}}^{n+1}) \\cdot A\n$$\nSince $A=1\\,\\mathrm{m}^2$, this simplifies to $M_{\\mathrm{before}} = \\rho_l x_{\\mathrm{int}}^{n+1} + \\rho_v (L - x_{\\mathrm{int}}^{n+1})$.\n\n### 5. Numerical Mass Error from Reinitialization\n\nA common issue in LSM simulations is the numerical error introduced by the reinitialization step, which is necessary to maintain the signed distance property of $\\phi$. The problem models this error as a constant shift $\\gamma$ applied to the level set function, which results in a shift of the interface position:\n$$\nx_{\\mathrm{int}}^{\\mathrm{re}} = x_{\\mathrm{int}}^{n+1} - \\gamma\n$$\nThis shift alters the computed volumes of the two phases, leading to a change in the total mass. The total mass after this artificial shift is:\n$$\nM_{\\mathrm{after}} = \\rho_l \\cdot (x_{\\mathrm{int}}^{\\mathrm{re}} \\cdot A) + \\rho_v \\cdot (L - x_{\\mathrm{int}}^{\\mathrm{re}}) \\cdot A\n$$\nThe uncorrected mass error, $\\Delta M$, is the difference between the mass after and before the reinitialization step:\n$$\n\\Delta M = M_{\\mathrm{after}} - M_{\\mathrm{before}}\n$$\nSubstituting the expressions for the masses:\n$$\n\\Delta M = \\left[ \\rho_l x_{\\mathrm{int}}^{\\mathrm{re}} + \\rho_v (L - x_{\\mathrm{int}}^{\\mathrm{re}}) \\right] A - \\left[ \\rho_l x_{\\mathrm{int}}^{n+1} + \\rho_v (L - x_{\\mathrm{int}}^{n+1}) \\right] A\n$$\n$$\n\\Delta M = \\left( (x_{\\mathrm{int}}^{\\mathrm{re}} - x_{\\mathrm{int}}^{n+1}) \\rho_l - (x_{\\mathrm{int}}^{\\mathrm{re}} - x_{\\mathrm{int}}^{n+1}) \\rho_v \\right) A\n$$\n$$\n\\Delta M = (x_{\\mathrm{int}}^{\\mathrm{re}} - x_{\\mathrm{int}}^{n+1}) (\\rho_l - \\rho_v) A\n$$\nSince $x_{\\mathrm{int}}^{\\mathrm{re}} - x_{\\mathrm{int}}^{n+1} = -\\gamma$, we obtain a direct expression for the mass error:\n$$\n\\Delta M = -\\gamma (\\rho_l - \\rho_v) A\n$$\n\n### 6. Conservative Correction\n\nTo enforce mass conservation, a corrective shift $\\delta_c$ is applied to the reinitialized level set, resulting in a corrected interface position $x_{\\mathrm{int}}^{\\mathrm{corr}} = x_{\\mathrm{int}}^{\\mathrm{re}} + \\delta_c$. The goal is to choose $\\delta_c$ such that the corrected mass, $M_{\\mathrm{corr}}$, is identical to the mass before reinitialization, $M_{\\mathrm{before}}$.\n$$\nM_{\\mathrm{corr}} = \\rho_l \\cdot (x_{\\mathrm{int}}^{\\mathrm{corr}} \\cdot A) + \\rho_v \\cdot (L - x_{\\mathrm{int}}^{\\mathrm{corr}}) \\cdot A\n$$\nSetting $M_{\\mathrm{corr}} = M_{\\mathrm{before}}$:\n$$\n\\left( \\rho_l x_{\\mathrm{int}}^{\\mathrm{corr}} + \\rho_v (L - x_{\\mathrm{int}}^{\\mathrm{corr}}) \\right) A = \\left( \\rho_l x_{\\mathrm{int}}^{n+1} + \\rho_v (L - x_{\\mathrm{int}}^{n+1}) \\right) A\n$$\nAssuming $\\rho_l \\neq \\rho_v$, this equality holds if and only if $x_{\\mathrm{int}}^{\\mathrm{corr}} = x_{\\mathrm{int}}^{n+1}$. Substituting the definition of the corrected position:\n$$\nx_{\\mathrm{int}}^{\\mathrm{re}} + \\delta_c = x_{\\mathrm{int}}^{n+1}\n$$\n$$\n(x_{\\mathrm{int}}^{n+1} - \\gamma) + \\delta_c = x_{\\mathrm{int}}^{n+1}\n$$\nThis yields the required correction shift:\n$$\n\\delta_c = \\gamma\n$$\nApplying this correction restores the interface to its physically correct advected position, thereby perfectly conserving mass. The corrected mass error is, by construction:\n$$\n\\Delta M_{\\mathrm{corr}} = M_{\\mathrm{corr}} - M_{\\mathrm{before}} = 0\n$$\n\n### 7. Summary of Computations\n\nFor each test case, the three required quantities are computed as follows:\n1.  **Mass Transfer Rate**: $\\dot{m} = \\frac{q_v - q_l}{h_{lv}}$.\n2.  **Uncorrected Mass Error**: $\\Delta M = -\\gamma (\\rho_l - \\rho_v) A$, with $A=1\\,\\mathrm{m}^2$. Although this direct formula can be used, we will follow the problem's procedural description by calculating $x_{\\mathrm{int}}^{n+1}$ and the masses explicitly to demonstrate the full process.\n3.  **Corrected Mass Error**: $\\Delta M_{\\mathrm{corr}} = 0$, by definition of the correction.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the multiphysics problem for conservation of mass, momentum, and energy\n    at a moving phase-change interface, including a model for numerical mass error\n    and its correction.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (L, x0, rho_l, rho_v, h_lv, q_v, q_l, dt, gamma)\n    test_cases = [\n        # Case 1 (happy path, evaporation)\n        (0.1, 0.06, 1000, 0.6, 2.26e6, 1200, 200, 0.01, 1e-4),\n        # Case 2 (boundary: zero energy jump)\n        (0.12, 0.05, 950, 0.7, 2.26e6, 1000, 1000, 0.01, 5e-4),\n        # Case 3 (condensation: negative energy jump)\n        (0.2, 0.15, 1000, 0.6, 2.26e6, 500, 1000, 0.02, 2e-4),\n        # Case 4 (near-density match)\n        (0.08, 0.04, 10, 8, 1.0e6, 300, 0, 0.005, 1e-4),\n        # Case 5 (edge: no reinitialization perturbation)\n        (0.1, 0.03, 1000, 0.6, 2.26e6, 1100, 900, 0.01, 0.0),\n    ]\n\n    results = []\n    A = 1.0  # Unit cross-sectional area in m^2\n\n    for case in test_cases:\n        L, x0, rho_l, rho_v, h_lv, q_v, q_l, dt, gamma = case\n\n        # 1. Calculate the interfacial mass transfer rate per unit area (m_dot)\n        # Based on the energy jump condition: m_dot * h_lv = q_v - q_l\n        m_dot = (q_v - q_l) / h_lv\n\n        # 2. Calculate the interface velocity (V_n)\n        # Based on the mass jump condition: m_dot = rho_l * V_n (since u_l = 0)\n        V_n = m_dot / rho_l\n\n        # 3. Perform one advection step to find the new interface position\n        # x_int^{n+1} = x_int^n + dt * V_n\n        # Here, x_int^n is the initial position x0\n        x_int_n1 = x0 + dt * V_n\n\n        # 4. Calculate total mass before reinitialization (M_before)\n        # M = rho_l * V_l + rho_v * V_v = rho_l * (x_int * A) + rho_v * ((L - x_int) * A)\n        M_before = rho_l * x_int_n1 * A + rho_v * (L - x_int_n1) * A\n\n        # 5. Apply the artificial reinitialization shift gamma to the interface\n        x_int_re = x_int_n1 - gamma\n\n        # 6. Calculate total mass after reinitialization (M_after)\n        M_after = rho_l * x_int_re * A + rho_v * (L - x_int_re) * A\n\n        # 7. Quantify the uncorrected mass error (Delta M)\n        delta_M = M_after - M_before\n        \n        # Analytically, delta_M = -gamma * (rho_l - rho_v) * A. \n        # The procedural calculation above is used to strictly follow the problem description.\n\n        # 8. Define the corrected mass error (Delta M_corr)\n        # The correction is designed to make the corrected mass exactly equal to M_before.\n        # Therefore, the corrected mass error is zero by definition.\n        delta_M_corr = 0.0\n\n        results.extend([m_dot, delta_M, delta_M_corr])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.15g}' for r in results)}]\")\n\nsolve()\n```", "id": "3499248"}]}