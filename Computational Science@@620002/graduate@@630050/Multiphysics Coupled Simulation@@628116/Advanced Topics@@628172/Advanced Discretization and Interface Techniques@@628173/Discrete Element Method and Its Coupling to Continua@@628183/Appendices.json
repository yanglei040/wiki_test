{"hands_on_practices": [{"introduction": "The foundation of any robust Discrete Element Method (DEM) simulation is the accurate modeling of contact forces between particles. This practice focuses on a fundamental and crucial algorithm for updating tangential forces, accounting for both elastic deformation and frictional slip according to the Coulomb law [@problem_id:3504405]. By working through this exercise, you will gain hands-on experience with the incremental, predictor-corrector logic that lies at the heart of nearly all modern DEM codes.", "problem": "A single spherical particle modeled by the Discrete Element Method (DEM) is in contact with a smooth elastic continuum boundary. The contact is characterized by a normal force $\\|F_n\\|$ transmitted from the continuum to the particle, and a tangential micro-slip response captured by a linear elastic tangential spring with stiffness $k_t$ until a slip condition governed by the Coulomb friction law limits the tangential force magnitude to $\\mu \\|F_n\\|$. The particle also experiences rolling resistance at the contact, modeled as a torque proportional to the normal force, an effective contact radius $R^\\ast$, and the magnitude of the rolling rotation increment $\\|\\Delta \\theta_r\\|$ with proportionality coefficient $k_r$. Assume the contact lies on a locally flat portion of the boundary, and that the continuum boundary is sufficiently rigid so that the effective contact radius for a sphere-plane contact reduces to the particle radius.\n\nThe particle has radius $R = 0.015 \\, \\mathrm{m}$, and the current normal force magnitude is $\\|F_n\\| = 50 \\, \\mathrm{N}$. The coefficient of friction is $\\mu = 0.4$, the tangential stiffness is $k_t = 5.0 \\times 10^{5} \\, \\mathrm{N/m}$, and the rolling resistance coefficient is $k_r = 0.05$. In the local tangential plane at the contact, the previous tangential force is $F_t^{\\mathrm{old}} = (15,\\,0) \\, \\mathrm{N}$. Over the current time increment, the tangential relative displacement increment is $\\Delta u_t = (2.0 \\times 10^{-5},\\,-1.0 \\times 10^{-5}) \\, \\mathrm{m}$. The magnitude of the rolling rotation increment is $\\|\\Delta \\theta_r\\| = 0.02 \\, \\mathrm{rad}$.\n\nStarting from first principles for contact mechanics and frictional slip (Hooke’s law for the tangential spring, Newton’s laws, and the Coulomb friction cap), and taking $R^\\ast = R$ for a sphere-plane contact, determine:\n- the updated tangential force vector $F_t$ after applying the elastic increment and enforcing the Coulomb cap, and\n- the rolling resistance torque $M_r$.\n\nRound each component of $F_t$ and the torque $M_r$ to four significant figures. Express the force in $\\mathrm{N}$ and the torque in $\\mathrm{N \\cdot m}$. Provide your final answer as a row matrix containing the two components of $F_t$ followed by $M_r$. Angles must be treated in radians.", "solution": "The problem requires the calculation of an updated tangential contact force and a rolling resistance torque for a particle-boundary interaction within a Discrete Element Method (DEM) framework. The problem is well-posed and scientifically sound, providing all necessary parameters and a clear description of the physical model. The solution will be determined in two parts: first, the tangential force, and second, the rolling resistance torque.\n\n**Part 1: Calculation of the Updated Tangential Force $F_t$**\n\nThe contact model for the tangential force is that of a linear elastic spring with a slip condition governed by the Coulomb friction law. This is a standard elastic-plastic model solved using a predictor-corrector scheme.\n\n**Step 1.1: Elastic Predictor**\n\nFirst, a trial tangential force, $F_t^{\\mathrm{trial}}$, is calculated by assuming a purely elastic increment. The tangential force increment, $\\Delta F_t$, is determined by the tangential stiffness, $k_t$, and the tangential relative displacement increment, $\\Delta u_t$, according to Hooke's law:\n$$\n\\Delta F_t = k_t \\Delta u_t\n$$\nThe given values are $k_t = 5.0 \\times 10^{5} \\, \\mathrm{N/m}$ and $\\Delta u_t = (2.0 \\times 10^{-5},\\,-1.0 \\times 10^{-5}) \\, \\mathrm{m}$.\n$$\n\\Delta F_t = (5.0 \\times 10^{5}) \\begin{pmatrix} 2.0 \\times 10^{-5} \\\\ -1.0 \\times 10^{-5} \\end{pmatrix} = \\begin{pmatrix} (5.0 \\times 10^{5}) \\cdot (2.0 \\times 10^{-5}) \\\\ (5.0 \\times 10^{5}) \\cdot (-1.0 \\times 10^{-5}) \\end{pmatrix} = \\begin{pmatrix} 10 \\\\ -5 \\end{pmatrix} \\, \\mathrm{N}\n$$\nThe trial tangential force is the sum of the force from the previous time step, $F_t^{\\mathrm{old}}$, and this elastic increment:\n$$\nF_t^{\\mathrm{trial}} = F_t^{\\mathrm{old}} + \\Delta F_t\n$$\nWith $F_t^{\\mathrm{old}} = (15,\\,0) \\, \\mathrm{N}$, the trial force is:\n$$\nF_t^{\\mathrm{trial}} = \\begin{pmatrix} 15 \\\\ 0 \\end{pmatrix} + \\begin{pmatrix} 10 \\\\ -5 \\end{pmatrix} = \\begin{pmatrix} 25 \\\\ -5 \\end{pmatrix} \\, \\mathrm{N}\n$$\n\n**Step 1.2: Check Slip Condition**\n\nNext, the magnitude of the trial force, $\\|F_t^{\\mathrm{trial}}\\|$, must be compared to the maximum allowable tangential force defined by the Coulomb friction limit, $F_t^{\\mathrm{max}}$. The friction limit is proportional to the magnitude of the normal force, $\\|F_n\\|$, with the coefficient of friction, $\\mu$, as the proportionality constant.\n$$\nF_t^{\\mathrm{max}} = \\mu \\|F_n\\|\n$$\nUsing the given values $\\mu = 0.4$ and $\\|F_n\\| = 50 \\, \\mathrm{N}$:\n$$\nF_t^{\\mathrm{max}} = 0.4 \\times 50 = 20 \\, \\mathrm{N}\n$$\nThe magnitude of the trial force is:\n$$\n\\|F_t^{\\mathrm{trial}}\\| = \\sqrt{(25)^2 + (-5)^2} = \\sqrt{625 + 25} = \\sqrt{650} \\, \\mathrm{N}\n$$\nNumerically, $\\|F_t^{\\mathrm{trial}}\\| \\approx 25.495 \\, \\mathrm{N}$.\n\n**Step 1.3: Corrector (Slip Enforcement)**\n\nWe compare the magnitude of the trial force to the friction limit:\n$$\n\\|F_t^{\\mathrm{trial}}\\| \\approx 25.495 \\, \\mathrm{N} > F_t^{\\mathrm{max}} = 20 \\, \\mathrm{N}\n$$\nSince the trial force exceeds the friction limit, slip occurs. The final tangential force, $F_t$, must be projected back onto the friction cone. This means its magnitude must be equal to $F_t^{\\mathrm{max}}$, and its direction must be the same as that of the trial force.\n$$\nF_t = F_t^{\\mathrm{max}} \\frac{F_t^{\\mathrm{trial}}}{\\|F_t^{\\mathrm{trial}}\\|}\n$$\nSubstituting the calculated values:\n$$\nF_t = 20 \\cdot \\frac{\\begin{pmatrix} 25 \\\\ -5 \\end{pmatrix}}{\\sqrt{650}} = \\begin{pmatrix} \\frac{20 \\cdot 25}{\\sqrt{650}} \\\\ \\frac{20 \\cdot (-5)}{\\sqrt{650}} \\end{pmatrix} = \\begin{pmatrix} \\frac{500}{\\sqrt{650}} \\\\ \\frac{-100}{\\sqrt{650}} \\end{pmatrix} \\, \\mathrm{N}\n$$\nNow we compute the numerical values and round them to four significant figures as required by the problem.\n$$\nF_{t,x} = \\frac{500}{\\sqrt{650}} \\approx 19.61161 \\, \\mathrm{N} \\implies 19.61 \\, \\mathrm{N}\n$$\n$$\nF_{t,y} = \\frac{-100}{\\sqrt{650}} \\approx -3.92232 \\, \\mathrm{N} \\implies -3.922 \\, \\mathrm{N}\n$$\nThus, the updated tangential force vector is $F_t = (19.61, -3.922) \\, \\mathrm{N}$.\n\n**Part 2: Calculation of the Rolling Resistance Torque $M_r$**\n\nThe problem defines the rolling resistance torque as being proportional to the normal force $\\|F_n\\|$, the effective contact radius $R^\\ast$, the magnitude of the rolling rotation increment $\\|\\Delta \\theta_r\\|$, and a rolling resistance coefficient $k_r$. The problem explicitly states to take $R^\\ast = R$. The formula for the magnitude of the rolling resistance torque $M_r$ is:\n$$\nM_r = k_r \\|F_n\\| R^\\ast \\|\\Delta \\theta_r\\| = k_r \\|F_n\\| R \\|\\Delta \\theta_r\\|\n$$\nThe problem provides the following values:\n$k_r = 0.05$\n$\\|F_n\\| = 50 \\, \\mathrm{N}$\n$R = 0.015 \\, \\mathrm{m}$\n$\\|\\Delta \\theta_r\\| = 0.02 \\, \\mathrm{rad}$\n\nSubstituting these values into the formula:\n$$\nM_r = (0.05) \\cdot (50) \\cdot (0.015) \\cdot (0.02) \\, \\mathrm{N \\cdot m}\n$$\n$$\nM_r = (2.5) \\cdot (0.015) \\cdot (0.02) = (0.0375) \\cdot (0.02) = 0.00075 \\, \\mathrm{N \\cdot m}\n$$\nRounding to four significant figures:\n$$\nM_r = 0.0007500 \\, \\mathrm{N \\cdot m}\n$$\nThe final results, rounded to four significant figures, are the components of the tangential force vector $F_t = (19.61, -3.922) \\, \\mathrm{N}$ and the magnitude of the rolling resistance torque $M_r = 0.0007500 \\, \\mathrm{N \\cdot m}$.", "answer": "$$\n\\boxed{\\begin{pmatrix} 19.61 & -3.922 & 0.0007500 \\end{pmatrix}}\n$$", "id": "3504405"}, {"introduction": "Once particle interactions are defined, the central challenge in coupled simulations is enforcing the physical connection between the discrete and continuum domains. This practice takes you to the core of this challenge by comparing two fundamental coupling strategies: the approximate 'soft' constraint of the penalty method and the exact 'hard' constraint of the Lagrange multiplier method [@problem_id:3504386]. Implementing and contrasting these approaches provides invaluable insight into the critical trade-offs between constraint accuracy, implementation complexity, and computational cost.", "problem": "Consider a single Discrete Element Method (DEM) particle coupled in tangential motion to a single continuum fluid control volume at an interface. The particle has mass $m_p$ and tangential velocity $u_\\text{DEM}(t)$, while the fluid cell has lumped mass $m_f$ and tangential velocity $u_f(t)$. The external shear force acting on the fluid cell is $f_s(t)$. The interface traction acts in opposite directions on the two subsystems. Two enforcement strategies for the kinematic no-slip constraint $u_\\text{DEM}(t) = u_f(t)$ are considered: a penalty method and a Lagrange multiplier method. The goal is to quantify the continuity error $\\|u_\\text{DEM} - u_f\\|$ as a function of the penalty parameter $\\gamma$ and the contact stiffness $k_n$.\n\nStart from Newton’s second law $m\\,du/dt = \\sum F$ for each subsystem. Model the physical tangential interfacial traction as linear viscous drag proportional to the slip $u_\\text{DEM} - u_f$ with coefficient $c_t$ that depends on the normal contact stiffness $k_n$ through $c_t = \\zeta \\sqrt{k_n m_p}$, where $\\zeta$ is a dimensionless proportionality constant. The fluid cell experiences additional bulk viscous resistance modeled as a linear dashpot with coefficient $b$ opposing $u_f$. Use the following given parameters and units:\n- Particle mass $m_p = 0.01$ kg.\n- Fluid lumped mass $m_f = 0.02$ kg.\n- Bulk fluid damping $b = 0.1$ kg/s.\n- Proportionality constant $\\zeta = 0.2$.\n- Time step $\\Delta t = 1\\times 10^{-4}$ s.\n- Total simulation time $T = 0.5$ s.\n- External shear forcing $f_s(t) = F_0 \\sin(2\\pi f t)$ with $F_0 = 0.01$ N and $f = 2$ Hz.\n\nFor the penalty enforcement, augment the physical interfacial traction with a numerical penalty traction proportional to slip with penalty parameter $\\gamma$ (units kg/s). For time-stepping, use backward (implicit) Euler over the interval $[0,T]$ with step size $\\Delta t$:\n- Define $K = c_t + \\gamma$.\n- Evolve $\\{u_\\text{DEM}^{n}, u_f^{n}\\}$ to $\\{u_\\text{DEM}^{n+1}, u_f^{n+1}\\}$ by solving the linear system obtained from implicit Euler applied to Newton’s second law with interfacial traction $K(u_\\text{DEM}^{n+1} - u_f^{n+1})$ and bulk damping $b$ acting on $u_f^{n+1}$, and external forcing $f_s(t^{n+1})$:\n  $$\\frac{m_p}{\\Delta t}\\left(u_\\text{DEM}^{n+1} - u_\\text{DEM}^{n}\\right) = -K\\left(u_\\text{DEM}^{n+1} - u_f^{n+1}\\right),$$\n  $$\\frac{m_f}{\\Delta t}\\left(u_f^{n+1} - u_f^{n}\\right) = f_s(t^{n+1}) - b\\,u_f^{n+1} + K\\left(u_\\text{DEM}^{n+1} - u_f^{n+1}\\right).$$\n- Initialize $u_\\text{DEM}^{0} = 0$ m/s and $u_f^{0} = 0$ m/s at $t=0$ s.\n\nFor the Lagrange multiplier enforcement, impose the constraint $u_\\text{DEM}^{n+1} = u_f^{n+1}$ exactly at each time step via a Lagrange multiplier representing the interfacial traction. Eliminating the multiplier by enforcing the kinematic equality produces the combined update for the common velocity $u^{n+1}$:\n$$\\frac{m_p + m_f}{\\Delta t}\\left(u^{n+1} - u^{n}\\right) = f_s(t^{n+1}) - b\\,u^{n+1},$$\nwith $u^{0} = 0$ m/s and $u_\\text{DEM}^{n+1} = u_f^{n+1} = u^{n+1}$ thereafter.\n\nDefine the error norm as the time-averaged discrete $L^2$ norm over $[0,T]$:\n$$\\|u_\\text{DEM} - u_f\\| = \\sqrt{\\frac{1}{T}\\sum_{n=0}^{N-1} \\Delta t \\left(u_\\text{DEM}^{n+1} - u_f^{n+1}\\right)^2},$$\nand report it in meters per second (m/s).\n\nImplement a complete program that:\n- Simulates the coupled system for each test case using the specified implicit Euler scheme for either the penalty method or the Lagrange multiplier method.\n- Computes and returns the error norm $\\|u_\\text{DEM} - u_f\\|$ in m/s for each test case.\n\nUse the following test suite covering typical, boundary, and edge cases. Each case is a tuple $(\\text{method}, \\gamma, k_n)$, where $\\text{method}$ is either the string \"penalty\" or \"LM\":\n1. $(\"penalty\", 0.0, 10^3)$\n2. $(\"penalty\", 10.0, 10^3)$\n3. $(\"penalty\", 10^3, 10^3)$\n4. $(\"penalty\", 10^2, 10^5)$\n5. $(\"penalty\", 10^2, 10^2)$\n6. $(\"LM\", 0.0, 10^3)$\n7. $(\"LM\", 10^2, 10^5)$\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[r_1,r_2,\\dots,r_7]$), where each $r_i$ is the error norm $\\|u_\\text{DEM} - u_f\\|$ in m/s for the corresponding test case, computed to full double precision as a floating-point number.", "solution": "The governing equations arise from Newton’s second law $m\\,du/dt = \\sum F$ for the DEM particle and for the continuum fluid cell, with interfacial traction acting equally and oppositely. The interface no-slip condition $u_\\text{DEM} = u_f$ is enforced either by a penalty method or exactly by a Lagrange multiplier method. The physical interfacial mechanism responsible for tangential momentum exchange is modeled as a linear viscous traction with coefficient $c_t$. To tie this coefficient to the mechanical contact properties, it is set as $c_t = \\zeta \\sqrt{k_n m_p}$, where $k_n$ is the normal contact stiffness and $\\zeta$ is a dimensionless proportionality constant, a form consistent with Rayleigh-type damping scaling that yields units $[c_t] = \\text{kg/s}$ because $[k_n] = \\text{N/m} = \\text{kg}/\\text{s}^2$ and thus $\\sqrt{k_n m_p}$ has units $\\text{kg}/\\text{s}$.\n\nFor the penalty method, the interfacial traction is the sum of a physical contribution (viscous slip damping with coefficient $c_t$) and a numerical penalty contribution proportional to slip with parameter $\\gamma$. Let $K = c_t + \\gamma$. Applying backward (implicit) Euler over a single time step from $t^n$ to $t^{n+1} = t^n + \\Delta t$, and denoting the discrete velocities $u_\\text{DEM}^{n}$ and $u_f^{n}$, yields:\n$$\\frac{m_p}{\\Delta t}\\left(u_\\text{DEM}^{n+1} - u_\\text{DEM}^{n}\\right) = -K\\left(u_\\text{DEM}^{n+1} - u_f^{n+1}\\right),$$\n$$\\frac{m_f}{\\Delta t}\\left(u_f^{n+1} - u_f^{n}\\right) = f_s(t^{n+1}) - b\\,u_f^{n+1} + K\\left(u_\\text{DEM}^{n+1} - u_f^{n+1}\\right).$$\nRearranging gives a $2\\times 2$ linear system for $\\left(u_\\text{DEM}^{n+1}, u_f^{n+1}\\right)$:\n$$\\left(\\frac{m_p}{\\Delta t} + K\\right)u_\\text{DEM}^{n+1} - K\\,u_f^{n+1} = \\frac{m_p}{\\Delta t}u_\\text{DEM}^{n},$$\n$$-K\\,u_\\text{DEM}^{n+1} + \\left(\\frac{m_f}{\\Delta t} + b + K\\right)u_f^{n+1} = f_s(t^{n+1}) + \\frac{m_f}{\\Delta t}u_f^{n}.$$\nThis system is uniquely solvable for positive $m_p$, $m_f$, $b$, and $K$, as the coefficient matrix is strictly diagonally dominant for the chosen parameters and thus nonsingular. Starting from $u_\\text{DEM}^0 = 0$ and $u_f^0 = 0$, we time-march to $t=T$.\n\nFor the Lagrange multiplier method, the constraint $u_\\text{DEM}^{n+1} = u_f^{n+1}$ is imposed exactly. Introducing a Lagrange multiplier $\\lambda^{n+1}$ to represent the interfacial traction, the discrete implicit Euler equations are:\n$$\\frac{m_p}{\\Delta t}\\left(u_\\text{DEM}^{n+1} - u_\\text{DEM}^{n}\\right) = -\\lambda^{n+1} - c_t\\left(u_\\text{DEM}^{n+1} - u_f^{n+1}\\right),$$\n$$\\frac{m_f}{\\Delta t}\\left(u_f^{n+1} - u_f^{n}\\right) = f_s(t^{n+1}) - b\\,u_f^{n+1} + \\lambda^{n+1} + c_t\\left(u_\\text{DEM}^{n+1} - u_f^{n+1}\\right),$$\n$$u_\\text{DEM}^{n+1} - u_f^{n+1} = 0.$$\nThe $c_t$ terms vanish under the constraint, and one can eliminate the Lagrange multiplier by summing the two momentum equations, yielding a single implicit Euler update for the common velocity $u^{n+1} = u_\\text{DEM}^{n+1} = u_f^{n+1}$:\n$$\\frac{m_p + m_f}{\\Delta t}\\left(u^{n+1} - u^{n}\\right) = f_s(t^{n+1}) - b\\,u^{n+1},$$\nwith $u^{0} = 0$. This linear scalar equation has the solution\n$$u^{n+1} = \\frac{f_s(t^{n+1}) + \\frac{m_p + m_f}{\\Delta t}u^{n}}{\\frac{m_p + m_f}{\\Delta t} + b}.$$\nBy construction, the kinematic difference $u_\\text{DEM}^{n+1} - u_f^{n+1}$ is exactly zero at each step for the Lagrange multiplier enforcement, so the error norm $\\|u_\\text{DEM} - u_f\\|$ is identically zero up to floating-point arithmetic.\n\nThe error norm is defined as the time-averaged discrete $L^2$ norm,\n$$\\|u_\\text{DEM} - u_f\\| = \\sqrt{\\frac{1}{T}\\sum_{n=0}^{N-1} \\Delta t \\left(u_\\text{DEM}^{n+1} - u_f^{n+1}\\right)^2},$$\nwhich has units of meters per second (m/s), since the factor $\\Delta t/T$ is dimensionless.\n\nAlgorithmic design:\n1. Initialize $u_\\text{DEM}^{0} = 0$ and $u_f^{0} = 0$ for penalty; initialize $u^{0} = 0$ for Lagrange multiplier.\n2. For each time step $n = 0,\\dots,N-1$ where $N = T/\\Delta t$, compute $t^{n+1} = (n+1)\\Delta t$ and $f_s(t^{n+1}) = F_0 \\sin(2\\pi f t^{n+1})$.\n3. Penalty method:\n   - Compute $c_t = \\zeta \\sqrt{k_n m_p}$ and $K = c_t + \\gamma$.\n   - Assemble the $2\\times 2$ system and solve for $\\left(u_\\text{DEM}^{n+1}, u_f^{n+1}\\right)$ using a direct solver.\n4. Lagrange multiplier method:\n   - Update the common velocity $u^{n+1}$ with the scalar implicit Euler formula and set $u_\\text{DEM}^{n+1} = u_f^{n+1} = u^{n+1}$.\n5. Accumulate the squared slip multiplied by $\\Delta t$ at each step to form the numerator of the error measure; divide by $T$ and take the square root to obtain $\\|u_\\text{DEM} - u_f\\|$.\n6. For the provided test suite, run the simulation for each tuple $(\\text{method}, \\gamma, k_n)$ and collect the resulting error norms into a list.\n\nScientific realism and coupling rationale:\n- The use of Newton’s second law ensures momentum conservation in each subsystem.\n- The linear viscous tangential traction $c_t(u_\\text{DEM} - u_f)$ captures interfacial momentum exchange attributable to near-contact damping and is scaled with $k_n$ to reflect stronger interaction under stiffer normal contact via $c_t = \\zeta \\sqrt{k_n m_p}$.\n- The penalty method approximates the no-slip constraint by adding numerical stiffness in velocity space through $\\gamma$, which reduces slip but cannot make it identically zero unless $\\gamma \\to \\infty$.\n- The Lagrange multiplier method enforces the constraint exactly by introducing an auxiliary variable that adjusts interfacial traction to satisfy $u_\\text{DEM} = u_f$ at each time level, yielding zero continuity error by construction.\n\nThe final program implements these steps, uses the specified units, and outputs a single line with the error norms for all test cases in m/s.", "answer": "```python\nimport numpy as np\n\ndef simulate_penalty(gamma, k_n, params):\n    # Unpack parameters\n    m_p = params[\"m_p\"]\n    m_f = params[\"m_f\"]\n    b = params[\"b\"]\n    zeta = params[\"zeta\"]\n    dt = params[\"dt\"]\n    T = params[\"T\"]\n    F0 = params[\"F0\"]\n    freq = params[\"freq\"]\n    N = int(np.round(T / dt))\n\n    # Interface viscous coefficient scaled by normal stiffness\n    c_t = zeta * np.sqrt(k_n * m_p)\n    K = c_t + gamma\n\n    # Initialize velocities\n    u_dem = 0.0\n    u_f = 0.0\n\n    # Accumulate squared slip for error norm\n    slip_accum = 0.0\n\n    # Precompute coefficients\n    a11 = m_p / dt + K\n    a12 = -K\n    # Fluid equation coefficients depend on b; recompute at each step only RHS\n    b11 = -K\n    b22 = m_f / dt + b + K\n\n    for n in range(N):\n        tnp1 = (n + 1) * dt\n        f_s = F0 * np.sin(2.0 * np.pi * freq * tnp1)\n\n        rhs1 = (m_p / dt) * u_dem\n        rhs2 = f_s + (m_f / dt) * u_f\n\n        # Solve 2x2 linear system:\n        # [a11 a12][u_dem^{n+1}] = [rhs1]\n        # [b11 b22][u_f^{n+1}]   = [rhs2]\n        # But note the coupling: second equation also has u_dem^{n+1} term (b11).\n        # Form matrix and right-hand side.\n        A = np.array([[a11, a12],\n                      [b11, b22]], dtype=float)\n        rhs = np.array([rhs1, rhs2], dtype=float)\n\n        sol = np.linalg.solve(A, rhs)\n        u_dem_new, u_f_new = sol[0], sol[1]\n\n        slip = u_dem_new - u_f_new\n        slip_accum += dt * (slip * slip)\n\n        u_dem = u_dem_new\n        u_f = u_f_new\n\n    error = np.sqrt(slip_accum / T)\n    return error\n\ndef simulate_lagrange_multiplier(k_n, params):\n    # Unpack parameters\n    m_p = params[\"m_p\"]\n    m_f = params[\"m_f\"]\n    b = params[\"b\"]\n    dt = params[\"dt\"]\n    T = params[\"T\"]\n    F0 = params[\"F0\"]\n    freq = params[\"freq\"]\n    N = int(np.round(T / dt))\n\n    # Initialize common velocity\n    u = 0.0\n\n    slip_accum = 0.0  # will remain zero by construction\n\n    # Coefficient for implicit Euler update\n    M_over_dt = (m_p + m_f) / dt\n    denom = M_over_dt + b\n\n    for n in range(N):\n        tnp1 = (n + 1) * dt\n        f_s = F0 * np.sin(2.0 * np.pi * freq * tnp1)\n        rhs = f_s + M_over_dt * u\n        u_new = rhs / denom\n        # Enforced equality\n        u_dem_new = u_new\n        u_f_new = u_new\n\n        slip = u_dem_new - u_f_new\n        slip_accum += dt * (slip * slip)\n\n        u = u_new\n\n    error = np.sqrt(slip_accum / T)\n    return error\n\ndef solve():\n    # Define global parameters\n    params = {\n        \"m_p\": 0.01,     # kg\n        \"m_f\": 0.02,     # kg\n        \"b\": 0.1,        # kg/s\n        \"zeta\": 0.2,     # dimensionless\n        \"dt\": 1e-4,      # s\n        \"T\": 0.5,        # s\n        \"F0\": 0.01,      # N\n        \"freq\": 2.0      # Hz\n    }\n\n    # Test suite: (method, gamma, k_n)\n    test_cases = [\n        (\"penalty\", 0.0, 1e3),    # boundary: no penalty\n        (\"penalty\", 10.0, 1e3),   # moderate penalty\n        (\"penalty\", 1e3, 1e3),    # very large penalty\n        (\"penalty\", 1e2, 1e5),    # strong contact stiffness\n        (\"penalty\", 1e2, 1e2),    # weak contact stiffness\n        (\"LM\", 0.0, 1e3),         # LM enforcement, k_n nominal\n        (\"LM\", 1e2, 1e5)          # LM enforcement, k_n varied\n    ]\n\n    results = []\n    for method, gamma, k_n in test_cases:\n        if method == \"penalty\":\n            err = simulate_penalty(gamma, k_n, params)\n        elif method == \"LM\":\n            # gamma not used in LM method\n            err = simulate_lagrange_multiplier(k_n, params)\n        else:\n            err = float('nan')\n        results.append(err)\n\n    # Print in the exact required format\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "3504386"}, {"introduction": "The true power of coupled simulations is their ability to predict complex multiphysics phenomena that arise from the interplay of different physical domains. This final exercise provides a tangible example by exploring frictional heating at the DEM-continuum interface [@problem_id:3504416]. You will connect the mechanical power dissipated by friction—a direct result of the coupled dynamics—to a transient thermal response, offering a practical look at how thermo-mechanical problems are modeled in a coupled framework.", "problem": "A single Discrete Element Method (DEM) spherical particle is sliding on a rigid continuum wall. At a single contact point, the DEM solver reports a tangential force $F_t$ and slip speed $v_t$. The continuum wall and the DEM particle are thermally distinct materials. The frictional work at the contact is converted to heat that partitions into the two bodies according to their thermal effusivities. A lumped-capacitance approximation is used to model the near-contact microvolume of the DEM particle as a thermal node that exchanges heat by conduction with the rest of the particle across a representative thickness.\n\nStarting from the First Law of Thermodynamics (energy conservation), Fourier’s law of heat conduction, and the definition of thermal effusivity, derive the governing equation for the transient temperature rise in the particle’s near-contact microvolume, solve it for the case of zero initial temperature rise, and evaluate the temperature rise at a specified time. Assume:\n- The frictional power input at the contact is $P = F_t \\, v_t$.\n- Heat partitions between the two bodies in proportion to their thermal effusivities $e_i = \\sqrt{k_i \\, \\rho_i \\, c_i}$, where $k_i$ is thermal conductivity, $\\rho_i$ is density, and $c_i$ is specific heat capacity. The fraction of $P$ entering the particle is $f_p = \\frac{e_p}{e_p + e_w}$, so the particle receives $P_p = f_p \\, P$.\n- The particle’s near-contact microvolume has volume $V_c = A_c \\, \\delta_c$ and heat capacity $C_p = \\rho_p \\, c_p \\, V_c$, where $A_c$ is an estimate of the contact area and $\\delta_c$ is a representative conduction thickness into the particle.\n- Conduction from the near-contact microvolume into the rest of the particle is one-dimensional across $\\delta_c$, consistent with Fourier’s law for a slab.\n\nUse the following data:\n- Tangential force $F_t = 0.2 \\,\\mathrm{N}$ and slip speed $v_t = 0.05 \\,\\mathrm{m/s}$.\n- Contact area estimate $A_c = 1.0 \\times 10^{-8} \\,\\mathrm{m^2}$ and representative conduction thickness $\\delta_c = 1.0 \\times 10^{-4} \\,\\mathrm{m}$.\n- Particle (DEM grain) thermal properties: thermal conductivity $k_p = 45 \\,\\mathrm{W/(m \\cdot K)}$, density $\\rho_p = 7800 \\,\\mathrm{kg/m^3}$, specific heat $c_p = 460 \\,\\mathrm{J/(kg \\cdot K)}$.\n- Wall (continuum) thermal properties: thermal conductivity $k_w = 3 \\,\\mathrm{W/(m \\cdot K)}$, density $\\rho_w = 2600 \\,\\mathrm{kg/m^3}$, specific heat $c_w = 790 \\,\\mathrm{J/(kg \\cdot K)}$.\n- Both bodies far from the contact are initially at the same uniform temperature, so the initial temperature rise at the contact microvolume is zero.\n\nCompute the particle’s near-contact transient temperature rise $\\Delta T_p(t)$ at time $t = 0.010 \\,\\mathrm{s}$. Express your final temperature rise in Kelvin, and round your answer to four significant figures.", "solution": "The problem requires the derivation and solution of a governing equation for the transient temperature rise in a near-contact microvolume of a Discrete Element Method (DEM) particle sliding against a continuum wall. The derivation begins with the First Law of Thermodynamics, which states that the rate of change of internal energy within a control volume equals the net rate of heat transfer into it.\n\nLet $\\Delta T_p(t)$ be the temperature rise of the particle's near-contact microvolume above the initial ambient temperature. The internal energy of this microvolume, relative to the initial state, is $U_p = C_p \\Delta T_p(t)$, where $C_p$ is the heat capacity of the volume. The rate of change of internal energy is thus $\\frac{dU_p}{dt} = C_p \\frac{d(\\Delta T_p)}{dt}$.\n\nThe heat capacity $C_p$ is given by the product of density $\\rho_p$, specific heat capacity $c_p$, and the volume of the microvolume $V_c$. The volume is modeled as $V_c = A_c \\delta_c$, where $A_c$ is the contact area and $\\delta_c$ is a representative conduction thickness. Therefore, $C_p = \\rho_p c_p A_c \\delta_c$.\n\nThe net rate of heat transfer into the microvolume is the difference between the heat generated that flows into the particle, $\\dot{Q}_{in}$, and the heat conducted away from the microvolume into the bulk of the particle, $\\dot{Q}_{out}$.\n\nThe heat input, $\\dot{Q}_{in}$, is a fraction of the total frictional power $P$ generated at the contact. The total power is $P = F_t v_t$. This power partitions between the particle and the wall. The fraction entering the particle is given as $f_p = \\frac{e_p}{e_p + e_w}$, where $e_p$ and $e_w$ are the thermal effusivities of the particle and wall, respectively. The thermal effusivity is defined as $e_i = \\sqrt{k_i \\rho_i c_i}$. The power entering the particle's microvolume is therefore $P_p = \\dot{Q}_{in} = f_p P = f_p F_t v_t$.\n\nThe heat output, $\\dot{Q}_{out}$, is modeled as one-dimensional heat conduction away from the microvolume. According to Fourier's law, for a slab of cross-sectional area $A_c$ and thickness $\\delta_c$, the heat transfer rate is proportional to the temperature difference across it. The temperature of the microvolume is raised by $\\Delta T_p$, while the bulk of the particle is assumed to remain at the initial temperature. Thus, the heat conducted away is $\\dot{Q}_{out} = k_p A_c \\frac{\\Delta T_p}{\\delta_c}$.\n\nCombining these terms into the energy balance equation:\n$$\n\\frac{dU_p}{dt} = \\dot{Q}_{in} - \\dot{Q}_{out}\n$$\n$$\nC_p \\frac{d(\\Delta T_p)}{dt} = P_p - \\frac{k_p A_c}{\\delta_c} \\Delta T_p\n$$\n\nSubstituting the expression for $C_p$:\n$$\n(\\rho_p c_p A_c \\delta_c) \\frac{d(\\Delta T_p)}{dt} = P_p - \\frac{k_p A_c}{\\delta_c} \\Delta T_p\n$$\n\nThis is a first-order linear ordinary differential equation. To solve it, we rearrange it into standard form $\\frac{dy}{dt} + a y = b$:\n$$\n\\frac{d(\\Delta T_p)}{dt} + \\left(\\frac{k_p A_c}{\\delta_c (\\rho_p c_p A_c \\delta_c)}\\right) \\Delta T_p = \\frac{P_p}{\\rho_p c_p A_c \\delta_c}\n$$\n$$\n\\frac{d(\\Delta T_p)}{dt} + \\left(\\frac{k_p}{\\rho_p c_p \\delta_c^2}\\right) \\Delta T_p = \\frac{P_p}{\\rho_p c_p A_c \\delta_c}\n$$\n\nLet's define the thermal time constant $\\tau$ and the steady-state temperature rise $\\Delta T_{p,ss}$. The coefficient of the $\\Delta T_p$ term is the inverse of the time constant:\n$$\n\\frac{1}{\\tau} = \\frac{k_p}{\\rho_p c_p \\delta_c^2} \\implies \\tau = \\frac{\\rho_p c_p \\delta_c^2}{k_p}\n$$\nAt steady state, $\\frac{d(\\Delta T_p)}{dt} = 0$, so the equation simplifies to:\n$$\n\\frac{1}{\\tau} \\Delta T_{p,ss} = \\frac{P_p}{\\rho_p c_p A_c \\delta_c}\n$$\n$$\n\\Delta T_{p,ss} = \\tau \\frac{P_p}{\\rho_p c_p A_c \\delta_c} = \\left(\\frac{\\rho_p c_p \\delta_c^2}{k_p}\\right) \\frac{P_p}{\\rho_p c_p A_c \\delta_c} = \\frac{P_p \\delta_c}{k_p A_c}\n$$\nThe differential equation can now be written as:\n$$\n\\frac{d(\\Delta T_p)}{dt} + \\frac{1}{\\tau} \\Delta T_p = \\frac{\\Delta T_{p,ss}}{\\tau}\n$$\nThe general solution to this equation is $\\Delta T_p(t) = \\Delta T_{p,ss} + K \\exp(-t/\\tau)$, where $K$ is a constant of integration. We use the initial condition that the temperature rise is zero at time $t=0$, i.e., $\\Delta T_p(0) = 0$.\n$$\n0 = \\Delta T_{p,ss} + K \\exp(0) \\implies K = -\\Delta T_{p,ss}\n$$\nThe particular solution for the transient temperature rise is:\n$$\n\\Delta T_p(t) = \\Delta T_{p,ss} - \\Delta T_{p,ss} \\exp(-t/\\tau) = \\Delta T_{p,ss} \\left(1 - \\exp\\left(-\\frac{t}{\\tau}\\right)\\right)\n$$\n\nNow we compute the numerical values for the parameters using the provided data.\nGiven data:\nTangential force $F_t = 0.2 \\,\\mathrm{N}$, slip speed $v_t = 0.05 \\,\\mathrm{m/s}$.\nContact area $A_c = 1.0 \\times 10^{-8} \\,\\mathrm{m^2}$, conduction thickness $\\delta_c = 1.0 \\times 10^{-4} \\,\\mathrm{m}$.\nParticle properties: $k_p = 45 \\,\\mathrm{W/(m \\cdot K)}$, $\\rho_p = 7800 \\,\\mathrm{kg/m^3}$, $c_p = 460 \\,\\mathrm{J/(kg \\cdot K)}$.\nWall properties: $k_w = 3 \\,\\mathrm{W/(m \\cdot K)}$, $\\rho_w = 2600 \\,\\mathrm{kg/m^3}$, $c_w = 790 \\,\\mathrm{J/(kg \\cdot K)}$.\nTime $t = 0.010 \\,\\mathrm{s}$.\n\nFirst, calculate the thermal effusivities, $e_i = \\sqrt{k_i \\rho_i c_i}$:\nFor the particle:\n$e_p = \\sqrt{45 \\times 7800 \\times 460} = \\sqrt{161,460,000} \\approx 12706.7 \\,\\mathrm{J/(m^2 \\cdot K \\cdot \\sqrt{s})}$.\nFor the wall:\n$e_w = \\sqrt{3 \\times 2600 \\times 790} = \\sqrt{6,162,000} \\approx 2482.3 \\,\\mathrm{J/(m^2 \\cdot K \\cdot \\sqrt{s})}$.\n\nNext, calculate the total frictional power $P$ and the portion $P_p$ entering the particle:\n$P = F_t v_t = 0.2 \\times 0.05 = 0.01 \\,\\mathrm{W}$.\nThe partition fraction is $f_p = \\frac{e_p}{e_p + e_w} = \\frac{12706.7}{12706.7 + 2482.3} = \\frac{12706.7}{15189.0} \\approx 0.83657$.\n$P_p = f_p P = 0.83657 \\times 0.01 = 0.0083657 \\,\\mathrm{W}$.\n\nNow, calculate the steady-state temperature rise $\\Delta T_{p,ss}$:\n$$\n\\Delta T_{p,ss} = \\frac{P_p \\delta_c}{k_p A_c} = \\frac{(0.0083657) \\times (1.0 \\times 10^{-4})}{(45) \\times (1.0 \\times 10^{-8})} = \\frac{8.3657 \\times 10^{-7}}{4.5 \\times 10^{-7}} \\approx 1.85905 \\,\\mathrm{K}\n$$\n\nNext, calculate the thermal time constant $\\tau$:\n$$\n\\tau = \\frac{\\rho_p c_p \\delta_c^2}{k_p} = \\frac{(7800) \\times (460) \\times (1.0 \\times 10^{-4})^2}{45} = \\frac{3,588,000 \\times 1.0 \\times 10^{-8}}{45} = \\frac{0.03588}{45} \\approx 0.00079733 \\,\\mathrm{s}\n$$\n\nFinally, compute the temperature rise at $t = 0.010 \\,\\mathrm{s}$:\n$$\n\\Delta T_p(0.010) = \\Delta T_{p,ss} \\left(1 - \\exp\\left(-\\frac{t}{\\tau}\\right)\\right)\n$$\nThe ratio $t/\\tau$ is:\n$$\n\\frac{t}{\\tau} = \\frac{0.010}{0.00079733} \\approx 12.5417\n$$\nNow substitute this into the solution:\n$$\n\\Delta T_p(0.010) \\approx 1.85905 \\left(1 - \\exp(-12.5417)\\right)\n$$\n$$\n\\Delta T_p(0.010) \\approx 1.85905 \\left(1 - 3.582 \\times 10^{-6}\\right) = 1.85905 \\times 0.999996418 \\approx 1.85904 \\,\\mathrm{K}\n$$\nThe problem asks for the answer to be rounded to four significant figures.\n$\\Delta T_p(0.010) \\approx 1.859 \\,\\mathrm{K}$.", "answer": "$$\n\\boxed{1.859}\n$$", "id": "3504416"}]}