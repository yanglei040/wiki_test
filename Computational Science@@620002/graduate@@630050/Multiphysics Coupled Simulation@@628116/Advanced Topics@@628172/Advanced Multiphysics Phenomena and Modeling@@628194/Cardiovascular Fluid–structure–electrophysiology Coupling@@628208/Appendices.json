{"hands_on_practices": [{"introduction": "The cardiac cycle is initiated by a wave of electrical excitation propagating through the myocardium. Understanding the speed and shape of this wave is the first step in modeling the heart's coordinated function. This exercise uses dimensional analysis of a reaction-diffusion model to estimate the conduction speed and explore how the heart muscle's fibrous, anisotropic structure fundamentally alters wavefront propagation, a key factor in both normal and pathological heart rhythms.", "problem": "In a coupled cardiovascular simulation, the electrical excitation is modeled on a deforming myocardial wall and interacts with fluid and structure through excitation–contraction and pressure–load feedback. Consider the monodomain reaction–diffusion description of the transmembrane potential, where the diffusive spread of depolarization is characterized by a diffusion tensor aligned with the myocardial fibers. Let the local fiber coordinate system be such that the diffusion tensor is diagonal with entries $D_{\\ell}$ (along fibers) and $D_{t}$ (transverse to fibers), and let the ionic upstroke time scale be $\\tau_{\\text{up}}$. Assume a steep excitation front during the upstroke and neglect curvature at leading order when estimating the baseline speed.\n\nStarting from the reaction–diffusion balance (diffusive flux divergence versus temporal rate of change over the upstroke), use dimensional analysis to derive a leading-order scaling for the planar wavefront speed in terms of a characteristic diffusion coefficient and the upstroke time, and then use it to estimate speeds in the following scenarios. Explain qualitatively how anisotropic conductivity modifies the effective diffusion that controls propagation speed and how it influences wavefront curvature in two spatial dimensions.\n\nGiven data (in the local fiber frame):\n- Longitudinal diffusion coefficient $D_{\\ell} = 1.2 \\times 10^{-3}\\ \\mathrm{cm}^2/\\mathrm{ms}$,\n- Transverse diffusion coefficient $D_{t} = 3.0 \\times 10^{-4}\\ \\mathrm{cm}^2/\\mathrm{ms}$,\n- Upstroke time $\\tau_{\\text{up}} = 0.8\\ \\mathrm{ms}$.\n\nTasks:\n1) In a one-dimensional fiber-aligned cable, estimate the conduction speed $c_{\\ell}$ along fibers.\n\n2) In a two-dimensional slab, consider planar propagation whose normal makes an angle $\\theta$ with the fiber direction. Using the projection of the diffusion tensor onto the propagation normal, write the expression for the effective diffusion $D_{\\text{eff}}(\\theta)$ and estimate the resulting speed $c(\\theta)$ for $\\theta = 30^{\\circ}$ (degrees). Express both speeds in $\\mathrm{m}/\\mathrm{s}$.\n\nBriefly explain, based on the anisotropic diffusion operator, how anisotropy affects wavefront curvature and speed (no formula citation is needed; reason from the diffusion–reaction balance and geometric projection).\n\nRound your final reported value for $c(\\theta)$ to three significant figures. Report only the value of $c(\\theta)$ in your final answer.", "solution": "The problem is first validated.\n\n### Step 1: Extract Givens\n- **Model**: Monodomain reaction–diffusion for transmembrane potential.\n- **Diffusion Tensor**: In the local fiber coordinate system, the tensor is diagonal with longitudinal diffusion coefficient $D_{\\ell}$ and transverse diffusion coefficient $D_{t}$.\n- **Time Scale**: The ionic upstroke time scale is $\\tau_{\\text{up}}$.\n- **Assumptions**: Steep excitation front; leading-order curvature is neglected for baseline speed estimation.\n- **Data**:\n  - Longitudinal diffusion coefficient $D_{\\ell} = 1.2 \\times 10^{-3}\\ \\mathrm{cm}^2/\\mathrm{ms}$.\n  - Transverse diffusion coefficient $D_{t} = 3.0 \\times 10^{-4}\\ \\mathrm{cm}^2/\\mathrm{ms}$.\n  - Upstroke time $\\tau_{\\text{up}} = 0.8\\ \\mathrm{ms}$.\n- **Tasks**:\n  1.  Use dimensional analysis to derive a scaling for planar wavefront speed.\n  2.  Estimate conduction speed $c_{\\ell}$ along fibers.\n  3.  Derive the expression for effective diffusion $D_{\\text{eff}}(\\theta)$ for planar propagation at an angle $\\theta$ to the fibers.\n  4.  Estimate the speed $c(\\theta)$ for $\\theta = 30^{\\circ}$.\n  5.  Express speeds in $\\mathrm{m}/\\mathrm{s}$.\n  6.  Qualitatively explain how anisotropic conductivity modifies effective diffusion, wavefront speed, and curvature.\n  7.  Round the final value of $c(\\theta)$ to three significant figures.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, describing the standard monodomain model used in cardiac electrophysiology. It is well-posed, providing all necessary data and clear objectives for a unique solution. The given physical parameters ($D_{\\ell}$, $D_{t}$, $\\tau_{\\text{up}}$) are realistic for myocardial tissue. The language is objective and unambiguous. The problem is a standard exercise in biophysical modeling and does not violate any of the invalidity criteria.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. A detailed solution will be provided.\n\n***\n\nThe propagation of the transmembrane potential $V$ in cardiac tissue can be described by a reaction-diffusion equation. In its simplified, monodomain form, it is:\n$$ \\frac{\\partial V}{\\partial t} = \\nabla \\cdot (\\mathbf{D} \\nabla V) - I_{\\text{ion}}(V) $$\nwhere $\\mathbf{D}$ is the diffusion tensor and $I_{\\text{ion}}(V)$ represents the ionic currents (the reaction term), scaled by membrane capacitance which is omitted here for simplicity in scaling.\n\n**Leading-Order Scaling for Wavefront Speed**\n\nThe problem asks for a dimensional analysis based on the balance between temporal change and diffusion during the steep upstroke of the action potential. We consider a planar wave traveling with speed $c$. Let the characteristic length scale of the wavefront's leading edge be $L$. The temporal rate of change during the upstroke, which occurs over a time $\\tau_{\\text{up}}$, scales as:\n$$ \\frac{\\partial V}{\\partial t} \\sim \\frac{\\Delta V}{\\tau_{\\text{up}}} $$\nwhere $\\Delta V$ is the amplitude of the action potential. The diffusive term scales as:\n$$ \\nabla \\cdot (D \\nabla V) \\sim D \\frac{\\Delta V}{L^2} $$\nwhere $D$ is a characteristic diffusion coefficient. A point on the wavefront travels a distance $L$ in a time related to the upstroke phase, which we can approximate as $\\tau_{\\text{up}}$. Therefore, the speed $c$ relates to these scales as $c \\sim L/\\tau_{\\text{up}}$, which implies $L \\sim c \\tau_{\\text{up}}$.\n\nBy balancing the temporal and diffusive terms as instructed, we get:\n$$ \\frac{\\Delta V}{\\tau_{\\text{up}}} \\sim D \\frac{\\Delta V}{L^2} $$\n$$ \\frac{1}{\\tau_{\\text{up}}} \\sim \\frac{D}{L^2} $$\nSubstituting $L \\sim c \\tau_{\\text{up}}$:\n$$ \\frac{1}{\\tau_{\\text{up}}} \\sim \\frac{D}{(c \\tau_{\\text{up}})^2} $$\n$$ c^2 \\tau_{\\text{up}}^2 \\sim D \\tau_{\\text{up}} $$\n$$ c^2 \\sim \\frac{D}{\\tau_{\\text{up}}} $$\nThis gives the leading-order scaling for the conduction speed:\n$$ c \\sim \\sqrt{\\frac{D}{\\tau_{\\text{up}}}} $$\n\n**1) Conduction Speed Along Fibers ($c_{\\ell}$)**\n\nFor a one-dimensional cable aligned with the myocardial fibers, the relevant diffusion coefficient is the longitudinal one, $D = D_{\\ell}$.\n$$ c_{\\ell} = \\sqrt{\\frac{D_{\\ell}}{\\tau_{\\text{up}}}} $$\nGiven $D_{\\ell} = 1.2 \\times 10^{-3}\\ \\mathrm{cm}^2/\\mathrm{ms}$ and $\\tau_{\\text{up}} = 0.8\\ \\mathrm{ms}$:\n$$ c_{\\ell} = \\sqrt{\\frac{1.2 \\times 10^{-3}\\ \\mathrm{cm}^2/\\mathrm{ms}}{0.8\\ \\mathrm{ms}}} = \\sqrt{1.5 \\times 10^{-3}\\ \\mathrm{cm}^2/\\mathrm{ms}^2} \\approx 0.03873\\ \\mathrm{cm/ms} $$\nTo convert to $\\mathrm{m/s}$:\n$$ 1\\ \\frac{\\mathrm{cm}}{\\mathrm{ms}} = \\frac{10^{-2}\\ \\mathrm{m}}{10^{-3}\\ \\mathrm{s}} = 10\\ \\frac{\\mathrm{m}}{\\mathrm{s}} $$\n$$ c_{\\ell} \\approx 0.03873 \\times 10\\ \\mathrm{m/s} = 0.3873\\ \\mathrm{m/s} $$\n\n**2) Conduction Speed at an Angle $\\theta = 30^{\\circ}$**\n\nIn a two-dimensional slab, the diffusion tensor $\\mathbf{D}$ in the local fiber coordinate system (where the $x_1$-axis is along the fibers) is:\n$$ \\mathbf{D} = \\begin{pmatrix} D_{\\ell} & 0 \\\\ 0 & D_{t} \\end{pmatrix} $$\nFor a planar wave propagating in a direction defined by the unit normal vector $\\mathbf{n}$, forming an angle $\\theta$ with the fiber direction, we have:\n$$ \\mathbf{n} = \\begin{pmatrix} \\cos\\theta \\\\ \\sin\\theta \\end{pmatrix} $$\nThe effective diffusion coefficient $D_{\\text{eff}}(\\theta)$ in the direction of propagation is given by the projection $\\mathbf{n}^T \\mathbf{D} \\mathbf{n}$:\n$$ D_{\\text{eff}}(\\theta) = \\begin{pmatrix} \\cos\\theta & \\sin\\theta \\end{pmatrix} \\begin{pmatrix} D_{\\ell} & 0 \\\\ 0 & D_{t} \\end{pmatrix} \\begin{pmatrix} \\cos\\theta \\\\ \\sin\\theta \\end{pmatrix} = \\begin{pmatrix} \\cos\\theta & \\sin\\theta \\end{pmatrix} \\begin{pmatrix} D_{\\ell}\\cos\\theta \\\\ D_{t}\\sin\\theta \\end{pmatrix} $$\n$$ D_{\\text{eff}}(\\theta) = D_{\\ell}\\cos^2\\theta + D_{t}\\sin^2\\theta $$\nThis is the expression for the effective diffusion coefficient.\n\nFor $\\theta = 30^{\\circ}$, we have $\\cos(30^{\\circ}) = \\frac{\\sqrt{3}}{2}$ and $\\sin(30^{\\circ}) = \\frac{1}{2}$. Thus, $\\cos^2(30^{\\circ}) = \\frac{3}{4}$ and $\\sin^2(30^{\\circ}) = \\frac{1}{4}$.\nUsing the given data, $D_{\\ell} = 1.2 \\times 10^{-3}\\ \\mathrm{cm}^2/\\mathrm{ms}$ and $D_{t} = 3.0 \\times 10^{-4}\\ \\mathrm{cm}^2/\\mathrm{ms}$:\n$$ D_{\\text{eff}}(30^{\\circ}) = (1.2 \\times 10^{-3})\\left(\\frac{3}{4}\\right) + (3.0 \\times 10^{-4})\\left(\\frac{1}{4}\\right) $$\n$$ D_{\\text{eff}}(30^{\\circ}) = 0.9 \\times 10^{-3} + 0.75 \\times 10^{-4} = 0.9 \\times 10^{-3} + 0.075 \\times 10^{-3} $$\n$$ D_{\\text{eff}}(30^{\\circ}) = 0.975 \\times 10^{-3}\\ \\mathrm{cm}^2/\\mathrm{ms} $$\nThe resulting speed $c(30^{\\circ})$ is:\n$$ c(30^{\\circ}) = \\sqrt{\\frac{D_{\\text{eff}}(30^{\\circ})}{\\tau_{\\text{up}}}} = \\sqrt{\\frac{0.975 \\times 10^{-3}\\ \\mathrm{cm}^2/\\mathrm{ms}}{0.8\\ \\mathrm{ms}}} = \\sqrt{1.21875 \\times 10^{-3}\\ \\mathrm{cm}^2/\\mathrm{ms}^2} $$\n$$ c(30^{\\circ}) \\approx 0.0349106\\ \\mathrm{cm/ms} $$\nConverting to $\\mathrm{m/s}$:\n$$ c(30^{\\circ}) \\approx 0.0349106 \\times 10\\ \\mathrm{m/s} = 0.349106\\ \\mathrm{m/s} $$\nRounding to three significant figures, we get $c(30^{\\circ}) \\approx 0.349\\ \\mathrm{m/s}$.\n\n**Qualitative Explanation of Anisotropy Effects**\n\nAnisotropic conductivity, where $D_{\\ell} > D_{t}$, has profound effects on wavefront propagation.\n- **Effective Diffusion and Speed**: The effective diffusion coefficient, $D_{\\text{eff}}(\\theta) = D_{\\ell}\\cos^2\\theta + D_{t}\\sin^2\\theta$, is not constant but varies with the angle $\\theta$ of propagation relative to the fiber direction. Since $D_{\\ell}$ is the largest coefficient, $D_{\\text{eff}}$ is maximal when $\\cos^2\\theta = 1$ (i.e., $\\theta = 0^{\\circ}$ or $180^{\\circ}$), corresponding to propagation purely along the fibers. It is minimal when $\\sin^2\\theta = 1$ (i.e., $\\theta = 90^{\\circ}$ or $270^{\\circ}$), for propagation transverse to the fibers. As the speed scales with $\\sqrt{D_{\\text{eff}}}$, the propagation speed is fastest along the fibers and slowest transverse to them.\n- **Wavefront Curvature**: In an isotropic medium ($D_{\\ell} = D_{t}$), the diffusion operator is the Laplacian, $D\\nabla^2 V$. Diffusive current flows perpendicular to the wavefront (i.e., along the gradient $\\nabla V$). This leads to a symmetric relationship between curvature and speed (e.g., a point stimulus generates a circular wave). In an anisotropic medium, the diffusion operator is $\\nabla \\cdot (\\mathbf{D} \\nabla V)$. The diffusive current flux is $\\mathbf{j} = -\\mathbf{D}\\nabla V$. Because $\\mathbf{D}$ is a tensor, the flux vector $\\mathbf{j}$ is generally not parallel to the potential gradient $\\nabla V$. Instead, it is rotated toward the direction of higher diffusivity (the fiber axis). This means that even if a wavefront has a certain curvature, the diffusive currents that smooth it are skewed. A consequence is that a wavefront initiated from a point stimulus will not be circular; it will be elongated in the fiber direction, forming an elliptical shape, as propagation is faster along this axis. The interplay between local wavefront curvature and local speed becomes dependent on the orientation of the wavefront segment with respect to the fibers, breaking the simple isotropic relationship.", "answer": "$$\\boxed{0.349}$$", "id": "3496978"}, {"introduction": "Once the electrical signal passes, the myocardial cells contract, generating force and stiffening the heart chamber walls. This mechanical activity drives the changes in pressure and volume that constitute the cardiac cycle. Using the classic time-varying elastance framework, this practice provides a tangible link between electrophysiology and hemodynamics by tasking you to compute the pressure-volume loop and the resulting stroke work, and to analyze how this work is modulated by preload and afterload.", "problem": "A simplified but mechanistically consistent left-ventricular model is considered to capture cardiovascular fluid–structure–electrophysiology coupling during one cardiac cycle. The left-ventricular pressure obeys the time-varying elastance relation $P(t) = E(t)\\,\\big(V(t)-V_{0}\\big)$, where $P(t)$ is pressure, $V(t)$ is chamber volume, $V_{0}$ is the volume-axis intercept, and $E(t)$ is the instantaneous elastance. The structural (myocardial) state is driven by the electrophysiology through the active myocyte tension $T_{\\text{act}}(t)$ via the linear constitutive coupling $E(t) = E_{\\min} + \\gamma\\,T_{\\text{act}}(t)$. Assume that $T_{\\text{act}}(t)$ rises from $0$ to its peak $T_{\\text{act}}^{\\max}$ during systolic activation and then falls back to $0$ during relaxation, so that $E(t)$ rises from $E_{\\min}$ to $E_{\\max} = E_{\\min} + \\gamma\\,T_{\\text{act}}^{\\max}$ and then falls back to $E_{\\min}$.\n\nHemodynamics are modeled with ideal diodes for the mitral and aortic valves, negligible valvular resistance, and large atrial and aortic compliances that maintain constant upstream and downstream pressures: the left atrium is a reservoir at pressure $P_{v}$ (preload) and the proximal aorta is a reservoir at pressure $P_{a}$ (afterload). With negligible resistance, when a valve is open the chamber pressure equals the connected reservoir pressure. The mitral valve opens when $P(t) \\le P_{v}$ and the aortic valve opens when $P(t) \\ge P_{a}$. Both valves are closed otherwise. Neglect inertial and viscous effects in the blood columns.\n\nStarting only from these assumptions and the definitions of pressure, volume, and work in continuum mechanics, and treating $T_{\\text{act}}(t)$ as the driver of $E(t)$, derive the piecewise path of the pressure–volume loop over one beat and compute the stroke work (the enclosed area) for the following three cases:\n- Baseline: $E_{\\min} = 0.08$ mmHg/mL, $\\gamma = 1.74$ mmHg/(mL·unit tension), $T_{\\text{act}}^{\\max} = 1$ (dimensionless), $P_{v} = 10$ mmHg, $P_{a} = 100$ mmHg.\n- Increased preload: same parameters as baseline except $P_{v} = 12$ mmHg.\n- Increased afterload: same parameters as baseline except $P_{a} = 120$ mmHg.\n\nAssume the activation is sufficiently slow that the transitions between valve states occur quasi-statically as $E(t)$ rises and falls, and assume the cycle is periodic so that the end-diastolic and end-systolic states repeat each beat. You may take $V_{0}$ as a constant that does not need to be specified numerically.\n\nReport your three stroke-work values as a single row vector in the order (baseline, increased preload, increased afterload). Express the final results in mmHg·mL, and round each entry to four significant figures.", "solution": "The problem is first validated to ensure it is scientifically sound, well-posed, and objective. The givens are:\n-   Pressure-volume relation: $P(t) = E(t)\\,\\big(V(t)-V_{0}\\big)$\n-   Elastance-tension coupling: $E(t) = E_{\\min} + \\gamma\\,T_{\\text{act}}(t)$\n-   Maximum elastance: $E_{\\max} = E_{\\min} + \\gamma\\,T_{\\text{act}}^{\\max}$\n-   Valve logic: Mitral valve opens for $P(t) \\le P_{v}$, Aortic valve opens for $P(t) \\ge P_{a}$. When open, chamber pressure equals reservoir pressure.\n-   Constant preload: $P_{v}$\n-   Constant afterload: $P_{a}$\n-   Assumptions: Ideal valves, negligible resistance, inertial, and viscous effects, quasi-static transitions, periodic cycle.\n-   Parameters for three cases:\n    1.  Baseline: $E_{\\min} = 0.08$ mmHg/mL, $\\gamma = 1.74$ mmHg/(mL·unit tension), $T_{\\text{act}}^{\\max} = 1$, $P_{v} = 10$ mmHg, $P_{a} = 100$ mmHg.\n    2.  Increased preload: Same as baseline, but $P_{v} = 12$ mmHg.\n    3.  Increased afterload: Same as baseline, but $P_{a} = 120$ mmHg.\n\nThe problem is valid. It is based on the standard and well-established time-varying elastance framework of cardiovascular mechanics, a simplification but not a violation of principles. The parameters are defined, the goals are clear, and the assumptions (e.g., quasi-static behavior, ideal valves) render the problem well-posed and algebraically solvable. The use of $V_0$ as an unspecified constant is acceptable as it will be shown to cancel out.\n\nThe pressure-volume (PV) loop describes the work done by the ventricle in one cardiac cycle. The problem's assumptions simplify the four phases of the cardiac cycle into four distinct segments in the PV plane:\n1.  **Isovolumetric Contraction**: Both valves are closed. Volume is constant at the end-diastolic volume, $V_{\\mathrm{ED}}$. Pressure rises from the preload $P_{v}$ to the afterload $P_{a}$. This is a vertical line segment in the PV plane.\n2.  **Ejection**: The aortic valve opens. Pressure is held constant at the afterload, $P_{a}$. Volume decreases from $V_{\\mathrm{ED}}$ to the end-systolic volume, $V_{\\mathrm{ES}}$. This is a horizontal line segment.\n3.  **Isovolumetric Relaxation**: Both valves are closed. Volume is constant at $V_{\\mathrm{ES}}$. Pressure falls from $P_{a}$ to $P_{v}$. This is a vertical line segment.\n4.  **Filling**: The mitral valve opens. Pressure is held constant at the preload, $P_{v}$. Volume increases from $V_{\\mathrm{ES}}$ back to $V_{\\mathrm{ED}}$. This is a horizontal line segment.\n\nThese four segments form a rectangle in the PV plane, with vertices at $(V_{\\mathrm{ED}}, P_{v})$, $(V_{\\mathrm{ED}}, P_{a})$, $(V_{\\mathrm{ES}}, P_{a})$, and $(V_{\\mathrm{ES}}, P_{v})$. The stroke work, $W_{\\mathrm{stroke}}$, is the area enclosed by this loop.\n\nThe volumes $V_{\\mathrm{ED}}$ and $V_{\\mathrm{ES}}$ are determined by the state of the ventricle at the boundaries of the filling and ejection phases.\nThe end of the filling phase (end-diastole) occurs when the ventricle is maximally relaxed, so its elastance is at its minimum, $E_{\\min}$. At this point, the pressure is the preload, $P_v$. Using the pressure-volume relation:\n$$P_{v} = E_{\\min}(V_{\\mathrm{ED}} - V_{0})$$\nSolving for the end-diastolic volume, $V_{\\mathrm{ED}}$:\n$$V_{\\mathrm{ED}} = V_{0} + \\frac{P_{v}}{E_{\\min}}$$\n\nThe end of the ejection phase (end-systole) occurs when the ventricle is maximally contracted, so its elastance is at its peak, $E_{\\max}$. At this point, the pressure is the afterload, $P_a$. Using the pressure-volume relation:\n$$P_{a} = E_{\\max}(V_{\\mathrm{ES}} - V_{0})$$\nSolving for the end-systolic volume, $V_{\\mathrm{ES}}$:\n$$V_{\\mathrm{ES}} = V_{0} + \\frac{P_{a}}{E_{\\max}}$$\nNote that for ejection to occur, it must be that $V_{\\mathrm{ED}} > V_{\\mathrm{ES}}$, which implies $\\frac{P_{v}}{E_{\\min}} > \\frac{P_{a}}{E_{\\max}}$.\n\nThe stroke work is the area of the PV rectangle, which is the product of the change in pressure and the change in volume (stroke volume, $SV$).\n$$W_{\\mathrm{stroke}} = (P_{a} - P_{v}) \\times (V_{\\mathrm{ED}} - V_{\\mathrm{ES}})$$\nThe stroke volume, $SV = V_{\\mathrm{ED}} - V_{\\mathrm{ES}}$, can be computed by substituting the expressions for the volumes:\n$$SV = \\left(V_{0} + \\frac{P_{v}}{E_{\\min}}\\right) - \\left(V_{0} + \\frac{P_{a}}{E_{\\max}}\\right) = \\frac{P_{v}}{E_{\\min}} - \\frac{P_{a}}{E_{\\max}}$$\nThe unknown constant $V_{0}$ cancels out, as anticipated.\nThe final expression for stroke work is:\n$$W_{\\mathrm{stroke}} = (P_{a} - P_{v})\\left(\\frac{P_{v}}{E_{\\min}} - \\frac{P_{a}}{E_{\\max}}\\right)$$\n\nNow, we calculate the numerical values for the three requested cases. First, calculate the maximum elastance, $E_{\\max}$, which is common to all cases:\n$E_{\\min} = 0.08$ mmHg/mL, $\\gamma = 1.74$ mmHg/(mL·unit tension), $T_{\\text{act}}^{\\max} = 1$.\n$$E_{\\max} = E_{\\min} + \\gamma T_{\\text{act}}^{\\max} = 0.08 + 1.74 \\times 1 = 1.82 \\, \\text{mmHg/mL}$$\n\n**Case 1: Baseline**\nParameters: $P_{v} = 10$ mmHg, $P_{a} = 100$ mmHg, $E_{\\min} = 0.08$ mmHg/mL, $E_{\\max} = 1.82$ mmHg/mL.\n$$W_{\\text{base}} = (100 - 10) \\left( \\frac{10}{0.08} - \\frac{100}{1.82} \\right)$$\n$$W_{\\text{base}} = 90 \\left( 125 - 54.94505... \\right) = 90 \\left( 70.054945... \\right) \\approx 6304.945 \\, \\text{mmHg}\\cdot\\text{mL}$$\nRounding to four significant figures, $W_{\\text{base}} = 6305$ mmHg·mL.\n\n**Case 2: Increased Preload**\nParameters: $P_{v} = 12$ mmHg, $P_{a} = 100$ mmHg, $E_{\\min} = 0.08$ mmHg/mL, $E_{\\max} = 1.82$ mmHg/mL.\n$$W_{\\text{preload}} = (100 - 12) \\left( \\frac{12}{0.08} - \\frac{100}{1.82} \\right)$$\n$$W_{\\text{preload}} = 88 \\left( 150 - 54.94505... \\right) = 88 \\left( 95.054945... \\right) \\approx 8364.835 \\, \\text{mmHg}\\cdot\\text{mL}$$\nRounding to four significant figures, $W_{\\text{preload}} = 8365$ mmHg·mL.\n\n**Case 3: Increased Afterload**\nParameters: $P_{v} = 10$ mmHg, $P_{a} = 120$ mmHg, $E_{\\min} = 0.08$ mmHg/mL, $E_{\\max} = 1.82$ mmHg/mL.\n$$W_{\\text{afterload}} = (120 - 10) \\left( \\frac{10}{0.08} - \\frac{120}{1.82} \\right)$$\n$$W_{\\text{afterload}} = 110 \\left( 125 - 65.93406... \\right) = 110 \\left( 59.065934... \\right) \\approx 6497.252 \\, \\text{mmHg}\\cdot\\text{mL}$$\nRounding to four significant figures, $W_{\\text{afterload}} = 6497$ mmHg·mL.\n\nThe three stroke-work values are $(6305, 8365, 6497)$ mmHg·mL.", "answer": "$$\\boxed{\\begin{pmatrix} 6305 & 8365 & 6497 \\end{pmatrix}}$$", "id": "3496958"}, {"introduction": "Capturing the interaction between the deformable heart wall and the dense blood it pumps is a formidable computational task. A common partitioned approach, where fluid and structure are solved separately, can suffer from numerical instability due to the 'added-mass' effect. This exercise illuminates this core challenge of cardiovascular fluid-structure interaction by having you derive and compare the stability properties of monolithic and partitioned schemes for a simplified model, offering direct insight into the numerical foundations of coupled simulations.", "problem": "You are asked to design and analyze a reduced-order, monolithic versus partitioned coupling study that captures the stability impact of the added-mass effect for a beating ventricle undergoing fluid–structure–electrophysiology coupling. The focus is on the logical derivation and numerical quantification of stability using the interfacial traction and kinematic conditions and an Arbitrary Lagrangian–Eulerian (ALE) mesh motion. The goal is to derive linear update operators and compute their spectral radii to assess stability of the discrete-time schemes.\n\nStarting point and assumptions:\n- Fundamental laws and interface conditions:\n  - Newton’s second law applied to a control volume of fluid and the structural wall.\n  - Continuity of traction at the fluid–structure interface: $[\\boldsymbol{\\sigma}_f \\mathbf{n}] = [\\boldsymbol{\\sigma}_s \\mathbf{n}]$.\n  - Kinematic continuity at the interface: $\\mathbf{u}_f = \\dot{\\mathbf{x}}_s$.\n  - Arbitrary Lagrangian–Eulerian (ALE) mesh motion: the fluid mesh velocity at the interface equals the structural velocity so that the kinematic condition is enforced consistently.\n- Reduced-order model:\n  - Consider a one-dimensional, linearized representation of a ventricle wall segment coupled to its intraventricular fluid. The structure is modeled as a single-degree-of-freedom mass–spring–damper with structural mass $M_s$, damping $C$, and stiffness $K$. The fluid is represented through an effective added mass $M_a$ that embodies the inertia of the fluid slaved to the wall via the ALE condition. This representation is derived by applying Newton’s second law to the fluid control volume and invoking $\\mathbf{u}_f = \\dot{\\mathbf{x}}_s$ to show that the wall acceleration induces a fluid reaction force proportional to $M_a \\ddot{x}$.\n  - The electrophysiology (EP) enters as an active stress that generates an active force $F_{\\text{active}}(t)$ in the structural equation. For the purpose of discrete-time stability of the homogeneous equations, set $F_{\\text{active}}(t) = 0$. This isolates the stability properties of the coupling itself. You may assume non-dimensional variables, so no physical units are required in the output.\n\nContinuous equations:\n- Structure with fluid reaction (using dynamic and kinematic continuity):\n  $$\n  (M_s + M_a)\\,\\ddot{x}(t) + C\\,\\dot{x}(t) + K\\,x(t) = F_{\\text{active}}(t).\n  $$\n  For stability analysis, use $F_{\\text{active}}(t) = 0$.\n\nDiscretizations to be derived and analyzed:\n- Monolithic scheme (implicit, single field solve):\n  - Write the first-order state form with $x(t)$ and $v(t) = \\dot{x}(t)$:\n    $$\n    \\dot{x} = v,\\quad \\dot{v} = -\\frac{C}{M_s + M_a} v - \\frac{K}{M_s + M_a} x.\n    $$\n  - Apply backward Euler with time step $\\Delta t$ to obtain a linear update $y^{n+1} = \\mathbf{G}_{\\text{mono}}\\,y^n$ for $y^n = [x^n, v^n]^\\top$. Derive $\\mathbf{G}_{\\text{mono}}$ from the fundamental definition of backward Euler applied to the above state-space system.\n\n- Partitioned, loosely coupled scheme (explicit fluid reaction with one-step lag):\n  - Use the ALE kinematic condition and linearized fluid momentum to represent the fluid reaction as an added-mass force $-M_a \\ddot{x}$, but treat it partitionedly with a one-step lag in the structure update. Use forward Euler for the structural state update and explicitly lag the fluid acceleration by one time step:\n    $$\n    a^n = \\ddot{x}^n = \\frac{-C\\,v^n - K\\,x^n + M_a\\,a^{n-1}}{M_s},\\quad v^{n+1} = v^n + \\Delta t\\,a^n,\\quad x^{n+1} = x^n + \\Delta t\\,v^n.\n    $$\n  - Define the augmented state $z^n = [x^n, v^n, a^{n-1}]^\\top$ and derive the $3\\times 3$ amplification matrix $\\mathbf{G}_{\\text{part}}$ such that $z^{n+1} = \\mathbf{G}_{\\text{part}}\\,z^n$.\n\nStability quantification:\n- For each scheme, compute the spectral radius, defined as the maximum magnitude of the eigenvalues of the amplification matrix. Denote these as $\\rho_{\\text{mono}}$ and $\\rho_{\\text{part}}$.\n- Stability criterion: a scheme is deemed linearly stable for the homogeneous system if the spectral radius is strictly less than $1$ (use a small numerical tolerance in implementation). Record stability as an integer $1$ for stable and $0$ for unstable.\n\nTest suite:\n- Use the following five parameter sets, each specified as $(M_s, M_a, C, K, \\Delta t)$ with non-dimensional values:\n  1. $(1.0, 0.5, 0.1, 100.0, 0.005)$ capturing a moderate added-mass ratio and small time step.\n  2. $(1.0, 5.0, 0.1, 100.0, 0.005)$ highlighting a large added-mass ratio.\n  3. $(1.0, 5.0, 2.0, 100.0, 0.005)$ exploring the effect of larger damping for large added mass.\n  4. $(1.0, 0.9, 0.0, 100.0, 0.02)$ as a low-damping, larger time-step scenario.\n  5. $(1.0, 0.0, 0.0, 100.0, 0.02)$ as a no-fluid edge case.\n\nProgram requirements:\n- Implement the derivations to construct $\\mathbf{G}_{\\text{mono}}$ and $\\mathbf{G}_{\\text{part}}$ for each test case, compute $\\rho_{\\text{mono}}$ and $\\rho_{\\text{part}}$, and determine stability flags $s_{\\text{mono}}$ and $s_{\\text{part}}$ where $s_{\\text{mono}} = 1$ if $\\rho_{\\text{mono}} < 1$ and $0$ otherwise (use a numerical tolerance), and similarly for $s_{\\text{part}}$.\n- For each test case, output a list $[\\rho_{\\text{mono}}, \\rho_{\\text{part}}, s_{\\text{mono}}, s_{\\text{part}}]$ where the spectral radii are floats rounded to six decimal places and the stabilities are integers.\n- Your program should produce a single line of output containing the results for all test cases as a comma-separated list enclosed in square brackets, where each test case result appears as its own sub-list. For example: \"[[r1_mono,r1_part,s1_mono,s1_part],[r2_mono,r2_part,s2_mono,s2_part],...]\" (this is an illustrative format; your actual numeric values will differ).\n- All outputs are non-dimensional numbers; no physical units are required. Angles are not used.\n\nDeliverables:\n- Provide a complete, runnable program that constructs the amplification matrices based on the derivations above, computes the spectral radii, assesses stability, and prints the aggregated results exactly in the specified single-line format.", "solution": "The problem requires the derivation and stability analysis of two numerical coupling schemes, monolithic and partitioned, for a simplified one-dimensional fluid-structure interaction (FSI) model representing a segment of a beating ventricle. The stability is assessed by computing the spectral radius of the amplification matrix for each scheme.\n\nThe governing ordinary differential equation for the structure's displacement $x(t)$, including the fluid's added mass effect, is given as:\n$$\n(M_s + M_a)\\,\\ddot{x}(t) + C\\,\\dot{x}(t) + K\\,x(t) = 0\n$$\nwhere $M_s$ is the structural mass, $M_a$ is the fluid added mass, $C$ is the damping coefficient, and $K$ is the stiffness. The active force $F_{\\text{active}}(t)$ is set to zero for the homogeneous stability analysis.\n\nLet us define the total mass as $M_{tot} = M_s + M_a$. The equation can be rewritten in state-space form. Let the state vector be $y(t) = [x(t), v(t)]^\\top$, where $v(t) = \\dot{x}(t)$ is the velocity. The first-order system is:\n$$\n\\dot{y}(t) = \\begin{pmatrix} \\dot{x}(t) \\\\ \\dot{v}(t) \\end{pmatrix} = \\begin{pmatrix} v(t) \\\\ -\\frac{K}{M_{tot}}x(t) - \\frac{C}{M_{tot}}v(t) \\end{pmatrix} = \\begin{pmatrix} 0 & 1 \\\\ -\\frac{K}{M_{tot}} & -\\frac{C}{M_{tot}} \\end{pmatrix} \\begin{pmatrix} x(t) \\\\ v(t) \\end{pmatrix}\n$$\nThis is of the form $\\dot{y} = \\mathbf{A}y$, with the system matrix $\\mathbf{A}$ defined as:\n$$\n\\mathbf{A} = \\begin{pmatrix} 0 & 1 \\\\ -\\frac{K}{M_{tot}} & -\\frac{C}{M_{tot}} \\end{pmatrix}\n$$\n\n### Monolithic Scheme Derivation\n\nThe monolithic scheme solves for all fields simultaneously using an implicit time-stepping method. Here, we apply the backward Euler method to the state-space system with a time step $\\Delta t$. The discrete update rule for backward Euler is:\n$$\ny^{n+1} = y^n + \\Delta t \\, \\dot{y}^{n+1}\n$$\nSubstituting $\\dot{y}^{n+1} = \\mathbf{A}y^{n+1}$:\n$$\ny^{n+1} = y^n + \\Delta t \\, \\mathbf{A}y^{n+1}\n$$\nRearranging to solve for the state at the new time step, $y^{n+1}$:\n$$\n(\\mathbf{I} - \\Delta t \\, \\mathbf{A})y^{n+1} = y^n\n$$\nwhere $\\mathbf{I}$ is the $2 \\times 2$ identity matrix. This leads to the linear update form $y^{n+1} = \\mathbf{G}_{\\text{mono}} y^n$, where the amplification matrix $\\mathbf{G}_{\\text{mono}}$ is:\n$$\n\\mathbf{G}_{\\text{mono}} = (\\mathbf{I} - \\Delta t \\, \\mathbf{A})^{-1}\n$$\nLet's construct the matrix to be inverted:\n$$\n\\mathbf{I} - \\Delta t \\, \\mathbf{A} = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix} - \\Delta t \\begin{pmatrix} 0 & 1 \\\\ -\\frac{K}{M_{tot}} & -\\frac{C}{M_{tot}} \\end{pmatrix} = \\begin{pmatrix} 1 & -\\Delta t \\\\ \\frac{K \\Delta t}{M_{tot}} & 1 + \\frac{C \\Delta t}{M_{tot}} \\end{pmatrix}\n$$\nThe determinant of this matrix is:\n$$\n\\det(\\mathbf{I} - \\Delta t \\, \\mathbf{A}) = 1 \\cdot \\left(1 + \\frac{C \\Delta t}{M_{tot}}\\right) - (-\\Delta t)\\left(\\frac{K \\Delta t}{M_{tot}}\\right) = 1 + \\frac{C \\Delta t}{M_{tot}} + \\frac{K (\\Delta t)^2}{M_{tot}}\n$$\nThe inverse is then:\n$$\n\\mathbf{G}_{\\text{mono}} = \\frac{1}{1 + \\frac{C \\Delta t}{M_{tot}} + \\frac{K (\\Delta t)^2}{M_{tot}}} \\begin{pmatrix} 1 + \\frac{C \\Delta t}{M_{tot}} & \\Delta t \\\\ -\\frac{K \\Delta t}{M_{tot}} & 1 \\end{pmatrix}\n$$\nThe stability of this scheme is determined by the spectral radius $\\rho_{\\text{mono}} = \\max_i |\\lambda_i(\\mathbf{G}_{\\text{mono}})|$. Since backward Euler is an A-stable method, we expect $\\rho_{\\text{mono}} \\le 1$ for any choice of parameters and $\\Delta t > 0$.\n\n### Partitioned Scheme Derivation\n\nThe partitioned scheme treats the fluid reaction force explicitly with a one-time-step lag. The structural equations are advanced using a forward Euler method. The discrete update equations are given as:\n\\begin{align*}\nx^{n+1} &= x^n + \\Delta t\\,v^n \\\\\nv^{n+1} &= v^n + \\Delta t\\,a^n \\\\\na^n &= \\frac{-C\\,v^n - K\\,x^n + M_a\\,a^{n-1}}{M_s}\n\\end{align*}\nTo analyze stability, we define an augmented state vector $z^n = [x^n, v^n, a^{n-1}]^\\top$. The state at the next time step is $z^{n+1} = [x^{n+1}, v^{n+1}, a^n]^\\top$. We need to find the $3 \\times 3$ amplification matrix $\\mathbf{G}_{\\text{part}}$ such that $z^{n+1} = \\mathbf{G}_{\\text{part}} z^n$.\n\nLet's express each component of $z^{n+1}$ in terms of the components of $z^n$:\n1.  For $x^{n+1}$:\n    $$\n    x^{n+1} = 1 \\cdot x^n + \\Delta t \\cdot v^n + 0 \\cdot a^{n-1}\n    $$\n2.  For $v^{n+1}$: Substitute the expression for $a^n$.\n    $$\n    v^{n+1} = v^n + \\Delta t \\left( \\frac{-K}{M_s}x^n - \\frac{C}{M_s}v^n + \\frac{M_a}{M_s}a^{n-1} \\right) = -\\frac{K \\Delta t}{M_s}x^n + \\left(1 - \\frac{C \\Delta t}{M_s}\\right)v^n + \\frac{M_a \\Delta t}{M_s}a^{n-1}\n    $$\n3.  For $a^n$: The expression is already in the required form.\n    $$\n    a^n = -\\frac{K}{M_s}x^n - \\frac{C}{M_s}v^n + \\frac{M_a}{M_s}a^{n-1}\n    $$\nCombining these into a matrix equation gives:\n$$\n\\begin{pmatrix} x^{n+1} \\\\ v^{n+1} \\\\ a^n \\end{pmatrix} = \\begin{pmatrix}\n1 & \\Delta t & 0 \\\\\n-\\frac{K \\Delta t}{M_s} & 1 - \\frac{C \\Delta t}{M_s} & \\frac{M_a \\Delta t}{M_s} \\\\\n-\\frac{K}{M_s} & -\\frac{C}{M_s} & \\frac{M_a}{M_s}\n\\end{pmatrix}\n\\begin{pmatrix} x^n \\\\ v^n \\\\ a^{n-1} \\end{pmatrix}\n$$\nThus, the amplification matrix for the partitioned scheme is:\n$$\n\\mathbf{G}_{\\text{part}} = \\begin{pmatrix}\n1 & \\Delta t & 0 \\\\\n-\\frac{K \\Delta t}{M_s} & 1 - \\frac{C \\Delta t}{M_s} & \\frac{M_a \\Delta t}{M_s} \\\\\n-\\frac{K}{M_s} & -\\frac{C}{M_s} & \\frac{M_a}{M_s}\n\\end{pmatrix}\n$$\nThe stability of this scheme depends on its spectral radius $\\rho_{\\text{part}} = \\max_i |\\lambda_i(\\mathbf{G}_{\\text{part}})|$. This type of explicit coupling is known to be prone to instability, especially for large added-mass ratios ($M_a/M_s$), a phenomenon known as added-mass instability. The scheme is stable if $\\rho_{\\text{part}} < 1$.\n\n### Stability Quantification\n\nFor each scheme, we will compute the eigenvalues of its amplification matrix ($\\mathbf{G}_{\\text{mono}}$ or $\\mathbf{G}_{\\text{part}}$) and find the maximum of their absolute values to obtain the spectral radius. A scheme is declared stable if its spectral radius is strictly less than $1$, which we check numerically. The stability is flagged as $s=1$ for stable and $s=0$ for unstable.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Analyzes the stability of monolithic and partitioned coupling schemes for a\n    reduced-order fluid-structure interaction model.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (Ms, Ma, C, K, dt)\n    test_cases = [\n        (1.0, 0.5, 0.1, 100.0, 0.005),  # Moderate added mass, small dt\n        (1.0, 5.0, 0.1, 100.0, 0.005),  # Large added mass\n        (1.0, 5.0, 2.0, 100.0, 0.005),  # Large added mass, large damping\n        (1.0, 0.9, 0.0, 100.0, 0.02),   # Low damping, larger dt\n        (1.0, 0.0, 0.0, 100.0, 0.02),   # No fluid/damping edge case\n    ]\n\n    results = []\n    for case in test_cases:\n        Ms, Ma, C, K, dt = case\n\n        # --- Monolithic Scheme Analysis ---\n        # The monolithic scheme uses backward Euler on the coupled system.\n        \n        M_tot = Ms + Ma\n        \n        # Stability is guaranteed if M_tot is not zero, which is ensured by Ms=1.0.\n        if M_tot > 0:\n            # System matrix A for dy/dt = Ay\n            A = np.array([\n                [0, 1],\n                [-K / M_tot, -C / M_tot]\n            ])\n            \n            # Amplification matrix G_mono = (I - dt*A)^-1\n            I = np.identity(2)\n            G_mono = np.linalg.inv(I - dt * A)\n            \n            # Compute spectral radius\n            eigvals_mono = np.linalg.eigvals(G_mono)\n            rho_mono = np.max(np.abs(eigvals_mono))\n        else: # Should not happen with given data\n            rho_mono = np.inf\n            \n        s_mono = 1 if rho_mono  1.0 else 0\n\n        # --- Partitioned Scheme Analysis ---\n        # The partitioned scheme uses an explicit formulation with a lagged added-mass term.\n        # Amplification matrix G_part for z_{n+1} = G_part * z_n\n        \n        # We build the G_part matrix according to the derived formula.\n        G_part = np.array([\n            [1, dt, 0],\n            [-K * dt / Ms, 1 - C * dt / Ms, Ma * dt / Ms],\n            [-K / Ms, -C / Ms, Ma / Ms]\n        ])\n        \n        # Compute spectral radius\n        eigvals_part = np.linalg.eigvals(G_part)\n        rho_part = np.max(np.abs(eigvals_part))\n        s_part = 1 if rho_part  1.0 else 0\n\n        # Store the results for this test case\n        results.append([\n            round(rho_mono, 6),\n            round(rho_part, 6),\n            s_mono,\n            s_part\n        ])\n\n    # Final print statement in the exact required format.\n    # The string representation of a list of lists matches the required format.\n    print(f\"[[{', '.join(map(str, results))}]\".replace(\"], [\", \"],[\"))\n\nsolve()\n```", "id": "3496947"}]}