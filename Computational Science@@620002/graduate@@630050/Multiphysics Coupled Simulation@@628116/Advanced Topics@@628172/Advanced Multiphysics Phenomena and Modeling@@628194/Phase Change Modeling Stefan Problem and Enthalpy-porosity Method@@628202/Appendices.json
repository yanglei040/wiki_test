{"hands_on_practices": [{"introduction": "The classical Stefan problem describes phase change with a perfectly sharp, infinitesimally thin interface. At the heart of this model is the Stefan condition, a precise statement of energy conservation that dictates the interface's velocity. This exercise challenges you to derive this fundamental relationship from first principles and apply it to a practical scenario, providing a solid physical foundation for understanding how heat fluxes drive melting or solidification. [@problem_id:3521105]", "problem": "A pure material undergoing one-dimensional melting or solidification is modeled with a sharp planar solid–liquid interface. Let the unit normal $\\boldsymbol{n}$ point from the solid toward the liquid. Assume Fourier heat conduction applies in both phases and neglect volumetric heat sources and kinetic undercooling. The solid and liquid are at the phase-change temperature at the interface. The material has density $\\rho$ and latent heat of fusion $L$ per unit mass. On the solid side, define the scalar normal heat flux $q_s$ to be positive when heat flows from the solid toward the interface (i.e., opposite to $\\boldsymbol{n}$ into the interface). On the liquid side, define the scalar normal heat flux $q_l$ to be positive when heat flows from the interface into the liquid (i.e., along $\\boldsymbol{n}$ away from the interface).\n\nStarting from the statement of local energy conservation and considering a vanishingly thin pillbox control volume around the interface, derive the expression for the normal interface velocity $V_n$ in terms of $q_s$, $q_l$, $\\rho$, and $L$. Then, for a water–ice system with $\\rho = 1000$ kg/m$^3$ and $L = 3.34 \\times 10^{5}$ J/kg, suppose interfacial diagnostics report $q_s = 1.40 \\times 10^{5}$ W/m$^2$ and $q_l = 2.00 \\times 10^{4}$ W/m$^2$ under steady conditions. Compute the value of $V_n$ and interpret the sign in the context of melting versus solidification given the stated normal direction.\n\nExpress the final speed in meters per second and round your answer to four significant figures. Provide the requested interpretation in words separately from the numerical result.", "solution": "The problem requires the derivation of the Stefan condition for interface motion and its application to a specific water-ice system. The validation process confirms that the problem is scientifically sound, self-contained, and well-posed. The ambiguity in a parenthetical phrase regarding the definition of heat flux can be resolved by adhering to the primary definition and the principles of energy conservation.\n\nThe derivation begins by considering the statement of local energy conservation at the sharp solid–liquid interface. We analyze a vanishingly thin control volume (a \"pillbox\") of area $A$ that envelops a segment of the interface and moves with it. The interface has a normal velocity $V_n$, taken as positive when it moves in the direction of the unit normal vector $\\boldsymbol{n}$ (which points from the solid to the liquid phase).\n\nThe first law of thermodynamics for this open control volume, in the absence of volumetric heat sources and with negligible changes in kinetic and potential energy, states that the rate of energy absorption at the interface must equal the net rate of heat conducted into it.\n\nThe rate of energy absorption is due to the phase change. As the interface moves a distance $V_n dt$ in time $dt$, a volume of solid $A V_n dt$ is converted to liquid. The mass converted is $(\\rho A V_n dt)$, where $\\rho$ is the density of the material (assumed constant across the phase change for simplicity, as is standard in this model). The energy required for this phase change is the latent heat of fusion, $L$, per unit mass. Thus, the rate of energy absorbed by the interface is $(\\rho A V_n) L$. The rate per unit area is $\\rho L V_n$.\n\nThe net rate of heat conducted into the interface is the difference between the heat flowing in from the solid side and the heat flowing out into the liquid side. The problem defines the relevant scalar heat fluxes as follows:\n1.  $q_s$: the normal heat flux that is positive when heat flows *from the solid toward the interface*. This represents a heat input to the interface from the solid phase. The total heat input rate from the solid is $q_s A$.\n2.  $q_l$: the normal heat flux that is positive when heat flows *from the interface into the liquid*. This represents a heat loss from the interface to the liquid phase. The total heat loss rate to the liquid is $q_l A$.\n\nThe net heat flux into the interface, per unit area, is therefore the difference between the incoming and outgoing fluxes: $q_s - q_l$.\n\nEquating the rate of energy absorption per unit area with the net heat flux per unit area gives the energy balance at the interface:\n$$\n\\rho L V_n = q_s - q_l\n$$\nThis equation is known as the Stefan condition. Solving for the normal interface velocity $V_n$, we obtain the desired expression:\n$$\nV_n = \\frac{q_s - q_l}{\\rho L}\n$$\n\nNext, we compute the value of $V_n$ for the specified water–ice system. The given parameters are:\nDensity, $\\rho = 1000$ kg/m$^3$\nLatent heat of fusion, $L = 3.34 \\times 10^{5}$ J/kg\nHeat flux from the solid, $q_s = 1.40 \\times 10^{5}$ W/m$^2$\nHeat flux into the liquid, $q_l = 2.00 \\times 10^{4}$ W/m$^2$\n\nFirst, we calculate the net heat flux at the interface, $q_s - q_l$:\n$$\nq_s - q_l = (1.40 \\times 10^{5} \\text{ W/m}^2) - (2.00 \\times 10^{4} \\text{ W/m}^2) = 1.20 \\times 10^{5} \\text{ W/m}^2\n$$\nThe positive result indicates a net flow of energy into the interface.\n\nNext, we calculate the volumetric latent heat, $\\rho L$:\n$$\n\\rho L = (1000 \\text{ kg/m}^3) \\times (3.34 \\times 10^{5} \\text{ J/kg}) = 3.34 \\times 10^{8} \\text{ J/m}^3\n$$\n\nNow, we can compute $V_n$ using the derived formula. Noting that $1 \\text{ W} = 1 \\text{ J/s}$, the units are consistent: $(\\text{J/s} \\cdot \\text{m}^{-2}) / (\\text{J} \\cdot \\text{m}^{-3}) = \\text{m/s}$.\n$$\nV_n = \\frac{1.20 \\times 10^{5} \\text{ J/(s}\\cdot\\text{m}^2)}{3.34 \\times 10^{8} \\text{ J/m}^3} \\approx 3.59281 \\times 10^{-4} \\text{ m/s}\n$$\nRounding the result to four significant figures as requested:\n$$\nV_n \\approx 3.593 \\times 10^{-4} \\text{ m/s}\n$$\n\nFinally, we interpret the sign of the result. The calculated velocity $V_n$ is positive. By definition, the unit normal vector $\\boldsymbol{n}$ points from the solid phase toward the liquid phase. Since the interface velocity vector is $\\boldsymbol{V} = V_n \\boldsymbol{n}$, a positive $V_n$ signifies that the interface is moving in the direction of $\\boldsymbol{n}$. This means the interface is advancing into the region occupied by the solid, converting it to liquid. Therefore, a positive sign for $V_n$ corresponds to the process of **melting**. A negative sign would have indicated solidification (freezing). This physical interpretation is consistent with the heat fluxes: the heat supplied to the interface ($q_s$) is greater than the heat removed from it ($q_l$), resulting in a net energy gain that drives the endothermic process of melting.", "answer": "$$\\boxed{3.593 \\times 10^{-4}}$$", "id": "3521105"}, {"introduction": "While elegant, explicitly tracking a sharp interface as in the classical Stefan problem is computationally complex. The enthalpy method offers a powerful alternative by reformulating the problem on a fixed grid, treating the phase change as a rapid variation in heat capacity within a 'mushy' zone. This coding exercise provides a direct comparison between the two approaches: you will implement a numerical enthalpy-based model and validate its accuracy against the exact analytical solution for a 1D melting problem, gaining insight into the practicalities of phase change simulation. [@problem_id:3521150]", "problem": "Consider one-dimensional melting in a semi-infinite medium with no fluid flow and constant thermophysical properties. The Governing Energy Conservation Law states that the divergence of the conductive heat flux equals the rate of change of sensible and latent heat. Let the density be $\\rho$, the specific heat capacity be $c_p$, the thermal conductivity be $k$, and the latent heat of fusion be $L$. Let the melting temperature be $T_m$. Enthalpy is defined as $h(T) = c_p (T - T_{\\mathrm{ref}}) + L f_\\ell(T)$, where $f_\\ell(T)$ is the liquid fraction with $0 \\le f_\\ell \\le 1$.\n\nYou will implement two approaches to determine the melting front location at a fixed final time.\n\n1) A reference moving-interface approach based on the classical Stefan formulation with an isothermal interface satisfying a jump condition derived from energy conservation. Consider an initially isothermal solid at $T(x,0) = T_m$ for all $x \\ge 0$, with a suddenly raised boundary temperature $T(0,t) = T_b$ for $t \\ge 0$, where $T_b > T_m$. With constant properties and no convection, the classical similarity solution yields an interface position $s(t) = 2 \\lambda \\sqrt{\\alpha t}$ for $t > 0$, where $\\alpha = k/(\\rho c_p)$ is the thermal diffusivity, and the parameter $\\lambda$ satisfies the transcendental equation\n$$\n\\sqrt{\\pi}\\, \\lambda \\, e^{\\lambda^2} \\, \\mathrm{erf}(\\lambda) = \\mathrm{Ste},\n$$\nwith $\\mathrm{Ste} = \\dfrac{c_p (T_b - T_m)}{L}$ the Stefan number. Here $\\mathrm{erf}(\\cdot)$ denotes the error function. This solution represents the moving-mesh solution with an isothermal interface and the appropriate jump condition.\n\n2) An enthalpy-porosity method with an isothermal phase-change constraint enforced via a phase-field-like penalty. In one dimension without fluid flow, this reduces to an enthalpy method with an apparent heat capacity, augmented by a penalty source that relaxes the temperature toward $T_m$ inside the mushy region. Use an apparent heat capacity\n$$\nc_{\\mathrm{app}}(T) = c_p + \\frac{L}{\\Delta T} \\, \\chi_{\\mathrm{m}}(T),\n$$\nwhere $\\Delta T$ is a small smoothing width and $\\chi_{\\mathrm{m}}(T)$ is $1$ if $|T - T_m| < \\Delta T/2$ and $0$ otherwise. Evolve the temperature by\n$$\n\\frac{\\partial T}{\\partial t} = \\frac{k}{\\rho \\, c_{\\mathrm{app}}(T)} \\frac{\\partial^2 T}{\\partial x^2} - \\beta \\, (T - T_m) \\, \\chi_{\\mathrm{m}}(T),\n$$\nwhere $\\beta \\ge 0$ is a penalty coefficient with units of inverse time. The penalty term acts only in the mushy region and enforces the isothermal constraint $T \\approx T_m$ there. The initial condition is $T(x,0) = T_m$ for all $x \\in [0,L_x]$. Boundary conditions are $T(0,t) = T_b$ and zero heat flux at $x = L_x$.\n\nYour task is to write a program that:\n\n- Uses physically plausible constants: density $\\rho = 1000\\,\\mathrm{kg/m^3}$, heat capacity $c_p = 4180\\,\\mathrm{J/(kg\\cdot K)}$, conductivity $k = 0.6\\,\\mathrm{W/(m\\cdot K)}$, latent heat $L = 3.34\\times 10^5\\,\\mathrm{J/kg}$, melting temperature $T_m = 0\\,^{\\circ}\\mathrm{C}$, boundary temperature $T_b = 10\\,^{\\circ}\\mathrm{C}$.\n- Domain length $L_x = 0.05\\,\\mathrm{m}$ and final time $t_{\\mathrm{end}} = 60\\,\\mathrm{s}$.\n- Computes the reference interface position $s_{\\mathrm{ref}}(t_{\\mathrm{end}})$ from the Stefan similarity solution by numerically solving for $\\lambda$ in the given transcendental equation and then evaluating $s(t)$.\n- Solves the penalized enthalpy-porosity temperature equation on a uniform grid in space using an explicit finite-difference scheme in time, with spatial second derivatives approximated by second-order central differences, subject to the above initial and boundary conditions. Use a time step that respects explicit stability constraints derived from the thermal diffusion term and the penalty relaxation term. Estimate the interface location $s_{\\mathrm{num}}(t_{\\mathrm{end}})$ as the first position where the temperature falls below $T_m$, using linear interpolation between grid points to locate the crossing of $T = T_m$.\n- Reports the absolute error in the interface location, $|s_{\\mathrm{num}}(t_{\\mathrm{end}}) - s_{\\mathrm{ref}}(t_{\\mathrm{end}})|$, in meters.\n\nImplement and test the program on the following test suite of parameter triples $(N_x, \\Delta T, \\beta)$, where $N_x$ is the number of spatial grid points, $\\Delta T$ is the smoothing width in Kelvin, and $\\beta$ is the penalty coefficient in inverse seconds:\n- Case 1 (happy path, no penalty): $(N_x,\\Delta T,\\beta) = (400, 1.0, 0.0)$.\n- Case 2 (moderate penalty): $(N_x,\\Delta T,\\beta) = (400, 1.0, 10.0)$.\n- Case 3 (narrow mushy zone, stronger penalty): $(N_x,\\Delta T,\\beta) = (400, 0.2, 20.0)$.\n- Case 4 (coarser grid): $(N_x,\\Delta T,\\beta) = (200, 1.0, 10.0)$.\n- Case 5 (wider mushy zone): $(N_x,\\Delta T,\\beta) = (400, 2.0, 10.0)$.\n\nScientific and numerical requirements:\n- Base your derivations on conservation of energy, the definition of enthalpy, the relation $\\alpha = k/(\\rho c_p)$, and the Stefan jump condition. Do not use any shortcut formulas other than those derived from these principles.\n- Discretization must use central differences for the Laplacian and explicit time stepping. Ensure stability by choosing a time step $\\Delta t$ satisfying $\\Delta t \\le C \\, \\Delta x^2/\\alpha_{\\max}$ with a Courant-like constant $C$ strictly less than $1$, where $\\alpha_{\\max} = k/(\\rho c_{\\min})$ with $c_{\\min} = c_p$, and also $\\Delta t \\le \\theta/\\beta$ for some $\\theta \\in (0,1)$ when $\\beta > 0$.\n- Determine $s_{\\mathrm{num}}(t_{\\mathrm{end}})$ by detecting the first crossing of $T = T_m$ from above to below moving away from $x=0$, and use linear interpolation between the two adjacent grid points to estimate the crossing location.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets in the order of the test suite, for example, $\"[r_1,r_2,r_3,r_4,r_5]\"$, where each $r_i$ is the absolute error $|s_{\\mathrm{num}} - s_{\\mathrm{ref}}|$ in meters expressed as a floating-point number in $\\mathrm{m}$.", "solution": "The problem presented requires the analysis of a one-dimensional melting process in a semi-infinite medium, a classic case of a Stefan problem. We are asked to determine the location of the melting front at a specified time using two distinct methodologies: a classical analytical similarity solution and a numerical finite-difference scheme based on the enthalpy-porosity method. The objective is to quantify the discrepancy between the numerical approximation and the exact analytical result for a given set of physical parameters and numerical discretization choices.\n\n**1. Physical System and Governing Parameters**\n\nThe system is governed by the one-dimensional heat equation with a phase change. The material properties are provided as:\n- Density: $\\rho = 1000\\,\\mathrm{kg/m^3}$\n- Specific heat capacity (constant for both phases): $c_p = 4180\\,\\mathrm{J/(kg\\cdot K)}$\n- Thermal conductivity (constant for both phases): $k = 0.6\\,\\mathrm{W/(m\\cdot K)}$\n- Latent heat of fusion: $L = 3.34\\times 10^5\\,\\mathrm{J/kg}$\n\nThe thermal conditions are:\n- Melting temperature: $T_m = 0\\,^{\\circ}\\mathrm{C}$\n- Initial temperature of the solid: $T(x,0) = T_m = 0\\,^{\\circ}\\mathrm{C}$\n- Boundary temperature at $x=0$: $T(0,t) = T_b = 10\\,^{\\circ}\\mathrm{C}$ for $t > 0$\n- Final time of interest: $t_{\\mathrm{end}} = 60\\,\\mathrm{s}$\n\nFrom these, we can derive two important parameters. First, the thermal diffusivity, $\\alpha$, which characterizes the rate of heat transport:\n$$\n\\alpha = \\frac{k}{\\rho c_p} = \\frac{0.6\\,\\mathrm{W/(m\\cdot K)}}{(1000\\,\\mathrm{kg/m^3}) (4180\\,\\mathrm{J/(kg\\cdot K)})} \\approx 1.4354 \\times 10^{-7}\\,\\mathrm{m^2/s}\n$$\nSecond, the Stefan number, $\\mathrm{Ste}$, which is a dimensionless parameter representing the ratio of sensible heat to latent heat:\n$$\n\\mathrm{Ste} = \\frac{c_p(T_b - T_m)}{L} = \\frac{(4180\\,\\mathrm{J/(kg\\cdot K)})(10\\,\\mathrm{K} - 0\\,\\mathrm{K})}{3.34\\times 10^5\\,\\mathrm{J/kg}} \\approx 0.12515\n$$\n\n**2. Reference Solution: The Classical Stefan Problem**\n\nFor the prescribed initial and boundary conditions in a semi-infinite domain, the problem admits a similarity solution. The temperature field depends only on the similarity variable $\\eta = x/(2\\sqrt{\\alpha t})$. The position of the moving melting front, $s(t)$, is given by:\n$$\ns(t) = 2 \\lambda \\sqrt{\\alpha t}\n$$\nwhere $\\lambda$ is a dimensionless constant. Conservation of energy at the moving interface (the Stefan condition) leads to the following transcendental equation for $\\lambda$:\n$$\n\\sqrt{\\pi}\\, \\lambda \\, e^{\\lambda^2} \\, \\mathrm{erf}(\\lambda) = \\mathrm{Ste}\n$$\nHere, $\\mathrm{erf}(\\cdot)$ is the error function. To find the reference interface position $s_{\\mathrm{ref}}(t_{\\mathrm{end}})$, we must first numerically solve this equation for $\\lambda$. Let $f(\\lambda) = \\sqrt{\\pi}\\, \\lambda \\, e^{\\lambda^2} \\, \\mathrm{erf}(\\lambda) - \\mathrm{Ste}$. We seek the root of $f(\\lambda)=0$. For $\\mathrm{Ste} \\approx 0.12515$, a numerical root-finding algorithm (such as the secant or Newton's method) yields:\n$$\n\\lambda \\approx 0.24503\n$$\nUsing this value, we can calculate the exact interface position at $t_{\\mathrm{end}} = 60\\,\\mathrm{s}$:\n$$\ns_{\\mathrm{ref}}(t_{\\mathrm{end}}) = 2 \\lambda \\sqrt{\\alpha t_{\\mathrm{end}}} \\approx 2 \\times 0.24503 \\times \\sqrt{(1.4354 \\times 10^{-7}\\,\\mathrm{m^2/s}) \\times (60\\,\\mathrm{s})} \\approx 0.0014382\\,\\mathrm{m}\n$$\nThis value serves as the benchmark against which the numerical results will be compared. The small value of $s_{\\mathrm{ref}}$ relative to the numerical domain length $L_x = 0.05\\,\\mathrm{m}$ validates the use of a finite domain to approximate the semi-infinite medium.\n\n**3. Numerical Solution: Penalized Enthalpy-Porosity Method**\n\nThe second approach is a numerical solution of a modified heat equation on a finite domain $[0, L_x]$. The phase change is handled using an apparent heat capacity method, augmented with a penalty term. The governing partial differential equation is:\n$$\n\\frac{\\partial T}{\\partial t} = \\frac{k}{\\rho \\, c_{\\mathrm{app}}(T)} \\frac{\\partial^2 T}{\\partial x^2} - \\beta \\, (T - T_m) \\, \\chi_{\\mathrm{m}}(T)\n$$\nThe apparent heat capacity, $c_{\\mathrm{app}}(T)$, models the absorption of latent heat over a small temperature interval $\\Delta T$ around $T_m$:\n$$\nc_{\\mathrm{app}}(T) = c_p + \\frac{L}{\\Delta T} \\, \\chi_{\\mathrm{m}}(T)\n$$\nwhere the mushy zone indicator function $\\chi_{\\mathrm{m}}(T)$ is defined as:\n$$\n\\chi_{\\mathrm{m}}(T) = \\begin{cases} 1 & \\text{if } |T - T_m| < \\Delta T/2 \\\\ 0 & \\text{otherwise} \\end{cases}\n$$\nThe penalty term, $-\\beta (T - T_m) \\chi_{\\mathrm{m}}(T)$, acts as a relaxation source within the mushy zone, forcing the temperature towards $T_m$ and thus enforcing the isothermal phase change condition more strictly as the penalty parameter $\\beta$ increases.\n\nThis equation is discretized on a uniform spatial grid with $N_x$ points, where the grid spacing is $\\Delta x = L_x / (N_x - 1)$. We use a second-order central difference for the spatial derivative and an explicit forward Euler method for time integration. The temperature at grid point $i$ and time step $n+1$, denoted $T_i^{n+1}$, is updated from the values at time step $n$ as follows:\n$$\nT_i^{n+1} = T_i^n + \\Delta t \\left[ \\frac{k}{\\rho c_{\\mathrm{app}}(T_i^n)} \\left( \\frac{T_{i+1}^n - 2T_i^n + T_{i-1}^n}{\\Delta x^2} \\right) - \\beta (T_i^n - T_m) \\chi_{\\mathrm{m}}(T_i^n) \\right]\n$$\nfor interior points $i=1, 2, \\dots, N_x-2$.\n\nThe boundary conditions are:\n- At $x=0$: A Dirichlet condition, $T_0^{n+1} = T_b$.\n- At $x=L_x$: A zero-flux Neumann condition, $\\frac{\\partial T}{\\partial x}|_{x=L_x}=0$. This is implemented using a second-order accurate \"ghost point\" method. The update for the rightmost grid point $i=N_x-1$ uses a value $T_{N_x}^n$ from a fictitious point outside the domain. The central difference approximation of the zero-flux condition implies $T_{N_x}^n = T_{N_x-2}^n$, leading to the specialized update rule at $i=N_x-1$:\n$$\nT_{N_x-1}^{n+1} = T_{N_x-1}^n + \\Delta t \\left[ \\frac{k}{\\rho c_{\\mathrm{app}}(T_{N_x-1}^n)} \\left( \\frac{2T_{N_x-2}^n - 2T_{N_x-1}^n}{\\Delta x^2} \\right) - \\beta (T_{N_x-1}^n - T_m) \\chi_{\\mathrm{m}}(T_{N_x-1}^n) \\right]\n$$\n\nThe explicit scheme is conditionally stable. The time step $\\Delta t$ must satisfy two constraints: one from the diffusion term and one from the penalty (reaction) term.\n1. Diffusion stability: $\\Delta t \\le C \\frac{\\Delta x^2}{D_{\\max}}$, where $D(T) = k/(\\rho c_{\\mathrm{app}}(T))$. The maximum diffusivity $D_{\\max}$ occurs where $c_{\\mathrm{app}}(T)$ is minimal, i.e., $c_{\\mathrm{app}}=c_p$. Thus, $D_{\\max} = \\alpha$ and we require $\\Delta t < \\frac{\\Delta x^2}{2\\alpha}$. We select a conservative factor $C=0.4 < 0.5$.\n2. Penalty stability: For the relaxation term, stability of the explicit Euler method requires $\\Delta t \\le 2/\\beta$. We use the more conservative criterion supplied, $\\Delta t \\le \\theta/\\beta$ with $\\theta = 0.9$.\n\nThe final time step is chosen as $\\Delta t = \\min(\\Delta t_{\\mathrm{diff}}, \\Delta t_{\\mathrm{penalty}})$.\n\nAfter running the simulation until $t = t_{\\mathrm{end}}$, the numerical interface position, $s_{\\mathrm{num}}$, is found by locating the first grid cell $(x_{i-1}, x_{i})$ where the temperature drops below $T_m$, i.e., $T_{i-1} \\ge T_m$ and $T_i < T_m$. Linear interpolation is then used to find the precise location:\n$$\ns_{\\mathrm{num}}(t_{\\mathrm{end}}) = x_{i-1} + \\Delta x \\frac{T_{i-1} - T_m}{T_{i-1} - T_i}\n$$\nThe program will execute this procedure for each specified test case $(N_x, \\Delta T, \\beta)$ and report the absolute error $|s_{\\mathrm{num}}(t_{\\mathrm{end}}) - s_{\\mathrm{ref}}(t_{\\mathrm{end}})|$.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import erf\nfrom scipy.optimize import root_scalar\n\ndef solve():\n    \"\"\"\n    Solves the 1D melting problem using analytical and numerical methods\n    and reports the error for several test cases.\n    \"\"\"\n\n    # --- Physical and Domain Constants ---\n    rho = 1000.0  # Density (kg/m^3)\n    cp = 4180.0   # Specific heat capacity (J/kg.K)\n    k = 0.6       # Thermal conductivity (W/m.K)\n    L = 3.34e5    # Latent heat of fusion (J/kg)\n    T_m = 0.0     # Melting temperature (deg C)\n    T_b = 10.0    # Boundary temperature (deg C)\n    L_x = 0.05    # Domain length (m)\n    t_end = 60.0  # Final time (s)\n\n    # --- Derived constants ---\n    alpha = k / (rho * cp)  # Thermal diffusivity (m^2/s)\n    Ste = cp * (T_b - T_m) / L  # Stefan number (-)\n\n    def compute_s_ref():\n        \"\"\"\n        Calculates the reference interface position using the analytical\n        Stefan similarity solution.\n        \"\"\"\n        # Transcendental equation: f(lambda) = 0\n        def f(lam):\n            return np.sqrt(np.pi) * lam * np.exp(lam**2) * erf(lam) - Ste\n\n        # Solve for lambda using a root-finding algorithm\n        # Bracket [0.01, 1.0] is safe as lambda > 0 for Ste > 0\n        sol = root_scalar(f, bracket=[0.01, 1.0], method='brentq')\n        lam = sol.root\n\n        # Calculate interface position\n        s_ref = 2 * lam * np.sqrt(alpha * t_end)\n        return s_ref\n\n    def compute_s_num(Nx, dT_mushy, beta):\n        \"\"\"\n        Solves the penalized enthalpy-porosity PDE numerically.\n        \"\"\"\n        # --- Discretization ---\n        dx = L_x / (Nx - 1)\n        x = np.linspace(0, L_x, Nx)\n\n        # --- Stability and Time Stepping ---\n        # Diffusion stability constraint\n        dt_diff = 0.4 * dx**2 / alpha  # Using a safety factor C = 0.4 < 0.5\n\n        # Penalty term stability constraint\n        if beta > 0:\n            dt_penalty = 0.9 / beta # Using safety factor theta = 0.9 < 1.0\n            dt = min(dt_diff, dt_penalty)\n        else:\n            dt = dt_diff\n\n        num_steps = int(np.ceil(t_end / dt))\n        dt = t_end / num_steps # Adjust dt to hit t_end exactly\n\n        # --- Initialization ---\n        T = np.full(Nx, T_m, dtype=np.float64)\n\n        # --- Time Marching Loop ---\n        for _ in range(num_steps):\n            # Store previous time step's temperature\n            T_n = T.copy()\n\n            # Apply Dirichlet BC at x=0\n            T[0] = T_b\n\n            # --- Calculate temperature-dependent properties ---\n            # Mushy zone indicator chi_m(T)\n            mushy_mask = np.abs(T_n - T_m) < (dT_mushy / 2.0)\n            \n            # Apparent heat capacity c_app(T)\n            c_app = np.full(Nx, cp, dtype=np.float64)\n            if dT_mushy > 0:\n                c_app[mushy_mask] += L / dT_mushy\n\n            # --- Update interior points ---\n            # i = 1 to Nx-2\n            laplacian = (T_n[2:] - 2 * T_n[1:-1] + T_n[:-2]) / dx**2\n            diffusion_term = (k / (rho * c_app[1:-1])) * laplacian\n            \n            penalty_term = np.zeros(Nx - 2)\n            if beta > 0:\n                penalty_term[mushy_mask[1:-1]] = beta * (T_n[1:-1][mushy_mask[1:-1]] - T_m)\n\n            T[1:-1] = T_n[1:-1] + dt * (diffusion_term - penalty_term)\n\n            # --- Apply Neumann BC at x=L_x ---\n            # i = Nx-1\n            laplacian_end = (2 * T_n[Nx-2] - 2 * T_n[Nx-1]) / dx**2\n            diffusion_end = (k / (rho * c_app[Nx-1])) * laplacian_end\n\n            penalty_end = 0.0\n            if beta > 0 and mushy_mask[Nx-1]:\n                penalty_end = beta * (T_n[Nx-1] - T_m)\n\n            T[Nx-1] = T_n[Nx-1] + dt * (diffusion_end - penalty_end)\n\n        # --- Find Interface Position ---\n        # Find the first index 'i' where T drops below Tm\n        try:\n            idx = np.where(T < T_m)[0][0]\n            if idx == 0: # Should not happen with Tb > Tm\n                return 0.0\n            \n            # Linear interpolation between grid points T[idx-1] and T[idx]\n            T_prev = T[idx-1]\n            T_curr = T[idx]\n            x_prev = x[idx-1]\n\n            s_num = x_prev + dx * (T_prev - T_m) / (T_prev - T_curr)\n            return s_num\n        except IndexError:\n            # Interface did not enter the domain or passed the whole domain\n            # Passed domain is unlikely here, so assume it is at or beyond Lx\n            return L_x\n\n    # --- Main Execution ---\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (400, 1.0, 0.0),    # Case 1\n        (400, 1.0, 10.0),   # Case 2\n        (400, 0.2, 20.0),   # Case 3\n        (200, 1.0, 10.0),   # Case 4\n        (400, 2.0, 10.0),   # Case 5\n    ]\n\n    # Calculate the reference solution once\n    s_ref = compute_s_ref()\n\n    results = []\n    for case in test_cases:\n        Nx, dT_mushy, beta = case\n        s_num = compute_s_num(Nx, dT_mushy, beta)\n        error = np.abs(s_num - s_ref)\n        results.append(error)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.8f}' for r in results)}]\")\n\nsolve()\n```", "id": "3521150"}, {"introduction": "The true power of the enthalpy-porosity method is realized when simulating phase change coupled with fluid flow, such as natural convection in a melt pool. The 'porosity' aspect of the method involves adding a momentum sink term that effectively immobilizes the fluid in the solid region, based on the local liquid fraction. This exercise delves into a critical numerical aspect of this coupling: the stiffness introduced by the momentum penalization term as a region approaches the solid state, and its profound impact on the maximum stable time step for an explicit simulation. [@problem_id:3521166]", "problem": "Consider a one-dimensional, isothermal step of a coupled phase-change and flow problem in the enthalpy–porosity (EP) framework and Darcy–Brinkman (DB) momentum description. The EP method models phase change by embedding latent heat in an enthalpy variable and enforcing a liquid fraction that varies with temperature, while the DB formulation extends viscous shear into porous regions and adds a drag term that suppresses flow in the solid and mushy regimes. You must derive a consistent coupling and then design and implement a numerical stability test for the explicit Euler time integration when the penalization term becomes stiff.\n\nThe physical setting is a stationary temperature field and an explicit Euler update of the velocity field, in one spatial dimension. The domain is of length $L = 0.01\\,\\mathrm{m}$, discretized into $N$ interior nodes with uniform spacing $h = L/(N+1)$ and homogeneous Dirichlet boundaries $u(0,t) = u(L,t) = 0$. The liquid fraction is a function of temperature $f_l(T)$ satisfying $f_l(T) = 0$ below the solidus temperature $T_s$, $f_l(T) = 1$ above the liquidus temperature $T_l$, and $0 < f_l(T) < 1$ in the mushy interval $T_s < T < T_l$ with a smooth monotone transition. Use the following physically consistent, piecewise-linear porosity function with regularization to avoid singularity in the drag:\n$$\nf_l(T) = \n\\begin{cases}\n0, & T \\le T_s, \\\\\n\\frac{T - T_s}{T_l - T_s}, & T_s < T < T_l, \\\\\n1, & T \\ge T_l,\n\\end{cases}\n\\quad \\text{and} \\quad \\tilde f_l(T) = \\max(f_l(T), \\varepsilon),\n$$\nwith $T_s = 273.15\\,\\mathrm{K}$, $T_l = 273.65\\,\\mathrm{K}$, and $\\varepsilon = 10^{-3}$.\n\nThe DB momentum balance for a Newtonian fluid with density $\\rho$ and dynamic viscosity $\\mu$ is modeled as\n$$\n\\rho \\frac{\\partial \\mathbf{u}}{\\partial t} = -\\nabla p + \\mu \\nabla^2 \\mathbf{u} - \\alpha(T)\\,\\mathbf{u},\n$$\nwhere $\\mathbf{u}$ is the velocity and $\\alpha(T)$ is an EP drag coefficient arising from phase change modeling. In the EP approach with penalization, the drag coefficient is posed as\n$$\n\\alpha(T) = A \\frac{(1 - \\tilde f_l(T))^2}{\\tilde f_l(T)^3},\n$$\nwhere $A$ is a large amplitude controlling flow suppression in the solid/mushy region. For one-dimensional velocity $u(x,t)$ with a frozen temperature field, the semi-discrete explicit Euler update can be written in the form\n$$\n\\frac{d\\mathbf{u}}{dt} = -\\mathbf{M}\\,\\mathbf{u},\n$$\nwhere $\\mathbf{M}$ is a positive-definite matrix depending on $\\mu$, $\\rho$, the discrete Laplacian, and the temperature-dependent drag.\n\nYour tasks are:\n\n1. From conservation of energy and momentum, and the definition of enthalpy with latent heat, derive the consistent coupling between the EP liquid fraction $f_l(T)$ and the DB momentum equation. Formalize how the EP drag coefficient $\\alpha(T)$ enters the DB momentum balance and specify the semi-discrete operator $\\mathbf{M}$ under homogeneous Dirichlet boundary conditions, uniform grid spacing, and a frozen temperature field. Your derivation must start from the laws of conservation of energy and momentum, define enthalpy including latent heat, and show how the liquid fraction induces the penalization $-\\alpha(T)\\mathbf{u}$ in the momentum equation. You must also state the assumptions under which the semi-discrete operator $\\mathbf{M}$ is symmetric positive definite.\n\n2. For the linear ordinary differential equation $d\\mathbf{u}/dt = -\\mathbf{M}\\mathbf{u}$ advanced by explicit Euler, derive a linear stability condition in terms of the eigenvalues of $\\mathbf{M}$, and obtain a formula for a maximum stable time step $\\,\\Delta t_{\\max}\\,$ that prevents growth in the discrete $L^2$ energy. Explain any regularization needed when $\\tilde f_l(T)$ is close to zero.\n\n3. Implement a program that, given $N$, $L$, $\\mu$, $\\rho$, $A$, and a specified temperature field $T(x)$ sampled at the interior nodes, constructs the semi-discrete operator $\\mathbf{M}$ and computes $\\,\\Delta t_{\\max}\\,$ from your stability criterion. Use $N = 20$, $L = 0.01\\,\\mathrm{m}$, $\\mu = 10^{-3}\\,\\mathrm{Pa}\\cdot\\mathrm{s}$, and $\\rho = 1000\\,\\mathrm{kg}/\\mathrm{m}^3$ for all tests. Discretize the one-dimensional Laplacian with second-order central differences under homogeneous Dirichlet boundary conditions.\n\n4. Test numerical stability under stiffness by evaluating $\\,\\Delta t_{\\max}\\,$ for the following four cases, each with temperature provided at interior nodes and a specified $A$:\n   - Case $1$ (fully liquid, happy path): $A = 10^{6}$, $T_i = T_l + 1.0\\,\\mathrm{K}$ for all interior nodes $i$.\n   - Case $2$ (uniform mushy): $A = 10^{6}$, $T_i = (T_s + T_l)/2$ for all interior nodes $i$.\n   - Case $3$ (near-solid, highly stiff): $A = 10^{8}$, $T_i = T_s + 0.05\\,(T_l - T_s)$ for all interior nodes $i$.\n   - Case $4$ (heterogeneous, mixed stiffness): $A = 10^{7}$, $T_i = T_s + 0.10\\,(T_l - T_s)$ for interior nodes $i \\le N/2$, and $T_i = T_l + 0.20\\,\\mathrm{K}$ for interior nodes $i > N/2$.\n\nAll quantities that represent time must be expressed in seconds. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $\\,[\\Delta t_{\\max,1},\\Delta t_{\\max,2},\\Delta t_{\\max,3},\\Delta t_{\\max,4}]\\,$), where each entry is a floating-point number representing $\\,\\Delta t_{\\max}\\,$ in seconds for the corresponding case. The output must be in the exact required format and order shown above.\n\nProvide no intermediate hints in the problem statement beyond what is written. The derivation and algorithmic steps must be grounded in fundamental conservation laws and definitions and must be scientifically consistent with phase change modeling and porous flow mechanics.", "solution": "We start from fundamental principles. Conservation of energy for a phase-changing material relates the change in enthalpy to heat fluxes and sources. In the enthalpy–porosity (EP) method, the specific enthalpy $h(T)$ is decomposed into sensible and latent parts:\n$$\nh(T) = \\int_{T_0}^{T} c_p(\\theta)\\,d\\theta + L\\,f_l(T),\n$$\nwhere $c_p(T)$ is the specific heat capacity, $L$ is the latent heat of fusion, and $f_l(T)$ is the liquid fraction. The balance of energy in the absence of advection and internal sources is\n$$\n\\rho \\frac{\\partial h}{\\partial t} = \\nabla \\cdot \\left(k \\nabla T\\right),\n$$\nwith thermal conductivity $k$. In the EP method, the phase change is incorporated by allowing $f_l(T)$ to vary smoothly from $0$ to $1$ across the mushy interval $[T_s, T_l]$, yielding consistency with energy conservation through latent heat release or absorption.\n\nConservation of momentum for a Newtonian fluid in a porous medium is given by the Darcy–Brinkman (DB) equation, which extends Stokes flow with a Darcy drag term. For velocity $\\mathbf{u}$ and pressure $p$, with density $\\rho$ and dynamic viscosity $\\mu$,\n$$\n\\rho \\frac{\\partial \\mathbf{u}}{\\partial t} + \\rho (\\mathbf{u}\\cdot\\nabla)\\mathbf{u} = -\\nabla p + \\mu \\nabla^2 \\mathbf{u} - \\alpha\\,\\mathbf{u}.\n$$\nNeglecting convection for the present linear stability analysis (small Reynolds number or explicit examination of linearized stability), we write\n$$\n\\rho \\frac{\\partial \\mathbf{u}}{\\partial t} = -\\nabla p + \\mu \\nabla^2 \\mathbf{u} - \\alpha(T)\\,\\mathbf{u}.\n$$\nThe EP coupling supplies a drag coefficient that suppresses flow where liquid fraction is small and vanishes in the liquid:\n$$\n\\alpha(T) = A \\frac{(1 - \\tilde f_l(T))^2}{\\tilde f_l(T)^3}, \\quad \\tilde f_l(T) = \\max(f_l(T), \\varepsilon),\n$$\nwith $A$ a large amplitude and $\\varepsilon$ a small regularization preventing singularity as $f_l \\to 0$. The regularization is essential because $f_l^{-3}$ diverges as $f_l \\to 0$, reflecting the physical notion that velocity should vanish in the solid; numerically, we avoid division by zero while still attaining large penalization.\n\nWe focus on a one-dimensional velocity $u(x,t)$ with homogeneous Dirichlet boundary conditions $u(0,t) = u(L,t) = 0$. Discretize the spatial domain into $N$ interior nodes with spacing $h = L/(N+1)$. The second-order central-difference Laplacian under homogeneous Dirichlet boundaries yields the discrete positive operator $\\mathbf{L}$:\n$$\n\\mathbf{L} = \\frac{1}{h^2}\\begin{bmatrix}\n2 & -1 & 0 & \\cdots & 0 \\\\\n-1 & 2 & -1 & \\ddots & \\vdots \\\\\n0 & -1 & 2 & \\ddots & 0 \\\\\n\\vdots & \\ddots & \\ddots & \\ddots & -1 \\\\\n0 & \\cdots & 0 & -1 & 2\n\\end{bmatrix},\n$$\nwhich corresponds to $-\\partial_{xx}$ and is symmetric positive definite. Let $\\boldsymbol{\\alpha}$ be the vector of nodal drag coefficients $\\alpha_i = \\alpha(T_i)$ and $\\mathbf{D} = \\mathrm{diag}(\\alpha_i/\\rho)$ the diagonal drag operator divided by density. With frozen temperature, the semi-discrete momentum equation (division by $\\rho$) is\n$$\n\\frac{d\\mathbf{u}}{dt} = \\frac{\\mu}{\\rho} \\nabla^2 \\mathbf{u} - \\frac{\\boldsymbol{\\alpha}}{\\rho} \\odot \\mathbf{u},\n$$\nwhich in operator form using $\\mathbf{L}$ becomes\n$$\n\\frac{d\\mathbf{u}}{dt} = -\\left( \\frac{\\mu}{\\rho}\\,\\mathbf{L} + \\mathbf{D} \\right)\\mathbf{u} = -\\mathbf{M}\\,\\mathbf{u}.\n$$\nHere,\n$$\n\\mathbf{M} = \\frac{\\mu}{\\rho}\\,\\mathbf{L} + \\mathbf{D},\n$$\nwith $\\mathbf{L}$ symmetric positive definite and $\\mathbf{D}$ symmetric positive semidefinite (strictly positive definite wherever $\\alpha_i > 0$). Therefore, under homogeneous Dirichlet boundaries and nonnegative drag, $\\mathbf{M}$ is symmetric positive definite except in the special case $\\alpha_i = 0$ for all $i$, in which case $\\mathbf{M}$ remains symmetric positive definite due to the Laplacian; if both $\\mathbf{D}$ is zero and homogeneous Dirichlet Laplacian is used, $\\mathbf{L}$ maintains positive definiteness and $\\mathbf{M}$ is positive definite. Symmetry and positive definiteness ensure real, positive eigenvalues.\n\nWe now establish the explicit Euler stability criterion. Consider the linear ordinary differential equation\n$$\n\\frac{d\\mathbf{u}}{dt} = -\\mathbf{M}\\,\\mathbf{u}.\n$$\nThe explicit Euler update is\n$$\n\\mathbf{u}^{n+1} = \\mathbf{u}^n - \\Delta t\\,\\mathbf{M}\\,\\mathbf{u}^n = \\left(\\mathbf{I} - \\Delta t\\,\\mathbf{M}\\right)\\mathbf{u}^n.\n$$\nLet $\\lambda_j$ denote the eigenvalues of $\\mathbf{M}$, which are real and positive. In the eigenbasis, each mode amplifies by $g_j = 1 - \\Delta t\\,\\lambda_j$. For non-increasing discrete $L^2$ energy, we require $|g_j| \\le 1$ for all $j$, which implies $0 \\le \\Delta t\\,\\lambda_j \\le 2$. Thus,\n$$\n\\Delta t \\le \\frac{2}{\\max_j \\lambda_j} = \\frac{2}{\\rho_{\\mathrm{spec}}(\\mathbf{M})},\n$$\nwhere $\\rho_{\\mathrm{spec}}(\\mathbf{M})$ is the spectral radius (largest eigenvalue) of $\\mathbf{M}$. This yields the maximum stable time step\n$$\n\\Delta t_{\\max} = \\frac{2}{\\lambda_{\\max}(\\mathbf{M})}.\n$$\nWhen $\\tilde f_l(T)$ is close to zero, the EP drag coefficient $\\alpha(T)$ becomes extremely large, increasing $\\lambda_{\\max}(\\mathbf{M})$ and thus making $\\Delta t_{\\max}$ extremely small. The regularization $\\tilde f_l(T) = \\max(f_l(T), \\varepsilon)$ with small $\\varepsilon$ maintains finite, albeit very large, drag and preserves the qualitative stiffness while preventing division by zero.\n\nAlgorithmic design to compute $\\Delta t_{\\max}$ proceeds as follows:\n- Construct the discrete Laplacian $\\mathbf{L}$ with second-order central differences and homogeneous Dirichlet boundary conditions, yielding a symmetric tridiagonal matrix with diagonal entries $2/h^2$ and off-diagonals $-1/h^2$.\n- Map the temperature field at interior nodes to $\\tilde f_l(T_i)$ using the piecewise-linear function with regularization.\n- Compute the drag $\\alpha_i = A\\,\\frac{(1 - \\tilde f_l(T_i))^2}{\\tilde f_l(T_i)^3}$, and form $\\mathbf{D} = \\mathrm{diag}(\\alpha_i/\\rho)$.\n- Assemble $\\mathbf{M} = (\\mu/\\rho)\\,\\mathbf{L} + \\mathbf{D}$.\n- Compute the largest eigenvalue $\\lambda_{\\max}$ of $\\mathbf{M}$ using a symmetric eigensolver.\n- Return $\\Delta t_{\\max} = 2/\\lambda_{\\max}$.\n\nWe now apply this to the specified tests with $N = 20$, $L = 0.01\\,\\mathrm{m}$, $\\mu = 10^{-3}\\,\\mathrm{Pa}\\cdot\\mathrm{s}$, and $\\rho = 1000\\,\\mathrm{kg}/\\mathrm{m}^3$. The four cases are:\n- Case $1$: Fully liquid $f_l = 1$ at all nodes, $A = 10^{6}$; $\\alpha = 0$ and $\\mathbf{M} = (\\mu/\\rho)\\,\\mathbf{L}$; the time step is limited by viscous diffusion.\n- Case $2$: Uniform mushy $f_l = 0.5$ at all nodes, $A = 10^{6}$; $\\alpha = A\\,(1-0.5)^2/0.5^3 = A \\cdot 0.25 / 0.125 = 2A$; the drag dominates and reduces $\\Delta t_{\\max}$ substantially.\n- Case $3$: Near-solid $f_l = 0.05$ at all nodes, $A = 10^{8}$; $\\alpha$ is extremely large, making $\\Delta t_{\\max}$ extremely small (stiff regime).\n- Case $4$: Heterogeneous $f_l$ with left half $f_l = 0.1$ and right half $f_l = 1$, $A = 10^{7}$; the operator $\\mathbf{M}$ has spatially varying diagonal contributions, and stability is dictated by the largest eigenvalue of the composite operator.\n\nThe implementation computes $\\Delta t_{\\max}$ in seconds for each case and outputs them in the required single-line list format. The scientific realism is preserved by using physically plausible values, consistent units, and well-established EP and DB formulations. The explicit Euler stability criterion is a standard, well-tested fact in numerical time integration of linear systems with dissipative operators.", "answer": "```python\n# Python 3.12, numpy 1.23.5\nimport numpy as np\n\ndef liquid_fraction(T, Ts, Tl, eps=1e-3):\n    \"\"\"\n    Piecewise-linear liquid fraction f_l(T) with regularization:\n    f_l = 0 for T <= Ts\n    f_l = (T - Ts)/(Tl - Ts) for Ts < T < Tl\n    f_l = 1 for T >= Tl\n    Returns max(f_l, eps) to avoid singularity in penalization.\n    \"\"\"\n    if T <= Ts:\n        f = 0.0\n    elif T >= Tl:\n        f = 1.0\n    else:\n        f = (T - Ts) / (Tl - Ts)\n    return max(f, eps)\n\ndef build_laplacian_dirichlet(N, h):\n    \"\"\"\n    Build 1D discrete positive Laplacian operator L = -d2/dx2\n    with homogeneous Dirichlet boundary conditions on N interior nodes.\n    \"\"\"\n    main = (2.0 / h**2) * np.ones(N)\n    off = (-1.0 / h**2) * np.ones(N - 1)\n    L = np.diag(main) + np.diag(off, 1) + np.diag(off, -1)\n    return L\n\ndef build_operator_M(N, Lx, mu, rho, A, T_nodes, Ts, Tl, eps=1e-3):\n    \"\"\"\n    Assemble the semi-discrete operator M = (mu/rho)*L + diag(alpha/rho)\n    where alpha = A * ((1 - f)^2)/(f^3) and f = liquid_fraction(T).\n    \"\"\"\n    h = Lx / (N + 1)\n    L = build_laplacian_dirichlet(N, h)\n    f = np.array([liquid_fraction(T, Ts, Tl, eps) for T in T_nodes])\n    alpha = A * ((1.0 - f)**2) / (f**3)\n    D = np.diag(alpha / rho)\n    M = (mu / rho) * L + D\n    return M\n\ndef dt_max_from_operator(M):\n    \"\"\"\n    For explicit Euler stability of du/dt = -M u, dt_max = 2 / lambda_max(M).\n    Uses eigvalsh since M is symmetric.\n    \"\"\"\n    eigs = np.linalg.eigvalsh(M)\n    lam_max = np.max(eigs)\n    # Guard against any numerical zero or negative eigenvalues (shouldn't occur for SPD),\n    # but ensure positive lam_max for meaningful dt.\n    if lam_max <= 0.0:\n        return float('inf')\n    return 2.0 / lam_max\n\ndef solve():\n    # Physical and numerical parameters\n    N = 20\n    Lx = 0.01  # meters\n    mu = 1.0e-3  # Pa*s\n    rho = 1000.0  # kg/m^3\n    Ts = 273.15  # K\n    Tl = 273.65  # K\n    eps = 1.0e-3\n\n    # Generate interior node positions (not strictly needed for this test since T is uniform/piecewise)\n    # x_i = i*h for i=1..N with h = Lx/(N+1)\n    h = Lx / (N + 1)\n    x_nodes = np.arange(1, N + 1) * h\n\n    test_cases = []\n\n    # Case 1: fully liquid\n    A1 = 1.0e6\n    T1 = (Tl + 1.0)  # K\n    T_nodes_1 = np.full(N, T1)\n    test_cases.append((A1, T_nodes_1))\n\n    # Case 2: uniform mushy (midpoint)\n    A2 = 1.0e6\n    T2 = 0.5 * (Ts + Tl)\n    T_nodes_2 = np.full(N, T2)\n    test_cases.append((A2, T_nodes_2))\n\n    # Case 3: near-solid, highly stiff\n    A3 = 1.0e8\n    T3 = Ts + 0.05 * (Tl - Ts)\n    T_nodes_3 = np.full(N, T3)\n    test_cases.append((A3, T_nodes_3))\n\n    # Case 4: heterogeneous, mixed stiffness\n    A4 = 1.0e7\n    T_left = Ts + 0.10 * (Tl - Ts)\n    T_right = Tl + 0.20\n    T_nodes_4 = np.empty(N)\n    half = N // 2\n    T_nodes_4[:half] = T_left\n    T_nodes_4[half:] = T_right\n    test_cases.append((A4, T_nodes_4))\n\n    results = []\n    for A, T_nodes in test_cases:\n        M = build_operator_M(N, Lx, mu, rho, A, T_nodes, Ts, Tl, eps)\n        dt_max = dt_max_from_operator(M)\n        results.append(dt_max)\n\n    # Final print: single line, comma-separated list enclosed in square brackets\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "3521166"}]}