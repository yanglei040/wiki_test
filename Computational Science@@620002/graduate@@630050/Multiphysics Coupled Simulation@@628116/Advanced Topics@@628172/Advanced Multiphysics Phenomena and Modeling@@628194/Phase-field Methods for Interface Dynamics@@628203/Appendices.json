{"hands_on_practices": [{"introduction": "To effectively use phase-field models, we must bridge the gap between their theoretical constructs and measurable physical reality. This first practice provides a foundational exercise in connecting the abstract parameters of a Ginzburg-Landau free energy functional to a key physical property: surface tension. By working through the analytical derivation for a simple one-dimensional interface, you will see how the gradient energy coefficient, $\\kappa$, and the bulk energy scale, $\\lambda$, collectively define the excess energy stored in an interface, providing a direct link between the model and thermodynamics.", "problem": "Consider a one-dimensional, planar equilibrium interface in a binary system modeled by a phase-field order parameter $\\,\\phi(x)\\,$ with $\\,\\phi(-\\infty)=-1\\,$ and $\\,\\phi(+\\infty)=+1\\,$. The Helmholtz free-energy functional per unit area is taken to be\n$$\n\\mathcal{F}[\\phi] \\;=\\; \\int_{-\\infty}^{+\\infty} \\left[ \\frac{\\kappa}{2}\\left(\\frac{d\\phi}{dx}\\right)^{2} \\;+\\; \\lambda\\,W(\\phi) \\right]\\,dx,\n$$\nwhere $\\,\\kappa>0\\,$ is the gradient-energy coefficient, $\\,\\lambda>0\\,$ is the bulk energy scale, and the double-well potential is\n$$\nW(\\phi) \\;=\\; \\frac{1}{4}\\left(\\phi^{2}-1\\right)^{2}.\n$$\nAssume the system is at mechanical equilibrium and that the interface is stationary and planar, such that the equilibrium profile $\\,\\phi(x)\\,$ minimizes $\\,\\mathcal{F}\\,$ subject to the boundary conditions. The surface tension $\\,\\sigma\\,$ is defined as the excess free energy per unit area associated with the interface, given by\n$$\n\\sigma \\;=\\; \\int_{-\\infty}^{+\\infty} \\left[ \\frac{\\kappa}{2}\\left(\\frac{d\\phi}{dx}\\right)^{2} \\;+\\; \\lambda\\,W(\\phi) \\right]\\,dx,\n$$\nwith the homogeneous bulk contributions subtracted implicitly because $\\,W(\\pm 1)=0\\,$.\n\nStarting from fundamental variational principles and conservation of energy in the one-dimensional stationary profile, derive the necessary relation(s) for the equilibrium profile $\\,\\phi(x)\\,$ and compute $\\,\\sigma\\,$ in closed form as an analytical expression in terms of $\\,\\kappa\\,$ and $\\,\\lambda\\,$. Then explain how this value compares to the corresponding sharp-interface surface tension obtained by taking the limit of vanishing interface thickness while retaining the same bulk thermodynamics.\n\nProvide your final answer for $\\,\\sigma\\,$ as a single, simplified analytical expression in terms of $\\,\\kappa\\,$ and $\\,\\lambda\\,$. No rounding is required. Do not include units in your final boxed answer.", "solution": "The problem asks for the derivation of the equilibrium profile equation for a one-dimensional phase-field model and the calculation of the corresponding surface tension $\\sigma$. The problem statement is validated as scientifically grounded, well-posed, and objective. It represents a canonical problem in the theory of diffuse interfaces.\n\nThe Helmholtz free-energy functional per unit area is given by\n$$\n\\mathcal{F}[\\phi] = \\int_{-\\infty}^{+\\infty} \\mathcal{L}(\\phi, \\phi') \\,dx = \\int_{-\\infty}^{+\\infty} \\left[ \\frac{\\kappa}{2}\\left(\\frac{d\\phi}{dx}\\right)^{2} + \\lambda\\,W(\\phi) \\right]\\,dx\n$$\nwhere $\\phi' = \\frac{d\\phi}{dx}$ and the double-well potential is $W(\\phi) = \\frac{1}{4}(\\phi^2-1)^2$. The parameters $\\kappa$ and $\\lambda$ are positive constants. The boundary conditions are $\\phi(x \\to -\\infty) = -1$ and $\\phi(x \\to +\\infty) = +1$.\n\nThe equilibrium profile $\\phi(x)$ is the function that minimizes this functional. According to the calculus of variations, the minimizer must satisfy the Euler-Lagrange equation:\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial \\phi} - \\frac{d}{dx}\\left(\\frac{\\partial \\mathcal{L}}{\\partial \\phi'}\\right) = 0\n$$\nFirst, we compute the required partial derivatives of the integrand $\\mathcal{L}(\\phi, \\phi') = \\frac{\\kappa}{2}(\\phi')^2 + \\lambda W(\\phi)$:\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial \\phi} = \\lambda \\frac{dW}{d\\phi} = \\lambda \\frac{d}{d\\phi}\\left[\\frac{1}{4}(\\phi^4 - 2\\phi^2 + 1)\\right] = \\lambda (\\phi^3 - \\phi)\n$$\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial \\phi'} = \\kappa \\phi' = \\kappa \\frac{d\\phi}{dx}\n$$\nSubstituting these into the Euler-Lagrange equation gives the governing ordinary differential equation for the equilibrium profile:\n$$\n\\lambda (\\phi^3 - \\phi) - \\frac{d}{dx}\\left(\\kappa \\frac{d\\phi}{dx}\\right) = 0\n$$\n$$\n\\kappa \\frac{d^2\\phi}{dx^2} = \\lambda (\\phi^3 - \\phi)\n$$\nThis is the necessary relation for the stationary, one-dimensional equilibrium profile $\\phi(x)$.\n\nTo compute the surface tension $\\sigma = \\mathcal{F}[\\phi_{\\text{eq}}]$, we can first find a first integral of the Euler-Lagrange equation. This is analogous to the conservation of energy in a classical mechanics problem. We multiply the equilibrium equation by $\\frac{d\\phi}{dx}$:\n$$\n\\kappa \\frac{d^2\\phi}{dx^2}\\frac{d\\phi}{dx} - \\lambda (\\phi^3 - \\phi)\\frac{d\\phi}{dx} = 0\n$$\nRecognizing that each term is a total derivative with respect to $x$:\n$$\n\\frac{d}{dx}\\left[\\frac{\\kappa}{2}\\left(\\frac{d\\phi}{dx}\\right)^2\\right] - \\frac{d}{dx}[\\lambda W(\\phi)] = 0\n$$\n$$\n\\frac{d}{dx}\\left[\\frac{\\kappa}{2}\\left(\\frac{d\\phi}{dx}\\right)^2 - \\lambda W(\\phi)\\right] = 0\n$$\nThis implies that the quantity in the brackets is a constant along the profile. We can evaluate this constant using the boundary conditions at $x \\to \\pm\\infty$. At infinity, the system is in a bulk phase, so the profile is flat, $\\frac{d\\phi}{dx} \\to 0$. Also, $\\phi \\to \\pm 1$, and by definition, $W(\\pm 1) = \\frac{1}{4}((\\pm 1)^2 - 1)^2 = 0$. Therefore, the constant is zero. This yields a critical relationship for the equilibrium profile:\n$$\n\\frac{\\kappa}{2}\\left(\\frac{d\\phi}{dx}\\right)^2 = \\lambda W(\\phi)\n$$\nThis relation signifies an equipartition between the gradient energy density and the bulk potential energy density at every point $x$ within the interface.\n\nNow we can calculate the surface tension $\\sigma$, which is the value of the functional $\\mathcal{F}$ for the equilibrium profile:\n$$\n\\sigma = \\int_{-\\infty}^{+\\infty} \\left[ \\frac{\\kappa}{2}\\left(\\frac{d\\phi}{dx}\\right)^{2} + \\lambda W(\\phi) \\right]\\,dx\n$$\nUsing the equipartition relation $\\lambda W(\\phi) = \\frac{\\kappa}{2}(\\frac{d\\phi}{dx})^2$, we can simplify the integrand:\n$$\n\\sigma = \\int_{-\\infty}^{+\\infty} \\left[ \\frac{\\kappa}{2}\\left(\\frac{d\\phi}{dx}\\right)^{2} + \\frac{\\kappa}{2}\\left(\\frac{d\\phi}{dx}\\right)^{2} \\right]\\,dx = \\int_{-\\infty}^{+\\infty} \\kappa \\left(\\frac{d\\phi}{dx}\\right)^2 dx\n$$\nAn elegant way to evaluate this integral without explicitly solving for $\\phi(x)$ is to change the integration variable from $x$ to $\\phi$. From the equipartition relation, we have:\n$$\n\\frac{d\\phi}{dx} = \\sqrt{\\frac{2\\lambda W(\\phi)}{\\kappa}}\n$$\n(We take the positive root since $\\phi$ increases from $-1$ to $+1$ as $x$ increases from $-\\infty$ to $+\\infty$).\nWe can write the integral for $\\sigma$ as:\n$$\n\\sigma = \\int_{-\\infty}^{+\\infty} \\kappa \\left(\\frac{d\\phi}{dx}\\right) \\left(\\frac{d\\phi}{dx} dx\\right) = \\int_{\\phi(-\\infty)}^{\\phi(+\\infty)} \\kappa \\left(\\frac{d\\phi}{dx}\\right) d\\phi\n$$\nSubstituting the expression for $\\frac{d\\phi}{dx}$:\n$$\n\\sigma = \\int_{-1}^{+1} \\kappa \\sqrt{\\frac{2\\lambda W(\\phi)}{\\kappa}} d\\phi = \\int_{-1}^{+1} \\sqrt{2\\kappa\\lambda W(\\phi)} d\\phi\n$$\nNow, substitute the form of $W(\\phi) = \\frac{1}{4}(\\phi^2-1)^2$. For $\\phi \\in [-1, +1]$, $\\sqrt{W(\\phi)} = \\frac{1}{2}(1-\\phi^2)$.\n$$\n\\sigma = \\sqrt{2\\kappa\\lambda} \\int_{-1}^{+1} \\frac{1}{2}(1-\\phi^2) d\\phi\n$$\nThe integral is straightforward to evaluate:\n$$\n\\int_{-1}^{+1} (1-\\phi^2) d\\phi = \\left[\\phi - \\frac{\\phi^3}{3}\\right]_{-1}^{+1} = \\left(1 - \\frac{1}{3}\\right) - \\left(-1 - \\frac{(-1)^3}{3}\\right) = \\left(\\frac{2}{3}\\right) - \\left(-1 + \\frac{1}{3}\\right) = \\frac{2}{3} - \\left(-\\frac{2}{3}\\right) = \\frac{4}{3}\n$$\nSubstituting this result back into the expression for $\\sigma$:\n$$\n\\sigma = \\sqrt{2\\kappa\\lambda} \\cdot \\frac{1}{2} \\cdot \\frac{4}{3} = \\frac{2}{3}\\sqrt{2\\kappa\\lambda}\n$$\nThis can be written in the final simplified form:\n$$\n\\sigma = \\frac{2\\sqrt{2}}{3}\\sqrt{\\kappa\\lambda}\n$$\n\nRegarding the comparison to the sharp-interface limit: the value of $\\sigma$ derived here is the exact surface tension for the specified diffuse-interface model. In a classical sharp-interface model, the surface tension, say $\\sigma_{\\text{si}}$, is a prescribed thermodynamic parameter representing the excess energy of a zero-thickness mathematical surface. To connect the two models, one equates the phase-field surface tension with the sharp-interface value: $\\sigma = \\sigma_{\\text{si}}$. This equation provides one constraint on the model parameters $\\kappa$ and $\\lambda$. A second constraint comes from defining a characteristic interface thickness, $l$. By non-dimensionalizing the equilibrium equation, one finds that $l$ scales as $l \\propto \\sqrt{\\kappa/\\lambda}$.\nThe \"sharp-interface limit\" refers to the limit where $l \\to 0$ while $\\sigma_{\\text{si}}$ remains constant. From the scaling relations, if $\\sigma \\propto \\sqrt{\\kappa\\lambda}$ and $l \\propto \\sqrt{\\kappa/\\lambda}$, we find that $\\kappa \\propto \\sigma l$ and $\\lambda \\propto \\sigma/l$. Therefore, the limit $l \\to 0$ while keeping $\\sigma$ constant corresponds to $\\kappa \\to 0$ and $\\lambda \\to \\infty$, such that the product $\\kappa\\lambda$ remains constant. Our expression correctly shows that if $\\kappa\\lambda$ is held constant, the surface tension of the phase-field model remains constant, thereby consistently matching the sharp-interface value even as the interface profile becomes infinitely steep.", "answer": "$$\\boxed{\\frac{2\\sqrt{2}}{3}\\sqrt{\\kappa\\lambda}}$$", "id": "3521619"}, {"introduction": "Having established the physical meaning of the model parameters, the next crucial step toward computation is nondimensionalization. This practice demonstrates how to systematically analyze the governing equations, in this case the Cahn-Hilliard equation, to identify the natural scales for length, time, and energy. Performing this analysis is not just a mathematical formality; it reveals the fundamental dimensionless groups that control the system's behavior and is essential for designing robust and efficient numerical simulations.", "problem": "Consider an isothermal binary mixture described by a scalar order parameter field $\\phi(\\mathbf{x}, t)$ that is dimensionless, taking values in $[-1, 1]$. The interfacial thermodynamics are modeled by a free energy functional\n$$\n\\mathcal{F}[\\phi] = \\int_{\\Omega} \\left[ W\\, f(\\phi) + \\frac{1}{2}\\,\\kappa\\,|\\nabla \\phi|^{2} \\right]\\,\\mathrm{d}V,\n$$\nwhere $\\Omega \\subset \\mathbb{R}^{3}$ is a representative volume, $W$ is a positive bulk energy density scale, $\\kappa$ is a positive gradient penalty coefficient, and $f(\\phi)$ is a dimensionless double-well potential with two minima corresponding to coexisting phases. The nonequilibrium thermodynamic driving force is the chemical potential $\\mu(\\mathbf{x}, t)$ defined as the variational derivative $\\mu = \\delta \\mathcal{F}/\\delta \\phi$. The evolution of $\\phi$ follows mass conservation and a linear Onsager constitutive law,\n$$\n\\frac{\\partial \\phi}{\\partial t} + \\nabla \\cdot \\mathbf{J} = 0, \\qquad \\mathbf{J} = -M\\,\\nabla \\mu,\n$$\nwhere $\\mathbf{J}(\\mathbf{x}, t)$ is the diffusive flux of $\\phi$ and $M$ is a positive constant mobility.\n\nStarting from these foundational principles and definitions, perform a systematic dimensional analysis and nondimensionalization to:\n\n- Infer the physical dimensions of $\\mathcal{F}$, $\\mu$, $M$, and $\\mathbf{J}$ consistent with the above governing laws, given that $\\phi$ is dimensionless.\n- Introduce a characteristic length $L$ and an unknown characteristic time $T$, define dimensionless variables $\\mathbf{x}^{\\ast} = \\mathbf{x}/L$, $t^{\\ast} = t/T$, and scale the chemical potential as $\\mu^{\\ast} = \\mu/W$. Use these to nondimensionalize the Cahn–Hilliard (CH) equation $\\partial \\phi/\\partial t = \\nabla \\cdot (M \\nabla \\mu)$, and identify the emergent dimensionless interfacial parameter $\\varepsilon^{2}$ multiplying the Laplacian term in the nondimensionalized $\\mu^{\\ast}$.\n- Choose the time scale $T$ so that the nondimensionalized CH equation has no prefactor multiplying the dimensionless operator $\\nabla^{\\ast} \\cdot \\nabla^{\\ast} \\mu^{\\ast}$ (that is, the dimensionless mobility equals unity).\n\nState the final answer as the closed-form expression for the diffusion time scale $T$ in terms of $M$, $W$, and $L$. No numerical evaluation is required, and no rounding is needed. The final answer must be a single analytical expression without units inside the answer box.", "solution": "The problem statement is carefully examined and found to be valid. It is scientifically grounded in the principles of non-equilibrium thermodynamics and continuum mechanics, specifically describing the Cahn-Hilliard model for phase separation. The problem is well-posed, with all necessary information provided to perform a systematic dimensional analysis and nondimensionalization to determine a characteristic time scale. The language is precise and objective. There are no contradictions, ambiguities, or factual errors. We may therefore proceed with a full solution.\n\nThe solution is developed in three stages:\n1.  Determination of the physical dimensions of the parameters and fields.\n2.  Nondimensionalization of the governing equations.\n3.  Derivation of the characteristic time scale $T$ based on the specified condition.\n\nLet the fundamental physical dimensions be energy ($E$), length ($L$), and time ($t$). The notation $[\\cdot]$ will be used to denote the dimension of a physical quantity.\n\nFirst, we determine the physical dimensions. The order parameter $\\phi$ is given as dimensionless, so $[\\phi] = 1$. The free energy functional $\\mathcal{F}[\\phi]$ is an integral of an energy density over a volume $\\Omega \\subset \\mathbb{R}^{3}$. Therefore, $\\mathcal{F}$ has dimensions of energy, $[\\mathcal{F}] = E$. The integrand, let's call it $\\psi = W f(\\phi) + \\frac{1}{2}\\kappa|\\nabla \\phi|^{2}$, must have dimensions of energy density, i.e., energy per unit volume.\n$$ [\\psi] = \\frac{E}{L^{3}} $$\nThe function $f(\\phi)$ is given as dimensionless. Thus, the term $W f(\\phi)$ must have dimensions of energy density. This implies that the bulk energy scale $W$ has dimensions of energy density.\n$$ [W] = \\frac{E}{L^{3}} $$\nThe gradient operator $\\nabla$ has dimensions of inverse length, $[\\nabla] = 1/L$. As $\\phi$ is dimensionless, the term $|\\nabla \\phi|^{2}$ has dimensions of $(1/L)^{2} = 1/L^{2}$. For the second term in the integrand, $\\frac{1}{2}\\kappa|\\nabla \\phi|^{2}$, to also have dimensions of energy density, the dimensions of the gradient penalty coefficient $\\kappa$ must satisfy:\n$$ [\\kappa] \\cdot \\left[\\frac{1}{L^{2}}\\right] = \\frac{E}{L^{3}} \\implies [\\kappa] = \\frac{E}{L} $$\nThe chemical potential $\\mu$ is defined as the variational derivative $\\mu = \\delta \\mathcal{F} / \\delta \\phi$. This relationship implies $\\delta \\mathcal{F} = \\int_{\\Omega} \\mu \\, \\delta\\phi \\, \\mathrm{d}V$. Analyzing the dimensions of this integral relation:\n$$ [\\mathcal{F}] = [\\mu] [\\phi] [V] \\implies E = [\\mu] \\cdot 1 \\cdot L^{3} \\implies [\\mu] = \\frac{E}{L^{3}} $$\nThe chemical potential has dimensions of energy density, consistent with $[W]$.\n\nNext, we consider the evolution equations. The continuity equation is $\\partial \\phi / \\partial t + \\nabla \\cdot \\mathbf{J} = 0$. The dimensions of its terms must be consistent.\n$$ \\left[\\frac{\\partial \\phi}{\\partial t}\\right] = \\frac{[\\phi]}{[t]} = \\frac{1}{t} $$\n$$ [\\nabla \\cdot \\mathbf{J}] = [\\nabla] \\cdot [\\mathbf{J}] = \\frac{1}{L} [\\mathbf{J}] $$\nEquating these gives the dimensions of the flux $\\mathbf{J}$:\n$$ \\frac{1}{L} [\\mathbf{J}] = \\frac{1}{t} \\implies [\\mathbf{J}] = \\frac{L}{t} $$\nFinally, the constitutive law for the flux is $\\mathbf{J} = -M \\nabla \\mu$. We use this to find the dimensions of the mobility $M$.\n$$ [\\mathbf{J}] = [M] [\\nabla] [\\mu] \\implies \\frac{L}{t} = [M] \\cdot \\frac{1}{L} \\cdot \\frac{E}{L^{3}} = [M] \\frac{E}{L^{4}} $$\nSolving for $[M]$ yields:\n$$ [M] = \\frac{L}{t} \\cdot \\frac{L^{4}}{E} = \\frac{L^{5}}{E t} $$\nThis completes the dimensional analysis.\n\nSecond, we proceed with the nondimensionalization. The Cahn-Hilliard equation is derived by combining the continuity and constitutive laws: $\\partial \\phi/\\partial t = -\\nabla \\cdot \\mathbf{J} = \\nabla \\cdot (M \\nabla \\mu)$. For constant $M$, this becomes $\\partial \\phi/\\partial t = M \\nabla^{2} \\mu$. The chemical potential is given by the variational derivative, which results in $\\mu = W f'(\\phi) - \\kappa \\nabla^{2} \\phi$, where $f'(\\phi) = \\mathrm{d}f/\\mathrm{d}\\phi$.\n\nWe introduce the dimensionless variables as specified:\n$$ \\mathbf{x}^{\\ast} = \\frac{\\mathbf{x}}{L}, \\quad t^{\\ast} = \\frac{t}{T}, \\quad \\mu^{\\ast} = \\frac{\\mu}{W} $$\nThe differential operators transform as:\n$$ \\nabla = \\frac{\\partial}{\\partial \\mathbf{x}} = \\frac{\\partial \\mathbf{x}^{\\ast}}{\\partial \\mathbf{x}} \\frac{\\partial}{\\partial \\mathbf{x}^{\\ast}} = \\frac{1}{L} \\nabla^{\\ast} $$\n$$ \\frac{\\partial}{\\partial t} = \\frac{\\partial t^{\\ast}}{\\partial t} \\frac{\\partial}{\\partial t^{\\ast}} = \\frac{1}{T} \\frac{\\partial}{\\partial t^{\\ast}} $$\nSubstituting these into the Cahn-Hilliard equation $\\partial \\phi/\\partial t = M \\nabla^{2} \\mu$:\n$$ \\frac{1}{T} \\frac{\\partial \\phi}{\\partial t^{\\ast}} = M \\left(\\frac{1}{L} \\nabla^{\\ast}\\right)^{2} (W \\mu^{\\ast}) = \\frac{MW}{L^{2}} \\nabla^{\\ast 2} \\mu^{\\ast} $$\nMultiplying by $T$, we obtain the nondimensional Cahn-Hilliard equation:\n$$ \\frac{\\partial \\phi}{\\partial t^{\\ast}} = \\left( \\frac{MWT}{L^{2}} \\right) \\nabla^{\\ast 2} \\mu^{\\ast} $$\nNext, we nondimensionalize the expression for the chemical potential $\\mu = W f'(\\phi) - \\kappa \\nabla^{2} \\phi$:\n$$ W \\mu^{\\ast} = W f'(\\phi) - \\kappa \\left(\\frac{1}{L} \\nabla^{\\ast}\\right)^{2} \\phi = W f'(\\phi) - \\frac{\\kappa}{L^{2}} \\nabla^{\\ast 2} \\phi $$\nDividing by $W$:\n$$ \\mu^{\\ast} = f'(\\phi) - \\left( \\frac{\\kappa}{WL^{2}} \\right) \\nabla^{\\ast 2} \\phi $$\nThe problem asks to identify the dimensionless interfacial parameter $\\varepsilon^{2}$ multiplying the Laplacian term. From the above equation, we see that:\n$$ \\varepsilon^{2} = \\frac{\\kappa}{WL^{2}} $$\nA quick check of dimensions confirms it is dimensionless: $[\\varepsilon^{2}] = \\frac{[\\kappa]}{[W][L^{2}]} = \\frac{E/L}{(E/L^{3})L^{2}} = \\frac{E/L}{E/L} = 1$.\n\nThird, we determine the characteristic time scale $T$. The problem requires choosing $T$ such that the prefactor on the right-hand side of the nondimensionalized Cahn-Hilliard equation is unity. This prefactor represents the dimensionless mobility.\n$$ \\frac{MWT}{L^{2}} = 1 $$\nSolving this equation for $T$ provides the desired diffusion time scale:\n$$ T = \\frac{L^{2}}{MW} $$\nThis expression for $T$ depends only on the characteristic length scale $L$, the mobility $M$, and the bulk energy density scale $W$, as required. A final dimensional check confirms $[T] = \\frac{[L^2]}{[M][W]} = \\frac{L^2}{(L^5/Et) (E/L^3)} = \\frac{L^2}{L^2/t} = t$, which is correct.", "answer": "$$\\boxed{\\frac{L^{2}}{MW}}$$", "id": "3521593"}, {"introduction": "With a solid grasp of the model's physical interpretation and scaling properties, we can now proceed to numerical implementation. This hands-on coding exercise guides you through building a one-dimensional solver for the Allen-Cahn equation, which governs non-conserved interface dynamics. You will implement an efficient and stable semi-implicit spectral method and use it to investigate a crucial modeling choice: the difference between constant and phase-dependent (degenerate) mobility, quantifying its impact on interface kinetics.", "problem": "You are asked to implement and analyze a one-dimensional Allen–Cahn phase-field model with a mobility that is either constant or degenerate in the bulk. Your goal is to quantify how mobility degeneracy modifies interface kinetics under a small thermodynamic driving force by computing the interface velocity from first principles. The complete program must be self-contained, perform the required calculations for the specified test suite, and print the aggregated results in the exact format described at the end of this problem.\n\nConsider a scalar order parameter field $ \\phi(x,t) \\in [0,1] $ on a periodic one-dimensional domain $ x \\in [0,L) $, evolving under the Allen–Cahn dynamics driven by a Ginzburg–Landau free energy with a double-well potential and a small linear tilt that induces motion of the interface. The free energy functional is\n$$\n\\mathcal{F}[\\phi] = \\int_{0}^{L} \\left( \\frac{\\epsilon^2}{2} \\left| \\frac{\\partial \\phi}{\\partial x} \\right|^2 + W(\\phi) - h \\, \\phi \\right) \\, dx,\n$$\nwhere $ \\epsilon > 0 $ sets the interface thickness, $ W(\\phi) = \\phi^2 (1-\\phi)^2 $ is the double-well potential, and $ h \\in \\mathbb{R} $ is a small constant tilt that biases the two wells. The variational derivative (chemical potential) is\n$$\n\\mu = \\frac{\\delta \\mathcal{F}}{\\delta \\phi} = - \\epsilon^2 \\frac{\\partial^2 \\phi}{\\partial x^2} + W'(\\phi) - h,\n$$\nwith $ W'(\\phi) = 2 \\phi (1-\\phi)(1-2\\phi) $. The Allen–Cahn evolution is the relaxational dynamics\n$$\n\\frac{\\partial \\phi}{\\partial t} = - M(\\phi) \\, \\mu = M(\\phi) \\left( \\epsilon^2 \\frac{\\partial^2 \\phi}{\\partial x^2} - W'(\\phi) + h \\right),\n$$\nwhere $ M(\\phi) $ is the mobility. You will study two cases:\n- Constant mobility: $ M(\\phi) = M_0 $, where $ M_0 > 0 $ is constant.\n- Degenerate mobility: $ M(\\phi) = M_0 \\, \\phi^2 (1-\\phi)^2 $, which vanishes in the bulk phases $ \\phi = 0 $ and $ \\phi = 1 $ and is maximal near the interface $ \\phi \\approx 1/2 $.\n\nInitial condition: a single diffuse interface centered at $ x_0 = L/2 $,\n$$\n\\phi(x,0) = \\frac{1}{2} \\left[ 1 - \\tanh \\left( \\frac{x - x_0}{\\sqrt{2} \\, w} \\right) \\right],\n$$\nwith a smooth width $ w $ chosen proportionally to $ \\epsilon $ so that the interface is well-resolved.\n\nYou must derive from first principles a numerically stable semi-implicit time-stepping scheme in which the linear diffusive term is treated implicitly with a constant operator, while nonlinear and variable-coefficient terms are treated explicitly. Use a periodic spatial discretization and a Fast Fourier Transform (FFT) to implement the implicit linear solve efficiently by diagonalization in Fourier space. Specifically, write an update of the form\n$$\n\\left( I - \\Delta t \\, M_0 \\, \\epsilon^2 \\, \\frac{\\partial^2}{\\partial x^2} \\right) \\phi^{n+1} = \\phi^n + \\Delta t \\left[ \\left( M(\\phi^n) - M_0 \\right) \\epsilon^2 \\frac{\\partial^2 \\phi^n}{\\partial x^2} - M(\\phi^n) W'(\\phi^n) + M(\\phi^n) h \\right],\n$$\nwhere $ \\Delta t $ is the time step and superscripts denote time levels. Under periodic boundary conditions, the operator on the left-hand side is diagonal in Fourier space.\n\nDefine the instantaneous interface position $ x_\\ast(t) $ as the unique location nearest to $ x_0 $ where $ \\phi(x_\\ast(t),t) = 1/2 $. Use linear interpolation between grid points to estimate $ x_\\ast(t) $ from the discrete field $ \\phi(x,t) $. Because the domain is periodic, compute the net displacement using the minimum image convention:\n$$\n\\Delta x = \\mathrm{wrap}( x_\\ast(T) - x_\\ast(0) ), \\quad \\mathrm{wrap}(d) = \n\\begin{cases}\nd - L & \\text{if } d > L/2, \\\\\nd + L & \\text{if } d < -L/2, \\\\\nd & \\text{otherwise.}\n\\end{cases}\n$$\nThe average interface velocity is then\n$$\nv = \\frac{\\Delta x}{T},\n$$\nwhere $ T $ is the final simulation time.\n\nImplement the above numerical scheme and compute, for each test case below, the pair of velocities $ v_{\\mathrm{const}} $ and $ v_{\\mathrm{deg}} $ obtained with constant and degenerate mobility, respectively, and the ratio\n$$\nR = \n\\begin{cases}\n\\frac{v_{\\mathrm{deg}}}{v_{\\mathrm{const}}}, & \\text{if } |v_{\\mathrm{const}}| \\ge \\delta, \\\\\n0, & \\text{if } |v_{\\mathrm{const}}| < \\delta,\n\\end{cases}\n$$\nwith $ \\delta = 10^{-8} $.\n\nAll simulations are nondimensional. Ensure numerical stability by choosing $ \\Delta t $ and the number of grid points $ N $ such that the interface is resolved and the scheme is stable.\n\nTest suite. For all cases use a periodic domain $ [0,L) $ with $ L = 1 $, and set $ w = 2 \\epsilon $ in the initial condition. Use the following parameter sets:\n- Case A (driven, thin interface): $ \\epsilon = 0.01 $, $ h = 0.05 $, $ M_0 = 1.0 $, $ N = 1024 $, $ \\Delta t = 10^{-4} $, $ T = 0.2 $.\n- Case B (undriven control): $ \\epsilon = 0.01 $, $ h = 0.0 $, $ M_0 = 1.0 $, $ N = 1024 $, $ \\Delta t = 10^{-4} $, $ T = 0.2 $.\n- Case C (driven, wider interface): $ \\epsilon = 0.02 $, $ h = 0.05 $, $ M_0 = 1.0 $, $ N = 1024 $, $ \\Delta t = 10^{-4} $, $ T = 0.2 $.\n\nFor each case, compute three floats $ [v_{\\mathrm{const}}, v_{\\mathrm{deg}}, R] $.\n\nFinal output format. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Concatenate the three floats for Case A, then the three floats for Case B, then the three floats for Case C, in that order, yielding a flat list of nine floats. Round each float to exactly six digits after the decimal point in the printed output. For example, the printed line must have the form\n$$\n[\\text{A1},\\text{A2},\\text{A3},\\text{B1},\\text{B2},\\text{B3},\\text{C1},\\text{C2},\\text{C3}],\n$$\nwhere each placeholder is a decimal number with exactly six digits after the decimal point.", "solution": "The user has provided a well-posed problem in computational physics, specifically concerning the numerical solution of the Allen-Cahn equation. The problem is scientifically grounded, free of contradictions, and contains all necessary information for a unique solution. I will proceed with the derivation and implementation of the solution.\n\n### 1. Theoretical Framework and Numerical Scheme\n\nThe evolution of the scalar phase field $\\phi(x,t)$ is governed by the Allen-Cahn equation, a gradient descent dynamics for the Ginzburg-Landau free energy functional $\\mathcal{F}[\\phi]$:\n$$\n\\frac{\\partial \\phi}{\\partial t} = -M(\\phi) \\frac{\\delta \\mathcal{F}}{\\delta \\phi}\n$$\nThe free energy functional is given by:\n$$\n\\mathcal{F}[\\phi] = \\int_{0}^{L} \\left( \\frac{\\epsilon^2}{2} \\left| \\frac{\\partial \\phi}{\\partial x} \\right|^2 + W(\\phi) - h \\, \\phi \\right) \\, dx\n$$\nwhere $W(\\phi) = \\phi^2 (1-\\phi)^2$ is the double-well potential. The variational derivative, or chemical potential $\\mu$, is:\n$$\n\\mu = \\frac{\\delta \\mathcal{F}}{\\delta \\phi} = - \\epsilon^2 \\frac{\\partial^2 \\phi}{\\partial x^2} + W'(\\phi) - h\n$$\nwith $W'(\\phi) = 2\\phi(1-\\phi)(1-2\\phi)$. This leads to the partial differential equation (PDE):\n$$\n\\frac{\\partial \\phi}{\\partial t} = M(\\phi) \\left( \\epsilon^2 \\frac{\\partial^2 \\phi}{\\partial x^2} - W'(\\phi) + h \\right)\n$$\nWe analyze two forms for the mobility $M(\\phi)$: constant ($M(\\phi) = M_0$) and degenerate ($M(\\phi) = M_0 \\phi^2(1-\\phi)^2$).\n\nA semi-implicit time integration scheme is specified to handle the stiffness of the diffusive term $\\epsilon^2 \\frac{\\partial^2 \\phi}{\\partial x^2}$. The scheme separates the PDE into a linear part with a constant coefficient, treated implicitly, and the remaining nonlinear/variable-coefficient parts, treated explicitly. We rewrite the PDE as:\n$$\n\\frac{\\partial \\phi}{\\partial t} = M_0 \\epsilon^2 \\frac{\\partial^2 \\phi}{\\partial x^2} + \\left[ (M(\\phi) - M_0)\\epsilon^2 \\frac{\\partial^2 \\phi}{\\partial x^2} - M(\\phi)W'(\\phi) + M(\\phi)h \\right]\n$$\nApplying a forward-Euler step for the explicit part and a backward-Euler step for the implicit part gives:\n$$\n\\frac{\\phi^{n+1} - \\phi^n}{\\Delta t} = M_0 \\epsilon^2 \\frac{\\partial^2 \\phi^{n+1}}{\\partial x^2} + \\left[ (M(\\phi^n) - M_0)\\epsilon^2 \\frac{\\partial^2 \\phi^n}{\\partial x^2} - M(\\phi^n)W'(\\phi^n) + M(\\phi^n)h \\right]\n$$\nRearranging for $\\phi^{n+1}$ yields the update equation specified in the problem:\n$$\n\\left( I - \\Delta t \\, M_0 \\, \\epsilon^2 \\, \\frac{\\partial^2}{\\partial x^2} \\right) \\phi^{n+1} = \\text{RHS}(\\phi^n)\n$$\nwhere $I$ is the identity operator and $\\text{RHS}(\\phi^n)$ collects all terms evaluated at the current time step $n$:\n$$\n\\text{RHS}(\\phi^n) = \\phi^n + \\Delta t \\left[ \\left( M(\\phi^n) - M_0 \\right) \\epsilon^2 \\frac{\\partial^2 \\phi^n}{\\partial x^2} - M(\\phi^n) W'(\\phi^n) + M(\\phi^n) h \\right]\n$$\n\n### 2. Spectral Implementation\n\nThe problem is set on a periodic domain $x \\in [0,L)$, making a spectral method based on the Fast Fourier Transform (FFT) highly efficient. The spatial domain is discretized into $N$ grid points $x_j = j \\cdot \\Delta x$ for $j = 0, \\dots, N-1$, where $\\Delta x = L/N$.\n\nIn Fourier space, the second derivative operator $\\frac{\\partial^2}{\\partial x^2}$ becomes a multiplication by $-q^2$, where $q$ are the angular wavenumbers. For a discrete grid, these are $q = 2\\pi k$, where $k$ are the spatial frequencies given by `numpy.fft.fftfreq(N, d=dx)`.\n\nLet $\\hat{\\phi}$ be the FFT of $\\phi$. The update equation in Fourier space becomes:\n$$\n\\left( 1 + \\Delta t \\, M_0 \\, \\epsilon^2 \\, q^2 \\right) \\hat{\\phi}^{n+1} = \\widehat{\\text{RHS}}(\\phi^n)\n$$\nWe can solve for $\\hat{\\phi}^{n+1}$ by a simple element-wise division:\n$$\n\\hat{\\phi}^{n+1} = \\frac{\\widehat{\\text{RHS}}(\\phi^n)}{1 + \\Delta t \\, M_0 \\, \\epsilon^2 \\, q^2}\n$$\nThe field at the new time step, $\\phi^{n+1}$, is then obtained by an inverse FFT.\n\nThe algorithm for one time step is:\n1.  Start with $\\phi^n$ in real space and $\\hat{\\phi}^n$ in Fourier space.\n2.  Compute the explicit term $\\frac{\\partial^2 \\phi^n}{\\partial x^2}$ by applying an inverse FFT to $-q^2 \\hat{\\phi}^n$.\n3.  Compute $W'(\\phi^n)$ and $M(\\phi^n)$ in real space.\n4.  Assemble the full $\\text{RHS}(\\phi^n)$ expression in real space.\n5.  Compute the FFT of the right-hand side, $\\widehat{\\text{RHS}}$.\n6.  Divide by the denominator $(1 + \\Delta t M_0 \\epsilon^2 q^2)$ to find $\\hat{\\phi}^{n+1}$.\n7.  The real part of the inverse FFT of $\\hat{\\phi}^{n+1}$ gives $\\phi^{n+1}$.\n\n### 3. Interface Velocity Calculation\n\nThe instantaneous position of the interface, $x_*(t)$, is defined as the location where $\\phi(x,t) = 1/2$. Given the discrete field $\\phi_j$, this position is found by identifying the grid cell $[x_j, x_{j+1}]$ where the crossing occurs (i.e., $(\\phi_j - 0.5)(\\phi_{j+1} - 0.5) \\le 0$) and using linear interpolation:\n$$\nx_* = x_j + \\Delta x \\frac{0.5 - \\phi_j}{\\phi_{j+1} - \\phi_j}\n$$\nThe periodic nature of the domain is handled by checking the crossing between the last and first grid points as well. If multiple crossings exist, the one nearest to the initial center $x_0 = L/2$ is chosen.\n\nThe net displacement $\\Delta x$ over the total simulation time $T$ is computed as $\\Delta x = x_*(T) - x_*(0)$, adjusted for periodicity using the minimum image convention:\n$$\n\\Delta x \\to \\Delta x - L \\quad \\text{if } \\Delta x > L/2\n$$\n$$\n\\Delta x \\to \\Delta x + L \\quad \\text{if } \\Delta x < -L/2\n$$\nThe average velocity is then $v = \\Delta x / T$.\n\nFor each test case, we compute the velocities for constant mobility, $v_{\\mathrm{const}}$, and degenerate mobility, $v_{\\mathrm{deg}}$. The ratio $R$ is calculated as $v_{\\mathrm{deg}}/v_{\\mathrm{const}}$, with a threshold to prevent division by zero for stationary interfaces.\n\nThe implementation will consist of a main function to loop through the test suite, calling a simulation function that executes the time-stepping loop and calculates the velocity. All parameters provided in the problem statement are used directly.", "answer": "```python\n#\n# Meticulous and Exacting Professor: STEM Fields\n# Final Answer: Allen-Cahn Phase-Field Simulation\n#\nimport numpy as np\n\ndef W_prime(phi):\n    \"\"\"Derivative of the double-well potential W(phi) = phi^2 * (1-phi)^2.\"\"\"\n    return 2.0 * phi * (1.0 - phi) * (1.0 - 2.0 * phi)\n\ndef M_const(phi, M0):\n    \"\"\"Constant mobility function.\"\"\"\n    return np.full_like(phi, M0)\n\ndef M_degen(phi, M0):\n    \"\"\"Degenerate mobility function.\"\"\"\n    return M0 * phi**2 * (1.0 - phi)**2\n\ndef find_interface_position(x, phi, L, x0_center):\n    \"\"\"\n    Finds the interface position (phi=0.5) using linear interpolation.\n    Handles periodic boundaries and selects the crossing nearest to x0_center.\n    \"\"\"\n    N = len(x)\n    dx = L / N\n    \n    phi_shifted = np.roll(phi, -1)\n    # Find indices j where a sign change occurs for phi-0.5\n    indices = np.where((phi - 0.5) * (phi_shifted - 0.5) = 0)[0]\n\n    if indices.size == 0:\n        center_idx = np.argmin(np.abs(phi - 0.5))\n        return x[center_idx]\n        \n    crossings = []\n    for j in indices:\n        phi_j = phi[j]\n        phi_j1 = phi_shifted[j]\n        \n        delta_phi = phi_j1 - phi_j\n        if np.abs(delta_phi)  1e-12:\n            if np.abs(phi_j - 0.5)  1e-9: # Point is on the crossing\n                crossings.append(x[j])\n            continue\n        \n        pos = x[j] + dx * (0.5 - phi_j) / delta_phi\n        crossings.append(pos)\n    \n    if not crossings:\n        center_idx = np.argmin(np.abs(phi - 0.5))\n        return x[center_idx]\n        \n    crossings = np.array(crossings)\n    crossings = crossings % L\n    \n    dist = np.abs(crossings - x0_center)\n    dist = np.minimum(dist, L - dist)\n    \n    return crossings[np.argmin(dist)]\n\ndef run_simulation(L, N, T, dt, eps, h, M0, mobility_type):\n    \"\"\"Runs a single Allen-Cahn simulation.\"\"\"\n    dx = L / N\n    x = np.arange(N) * dx\n    q = 2.0 * np.pi * np.fft.fftfreq(N, d=dx)\n    laplacian_k = -q**2\n\n    w = 2.0 * eps\n    x0_center = L / 2.0\n    phi_initial = 0.5 * (1.0 - np.tanh((x - x0_center) / (np.sqrt(2.0) * w)))\n    \n    pos0 = find_interface_position(x, phi_initial, L, x0_center)\n\n    mobility_map = {'const': M_const, 'degen': M_degen}\n    M_func = mobility_map[mobility_type]\n\n    num_steps = int(round(T / dt))\n    phi_k = np.fft.fft(phi_initial)\n    \n    denominator = 1.0 - dt * M0 * eps**2 * laplacian_k\n    denominator[np.abs(denominator)  1e-12] = 1.0\n\n    for _ in range(num_steps):\n        phi = np.fft.ifft(phi_k).real\n        M_phi = M_func(phi, M0)\n        W_p = W_prime(phi)\n        \n        if mobility_type == 'const':\n            rhs = phi + dt * (-M_phi * W_p + M_phi * h)\n        else:\n            lap_phi = np.fft.ifft(laplacian_k * phi_k).real\n            rhs = phi + dt * ((M_phi - M0) * eps**2 * lap_phi - M_phi * W_p + M_phi * h)\n        \n        rhs_k = np.fft.fft(rhs)\n        phi_k = rhs_k / denominator\n\n    phi_final = np.fft.ifft(phi_k).real\n    \n    pos_final = find_interface_position(x, phi_final, L, x0_center)\n    \n    delta_x = pos_final - pos0\n    if delta_x > L / 2.0:\n        delta_x -= L\n    elif delta_x  -L / 2.0:\n        delta_x += L\n        \n    velocity = delta_x / T\n    \n    return velocity\n\ndef solve():\n    \"\"\"Main function to run the test suite and print results.\"\"\"\n    test_suite = [\n        # Case A (driven, thin interface)\n        {'eps': 0.01, 'h': 0.05, 'T': 0.2, 'N': 1024, 'dt': 1e-4},\n        # Case B (undriven control)\n        {'eps': 0.01, 'h': 0.0, 'T': 0.2, 'N': 1024, 'dt': 1e-4},\n        # Case C (driven, wider interface)\n        {'eps': 0.02, 'h': 0.05, 'T': 0.2, 'N': 1024, 'dt': 1e-4},\n    ]\n    \n    common_params = {'L': 1.0, 'M0': 1.0}\n    delta_R = 1e-8\n    \n    results = []\n    for case_params in test_suite:\n        params = {**common_params, **case_params}\n        \n        v_const = run_simulation(**params, mobility_type='const')\n        v_deg = run_simulation(**params, mobility_type='degen')\n        \n        R = 0.0\n        if abs(v_const) >= delta_R:\n            R = v_deg / v_const\n            \n        results.extend([v_const, v_deg, R])\n\n    formatted_results = [f\"{r:.6f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\n# Execute the solver\nsolve()\n```", "id": "3521556"}]}