{"hands_on_practices": [{"introduction": "The stability of numerical simulations using explicit time-stepping schemes is governed by the Courant–Friedrichs–Lewy (CFL) condition, which requires the time step to be smaller than the time it takes for the fastest signal to cross a grid cell. Moving puncture gauge conditions introduce non-physical \"gauge\" modes that propagate with their own characteristic speeds, which can exceed the speed of physical phenomena like gravitational waves. This practice guides you through a linear perturbation analysis to determine these gauge speeds from first principles, providing a concrete understanding of how gauge choices directly constrain the maximum stable time step and thus the computational cost of a simulation [@problem_id:3479922].", "problem": "In the Baumgarte–Shapiro–Shibata–Nakamura (BSSN) formulation of the Einstein equations with the moving puncture gauge, the lapse function $\\alpha$ is often evolved by the so-called $1+\\log$ slicing condition. Work in geometrized units where $G=c=1$, so that time and length have the same units. Consider a vacuum spacetime linearized about Minkowski space with background values $\\alpha=1$, $\\beta^{i}=0$, and $\\gamma_{ij}=\\delta_{ij}$. Assume the following well-tested base equations for the principal (highest-derivative) parts:\n- The $1+\\log$ slicing condition for the lapse takes the form $\\partial_{t}\\alpha=-\\mu_{L}\\alpha^{2}K$, where $K$ is the trace of the extrinsic curvature and $\\mu_{L}$ is a positive constant.\n- The Arnowitt–Deser–Misner (ADM) evolution equation for $K$ in vacuum, at principal part and vanishing background shift, is $\\partial_{t}K=-\\Delta\\alpha+\\text{(lower-order terms)}$, where the flat-space Laplacian is $\\Delta=\\delta^{ij}\\partial_{i}\\partial_{j}$.\n\nCarry out a linear perturbation analysis by writing $\\alpha=1+\\delta\\alpha$ and keeping only terms linear in $\\delta\\alpha$ and $K$. Derive the principal-part subsystem for $\\delta\\alpha$ and $K$, and obtain the characteristic speed of the lapse gauge mode associated with the $1+\\log$ slicing as a function of $\\mu_{L}$. Then, taking into account that vacuum gravitational radiation in this formulation propagates at unit speed, and that the standard hyperbolic Gamma-driver shift sector has principal speeds that do not exceed unity for the usual choice of parameters, determine the maximum characteristic speed $v_{\\max}$ across all sectors when $\\mu_{L}=2$.\n\nFinally, use the Courant–Friedrichs–Lewy (CFL) restriction for an explicit finite-difference method-of-lines scheme,\n$$\\Delta t \\leq C \\frac{\\Delta x}{v_{\\max}},$$\nwith user-chosen Courant factor $C$ and spatial grid spacing $\\Delta x$, to compute the maximum stable time step $\\Delta t_{\\max}$. Express your final answer for $\\Delta t_{\\max}$ symbolically in terms of $C$ and $\\Delta x$. Use geometrized units ($G=c=1$), and express $\\Delta t_{\\max}$ in the same units as $\\Delta x$. No numerical rounding is required; provide an exact symbolic expression as your final answer.", "solution": "The problem is scientifically grounded, well-posed, and all necessary information for its resolution is provided. We can therefore proceed with the derivation. The analysis is performed in geometrized units, where $G=c=1$.\n\nThe problem provides the principal parts of the evolution equations for the lapse function $\\alpha$ and the trace of the extrinsic curvature $K$ in a vacuum spacetime:\n1.  The $1+\\log$ slicing condition for the lapse:\n    $$ \\partial_{t}\\alpha = -\\mu_{L}\\alpha^{2}K $$\n    where $\\mu_{L}$ is a positive constant.\n2.  The ADM evolution equation for $K$:\n    $$ \\partial_{t}K = -\\Delta\\alpha $$\n    where $\\Delta = \\delta^{ij}\\partial_{i}\\partial_{j}$ is the flat-space Laplacian operator.\n\nWe are asked to perform a linear perturbation analysis around a Minkowski background. The background values are specified as $\\alpha=1$, $\\beta^{i}=0$, $\\gamma_{ij}=\\delta_{ij}$, which implies the background value of the extrinsic curvature trace is $K=0$. We introduce a small perturbation $\\delta\\alpha$ for the lapse function, such that $\\alpha = 1 + \\delta\\alpha$. The quantity $K$ is itself a first-order perturbation away from its background value of $0$. We linearize the system by keeping only terms that are of first order in the perturbations $\\delta\\alpha$ and $K$.\n\nLet's linearize the first equation, $\\partial_{t}\\alpha = -\\mu_{L}\\alpha^{2}K$.\nThe left-hand side (LHS) is:\n$$ \\partial_{t}\\alpha = \\partial_{t}(1+\\delta\\alpha) = \\partial_{t}\\delta\\alpha $$\nThe right-hand side (RHS) is:\n$$ -\\mu_{L}\\alpha^{2}K = -\\mu_{L}(1+\\delta\\alpha)^{2}K = -\\mu_{L}(1 + 2\\delta\\alpha + (\\delta\\alpha)^2)K $$\nExpanding this and keeping only terms of first order in the perturbations:\n$$ -\\mu_{L}(1 \\cdot K + 2\\delta\\alpha \\cdot K + (\\delta\\alpha)^2 \\cdot K) \\approx -\\mu_{L}K $$\nThe term $2\\delta\\alpha \\cdot K$ is of second order and $(\\delta\\alpha)^2 \\cdot K$ is of third order, so they are discarded in the linearization.\nThus, the linearized lapse equation is:\n$$ \\partial_{t}\\delta\\alpha = -\\mu_{L}K $$\n\nNext, we linearize the second equation, $\\partial_{t}K = -\\Delta\\alpha$.\nThe LHS, $\\partial_{t}K$, is already linear as $K$ is a first-order quantity.\nThe RHS is:\n$$ -\\Delta\\alpha = -\\Delta(1+\\delta\\alpha) = -\\Delta(1) - \\Delta(\\delta\\alpha) $$\nSince $1$ is a constant, its Laplacian is zero, $\\Delta(1)=0$. The equation becomes:\n$$ \\partial_{t}K = -\\Delta\\delta\\alpha $$\n\nThe resulting linearized system of equations for the principal parts is:\n$$\n\\begin{cases}\n\\partial_{t}\\delta\\alpha = -\\mu_{L}K \\\\\n\\partial_{t}K = -\\Delta\\delta\\alpha\n\\end{cases}\n$$\n\nTo find the characteristic speed of this system, we can combine these two first-order equations into a single second-order wave equation. We differentiate the first equation with respect to time $t$:\n$$ \\partial_{tt}\\delta\\alpha = \\partial_{t}(-\\mu_{L}K) = -\\mu_{L}\\partial_{t}K $$\nNow, we substitute the second equation, $\\partial_{t}K = -\\Delta\\delta\\alpha$, into the expression above:\n$$ \\partial_{tt}\\delta\\alpha = -\\mu_{L}(-\\Delta\\delta\\alpha) = \\mu_{L}\\Delta\\delta\\alpha $$\nRearranging this gives the wave equation for the lapse perturbation $\\delta\\alpha$:\n$$ \\partial_{tt}\\delta\\alpha - \\mu_{L}\\Delta\\delta\\alpha = 0 $$\nThe standard form of a wave equation is $\\partial_{tt}u - v^2 \\Delta u = 0$, where $v$ is the propagation speed. By comparing our derived equation with the standard form, we can identify the square of the characteristic speed as $v_{\\text{lapse}}^2 = \\mu_{L}$. Since $\\mu_{L}$ is a positive constant, the characteristic speed of the lapse gauge mode is:\n$$ v_{\\text{lapse}} = \\sqrt{\\mu_{L}} $$\n\nThe problem asks us to consider the specific case where $\\mu_{L}=2$. For this value, the speed of the lapse gauge mode is:\n$$ v_{\\text{lapse}} = \\sqrt{2} $$\nThe problem states that vacuum gravitational radiation (physical modes) propagates at speed $v_{\\text{GW}}=1$, and the characteristic speeds of the Gamma-driver shift sector (gauge modes) do not exceed unity, i.e., $v_{\\text{shift}} \\le 1$.\nThe maximum characteristic speed of the full evolution system, $v_{\\max}$, is the maximum of the speeds of all modes, both physical and gauge.\n$$ v_{\\max} = \\max(v_{\\text{GW}}, v_{\\text{shift}}, v_{\\text{lapse}}) $$\nSubstituting the known values and constraints:\n$$ v_{\\max} = \\max(1, v_{\\text{shift}}, \\sqrt{2}) $$\nSince $\\sqrt{2} \\approx 1.414$, we have $\\sqrt{2} > 1$. And since $v_{\\text{shift}} \\le 1$, the maximum speed is determined by the lapse gauge mode:\n$$ v_{\\max} = \\sqrt{2} $$\n\nFinally, we use the Courant–Friedrichs–Lewy (CFL) condition to determine the maximum stable time step, $\\Delta t_{\\max}$. The condition is given as:\n$$ \\Delta t \\leq C \\frac{\\Delta x}{v_{\\max}} $$\nwhere $C$ is the Courant factor and $\\Delta x$ is the spatial grid spacing. The maximum allowed time step is achieved at the equality:\n$$ \\Delta t_{\\max} = C \\frac{\\Delta x}{v_{\\max}} $$\nSubstituting the value $v_{\\max} = \\sqrt{2}$:\n$$ \\Delta t_{\\max} = C \\frac{\\Delta x}{\\sqrt{2}} $$\nThis is the final symbolic expression for the maximum stable time step in terms of $C$ and $\\Delta x$.", "answer": "$$\\boxed{C\\frac{\\Delta x}{\\sqrt{2}}}$$", "id": "3479922"}, {"introduction": "A robust gauge condition must not only be stable but also actively damp unphysical transients and guide the system toward a quasi-stationary state, which is essential for long-term simulations of black holes. The Gamma-driver shift condition achieves this through a carefully designed damping mechanism, which can be understood by modeling the system's dynamics for a single Fourier mode. This exercise lets you dissect the distinct roles of the hyperbolic and damping terms by analyzing the system's eigenvalues and its response to a persistent source [@problem_id:3479951]. You will see precisely how the damping parameter $\\eta$ suppresses transient oscillations to ensure a smooth evolution, without altering the final equilibrium state of the shift.", "problem": "Consider the Moving Puncture Gauge used in the Baumgarte–Shapiro–Shibata–Nakamura (BSSN) formulation of numerical relativity, in which the shift vector $\\beta^{i}$ is evolved by a Gamma-driver condition, and an auxiliary variable $B^{i}$ is introduced to damp the conformal connection functions $\\tilde{\\Gamma}^{i}$. In the linearized, small-amplitude regime around a flat background, assume the lapse is approximately constant and equal to unity and focus on a single spatial Fourier mode of wavenumber $k>0$ for one Cartesian component of the shift. Under these assumptions, the principal-part coupling between the Gamma-driver and the shift can be modeled as\n$$\n\\partial_{t}\\beta(t) \\;=\\; a\\,B(t), \\qquad \\partial_{t}B(t) \\;=\\; -\\,\\nu\\,k^{2}\\,\\beta(t) \\;-\\; \\eta\\,B(t) \\;+\\; S,\n$$\nwhere $a>0$ and $\\nu>0$ are real constants characterizing the hyperbolic coupling and effective propagation speed of the gauge, $\\eta>0$ is the damping parameter, and $S$ is a real, time-independent source amplitude that represents a persistent driver due to quasi-stationary curvature or constraint-violation content projected onto the chosen Fourier mode. Treat $\\beta(t)$ and $B(t)$ as scalar functions of time corresponding to that single Fourier component.\n\nStarting from the above system and standard Fourier-mode analysis, derive the temporal eigenvalues governing the homogeneous transient dynamics and the steady-state value $\\beta_{\\ast}$ attained as $t\\to\\infty$ in the presence of the constant source $S$. You must begin from the basic principles of linear ordinary differential equations and Fourier-mode decomposition, and you must clearly explain the role of the damping parameter $\\eta$ in shaping transient decay and oscillatory behavior, as well as its influence (or lack thereof) on the steady-state solution.\n\nProvide your final results as closed-form analytic expressions for the two temporal eigenvalues and the steady-state $\\beta_{\\ast}$ in terms of $a, \\nu, \\eta, k, S$. No numerical evaluation or rounding is required. Do not include units in your final expressions.", "solution": "The user wants a detailed analysis of a system of linear ordinary differential equations (ODEs) modeling the moving puncture gauge conditions in numerical relativity. The task is to derive the temporal eigenvalues of the homogeneous system and the steady-state solution for the inhomogeneous system.\n\nThe problem is validated as sound. It is a standard, well-posed problem in mathematical physics, grounded in the established context of the BSSN formulation and Gamma-driver gauge conditions. The givens are self-consistent, and the terminology is precise.\n\nThe system of equations for a single Fourier mode is given by:\n$$\n\\partial_{t}\\beta(t) = a B(t)\n$$\n$$\n\\partial_{t}B(t) = -\\nu k^{2}\\beta(t) - \\eta B(t) + S\n$$\nwhere $\\beta(t)$ and $B(t)$ are scalar functions of time $t$. The parameters $a$, $\\nu$, $\\eta$, and $k$ are positive real constants, and $S$ is a real, time-independent source term.\n\nFirst, we analyze the homogeneous transient dynamics by setting the source term $S$ to $0$. The system becomes:\n$$\n\\partial_{t}\\beta(t) = a B(t)\n$$\n$$\n\\partial_{t}B(t) = -\\nu k^{2}\\beta(t) - \\eta B(t)\n$$\nThis is a system of two coupled, linear, first-order homogeneous ODEs with constant coefficients. We can write this in matrix form as:\n$$\n\\frac{d}{dt} \\begin{pmatrix} \\beta(t) \\\\ B(t) \\end{pmatrix} = \\begin{pmatrix} 0 & a \\\\ -\\nu k^{2} & -\\eta \\end{pmatrix} \\begin{pmatrix} \\beta(t) \\\\ B(t) \\end{pmatrix}\n$$\nThe temporal evolution of the system is governed by the eigenvalues, $\\lambda$, of the coefficient matrix. We seek solutions of the form $e^{\\lambda t}$. The eigenvalues are found by solving the characteristic equation $\\det(\\mathbf{M} - \\lambda\\mathbf{I}) = 0$, where $\\mathbf{M}$ is the coefficient matrix and $\\mathbf{I}$ is the identity matrix.\n$$\n\\det \\begin{pmatrix} -\\lambda & a \\\\ -\\nu k^{2} & -\\eta - \\lambda \\end{pmatrix} = 0\n$$\nExpanding the determinant gives the characteristic polynomial:\n$$\n(-\\lambda)(-\\eta - \\lambda) - (a)(-\\nu k^{2}) = 0\n$$\n$$\n\\lambda^{2} + \\eta\\lambda + a\\nu k^{2} = 0\n$$\nThis is a quadratic equation for the eigenvalues $\\lambda$. We can solve for $\\lambda$ using the quadratic formula, $\\lambda = \\frac{-b \\pm \\sqrt{b^{2}-4ac}}{2a}$, with coefficients $a=1$, $b=\\eta$, and $c=a\\nu k^{2}$.\n$$\n\\lambda = \\frac{-\\eta \\pm \\sqrt{\\eta^{2} - 4(1)(a\\nu k^{2})}}{2(1)}\n$$\n$$\n\\lambda = -\\frac{\\eta}{2} \\pm \\frac{1}{2}\\sqrt{\\eta^{2} - 4a\\nu k^{2}}\n$$\nThus, the two temporal eigenvalues governing the homogeneous dynamics are:\n$$\n\\lambda_{1} = -\\frac{\\eta}{2} + \\frac{1}{2}\\sqrt{\\eta^{2} - 4a\\nu k^{2}}\n$$\n$$\n\\lambda_{2} = -\\frac{\\eta}{2} - \\frac{1}{2}\\sqrt{\\eta^{2} - 4a\\nu k^{2}}\n$$\nThe role of the damping parameter $\\eta > 0$ can be understood from these eigenvalues. The real part of both eigenvalues is controlled by $-\\frac{\\eta}{2}$. Since $\\eta$ is positive, this term is always negative, ensuring that the amplitude of any transient solution decays exponentially with time, i.e., $\\lim_{t\\to\\infty} e^{\\lambda t} \\to 0$. The term under the square root, the discriminant $\\Delta = \\eta^{2} - 4a\\nu k^{2}$, determines the nature of the decay.\n- If $\\eta^{2} > 4a\\nu k^{2}$ (overdamped), both eigenvalues are real and negative. The system returns to equilibrium as a sum of two decaying exponentials without oscillation.\n- If $\\eta^{2} = 4a\\nu k^{2}$ (critically damped), there is one repeated real negative eigenvalue, $\\lambda = -\\frac{\\eta}{2}$. This corresponds to the fastest possible decay without oscillations.\n- If $\\eta^{2} < 4a\\nu k^{2}$ (underdamped), the eigenvalues form a complex conjugate pair, $\\lambda = -\\frac{\\eta}{2} \\pm i\\omega$, where $\\omega = \\frac{1}{2}\\sqrt{4a\\nu k^{2} - \\eta^{2}}$. The transient solution exhibits damped oscillations with decay rate $\\frac{\\eta}{2}$ and angular frequency $\\omega$.\n\nNext, we derive the steady-state value $\\beta_{\\ast}$ as $t\\to\\infty$ in the presence of the constant source $S$. In the steady state, the system is time-independent, meaning all time derivatives are zero. Let $\\beta_{\\ast}$ and $B_{\\ast}$ denote the steady-state values of $\\beta(t)$ and $B(t)$, respectively.\n$$\n\\partial_{t}\\beta(t) \\to 0 \\quad \\text{and} \\quad \\partial_{t}B(t) \\to 0 \\quad \\text{as} \\quad t\\to\\infty\n$$\nSubstituting these conditions into the original inhomogeneous system gives a pair of algebraic equations:\n$$\n0 = a B_{\\ast}\n$$\n$$\n0 = -\\nu k^{2}\\beta_{\\ast} - \\eta B_{\\ast} + S\n$$\nFrom the first equation, since the problem states $a > 0$, we must have:\n$$\nB_{\\ast} = 0\n$$\nSubstituting $B_{\\ast} = 0$ into the second equation:\n$$\n0 = -\\nu k^{2}\\beta_{\\ast} - \\eta(0) + S\n$$\n$$\n0 = -\\nu k^{2}\\beta_{\\ast} + S\n$$\nSolving for the steady-state value $\\beta_{\\ast}$:\n$$\n\\nu k^{2}\\beta_{\\ast} = S\n$$\n$$\n\\beta_{\\ast} = \\frac{S}{\\nu k^{2}}\n$$\nThis expression shows that the steady-state value $\\beta_{\\ast}$ depends on the source term $S$, the effective propagation speed parameter $\\nu$, and the wavenumber $k$. Importantly, the damping parameter $\\eta$ has no influence on the final steady-state value. Its role is confined to governing the dynamics of the transient phase, i.e., how the system approaches the steady state. The steady state itself is determined by the balance between the source $S$ and the hyperbolic term $-\\nu k^2\\beta$.\n\nIn summary, we have derived the two temporal eigenvalues for the homogeneous system and the steady-state value for the shift component $\\beta$ in the presence of a source.", "answer": "$$\n\\boxed{\\begin{pmatrix} -\\frac{\\eta}{2} + \\frac{1}{2}\\sqrt{\\eta^{2} - 4a\\nu k^{2}} & -\\frac{\\eta}{2} - \\frac{1}{2}\\sqrt{\\eta^{2} - 4a\\nu k^{2}} & \\frac{S}{\\nu k^{2}} \\end{pmatrix}}\n$$", "id": "3479951"}, {"introduction": "During long and computationally expensive simulations of phenomena like binary black hole mergers, it is crucial to have diagnostic tools that can monitor the \"health\" of the gauge in real-time. Such diagnostics must intelligently condense complex, multi-component field data across the entire grid into simple, interpretable scalar metrics that can flag undesirable behavior. This practice challenges you to design and implement such a tool—a \"gauge thermometer\"—from fundamental principles [@problem_id:3479919]. By constructing a weighted, normalized quantity from synthetic field data, you will gain hands-on experience in translating abstract physical requirements into a concrete and practical computational tool for monitoring numerical relativity simulations.", "problem": "Construct a self-contained program that computes, for a set of synthetic one-dimensional fields, a dimensionless scalar diagnostic that flags unhealthy gauge dynamics in the moving puncture gauge conditions used in numerical relativity. Begin from the following foundational elements and definitions.\n\nIn the Baumgarte–Shapiro–Shibata–Nakamura (BSSN) formulation, the moving puncture gauge combines $1+\\log$ slicing for the lapse function $\\alpha$ and a Gamma-driver condition for the shift vector $\\beta^i$. Schematically, $\\partial_t \\alpha$ and $\\partial_t \\beta^i$ encode the time response of gauge degrees of freedom, while the conformal connection functions $\\tilde{\\Gamma}^i$ monitor spatial gauge behavior. A synthetic scalar “gauge thermometer” $T$ shall incorporate these quantities. You must construct $T$ so that it satisfies all of the following properties:\n\n- It is dimensionless.\n- It vanishes when all gauge activity proxies $\\partial_t \\alpha$, $\\partial_t \\beta^i$, and $\\tilde{\\Gamma}^i$ are identically zero.\n- It increases monotonically as the amplitudes of $\\partial_t \\alpha$, $\\partial_t \\beta^i$, and $\\tilde{\\Gamma}^i$ increase.\n- It equals $1$ when the fields match a specified baseline configuration.\n\nUse the discrete $L^2$ norm on a uniform grid to combine components. For a scalar field $f(x)$ sampled on points $x_j$ with spacing $\\Delta x$, define\n$$\\|f\\|_2 \\equiv \\sqrt{\\Delta x \\sum_{j=0}^{N-1} f(x_j)^2}.$$\nFor a vector field $v^i(x)$ with components $v^x, v^y, v^z$ sampled on the same grid, define\n$$\\|v^i\\|_2 \\equiv \\sqrt{\\Delta x \\sum_{j=0}^{N-1} \\left( v^x(x_j)^2 + v^y(x_j)^2 + v^z(x_j)^2 \\right)}.$$\n\nConstruct the synthetic fields on a domain of length $L$ with $N$ points:\n- Let $L = 1$ and $N = 10001$, so $\\Delta x = L/(N-1)$ and $x_j = j \\Delta x$ for $j \\in \\{0,1,\\dots,N-1\\}$.\n- Choose wavenumber $k = 2\\pi/L$.\n- For given amplitudes $A_\\alpha$, $A_\\beta$, and $G$, define the synthetic fields:\n  $$\n  \\partial_t \\alpha(x) = A_\\alpha \\,\\sin(k x),\n  $$\n  $$\n  \\partial_t \\beta^x(x) = A_\\beta \\,\\cos(k x), \\quad \\partial_t \\beta^y(x) = A_\\beta \\,\\sin(2 k x), \\quad \\partial_t \\beta^z(x) = 0,\n  $$\n  $$\n  \\tilde{\\Gamma}^x(x) = G \\,\\sin(k x), \\quad \\tilde{\\Gamma}^y(x) = G \\,\\cos(2 k x), \\quad \\tilde{\\Gamma}^z(x) = 0.\n  $$\n- Use weights $w_\\alpha = 2$, $w_\\beta = 1$, and $w_\\Gamma = 0.5$ to form a weighted gauge activity density at each grid point,\n  $$\n  e(x_j) = w_\\alpha \\left[\\partial_t \\alpha(x_j)\\right]^2 + w_\\beta \\left( \\left[\\partial_t \\beta^x(x_j)\\right]^2 + \\left[\\partial_t \\beta^y(x_j)\\right]^2 + \\left[\\partial_t \\beta^z(x_j)\\right]^2 \\right) + w_\\Gamma \\left( \\left[\\tilde{\\Gamma}^x(x_j)\\right]^2 + \\left[\\tilde{\\Gamma}^y(x_j)\\right]^2 + \\left[\\tilde{\\Gamma}^z(x_j)\\right]^2 \\right).\n  $$\n- Define the baseline amplitudes $A_\\alpha^{\\mathrm{ref}} = 1$, $A_\\beta^{\\mathrm{ref}} = 1$, and $G^{\\mathrm{ref}} = 1$, and construct the corresponding baseline density $e_{\\mathrm{ref}}(x_j)$ using the same formulas with the baseline amplitudes.\n\nFrom these definitions, derive and implement a dimensionless thermometer $T$ that satisfies the properties above by comparing the total weighted activity to its baseline value. Let $\\tau = 1.5$ be the threshold; define the unhealthy-gauge flag as $\\text{unhealthy} = (T \\ge \\tau)$.\n\nTest Suite:\nEvaluate the thermometer for the following five amplitude triplets $(A_\\alpha, A_\\beta, G)$:\n1. $(0.8, 0.7, 0.9)$ (a typical “happy path” case with moderate activity),\n2. $(1.5, 1.5, 1.5)$ (a boundary case intended to produce $T \\approx \\tau$),\n3. $(0, 0, 0)$ (an edge case with no activity),\n4. $(3, 3, 3)$ (a strong-activity case),\n5. $(1.0, 1.0, 3.0)$ (anisotropic increase in $\\tilde{\\Gamma}^i$ only).\n\nFinal Output Format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each entry is a boolean indicating whether the corresponding test case is unhealthy (i.e., $T \\ge \\tau$). For example, produce output in the form $[\\text{result}_1,\\text{result}_2,\\dots,\\text{result}_5]$. No physical units are involved; all quantities are unitless. Angles are in radians by construction.", "solution": "The problem requires the derivation and implementation of a dimensionless gauge thermometer, $T$, for diagnosing gauge dynamics in numerical relativity simulations. The derivation must satisfy a set of specified properties.\n\n**1. Derivation of the Gauge Thermometer $T$**\n\nWe are given the following:\n- A set of gauge activity proxy fields: the time derivative of the lapse, $\\partial_t \\alpha$, the time derivative of the shift vector, $\\partial_t \\beta^i$, and the conformal connection functions, $\\tilde{\\Gamma}^i$.\n- A weighted gauge activity density at each grid point $x_j$:\n$$\ne(x_j) = w_\\alpha \\left[\\partial_t \\alpha(x_j)\\right]^2 + w_\\beta \\left( \\left[\\partial_t \\beta^x(x_j)\\right]^2 + \\left[\\partial_t \\beta^y(x_j)\\right]^2 + \\left[\\partial_t \\beta^z(x_j)\\right]^2 \\right) + w_\\Gamma \\left( \\left[\\tilde{\\Gamma}^x(x_j)\\right]^2 + \\left[\\tilde{\\Gamma}^y(x_j)\\right]^2 + \\left[\\tilde{\\Gamma}^z(x_j)\\right]^2 \\right)\n$$\n- A baseline configuration defined by amplitudes $A_\\alpha^{\\mathrm{ref}} = 1$, $A_\\beta^{\\mathrm{ref}} = 1$, and $G^{\\mathrm{ref}} = 1$.\n\nThe problem states that $T$ should be derived by \"comparing the total weighted activity to its baseline value.\" The total weighted activity, let's call it $\\mathcal{E}$, is the integral of the activity density $e(x)$ over the spatial domain. In its discrete form, this is:\n$$\n\\mathcal{E} = \\Delta x \\sum_{j=0}^{N-1} e(x_j)\n$$\nLet $\\mathcal{E}_{\\mathrm{ref}}$ be the total weighted activity for the baseline configuration. A simple comparison that satisfies the dimensionless property is the ratio $\\mathcal{E}/\\mathcal{E}_{\\mathrm{ref}}$. Let us check if $T = \\mathcal{E}/\\mathcal{E}_{\\mathrm{ref}}$ satisfies all required properties.\n1.  **Dimensionless**: Yes, it's a ratio of two quantities with the same dimensions.\n2.  **Vanishes for zero activity**: If all amplitudes are zero, $e(x_j)=0$ for all $j$, so $\\mathcal{E}=0$ and $T=0$. Yes.\n3.  **Monotonically increasing**: Since $e(x_j)$ is a sum of squares of fields, which are themselves linear in the amplitudes $A_\\alpha, A_\\beta, G$, the total activity $\\mathcal{E}$ is a positive-definite quadratic form of the amplitudes. Thus, it increases as any amplitude increases (assuming positive amplitudes). Yes.\n4.  **$T=1$ at baseline**: When the fields are generated with baseline amplitudes, $\\mathcal{E} = \\mathcal{E}_{\\mathrm{ref}}$, so $T = 1$. Yes.\n\nThis definition appears valid. However, the problem provides a hint: test case $2$, with amplitudes $(1.5, 1.5, 1.5)$, is \"intended to produce $T \\approx \\tau = 1.5$\".\nLet's see what $T = \\mathcal{E}/\\mathcal{E}_{\\mathrm{ref}}$ gives for this case. Since all fields are linear in their respective amplitudes, and $\\mathcal{E}$ is quadratic, if all amplitudes are scaled by a factor $s$ (i.e., $A_\\alpha = s A_\\alpha^{\\mathrm{ref}}$, $A_\\beta = s A_\\beta^{\\mathrm{ref}}$, $G = s G^{\\mathrm{ref}}$), then $\\mathcal{E}$ scales by $s^2$.\n$$\n\\mathcal{E}(s\\mathbf{A}^{\\mathrm{ref}}) = s^2 \\mathcal{E}(\\mathbf{A}^{\\mathrm{ref}}) = s^2 \\mathcal{E}_{\\mathrm{ref}}\n$$\nSo, for this special case, $T = \\mathcal{E}/\\mathcal{E}_{\\mathrm{ref}} = s^2$. For test case $2$, $s=1.5$, which yields $T = 1.5^2 = 2.25$. This is not close to $\\tau=1.5$.\n\nThis suggests an alternative definition for $T$ that also satisfies the four properties. Consider:\n$$\nT = \\sqrt{\\frac{\\mathcal{E}}{\\mathcal{E}_{\\mathrm{ref}}}}\n$$\nLet's re-check the properties for this new definition:\n1.  **Dimensionless**: Yes, the ratio is dimensionless, and so is its square root.\n2.  **Vanishes for zero activity**: If $\\mathcal{E}=0$, then $T=0$. Yes.\n3.  **Monotonically increasing**: Since $\\mathcal{E}$ is monotonic and the square root function is monotonic for non-negative arguments, $T$ is also monotonic. Yes.\n4.  **$T=1$ at baseline**: If $\\mathcal{E} = \\mathcal{E}_{\\mathrm{ref}}$, then $T = \\sqrt{1} = 1$. Yes.\n\nThis definition also satisfies all properties. Now let's check it against the hint for test case $2$. With uniform scaling by $s=1.5$, we have:\n$$\nT = \\sqrt{\\frac{s^2 \\mathcal{E}_{\\mathrm{ref}}}{\\mathcal{E}_{\\mathrm{ref}}}} = \\sqrt{s^2} = |s|\n$$\nFor $s=1.5$, this gives $T=1.5$, which equals $\\tau$. This strongly indicates that $T = \\sqrt{\\mathcal{E}/\\mathcal{E}_{\\mathrm{ref}}}$ is the intended formula. The total activity $\\mathcal{E}$ is an energy-like quantity (quadratic in field amplitudes), while the diagnostic $T$ is normalized to be a field-like quantity (linear in field amplitudes, for uniform scaling).\n\nThe factor $\\Delta x$ in $\\mathcal{E}$ and $\\mathcal{E}_{\\mathrm{ref}}$ cancels in the ratio. Therefore, we can compute $T$ as:\n$$\nT = \\sqrt{\\frac{\\sum_{j=0}^{N-1} e(x_j)}{\\sum_{j=0}^{N-1} e_{\\mathrm{ref}}(x_j)}}\n$$\n\n**2. Implementation Strategy**\n\nThe implementation will follow these steps:\n1.  Define all physical and numerical constants ($L, N, w_\\alpha, w_\\beta, w_\\Gamma, \\tau$, and the baseline amplitudes).\n2.  Create a helper function that, given a set of amplitudes $(A_\\alpha, A_\\beta, G)$, computes the total activity sum $\\sum e(x_j)$. This function will:\n    a.  Generate the spatial grid $x_j$.\n    b.  Calculate the wavenumber $k$.\n    c.  Generate the six synthetic field components as NumPy arrays.\n    d.  Compute the activity density $e(x_j)$ at each grid point.\n    e.  Return the sum of the activity density array.\n3.  Call this helper function with the baseline amplitudes $(1, 1, 1)$ to compute the reference total activity, $\\sum e_{\\mathrm{ref}}(x_j)$.\n4.  Iterate through the specified test cases. For each case:\n    a.  Call the helper function with the test case amplitudes to get its total activity, $\\sum e(x_j)$.\n    b.  Calculate the thermometer $T$ using the derived formula.\n    c.  Compare $T$ with the threshold $\\tau=1.5$ to determine the `unhealthy` flag (True/False).\n5.  Collect the boolean results and format them into the required output string.\n\nThe use of NumPy for array operations will make the implementation concise and efficient.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes a gauge health diagnostic for a set of synthetic fields\n    in numerical relativity.\n    \"\"\"\n    # Define physical and numerical parameters from the problem statement.\n    L = 1.0\n    N = 10001\n    w_alpha = 2.0\n    w_beta = 1.0\n    w_gamma = 0.5\n    tau = 1.5\n\n    # Baseline amplitudes for the reference configuration.\n    ref_amplitudes = (1.0, 1.0, 1.0) # (A_alpha^ref, A_beta^ref, G^ref)\n\n    # Test cases: sets of (A_alpha, A_beta, G)\n    test_cases = [\n        (0.8, 0.7, 0.9),\n        (1.5, 1.5, 1.5),\n        (0.0, 0.0, 0.0),\n        (3.0, 3.0, 3.0),\n        (1.0, 1.0, 3.0),\n    ]\n\n    # Grid setup\n    x = np.linspace(0, L, N)\n    k = 2.0 * np.pi / L\n\n    def compute_total_activity(amplitudes):\n        \"\"\"\n        Calculates the total integrated gauge activity for a given set of amplitudes.\n        The integration factor dx cancels in the final ratio for T, so we\n        compute the sum of the density e(x_j).\n        \"\"\"\n        A_alpha, A_beta, G = amplitudes\n\n        # Generate synthetic fields based on the given amplitudes.\n        # Time derivative of lapse alpha\n        dt_alpha = A_alpha * np.sin(k * x)\n\n        # Time derivative of shift vector beta^i\n        dt_betax = A_beta * np.cos(k * x)\n        dt_betay = A_beta * np.sin(2 * k * x)\n        # dt_betaz is zero per problem spec, so it can be omitted from sums.\n\n        # Conformal connection functions Gamma_tilde^i\n        Gamma_tildex = G * np.sin(k * x)\n        Gamma_tildey = G * np.cos(2 * k * x)\n        # Gamma_tildez is zero per problem spec.\n\n        # Calculate the weighted gauge activity density e(x) at each grid point.\n        e_density = (\n            w_alpha * dt_alpha**2\n            + w_beta * (dt_betax**2 + dt_betay**2)\n            + w_gamma * (Gamma_tildex**2 + Gamma_tildey**2)\n        )\n\n        # The total activity is the sum over the grid.\n        return np.sum(e_density)\n\n    # Calculate the total activity for the baseline reference configuration.\n    total_activity_ref = compute_total_activity(ref_amplitudes)\n\n    results = []\n    for case_amplitudes in test_cases:\n        # Calculate total activity for the current test case.\n        total_activity_case = compute_total_activity(case_amplitudes)\n\n        # The denominator cannot be zero given the reference amplitudes are non-zero.\n        if total_activity_ref == 0:\n            # This case should not be reached with the given problem parameters.\n            # If ref activity is zero, any non-zero activity is infinitely unhealthy.\n            T = float('inf') if total_activity_case > 0 else 0.0\n        else:\n            # Define the thermometer T as the square root of the ratio of activities.\n            # This makes T scale linearly with amplitude for uniform scalings.\n            T = np.sqrt(total_activity_case / total_activity_ref)\n\n        # Determine if the gauge condition is unhealthy.\n        is_unhealthy = (T >= tau)\n        results.append(is_unhealthy)\n\n    # Format the final output as a comma-separated list of lowercase booleans.\n    output_str = f\"[{','.join(str(r).lower() for r in results)}]\"\n    print(output_str)\n\nsolve()\n```", "id": "3479919"}]}