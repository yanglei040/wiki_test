{"hands_on_practices": [{"introduction": "To begin our hands-on exploration, we will derive a fundamental invariant of the 1+log slicing condition. This exercise [@problem_id:3462440] demonstrates how the choice of gauge directly couples the evolution of the lapse function, $\\alpha$, to the spatial volume element, $\\sqrt{\\gamma}$. Understanding this direct relationship is the first step toward appreciating the condition's powerful singularity-avoiding properties.", "problem": "Consider a vacuum region of spacetime described by the $3+1$ decomposition of General Relativity (GR), with spatial metric $g_{ij}$, spatial metric determinant $\\gamma \\equiv \\det(g_{ij})$, lapse function $\\alpha$, and extrinsic curvature $K_{ij}$ with trace $K \\equiv g^{ij} K_{ij}$. Work in coordinates with vanishing shift vector $\\beta^{i} = 0$ so that observers are comoving with the hypersurface normals. The Arnowitt-Deser-Misner (ADM) evolution equation for the spatial metric in this gauge is $ \\partial_{t} g_{ij} = - 2 \\alpha K_{ij} $, and the computational gauge condition is the so-called $1+\\log$ slicing, defined by $ \\partial_{t} \\alpha = - 2 \\alpha K $. Assume smooth initial data such that at $t=0$ the lapse is $\\alpha(t=0) = 1$ and the spatial metric determinant is a positive value $\\gamma(t=0) \\equiv \\gamma_{0} > 0$. A small-amplitude, compactly supported perturbation propagates through the domain, and you may assume the perturbation remains weak so that nonlinear blow-up effects do not occur and the gauge condition remains valid throughout the evolution.\n\nStarting from the fundamental relations stated above, derive a time-invariant combination of the lapse and the spatial metric determinant implied by the coupled gauge and ADM evolution. Use this invariant to determine the constant fixed by the initial data. Finally, use the invariant to predict the asymptotic form of the lapse for small perturbations that disperse, expressed directly in terms of the instantaneous determinant $\\gamma(t)$ and the initial determinant $\\gamma_{0}$.\n\nYour final answer must be a single closed-form analytic expression for the lapse $\\alpha(t)$ in terms of $\\gamma(t)$ and $\\gamma_{0}$. No numerical evaluation or rounding is required.", "solution": "The problem is valid. It is a well-posed Meticulous and exacting professor in the STEM fields problem in numerical relativity based on the standard Arnowitt-Deser-Misner (ADM) formalism and a common gauge choice. All given information is scientifically grounded and sufficient for a unique derivation.\n\nThe goal is to find a time-invariant quantity derived from the given evolution equations and then use it to express the lapse function $\\alpha(t)$ in terms of the spatial metric determinant $\\gamma(t)$ and its initial value $\\gamma_0$.\n\nThe problem provides two fundamental evolution equations within the $3+1$ decomposition of spacetime. The first is the gauge condition, known as the $1+\\log$ slicing condition, which governs the evolution of the lapse function $\\alpha$:\n$$\n\\partial_{t} \\alpha = - 2 \\alpha K\n$$\nHere, $K \\equiv g^{ij} K_{ij}$ is the trace of the extrinsic curvature $K_{ij}$, and we are working in a gauge with a vanishing shift vector, $\\beta^i=0$.\n\nThe second equation describes the time evolution of the spatial metric $g_{ij}$:\n$$\n\\partial_{t} g_{ij} = - 2 \\alpha K_{ij}\n$$\n\nTo find a relationship between $\\alpha$ and the determinant of the spatial metric, $\\gamma \\equiv \\det(g_{ij})$, we must first find the evolution equation for $\\gamma$. We use Jacobi's formula for the derivative of a determinant: for a time-dependent matrix $M(t)$, its determinant $\\det(M)$ evolves as\n$$\n\\frac{d}{dt} \\det(M) = \\det(M) \\text{Tr}\\left(M^{-1} \\frac{dM}{dt}\\right)\n$$\nApplying this formula to the spatial metric $g_{ij}$, we have $M = g_{ij}$, $\\det(M) = \\gamma$, and $M^{-1} = g^{ij}$. The trace operation involves contracting the matrix product. Thus, the evolution of $\\gamma$ is given by:\n$$\n\\partial_{t} \\gamma = \\gamma g^{ij} (\\partial_{t} g_{ij})\n$$\nWe can now substitute the given ADM evolution equation for $\\partial_{t} g_{ij}$:\n$$\n\\partial_{t} \\gamma = \\gamma g^{ij} (- 2 \\alpha K_{ij})\n$$\nFactoring out the scalar quantities $-2\\alpha$ from the contraction gives:\n$$\n\\partial_{t} \\gamma = - 2 \\alpha \\gamma (g^{ij} K_{ij})\n$$\nBy definition, the trace of the extrinsic curvature is $K = g^{ij} K_{ij}$. Substituting this into the equation for $\\partial_t \\gamma$ yields:\n$$\n\\partial_{t} \\gamma = - 2 \\alpha \\gamma K\n$$\nThis equation describes the evolution of the spatial volume element. An alternative and more convenient form is obtained by considering the evolution of the natural logarithm of $\\gamma$:\n$$\n\\partial_{t} (\\ln \\gamma) = \\frac{1}{\\gamma} \\partial_{t} \\gamma = \\frac{1}{\\gamma} (- 2 \\alpha \\gamma K) = -2 \\alpha K\n$$\nSo, we have derived the following system of coupled ordinary differential equations for $\\alpha(t)$ and $\\gamma(t)$ at any spatial point:\n1.  $\\partial_{t} \\alpha = - 2 \\alpha K$ (Gauge condition)\n2.  $\\partial_{t} (\\ln \\gamma) = - 2 \\alpha K$ (Derived from ADM evolution)\n\nBy comparing these two equations, we immediately see that their right-hand sides are identical:\n$$\n\\partial_{t} \\alpha = \\partial_{t} (\\ln \\gamma)\n$$\nThis implies that the time derivative of their difference is zero:\n$$\n\\partial_{t} (\\alpha - \\ln \\gamma) = 0\n$$\nThis means that the quantity $(\\alpha - \\ln \\gamma)$ is a constant in time, i.e., it is a time-invariant combination of the lapse and the metric determinant.\n$$\n\\alpha(t) - \\ln(\\gamma(t)) = C\n$$\nwhere $C$ is a constant of integration.\n\nThe problem asks to determine this constant using the provided initial data. At time $t=0$, we are given $\\alpha(t=0) = 1$ and $\\gamma(t=0) = \\gamma_0$. We can evaluate the constant $C$ at $t=0$:\n$$\nC = \\alpha(0) - \\ln(\\gamma(0)) = 1 - \\ln(\\gamma_0)\n$$\nNow we have the full time-invariant relation:\n$$\n\\alpha(t) - \\ln(\\gamma(t)) = 1 - \\ln(\\gamma_0)\n$$\nThe final step is to solve this equation for the lapse function $\\alpha(t)$ to express it in terms of the instantaneous determinant $\\gamma(t)$ and the initial determinant $\\gamma_0$. Rearranging the equation, we find:\n$$\n\\alpha(t) = 1 + \\ln(\\gamma(t)) - \\ln(\\gamma_0)\n$$\nUsing the property of logarithms $\\ln(a) - \\ln(b) = \\ln(a/b)$, we can write the final expression in a more compact form:\n$$\n\\alpha(t) = 1 + \\ln\\left(\\frac{\\gamma(t)}{\\gamma_0}\\right)\n$$\nThis expression gives the value of the lapse function at any time $t$ as a function of the spatial metric determinant at that same time and the initial value of the determinant. The assumption that perturbations are small and disperse ensures that the spacetime evolution is well-behaved and that the gauge condition remains valid, thus guaranteeing the validity of this relation throughout the evolution.", "answer": "$$\n\\boxed{1 + \\ln\\left(\\frac{\\gamma(t)}{\\gamma_0}\\right)}\n$$", "id": "3462440"}, {"introduction": "Having established the analytical relationship between the lapse and the metric determinant, we now explore its profound physical consequences. This practice [@problem_id:3462400] contrasts 1+log slicing with the more traditional harmonic slicing in the context of a collapsing spacetime, a simplified model for black hole formation. By calculating the coordinate time to reach the singularity in both cases, you will directly observe the 'lapse-collapsing' and 'time-slowing' behavior that makes 1+log slicing so effective for stable, long-term black hole simulations.", "problem": "Consider a spatially homogeneous, isotropic collapsing region modeled by a spatially flat Friedmann–Lemaître–Robertson–Walker geometry written in an Arnowitt–Deser–Misner (ADM) decomposition with vanishing shift. Let the spatial metric be $\\gamma_{ij}(t) = a^{2}(\\tau)\\,\\delta_{ij}$, where the proper time $\\tau$ along the normal observers is related to the coordinate time $t$ by $\\mathrm{d}\\tau = \\alpha(t)\\,\\mathrm{d}t$ with lapse $\\alpha(t) > 0$. Assume the matter content is pressureless dust so that, near a curvature singularity reached at proper time $\\tau_{s}$, the scale factor behaves as the well-tested leading-order law $a(\\tau) \\propto (\\tau_{s} - \\tau)^{2/3}$. Use the $3+1$ definitions $K_{ij} = -\\tfrac{1}{2\\alpha}\\,\\partial_{t}\\gamma_{ij}$ and $K = \\gamma^{ij}K_{ij}$, and the Bona–Massó slicing family in zero shift,\n$$\\partial_{t}\\alpha = -\\,\\alpha^{2}\\,f(\\alpha)\\,\\bigl(K - K_{0}\\bigr),$$\nwith $K_{0} = 0$. Take harmonic slicing to correspond to $f(\\alpha) = 1$ and the standard $1+\\log$ slicing to correspond to $f(\\alpha) = 2/\\alpha$.\n\nImpose the initial conditions $\\alpha(\\tau_{0}) = \\alpha_{0} > 0$ and $t(\\tau_{0}) = 0$ for some proper time $\\tau_{0}  \\tau_{s}$. Work in the homogeneous sector so that $K$ depends only on $\\tau$.\n\nTasks:\n- Derive $K(\\tau)$ in terms of the proper-time Hubble rate $H(\\tau) = a'(\\tau)/a(\\tau)$, where $' = \\mathrm{d}/\\mathrm{d}\\tau$, and use the dust behavior to find the leading-order $\\tau$-dependence of $K(\\tau)$ near $\\tau_{s}$.\n- Using harmonic slicing, integrate the lapse evolution equation to obtain an explicit expression $\\alpha_{\\mathrm{harm}}(\\tau)$ that satisfies $\\alpha_{\\mathrm{harm}}(\\tau_{0}) = \\alpha_{0}$.\n- Define the coordinate time by $\\mathrm{d}t/\\mathrm{d}\\tau = 1/\\alpha$. For harmonic slicing, determine the coefficient $C_{\\mathrm{harm}}$ of the leading divergence of $t(\\tau)$ as $\\tau \\to \\tau_{s}^{-}$ via\n$$C_{\\mathrm{harm}} \\equiv \\lim_{\\tau \\to \\tau_{s}^{-}} (\\tau_{s} - \\tau)\\,\\bigl[t_{\\mathrm{harm}}(\\tau) - t_{\\mathrm{harm}}(\\tau_{0})\\bigr].$$\n- For $1+\\log$ slicing, integrate the lapse evolution equation to obtain the proper time $\\tau_{\\mathrm{zero}} \\in (\\tau_{0},\\tau_{s})$ at which the lapse vanishes, and define the coefficient $C_{1+\\log}$ of the leading divergence of $t(\\tau)$ as $\\tau \\to \\tau_{\\mathrm{zero}}^{-}$ by\n$$C_{1+\\log} \\equiv \\lim_{\\tau \\to \\tau_{\\mathrm{zero}}^{-}} \\frac{t_{1+\\log}(\\tau)}{\\ln\\!\\bigl[1/(\\tau_{\\mathrm{zero}} - \\tau)\\bigr]}.$$\n\nExpress your final answer as a single row matrix whose entries are, in order: $\\alpha_{\\mathrm{harm}}(\\tau)$, $C_{\\mathrm{harm}}$, and $C_{1+\\log}$, all in closed form in terms of $\\alpha_{0}$, $\\tau_{0}$, and $\\tau_{s}$. No numerical evaluation is required, and no units are needed in the final answer.", "solution": "The problem asks for derivations related to different time-slicing conditions in the context of a collapsing, spatially flat Friedmann–Lemaître–Robertson–Walker (FLRW) spacetime. We will address each task in sequence.\n\nFirst, we derive the relationship between the trace of the extrinsic curvature, $K$, and the proper-time Hubble rate, $H(\\tau)$. The spatial metric is given by $\\gamma_{ij}(t) = a^{2}(\\tau)\\delta_{ij}$, where $\\tau$ is the proper time along observers normal to the spatial slices. The lapse function $\\alpha(t)$ relates coordinate time $t$ and proper time $\\tau$ via $\\mathrm{d}\\tau = \\alpha(t)\\,\\mathrm{d}t$, which implies $\\frac{\\mathrm{d}t}{\\mathrm{d}\\tau} = \\frac{1}{\\alpha(t)}$. A time derivative with respect to coordinate time $t$, $\\partial_t$, can be related to a derivative with respect to proper time $\\tau$, denoted by a prime ($' = \\mathrm{d}/\\mathrm{d}\\tau$), using the chain rule:\n$$ \\partial_{t} = \\frac{\\mathrm{d}\\tau}{\\mathrm{d}t}\\frac{\\mathrm{d}}{\\mathrm{d}\\tau} = \\alpha \\frac{\\mathrm{d}}{\\mathrm{d}\\tau} $$\nThe extrinsic curvature is defined as $K_{ij} = -\\frac{1}{2\\alpha}\\partial_{t}\\gamma_{ij}$. With a vanishing shift vector, this is the correct definition. We compute the time derivative of the spatial metric:\n$$ \\partial_{t}\\gamma_{ij} = \\alpha \\frac{\\mathrm{d}}{\\mathrm{d}\\tau} (a^{2}(\\tau)\\delta_{ij}) = \\alpha (2 a(\\tau) a'(\\tau)) \\delta_{ij} $$\nSubstituting this into the definition of $K_{ij}$:\n$$ K_{ij} = -\\frac{1}{2\\alpha} \\left( \\alpha (2 a a') \\delta_{ij} \\right) = - a a' \\delta_{ij} $$\nThe trace of the extrinsic curvature is $K = \\gamma^{ij}K_{ij}$. The inverse spatial metric is $\\gamma^{ij} = a^{-2}\\delta^{ij}$. Thus,\n$$ K = (a^{-2}\\delta^{ij})(-a a' \\delta_{ij}) = -a^{-1}a' (\\delta^{ij}\\delta_{ij}) $$\nIn $3$ spatial dimensions, the trace of the Kronecker delta is $\\delta^{ij}\\delta_{ij} = \\delta^{i}_{i} = 3$. Therefore,\n$$ K(\\tau) = -3 \\frac{a'(\\tau)}{a(\\tau)} = -3 H(\\tau) $$\nwhere $H(\\tau) = a'(\\tau)/a(\\tau)$ is the proper-time Hubble rate.\n\nNext, we find the leading-order behavior of $K(\\tau)$ near the singularity at $\\tau = \\tau_{s}$. The scale factor for a pressureless dust-dominated universe behaves as $a(\\tau) = C(\\tau_{s} - \\tau)^{2/3}$ for some constant $C$. The Hubble rate is:\n$$ H(\\tau) = \\frac{a'(\\tau)}{a(\\tau)} = \\frac{\\mathrm{d}}{\\mathrm{d}\\tau} \\ln(a(\\tau)) = \\frac{\\mathrm{d}}{\\mathrm{d}\\tau} \\left( \\ln(C) + \\frac{2}{3}\\ln(\\tau_s - \\tau) \\right) = \\frac{2}{3} \\frac{-1}{\\tau_s - \\tau} = -\\frac{2}{3(\\tau_s - \\tau)} $$\nThe trace of the extrinsic curvature near the singularity is therefore:\n$$ K(\\tau) = -3 H(\\tau) = -3 \\left(-\\frac{2}{3(\\tau_s - \\tau)}\\right) = \\frac{2}{\\tau_s - \\tau} $$\n\nNow, we solve for the lapse function $\\alpha(\\tau)$ under harmonic slicing. The Bona–Massó evolution equation for the lapse with $K_0=0$ is $\\partial_{t}\\alpha = -\\alpha^{2}f(\\alpha)K$. For harmonic slicing, $f(\\alpha) = 1$, so $\\partial_{t}\\alpha = -\\alpha^2 K$. We convert the time derivative to be with respect to $\\tau$:\n$$ \\alpha \\frac{\\mathrm{d}\\alpha}{\\mathrm{d}\\tau} = -\\alpha^{2}K \\implies \\frac{\\mathrm{d}\\alpha}{\\mathrm{d}\\tau} = -\\alpha K $$\nSubstituting $K(\\tau) = -3 a'(\\tau)/a(\\tau)$:\n$$ \\frac{\\mathrm{d}\\alpha}{\\mathrm{d}\\tau} = -\\alpha \\left(-3 \\frac{a'}{a}\\right) = 3\\alpha \\frac{a'}{a} $$\nThis is a separable differential equation:\n$$ \\frac{1}{\\alpha}\\mathrm{d}\\alpha = 3\\frac{1}{a}\\mathrm{d}a \\implies \\int \\frac{\\mathrm{d}\\alpha}{\\alpha} = \\int 3\\frac{\\mathrm{d}a}{a} \\implies \\ln(\\alpha) = 3\\ln(a) + \\text{const} $$\nThis gives $\\alpha(\\tau) = C_1 a^3(\\tau)$ for some constant $C_1$. Using the initial condition $\\alpha(\\tau_0) = \\alpha_0$, we find $\\alpha_0 = C_1 a^3(\\tau_0)$, so $C_1 = \\alpha_0/a^3(\\tau_0)$. The lapse is:\n$$ \\alpha_{\\mathrm{harm}}(\\tau) = \\alpha_0 \\left(\\frac{a(\\tau)}{a(\\tau_0)}\\right)^3 $$\nUsing the behavior $a(\\tau) \\propto (\\tau_s-\\tau)^{2/3}$, the ratio is $a(\\tau)/a(\\tau_0) = \\left(\\frac{\\tau_s-\\tau}{\\tau_s-\\tau_0}\\right)^{2/3}$. So,\n$$ \\alpha_{\\mathrm{harm}}(\\tau) = \\alpha_0 \\left[ \\left(\\frac{\\tau_s-\\tau}{\\tau_s-\\tau_0}\\right)^{2/3} \\right]^3 = \\alpha_0 \\left(\\frac{\\tau_s-\\tau}{\\tau_s-\\tau_0}\\right)^2 $$\nThis is the first required expression.\n\nNext, we calculate the coefficient $C_{\\mathrm{harm}}$. The coordinate time $t(\\tau)$ is found by integrating $\\mathrm{d}t/\\mathrm{d}\\tau = 1/\\alpha(\\tau)$. With the initial condition $t(\\tau_0) = 0$:\n$$ t_{\\mathrm{harm}}(\\tau) = \\int_{\\tau_0}^{\\tau} \\frac{\\mathrm{d}s}{\\alpha_{\\mathrm{harm}}(s)} = \\int_{\\tau_0}^{\\tau} \\frac{1}{\\alpha_0} \\left(\\frac{\\tau_s-\\tau_0}{\\tau_s-s}\\right)^2 \\mathrm{d}s = \\frac{(\\tau_s-\\tau_0)^2}{\\alpha_0} \\int_{\\tau_0}^{\\tau} \\frac{\\mathrm{d}s}{(\\tau_s-s)^2} $$\nThe integral evaluates to:\n$$ \\int_{\\tau_0}^{\\tau} (\\tau_s-s)^{-2} \\mathrm{d}s = \\left[\\frac{1}{\\tau_s-s}\\right]_{\\tau_0}^{\\tau} = \\frac{1}{\\tau_s-\\tau} - \\frac{1}{\\tau_s-\\tau_0} $$\nSo, $t_{\\mathrm{harm}}(\\tau) = \\frac{(\\tau_s-\\tau_0)^2}{\\alpha_0} \\left(\\frac{1}{\\tau_s-\\tau} - \\frac{1}{\\tau_s-\\tau_0}\\right)$. The coefficient $C_{\\mathrm{harm}}$ is defined as:\n$$ C_{\\mathrm{harm}} = \\lim_{\\tau \\to \\tau_s^{-}} (\\tau_s - \\tau) [t_{\\mathrm{harm}}(\\tau) - t_{\\mathrm{harm}}(\\tau_0)] = \\lim_{\\tau \\to \\tau_s^{-}} (\\tau_s - \\tau) t_{\\mathrm{harm}}(\\tau) $$\n$$ C_{\\mathrm{harm}} = \\lim_{\\tau \\to \\tau_s^{-}} (\\tau_s - \\tau) \\frac{(\\tau_s-\\tau_0)^2}{\\alpha_0} \\left(\\frac{1}{\\tau_s-\\tau} - \\frac{1}{\\tau_s-\\tau_0}\\right) = \\lim_{\\tau \\to \\tau_s^{-}} \\frac{(\\tau_s-\\tau_0)^2}{\\alpha_0} \\left(1 - \\frac{\\tau_s-\\tau}{\\tau_s-\\tau_0}\\right) $$\nAs $\\tau \\to \\tau_s^{-}$, the term $(\\tau_s-\\tau)/(\\tau_s-\\tau_0)$ goes to zero. Thus,\n$$ C_{\\mathrm{harm}} = \\frac{(\\tau_s-\\tau_0)^2}{\\alpha_0} $$\nThis is the second required expression.\n\nFinally, we analyze the $1+\\log$ slicing case, where $f(\\alpha) = 2/\\alpha$. The lapse evolution equation is $\\partial_t \\alpha = -\\alpha^2(2/\\alpha)K = -2\\alpha K$. Converting to a $\\tau$ derivative:\n$$ \\alpha \\frac{\\mathrm{d}\\alpha}{\\mathrm{d}\\tau} = -2\\alpha K \\implies \\frac{\\mathrm{d}\\alpha}{\\mathrm{d}\\tau} = -2K $$\nUsing $K(\\tau) = 2/(\\tau_s-\\tau)$, we have:\n$$ \\frac{\\mathrm{d}\\alpha}{\\mathrm{d}\\tau} = -2\\left(\\frac{2}{\\tau_s-\\tau}\\right) = -\\frac{4}{\\tau_s-\\tau} $$\nIntegrating from $\\tau_0$ to $\\tau$:\n$$ \\alpha(\\tau) - \\alpha(\\tau_0) = \\int_{\\tau_0}^{\\tau} \\frac{-4}{\\tau_s-s}\\mathrm{d}s = 4[\\ln(\\tau_s-s)]_{\\tau_0}^{\\tau} = 4\\ln\\left(\\frac{\\tau_s-\\tau}{\\tau_s-\\tau_0}\\right) $$\nSo, $\\alpha_{1+\\log}(\\tau) = \\alpha_0 + 4\\ln\\left(\\frac{\\tau_s-\\tau}{\\tau_s-\\tau_0}\\right)$. The lapse vanishes at $\\tau_{\\mathrm{zero}}$ when $\\alpha_{1+\\log}(\\tau_{\\mathrm{zero}}) = 0$:\n$$ 0 = \\alpha_0 + 4\\ln\\left(\\frac{\\tau_s-\\tau_{\\mathrm{zero}}}{\\tau_s-\\tau_0}\\right) \\implies -\\frac{\\alpha_0}{4} = \\ln\\left(\\frac{\\tau_s-\\tau_{\\mathrm{zero}}}{\\tau_s-\\tau_0}\\right) $$\nExponentiating both sides gives $\\exp(-\\alpha_0/4) = \\frac{\\tau_s-\\tau_{\\mathrm{zero}}}{\\tau_s-\\tau_0}$, so $\\tau_s - \\tau_{\\mathrm{zero}} = (\\tau_s-\\tau_0)\\exp(-\\alpha_0/4)$.\n\nNow we find the coefficient $C_{1+\\log}$, defined as $C_{1+\\log} = \\lim_{\\tau \\to \\tau_{\\mathrm{zero}}^{-}} \\frac{t_{1+\\log}(\\tau)}{\\ln[1/(\\tau_{\\mathrm{zero}}-\\tau)]}$.\nThis limit is of the form $\\infty/\\infty$, since $t_{1+\\log}(\\tau) = \\int_{\\tau_0}^{\\tau} \\frac{\\mathrm{d}s}{\\alpha_{1+\\log}(s)}$ diverges as $\\tau \\to \\tau_{\\mathrm{zero}}^{-}$. We apply L'Hôpital's rule:\n$$ C_{1+\\log} = \\lim_{\\tau \\to \\tau_{\\mathrm{zero}}^{-}} \\frac{\\mathrm{d}t_{1+\\log}(\\tau)/\\mathrm{d}\\tau}{\\mathrm{d}(\\ln[1/(\\tau_{\\mathrm{zero}}-\\tau)])/\\mathrm{d}\\tau} = \\lim_{\\tau \\to \\tau_{\\mathrm{zero}}^{-}} \\frac{1/\\alpha_{1+\\log}(\\tau)}{1/(\\tau_{\\mathrm{zero}}-\\tau)} = \\lim_{\\tau \\to \\tau_{\\mathrm{zero}}^{-}} \\frac{\\tau_{\\mathrm{zero}}-\\tau}{\\alpha_{1+\\log}(\\tau)} $$\nThis is of the form $0/0$. Applying L'Hôpital's rule again:\n$$ C_{1+\\log} = \\lim_{\\tau \\to \\tau_{\\mathrm{zero}}^{-}} \\frac{\\mathrm{d}(\\tau_{\\mathrm{zero}}-\\tau)/\\mathrm{d}\\tau}{\\mathrm{d}\\alpha_{1+\\log}(\\tau)/\\mathrm{d}\\tau} = \\lim_{\\tau \\to \\tau_{\\mathrm{zero}}^{-}} \\frac{-1}{\\alpha'_{1+\\log}(\\tau)} $$\nWe have $\\alpha'_{1+\\log}(\\tau) = -4/(\\tau_s-\\tau)$. Evaluating at $\\tau_{\\mathrm{zero}}$:\n$$ C_{1+\\log} = \\frac{-1}{-4/(\\tau_s-\\tau_{\\mathrm{zero}})} = \\frac{\\tau_s-\\tau_{\\mathrm{zero}}}{4} $$\nSubstituting the expression for $\\tau_s - \\tau_{\\mathrm{zero}}$:\n$$ C_{1+\\log} = \\frac{(\\tau_s-\\tau_0)\\exp(-\\alpha_0/4)}{4} $$\nThis is the third and final required expression.", "answer": "$$ \\boxed{ \\begin{pmatrix} \\alpha_{0} \\left( \\frac{\\tau_{s} - \\tau}{\\tau_{s} - \\tau_{0}} \\right)^{2}  \\frac{(\\tau_{s} - \\tau_{0})^{2}}{\\alpha_{0}}  \\frac{(\\tau_{s} - \\tau_{0})\\exp(-\\alpha_{0}/4)}{4} \\end{pmatrix} } $$", "id": "3462400"}, {"introduction": "Finally, we bridge the gap between analytical theory and computational practice by addressing a key challenge in numerical relativity: the formation of gauge shocks. This coding exercise [@problem_id:3462413] tasks you with implementing a numerical solver for the 1+log lapse equation and exploring how artificial viscosity can regulate steep gradients without corrupting the physical solution. This practice provides direct experience with the trade-offs involved in stabilizing numerical evolutions and ensuring the fidelity of simulation results.", "problem": "You are asked to design and implement a numerical experiment to quantify the minimal artificial viscosity required to avoid gauge-shock formation in the 1+log slicing condition of numerical relativity while preserving the physical content of the lapse. The setting is the $3+1$ decomposition of spacetime with lapse $\\alpha$, shift $\\beta^i$, and extrinsic curvature $K$, where the 1+log slicing condition specifies the lapse evolution by the advection-reaction partial differential equation\n$$\n\\partial_t \\alpha - \\beta^i \\partial_i \\alpha = -2\\,\\alpha\\,K.\n$$\nTo model gauge-shock avoidance, consider the augmented equation with an artificial viscosity term\n$$\n\\partial_t \\alpha - \\beta^i \\partial_i \\alpha = -2\\,\\alpha\\,K + \\nu\\,\\Delta \\alpha,\n$$\nwhere $\\nu \\ge 0$ is the artificial viscosity coefficient. Work in one spatial dimension with coordinate $x \\in [0,1]$, shift velocity $\\beta \\ge 0$, and spatially varying extrinsic curvature $K(x)$. All variables are dimensionless.\n\nYour program must implement a first-principles numerical solver based on the method of lines with explicit time stepping and monotone spatial discretizations, obeying the following requirements:\n\n- Spatial discretization:\n  - Use a uniform grid with $N$ points on $[0,1]$ and spacing $\\Delta x = 1/(N-1)$.\n  - Discretize $\\partial_x \\alpha$ by first-order upwind differencing assuming $\\beta \\ge 0$:\n    $$\n    \\left(\\partial_x \\alpha\\right)_i \\approx \\frac{\\alpha_i - \\alpha_{i-1}}{\\Delta x}.\n    $$\n  - Discretize $\\Delta \\alpha$ by the standard second-order central difference:\n    $$ \n    \\left(\\Delta \\alpha\\right)_i \\approx \\frac{\\alpha_{i+1} - 2\\alpha_i + \\alpha_{i-1}}{\\Delta x^2}.\n    $$\n  - Enforce homogeneous Neumann boundary conditions (zero gradient) at both ends by setting $\\alpha_0 = \\alpha_1$ and $\\alpha_{N-1} = \\alpha_{N-2}$ after each update.\n- Time stepping:\n  - Use explicit forward Euler:\n    $$\n    \\alpha^{n+1}_i = \\alpha^n_i + \\Delta t\\left(-\\beta\\,\\frac{\\alpha^n_i - \\alpha^n_{i-1}}{\\Delta x} - 2\\,\\alpha^n_i\\,K_i + \\nu\\,\\frac{\\alpha^n_{i+1} - 2\\alpha^n_i + \\alpha^n_{i-1}}{\\Delta x^2}\\right).\n    $$\n  - Choose the time step $\\Delta t$ adaptively to satisfy the stability and monotonicity constraints\n    $$\n    \\frac{\\beta\\,\\Delta t}{\\Delta x} \\le 0.8,\\quad \\frac{\\nu\\,\\Delta t}{\\Delta x^2} \\le 0.45,\\quad \\Delta t \\le 0.9 \\min_i \\frac{1}{2\\,K_i + \\epsilon},\n    $$\n    with $\\epsilon = 10^{-12}$ to avoid division by zero.\n  - To maintain physical plausibility, clamp the lapse after each update to the interval $[0,1.5]$; that is, set $\\alpha^{n+1}_i \\leftarrow \\min\\left(1.5,\\max(0,\\alpha^{n+1}_i)\\right)$.\n\nInitial data and extrinsic curvature profiles are defined as follows. Use the steep-profile initial lapse\n$$\n\\alpha(x,0) = 1 - A\\,\\tanh\\!\\left(\\frac{x - x_c}{\\sigma}\\right),\n$$\nwith amplitude $A \\in (0,1)$, center $x_c \\in (0,1)$, and steepness parameter $\\sigma  0$. For $K(x)$, two types of spatial profiles are used:\n\n- Piecewise constant profile with an interface at $x = x_{\\mathrm{int}}$:\n  $$\n  K(x) = \\begin{cases}\n  k_{\\mathrm{left}},  x  x_{\\mathrm{int}},\\\\\n  k_{\\mathrm{right}},  x \\ge x_{\\mathrm{int}}.\n  \\end{cases}\n  $$\n- Gaussian spike profile:\n  $$\n  K(x) = k_0 + k_{\\mathrm{spike}} \\exp\\!\\left(-\\frac{(x - x_s)^2}{\\sigma_K^2}\\right).\n  $$\n\nDefine the following quantitative metrics evaluated at a fixed final time $T$:\n\n- The maximal discrete gradient magnitude\n  $$\n  G(\\nu) = \\max_{0 \\le i  N-1} \\left|\\frac{\\alpha_\\nu(x_{i+1},T) - \\alpha_\\nu(x_i,T)}{\\Delta x}\\right|.\n  $$\n- The relative $\\ell^2$ deviation from the baseline solution at $\\nu = 0$:\n  $$\n  \\mathcal{D}(\\nu) = \\frac{\\left\\|\\alpha_\\nu(\\cdot,T) - \\alpha_0(\\cdot,T)\\right\\|_2}{\\left\\|\\alpha_0(\\cdot,T)\\right\\|_2},\n  $$\n  where the discrete $\\ell^2$ norm is $\\|u\\|_2 = \\left(\\sum_{i=0}^{N-1} u_i^2 \\,\\Delta x\\right)^{1/2}$.\n\nYour task is to determine, for each test case, the minimal artificial viscosity $\\nu_{\\min}$ that simultaneously satisfies\n$$\nG(\\nu_{\\min}) \\le G_{\\mathrm{target}} \\quad \\text{and} \\quad \\mathcal{D}(\\nu_{\\min}) \\le \\delta_{\\max}.\n$$\n\nImplement the search for $\\nu_{\\min}$ using an adaptive bracketing and bisection strategy on $\\nu \\in [0,\\nu_{\\max}]$ with a tolerance of $10^{-6}$ on $\\nu$, and return $\\nu_{\\min} = \\nu_{\\max}$ if no $\\nu \\in [0,\\nu_{\\max}]$ satisfies the criteria.\n\nTest Suite:\nProvide four test cases that span typical and edge scenarios. For each case, specify $(N,\\beta,A,\\sigma,x_c,T)$, the form and parameters of $K(x)$, and the acceptance thresholds $(G_{\\mathrm{target}},\\delta_{\\max})$, together with the search bound $\\nu_{\\max}$.\n\n- Case $1$ (general, piecewise $K$):\n  - $N = 128$, $\\beta = 0.3$, $A = 0.8$, $\\sigma = 0.02$, $x_c = 0.5$, $T = 0.2$.\n  - $K(x)$ piecewise with $x_{\\mathrm{int}} = 0.5$, $k_{\\mathrm{left}} = 0.2$, $k_{\\mathrm{right}} = 0.8$.\n  - $G_{\\mathrm{target}} = 30$, $\\delta_{\\max} = 0.1$, $\\nu_{\\max} = 0.02$.\n- Case $2$ (high advection, piecewise $K$):\n  - $N = 128$, $\\beta = 0.9$, $A = 0.7$, $\\sigma = 0.015$, $x_c = 0.5$, $T = 0.15$.\n  - $K(x)$ piecewise with $x_{\\mathrm{int}} = 0.4$, $k_{\\mathrm{left}} = 0.1$, $k_{\\mathrm{right}} = 0.5$.\n  - $G_{\\mathrm{target}} = 50$, $\\delta_{\\max} = 0.12$, $\\nu_{\\max} = 0.02$.\n- Case $3$ (no advection, piecewise $K$):\n  - $N = 128$, $\\beta = 0.0$, $A = 0.85$, $\\sigma = 0.01$, $x_c = 0.5$, $T = 0.2$.\n  - $K(x)$ piecewise with $x_{\\mathrm{int}} = 0.6$, $k_{\\mathrm{left}} = 0.3$, $k_{\\mathrm{right}} = 1.0$.\n  - $G_{\\mathrm{target}} = 25$, $\\delta_{\\max} = 0.08$, $\\nu_{\\max} = 0.02$.\n- Case $4$ (Gaussian spike in $K$):\n  - $N = 128$, $\\beta = 0.4$, $A = 0.9$, $\\sigma = 0.008$, $x_c = 0.5$, $T = 0.1$.\n  - $K(x)$ Gaussian with $k_0 = 0.2$, $k_{\\mathrm{spike}} = 1.2$, $x_s = 0.6$, $\\sigma_K = 0.03$.\n  - $G_{\\mathrm{target}} = 60$, $\\delta_{\\max} = 0.15$, $\\nu_{\\max} = 0.02$.\n\nFinal Output Format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with the minimal viscosities for the four test cases rounded to six decimal places, in the order of the cases above. For example, the output format is\n$$\n[\\nu_1,\\nu_2,\\nu_3,\\nu_4].\n$$", "solution": "The problem requires the design and implementation of a numerical experiment to determine the minimal artificial viscosity, $\\nu_{\\min}$, needed to regularize the $1+log$ slicing condition in numerical relativity. This is accomplished by solving a $1$-dimensional advection-reaction-diffusion partial differential equation (PDE) for the lapse function $\\alpha(x,t)$. The solution must satisfy specified constraints on the solution's gradient and its deviation from a baseline, non-viscous solution.\n\nThe governing PDE, augmented with an artificial viscosity term, is:\n$$\n\\partial_t \\alpha - \\beta \\partial_x \\alpha = -2\\,\\alpha\\,K(x) + \\nu\\,\\partial^2_x \\alpha\n$$\nThis equation is defined on the spatial domain $x \\in [0,1]$ with shift velocity $\\beta \\ge 0$, spatially varying extrinsic curvature $K(x)$, and artificial viscosity coefficient $\\nu \\ge 0$. The task involves implementing a numerical solver and using it within a bisection search algorithm to find $\\nu_{\\min}$ for several test cases.\n\nThe numerical solution is constructed based on the Method of Lines (MoL), where spatial derivatives are discretized first, converting the PDE into a system of Ordinary Differential Equations (ODEs) in time, which is then solved using an explicit time-stepping scheme.\n\n**1. Spatial Discretization**\n\nThe spatial domain $x \\in [0,1]$ is discretized using a uniform grid of $N$ points $x_i = i\\,\\Delta x$ for $i=0, 1, \\dots, N-1$, where the grid spacing is $\\Delta x = 1/(N-1)$. At each interior grid point $x_i$ for $i=1, \\dots, N-2$, the spatial derivatives are approximated using finite differences as specified:\n\n- The advection term, $\\beta\\,\\partial_x \\alpha$, is discretized using a first-order upwind scheme, which for $\\beta \\ge 0$ is a backward difference:\n$$\n\\beta \\left(\\partial_x \\alpha\\right)_i \\approx \\beta\\,\\frac{\\alpha_i - \\alpha_{i-1}}{\\Delta x}\n$$\n- The diffusion term, $\\nu\\,\\Delta \\alpha = \\nu\\,\\partial^2_x \\alpha$, is discretized using the standard second-order central difference stencil:\n$$\n\\nu \\left(\\Delta \\alpha\\right)_i \\approx \\nu\\,\\frac{\\alpha_{i+1} - 2\\alpha_i + \\alpha_{i-1}}{\\Delta x^2}\n$$\n- The reaction term, $-2\\,\\alpha\\,K$, is a local source term and is simply evaluated at the grid point as $-2\\,\\alpha_i\\,K_i$.\n\nSubstituting these discretizations into the PDE yields a system of ODEs for the lapse values $\\alpha_i(t)$ at the interior grid points:\n$$\n\\frac{d\\alpha_i}{dt} = -\\beta\\,\\frac{\\alpha_i - \\alpha_{i-1}}{\\Delta x} - 2\\,\\alpha_i\\,K_i + \\nu\\,\\frac{\\alpha_{i+1} - 2\\alpha_i + \\alpha_{i-1}}{\\Delta x^2} \\quad \\text{for } i=1, \\dots, N-2\n$$\n\nHomogeneous Neumann boundary conditions ($\\partial_x \\alpha = 0$) are enforced at $x=0$ and $x=1$. This is implemented by setting the lapse values at the boundary points equal to their interior neighbors after each time step: $\\alpha_0 = \\alpha_1$ and $\\alpha_{N-1} = \\alpha_{N-2}$.\n\n**2. Time Integration**\n\nThe system of ODEs is integrated in time using the explicit forward Euler method. For a time step $\\Delta t$, the value of the lapse at the next time level, $\\alpha^{n+1}$, is computed from the current level, $\\alpha^n$, as:\n$$\n\\alpha^{n+1}_i = \\alpha^n_i + \\Delta t \\left( -\\beta\\,\\frac{\\alpha^n_i - \\alpha^n_{i-1}}{\\Delta x} - 2\\,\\alpha^n_i\\,K_i + \\nu\\,\\frac{\\alpha^n_{i+1} - 2\\alpha^n_i + \\alpha^n_{i-1}}{\\Delta x^2} \\right)\n$$\nThis update is performed for all interior points $i=1, \\dots, N-2$.\n\nThe stability of this explicit scheme requires the time step $\\Delta t$ to be sufficiently small. An adaptive time step is chosen at each iteration to satisfy the Courant-Friedrichs-Lewy (CFL) conditions for the advection and diffusion parts, and a stability constraint for the reaction part:\n$$\n\\Delta t \\le \\min\\left( \\frac{0.8\\,\\Delta x}{\\beta}, \\frac{0.45\\,\\Delta x^2}{\\nu}, \\frac{0.9}{\\max_i(2\\,K_i) + \\epsilon} \\right)\n$$\nwhere $\\epsilon=10^{-12}$ is a small number to prevent division by zero. If $\\beta=0$ or $\\nu=0$, the corresponding upper bounds on $\\Delta t$ are taken to be infinite. To ensure the final time $T$ is reached exactly, the last time step is adjusted if necessary.\n\nAfter each time update, the lapse function is clamped to the physically plausible range $[0, 1.5]$ via the operation $\\alpha^{n+1}_i \\leftarrow \\min(1.5, \\max(0, \\alpha^{n+1}_i))$.\n\n**3. Search for Minimal Viscosity $\\nu_{\\min}$**\n\nThe core task is to find the minimum $\\nu \\ge 0$ in the search range $[0, \\nu_{\\max}]$ such that the solution $\\alpha_\\nu(x,T)$ satisfies two conditions simultaneously:\n1.  The maximum discrete gradient magnitude is bounded: $G(\\nu) = \\max_{i} \\left|\\frac{\\alpha_\\nu(x_{i+1},T) - \\alpha_\\nu(x_i,T)}{\\Delta x}\\right| \\le G_{\\mathrm{target}}$.\n2.  The relative $\\ell^2$ deviation from the non-viscous baseline solution ($\\nu=0$) is bounded: $\\mathcal{D}(\\nu) = \\frac{\\|\\alpha_\\nu(\\cdot,T) - \\alpha_0(\\cdot,T)\\|_2}{\\|\\alpha_0(\\cdot,T)\\|_2} \\le \\delta_{\\max}$.\n\nThe search for $\\nu_{\\min}$ is performed using a bisection algorithm. The procedure for each test case is as follows:\n1.  First, the baseline solution $\\alpha_0(\\cdot,T)$ is computed by running the simulation with $\\nu=0$.\n2.  The condition is checked for $\\nu=0$. Since $\\mathcal{D}(0)=0$, this only requires checking if $G(0) \\le G_{\\mathrm{target}}$. If true, $\\nu_{\\min}=0$.\n3.  If $\\nu=0$ is not a solution, the condition is checked for $\\nu=\\nu_{\\max}$. If it is not satisfied, no solution exists in the given range, and $\\nu_{\\min}$ is reported as $\\nu_{\\max}$.\n4.  If a solution exists in $(0, \\nu_{\\max}]$, a bisection search is initiated on the interval $[0, \\nu_{\\max}]$. Let this interval be $[L, H]$.\n5.  In each iteration, the midpoint $\\nu_{\\text{mid}} = (L+H)/2$ is evaluated. A simulation is run with $\\nu=\\nu_{\\text{mid}}$ to obtain $\\alpha_{\\text{mid}}(\\cdot,T)$, and the metrics $G(\\nu_{\\text{mid}})$ and $\\mathcal{D}(\\nu_{\\text{mid}})$ are calculated.\n6.  If both criteria are met for $\\nu_{\\text{mid}}$, it means a valid solution has been found. To find the *minimal* such value, the search continues in the lower half of the interval by setting $H = \\nu_{\\text{mid}}$.\n7.  If the criteria are not met, $\\nu_{\\text{mid}}$ is too small, and a larger viscosity is required. The search continues in the upper half by setting $L = \\nu_{\\text{mid}}$.\n8.  The process repeats until the width of the search interval $H-L$ is smaller than a specified tolerance of $10^{-6}$. The final result is the upper bound $H$, which represents the best approximation to $\\nu_{\\min}$ found.\n\nThis systematic approach guarantees a robust and precise determination of the minimal required artificial viscosity under the problem's constraints. The implementation vectorizes the spatial derivative calculations for efficiency.", "answer": "```python\nimport numpy as np\n\ndef setup_K_profile(x, k_type, k_params):\n    \"\"\"\n    Sets up the extrinsic curvature K(x) profile.\n    \n    Args:\n        x (np.ndarray): The spatial grid.\n        k_type (str): Type of profile ('piecewise' or 'gaussian').\n        k_params (tuple): Parameters for the K profile.\n\n    Returns:\n        np.ndarray: The array K(x).\n    \"\"\"\n    if k_type == 'piecewise':\n        x_int, k_left, k_right = k_params\n        K = np.full_like(x, k_right)\n        K[x  x_int] = k_left\n        return K\n    elif k_type == 'gaussian':\n        k0, k_spike, x_s, sigma_K = k_params\n        return k0 + k_spike * np.exp(-((x - x_s)**2) / sigma_K**2)\n    else:\n        raise ValueError(\"Unknown K profile type\")\n\ndef setup_initial_alpha(x, A, xc, sigma):\n    \"\"\"\n    Sets up the initial lapse profile alpha(x, 0).\n    \n    Args:\n        x (np.ndarray): The spatial grid.\n        A (float): Amplitude parameter.\n        xc (float): Center parameter.\n        sigma (float): Steepness parameter.\n\n    Returns:\n        np.ndarray: The initial alpha profile.\n    \"\"\"\n    return 1.0 - A * np.tanh((x - xc) / sigma)\n\ndef run_simulation(case_params, nu):\n    \"\"\"\n    Solves the lapse evolution equation up to time T.\n\n    Args:\n        case_params (dict): Dictionary of parameters for the simulation case.\n        nu (float): The artificial viscosity coefficient.\n\n    Returns:\n        np.ndarray: The lapse profile alpha at the final time T.\n    \"\"\"\n    N, beta, T = case_params['N'], case_params['beta'], case_params['T']\n    A, xc, sigma = case_params['A'], case_params['xc'], case_params['sigma']\n    k_type, k_params = case_params['k_type'], case_params['k_params']\n    \n    x = np.linspace(0, 1, N)\n    dx = 1.0 / (N - 1)\n\n    alpha = setup_initial_alpha(x, A, xc, sigma)\n    K = setup_K_profile(x, k_type, k_params)\n    \n    t = 0.0\n    epsilon = 1e-12\n\n    dt_react_bound = 0.9 / (2 * np.max(K) + epsilon)\n    dt_adv_bound = 0.8 * dx / beta if beta  0 else np.inf\n    K_interior = K[1:-1]\n    \n    while t  T:\n        dt_diff_bound = 0.45 * dx**2 / nu if nu  0 else np.inf\n        \n        dt = min(dt_adv_bound, dt_diff_bound, dt_react_bound)\n        if t + dt  T:\n            dt = T - t\n        \n        alpha_n = alpha.copy()\n        \n        # Vectorized update for interior points\n        alpha_c = alpha_n[1:-1]  # i\n        alpha_l = alpha_n[0:-2]  # i-1\n        alpha_r = alpha_n[2:]    # i+1\n\n        adv_term = -beta * (alpha_c - alpha_l) / dx\n        react_term = -2 * alpha_c * K_interior\n        diff_term = nu * (alpha_r - 2 * alpha_c + alpha_l) / (dx**2)\n        \n        alpha[1:-1] = alpha_c + dt * (adv_term + react_term + diff_term)\n\n        # Homogeneous Neumann boundary conditions\n        alpha[0] = alpha[1]\n        alpha[N-1] = alpha[N-2]\n        \n        # Clamping\n        np.clip(alpha, 0, 1.5, out=alpha)\n\n        t += dt\n            \n    return alpha\n\ndef check_criteria(alpha_nu, alpha_0, dx, G_target, delta_max):\n    \"\"\"\n    Checks if the solution alpha_nu satisfies the given criteria.\n\n    Args:\n        alpha_nu (np.ndarray): The solution with viscosity nu.\n        alpha_0 (np.ndarray): The baseline solution (nu=0).\n        dx (float): Grid spacing.\n        G_target (float): Target for max gradient.\n        delta_max (float): Target for relative L2 deviation.\n\n    Returns:\n        bool: True if criteria are satisfied, False otherwise.\n    \"\"\"\n    # Max gradient metric G(nu)\n    grad = np.abs(np.diff(alpha_nu) / dx)\n    G = np.max(grad)\n\n    # Relative L2 deviation D(nu)\n    norm_diff_sq = np.sum((alpha_nu - alpha_0)**2 * dx)\n    norm_base_sq = np.sum(alpha_0**2 * dx)\n    \n    D = np.sqrt(norm_diff_sq / norm_base_sq) if norm_base_sq  1e-20 else np.inf\n\n    return G = G_target and D = delta_max\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and find minimal viscosity.\n    \"\"\"\n    test_cases = [\n        # Case 1 (general, piecewise K)\n        {'N': 128, 'beta': 0.3, 'A': 0.8, 'sigma': 0.02, 'xc': 0.5, 'T': 0.2, \n         'k_type': 'piecewise', 'k_params': (0.5, 0.2, 0.8), \n         'G_target': 30, 'delta_max': 0.1, 'nu_max': 0.02},\n        # Case 2 (high advection, piecewise K)\n        {'N': 128, 'beta': 0.9, 'A': 0.7, 'sigma': 0.015, 'xc': 0.5, 'T': 0.15,\n         'k_type': 'piecewise', 'k_params': (0.4, 0.1, 0.5),\n         'G_target': 50, 'delta_max': 0.12, 'nu_max': 0.02},\n        # Case 3 (no advection, piecewise K)\n        {'N': 128, 'beta': 0.0, 'A': 0.85, 'sigma': 0.01, 'xc': 0.5, 'T': 0.2,\n         'k_type': 'piecewise', 'k_params': (0.6, 0.3, 1.0),\n         'G_target': 25, 'delta_max': 0.08, 'nu_max': 0.02},\n        # Case 4 (Gaussian spike in K)\n        {'N': 128, 'beta': 0.4, 'A': 0.9, 'sigma': 0.008, 'xc': 0.5, 'T': 0.1,\n         'k_type': 'gaussian', 'k_params': (0.2, 1.2, 0.6, 0.03),\n         'G_target': 60, 'delta_max': 0.15, 'nu_max': 0.02}\n    ]\n\n    results = []\n    tol = 1e-6\n    \n    for case in test_cases:\n        dx = 1.0 / (case['N'] - 1)\n        G_target, delta_max, nu_max = case['G_target'], case['delta_max'], case['nu_max']\n        \n        alpha_0 = run_simulation(case, 0.0)\n        \n        if check_criteria(alpha_0, alpha_0, dx, G_target, delta_max):\n            results.append(0.0)\n            continue\n            \n        alpha_nu_max = run_simulation(case, nu_max)\n        if not check_criteria(alpha_nu_max, alpha_0, dx, G_target, delta_max):\n            results.append(nu_max)\n            continue\n        \n        low, high = 0.0, nu_max\n        while high - low  tol:\n            mid = low + (high - low) / 2\n            if mid == low or mid == high:\n                break\n            \n            alpha_mid = run_simulation(case, mid)\n            if check_criteria(alpha_mid, alpha_0, dx, G_target, delta_max):\n                high = mid\n            else:\n                low = mid\n        \n        results.append(high)\n\n    print(f\"[{','.join([f'{r:.6f}' for r in results])}]\")\n\nsolve()\n```", "id": "3462413"}]}