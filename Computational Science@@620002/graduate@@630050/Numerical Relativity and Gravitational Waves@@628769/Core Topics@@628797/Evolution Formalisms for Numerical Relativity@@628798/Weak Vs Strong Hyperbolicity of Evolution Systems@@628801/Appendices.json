{"hands_on_practices": [{"introduction": "To build a solid foundation, we begin with the simplest example of a well-posed system. This exercise [@problem_id:3497855] tasks you with analyzing a basic uncoupled wave equation, which serves as the archetype for a strongly hyperbolic system. By directly computing the characteristic speeds and verifying the diagonalizability of the principal symbol, you will confirm from first principles why this system is considered mathematically robust and well-behaved.", "problem": "Consider the linear, constant-coefficient, first-order partial differential equation (PDE) system in one spatial dimension,\n$$\nu_{t} = A\\,\\partial_{x} u,\n$$\nwhere $u(x,t) \\in \\mathbb{R}^{2}$ and\n$$\nA = \\begin{pmatrix} 1 & 0 \\\\ 0 & -1 \\end{pmatrix}.\n$$\nYou will use the plane-wave ansatz and the definition of strong hyperbolicity from first principles. For the plane-wave analysis, adopt\n$$\nu(x,t) = v\\,\\exp\\!\\big(i(k x + \\omega t)\\big),\n$$\nwith $k \\in \\mathbb{R}$ the spatial wavenumber, $\\omega \\in \\mathbb{R}$ the temporal frequency, and $v \\in \\mathbb{C}^{2}$ a constant amplitude vector. Define the characteristic speeds $c$ by $c = \\omega/k$ whenever $k \\neq 0$. For strong hyperbolicity, use the definition based on the principal symbol and diagonalization: a first-order system is strongly hyperbolic if its principal symbol admits a complete set of eigenvectors with real eigenvalues and there exists an eigenvector matrix $S$ that diagonalizes the principal symbol such that the operator $2$-norm (spectral norm) condition number $\\kappa_{2}(S) = \\|S\\|_{2}\\,\\|S^{-1}\\|_{2}$ is uniformly bounded over all unit covectors in the spatial direction.\n\nWorking from these definitions alone:\n- Derive the characteristic speeds of the system by computing the dispersion relation implied by the plane-wave ansatz and relating $\\omega/k$ to the eigenvalues of $A$.\n- Verify strong hyperbolicity by explicitly exhibiting a diagonalization of the system’s principal symbol and determining a uniform bound on the operator $2$-norm condition number of the diagonalizing matrix $S$. Among all valid diagonalizations, determine the smallest uniform bound $\\kappa_{\\ast}$ you can guarantee.\n\nReport your final answer as a single row matrix $\\begin{pmatrix} c_{1} & c_{2} & \\kappa_{\\ast} \\end{pmatrix}$, where $c_{1}$ and $c_{2}$ are the characteristic speeds. No rounding is required.", "solution": "The problem is assessed as valid as it is scientifically grounded, well-posed, and objective. It is a standard exercise in the theory of first-order hyperbolic partial differential equations.\n\nThe given partial differential equation (PDE) system is:\n$$\n\\partial_{t} u = A\\,\\partial_{x} u\n$$\nwhere $u(x,t) \\in \\mathbb{R}^{2}$ and the coefficient matrix $A$ is\n$$\nA = \\begin{pmatrix} 1 & 0 \\\\ 0 & -1 \\end{pmatrix}\n$$\n\n### Derivation of Characteristic Speeds\n\nWe employ the plane-wave ansatz provided:\n$$\nu(x,t) = v\\,\\exp\\big(i(k x + \\omega t)\\big)\n$$\nwhere $v \\in \\mathbb{C}^{2}$ is a constant amplitude vector, $k \\in \\mathbb{R}$ is the spatial wavenumber, and $\\omega \\in \\mathbb{R}$ is the temporal frequency.\n\nFirst, we compute the partial derivatives of $u(x,t)$:\n$$\n\\partial_{t} u = i\\omega v\\,\\exp\\big(i(k x + \\omega t)\\big) = i\\omega u\n$$\n$$\n\\partial_{x} u = ik v\\,\\exp\\big(i(k x + \\omega t)\\big) = ik u\n$$\nSubstituting these expressions into the PDE system gives:\n$$\ni\\omega u = A(ik u)\n$$\nSince this must hold for any non-trivial solution $u$, we can divide by the non-zero scalar factor $i$ and the everywhere non-zero exponential term, yielding an algebraic equation for the amplitude vector $v$:\n$$\n\\omega v = k A v\n$$\nFor a non-trivial solution ($v \\neq 0$), this equation must hold. This can be rewritten as an eigenvalue problem:\n$$\nA v = \\frac{\\omega}{k} v\n$$\nfor $k \\neq 0$. The characteristic speeds $c$ are defined as $c = \\omega/k$. Thus, the characteristic speeds are the eigenvalues of the matrix $A$.\n\nAlternatively, we can derive the dispersion relation. Rearranging the equation $\\omega v = k A v$ gives:\n$$\n(k A - \\omega I) v = 0\n$$\nwhere $I$ is the $2 \\times 2$ identity matrix. For a non-trivial solution for $v$, the determinant of the matrix $(k A - \\omega I)$ must be zero:\n$$\n\\det(k A - \\omega I) = 0\n$$\nLet's compute this determinant:\n$$\nk A - \\omega I = k \\begin{pmatrix} 1 & 0 \\\\ 0 & -1 \\end{pmatrix} - \\omega \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix} = \\begin{pmatrix} k - \\omega & 0 \\\\ 0 & -k - \\omega \\end{pmatrix}\n$$\nThe determinant is:\n$$\n\\det\\begin{pmatrix} k - \\omega & 0 \\\\ 0 & -k - \\omega \\end{pmatrix} = (k - \\omega)(-k - \\omega) = -(k - \\omega)(k + \\omega) = 0\n$$\nThis gives two solutions for the frequency $\\omega$:\n$$\n\\omega_1 = k \\quad \\text{and} \\quad \\omega_2 = -k\n$$\nThe corresponding characteristic speeds $c = \\omega/k$ (for $k \\neq 0$) are:\n$$\nc_{1} = \\frac{\\omega_1}{k} = \\frac{k}{k} = 1\n$$\n$$\nc_{2} = \\frac{\\omega_2}{k} = \\frac{-k}{k} = -1\n$$\nAs a check, the eigenvalues of $A = \\text{diag}(1, -1)$ are $\\lambda_1 = 1$ and $\\lambda_2 = -1$, which are indeed the characteristic speeds.\n\n### Verification of Strong Hyperbolicity\n\nThe PDE system can be written in the form $\\partial_t u + A_x \\partial_x u = 0$, where $A_x = -A$. For a first-order system in one spatial dimension, the principal symbol is $P(n_x) = n_x A_x$, where $n_x$ is a unit covector in the spatial direction, i.e., $n_x \\in \\{-1, 1\\}$.\nIn our case, the principal symbol matrix is:\n$$\nP(n_x) = n_x(-A) = -n_x A = -n_x \\begin{pmatrix} 1 & 0 \\\\ 0 & -1 \\end{pmatrix} = \\begin{pmatrix} -n_x & 0 \\\\ 0 & n_x \\end{pmatrix}\n$$\nFor strong hyperbolicity, for every unit covector $n_x$, the principal symbol $P(n_x)$ must have a complete set of eigenvectors with real eigenvalues, and there must exist a diagonalizing matrix $S$ whose condition number is uniformly bounded over all such $n_x$.\n\n1.  **Eigenvalues and Eigenvectors**:\n    The matrix $P(n_x)$ is diagonal. Its eigenvalues are the diagonal entries: $\\lambda_1 = -n_x$ and $\\lambda_2 = n_x$. Since $n_x$ is real, the eigenvalues are real.\n    Since the eigenvalues are distinct for $n_x \\neq 0$ (which is true for $n_x \\in \\{-1, 1\\}$), a complete set of linearly independent eigenvectors is guaranteed. The eigenvectors of $P(n_x)$ are the standard basis vectors, regardless of the value of $n_x$:\n    For $\\lambda_1 = -n_x$, the eigenvector is $v_1 = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$.\n    For $\\lambda_2 = n_x$, the eigenvector is $v_2 = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$.\n\n2.  **Diagonalization and Condition Number**:\n    The eigenvectors are defined up to a non-zero scalar multiple. A general eigenvector matrix $S$ is formed by these scaled eigenvectors as columns:\n    $$\n    S = \\begin{pmatrix} \\alpha v_1 & \\beta v_2 \\end{pmatrix} = \\begin{pmatrix} \\alpha & 0 \\\\ 0 & \\beta \\end{pmatrix}\n    $$\n    where $\\alpha, \\beta \\in \\mathbb{C}$ are non-zero scaling factors. This matrix $S$ diagonalizes $P(n_x)$ for any $n_x$. The condition number in the operator $2$-norm is $\\kappa_2(S) = \\|S\\|_2 \\|S^{-1}\\|_2$.\n\n    For a diagonal matrix, the $2$-norm is the maximum absolute value of its diagonal entries.\n    $$\n    \\|S\\|_2 = \\max(|\\alpha|, |\\beta|)\n    $$\n    The inverse of $S$ is $S^{-1} = \\begin{pmatrix} 1/\\alpha & 0 \\\\ 0 & 1/\\beta \\end{pmatrix}$, and its norm is:\n    $$\n    \\|S^{-1}\\|_2 = \\max\\left(\\left|\\frac{1}{\\alpha}\\right|, \\left|\\frac{1}{\\beta}\\right|\\right) = \\frac{1}{\\min(|\\alpha|, |\\beta|)}\n    $$\n    The condition number is therefore:\n    $$\n    \\kappa_2(S) = \\frac{\\max(|\\alpha|, |\\beta|)}{\\min(|\\alpha|, |\\beta|)}\n    $$\n    This expression for $\\kappa_2(S)$ does not depend on the covector $n_x$. Thus, for any choice of non-zero $\\alpha$ and $\\beta$, the condition number is uniformly bounded. The system is strongly hyperbolic.\n\n3.  **Smallest Uniform Bound $\\kappa_{\\ast}$**:\n    We are asked to find the smallest possible uniform bound $\\kappa_{\\ast}$ over all valid diagonalizations. This corresponds to finding the minimum value of $\\kappa_2(S)$ over all possible choices of $\\alpha$ and $\\beta$. The ratio $\\frac{\\max(|\\alpha|, |\\beta|)}{\\min(|\\alpha|, |\\beta|)}$ is always greater than or equal to $1$. The minimum value of $1$ is achieved when $|\\alpha| = |\\beta|$.\n\n    For example, we can choose $\\alpha=1$ and $\\beta=1$. This gives the eigenvector matrix $S = I$, the identity matrix.\n    $$\n    \\kappa_2(I) = \\|I\\|_2 \\|I^{-1}\\|_2 = 1 \\cdot 1 = 1\n    $$\n    This is the lowest possible condition number for any matrix. Therefore, the smallest uniform bound we can guarantee is $\\kappa_{\\ast} = 1$.\n\nThe characteristic speeds are $c_1=1$, $c_2=-1$, and the smallest uniform bound on the condition number is $\\kappa_{\\ast}=1$.", "answer": "$$\n\\boxed{\\begin{pmatrix} 1 & -1 & 1 \\end{pmatrix}}\n$$", "id": "3497855"}, {"introduction": "Having established the properties of a strongly hyperbolic system, we now turn to its problematic counterpart. This practice [@problem_id:3497799] presents a system with a non-diagonalizable principal symbol, the canonical example of weak hyperbolicity. Your analysis will reveal the crucial difference between an eigenvalue's algebraic and geometric multiplicity, a mathematical 'defect' that signals an ill-posed formulation and hints at potential pathologies in the solution.", "problem": "Consider the linear first-order Partial Differential Equation (PDE) system in one spatial dimension for an unknown vector field $u:\\mathbb{R}\\times\\mathbb{R}\\to\\mathbb{R}^{2}$ given by\n$$\n\\partial_{t}u = A\\,\\partial_{x}u,\\quad A=\\begin{pmatrix}1 & 1\\\\ 0 & 1\\end{pmatrix}.\n$$\nAdopt the convention that the principal symbol is the linear map $P(\\xi)=A\\,\\xi$ for covector $\\xi\\in\\mathbb{R}$. Starting from the definitions of principal symbol and hyperbolicity for first-order systems, carry out the following steps:\n- Compute the principal symbol $P(\\xi)$ explicitly.\n- Determine the eigenvalues and eigenvectors of $P(\\xi)$ for $\\xi\\neq 0$ and decide whether the system is strongly hyperbolic or only weakly hyperbolic, explaining your reasoning in terms of diagonalizability and the existence (or not) of a uniform diagonalization.\n- Using the Fourier-mode ansatz in $x$, briefly justify how the structure of $P(\\xi)$ influences the growth of high-frequency solutions in time, and connect this with the distinction between strong and weak hyperbolicity.\n\nDefine the defect $\\delta$ of the symbol as the difference between the algebraic multiplicity and the geometric multiplicity of any eigenvalue of $P(\\xi)$ for a fixed but arbitrary nonzero $\\xi$:\n$$\n\\delta \\equiv \\text{(algebraic multiplicity)} - \\text{(geometric multiplicity)}.\n$$\nProvide, as your final answer, the single number $\\delta$. No rounding is required. Do not include units.", "solution": "The problem asks for an analysis of the hyperbolicity of a given first-order partial differential equation (PDE) system and the calculation of a quantity defined as the 'defect'.\n\nThe PDE system is given by $\\partial_{t}u = A\\,\\partial_{x}u$, where $u(t, x)$ is a vector field in $\\mathbb{R}^{2}$ and the constant matrix $A$ is\n$$\nA = \\begin{pmatrix} 1 & 1 \\\\ 0 & 1 \\end{pmatrix}.\n$$\nThe problem is set in one spatial dimension, so the wave covector $\\xi$ is a scalar in $\\mathbb{R}$.\n\nFirst, we compute the principal symbol of the system. Following the provided definition, the principal symbol is the matrix-valued function $P(\\xi)$ given by\n$$\nP(\\xi) = A\\,\\xi = \\begin{pmatrix} 1 & 1 \\\\ 0 & 1 \\end{pmatrix} \\xi = \\begin{pmatrix} \\xi & \\xi \\\\ 0 & \\xi \\end{pmatrix}.\n$$\n\nNext, we determine the eigenvalues and eigenvectors of $P(\\xi)$ for a non-zero covector $\\xi \\neq 0$. The eigenvalues $\\lambda$ are the roots of the characteristic equation $\\det(P(\\xi) - \\lambda I) = 0$, where $I$ is the $2 \\times 2$ identity matrix.\n$$\n\\det\\begin{pmatrix} \\xi - \\lambda & \\xi \\\\ 0 & \\xi - \\lambda \\end{pmatrix} = (\\xi - \\lambda)^{2} = 0.\n$$\nThis equation yields a single eigenvalue, $\\lambda = \\xi$, with an algebraic multiplicity of $2$.\n\nA system is defined as hyperbolic if for every real covector $\\xi$, all eigenvalues of its principal symbol $P(\\xi)$ are real. In our case, for any $\\xi \\in \\mathbb{R}$, the only eigenvalue is $\\lambda=\\xi$, which is always real. Therefore, the system is hyperbolic.\n\nTo distinguish between strong and weak hyperbolicity, we must examine the diagonalizability of $P(\\xi)$, which is determined by the geometric multiplicity of its eigenvalues. The geometric multiplicity of an eigenvalue is the dimension of its corresponding eigenspace, which is the null space of the matrix $P(\\xi) - \\lambda I$. For our eigenvalue $\\lambda = \\xi$, we need to find the null space of\n$$\nP(\\xi) - \\xi I = \\begin{pmatrix} \\xi - \\xi & \\xi \\\\ 0 & \\xi - \\xi \\end{pmatrix} = \\begin{pmatrix} 0 & \\xi \\\\ 0 & 0 \\end{pmatrix}.\n$$\nLet $v = \\begin{pmatrix} v_1 \\\\ v_2 \\end{pmatrix}$ be an eigenvector. The condition $(P(\\xi) - \\xi I)v = 0$ becomes\n$$\n\\begin{pmatrix} 0 & \\xi \\\\ 0 & 0 \\end{pmatrix} \\begin{pmatrix} v_1 \\\\ v_2 \\end{pmatrix} = \\begin{pmatrix} \\xi v_2 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}.\n$$\nFor a non-zero covector $\\xi \\neq 0$, this equation implies $\\xi v_2 = 0$, which means $v_2 = 0$. The component $v_1$ is unconstrained. Thus, any eigenvector must be of the form $v = \\begin{pmatrix} c \\\\ 0 \\end{pmatrix}$ for some non-zero constant $c \\in \\mathbb{R}$. The eigenspace is spanned by the single vector $\\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$. The dimension of this eigenspace is $1$.\nSo, the geometric multiplicity of the eigenvalue $\\lambda = \\xi$ is $1$.\n\nA system is strongly hyperbolic if for all $\\xi$, its principal symbol $P(\\xi)$ is diagonalizable. This requires that for every eigenvalue, its algebraic and geometric multiplicities are equal. In our case, for any $\\xi \\neq 0$, the algebraic multiplicity is $2$, while the geometric multiplicity is $1$. Since the multiplicities do not match, the matrix $P(\\xi)$ is not diagonalizable for any $\\xi \\neq 0$. Consequently, the system is not strongly hyperbolic. As it is hyperbolic but not strongly hyperbolic, the system is weakly hyperbolic.\n\nNow, we connect the structure of $P(\\xi)$ to the behavior of high-frequency solutions. Consider a Fourier mode ansatz $u(t, x) = \\hat{u}(t) \\exp(ikx)$, where $k$ is the wavenumber. Substituting this into the PDE gives:\n$$\n\\frac{d\\hat{u}(t)}{dt} \\exp(ikx) = A \\,(ik \\hat{u}(t) \\exp(ikx)).\n$$\nThis simplifies to an ordinary differential equation for the Fourier amplitudes $\\hat{u}(t)$:\n$$\n\\frac{d\\hat{u}(t)}{dt} = ikA \\, \\hat{u}(t) = i P(k) \\, \\hat{u}(t).\n$$\nThe solution is given by $\\hat{u}(t) = \\exp(i P(k) t) \\hat{u}(0) = \\exp(iktA) \\hat{u}(0)$. The non-diagonalizability of $A$ (and thus $P(k)$) is crucial here. The matrix $A$ is a Jordan block. We can write $A = I + N$, where $N = \\begin{pmatrix} 0 & 1 \\\\ 0 & 0 \\end{pmatrix}$ and $N^2 = 0$. Since $I$ and $N$ commute, we can write the matrix exponential as:\n$$\n\\exp(iktA) = \\exp(ikt(I+N)) = \\exp(iktI)\\exp(iktN).\n$$\nUsing the series expansion for the exponential, we have $\\exp(iktI) = \\exp(ikt)I$ and\n$$\n\\exp(iktN) = I + (iktN) + \\frac{(iktN)^2}{2!} + \\dots = I + iktN,\n$$\nsince $N^m = 0$ for $m \\geq 2$. So, the solution operator is:\n$$\n\\exp(iktA) = \\exp(ikt) (I + iktN) = \\exp(ikt) \\begin{pmatrix} 1 & ikt \\\\ 0 & 1 \\end{pmatrix}.\n$$\nThe solution for the Fourier amplitude is $\\hat{u}(t) = \\exp(ikt) \\begin{pmatrix} 1 & ikt \\\\ 0 & 1 \\end{pmatrix} \\hat{u}(0)$. The term $ikt$ in the upper-right corner of the matrix causes a secular growth. The norm of the solution vector $\\|\\hat{u}(t)\\|$ can grow linearly with time $t$. The rate of this growth is proportional to the frequency $k$. This polynomial growth in time for high-frequency modes ($|k| \\gg 1$) is a hallmark of weakly hyperbolic systems and is a direct consequence of the non-diagonalizability of the principal symbol. In contrast, for a strongly hyperbolic system, the solution operator $\\exp(iP(k)t)$ would be uniformly bounded in time, preventing such growth.\n\nFinally, we are asked to compute the defect $\\delta$, defined as the difference between the algebraic and geometric multiplicities for any eigenvalue of $P(\\xi)$ with a fixed non-zero $\\xi$.\nFrom our analysis:\n- The algebraic multiplicity of the eigenvalue $\\lambda = \\xi$ is $2$.\n- The geometric multiplicity of the eigenvalue $\\lambda = \\xi$ is $1$.\nTherefore, the defect $\\delta$ is:\n$$\n\\delta = (\\text{algebraic multiplicity}) - (\\text{geometric multiplicity}) = 2 - 1 = 1.\n$$\nThis result is independent of the specific choice of non-zero $\\xi$.", "answer": "$$\\boxed{1}$$", "id": "3497799"}, {"introduction": "Theory predicts that weakly hyperbolic systems are ill-posed, but what does this mean for a numerical simulation? This final practice [@problem_id:3497807] is a computational experiment designed to make the abstract consequences of weak hyperbolicity tangible. By implementing a numerical integrator for both weakly and strongly hyperbolic systems, you will directly observe how the flaw identified in the previous exercise manifests as a resolution-dependent instability, a critical failure mode in numerical relativity.", "problem": "Consider the linearized Arnowitt–Deser–Misner (ADM) formulation of general relativity, restricted to one spatial dimension, and focus only on the principal part of an evolution system. In first-order form, write the system for a state vector $\\,\\mathbf{u}(x,t)\\in\\mathbb{R}^2\\,$ as\n$$\n\\partial_t \\mathbf{u} = A \\,\\partial_x \\mathbf{u},\n$$\nwhere $A$ is a constant $2\\times 2$ matrix capturing the principal symbol of the linearization. A fundamental base for analysis is the Fourier (normal mode) approach: insert the ansatz $\\,\\mathbf{u}(x,t)=\\widehat{\\mathbf{u}}(k,t)e^{i k x}\\,$ with spatial wavenumber $\\,k\\in\\mathbb{R}\\,$ to obtain\n$$\n\\partial_t \\widehat{\\mathbf{u}} = i k A \\,\\widehat{\\mathbf{u}}.\n$$\n\nHyperbolicity of this system is determined by the spectral properties of $A$. The system is strongly hyperbolic if, for each spatial direction, the principal symbol is diagonalizable with a complete set of eigenvectors and uniformly bounded condition number. It is only weakly hyperbolic if the eigenvalues are real but the principal symbol fails to be diagonalizable (has a nontrivial Jordan block). Weak hyperbolicity is known to lead to ill-posedness in the Hadamard sense, reflected in growth that is unbounded with respect to frequency $\\,k\\,$, which can manifest as resolution-dependent deterioration in numerical simulations of the ADM system.\n\nYou will implement and study a prototypical weakly hyperbolic test problem that models this behavior. Consider two matrices:\n$$\nA_{\\text{weak}} = \\begin{pmatrix} 1 & 1 \\\\ 0 & 1 \\end{pmatrix}, \\qquad\nA_{\\text{strong}} = \\begin{pmatrix} 1 & 0 \\\\ 0 & -1 \\end{pmatrix}.\n$$\nThe matrix $A_{\\text{weak}}$ has a repeated eigenvalue and a nontrivial Jordan block, hence represents a weakly hyperbolic principal part. In contrast, $A_{\\text{strong}}$ is diagonalizable with real eigenvalues, and represents a strongly hyperbolic principal part.\n\nYour program must numerically integrate the system on a periodic domain $[0,2\\pi]$ using the method of lines:\n- Use a uniform grid with $N$ points and grid spacing $\\,h=2\\pi/N\\,$.\n- Approximate $\\,\\partial_x\\,$ with the second-order centered difference operator\n$$\nD_h f_j = \\frac{f_{j+1}-f_{j-1}}{2h}, \\quad \\text{with periodic wrap-around}.\n$$\n- Advance in time to a final time $\\,T\\,$ with the classical fourth-order Runge–Kutta method (RK4).\n- Use a time step $\\,\\Delta t = \\text{CFL}\\cdot h / a_{\\max}\\,$ where $\\,a_{\\max}\\,$ is the maximum magnitude of the characteristic speeds implied by $A$ (for the above choices, take $\\,a_{\\max}=1\\,$). Ensure the final time integration spans exactly $T$ by taking an integer number of steps and resetting $\\,\\Delta t = T / n_{\\text{steps}}\\,$.\n\nFor an initial condition, take a single Fourier mode with wavenumber $\\,m\\,$ scaled to the grid:\n$$\n\\mathbf{u}(x,0) = \\begin{cases}\n\\big(\\sin(m x), \\sin(m x)\\big)^{\\top}, & \\text{generic two-component mode}, \\\\\n\\big(\\sin(m x), 0\\big)^{\\top}, & \\text{eigenvector-only mode for } A_{\\text{weak}}.\n\\end{cases}\n$$\nOn a grid of $N$ points, set $\\,m=\\lfloor \\alpha N \\rfloor\\,$ with a fixed fraction $\\,\\alpha\\in(0,0.5)\\,$ to probe resolution-dependent high-frequency behavior. Use the $L^2$ norm\n$$\n\\|\\mathbf{u}\\|_{L^2} = \\left( \\int_0^{2\\pi} \\left(u_1^2(x,t) + u_2^2(x,t)\\right) \\, dx \\right)^{1/2}\n$$\nand approximate it by the quadrature $\\,\\left(h\\sum_j \\big(u_{1,j}^2+u_{2,j}^2\\big)\\right)^{1/2}\\,$. Define the amplification factor\n$$\n\\mathcal{A} = \\frac{\\|\\mathbf{u}(\\cdot,T)\\|_{L^2}}{\\|\\mathbf{u}(\\cdot,0)\\|_{L^2}}.\n$$\n\nTask:\n- Implement the numerical integrator as described.\n- For each test case, compute the amplification factor $\\,\\mathcal{A}\\,$.\n\nScientific objective:\n- Explain, using the Fourier-symbol picture, why the weakly hyperbolic system with $A_{\\text{weak}}$ exhibits amplification that grows with resolution for high-frequency modes even when coarse grids appear stable for short times.\n- Demonstrate numerically that $\\,\\mathcal{A}\\,$ increases as $\\,h\\to 0\\,$ for the weakly hyperbolic generic mode, while remaining near unity for the eigenvector-only weak mode and for the strongly hyperbolic comparison.\n\nTest suite:\nProvide results for the following parameter sets $(\\text{system}, N, \\alpha, T, \\text{CFL})$:\n1. $(\\text{weak\\_generic}, 64, 0.25, 1.0, 0.5)$\n2. $(\\text{weak\\_generic}, 256, 0.25, 1.0, 0.5)$\n3. $(\\text{weak\\_generic}, 512, 0.25, 1.0, 0.5)$\n4. $(\\text{weak\\_eigen}, 256, 0.25, 1.0, 0.5)$\n5. $(\\text{strong\\_generic}, 256, 0.25, 1.0, 0.5)$\n\nAnswer specification:\n- For each test case, output the amplification factor $\\,\\mathcal{A}\\,$ as a float rounded to three decimal places.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[\\text{result}_1,\\text{result}_2,\\text{result}_3,\\text{result}_4,\\text{result}_5]$).\n- No physical units are involved; all quantities are dimensionless.", "solution": "The problem is subjected to validation against the specified criteria.\n\n### Step 1: Extract Givens\n- **Governing Equation**: $\\partial_t \\mathbf{u} = A \\,\\partial_x \\mathbf{u}$ for a state vector $\\mathbf{u}(x,t)\\in\\mathbb{R}^2$.\n- **Matrices**:\n  - Weakly hyperbolic: $A_{\\text{weak}} = \\begin{pmatrix} 1 & 1 \\\\ 0 & 1 \\end{pmatrix}$.\n  - Strongly hyperbolic: $A_{\\text{strong}} = \\begin{pmatrix} 1 & 0 \\\\ 0 & -1 \\end{pmatrix}$.\n- **Domain**: Periodic, $x \\in [0, 2\\pi]$.\n- **Numerical Discretization (Method of Lines)**:\n  - **Spatial**: A uniform grid with $N$ points, spacing $h=2\\pi/N$, and a second-order centered difference operator $D_h f_j = \\frac{f_{j+1}-f_{j-1}}{2h}$ with periodic boundaries.\n  - **Temporal**: Classical fourth-order Runge–Kutta (RK4) integrator up to a final time $T$.\n- **Time Step**: $\\Delta t = \\text{CFL}\\cdot h / a_{\\max}$, with maximum characteristic speed $a_{\\max}=1$. The number of steps is fixed as $n_{\\text{steps}} = \\lceil T / \\Delta t_{\\text{initial}} \\rceil$ and the time step is adjusted to $\\Delta t = T / n_{\\text{steps}}$ to reach exactly time $T$.\n- **Initial Conditions**: A single Fourier mode with wavenumber $m=\\lfloor \\alpha N \\rfloor$ for $\\alpha\\in(0,0.5)$.\n  - Generic mode: $\\mathbf{u}(x,0) = (\\sin(m x), \\sin(m x))^{\\top}$.\n  - Eigenvector-only mode (for $A_{\\text{weak}}$): $\\mathbf{u}(x,0) = (\\sin(m x), 0)^{\\top}$.\n- **Analysis Metric**: The amplification factor $\\mathcal{A} = \\frac{\\|\\mathbf{u}(\\cdot,T)\\|_{L^2}}{\\|\\mathbf{u}(\\cdot,0)\\|_{L^2}}$, where the $L^2$ norm is approximated by the quadrature $\\|\\mathbf{u}\\|_{L^2} \\approx \\left(h\\sum_j \\big(u_{1,j}^2+u_{2,j}^2\\big)\\right)^{1/2}$.\n- **Test Suite**: Five cases are specified with parameters $(\\text{system}, N, \\alpha, T, \\text{CFL})$.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientific Grounding**: The problem is scientifically sound. It addresses the well-established distinction between strong and weak hyperbolicity in the context of first-order partial differential equations, a cornerstone topic in numerical relativity and computational physics. The matrices $A_{\\text{weak}}$ and $A_{\\text{strong}}$ are canonical examples used to illustrate this concept. The predicted numerical pathology (resolution-dependent growth) for weakly hyperbolic systems is a known phenomenon.\n- **Well-Posedness**: The problem is well-posed. It specifies a complete initial-boundary value problem along with a fully determined numerical method for its solution. All parameters are provided.\n- **Objectivity**: The problem is stated in precise, objective, and formal mathematical language.\n- **Flaw Checklist**: The problem does not violate any of the specified criteria for invalidity. It is scientifically factual, formalizable, complete, feasible, well-structured, and non-trivial.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete solution is provided below.\n\n### Principle-Based Solution\n\nThe problem investigates the numerical consequences of weak hyperbolicity in systems of partial differential equations (PDEs). We analyze the behavior of the system $\\partial_t \\mathbf{u} = A \\,\\partial_x \\mathbf{u}$ by examining the properties of the evolution operator in Fourier space.\n\n**1. Hyperbolicity and the Fourier Symbol**\n\nFor a plane wave ansatz $\\mathbf{u}(x,t)=\\widehat{\\mathbf{u}}(k,t)e^{i k x}$ with spatial wavenumber $k$, the PDE system transforms into a system of ordinary differential equations (ODEs) for the Fourier amplitudes $\\widehat{\\mathbf{u}}$:\n$$\n\\partial_t \\widehat{\\mathbf{u}} = i k A \\,\\widehat{\\mathbf{u}}\n$$\nThe matrix $P(k) = ikA$ is the Fourier symbol of the differential operator. A system is defined as hyperbolic if the eigenvalues of the principal symbol matrix (in this 1D case, $A$) are all real. This ensures that the solutions $\\widehat{\\mathbf{u}}(k,t) = e^{ikAt}\\widehat{\\mathbf{u}}(k,0)$ are purely oscillatory for each mode $k$, not exponentially growing.\n\n**2. Strong vs. Weak Hyperbolicity**\n\nThe nature of the hyperbolicity depends on the eigensystem of $A$:\n- **Strongly Hyperbolic ($A_{\\text{strong}}$)**: The matrix $A_{\\text{strong}} = \\begin{pmatrix} 1 & 0 \\\\ 0 & -1 \\end{pmatrix}$ has distinct real eigenvalues $\\lambda = 1, -1$ and is diagonalizable. The evolution operator $e^{ikA_{\\text{strong}}t}$ is unitary (up to a coordinate transformation), so it preserves the norm of $\\widehat{\\mathbf{u}}(k,t)$ for all time. Consequently, the total $L^2$ norm of the solution is conserved, and the amplification factor $\\mathcal{A}$ is expected to be $1$.\n- **Weakly Hyperbolic ($A_{\\text{weak}}$)**: The matrix $A_{\\text{weak}} = \\begin{pmatrix} 1 & 1 \\\\ 0 & 1 \\end{pmatrix}$ has a repeated real eigenvalue $\\lambda = 1$ but is not diagonalizable; it possesses a non-trivial Jordan block. Its matrix exponential can be calculated as:\n$$\ne^{ikA_{\\text{weak}}t} = e^{ikt(I+N)} = e^{ikt}e^{ikNt} = e^{ikt}(I + ikNt + \\frac{(ikNt)^2}{2!} + \\dots)\n$$\nwhere $N = \\begin{pmatrix} 0 & 1 \\\\ 0 & 0 \\end{pmatrix}$. Since $N^2=0$, the series truncates:\n$$\ne^{ikA_{\\text{weak}}t} = e^{ikt} \\left( I + ikNt \\right) = e^{ikt} \\begin{pmatrix} 1 & ikt \\\\ 0 & 1 \\end{pmatrix}\n$$\nThe solution for a mode is $\\widehat{\\mathbf{u}}(k,t) = e^{ikt} \\begin{pmatrix} 1 & ikt \\\\ 0 & 1 \\end{pmatrix} \\widehat{\\mathbf{u}}(k,0)$. If the initial data $\\widehat{\\mathbf{u}}(k,0)$ has a component that is not in the true eigenspace (i.e., the second component is non-zero), the term $ikt$ causes the amplitude of the first component of $\\widehat{\\mathbf{u}}(k,t)$ to grow linearly with both time $t$ and wavenumber $k$. This unbounded growth with respect to $k$ signifies that the continuous problem is ill-posed in the sense of Hadamard.\n\n**3. Numerical Implications**\n\nThe method of lines discretizes the spatial domain, replacing the continuous derivative operator $\\partial_x$ with a discrete matrix operator. The symbol of the second-order centered difference operator $D_h$ is found by applying it to a grid function $e^{ikx_j}$:\n$$\nD_h e^{ikx_j} \\to i \\frac{\\sin(kh)}{h} e^{ikx_j}\n$$\nThe semi-discretized system for a Fourier mode behaves like $\\partial_t \\widehat{\\mathbf{u}} = i k_{\\text{eff}} A \\widehat{\\mathbf{u}}$, where $k_{\\text{eff}}(k) = \\frac{\\sin(kh)}{h}$ is the effective wavenumber.\n\nFor the weakly hyperbolic case, the growth is now proportional to $k_{\\text{eff}}t$. On a grid with $N$ points and spacing $h=2\\pi/N$, the highest wavenumbers that can be resolved are of order $k \\sim 1/h \\propto N$. The term $k_{\\text{eff}}$ is maximized for $kh=\\pi/2$, where $k_{\\text{eff}} = 1/h \\propto N$. The problem is designed with $\\alpha=0.25$, which sets the initial mode wavenumber $m = \\lfloor 0.25 N \\rfloor$. This corresponds to a grid wavenumber of $kh = m (2\\pi/N) \\approx 0.25 \\times 2\\pi = \\pi/2$. This choice precisely targets the frequency of maximum numerical growth.\n\nTherefore, for the weakly hyperbolic system with a generic initial condition:\n- The amplification is caused by the $ikt$ term in the evolution operator.\n- Higher resolution (larger $N$, smaller $h$) allows for the representation of modes with a larger effective wavenumber $k_{\\text{eff}} \\approx 1/h$.\n- This leads to a larger growth factor over a fixed time $T$, causing the amplification factor $\\mathcal{A}$ to increase with resolution. This is what the numerical tests are set up to demonstrate.\n\nIn contrast:\n- For the `weak_eigen` case, the initial condition $\\mathbf{u}(x,0) = (\\sin(mx), 0)^\\top$ lies entirely within the eigenspace of $A_{\\text{weak}}$. The evolution operator does not induce growth: $e^{ikt}\\begin{pmatrix} 1 & ikt \\\\ 0 & 1 \\end{pmatrix} \\begin{pmatrix} \\hat{u}_1 \\\\ 0 \\end{pmatrix} = e^{ikt}\\begin{pmatrix} \\hat{u}_1 \\\\ 0 \\end{pmatrix}$. The norm is preserved, and $\\mathcal{A} \\approx 1$.\n- For the `strong_generic` case, the system is norm-preserving. Numerical discretization will introduce small errors, but no systematic growth is expected, so $\\mathcal{A} \\approx 1$.\n\n**4. Implementation Details**\n\nThe solution is implemented using the Method of Lines. The state vector $\\mathbf{u}(x,t)$ is discretized onto a grid with $N$ points, yielding a large state vector of size $2N$. The spatial derivative $\\partial_x \\mathbf{u}$ is computed at each grid point using the centered difference formula with periodic wrap-around, which can be efficiently implemented using `np.roll`. This gives the right-hand side (RHS) of a large system of ODEs, $\\frac{d}{dt}\\mathbf{U} = F(\\mathbf{U})$. This ODE system is then integrated from $t=0$ to $t=T$ using the classical fourth-order Runge-Kutta (RK4) method. Finally, the $L^2$ norms of the initial and final states are computed via numerical quadrature to find the amplification factor $\\mathcal{A}$.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef run_simulation(system_type, N, alpha, T, CFL):\n    \"\"\"\n    Runs a single simulation for the given parameters.\n\n    Args:\n        system_type (str): Type of system ('weak_generic', 'weak_eigen', 'strong_generic').\n        N (int): Number of grid points.\n        alpha (float): Factor to determine the initial mode wavenumber.\n        T (float): Final integration time.\n        CFL (float): CFL number for time step calculation.\n\n    Returns:\n        float: The amplification factor A.\n    \"\"\"\n    # 1. Setup Grid and System Matrix\n    h = 2 * np.pi / N\n    x = np.linspace(0, 2 * np.pi, N, endpoint=False)\n    \n    A_weak = np.array([[1.0, 1.0], [0.0, 1.0]])\n    A_strong = np.array([[1.0, 0.0], [0.0, -1.0]])\n\n    m = int(alpha * N)\n\n    # 2. Set Initial Conditions\n    if system_type == 'weak_generic':\n        A = A_weak\n        u0 = np.array([np.sin(m * x), np.sin(m * x)])\n    elif system_type == 'weak_eigen':\n        A = A_weak\n        u0 = np.array([np.sin(m * x), np.zeros(N)])\n    elif system_type == 'strong_generic':\n        A = A_strong\n        u0 = np.array([np.sin(m * x), np.sin(m * x)])\n    else:\n        raise ValueError(\"Invalid system_type\")\n\n    # 3. Setup Time Integration\n    a_max = 1.0 # Max characteristic speed\n    dt_initial = CFL * h / a_max\n    # Problem specifies to adjust dt to hit T exactly\n    num_steps = int(np.ceil(T / dt_initial))\n    dt = T / num_steps\n\n    # 4. Define the RHS function for the ODE system d(u)/dt = F(u)\n    def rhs(u_state, A_matrix, h_spacing):\n        \"\"\"\n        Calculates the right-hand side of the semi-discretized PDE system.\n        RHS = A * d(u)/dx\n        \"\"\"\n        # Second-order centered difference with periodic boundaries\n        # np.roll(u, -1, axis=1) corresponds to u_{j+1}\n        # np.roll(u, 1, axis=1) corresponds to u_{j-1}\n        du_dx = (np.roll(u_state, -1, axis=1) - np.roll(u_state, 1, axis=1)) / (2 * h_spacing)\n        \n        # Apply the matrix A to the spatial derivatives\n        # A is (2,2), du_dx is (2,N). Result is (2,N)\n        return A_matrix @ du_dx\n\n    # 5. Perform RK4 Time Integration\n    u = u0.copy()\n    for _ in range(num_steps):\n        k1 = rhs(u, A, h)\n        k2 = rhs(u + dt / 2 * k1, A, h)\n        k3 = rhs(u + dt / 2 * k2, A, h)\n        k4 = rhs(u + dt * k3, A, h)\n        u += dt / 6 * (k1 + 2 * k2 + 2 * k3 + k4)\n\n    # 6. Calculate Amplification Factor\n    # L2 norm is sqrt(h * sum(u_1^2 + u_2^2))\n    norm_initial = np.sqrt(h * np.sum(u0**2))\n    norm_final = np.sqrt(h * np.sum(u**2))\n    \n    amplification = norm_final / norm_initial\n    return amplification\n\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (system_type, N, alpha, T, CFL)\n        ('weak_generic', 64, 0.25, 1.0, 0.5),\n        ('weak_generic', 256, 0.25, 1.0, 0.5),\n        ('weak_generic', 512, 0.25, 1.0, 0.5),\n        ('weak_eigen', 256, 0.25, 1.0, 0.5),\n        ('strong_generic', 256, 0.25, 1.0, 0.5),\n    ]\n\n    results = []\n    for params in test_cases:\n        result = run_simulation(*params)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    # Results are rounded to three decimal places.\n    print(f\"[{','.join(f'{r:.3f}' for r in results)}]\")\n\nsolve()\n```", "id": "3497807"}]}