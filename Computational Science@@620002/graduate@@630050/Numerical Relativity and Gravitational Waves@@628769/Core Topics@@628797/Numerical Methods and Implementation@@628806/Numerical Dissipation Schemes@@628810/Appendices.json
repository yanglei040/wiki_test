{"hands_on_practices": [{"introduction": "Before implementing any numerical scheme, it is essential to understand its fundamental properties. This practice guides you through a foundational analysis of the Kreiss-Oliger (KO) dissipation operator, combining theoretical derivation with empirical verification. By using Taylor series expansions, you will first determine the continuum differential operator that the discrete KO operator approximates and identify its leading error term, a crucial step in assessing its accuracy [@problem_id:3481434]. You will then write a short program to perform a convergence test, numerically confirming your theoretical predictions and building confidence in both the theory and your implementation.", "problem": "Consider the addition of Kreiss–Oliger (KO) numerical dissipation to stabilize high-order finite difference evolutions of linearized gravitational wave propagation in one spatial dimension within the Method of Lines (MoL). Kreiss–Oliger (KO) dissipation is a linear high-order smoothing operator designed to selectively damp grid-scale oscillations while vanishing on sufficiently smooth solutions as the grid is refined.\n\nWork on a periodic domain of length $2\\pi$ (angles in radians), with a smooth field $u(x)$ sampled on a uniform grid with $N$ points and spacing $\\Delta x = \\frac{2\\pi}{N}$. Define the forward and backward difference operators\n$$\nD_+ u_i = \\frac{u_{i+1} - u_i}{\\Delta x}, \\qquad D_- u_i = \\frac{u_i - u_{i-1}}{\\Delta x},\n$$\nwith periodic indexing. For an integer order parameter $p \\geq 2$, define the KO operator as\n$$\nQ_i = \\sigma\\, \\Delta x^{2p-1}\\, \\left(D_+^p D_-^p u\\right)_i,\n$$\nwhere $D_+^p$ and $D_-^p$ denote $p$-fold compositions and $\\sigma$ is a dimensionless constant. In common practice for numerical relativity, one takes $\\sigma$ of order unity and ensures the KO term vanishes rapidly with grid refinement.\n\nFrom first principles appropriate to numerical relativity and gravitational waves, starting from:\n- the definition of the forward and backward finite difference operators $D_+$ and $D_-$,\n- Taylor expansions of $u(x)$ about grid points,\n- and the Fourier representation of smooth periodic functions,\nderive the asymptotic behavior, for smooth $u(x)$, of the KO term $Q$ as $\\Delta x \\to 0$, including both its convergence order and its leading error term structure. Your derivation must identify the continuum operator that $D_+^p D_-^p$ approximates on smooth $u(x)$ and quantitatively determine how $Q$ scales with $\\Delta x$ and the leading derivative of $u$, without using any shortcut formulas or pre-stated error estimates.\n\nThen implement a program that empirically measures the convergence order of the leading error term by comparing the discrete KO operator to the corresponding continuum target on the test function\n$$\nu(x) = \\sin(k x),\n$$\nwith integer wavenumber $k$ (angles in radians). For each test case, compute the discrete KO operator $Q$ on two grids with $N$ and $2N$ points, respectively, and compare it to the continuum target constructed from the leading derivative you identified. Define the error as the maximum norm (supremum norm) difference between the discrete KO output and the continuum target evaluated at the grid points. Let $E(\\Delta x)$ be this error, and measure the empirical convergence order as\n$$\nr = \\frac{\\ln\\left(E(\\Delta x)\\right) - \\ln\\left(E\\left(\\frac{\\Delta x}{2}\\right)\\right)}{\\ln\\left(\\Delta x\\right) - \\ln\\left(\\frac{\\Delta x}{2}\\right)}.\n$$\n\nUse $\\sigma = 1$. Angles must be in radians throughout. There are no physical units required beyond this angle specification.\n\nTest suite:\n- Case $1$ (general high-order, happy path): $p=2$, $N=128$, $k=3$.\n- Case $2$ (higher dissipation order): $p=3$, $N=128$, $k=3$.\n- Case $3$ (even higher dissipation order): $p=4$, $N=128$, $k=3$.\n- Case $4$ (boundary resolution): $p=2$, $N=16$, $k=3$.\n- Case $5$ (edge near-Nyquist content): $p=2$, $N=64$, $k=31$.\n\nYour program should produce a single line of output containing the results as a comma-separated list of decimal numbers rounded to three decimal places, enclosed in square brackets, for the five test cases in order, for example, $[r_1,r_2,r_3,r_4,r_5]$.", "solution": "The problem requires a first-principles derivation of the asymptotic behavior of the Kreiss-Oliger (KO) dissipation operator, followed by a numerical implementation to verify the convergence properties of its leading error term.\n\nFirst, we validate the problem statement.\nThe givens are:\n- A periodic domain of length $2\\pi$ with a uniform grid of $N$ points and spacing $\\Delta x = \\frac{2\\pi}{N}$.\n- A smooth scalar field $u(x)$.\n- Finite difference operators: $D_+ u_i = \\frac{u_{i+1} - u_i}{\\Delta x}$ and $D_- u_i = \\frac{u_i - u_{i-1}}{\\Delta x}$ with periodic indexing.\n- The Kreiss-Oliger (KO) operator: $Q_i = \\sigma\\, \\Delta x^{2p-1}\\, \\left(D_+^p D_-^p u\\right)_i$, where $p \\geq 2$ is an integer and $\\sigma$ is a dimensionless constant.\n- The numerical task involves the test function $u(x) = \\sin(k x)$, a specific formula for the empirical convergence order $r$, and five test cases with specified parameters for $p$, $N$, and $k$. For the numerical part, $\\sigma=1$.\n\nThe problem is scientifically grounded in the field of numerical analysis for partial differential equations. The definitions of the finite difference operators and the structure of the KO term are standard, although some common pre-factors like $(-1)^{p+1}$ are absent in this particular definition. The problem is well-posed, providing all necessary information to perform both the analytical derivation and the numerical calculation. The tasks are mathematically rigorous and do not violate any physical or logical principles, even though the specific operator form given might be anti-dissipative for certain values of $p$; the analysis of such an operator is still a valid mathematical exercise. The problem is thus deemed valid.\n\nWe proceed to the derivation. Our goal is to determine the continuum operator that $D_+^p D_-^p$ approximates and to find the leading error term. We will use Taylor series expansions.\n\nThe operators $D_+$ and $D_-$ commute on a grid with periodic boundary conditions. Therefore, the operator $D_+^p D_-^p$ is equivalent to the $p$-th composition of the operator $D_+D_-$, which we denote as $(D_+D_-)^p$. Let's first analyze the fundamental operator $D_+D_-$.\n$$\n(D_+D_-) u_i = D_+ \\left( \\frac{u_i - u_{i-1}}{\\Delta x} \\right) = \\frac{1}{\\Delta x} \\left( \\frac{u_{i+1} - u_i}{\\Delta x} - \\frac{u_i - u_{i-1}}{\\Delta x} \\right) = \\frac{u_{i+1} - 2u_i + u_{i-1}}{(\\Delta x)^2}.\n$$\nThis is the standard three-point central difference stencil for the second derivative. To find its continuum limit and leading error, we use Taylor series for $u(x)$ expanded around the grid point $x_i$:\n$$\nu_{i\\pm 1} = u(x_i \\pm \\Delta x) = u_i \\pm \\Delta x \\frac{\\partial u}{\\partial x}\\bigg|_i + \\frac{(\\Delta x)^2}{2!} \\frac{\\partial^2 u}{\\partial x^2}\\bigg|_i \\pm \\frac{(\\Delta x)^3}{3!} \\frac{\\partial^3 u}{\\partial x^3}\\bigg|_i + \\frac{(\\Delta x)^4}{4!} \\frac{\\partial^4 u}{\\partial x^4}\\bigg|_i + O((\\Delta x)^5).\n$$\nSubstituting these into the expression for $(D_+D_-)u_i$:\n$$\nu_{i+1} - 2u_i + u_{i-1} = \\left( u_i + \\Delta x u'_i + \\frac{(\\Delta x)^2}{2} u''_i + \\frac{(\\Delta x)^3}{6} u'''_i + \\frac{(\\Delta x)^4}{24} u^{(4)}_i \\right) - 2u_i + \\left( u_i - \\Delta x u'_i + \\frac{(\\Delta x)^2}{2} u''_i - \\frac{(\\Delta x)^3}{6} u'''_i + \\frac{(\\Delta x)^4}{24} u^{(4)}_i \\right) + O((\\Delta x)^6).\n$$\nThe terms with odd powers of $\\Delta x$ cancel due to symmetry. Summing the coefficients for the even powers gives:\n$$\nu_{i+1} - 2u_i + u_{i-1} = (\\Delta x)^2 \\frac{\\partial^2 u}{\\partial x^2}\\bigg|_i + \\frac{2(\\Delta x)^4}{24} \\frac{\\partial^4 u}{\\partial x^4}\\bigg|_i + O((\\Delta x)^6) = (\\Delta x)^2 \\frac{\\partial^2 u}{\\partial x^2}\\bigg|_i + \\frac{(\\Delta x)^4}{12} \\frac{\\partial^4 u}{\\partial x^4}\\bigg|_i + O((\\Delta x)^6).\n$$\nDividing by $(\\Delta x)^2$, we find the operator expansion:\n$$\n(D_+D_-) = \\frac{\\partial^2}{\\partial x^2} + \\frac{(\\Delta x)^2}{12} \\frac{\\partial^4}{\\partial x^4} + O((\\Delta x)^4).\n$$\nThe operator $D_+D_-$ approximates the second partial derivative $\\frac{\\partial^2}{\\partial x^2}$ with a leading error term of order $(\\Delta x)^2$.\n\nNow, we consider the full operator $(D_+D_-)^p$. We can apply the binomial expansion to the operator expression:\n$$\n(D_+D_-)^p = \\left( \\frac{\\partial^2}{\\partial x^2} + \\frac{(\\Delta x)^2}{12} \\frac{\\partial^4}{\\partial x^4} + O((\\Delta x)^4) \\right)^p.\n$$\nFor small $\\Delta x$, the leading terms are:\n$$\n(D_+D_-)^p = \\left(\\frac{\\partial^2}{\\partial x^2}\\right)^p + p \\left(\\frac{\\partial^2}{\\partial x^2}\\right)^{p-1} \\left( \\frac{(\\Delta x)^2}{12} \\frac{\\partial^4}{\\partial x^4} \\right) + O((\\Delta x)^4).\n$$\nThis simplifies to:\n$$\n(D_+^p D_-^p) u = \\frac{\\partial^{2p} u}{\\partial x^{2p}} + \\frac{p (\\Delta x)^2}{12} \\frac{\\partial^{2p+2} u}{\\partial x^{2p+2}} + O((\\Delta x)^4).\n$$\nFrom this, we identify the continuum operator that $D_+^p D_-^p$ approximates on smooth $u(x)$ as $\\frac{\\partial^{2p}}{\\partial x^{2p}}$. The approximation is second-order accurate.\n\nNext, we analyze the full KO term $Q_i$:\n$$\nQ_i = \\sigma\\, \\Delta x^{2p-1}\\, \\left(D_+^p D_-^p u\\right)_i.\n$$\nSubstituting our expansion for the difference operator:\n$$\nQ_i = \\sigma\\, \\Delta x^{2p-1} \\left( \\frac{\\partial^{2p} u}{\\partial x^{2p}}\\bigg|_i + \\frac{p (\\Delta x)^2}{12} \\frac{\\partial^{2p+2} u}{\\partial x^{2p+2}}\\bigg|_i + O((\\Delta x)^4) \\right).\n$$\nThe asymptotic behavior of $Q_i$ as $\\Delta x \\to 0$ is dominated by the first term:\n$$\nQ_i = \\sigma \\Delta x^{2p-1} \\frac{\\partial^{2p} u}{\\partial x^{2p}}\\bigg|_i + \\sigma \\frac{p (\\Delta x)^{2p+1}}{12} \\frac{\\partial^{2p+2} u}{\\partial x^{2p+2}}\\bigg|_i + O((\\Delta x)^{2p+3}).\n$$\nThus, the KO term $Q$ scales as $\\Delta x^{2p-1}$, and its magnitude is proportional to the $(2p)$-th derivative of the field $u(x)$.\n\nFor the numerical part, we are asked to measure the convergence order of the leading error term. The error is defined as the difference between the discrete KO operator $Q$ and the \"continuum target\". This target is constructed from the leading derivative we identified, which is $\\frac{\\partial^{2p}}{\\partial x^{2p}}$. The continuum target for $Q$ is therefore:\n$$\nQ_{\\text{cont}}(x) = \\sigma \\Delta x^{2p-1} \\frac{\\partial^{2p} u}{\\partial x^{2p}}(x).\n$$\nThe error, $E(x)$, is the difference between the discrete operator and this continuum target:\n$$\nE(x) = Q_i - Q_{\\text{cont}}(x_i) = \\left( \\sigma \\Delta x^{2p-1} \\frac{\\partial^{2p} u}{\\partial x^{2p}} + \\sigma \\frac{p (\\Delta x)^{2p+1}}{12} \\frac{\\partial^{2p+2} u}{\\partial x^{2p+2}} + \\dots \\right) - \\sigma \\Delta x^{2p-1} \\frac{\\partial^{2p} u}{\\partial x^{2p}}.\n$$\nThe leading error term is:\n$$\nE(x) \\approx \\sigma \\frac{p (\\Delta x)^{2p+1}}{12} \\frac{\\partial^{2p+2} u}{\\partial x^{2p+2}}(x).\n$$\nThe error $E(\\Delta x) = \\max_i |E(x_i)|$ scales as $(\\Delta x)^{2p+1}$. The convergence order $r$ is given by $r = \\log_2(E(\\Delta x)/E(\\Delta x/2))$. If $E(\\Delta x) \\propto (\\Delta x)^\\alpha$, then $r = \\log_2((\\Delta x)^\\alpha / (\\Delta x/2)^\\alpha) = \\log_2(2^\\alpha) = \\alpha$. Therefore, the expected theoretical convergence order is $r = 2p+1$.\n\nFor the specific test function $u(x) = \\sin(kx)$, we need its $(2p)$-th derivative:\n$$\n\\frac{\\partial^{2p}}{\\partial x^{2p}} \\sin(kx) = k^{2p} \\sin\\left(kx + 2p \\cdot \\frac{\\pi}{2}\\right) = k^{2p} \\sin(kx + p\\pi) = (-1)^p k^{2p} \\sin(kx).\n$$\nThe continuum target for the numerical test is:\n$$\nQ_{\\text{cont}}(x) = \\sigma \\Delta x^{2p-1} (-1)^p k^{2p} \\sin(kx).\n$$\nThe predicted convergence orders for the test cases are:\n- Case 1 ($p=2$): $r = 2(2)+1 = 5$.\n- Case 2 ($p=3$): $r = 2(3)+1 = 7$.\n- Case 3 ($p=4$): $r = 2(4)+1 = 9$.\n- Case 4 ($p=2$, coarse grid): $r=5$, but lower accuracy is expected.\n- Case 5 ($p=2$, near-Nyquist): The asymptotic analysis is expected to fail, leading to an order different from $5$.", "answer": "```python\nimport numpy as np\n\ndef compute_q_discrete(u_grid, p_order, delta_x):\n    \"\"\"\n    Computes the discrete Kreiss-Oliger operator Q on a grid.\n    \n    Args:\n        u_grid (np.ndarray): The field u on a uniform periodic grid.\n        p_order (int): The order parameter p of the KO operator.\n        delta_x (float): The grid spacing.\n        \n    Returns:\n        np.ndarray: The value of the discrete operator Q on the grid.\n    \"\"\"\n    sigma = 1.0\n    \n    # The operator is (D_+ D_-)^p. We implement D_+ D_- and apply it p times.\n    # D+D- u_i = (u_{i+1} - 2u_i + u_{i-1}) / dx^2\n    \n    # Initialize with the input grid function\n    op_u = u_grid\n    \n    # Apply the D_+ D_- operator p times\n    for _ in range(p_order):\n        op_u = (np.roll(op_u, -1) - 2 * op_u + np.roll(op_u, 1)) / (delta_x**2)\n        \n    # The full Q operator\n    q_val = sigma * (delta_x**(2 * p_order - 1)) * op_u\n    return q_val\n\ndef solve():\n    \"\"\"\n    Performs the full analysis for the given test cases.\n    \"\"\"\n    test_cases = [\n        # (p, N, k)\n        (2, 128, 3),  # Case 1\n        (3, 128, 3),  # Case 2\n        (4, 128, 3),  # Case 3\n        (2, 16, 3),   # Case 4\n        (2, 64, 31),  # Case 5\n    ]\n\n    results = []\n    sigma = 1.0\n\n    for p, N, k in test_cases:\n        # Set up two grids: one with N points, one with 2N points.\n        N1 = N\n        N2 = 2 * N\n        \n        # Grid 1\n        dx1 = 2 * np.pi / N1\n        x1 = np.linspace(0, 2 * np.pi, N1, endpoint=False)\n        u1 = np.sin(k * x1)\n        \n        # Grid 2\n        dx2 = 2 * np.pi / N2\n        x2 = np.linspace(0, 2 * np.pi, N2, endpoint=False)\n        u2 = np.sin(k * x2)\n        \n        # --- Compute discrete KO operator Q on both grids ---\n        Q1_discrete = compute_q_discrete(u1, p, dx1)\n        Q2_discrete = compute_q_discrete(u2, p, dx2)\n        \n        # --- Compute continuum target on both grids ---\n        # Q_cont = sigma * dx^(2p-1) * d^(2p)u/dx^(2p)\n        # d^(2p)u/dx^(2p) for u=sin(kx) is (-1)^p * k^(2p) * sin(kx)\n        \n        # Continuum target on grid 1\n        d2p_u1 = (-1)**p * k**(2 * p) * np.sin(k * x1)\n        Q1_continuum = sigma * (dx1**(2 * p - 1)) * d2p_u1\n        \n        # Continuum target on grid 2\n        d2p_u2 = (-1)**p * k**(2 * p) * np.sin(k * x2)\n        Q2_continuum = sigma * (dx2**(2 * p - 1)) * d2p_u2\n        \n        # --- Compute errors ---\n        # Error is the L-infinity norm of the difference\n        E1 = np.max(np.abs(Q1_discrete - Q1_continuum))\n        E2 = np.max(np.abs(Q2_discrete - Q2_continuum))\n        \n        # --- Compute empirical convergence order r ---\n        # r = [ln(E(dx)) - ln(E(dx/2))] / [ln(dx) - ln(dx/2)]\n        # This simplifies to log2(E1 / E2)\n        if E1 > 0 and E2 > 0:\n            order = np.log(E1 / E2) / np.log(2)\n        else:\n            order = np.nan # Avoid log(0) if error is zero (e.g. machine precision)\n\n        results.append(order)\n\n    # Format the final output as specified\n    print(f\"[{','.join([f'{r:.3f}' for r in results])}]\")\n\nsolve()\n\n```", "id": "3481434"}, {"introduction": "Adding a dissipation operator to an evolution equation is a powerful tool for stabilization, but it comes with its own constraints. When combined with an explicit time integration scheme, the dissipation term can introduce new numerical instabilities if not handled carefully. This exercise introduces the von Neumann stability analysis, a cornerstone technique for determining the stability limits of finite difference schemes [@problem_id:3481413]. By deriving the amplification factor $G(\\xi)$ for a model equation with KO dissipation, you will determine the maximum allowable dissipation strength $\\sigma_{\\max}$ that ensures a stable simulation, a critical skill for running robust numerical relativity codes.", "problem": "Consider the Baumgarte-Shapiro-Shibata-Nakamura (BSSN) formulation linearized about Minkowski spacetime on a one-dimensional periodic domain of length $L$, discretized with a uniform grid $x_{j} = j \\,\\Delta x$ for $j = 0, 1, \\dots, N-1$ where $N \\,\\Delta x = L$. In the linearized system, focus on a single decoupled characteristic field with zero continuum speed (for example, a constraint-carrying mode) and model its semi-discrete evolution by adding only a high-order numerical dissipation term. The evolution equation for the grid function $u_{j}(t)$ is\n$$\n\\frac{d}{dt} u_{j}(t) \\;=\\; Q[u]_{j},\n$$\nwhere $Q$ is the fourth-order Kreiss-Oliger dissipation operator defined by\n$$\nQ[u]_{j} \\;=\\; -\\,\\sigma \\,\\Delta x^{3}\\, D_{+}^{2} D_{-}^{2} u_{j}.\n$$\nHere $D_{+}$ and $D_{-}$ are the forward and backward difference operators,\n$$\nD_{+} u_{j} \\;=\\; \\frac{u_{j+1} - u_{j}}{\\Delta x}, \n\\qquad\nD_{-} u_{j} \\;=\\; \\frac{u_{j} - u_{j-1}}{\\Delta x},\n$$\nand $D_{+}^{2} D_{-}^{2} \\equiv (D_{+} D_{-})^{2}$ is applied in the usual composition order. Advance the solution in time using the Forward Euler method with time step $\\Delta t$,\n$$\nu_{j}^{n+1} \\;=\\; u_{j}^{n} \\;+\\; \\Delta t \\, Q[u^{n}]_{j}.\n$$\nPerform a von Neumann analysis: assume a discrete Fourier mode $u_{j}^{n} = \\hat{u}^{n} \\exp\\!\\big(i j \\xi\\big)$ with dimensionless wavenumber $\\xi \\in [-\\pi,\\pi]$, derive the amplification factor $G(\\xi)$, and impose the requirement that no Fourier mode exhibits negative damping and that the one-step amplification remains bounded in magnitude, namely $|G(\\xi)| \\leq 1$ for all $\\xi$. Determine the largest admissible dissipation coefficient $\\sigma_{\\max}$ as a closed-form analytic expression in terms of $\\Delta x$ and $\\Delta t$ such that the above constraints hold for all resolvable Fourier modes. Express your final answer as a single analytic expression for $\\sigma_{\\max}$ with no units attached.", "solution": "The problem as stated is scientifically grounded, well-posed, and objective. It represents a standard von Neumann stability analysis of a finite difference scheme, a fundamental procedure in the field of numerical methods for partial differential equations. The setup is a simplified but representative model used in numerical relativity to study the stability properties of dissipation terms. All necessary information is provided, and there are no contradictions. Therefore, the problem is valid, and I will proceed with the solution.\n\nThe task is to find the maximum admissible dissipation coefficient $\\sigma_{\\max}$ for the given numerical scheme. The scheme consists of a semi-discrete evolution equation for a grid function $u_j(t)$, which is then discretized in time using the Forward Euler method. The stability is to be analyzed using the von Neumann method.\n\nThe semi-discrete evolution equation is given by\n$$\n\\frac{d}{dt} u_{j}(t) = Q[u]_{j}\n$$\nwhere $Q$ is the fourth-order Kreiss-Oliger dissipation operator:\n$$\nQ[u]_{j} = -\\sigma \\Delta x^{3} D_{+}^{2} D_{-}^{2} u_{j} = -\\sigma \\Delta x^{3} (D_{+} D_{-})^{2} u_{j}\n$$\nThe time integration is performed using the Forward Euler method:\n$$\nu_{j}^{n+1} = u_{j}^{n} + \\Delta t \\, Q[u^{n}]_{j}\n$$\n\nFor the von Neumann analysis, we substitute a single Fourier mode $u_j^n = \\hat{u}^n \\exp(i j \\xi)$ into the fully discrete equation. Here, $\\xi = k \\Delta x$ is the dimensionless wavenumber, with $k$ being the wavenumber, and $\\xi \\in [-\\pi, \\pi]$ for all resolvable modes on the grid. The amplification factor is defined as $G(\\xi) = \\hat{u}^{n+1}/\\hat{u}^{n}$.\n\nSubstituting the Fourier mode into the Forward Euler equation yields:\n$$\n\\hat{u}^{n+1} e^{i j \\xi} = \\hat{u}^{n} e^{i j \\xi} + \\Delta t \\, Q[\\hat{u}^{n} e^{i j \\xi}]_{j}\n$$\nThe operator $Q$ is a linear, constant-coefficient difference operator. Its action on a Fourier mode is to multiply it by a complex number, its symbol, denoted $\\hat{Q}(\\xi)$. Thus, $Q[e^{i j \\xi}]_{j} = \\hat{Q}(\\xi) e^{i j \\xi}$. The equation becomes:\n$$\n\\hat{u}^{n+1} e^{i j \\xi} = \\hat{u}^{n} e^{i j \\xi} + \\Delta t \\, \\hat{u}^{n} \\hat{Q}(\\xi) e^{i j \\xi}\n$$\nDividing by $\\hat{u}^{n} e^{i j \\xi}$, we find the amplification factor:\n$$\nG(\\xi) = 1 + \\Delta t \\, \\hat{Q}(\\xi)\n$$\n\nTo find $G(\\xi)$, we must first determine the symbol $\\hat{Q}(\\xi)$ of the operator $Q$. The operator is $Q = -\\sigma \\Delta x^3 (D_+ D_-)^2$. We find the symbol of $D_+ D_-$ first.\nThe forward and backward difference operators, $D_+$ and $D_ -$, have symbols:\n$$\n\\widehat{D_+}(\\xi) = \\frac{e^{i\\xi} - 1}{\\Delta x}\n$$\n$$\n\\widehat{D_-}(\\xi) = \\frac{1 - e^{-i\\xi}}{\\Delta x}\n$$\nThe symbol of the composite operator $D_+ D_-$ is the product of their symbols:\n$$\n\\widehat{D_+ D_-}(\\xi) = \\widehat{D_+}(\\xi) \\widehat{D_-}(\\xi) = \\frac{(e^{i\\xi} - 1)(1 - e^{-i\\xi})}{(\\Delta x)^2} = \\frac{e^{i\\xi} - e^{i\\xi}e^{-i\\xi} - 1 + e^{-i\\xi}}{(\\Delta x)^2}\n$$\n$$\n\\widehat{D_+ D_-}(\\xi) = \\frac{e^{i\\xi} + e^{-i\\xi} - 2}{(\\Delta x)^2} = \\frac{2\\cos(\\xi) - 2}{(\\Delta x)^2}\n$$\nUsing the half-angle identity $1 - \\cos(\\xi) = 2\\sin^2(\\xi/2)$, we get:\n$$\n\\widehat{D_+ D_-}(\\xi) = -\\frac{4\\sin^2(\\xi/2)}{(\\Delta x)^2}\n$$\nThe operator in $Q$ is $(D_+ D_-)^2$, so its symbol is the square of the symbol of $D_+ D_-$:\n$$\n\\widehat{(D_+ D_-)^2}(\\xi) = \\left( -\\frac{4\\sin^2(\\xi/2)}{(\\Delta x)^2} \\right)^2 = \\frac{16\\sin^4(\\xi/2)}{(\\Delta x)^4}\n$$\nNow, we can find the symbol of the full operator $Q$:\n$$\n\\hat{Q}(\\xi) = -\\sigma \\Delta x^3 \\widehat{(D_+ D_-)^2}(\\xi) = -\\sigma \\Delta x^3 \\left( \\frac{16\\sin^4(\\xi/2)}{(\\Delta x)^4} \\right) = -\\frac{16\\sigma}{\\Delta x} \\sin^4(\\xi/2)\n$$\nSubstituting this into the expression for the amplification factor:\n$$\nG(\\xi) = 1 + \\Delta t \\left( -\\frac{16\\sigma}{\\Delta x} \\sin^4(\\xi/2) \\right) = 1 - \\frac{16\\sigma \\Delta t}{\\Delta x} \\sin^4(\\xi/2)\n$$\n\nThe problem imposes two constraints on $\\sigma$:\n1. No Fourier mode exhibits negative damping.\n2. The one-step amplification remains bounded in magnitude, $|G(\\xi)| \\leq 1$.\n\nLet's analyze the first constraint. For a purely dissipative system, the rate of change of a mode's amplitude is governed by the real part of the operator's symbol. Negative damping corresponds to growth, i.e., $\\operatorname{Re}(\\hat{Q}(\\xi)) > 0$. The constraint of no negative damping is therefore $\\operatorname{Re}(\\hat{Q}(\\xi)) \\leq 0$.\nSince $\\hat{Q}(\\xi)$ is purely real, this simplifies to $\\hat{Q}(\\xi) \\leq 0$.\n$$\n-\\frac{16\\sigma}{\\Delta x} \\sin^4(\\xi/2) \\leq 0\n$$\nGiven that $\\Delta x > 0$ and $\\sin^4(\\xi/2) \\geq 0$ for all $\\xi$, this inequality requires $-16\\sigma \\leq 0$, which implies $\\sigma \\geq 0$. This ensures that the operator $Q$ is indeed dissipative for all modes.\n\nNow, let's analyze the second constraint, $|G(\\xi)| \\leq 1$. This is equivalent to $-1 \\leq G(\\xi) \\leq 1$.\n$$\n-1 \\leq 1 - \\frac{16\\sigma \\Delta t}{\\Delta x} \\sin^4(\\xi/2) \\leq 1\n$$\nLet's analyze the two inequalities separately.\nThe right-hand inequality is:\n$$\n1 - \\frac{16\\sigma \\Delta t}{\\Delta x} \\sin^4(\\xi/2) \\leq 1 \\quad\\implies\\quad -\\frac{16\\sigma \\Delta t}{\\Delta x} \\sin^4(\\xi/2) \\leq 0\n$$\nWith $\\sigma \\geq 0$, $\\Delta t > 0$, $\\Delta x > 0$, and $\\sin^4(\\xi/2) \\geq 0$, this inequality is always satisfied.\n\nThe left-hand inequality is:\n$$\n-1 \\leq 1 - \\frac{16\\sigma \\Delta t}{\\Delta x} \\sin^4(\\xi/2)\n$$\nRearranging the terms, we get:\n$$\n\\frac{16\\sigma \\Delta t}{\\Delta x} \\sin^4(\\xi/2) \\leq 2\n$$\nThis inequality must hold for all resolvable wavenumbers, i.e., for all $\\xi \\in [-\\pi, \\pi]$. To find the most restrictive condition on $\\sigma$, we must find the maximum value of the term $\\sin^4(\\xi/2)$. The function $\\sin(\\xi/2)$ has a maximum magnitude of $1$ at $\\xi = \\pm\\pi$. Therefore, the maximum value of $\\sin^4(\\xi/2)$ is $1$.\nThe inequality must hold in this worst-case scenario:\n$$\n\\frac{16\\sigma \\Delta t}{\\Delta x} (1) \\leq 2\n$$\nSolving for $\\sigma$:\n$$\n\\sigma \\leq \\frac{2 \\Delta x}{16 \\Delta t} = \\frac{\\Delta x}{8 \\Delta t}\n$$\nCombining this with the condition $\\sigma \\geq 0$, we find the range of admissible values for the dissipation coefficient is $0 \\leq \\sigma \\leq \\frac{\\Delta x}{8 \\Delta t}$.\n\nThe largest admissible dissipation coefficient, $\\sigma_{\\max}$, is the upper bound of this range.\n$$\n\\sigma_{\\max} = \\frac{\\Delta x}{8 \\Delta t}\n$$\nThis is the stability limit for the Forward Euler time-stepping of the fourth-order Kreiss-Oliger dissipation operator.", "answer": "$$\\boxed{\\frac{\\Delta x}{8 \\Delta t}}$$", "id": "3481413"}, {"introduction": "Numerical relativity simulations rarely involve single, decoupled equations; instead, they feature complex systems of coupled partial differential equations. This practice extends the analysis of dissipation to a more realistic scenario: a coupled subsystem modeling constraint propagation. By examining a $2\\times 2$ system, you will learn how to apply Fourier analysis to derive a semi-discrete amplification matrix and compute its eigenvalues [@problem_id:3481432]. This reveals how dissipation affects the different modes of the system, providing insight into its ability to selectively damp unphysical constraint violations while minimally affecting the physical, propagating degrees of freedom.", "problem": "Consider a simplified linear constraint-propagation subsystem that models the evolution of two constraint variables $C(x,t)$ and $Z(x,t)$ arising in formulations used in numerical relativity for gravitational-wave spacetimes. The continuum system is\n$$\n\\partial_{t} C = -\\,\\partial_{x} Z,\\qquad\n\\partial_{t} Z = -\\,c^{2}\\,\\partial_{x} C - \\gamma\\, Z,\n$$\nwhere $c>0$ is a characteristic propagation speed and $\\gamma\\ge 0$ is a physical constraint-damping parameter. Discretize space on a uniform grid $x_{j} = j \\Delta x$ of spacing $\\Delta x>0$ and use the Method of Lines (MOL) with second-order centered finite differences for the first spatial derivative. Augment both semi-discrete equations with fourth-order Kreiss-Oliger (KO) dissipation, defined by adding $-\\sigma\\,\\Delta x^{3} D_{+}^{2} D_{-}^{2}$ acting on the evolved variable, where $D_{+}$ and $D_{-}$ are the forward and backward difference operators, respectively, and $\\sigma>0$ is a dimensionless dissipation coefficient. Assume periodic boundary conditions and analyze a single Fourier mode of wavenumber $k$.\n\nStarting from the continuum system and the stated discretizations, derive the semi-discrete symbol for this Fourier mode and compute the two eigenvalues of the resulting $2\\times 2$ amplification matrix. Express your final answer as a single closed-form analytic expression in terms of $c$, $\\gamma$, $\\sigma$, $\\Delta x$, and $k$. Do not substitute numerical values. Your final answer must be the pair of eigenvalues written as a row matrix using the LaTeX $\\texttt{pmatrix}$ environment. No rounding is required and no units should be reported in the final answer.", "solution": "The user wants to find the eigenvalues of the amplification matrix for a discretized system of partial differential equations.\n\n### Step 1: Problem Validation\n\nThe problem is first validated against the specified criteria.\n\n#### Step 1.1: Extract Givens\n\n*   **Continuum System:**\n    $\n    \\partial_{t} C = -\\,\\partial_{x} Z\n    $\n    $\n    \\partial_{t} Z = -\\,c^{2}\\,\\partial_{x} C - \\gamma\\, Z\n    $\n*   **Parameters and Variables:**\n    *   $C(x, t)$, $Z(x, t)$: Constraint variables.\n    *   $c > 0$: Characteristic propagation speed.\n    *   $\\gamma \\ge 0$: Physical constraint-damping parameter.\n*   **Discretization Scheme:**\n    *   Method of Lines (MOL) on a uniform grid $x_{j} = j \\Delta x$ with spacing $\\Delta x>0$.\n    *   The first spatial derivative $\\partial_x$ is approximated by a second-order centered finite difference.\n*   **Dissipation:**\n    *   Fourth-order Kreiss-Oliger (KO) dissipation term is added: $-\\sigma\\,\\Delta x^{3} D_{+}^{2} D_{-}^{2}$.\n    *   $D_{+}$ and $D_{-}$ are the forward and backward difference operators.\n    *   $\\sigma > 0$ is a dimensionless dissipation coefficient.\n*   **Boundary Conditions and Analysis:**\n    *   Periodic boundary conditions are assumed.\n    *   The analysis is for a single Fourier mode with wavenumber $k$.\n*   **Objective:**\n    *   Derive the semi-discrete symbol (amplification matrix) for a Fourier mode.\n    *   Compute the two eigenvalues of this matrix.\n    *   The result must be a single closed-form analytic expression in terms of $c$, $\\gamma$, $\\sigma$, $\\Delta x$, and $k$.\n\n#### Step 1.2: Validate Using Extracted Givens\n\n*   **Scientific Grounding:** The problem describes a system of linear hyperbolic partial differential equations, a common model in physics and engineering. The numerical methods specified—Method of Lines, centered finite differences, and Kreiss-Oliger dissipation—are standard and widely used techniques for solving such equations, particularly in fields like numerical relativity. The setup is scientifically and mathematically sound.\n*   **Well-Posedness:** The problem is clearly defined. It asks for a specific mathematical derivation (eigenvalues of a matrix) based on a complete set of instructions. The existence of a unique, meaningful solution is guaranteed by the well-defined mathematical operations.\n*   **Objectivity:** The problem is stated in precise, objective, and standard mathematical language. It is free of any ambiguity, subjectivity, or opinion-based claims.\n\nAll other criteria for validity (completeness, consistency, feasibility, etc.) are met. The problem is a standard exercise in the stability analysis of numerical schemes for PDEs.\n\n#### Step 1.3: Verdict and Action\n\n*   **Verdict:** The problem is **valid**.\n*   **Action:** Proceed with the full derivation and solution.\n\n### Step 2: Derivation of the Solution\n\nThe solution is derived by applying Fourier analysis to the semi-discretized system.\n\n**1. Semi-Discretization using Method of Lines (MOL)**\n\nWe discretize in space, leaving time continuous. The grid points are $x_j = j \\Delta x$. The functions $C(x_j, t)$ and $Z(x_j, t)$ are denoted by $C_j(t)$ and $Z_j(t)$. The second-order centered difference approximation for the first spatial derivative $\\partial_x$ applied to a grid function $f_j$ is given by:\n$$\n\\delta_{2x} f_j = \\frac{f_{j+1} - f_{j-1}}{2\\Delta x}\n$$\nApplying this to the continuum system gives the semi-discrete equations for the variables at grid point $j$:\n$$\n\\frac{d C_j}{dt} = - \\frac{Z_{j+1} - Z_{j-1}}{2\\Delta x}\n$$\n$$\n\\frac{d Z_j}{dt} = -c^2 \\frac{C_{j+1} - C_{j-1}}{2\\Delta x} - \\gamma Z_j\n$$\n\n**2. Incorporating Kreiss-Oliger Dissipation**\n\nThe problem specifies adding a fourth-order Kreiss-Oliger dissipation term, $-\\sigma \\Delta x^3 D_+^2 D_-^2$, to each evolution equation. The forward and backward difference operators are defined as $D_+ f_j = (f_{j+1} - f_j)/\\Delta x$ and $D_- f_j = (f_j - f_{j-1})/\\Delta x$. The full semi-discrete system becomes:\n$$\n\\frac{d C_j}{dt} = - \\frac{Z_{j+1} - Z_{j-1}}{2\\Delta x} - \\sigma \\Delta x^3 D_+^2 D_-^2 C_j\n$$\n$$\n\\frac{d Z_j}{dt} = -c^2 \\frac{C_{j+1} - C_{j-1}}{2\\Delta x} - \\gamma Z_j - \\sigma \\Delta x^3 D_+^2 D_-^2 Z_j\n$$\n\n**3. Fourier Analysis**\n\nWe analyze the system for a single Fourier mode. We make the ansatz that the solution at each grid point has the form of a plane wave:\n$$\nC_j(t) = \\hat{C}(t) e^{i k x_j} = \\hat{C}(t) e^{i k j \\Delta x}\n$$\n$$\nZ_j(t) = \\hat{Z}(t) e^{i k x_j} = \\hat{Z}(t) e^{i k j \\Delta x}\n$$\nwhere $\\hat{C}$ and $\\hat{Z}$ are the time-dependent Fourier amplitudes, $k$ is the wavenumber, and $i = \\sqrt{-1}$. We now find the Fourier symbol (also known as the amplification factor) for each operator.\n\nThe symbol of the centered difference operator $\\delta_{2x}$ is found by applying it to $e^{i k j \\Delta x}$:\n$$\n\\delta_{2x} e^{i k j \\Delta x} = \\frac{e^{i k (j+1) \\Delta x} - e^{i k (j-1) \\Delta x}}{2\\Delta x} = \\frac{e^{i k \\Delta x} - e^{-i k \\Delta x}}{2\\Delta x} e^{i k j \\Delta x} = \\frac{2i \\sin(k\\Delta x)}{2\\Delta x} e^{i k j \\Delta x} = \\frac{i \\sin(k\\Delta x)}{\\Delta x} e^{i k j \\Delta x}\n$$\nSo, the symbol for $\\partial_x$ is $\\hat{\\partial}_x = i \\frac{\\sin(k\\Delta x)}{\\Delta x}$.\n\nThe symbol of the Kreiss-Oliger dissipation operator $-\\sigma \\Delta x^3 D_+^2 D_-^2$ is derived as follows. The symbols for $D_+$ and $D_-$ are:\n$$\n\\hat{D}_+ = \\frac{e^{ik\\Delta x} - 1}{\\Delta x}\n$$\n$$\n\\hat{D}_- = \\frac{1 - e^{-ik\\Delta x}}{\\Delta x}\n$$\nThe symbol for the product $D_+ D_-$ is:\n$$\n\\widehat{D_+ D_-} = \\hat{D}_+ \\hat{D}_- = \\frac{(e^{ik\\Delta x} - 1)(1 - e^{-ik\\Delta x})}{\\Delta x^2} = \\frac{1 - e^{-ik\\Delta x} - e^{ik\\Delta x} + 1}{\\Delta x^2} = \\frac{2(1 - \\cos(k\\Delta x))}{\\Delta x^2}\n$$\nUsing the half-angle identity $1 - \\cos(\\theta) = 2 \\sin^2(\\theta/2)$, this becomes:\n$$\n\\widehat{D_+ D_-} = \\frac{4 \\sin^2(k\\Delta x/2)}{\\Delta x^2}\n$$\nThe symbol for the full dissipation operator involves the square of this term:\n$$\n\\widehat{K} = -\\sigma \\Delta x^3 \\left(\\widehat{D_+ D_-}\\right)^2 = -\\sigma \\Delta x^3 \\left(\\frac{4 \\sin^2(k\\Delta x/2)}{\\Delta x^2}\\right)^2 = -\\frac{16 \\sigma}{\\Delta x} \\sin^4\\left(\\frac{k\\Delta x}{2}\\right)\n$$\nThis symbol is a real, non-positive number, which provides numerical damping.\n\n**4. The System in Fourier Space**\n\nSubstituting the Fourier ansatz and the operator symbols into the semi-discrete equations yields a system of ordinary differential equations for the amplitudes $\\hat{C}$ and $\\hat{Z}$:\n$$\n\\frac{d \\hat{C}}{dt} = - \\left(i \\frac{\\sin(k\\Delta x)}{\\Delta x}\\right) \\hat{Z} + \\left(-\\frac{16 \\sigma}{\\Delta x} \\sin^4\\left(\\frac{k\\Delta x}{2}\\right)\\right) \\hat{C}\n$$\n$$\n\\frac{d \\hat{Z}}{dt} = -c^2 \\left(i \\frac{\\sin(k\\Delta x)}{\\Delta x}\\right) \\hat{C} - \\gamma \\hat{Z} + \\left(-\\frac{16 \\sigma}{\\Delta x} \\sin^4\\left(\\frac{k\\Delta x}{2}\\right)\\right) \\hat{Z}\n$$\nThis can be written in matrix form, $\\frac{d}{dt} \\mathbf{\\hat{u}} = M \\mathbf{\\hat{u}}$, where $\\mathbf{\\hat{u}} = \\begin{pmatrix} \\hat{C} \\\\ \\hat{Z} \\end{pmatrix}$ and $M$ is the amplification matrix:\n$$\nM = \\begin{pmatrix}\n-\\frac{16 \\sigma}{\\Delta x} \\sin^4\\left(\\frac{k\\Delta x}{2}\\right) & -i \\frac{\\sin(k\\Delta x)}{\\Delta x} \\\\\n-i c^2 \\frac{\\sin(k\\Delta x)}{\\Delta x} & -\\gamma - \\frac{16 \\sigma}{\\Delta x} \\sin^4\\left(\\frac{k\\Delta x}{2}\\right)\n\\end{pmatrix}\n$$\n\n**5. Eigenvalue Calculation**\n\nThe eigenvalues $\\lambda$ of the matrix $M$ are the solutions to the characteristic equation $\\det(M - \\lambda I) = 0$, where $I$ is the identity matrix.\n$$\n\\det\n\\begin{pmatrix}\n-\\frac{16 \\sigma}{\\Delta x} \\sin^4\\left(\\frac{k\\Delta x}{2}\\right) - \\lambda & -i \\frac{\\sin(k\\Delta x)}{\\Delta x} \\\\\n-i c^2 \\frac{\\sin(k\\Delta x)}{\\Delta x} & -\\gamma - \\frac{16 \\sigma}{\\Delta x} \\sin^4\\left(\\frac{k\\Delta x}{2}\\right) - \\lambda\n\\end{pmatrix}\n= 0\n$$\nLet's simplify by defining $\\mathcal{K} = -\\frac{16 \\sigma}{\\Delta x} \\sin^4\\left(\\frac{k\\Delta x}{2}\\right)$ and $\\mathcal{D} = i \\frac{\\sin(k\\Delta x)}{\\Delta x}$. The matrix is $M = \\begin{pmatrix} \\mathcal{K} & -\\mathcal{D} \\\\ -c^2 \\mathcal{D} & -\\gamma+\\mathcal{K} \\end{pmatrix}$. The characteristic equation is:\n$$\n(\\mathcal{K} - \\lambda)(-\\gamma + \\mathcal{K} - \\lambda) - (- \\mathcal{D})(-c^2 \\mathcal{D}) = 0\n$$\n$$\n(\\mathcal{K} - \\lambda)^2 - \\gamma(\\mathcal{K} - \\lambda) - c^2 \\mathcal{D}^2 = 0\n$$\nSubstituting $\\mathcal{D}^2 = \\left(i \\frac{\\sin(k\\Delta x)}{\\Delta x}\\right)^2 = -\\frac{\\sin^2(k\\Delta x)}{\\Delta x^2}$:\n$$\n(\\mathcal{K} - \\lambda)^2 - \\gamma(\\mathcal{K} - \\lambda) + c^2 \\frac{\\sin^2(k\\Delta x)}{\\Delta x^2} = 0\n$$\nLet $\\Lambda = \\mathcal{K} - \\lambda$. The equation for $\\Lambda$ is:\n$$\n\\Lambda^2 - \\gamma \\Lambda + c^2 \\frac{\\sin^2(k\\Delta x)}{\\Delta x^2} = 0\n$$\nUsing the quadratic formula for $\\Lambda$:\n$$\n\\Lambda = \\frac{\\gamma \\pm \\sqrt{(-\\gamma)^2 - 4(1)\\left(c^2 \\frac{\\sin^2(k\\Delta x)}{\\Delta x^2}\\right)}}{2} = \\frac{\\gamma}{2} \\pm \\frac{1}{2}\\sqrt{\\gamma^2 - \\frac{4c^2 \\sin^2(k\\Delta x)}{\\Delta x^2}}\n$$\nNow, solving for $\\lambda = \\mathcal{K} - \\Lambda$:\n$$\n\\lambda = \\mathcal{K} - \\left( \\frac{\\gamma}{2} \\pm \\frac{1}{2}\\sqrt{\\gamma^2 - \\frac{4c^2 \\sin^2(k\\Delta x)}{\\Delta x^2}} \\right)\n$$\n$$\n\\lambda = \\mathcal{K} - \\frac{\\gamma}{2} \\mp \\sqrt{\\frac{\\gamma^2}{4} - \\frac{c^2 \\sin^2(k\\Delta x)}{\\Delta x^2}}\n$$\nSince $\\pm$ and $\\mp$ cover the same pair of solutions, we can use $\\pm$:\n$$\n\\lambda = \\mathcal{K} - \\frac{\\gamma}{2} \\pm \\sqrt{\\frac{\\gamma^2}{4} - \\frac{c^2 \\sin^2(k\\Delta x)}{\\Delta x^2}}\n$$\nSubstituting back the expression for $\\mathcal{K}$:\n$$\n\\lambda = -\\frac{16 \\sigma}{\\Delta x} \\sin^4\\left(\\frac{k\\Delta x}{2}\\right) - \\frac{\\gamma}{2} \\pm \\sqrt{\\frac{\\gamma^2}{4} - \\frac{c^2 \\sin^2(k\\Delta x)}{\\Delta x^2}}\n$$\nThese are the two eigenvalues of the amplification matrix. They represent the growth rates of the Fourier modes in the semi-discrete system.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-\\frac{16\\sigma}{\\Delta x} \\sin^4\\left(\\frac{k\\Delta x}{2}\\right) - \\frac{\\gamma}{2} + \\sqrt{\\frac{\\gamma^2}{4} - \\frac{c^2 \\sin^2(k\\Delta x)}{\\Delta x^2}} & -\\frac{16\\sigma}{\\Delta x} \\sin^4\\left(\\frac{k\\Delta x}{2}\\right) - \\frac{\\gamma}{2} - \\sqrt{\\frac{\\gamma^2}{4} - \\frac{c^2 \\sin^2(k\\Delta x)}{\\Delta x^2}}\n\\end{pmatrix}\n}\n$$", "id": "3481432"}]}