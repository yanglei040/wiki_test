{"hands_on_practices": [{"introduction": "The well-known Courant-Friedrichs-Lewy (CFL) condition, $\\Delta t \\le C \\frac{h}{s_{\\max}}$, involves a constant $C$ that is not universal; it is determined by the specific numerical scheme. This exercise [@problem_id:3487852] focuses on the crucial role of the time integration method, challenging you to analyze several Strong Stability Preserving (SSP) Runge-Kutta schemes. By dissecting their structure, you will determine their SSP coefficients and discover how a clever choice of time-stepper can significantly increase the maximum stable time step, enhancing computational efficiency.", "problem": "In numerical relativity, gauge drivers often include advection along the shift vector, which we idealize in one spatial dimension by the linear advection model for a gauge variable $g(x,t)$,\n$$\n\\partial_{t} g + \\beta\\, \\partial_{x} g = 0,\n$$\nwhere $\\beta$ is the (possibly large) shift speed. Consider a uniform grid with spacing $h>0$ and a monotone first-order upwind spatial discretization, which ensures forward Euler monotonicity for a time step $\\Delta t$ whenever\n$$\n\\Delta t \\le \\Delta t_{\\mathrm{FE}} = \\frac{h}{|\\beta|}.\n$$\nWe apply explicit Strong Stability Preserving Runge–Kutta (SSPRK) schemes written in Shu–Osher form to the semi-discrete ordinary differential equation $\\dot{u} = L(u)$ obtained from the spatial discretization of the advection equation. A SSPRK method is said to preserve monotonicity under the same convex functional as forward Euler provided it can be expressed as a convex combination of forward Euler steps; in that case, there exists a Strong Stability Preserving coefficient $c_{\\mathrm{SSP}}>0$ such that monotonicity holds for the Runge–Kutta method whenever\n$$\n\\Delta t \\le c_{\\mathrm{SSP}}\\, \\Delta t_{\\mathrm{FE}}.\n$$\nAssume a computational budget that allows at most four stages per time step. Consider the following SSPRK schemes in Shu–Osher form:\n1. The two-stage, second-order scheme $\\mathrm{SSPRK}(2,2)$:\n$$\n\\begin{aligned}\nu^{(1)} &= u^{n} + \\Delta t\\, L\\!\\left(u^{n}\\right), \\\\\nu^{n+1} &= \\frac{1}{2}\\, u^{n} + \\frac{1}{2}\\left[ u^{(1)} + \\Delta t\\, L\\!\\left(u^{(1)}\\right) \\right].\n\\end{aligned}\n$$\n2. The three-stage, third-order scheme $\\mathrm{SSPRK}(3,3)$:\n$$\n\\begin{aligned}\nu^{(1)} &= u^{n} + \\Delta t\\, L\\!\\left(u^{n}\\right), \\\\\nu^{(2)} &= \\frac{3}{4}\\, u^{n} + \\frac{1}{4}\\left[ u^{(1)} + \\Delta t\\, L\\!\\left(u^{(1)}\\right) \\right], \\\\\nu^{n+1} &= \\frac{1}{3}\\, u^{n} + \\frac{2}{3}\\left[ u^{(2)} + \\Delta t\\, L\\!\\left(u^{(2)}\\right) \\right].\n\\end{aligned}\n$$\n3. A four-stage, third-order scheme $\\mathrm{SSPRK}(4,3)$:\n$$\n\\begin{aligned}\nu^{(1)} &= u^{n} + \\frac{1}{2}\\, \\Delta t\\, L\\!\\left(u^{n}\\right), \\\\\nu^{(2)} &= u^{(1)} + \\frac{1}{2}\\, \\Delta t\\, L\\!\\left(u^{(1)}\\right), \\\\\nu^{(3)} &= \\frac{2}{3}\\, u^{n} + \\frac{1}{3}\\left[ u^{(2)} + \\frac{1}{2}\\, \\Delta t\\, L\\!\\left(u^{(2)}\\right) \\right], \\\\\nu^{n+1} &= u^{(3)} + \\frac{1}{2}\\, \\Delta t\\, L\\!\\left(u^{(3)}\\right).\n\\end{aligned}\n$$\nStarting from the definition of Strong Stability Preserving time stepping as convex combinations of forward Euler steps, determine the Strong Stability Preserving coefficient $c_{\\mathrm{SSP}}$ for each scheme listed above by identifying the largest forward Euler substep size (as a fraction of $\\Delta t$) that appears in the Shu–Osher decomposition. Then, under the restriction of at most four stages per time step, choose the scheme order that maximizes the allowable monotone time step and compute the corresponding Courant–Friedrichs–Lewy time step bound $\\Delta t_{\\max}$ for the advection-dominated gauge equation. Express your final answer as a single analytic expression in terms of $h$ and $\\beta$. No numerical rounding is required.", "solution": "The user has provided a problem statement that requires validation before a solution is attempted.\n\n### Step 1: Extract Givens\n- **Governing Equation**: The linear advection model for a gauge variable $g(x,t)$ is given by $\\partial_{t} g + \\beta\\, \\partial_{x} g = 0$, where $\\beta$ is the shift speed.\n- **Discretization**: A uniform grid with spacing $h>0$ and a monotone first-order upwind spatial discretization are used, leading to the semi-discrete ordinary differential equation (ODE) system $\\dot{u} = L(u)$.\n- **Forward Euler (FE) Monotonicity Condition**: The forward Euler method is monotone for a time step $\\Delta t$ provided that $\\Delta t \\le \\Delta t_{\\mathrm{FE}} = \\frac{h}{|\\beta|}$.\n- **Strong Stability Preserving (SSP) Condition**: An explicit SSP Runge-Kutta (SSPRK) method preserves monotonicity if it can be expressed as a convex combination of forward Euler steps. Monotonicity holds for a SSPRK method with SSP coefficient $c_{\\mathrm{SSP}}>0$ when the time step $\\Delta t$ satisfies $\\Delta t \\le c_{\\mathrm{SSP}}\\, \\Delta t_{\\mathrm{FE}}$.\n- **Computational Constraint**: The computational budget allows at most four stages per time step.\n- **SSPRK Schemes (Shu-Osher form)**:\n    1.  **SSPRK(2,2)** (two-stage, second-order):\n        $$\n        \\begin{aligned}\n        u^{(1)} &= u^{n} + \\Delta t\\, L(u^{n}), \\\\\n        u^{n+1} &= \\frac{1}{2}\\, u^{n} + \\frac{1}{2}\\left[ u^{(1)} + \\Delta t\\, L(u^{(1)}) \\right].\n        \\end{aligned}\n        $$\n    2.  **SSPRK(3,3)** (three-stage, third-order):\n        $$\n        \\begin{aligned}\n        u^{(1)} &= u^{n} + \\Delta t\\, L(u^{n}), \\\\\n        u^{(2)} &= \\frac{3}{4}\\, u^{n} + \\frac{1}{4}\\left[ u^{(1)} + \\Delta t\\, L(u^{(1)}) \\right], \\\\\n        u^{n+1} &= \\frac{1}{3}\\, u^{n} + \\frac{2}{3}\\left[ u^{(2)} + \\Delta t\\, L(u^{(2)}) \\right].\n        \\end{aligned}\n        $$\n    3.  **SSPRK(4,3)** (four-stage, third-order):\n        $$\n        \\begin{aligned}\n        u^{(1)} &= u^{n} + \\frac{1}{2}\\, \\Delta t\\, L(u^{n}), \\\\\n        u^{(2)} &= u^{(1)} + \\frac{1}{2}\\, \\Delta t\\, L(u^{(1)}), \\\\\n        u^{(3)} &= \\frac{2}{3}\\, u^{n} + \\frac{1}{3}\\left[ u^{(2)} + \\frac{1}{2}\\, \\Delta t\\, L(u^{(2)}) \\right], \\\\\n        u^{n+1} &= u^{(3)} + \\frac{1}{2}\\, \\Delta t\\, L(u^{(3)}).\n        \\end{aligned}\n        $$\n- **Task**:\n    1.  Determine the SSP coefficient $c_{\\mathrm{SSP}}$ for each scheme.\n    2.  Choose the scheme order that maximizes the allowable monotone time step.\n    3.  Compute the corresponding maximum time step bound, $\\Delta t_{\\max}$, in terms of $h$ and $\\beta$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is subjected to a rigorous validation procedure.\n- **Scientifically Grounded**: The problem is based on established concepts in numerical analysis for partial differential equations, specifically the theory of Strong Stability Preserving (SSP) time-stepping methods applied to hyperbolic conservation laws. The schemes presented are standard and well-documented in scientific literature. The context of numerical relativity and gauge drivers is appropriate and realistic. The problem is scientifically sound.\n- **Well-Posed**: The problem is clearly structured. The definitions of the schemes are provided, and the method for determining the SSP coefficient is described. The objective is unambiguous: calculate coefficients and perform a constrained optimization. A unique solution exists.\n- **Objective**: The problem is stated in precise mathematical language, free from subjectivity or bias.\n- **Incomplete or Contradictory Setup**: The problem is self-contained. All necessary equations, definitions, and constraints are provided. There are no contradictions.\n- **Other Flaws**: The problem is not trivial, metaphorical, or outside the scope of scientific verification.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. A complete, reasoned solution will be provided.\n\n### Solution\nThe problem requires us to determine the Strong Stability Preserving (SSP) coefficient, $c_{\\mathrm{SSP}}$, for three given Runge-Kutta schemes, and then to find the maximum allowable time step among them.\n\nA SSPRK method, when written in Shu-Osher form, can be interpreted as a convex combination of forward Euler (FE) operators. The operator $\\mathcal{F}(\\delta t) v = v + \\delta t L(v)$ represents a forward Euler step with step size $\\delta t$. For the linear advection equation discretized with a monotone scheme, this operator preserves monotonicity provided $\\delta t \\le \\Delta t_{\\mathrm{FE}} = \\frac{h}{|\\beta|}$.\n\nThe Shu-Osher form of an SSPRK scheme involves terms of the form $u^{(k)} + \\gamma_i \\Delta t L(u^{(k)})$, which corresponds to an FE step with an effective step size of $\\delta t_i = \\gamma_i \\Delta t$. For the entire SSPRK scheme to preserve monotonicity, every one of these FE substeps must be monotone. This imposes the condition $\\gamma_i \\Delta t \\le \\Delta t_{\\mathrm{FE}}$ for all fractional coefficients $\\gamma_i$ that appear in the scheme's definition.\n\nThis leads to a global time step restriction for the SSPRK method:\n$$\n\\Delta t \\max_i(\\gamma_i) \\le \\Delta t_{\\mathrm{FE}} \\implies \\Delta t \\le \\frac{1}{\\max_i(\\gamma_i)} \\Delta t_{\\mathrm{FE}}\n$$\nBy comparing this with the given definition $\\Delta t \\le c_{\\mathrm{SSP}} \\Delta t_{\\mathrm{FE}}$, we identify the SSP coefficient as:\n$$\nc_{\\mathrm{SSP}} = \\frac{1}{\\max_i(\\gamma_i)}\n$$\nwhere $\\max_i(\\gamma_i)$ is the largest fractional coefficient multiplying $\\Delta t L(\\cdot)$ in the Shu-Osher decomposition of the scheme. We now analyze each scheme to find this value.\n\n**1. SSPRK(2,2) Scheme:**\nThe scheme is:\n$$\n\\begin{aligned}\nu^{(1)} &= u^{n} + \\mathbf{1} \\cdot \\Delta t\\, L(u^{n}) \\\\\nu^{n+1} &= \\frac{1}{2}\\, u^{n} + \\frac{1}{2}\\left[ u^{(1)} + \\mathbf{1} \\cdot \\Delta t\\, L(u^{(1)}) \\right]\n\\end{aligned}\n$$\nThe fractional coefficients of $\\Delta t L(\\cdot)$ are $\\gamma_1 = 1$ in the first stage and $\\gamma_2 = 1$ in the second stage.\nThe maximum fractional coefficient is $\\max(\\gamma_i) = 1$.\nThe SSP coefficient is $c_{\\mathrm{SSP}} = \\frac{1}{1} = 1$.\nThe time step restriction is $\\Delta t \\le 1 \\cdot \\Delta t_{\\mathrm{FE}} = \\frac{h}{|\\beta|}$.\n\n**2. SSPRK(3,3) Scheme:**\nThe scheme is:\n$$\n\\begin{aligned}\nu^{(1)} &= u^{n} + \\mathbf{1} \\cdot \\Delta t\\, L(u^{n}) \\\\\nu^{(2)} &= \\frac{3}{4}\\, u^{n} + \\frac{1}{4}\\left[ u^{(1)} + \\mathbf{1} \\cdot \\Delta t\\, L(u^{(1)}) \\right] \\\\\nu^{n+1} &= \\frac{1}{3}\\, u^{n} + \\frac{2}{3}\\left[ u^{(2)} + \\mathbf{1} \\cdot \\Delta t\\, L(u^{(2)}) \\right]\n\\end{aligned}\n$$\nThe fractional coefficients of $\\Delta t L(\\cdot)$ are $\\gamma_1 = 1$, $\\gamma_2 = 1$, and $\\gamma_3 = 1$.\nThe maximum fractional coefficient is $\\max(\\gamma_i) = 1$.\nThe SSP coefficient is $c_{\\mathrm{SSP}} = \\frac{1}{1} = 1$.\nThe time step restriction is $\\Delta t \\le 1 \\cdot \\Delta t_{\\mathrm{FE}} = \\frac{h}{|\\beta|}$.\n\n**3. SSPRK(4,3) Scheme:**\nThe scheme is:\n$$\n\\begin{aligned}\nu^{(1)} &= u^{n} + \\frac{1}{2}\\, \\Delta t\\, L(u^{n}) \\\\\nu^{(2)} &= u^{(1)} + \\frac{1}{2}\\, \\Delta t\\, L(u^{(1)}) \\\\\nu^{(3)} &= \\frac{2}{3}\\, u^{n} + \\frac{1}{3}\\left[ u^{(2)} + \\frac{1}{2}\\, \\Delta t\\, L(u^{(2)}) \\right] \\\\\nu^{n+1} &= u^{(3)} + \\frac{1}{2}\\, \\Delta t\\, L(u^{(3)})\n\\end{aligned}\n$$\nThe fractional coefficients of $\\Delta t L(\\cdot)$ are $\\gamma_1 = 1/2$, $\\gamma_2 = 1/2$, $\\gamma_3 = 1/2$, and $\\gamma_4 = 1/2$.\nThe maximum fractional coefficient is $\\max(\\gamma_i) = \\frac{1}{2}$.\nThe SSP coefficient is $c_{\\mathrm{SSP}} = \\frac{1}{1/2} = 2$.\nThe time step restriction is $\\Delta t \\le 2 \\cdot \\Delta t_{\\mathrm{FE}} = 2 \\frac{h}{|\\beta|}$.\n\n**Comparison and Optimization:**\nWe are asked to choose the scheme order that maximizes the allowable monotone time step, subject to the constraint of using at most four stages. The provided schemes satisfy this constraint.\n\nLet's summarize the maximum allowable time steps for each scheme:\n- **SSPRK(2,2)** (Order $2$, $2$ stages): $\\Delta t \\le \\frac{h}{|\\beta|}$\n- **SSPRK(3,3)** (Order $3$, $3$ stages): $\\Delta t \\le \\frac{h}{|\\beta|}$\n- **SSPRK(4,3)** (Order $3$, $4$ stages): $\\Delta t \\le 2\\frac{h}{|\\beta|}$\n\nComparing the maximum allowable time step for each order based on the provided schemes:\n- For order $2$, the maximum time step is $\\frac{h}{|\\beta|}$ (from SSPRK(2,2)).\n- For order $3$, the maximum time step is $2\\frac{h}{|\\beta|}$ (from SSPRK(4,3)).\n\nThe third-order schemes allow for a larger time step than the second-order scheme. Specifically, the SSPRK(4,3) scheme provides the largest time step of all options. Therefore, the maximum allowable monotone time step, $\\Delta t_{\\max}$, under the given conditions is determined by the SSPRK(4,3) scheme.\n\nThe corresponding Courant-Friedrichs-Lewy (CFL) time step bound is:\n$$\n\\Delta t_{\\max} = 2 \\cdot \\Delta t_{\\mathrm{FE}} = 2 \\frac{h}{|\\beta|}\n$$", "answer": "$$\n\\boxed{2 \\frac{h}{|\\beta|}}\n$$", "id": "3487852"}, {"introduction": "While linear analysis forms the bedrock of stability theory, the dynamics in numerical relativity are inherently nonlinear. This practice [@problem_id:3487869] explores how nonlinearity introduces new constraints on the time step that are invisible to standard CFL analysis. Using a simplified nonlinear wave equation as a proxy for a gauge wave, you will develop a more sophisticated time-step limit that accounts not only for the wave speed but also for the finite time in which nonlinear steepening can lead to shock formation.", "problem": "Consider a one-dimensional proxy for the nonlinear gauge wave test used in numerical relativity, modeled by a scalar first-order nonlinear hyperbolic partial differential equation,\n$$\n\\partial_t u + a(u)\\,\\partial_x u = 0, \\quad a(u) = c_0\\left(1 + \\beta u^2\\right),\n$$\nwhere $u=u(x,t)$ is a dimensionless gauge wave amplitude, $x$ is position in meters, $t$ is time in seconds, $c_0$ is a constant characteristic speed in meters per second, and $\\beta$ is a dimensionless nonlinearity parameter. Assume initial data of the form\n$$\nu(x,0) = A \\sin(k x),\n$$\nwith amplitude $A$ (dimensionless) and wavenumber $k$ in radians per meter. Angles must be treated in radians.\n\nYou will estimate a “nonlinear Courant-Friedrichs-Lewy (CFL) threshold” for an explicit, monotone finite-volume method advanced by forward Euler in time, designed to capture advection-like behavior. The explicit time step $\\Delta t$ must respect both: (i) a speed-based CFL bound derived from the maximal characteristic speed, and (ii) an amplitude-dependent bound that ensures steepening and shock formation are delayed beyond a chosen minimum number of steps to allow numerical dissipation to act. You must contrast this estimate with a linearized CFL prediction that uses the linear characteristic speed.\n\nUse the following fundamental base and well-tested facts:\n\n- For conservation law–type advection with nonlinear speed $a(u)$, the characteristics satisfy $\\frac{dx}{dt}=a(u)$ and the slope $w=\\partial_x u$ evolves (for smooth solutions) according to\n$$\n\\frac{d}{dt} w = -a'(u)\\, w^2,\n$$\nwhere $a'(u) = \\frac{d}{du}a(u)$.\n- If $u(x,0)=A\\sin(kx)$ and $a'(u)\\neq 0$, then the earliest time of gradient blow-up (shock formation time) is\n$$\nt_s = \\frac{1}{\\max_x\\left(a'(u(x,0))\\,|\\partial_x u(x,0)|\\right)}.\n$$\n- For the nonlinear speed $a(u)=c_0(1+\\beta u^2)$ with $u(x,0)=A\\sin(kx)$, one has $a'(u)=2c_0\\beta u$ and $\\partial_x u(x,0)=Ak\\cos(kx)$, which yields\n$$\nt_s = \\frac{1}{c_0\\,\\beta\\,A^2\\,k}.\n$$\n- A speed-based CFL bound for an explicit monotone method with safety factor $\\nu\\in(0,1]$ is\n$$\n\\Delta t_{\\text{speed}} = \\nu \\frac{\\Delta x}{a_{\\max}}, \\quad a_{\\max} = \\max_x |a(u(x,0))| = c_0\\left(1+\\beta A^2\\right),\n$$\nwhere $\\Delta x$ is the grid spacing in meters.\n- The linearized CFL prediction (ignoring amplitude-dependent speed) is\n$$\n\\Delta t_{\\text{lin}} = \\nu \\frac{\\Delta x}{c_0}.\n$$\n\nDefine the nonlinear CFL threshold as\n$$\n\\Delta t_{\\text{nl}} = \\min\\left(\\Delta t_{\\text{speed}},\\, \\frac{t_s}{M}\\right),\n$$\nwhere $M$ is a chosen positive integer representing the minimum number of explicit time steps before the analytic steepening time $t_s$ is reached, thereby encoding a pragmatic requirement that shock formation be delayed to allow numerical dissipation to act. If $\\beta=0$, treat $t_s$ as $+\\infty$ and hence $\\Delta t_{\\text{nl}}=\\Delta t_{\\text{speed}}$.\n\nYour task is to write a program that, for each test case, computes and returns the pair $[\\Delta t_{\\text{nl}},\\,\\Delta t_{\\text{lin}}]$, both expressed in seconds. Angles must be treated in radians, and all physical units must be consistent: $c_0$ in meters per second, $\\Delta x$ in meters, $k$ in radians per meter. Use $k = 2\\pi/L$ where $L$ is the wavelength in meters.\n\nTest suite parameter sets:\n- Case 1 (general “happy path” with moderate nonlinearity): $c_0 = 2.99792458\\times 10^8$ $\\text{m/s}$, $\\Delta x = 1000$ $\\text{m}$, $\\beta = 0.1$, $A = 0.5$, $L = 1.0\\times 10^6$ $\\text{m}$, $\\nu = 0.9$, $M = 50$.\n- Case 2 (boundary condition, linearized limit): $c_0 = 2.99792458\\times 10^8$ $\\text{m/s}$, $\\Delta x = 500$ $\\text{m}$, $\\beta = 0.0$, $A = 0.8$, $L = 1.0\\times 10^5$ $\\text{m}$, $\\nu = 1.0$, $M = 20$.\n- Case 3 (edge case, strong nonlinearity, shock-time bound dominates): $c_0 = 3.0\\times 10^8$ $\\text{m/s}$, $\\Delta x = 100$ $\\text{m}$, $\\beta = 1.0$, $A = 1.0$, $L = 1.0\\times 10^4$ $\\text{m}$, $\\nu = 0.8$, $M = 100$.\n- Case 4 (edge case, fine grid, speed-based bound dominates): $c_0 = 2.99792458\\times 10^8$ $\\text{m/s}$, $\\Delta x = 1$ $\\text{m}$, $\\beta = 0.5$, $A = 0.9$, $L = 1.0\\times 10^5$ $\\text{m}$, $\\nu = 0.95$, $M = 200$.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated Python-style list of lists, each inner list holding the two floats $[\\Delta t_{\\text{nl}}, \\Delta t_{\\text{lin}}]$ in seconds, in the order of the test suite cases (for example, $[[x_1,y_1],[x_2,y_2],[x_3,y_3],[x_4,y_4]]$]).", "solution": "The problem statement has been validated and is deemed sound, self-contained, and well-posed. The task is to compute two types of time step thresholds, a linearized one and a nonlinear one, for a simplified model of a gauge wave equation used in numerical relativity. The calculation will be performed for four distinct parameter sets.\n\nThe core of the problem involves the application of specified formulas for the Courant-Friedrichs-Lewy (CFL) condition, which is a necessary condition for the stability of explicit time-integration schemes for hyperbolic partial differential equations. The problem introduces a \"nonlinear CFL threshold,\" $\\Delta t_{\\text{nl}}$, which innovatively combines the standard speed-based CFL limit with a heuristic constraint related to the shock formation time, $t_s$. This captures the dual numerical challenges of resolving high-speed wave propagation and managing the formation of discontinuities (shocks) due to nonlinear steepening.\n\nThe procedure for calculating the required values, $[\\Delta t_{\\text{nl}}, \\Delta t_{\\text{lin}}]$, for each test case is as follows.\n\nFirst, we define the physical and numerical parameters for a given case: the characteristic speed $c_0$, the grid spacing $\\Delta x$, the nonlinearity parameter $\\beta$, the initial amplitude $A$, the wavelength $L$, the CFL safety factor $\\nu$, and the shock-delay step count $M$.\n\nThe wavenumber $k$ is derived from the wavelength $L$ using the standard relation:\n$$\nk = \\frac{2\\pi}{L}\n$$\n\nNext, we compute the linearized CFL time step, $\\Delta t_{\\text{lin}}$. This value is based on the assumption that the wave speed is constant and equal to $c_0$, ignoring any nonlinear, amplitude-dependent effects. It is a baseline for comparison. The formula is given as:\n$$\n\\Delta t_{\\text{lin}} = \\nu \\frac{\\Delta x}{c_0}\n$$\nHere, $\\Delta x / c_0$ represents the time it takes for a wave traveling at speed $c_0$ to cross one grid cell, and $\\nu \\in (0, 1]$ is a safety factor.\n\nThen, we calculate the components required for the nonlinear CFL threshold, $\\Delta t_{\\text{nl}}$. This threshold must satisfy two separate constraints.\n\nThe first constraint is the speed-based CFL condition, $\\Delta t_{\\text{speed}}$. This condition accounts for the fact that the local wave speed, $a(u) = c_0(1 + \\beta u^2)$, depends on the wave amplitude $u$. For stability, the time step must be limited by the maximum possible wave speed, $a_{\\max}$, occurring over the domain. For the initial condition $u(x,0) = A \\sin(kx)$, the maximum amplitude is $A$, so the maximum speed is:\n$$\na_{\\max} = \\max_x |a(u(x,0))| = c_0\\left(1+\\beta A^2\\right)\n$$\nThe corresponding speed-based time step limit is:\n$$\n\\Delta t_{\\text{speed}} = \\nu \\frac{\\Delta x}{a_{\\max}} = \\nu \\frac{\\Delta x}{c_0\\left(1+\\beta A^2\\right)}\n$$\n\nThe second constraint is related to nonlinear wave steepening. A key feature of nonlinear hyperbolic equations is the tendency for smooth initial data to develop vertical gradients, forming a shock, in finite time. The problem provides the formula for this shock formation time, $t_s$:\n$$\nt_s = \\frac{1}{c_0\\,\\beta\\,A^2\\,k}\n$$\nThe problem introduces a pragmatic requirement that the numerical simulation must run for at least $M$ time steps before this analytical shock time is reached. This ensures that the numerical method has a chance to capture the steepening process and that its inherent numerical dissipation can regularize the would-be shock. This constraint is expressed as $\\Delta t \\le t_s / M$. An important special case arises when $\\beta = 0$. In this linear advection scenario, no steepening occurs, so $t_s$ is effectively infinite. The problem specifies that in this case, this second constraint is ignored.\n\nFinally, the nonlinear CFL threshold, $\\Delta t_{\\text{nl}}$, is defined as the more restrictive of these two bounds: the speed-based limit and the steepening limit.\n$$\n\\Delta t_{\\text{nl}} = \\min\\left(\\Delta t_{\\text{speed}},\\, \\frac{t_s}{M}\\right)\n$$\nIf $\\beta=0$, this simplifies to $\\Delta t_{\\text{nl}} = \\Delta t_{\\text{speed}}$, which further simplifies to $\\Delta t_{\\text{nl}} = \\Delta t_{\\text{lin}}$ since $a_{\\max} = c_0$.\n\nBy applying these steps to each parameter set provided in the test suite, we can systematically compute the pair of values $[\\Delta t_{\\text{nl}}, \\Delta t_{\\text{lin}}]$ and present them in the specified format. The calculations are executed for each case below.\n\nCase 1: $c_0 = 2.99792458\\times 10^8$, $\\Delta x = 1000$, $\\beta = 0.1$, $A = 0.5$, $L = 1.0\\times 10^6$, $\\nu = 0.9$, $M = 50$.\n- $k = 2\\pi / (1.0 \\times 10^6) \\approx 6.283 \\times 10^{-6}$ $\\text{rad/m}$.\n- $\\Delta t_{\\text{lin}} = 0.9 \\times 1000 / (2.99792458 \\times 10^8) \\approx 3.002077 \\times 10^{-6}$ $\\text{s}$.\n- $a_{\\max} = c_0(1 + 0.1 \\times 0.5^2) = 1.025\\,c_0$.\n- $\\Delta t_{\\text{speed}} = \\Delta t_{\\text{lin}} / 1.025 \\approx 2.928855 \\times 10^{-6}$ $\\text{s}$.\n- $t_s = 1 / (c_0 \\times 0.1 \\times 0.5^2 \\times k) \\approx 0.021236$ $\\text{s}$.\n- $t_s/M = 0.021236 / 50 \\approx 4.2471 \\times 10^{-4}$ $\\text{s}$.\n- $\\Delta t_{\\text{nl}} = \\min(2.928855 \\times 10^{-6}, 4.2471 \\times 10^{-4}) = 2.928855 \\times 10^{-6}$ $\\text{s}$.\n\nCase 2: $c_0 = 2.99792458\\times 10^8$, $\\Delta x = 500$, $\\beta = 0.0$, $A = 0.8$, $L = 1.0\\times 10^5$, $\\nu = 1.0$, $M = 20$.\n- $\\beta = 0$, so $t_s \\to \\infty$ and $a_{\\max} = c_0$.\n- $\\Delta t_{\\text{speed}} = \\Delta t_{\\text{lin}} = 1.0 \\times 500 / (2.99792458 \\times 10^8) \\approx 1.667821 \\times 10^{-6}$ $\\text{s}$.\n- $\\Delta t_{\\text{nl}} = \\Delta t_{\\text{speed}} = 1.667821 \\times 10^{-6}$ $\\text{s}$.\n\nCase 3: $c_0 = 3.0\\times 10^8$, $\\Delta x = 100$, $\\beta = 1.0$, $A = 1.0$, $L = 1.0\\times 10^4$, $\\nu = 0.8$, $M = 100$.\n- $k = 2\\pi / (1.0 \\times 10^4) \\approx 6.283 \\times 10^{-4}$ $\\text{rad/m}$.\n- $\\Delta t_{\\text{lin}} = 0.8 \\times 100 / (3.0 \\times 10^8) \\approx 2.666667 \\times 10^{-7}$ $\\text{s}$.\n- $a_{\\max} = c_0(1 + 1.0 \\times 1.0^2) = 2.0\\,c_0$.\n- $\\Delta t_{\\text{speed}} = \\Delta t_{\\text{lin}} / 2.0 \\approx 1.333333 \\times 10^{-7}$ $\\text{s}$.\n- $t_s = 1 / (c_0 \\times 1.0 \\times 1.0^2 \\times k) \\approx 5.30516 \\times 10^{-6}$ $\\text{s}$.\n- $t_s/M = 5.30516 \\times 10^{-6} / 100 \\approx 5.30516 \\times 10^{-8}$ $\\text{s}$.\n- $\\Delta t_{\\text{nl}} = \\min(1.333333 \\times 10^{-7}, 5.30516 \\times 10^{-8}) = 5.30516 \\times 10^{-8}$ $\\text{s}$.\n\nCase 4: $c_0 = 2.99792458\\times 10^8$, $\\Delta x = 1$, $\\beta = 0.5$, $A = 0.9$, $L = 1.0\\times 10^5$, $\\nu = 0.95$, $M = 200$.\n- $k = 2\\pi / (1.0 \\times 10^5) \\approx 6.283 \\times 10^{-5}$ $\\text{rad/m}$.\n- $\\Delta t_{\\text{lin}} = 0.95 \\times 1 / (2.99792458 \\times 10^8) \\approx 3.168850 \\times 10^{-9}$ $\\text{s}$.\n- $a_{\\max} = c_0(1 + 0.5 \\times 0.9^2) = 1.405\\,c_0$.\n- $\\Delta t_{\\text{speed}} = \\Delta t_{\\text{lin}} / 1.405 \\approx 2.255409 \\times 10^{-9}$ $\\text{s}$.\n- $t_s = 1 / (c_0 \\times 0.5 \\times 0.9^2 \\times k) \\approx 1.31102 \\times 10^{-4}$ $\\text{s}$.\n- $t_s/M = 1.31102 \\times 10^{-4} / 200 \\approx 6.5551 \\times 10^{-7}$ $\\text{s}$.\n- $\\Delta t_{\\text{nl}} = \\min(2.255409 \\times 10^{-9}, 6.5551 \\times 10^{-7}) = 2.255409 \\times 10^{-9}$ $\\text{s}$.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the nonlinear and linearized CFL time step thresholds\n    for a given set of test cases modeling a nonlinear gauge wave.\n    \"\"\"\n\n    # test_cases are lists of tuples (c0, dx, beta, A, L, nu, M)\n    test_cases = [\n        (2.99792458e8, 1000.0, 0.1, 0.5, 1.0e6, 0.9, 50),\n        (2.99792458e8, 500.0, 0.0, 0.8, 1.0e5, 1.0, 20),\n        (3.0e8, 100.0, 1.0, 1.0, 1.0e4, 0.8, 100),\n        (2.99792458e8, 1.0, 0.5, 0.9, 1.0e5, 0.95, 200),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        c0, dx, beta, A, L, nu, M = case\n\n        # Calculate the wavenumber k\n        k = 2 * np.pi / L\n\n        # Calculate the linearized CFL time step, dt_lin\n        dt_lin = nu * dx / c0\n\n        # Calculate the speed-based CFL time step, dt_speed\n        a_max = c0 * (1.0 + beta * A**2)\n        dt_speed = nu * dx / a_max\n        \n        # Calculate the nonlinear CFL threshold, dt_nl\n        if beta == 0.0:\n            # For the linear case, t_s is infinite, so the steepening\n            # bound is not a constraint. dt_nl is just dt_speed.\n            dt_nl = dt_speed\n        else:\n            # Calculate the shock formation time, t_s\n            # The denominator c0 * beta * A^2 * k must be non-zero\n            # because beta != 0.\n            t_s = 1.0 / (c0 * beta * A**2 * k)\n            \n            # The nonlinear CFL threshold is the minimum of the speed-based\n            # limit and the shock-steepening limit.\n            dt_nl = min(dt_speed, t_s / M)\n        \n        results.append([dt_nl, dt_lin])\n\n    # Final print statement in the exact required format.\n    # The string representation of a list of lists is desired.\n    formatted_results = \",\".join(map(str, results))\n    print(f\"[{formatted_results}]\")\n\nsolve()\n```", "id": "3487869"}, {"introduction": "The ultimate application of stability analysis in numerical relativity is to control simulations in dynamically evolving, curved spacetimes. This capstone exercise [@problem_id:3487841] guides you in constructing a local CFL estimator directly from the fundamental components of the 3+1 spacetime metric. You will derive the coordinate characteristic speeds from the lapse ($\\alpha$), shift ($\\beta^i$), and spatial metric ($\\gamma_{ij}$), creating a practical tool essential for ensuring the stability of complex simulations like binary black hole mergers.", "problem": "You are tasked with designing and implementing a local estimator for the Courant-Friedrichs-Lewy (CFL) condition that accounts for spacetime curvature in numerical relativity simulations of gravitational waves and binary black hole mergers. The estimator must be constructed from the principal symbol of a hyperbolic system in a local orthonormal tetrad basis and then mapped to coordinate speeds relevant for the numerical grid.\n\nStarting point and requirements:\n- Use the three-plus-one (3+1) decomposition of General Relativity, with lapse $\\alpha$, shift $\\beta^i$, and spatial metric $\\gamma_{ij}$, where $i,j \\in \\{x,y,z\\}$. Assume $\\gamma_{ij}$ is symmetric and positive definite, and for this problem you may restrict to diagonal $\\gamma_{ij}$.\n- Use the principal symbol of a massless wave-like hyperbolic system whose characteristic surfaces are null with respect to the spacetime metric. In a local orthonormal tetrad basis $\\{e_0, e_a\\}$ with $e_0$ timelike and $e_a$ ($a\\in\\{1,2,3\\}$) spacelike orthonormal, the characteristic speeds are $\\pm 1$ along each spatial triad direction (in units where the speed of light equals one).\n- Construct the orthonormal triad directions from the spatial metric $\\gamma_{ij}$ by normalizing coordinate basis vectors so that each triad vector $n^i$ satisfies $\\gamma_{ij} n^i n^j = 1$. Then, starting from the null condition $g_{\\mu\\nu} dx^{\\mu} dx^{\\nu} = 0$ and the 3+1 line element, derive the coordinate characteristic speeds along each grid axis by projecting these null directions, including the effects of both $\\alpha$ and $\\beta^i$.\n- Define the local spectral radius relevant for the CFL condition by aggregating the largest-magnitude coordinate speeds along each grid axis and combining them with the grid spacings $\\Delta x$, $\\Delta y$, and $\\Delta z$. Use an additive form appropriate for explicit method-of-lines integrators in multiple spatial dimensions.\n- Implement a predictor that, given a candidate time step $\\Delta t$, flags a location as \"predicted unstable\" if the candidate time step exceeds the local maximum allowed time step from your CFL estimator.\n\nObserved instability model:\n- To test the predictive power of your estimator, define an \"observed\" instability criterion by computing the sum of directional Courant numbers $\\sum_i \\lambda_i \\Delta t / \\Delta x_i$ using the same coordinate characteristic speeds $\\lambda_i$ you derived. Flag instability if this sum exceeds $1$. This provides a simple, local, model-based observation proxy for instability in explicit schemes.\n- Use the International System of Units (SI). Express grid spacings $\\Delta x_i$ in meters, time steps $\\Delta t$ in seconds, and speeds in meters per second. Use the speed of light $c = 299,792,458\\,\\mathrm{m/s}$ to convert from dimensionless characteristic speeds (which are fractions of $c$) to SI speeds.\n\nProgram inputs and outputs:\n- Your program must implement the above estimator and observed instability model for the following test suite of five distinct local states. Each test case is specified by $\\alpha$, $\\beta^i$, diagonal $\\gamma_{ii}$, grid spacings $(\\Delta x, \\Delta y, \\Delta z)$ in meters, and an applied time step $\\Delta t$ in seconds:\n    1. Case A (moderate curvature, modest shift): $\\alpha = 0.7$, $\\beta^i = (0.05, 0.02, 0.0)$, $\\gamma_{ii} = (2.0736, 2.0736, 2.0736)$, $(\\Delta x, \\Delta y, \\Delta z) = (150, 150, 150)\\,\\mathrm{m}$, $\\Delta t = 3.0\\times 10^{-4}\\,\\mathrm{s}$.\n    2. Case B (strong curvature, near-horizon-like, axial shift): $\\alpha = 0.2$, $\\beta^i = (0.05, 0.0, 0.0)$, $\\gamma_{ii} = (16.0, 16.0, 16.0)$, $(\\Delta x, \\Delta y, \\Delta z) = (100, 100, 100)\\,\\mathrm{m}$, $\\Delta t = 2.0\\times 10^{-4}\\,\\mathrm{s}$.\n    3. Case C (anisotropic metric and grid): $\\alpha = 0.9$, $\\beta^i = (0.2, -0.1, 0.05)$, $\\gamma_{ii} = (1.5, 2.5, 3.5)$, $(\\Delta x, \\Delta y, \\Delta z) = (200, 100, 50)\\,\\mathrm{m}$, $\\Delta t = 4.0\\times 10^{-4}\\,\\mathrm{s}$.\n    4. Case D (flat triad, zero shift, equality edge): $\\alpha = 1.0$, $\\beta^i = (0.0, 0.0, 0.0)$, $\\gamma_{ii} = (1.0, 1.0, 1.0)$, $(\\Delta x, \\Delta y, \\Delta z) = (300, 300, 300)\\,\\mathrm{m}$, $\\Delta t = 3.338\\times 10^{-7}\\,\\mathrm{s}$.\n    5. Case E (merger-core-like, nontrivial shift): $\\alpha = 0.5$, $\\beta^i = (0.1, 0.08, 0.0)$, $\\gamma_{ii} = (10.0, 10.0, 10.0)$, $(\\Delta x, \\Delta y, \\Delta z) = (75, 75, 150)\\,\\mathrm{m}$, $\\Delta t = 1.0\\times 10^{-4}\\,\\mathrm{s}$.\n- For each case, compute:\n    1. The predicted maximum stable time step $\\Delta t_{\\max}$ in seconds from your local CFL estimator.\n    2. A boolean indicating predicted instability, defined as $\\Delta t > \\Delta t_{\\max}$.\n    3. A boolean indicating observed instability, defined by the local additive Courant criterion $\\sum_i \\lambda_i \\Delta t / \\Delta x_i > 1$, where $\\lambda_i$ are the coordinate characteristic speeds in meters per second along each axis.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. The list must be flat and contain, in order for the five cases: $\\Delta t_{\\max}$ for Case A (float in seconds), predicted instability for Case A (boolean), observed instability for Case A (boolean), then the same triplet for Case B, Case C, Case D, and Case E. For example, the output should look like\n[$\\Delta t_{\\max,A}$, predA, obsA, $\\Delta t_{\\max,B}$, predB, obsB, ...].\n\nNotes:\n- Angles do not appear in this problem; no special angle unit is required.\n- All speeds must be treated consistently: the tetrad characteristic speeds are $\\pm 1$ in units of the speed of light, and coordinate speeds must be converted to meters per second using $c$ before combining with grid spacings in meters.\n- Ensure scientific realism by respecting the requirement $\\alpha^2 \\ge \\beta_{\\perp}^2$ so that the time coordinate remains timelike. The provided test suite satisfies this condition.", "solution": "The user-provided problem is assessed to be valid. It is scientifically grounded in the established principles of numerical relativity and the 3+1 decomposition of spacetime. The problem is well-posed, providing a complete and consistent set of data and definitions required to derive a unique, deterministic solution. The language is objective and formal. The task is a standard, albeit non-trivial, exercise in deriving and applying the Courant-Friedrichs-Lewy (CFL) stability condition in a general relativistic context.\n\nThe solution proceeds by first deriving the coordinate characteristic speeds from the spacetime metric and then using these speeds to construct the CFL limit on the time step.\n\n**1. Derivation of Coordinate Characteristic Speeds**\n\nThe fundamental principle for determining characteristic speeds of a wave-like system in General Relativity is that information propagates along null geodesics of the spacetime metric $g_{\\mu\\nu}$. A null path is defined by the condition $ds^2 = g_{\\mu\\nu} dx^\\mu dx^\\nu = 0$.\n\nThe problem specifies the use of the Arnowitt-Deser-Misner (ADM) or 3+1 formalism, where the spacetime line element $ds^2$ is decomposed as:\n$$ds^2 = -\\alpha^2 dt^2 + \\gamma_{ij} (dx^i - \\beta^i dt)(dx^j - \\beta^j dt)$$\nHere, $\\alpha$ is the lapse function, $\\beta^i$ is the shift vector, and $\\gamma_{ij}$ is the 3-dimensional spatial metric on a given time slice. The indices $i, j$ run from $1$ to $3$ (or $x, y, z$).\n\nTo find the coordinate speeds $v^i = dx^i/dt$ of a light signal, we set $ds^2=0$ and divide by $dt^2$:\n$$-\\alpha^2 + \\gamma_{ij} \\left(\\frac{dx^i}{dt} - \\beta^i\\right)\\left(\\frac{dx^j}{dt} - \\beta^j\\right) = 0$$\nSubstituting $v^i = dx^i/dt$, we obtain the equation for the boundary of the future light cone in coordinate velocity space:\n$$\\gamma_{ij} (v^i - \\beta^i)(v^j - \\beta^j) = \\alpha^2$$\nThis equation describes an ellipsoid in the velocity space of $v^i$. To determine the CFL condition, we need the maximum possible coordinate speed along each grid axis. Let us find the maximum speed along the $x$-axis, which we denote $\\lambda_x$. This corresponds to finding the maximum value of $v^x$ subject to the ellipsoidal constraint.\n\nLet $w^i = v^i - \\beta^i$. The constraint becomes $\\gamma_{ij} w^i w^j = \\alpha^2$. We want to find the extrema of $v^x = w^x + \\beta^x$. This is equivalent to finding the extrema of $w^x$. Since the problem states that $\\gamma_{ij}$ is diagonal, we can write $\\gamma_{ij} = \\text{diag}(\\gamma_{xx}, \\gamma_{yy}, \\gamma_{zz})$. The constraint equation simplifies to:\n$$\\gamma_{xx} (w^x)^2 + \\gamma_{yy} (w^y)^2 + \\gamma_{zz} (w^z)^2 = \\alpha^2$$\nTo find the maximum and minimum values of $w^x$, we set $w^y = 0$ and $w^z = 0$. This yields:\n$$\\gamma_{xx} (w^x)^2 = \\alpha^2 \\implies w^x = \\pm \\frac{\\alpha}{\\sqrt{\\gamma_{xx}}}$$\nThe extreme values for the coordinate velocity $v^x$ are therefore:\n$$v^x_{\\pm} = \\beta^x + w^x = \\beta^x \\pm \\frac{\\alpha}{\\sqrt{\\gamma_{xx}}}$$\nThe characteristic speed relevant for the CFL condition is the one with the largest magnitude. This is given by:\n$$\\lambda_x = \\max(|v^x_+|, |v^x_-|) = \\max\\left(\\left|\\beta^x + \\frac{\\alpha}{\\sqrt{\\gamma_{xx}}}\\right|, \\left|\\beta^x - \\frac{\\alpha}{\\sqrt{\\gamma_{xx}}}\\right|\\right)$$\nSince $\\alpha>0$ and $\\sqrt{\\gamma_{xx}}>0$, this simplifies to:\n$$\\lambda_x = |\\beta^x| + \\frac{\\alpha}{\\sqrt{\\gamma_{xx}}}$$\nBy analogy, the largest-magnitude characteristic speeds along the $y$ and $z$ axes are:\n$$\\lambda_y = |\\beta^y| + \\frac{\\alpha}{\\sqrt{\\gamma_{yy}}}$$\n$$\\lambda_z = |\\beta^z| + \\frac{\\alpha}{\\sqrt{\\gamma_{zz}}}$$\nThese speeds, $\\lambda_i$, are dimensionless, expressed in units of the speed of light $c$. To convert them to SI units (m/s), we multiply by $c = 299792458 \\, \\mathrm{m/s}$. Let $\\lambda_{i, \\text{SI}} = c \\cdot \\lambda_i$.\n\n**2. CFL Condition and Instability Criteria**\n\nFor a multi-dimensional hyperbolic system solved with an explicit method-of-lines scheme, a common form of the CFL stability condition is additive. The sum of the directional Courant numbers must be less than or equal to a constant $C_{\\text{CFL}}$, which is of order unity. The problem specifies a stability limit corresponding to $C_{\\text{CFL}} = 1$. The condition is:\n$$\\Delta t \\left( \\frac{\\lambda_{x, \\text{SI}}}{\\Delta x} + \\frac{\\lambda_{y, \\text{SI}}}{\\Delta y} + \\frac{\\lambda_{z, \\text{SI}}}{\\Delta z} \\right) \\le 1$$\nwhere $\\Delta x, \\Delta y, \\Delta z$ are the grid spacings in meters.\n\nFrom this inequality, we can determine the maximum stable time step, $\\Delta t_{\\max}$:\n$$\\Delta t_{\\max} = \\left( \\frac{\\lambda_{x, \\text{SI}}}{\\Delta x} + \\frac{\\lambda_{y, \\text{SI}}}{\\Delta y} + \\frac{\\lambda_{z, \\text{SI}}}{\\Delta z} \\right)^{-1}$$\nSubstituting the expressions for $\\lambda_{i, \\text{SI}}$:\n$$\\Delta t_{\\max} = \\left[ c \\left( \\frac{|\\beta^x| + \\alpha/\\sqrt{\\gamma_{xx}}}{\\Delta x} + \\frac{|\\beta^y| + \\alpha/\\sqrt{\\gamma_{yy}}}{\\Delta y} + \\frac{|\\beta^z| + \\alpha/\\sqrt{\\gamma_{zz}}}{\\Delta z} \\right) \\right]^{-1}$$\n\nThe problem defines two instability criteria for a given trial time step $\\Delta t$:\n1.  **Predicted Instability**: This is a boolean flag, true if the given time step $\\Delta t$ exceeds the computed maximum allowed time step $\\Delta t_{\\max}$.\n    $$\\text{Predicted Instability} = (\\Delta t > \\Delta t_{\\max})$$\n2.  **Observed Instability**: This is a boolean flag, true if the sum of directional Courant numbers exceeds $1$.\n    $$\\text{Observed Instability} = \\left( \\frac{\\lambda_{x, \\text{SI}} \\Delta t}{\\Delta x} + \\frac{\\lambda_{y, \\text{SI}} \\Delta t}{\\Delta y} + \\frac{\\lambda_{z, \\text{SI}} \\Delta t}{\\Delta z} > 1 \\right)$$\nIt is clear by algebraic rearrangement that these two conditions are logically equivalent. If $\\sum_i (\\lambda_{i, \\text{SI}} \\Delta t / \\Delta x_i) > 1$, then $\\Delta t > (\\sum_i \\lambda_{i, \\text{SI}} / \\Delta x_i)^{-1}$, which is identical to $\\Delta t > \\Delta t_{\\max}$.\n\n**3. Algorithmic Implementation**\n\nFor each test case provided, the following computational steps are performed:\n1.  Extract the local metric components $\\alpha$, $\\beta^i = (\\beta^x, \\beta^y, \\beta^z)$, and diagonal $\\gamma_{ii} = (\\gamma_{xx}, \\gamma_{yy}, \\gamma_{zz})$, along with grid spacings $(\\Delta x, \\Delta y, \\Delta z)$ and the trial time step $\\Delta t$.\n2.  Compute the dimensionless characteristic speeds $\\lambda_x, \\lambda_y, \\lambda_z$ using the derived formulas.\n3.  Calculate the denominator of the $\\Delta t_{\\max}$ expression, which is the sum of inverse CFL time scales: $S = c \\left( \\frac{\\lambda_x}{\\Delta x} + \\frac{\\lambda_y}{\\Delta y} + \\frac{\\lambda_z}{\\Delta z} \\right)$.\n4.  Compute the maximum stable time step: $\\Delta t_{\\max} = 1/S$.\n5.  Evaluate the predicted instability: a boolean resulting from the comparison $\\Delta t > \\Delta t_{\\max}$.\n6.  Evaluate the observed instability: a boolean resulting from the comparison $\\Delta t \\cdot S > 1$.\n7.  Collect the triplet of results ($\\Delta t_{\\max}$, predicted instability, observed instability) for each case.\n8.  Format all results into a single flat list for final output.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes a local CFL estimator for numerical relativity simulations,\n    evaluates it for several test cases, and predicts stability.\n    \"\"\"\n    # Define physical constants and test cases as per the problem statement.\n    C_LIGHT = 299792458.0  # Speed of light in m/s\n\n    test_cases = [\n        # Case A (moderate curvature, modest shift)\n        {\n            \"name\": \"A\",\n            \"alpha\": 0.7,\n            \"beta\": np.array([0.05, 0.02, 0.0]),\n            \"gamma_ii\": np.array([2.0736, 2.0736, 2.0736]),\n            \"delta_x\": np.array([150.0, 150.0, 150.0]),\n            \"delta_t\": 3.0e-4,\n        },\n        # Case B (strong curvature, near-horizon-like, axial shift)\n        {\n            \"name\": \"B\",\n            \"alpha\": 0.2,\n            \"beta\": np.array([0.05, 0.0, 0.0]),\n            \"gamma_ii\": np.array([16.0, 16.0, 16.0]),\n            \"delta_x\": np.array([100.0, 100.0, 100.0]),\n            \"delta_t\": 2.0e-4,\n        },\n        # Case C (anisotropic metric and grid)\n        {\n            \"name\": \"C\",\n            \"alpha\": 0.9,\n            \"beta\": np.array([0.2, -0.1, 0.05]),\n            \"gamma_ii\": np.array([1.5, 2.5, 3.5]),\n            \"delta_x\": np.array([200.0, 100.0, 50.0]),\n            \"delta_t\": 4.0e-4,\n        },\n        # Case D (flat triad, zero shift, equality edge)\n        {\n            \"name\": \"D\",\n            \"alpha\": 1.0,\n            \"beta\": np.array([0.0, 0.0, 0.0]),\n            \"gamma_ii\": np.array([1.0, 1.0, 1.0]),\n            \"delta_x\": np.array([300.0, 300.0, 300.0]),\n            \"delta_t\": 3.338e-7,\n        },\n        # Case E (merger-core-like, nontrivial shift)\n        {\n            \"name\": \"E\",\n            \"alpha\": 0.5,\n            \"beta\": np.array([0.1, 0.08, 0.0]),\n            \"gamma_ii\": np.array([10.0, 10.0, 10.0]),\n            \"delta_x\": np.array([75.0, 75.0, 150.0]),\n            \"delta_t\": 1.0e-4,\n        },\n    ]\n\n    all_results = []\n    for case in test_cases:\n        alpha = case[\"alpha\"]\n        beta = case[\"beta\"]\n        gamma_ii = case[\"gamma_ii\"]\n        delta_x = case[\"delta_x\"]\n        delta_t = case[\"delta_t\"]\n\n        # 1. Derive the largest-magnitude coordinate characteristic speeds.\n        # These speeds are dimensionless (in units of c).\n        # The formula is lambda_i = |beta^i| + alpha / sqrt(gamma_ii).\n        sqrt_gamma_ii = np.sqrt(gamma_ii)\n        lambda_dimless = np.abs(beta) + alpha / sqrt_gamma_ii\n\n        # 2. Formulate the CFL condition to find the maximum stable timestep.\n        # The additive form is dt * sum(lambda_i_SI / dx_i) <= 1.\n        # lambda_i_SI are the speeds in SI units (m/s).\n        lambda_si = C_LIGHT * lambda_dimless\n        \n        # This is the sum term S = sum(lambda_i_SI / dx_i), with units of 1/s.\n        cfl_sum_term = np.sum(lambda_si / delta_x)\n\n        # The maximum stable timestep is dt_max = 1 / S.\n        delta_t_max = 1.0 / cfl_sum_term\n\n        # 3. Evaluate the instability criteria for the given trial step delta_t.\n        \n        # Predicted instability: True if delta_t > delta_t_max.\n        predicted_instability = delta_t > delta_t_max\n\n        # Observed instability: True if sum of Courant numbers > 1.\n        # This is equivalent to sum(lambda_i * dt / dx_i) > 1,\n        # or dt * sum(lambda_i / dx_i) > 1, which is dt * cfl_sum_term > 1.\n        observed_instability = (delta_t * cfl_sum_term) > 1.0\n        \n        all_results.extend([delta_t_max, predicted_instability, observed_instability])\n\n    # Final print statement in the exact required format.\n    # The format string converts floats and booleans to their string representations.\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n```", "id": "3487841"}]}