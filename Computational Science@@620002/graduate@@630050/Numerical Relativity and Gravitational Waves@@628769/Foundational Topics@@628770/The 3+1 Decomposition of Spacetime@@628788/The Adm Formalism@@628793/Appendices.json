{"hands_on_practices": [{"introduction": "A crucial test for any formulation of General Relativity is its ability to recover the well-known physics of gravitational waves in the weak-field limit. This first exercise provides a foundational check of the ADM formalism by linearizing its equations around a flat Minkowski background [@problem_id:3489095]. By performing this standard perturbative analysis, you will see how the physical, propagating degrees of freedom—the two polarizations of a gravitational wave—emerge as the transverse-traceless part of the spatial metric, moving at the speed of light.", "problem": "Consider vacuum General Relativity in the $3+1$ decomposition due to Arnowitt, Deser, and Misner (ADM). Let the spatial metric be $\\gamma_{ij}$, the extrinsic curvature be $K_{ij}$, the lapse be $\\alpha$, and the shift be $\\beta^{i}$. Work in a neighborhood of Minkowski space with background fields $\\gamma_{ij} = \\delta_{ij}$, $K_{ij} = 0$, $\\alpha = 1$, and $\\beta^{i} = 0$. Introduce a perturbative expansion with $\\gamma_{ij} = \\delta_{ij} + h_{ij}$, $K_{ij} = \\kappa_{ij}$, $\\alpha = 1$, and $\\beta^{i} = 0$, retaining only terms linear in the small fields $h_{ij}$ and $\\kappa_{ij}$. Starting from the vacuum Einstein equations written in the ADM form (Hamiltonian and momentum constraints together with the evolution equations for $\\gamma_{ij}$ and $K_{ij}$), perform the linearization about this Minkowski background to obtain the linearized ADM system. Using the linearized constraints and evolution, decompose the spatial metric perturbation into its transverse-traceless sector and the complementary pure-gauge sectors, and identify which sector represents physical gravitational radiation and which sectors are gauge. For the physical transverse-traceless sector $h^{\\mathrm{TT}}_{ij}$, assume a plane-wave ansatz $h^{\\mathrm{TT}}_{ij}(t,\\mathbf{x}) = \\epsilon_{ij} \\exp\\big(i(k_{m} x^{m} - \\omega t)\\big)$ with $\\epsilon^{i}{}_{i} = 0$ and $k^{j} \\epsilon_{ij} = 0$, and derive the dispersion relation $\\omega(|\\mathbf{k}|)$ of the physical mode. Express your final answer as a single closed-form analytic expression for $\\omega$ in units where the speed of light is normalized to unity. No numerical approximation or rounding is required.", "solution": "The problem asks for the derivation of the dispersion relation for physical gravitational waves within the linearized Arnowitt-Deser-Misner (ADM) formalism of General Relativity. This requires starting from the vacuum ADM equations, linearizing them about a Minkowski background, identifying the physical degrees of freedom, and then analyzing their propagation.\n\n### Step 1: The Vacuum ADM Equations\nThe $3+1$ decomposition of spacetime results in a set of four constraint equations and twelve evolution equations. In a vacuum spacetime ($T_{\\mu\\nu}=0$), and using units where the speed of light $c=1$, the ADM equations are:\n\n1.  **Hamiltonian Constraint:**\n    $$R + K^2 - K_{ij} K^{ij} = 0$$\n    where $R$ is the Ricci scalar of the spatial metric $\\gamma_{ij}$, and $K = \\gamma^{ij} K_{ij}$ is the trace of the extrinsic curvature $K_{ij}$.\n\n2.  **Momentum Constraint:**\n    $$D_j (K^{ij} - \\gamma^{ij} K) = 0$$\n    where $D_j$ is the covariant derivative compatible with the spatial metric $\\gamma_{ij}$.\n\n3.  **Evolution of the Spatial Metric:**\n    $$\\frac{\\partial}{\\partial t} \\gamma_{ij} = -2\\alpha K_{ij} + D_i \\beta_j + D_j \\beta_i$$\n    where $\\alpha$ is the lapse function and $\\beta^i$ is the shift vector.\n\n4.  **Evolution of the Extrinsic Curvature:**\n    $$\\frac{\\partial}{\\partial t} K_{ij} = -D_i D_j \\alpha + \\alpha(R_{ij} + K K_{ij} - 2 K_{ik} K^k_j) + \\beta^k D_k K_{ij} + K_{ik} D_j \\beta^k + K_{jk} D_i \\beta^k$$\n    where $R_{ij}$ is the Ricci tensor of the spatial metric $\\gamma_{ij}$.\n\n### Step 2: Linearization about Minkowski Spacetime\nWe linearize these equations around a background Minkowski spacetime, characterized by flat spatial slices and no time evolution. The background fields are $\\gamma_{ij} = \\delta_{ij}$, $K_{ij} = 0$, $\\alpha = 1$, and $\\beta^i = 0$.\n\nWe introduce small perturbations:\n$\\gamma_{ij} = \\delta_{ij} + h_{ij}$\n$K_{ij} = \\kappa_{ij}$\nFor the lapse and shift, the problem specifies a gauge choice by keeping them at their background values:\n$\\alpha = 1$\n$\\beta^i = 0$\n\nWe retain only terms that are first-order in the perturbation fields $h_{ij}$ and $\\kappa_{ij}$. In this approximation, spatial indices are raised and lowered with the background metric $\\delta_{ij}$, and the spatial covariant derivative $D_i$ becomes the partial derivative $\\partial_i$.\n\nThe linearized Ricci tensor $R_{ij}^{(1)}$ and Ricci scalar $R^{(1)}$ are given by:\n$$R_{ij}^{(1)} = \\frac{1}{2}(\\partial_k \\partial_i h^k_j + \\partial_k \\partial_j h^k_i - \\partial_i \\partial_j h - \\nabla^2 h_{ij})$$\n$$R^{(1)} = \\delta^{ij}R_{ij}^{(1)} = \\partial_i \\partial_j h^{ij} - \\nabla^2 h$$\nwhere $h = \\delta^{ij} h_{ij}$ is the trace of the metric perturbation and $\\nabla^2 = \\delta^{ij}\\partial_i\\partial_j$ is the flat-space Laplacian.\n\nApplying this linearization to the ADM equations yields:\n\n1.  **Linearized Hamiltonian Constraint:** All terms in the original equation are quadratic in $K_{ij}$, except for $R$. Thus, we are left with the linearized Ricci scalar:\n    $$R^{(1)} = \\partial_i \\partial_j h^{ij} - \\nabla^2 h = 0$$\n\n2.  **Linearized Momentum Constraint:** The term $K^{ij} - \\gamma^{ij}K$ linearizes to $\\kappa^{ij} - \\delta^{ij}\\kappa$. The covariant derivative becomes a partial derivative:\n    $$\\partial_j (\\kappa^{ij} - \\delta^{ij} \\kappa) = 0$$\n    where $\\kappa = \\delta^{ij}\\kappa_{ij}$.\n\n3.  **Linearized Metric Evolution:** With $\\dot{\\gamma}_{ij} = \\dot{h}_{ij}$, $\\alpha=1$, and $\\beta^i=0$, the equation becomes:\n    $$\\dot{h}_{ij} = -2\\kappa_{ij}$$\n    where the dot represents a partial derivative with respect to time $t$. This equation directly relates the perturbation of the extrinsic curvature to the time derivative of the metric perturbation. Taking the trace gives $\\dot{h} = -2\\kappa$.\n\n4.  **Linearized Curvature Evolution:** With $\\dot{K}_{ij} = \\dot{\\kappa}_{ij}$, $\\alpha=1$, and $\\beta^i=0$, and noting that all terms involving $K_{ij}$ in the original equation are at least quadratic, the equation simplifies to:\n    $$\\dot{\\kappa}_{ij} = R^{(1)}_{ij}$$\n\n### Step 3: The Linearized Wave Equation and Identification of Physical Modes\nWe can combine the evolution equations to obtain a second-order equation for $h_{ij}$. Differentiating the metric evolution equation with respect to time gives $\\ddot{h}_{ij} = -2\\dot{\\kappa}_{ij}$. Substituting the curvature evolution equation yields:\n$$\\ddot{h}_{ij} = -2 R^{(1)}_{ij}$$\nSubstituting the expression for the linearized Ricci tensor gives the general linearized wave equation for $h_{ij}$ in this gauge:\n$$\\ddot{h}_{ij} = -(\\partial_k \\partial_i h^k_j + \\partial_k \\partial_j h^k_i - \\partial_i \\partial_j h - \\nabla^2 h_{ij})$$\nrearranging this gives:\n$$\\ddot{h}_{ij} - \\nabla^2 h_{ij} = -\\partial_i(\\partial^k h_{kj}) - \\partial_j(\\partial^k h_{ki}) + \\partial_i \\partial_j h$$\n\nA general spatial metric perturbation $h_{ij}$ has $6$ independent components. However, not all of these correspond to physical degrees of freedom. The theory of General Relativity is gauge-invariant, meaning that some components of the metric can be changed by a coordinate transformation without altering the physical situation. These are called gauge modes.\n\nA spatial symmetric tensor field $h_{ij}$ can be decomposed into parts with different transformation properties under spatial rotations. The decomposition relevant here is into a transverse-traceless part, and parts constructed from a vector and scalars. The parts of $h_{ij}$ that can be written as $\\partial_i \\zeta_j + \\partial_j \\zeta_i$ for some vector field $\\zeta_i$ are pure gauge, as they can be removed by an infinitesimal coordinate transformation $x^i \\rightarrow x^i - \\zeta^i$.\n\nThe physical degrees of freedom of the gravitational field are those that cannot be removed by such a transformation. These are contained in the **transverse-traceless (TT)** sector of the metric perturbation, denoted $h^{\\mathrm{TT}}_{ij}$. This sector is defined by two conditions:\n1.  **Transverse:** $\\partial^j h^{\\mathrm{TT}}_{ij} = 0$\n2.  **Traceless:** $\\delta^{ij} h^{\\mathrm{TT}}_{ij} = 0$ (so $h^{\\mathrm{TT}}=0$)\n\nA symmetric $3 \\times 3$ tensor has $6$ components. The transverse condition imposes $3$ constraints, and the traceless condition imposes $1$. However, one constraint is redundant, leaving $6-4=2$ independent components in $h^{\\mathrm{TT}}_{ij}$. These two components correspond to the two polarization states of a gravitational wave. The remaining $4$ components of $h_{ij}$ are gauge modes.\n\nLet us verify that this TT sector is consistent with the linearized dynamics. If we consider a solution that is purely transverse-traceless, $h_{ij} = h^{\\mathrm{TT}}_{ij}$:\n- The wave equation $\\ddot{h}_{ij} - \\nabla^2 h_{ij} = -\\partial_i(\\partial^k h_{kj}) - \\partial_j(\\partial^k h_{ki}) + \\partial_i \\partial_j h$ simplifies because $\\partial^k h_{kj}=0$ and $h=0$. The entire right-hand side vanishes, leaving a simple wave equation:\n  $$\\ddot{h}^{\\mathrm{TT}}_{ij} - \\nabla^2 h^{\\mathrm{TT}}_{ij} = 0$$\n- The linearized Hamiltonian constraint $\\partial_i \\partial_j h^{ij} - \\nabla^2 h = 0$ is satisfied: $\\partial_i(\\partial_j h^{ij}) - \\nabla^2(0) = 0$.\n- The linearized momentum constraint $\\partial_j (\\kappa^{ij} - \\delta^{ij}\\kappa) = 0$ becomes, using $\\kappa_{ij} = -\\frac{1}{2}\\dot{h}_{ij}$, $\\partial_j (-\\frac{1}{2}\\dot{h}^{ij} - \\delta^{ij}(-\\frac{1}{2}\\dot{h})) = 0$. For a TT mode, this simplifies to $\\partial_j(-\\frac{1}{2}\\dot{h}^{ij}) = -\\frac{1}{2}\\frac{\\partial}{\\partial t}(\\partial_j h^{ij}) = 0$.\n\nThus, the transverse-traceless sector represents the physical, propagating gravitational waves. The remaining sectors are the non-physical gauge modes.\n\n### Step 4: Derivation of the Dispersion Relation\nWe now seek the dispersion relation for these physical modes by using the plane-wave ansatz provided for $h^{\\mathrm{TT}}_{ij}$:\n$$h^{\\mathrm{TT}}_{ij}(t,\\mathbf{x}) = \\epsilon_{ij} \\exp\\big(i(k_{m} x^{m} - \\omega t)\\big)$$\nwhere $\\epsilon_{ij}$ is the constant polarization tensor, $\\mathbf{k}$ is the wave-vector with components $k_m$, and $\\omega$ is the angular frequency. The properties of the TT mode are encoded in $\\epsilon_{ij}$:\n- Traceless: $\\delta^{ij}\\epsilon_{ij} = 0$\n- Transverse: $k^j \\epsilon_{ij} = 0$\n\nWe substitute this ansatz into the wave equation for the TT modes, $\\ddot{h}^{\\mathrm{TT}}_{ij} - \\nabla^2 h^{\\mathrm{TT}}_{ij} = 0$.\nFirst, we compute the necessary derivatives:\n- Time derivatives: $\\frac{\\partial}{\\partial t} h^{\\mathrm{TT}}_{ij} = -i\\omega h^{\\mathrm{TT}}_{ij}$, which implies $\\ddot{h}^{\\mathrm{TT}}_{ij} = (-i\\omega)^2 h^{\\mathrm{TT}}_{ij} = -\\omega^2 h^{\\mathrm{TT}}_{ij}$.\n- Spatial derivatives: $\\partial_l h^{\\mathrm{TT}}_{ij} = ik_l h^{\\mathrm{TT}}_{ij}$. The Laplacian is $\\nabla^2 h^{\\mathrm{TT}}_{ij} = \\delta^{lm}\\partial_l\\partial_m h^{\\mathrm{TT}}_{ij} = \\delta^{lm}(ik_l)(ik_m)h^{\\mathrm{TT}}_{ij} = -(\\delta^{lm}k_l k_m)h^{\\mathrm{TT}}_{ij} = -|\\mathbf{k}|^2 h^{\\mathrm{TT}}_{ij}$.\n\nSubstituting these results into the wave equation:\n$$(-\\omega^2) h^{\\mathrm{TT}}_{ij} - (-|\\mathbf{k}|^2) h^{\\mathrm{TT}}_{ij} = 0$$\n$$(|\\mathbf{k}|^2 - \\omega^2) h^{\\mathrm{TT}}_{ij} = 0$$\nFor a non-trivial wave solution ($h^{\\mathrm{TT}}_{ij} \\neq 0$), the coefficient must be zero:\n$$|\\mathbf{k}|^2 - \\omega^2 = 0$$\n$$\\omega^2 = |\\mathbf{k}|^2$$\nAssuming a positive frequency $\\omega > 0$, we find the dispersion relation:\n$$\\omega = |\\mathbf{k}|$$\nThis linear dispersion relation signifies that the waves are non-dispersive and propagate at a speed $\\frac{\\omega}{|\\mathbf{k}|} = 1$. This corresponds to the speed of light, as expected for gravitational waves in vacuum General Relativity, consistent with our choice of units where $c=1$.", "answer": "$$\\boxed{\\omega = |\\mathbf{k}|}$$", "id": "3489095"}, {"introduction": "Having isolated the physical modes, a central challenge in numerical relativity is managing the remaining gauge (or coordinate) freedom. This choice is not arbitrary; it critically affects the stability and success of a long-term numerical evolution. This practice delves into the dynamics of the lapse function, which controls spacetime 'slicing', by analyzing how different gauge conditions manifest as propagating gauge modes and determining their characteristic speeds [@problem_id:3489081]. Understanding these speeds is essential for ensuring the underlying system of equations remains hyperbolic and well-behaved.", "problem": "Consider the vacuum Einstein equations written in the Arnowitt-Deser-Misner (ADM) formalism. The canonical variables are the spatial metric $\\gamma_{ij}$, its extrinsic curvature $K_{ij}$, the lapse $\\alpha$, and the shift $\\beta^{i}$. In vacuum, the fundamental evolution equations are\n$$\n\\partial_t \\gamma_{ij} = -2 \\alpha K_{ij} + \\nabla_i \\beta_j + \\nabla_j \\beta_i,\n$$\n$$\n\\partial_t K_{ij} = -\\nabla_i \\nabla_j \\alpha + \\alpha \\left( R_{ij} + K K_{ij} - 2 K_{ik} K^{k}{}_{j} \\right),\n$$\nwhere $R_{ij}$ is the Ricci tensor of $\\gamma_{ij}$, $K = \\gamma^{ij} K_{ij}$ is the trace of $K_{ij}$, and $\\nabla_i$ denotes the spatial covariant derivative compatible with $\\gamma_{ij}$.\n\nAssume a Minkowski background with $\\gamma_{ij} = \\delta_{ij}$, $\\alpha = 1$, $\\beta^{i} = 0$, and $K_{ij} = 0$, and consider small perturbations. Define the lapse perturbation $a$ by $\\alpha = 1 + a$ with $|a| \\ll 1$, and let $k$ denote the perturbation of the trace $K$.\n\nAdopt a slicing condition from the Bona-Massó family, specified by\n$$\n\\partial_t \\alpha - \\beta^{i} \\partial_i \\alpha = - \\alpha^{2} f(\\alpha) K,\n$$\nwhere $f(\\alpha)$ is a smooth positive function, and where the special case of harmonic slicing is recovered by $f(\\alpha) = 1$. Linearize this slicing condition around the Minkowski background and derive the coupled linearized evolution equations for $a$ and $k$. Using these, determine the dispersion relation for plane-wave gauge perturbations $a$ of the form $a \\propto \\exp\\left( i k_j x^{j} - i \\omega t \\right)$, and hence compute the characteristic speed $c_g = \\omega/|\\mathbf{k}|$ of the gauge mode in the coordinate frame.\n\nReport your final answer as a single $1\\times 2$ row matrix containing the two characteristic speeds: first for harmonic slicing, and second for the general Bona-Massó family expressed in terms of $f_0 = f(1)$. No units are required. If any stability condition arises from the requirement that the characteristic speeds be real, explain it in your derivation, but do not include it in the final reported values.", "solution": "The problem requires the derivation of the characteristic speed of gauge perturbations within the Arnowitt-Deser-Misner (ADM) formalism, under a specific family of slicing conditions. The procedure involves linearizing the relevant evolution equations around a Minkowski background, forming a wave equation for the gauge perturbations, and then extracting the dispersion relation and propagation speed.\n\nThe starting point is the set of vacuum ADM evolution equations and the Bona-Massó slicing condition. The fundamental variables are the spatial metric $\\gamma_{ij}$, its extrinsic curvature $K_{ij}$, the lapse function $\\alpha$, and the shift vector $\\beta^i$. The provided equations are:\n$$\n\\partial_t \\gamma_{ij} = -2 \\alpha K_{ij} + \\nabla_i \\beta_j + \\nabla_j \\beta_i\n$$\n$$\n\\partial_t K_{ij} = -\\nabla_i \\nabla_j \\alpha + \\alpha \\left( R_{ij} + K K_{ij} - 2 K_{ik} K^{k}{}_{j} \\right)\n$$\nAnd the Bona-Massó slicing condition:\n$$\n\\partial_t \\alpha - \\beta^{i} \\partial_i \\alpha = - \\alpha^{2} f(\\alpha) K\n$$\nwhere $K = \\gamma^{ij} K_{ij}$ is the trace of the extrinsic curvature and $R_{ij}$ is the Ricci tensor of the spatial metric $\\gamma_{ij}$.\n\nWe linearize these equations around a flat Minkowski background, which is specified by $\\gamma_{ij} = \\delta_{ij}$, $K_{ij} = 0$, $\\alpha = 1$, and $\\beta^i = 0$. We introduce small perturbations: the lapse perturbation $a$ is defined by $\\alpha = 1 + a$ with $|a| \\ll 1$, and $k$ is the first-order perturbation of the trace of the extrinsic curvature, so $K \\approx k$. All other perturbations, such as the metric perturbation $h_{ij}$ (where $\\gamma_{ij} = \\delta_{ij} + h_{ij}$), the shift $\\beta^i$, and the extrinsic curvature $K_{ij}$ itself, are considered first-order quantities.\n\nFirst, we linearize the Bona-Massó slicing condition.\n$$\n\\partial_t (1+a) - \\beta^{i} \\partial_i (1+a) = - (1+a)^{2} f(1+a) k\n$$\nThe term $\\beta^i \\partial_i(1+a) = \\beta^i \\partial_i a$ is a product of two first-order quantities, so it is of second order and vanishes in the linearization. The left side becomes $\\partial_t a$.\nOn the right side, we expand to first order: $(1+a)^2 \\approx 1+2a$, and $f(1+a) \\approx f(1) + f'(1)a$.\nThe right side is $-(1+2a)(f(1) + f'(1)a)k$. Since $a$ and $k$ are both first-order quantities, their product is second-order. Retaining only the first-order terms, we get $-(1)(f(1))k$.\nLet's define $f_0 = f(1)$. The linearized slicing condition is:\n$$\n\\partial_t a = -f_0 k\n$$\nThis provides the first of two coupled equations for the gauge variables $a$ and $k$.\n\nNext, we linearize the evolution equation for $K_{ij}$ and then take its trace to find an evolution equation for $k$.\n$$\n\\partial_t K_{ij} = -\\nabla_i \\nabla_j \\alpha + \\alpha \\left( R_{ij} + K K_{ij} - 2 K_{ik} K^{k}{}_{j} \\right)\n$$\nThe terms $K K_{ij}$ and $K_{ik} K^k_j$ are products of first-order quantities, making them second-order. They vanish in the linearization.\nThe term $\\alpha R_{ij} = (1+a)R_{ij}$. The Ricci tensor $R_{ij}$ of the perturbed metric is itself a first-order quantity. Thus, the product $a R_{ij}$ is second-order and vanishes. The term linearizes to $R_{ij}$.\nThe term $-\\nabla_i \\nabla_j \\alpha = -\\nabla_i \\nabla_j (1+a) = -\\nabla_i \\nabla_j a$. In a perturbed geometry, $\\nabla_i\\nabla_j a = \\partial_i\\partial_j a - \\Gamma^l_{ij}\\partial_l a$. The Christoffel symbols $\\Gamma^l_{ij}$ are first-order in the metric perturbation $h_{ij}$. Thus, the term $\\Gamma^l_{ij}\\partial_l a$ is second-order. To first order, we have $\\nabla_i \\nabla_j a \\approx \\partial_i \\partial_j a$.\nSo, the linearized evolution equation for $K_{ij}$ is:\n$$\n\\partial_t K_{ij} = -\\partial_i \\partial_j a + R_{ij}\n$$\nNow we take the trace to get an equation for $k$. The trace is $K = \\gamma^{ij} K_{ij}$. Its time derivative is $\\partial_t K = (\\partial_t \\gamma^{ij}) K_{ij} + \\gamma^{ij} (\\partial_t K_{ij})$. The term $(\\partial_t \\gamma^{ij}) K_{ij}$ is second-order, so to first order, $\\partial_t k \\approx \\delta^{ij} \\partial_t K_{ij}$.\nTaking the trace of the linearized equation for $K_{ij}$:\n$$\n\\partial_t k \\approx \\delta^{ij} (\\partial_t K_{ij}) = \\delta^{ij}(-\\partial_i \\partial_j a + R_{ij}) = -\\nabla^2 a + R\n$$\nwhere $\\nabla^2 = \\delta^{ij}\\partial_i\\partial_j$ is the flat-space Laplacian and $R = \\delta^{ij}R_{ij}$ is the linearized Ricci scalar of the spatial metric. The Ricci scalar $R$ depends on the physical metric perturbations $h_{ij}$ and couples the gauge dynamics to the gravitational wave dynamics. To isolate the dynamics of the gauge sector, it is standard to assume the absence of physical perturbations, which corresponds to setting $R=0$. This reduces the system to a self-contained set of equations for the gauge variables $a$ and $k$. With this well-justified assumption, our second linearized equation is:\n$$\n\\partial_t k = -\\nabla^2 a\n$$\nWe now have a closed system of two coupled first-order linear partial differential equations:\n$1.$ $\\partial_t a = -f_0 k$\n$2.$ $\\partial_t k = -\\nabla^2 a$\n\nTo find the dispersion relation, we combine these into a single second-order equation. We differentiate the first equation with respect to time $t$:\n$$\n\\partial_t^2 a = -f_0 \\partial_t k\n$$\nSubstituting the second equation into this gives:\n$$\n\\partial_t^2 a = -f_0(-\\nabla^2 a) = f_0 \\nabla^2 a\n$$\nThis gives the wave equation for the lapse perturbation $a$:\n$$\n\\partial_t^2 a - f_0 \\nabla^2 a = 0\n$$\nThis is a standard wave equation of the form $\\frac{1}{c^2}\\partial_t^2 \\phi - \\nabla^2 \\phi = 0$. By comparison, the squared propagation speed is $c^2=f_0$.\n\nTo formally derive the speed, we assume a plane-wave solution for the gauge mode $a$ of the form $a \\propto \\exp(i k_j x^j - i \\omega t)$. Substituting this ansatz into the wave equation yields:\n$$\n(-i\\omega)^2 a - f_0 (i k_j)(i k^j) a = 0\n$$\n$$\n-\\omega^2 a - f_0 (-|\\mathbf{k}|^2) a = 0\n$$\n$$\n(-\\omega^2 + f_0 |\\mathbf{k}|^2) a = 0\n$$\nFor a non-trivial solution ($a \\neq 0$), the expression in the parenthesis must be zero. This gives the dispersion relation:\n$$\n\\omega^2 = f_0 |\\mathbf{k}|^2\n$$\nThe characteristic speed of the gauge mode is $c_g = \\frac{\\omega}{|\\mathbf{k}|}$. From the dispersion relation, we find:\n$$\nc_g^2 = \\frac{\\omega^2}{|\\mathbf{k}|^2} = f_0 \\quad \\implies \\quad c_g = \\sqrt{f_0}\n$$\nThe problem statement specifies that $f(\\alpha)$ is a \"smooth positive function\". This means $f_0 = f(1) > 0$. Consequently, the characteristic speed $c_g$ is always real, and the corresponding gauge system is stable (its evolution equations are hyperbolic).\n\nWe can now find the specific speeds requested.\n1.  For harmonic slicing, $f(\\alpha)=1$. This implies $f_0 = f(1) = 1$. The characteristic speed is:\n    $$\n    c_g = \\sqrt{1} = 1\n    $$\n    This is the speed of light, as expected for perturbations in the harmonic gauge.\n2.  For the general Bona-Massó family, the characteristic speed is expressed in terms of $f_0 = f(1)$:\n    $$\n    c_g = \\sqrt{f_0}\n    $$\nThe final answer is presented as a $1 \\times 2$ row matrix containing these two speeds.", "answer": "$$\n\\boxed{\\begin{pmatrix} 1  \\sqrt{f_0} \\end{pmatrix}}\n$$", "id": "3489081"}, {"introduction": "The ADM formalism's most profound feature is its reformulation of General Relativity as a Hamiltonian system, subject to constraints. This structure has powerful implications for numerical methods, as preserving these constraints over long evolutions is paramount for physical accuracy. This final exercise explores this deep connection by applying a simple cosmological model to compare a standard integrator with a symplectic integrator, which is purpose-built to respect Hamiltonian structure [@problem_id:3489062]. You will directly observe how the choice of algorithm dramatically impacts the long-term conservation of the Hamiltonian constraint, a vital lesson for any aspiring numerical relativist.", "problem": "Consider a homogeneous, diagonal, anisotropic mini-superspace model of General Relativity in the Arnowitt-Deser-Misner (ADM) formalism, specifically the Bianchi type I cosmology augmented by a positive cosmological constant. In Misner variables $(\\alpha,\\beta_{+},\\beta_{-})$ with conjugate momenta $(p_{\\alpha},p_{+},p_{-})$, work in Planck units where $c=1$ and $8\\pi G=1$ so that all quantities are dimensionless. The Hamiltonian constraint is given by\n$$\nC(\\alpha,\\beta_{+},\\beta_{-},p_{\\alpha},p_{+},p_{-};\\Lambda)\n=\n-p_{\\alpha}^{2} + p_{+}^{2} + p_{-}^{2} + \\Lambda\\, e^{6\\alpha},\n$$\nand physical trajectories satisfy $C \\approx 0$. The total Hamiltonian is $H = N\\,C$ and, in the time gauge $N=1$, Hamilton’s equations are\n$$\n\\dot{\\alpha} = \\frac{\\partial C}{\\partial p_{\\alpha}},\\quad\n\\dot{\\beta}_{+} = \\frac{\\partial C}{\\partial p_{+}},\\quad\n\\dot{\\beta}_{-} = \\frac{\\partial C}{\\partial p_{-}},\n$$\n$$\n\\dot{p}_{\\alpha} = -\\frac{\\partial C}{\\partial \\alpha},\\quad\n\\dot{p}_{+} = -\\frac{\\partial C}{\\partial \\beta_{+}},\\quad\n\\dot{p}_{-} = -\\frac{\\partial C}{\\partial \\beta_{-}}.\n$$\nThis system is separable, $C = T(p_{\\alpha},p_{+},p_{-}) + V(\\alpha)$, with\n$$\nT(p_{\\alpha},p_{+},p_{-}) = -p_{\\alpha}^{2} + p_{+}^{2} + p_{-}^{2},\\quad\nV(\\alpha) = \\Lambda\\, e^{6\\alpha}.\n$$\n\nYour task is to implement two numerical time integrators for this system and compare long-time stability of the Hamiltonian constraint $C \\approx 0$:\n\n1. A symplectic splitting (Strang/Stormer–Verlet) integrator based on the decomposition $C = T + V$, using the canonical update:\n   - Half kick on momenta by $V$: $p \\leftarrow p - \\tfrac{\\Delta t}{2}\\,\\nabla_{q} V(q)$.\n   - Full drift on coordinates by $T$: $q \\leftarrow q + \\Delta t\\,\\nabla_{p} T(p)$.\n   - Half kick on momenta by $V$ at the updated $q$.\n   Here, $q=(\\alpha,\\beta_{+},\\beta_{-})$ and $p=(p_{\\alpha},p_{+},p_{-})$, and $\\nabla_{q} V$ is nonzero only in the $\\alpha$ component: $\\partial V/\\partial \\alpha = 6\\Lambda e^{6\\alpha}$.\n\n2. A non-symplectic explicit Runge–Kutta method of classical order four (Runge–Kutta (RK) $4$) applied to Hamilton’s ordinary differential equations (ODEs).\n\nStart from initial data $(\\alpha_{0},\\beta_{+,0},\\beta_{-,0},p_{\\alpha,0},p_{+,0},p_{-,0})$ for which the constraint is initially satisfied up to floating point error by choosing $p_{\\alpha,0}$ as\n$$\np_{\\alpha,0} = \\sqrt{p_{+,0}^{2} + p_{-,0}^{2} + \\Lambda\\, e^{6\\alpha_{0}}}.\n$$\n\nFor each test case, integrate up to total time $T$ using fixed time step $\\Delta t$ with both methods and record the maximum absolute drift of the constraint,\n$$\n\\Delta C_{\\max} = \\max_{n\\in\\{0,1,\\dots,N\\}} \\left| C(\\text{state}(t_{n})) - C(\\text{state}(t_{0})) \\right|,\n$$\nwhere $t_{n} = n\\,\\Delta t$ and $N = \\lfloor T/\\Delta t \\rfloor$. Compute this quantity for the symplectic method and the RK $4$ method, and report whether the symplectic method exhibits smaller or equal drift than RK $4$.\n\nImplement your program to produce results for the following test suite. Each test case specifies $(\\Lambda, T, \\Delta t, \\alpha_{0}, \\beta_{+,0}, \\beta_{-,0}, p_{+,0}, p_{-,0})$:\n\n- Case $1$ (vacuum boundary): $(\\Lambda=\\;0,\\; T=\\;100,\\;\\Delta t=\\;0.1,\\;\\alpha_{0}=\\;0,\\;\\beta_{+,0}=\\;0,\\;\\beta_{-,0}=\\;0,\\;p_{+,0}=\\;0.01,\\;p_{-,0}=\\;-0.015)$.\n- Case $2$ (long-time, small potential): $(\\Lambda=\\;10^{-3},\\; T=\\;1000,\\;\\Delta t=\\;0.5,\\;\\alpha_{0}=\\;0.2,\\;\\beta_{+,0}=\\;0.05,\\;\\beta_{-,0}=\\;-0.03,\\;p_{+,0}=\\;0.02,\\;p_{-,0}=\\;-0.01)$.\n- Case $3$ (moderate potential): $(\\Lambda=\\;10^{-2},\\; T=\\;500,\\;\\Delta t=\\;0.5,\\;\\alpha_{0}=\\;-0.2,\\;\\beta_{+,0}=\\;0,\\;\\beta_{-,0}=\\;0,\\;p_{+,0}=\\;0.02,\\;p_{-,0}=\\;0.015)$.\n- Case $4$ (large step stress test): $(\\Lambda=\\;10^{-2},\\; T=\\;500,\\;\\Delta t=\\;1.5,\\;\\alpha_{0}=\\;0.4,\\;\\beta_{+,0}=\\;0,\\;\\beta_{-,0}=\\;0,\\;p_{+,0}=\\;0.03,\\;p_{-,0}=\\;-0.025)$.\n\nAll quantities are dimensionless in these units. Your program should compute, for each case, the triple\n$$\n\\left[\\Delta C_{\\max}^{\\text{symp}},\\ \\Delta C_{\\max}^{\\text{RK4}},\\ \\text{symp\\_better}\\right],\n$$\nwhere $\\Delta C_{\\max}^{\\text{symp}}$ and $\\Delta C_{\\max}^{\\text{RK4}}$ are floats (in dimensionless units) and $\\text{symp\\_better}$ is a boolean indicating whether $\\Delta C_{\\max}^{\\text{symp}} \\le \\Delta C_{\\max}^{\\text{RK4}}$.\n\nFinal output format: Your program should produce a single line of output containing the results as a comma-separated list of the four case results, each case result itself being a list as above, and the entire output enclosed in square brackets, for example,\n$[\\,[x_{1},y_{1},b_{1}],\\,[x_{2},y_{2},b_{2}],\\,[x_{3},y_{3},b_{3}],\\,[x_{4},y_{4},b_{4}]\\,]$,\nwith actual numeric values substituted.", "solution": "The solution proceeds by first defining the dynamics of the system, then detailing the implementation of the two required numerical integrators, and finally executing the comparison for the specified test cases.\n\nLet the state of the system be described by the canonical coordinates $q = (\\alpha, \\beta_{+}, \\beta_{-})$ and their conjugate momenta $p = (p_{\\alpha}, p_{+}, p_{-})$. The Hamiltonian constraint, in units where $8\\pi G = 1$, is given by:\n$$\nC(q, p; \\Lambda) = -p_{\\alpha}^{2} + p_{+}^{2} + p_{-}^{2} + \\Lambda e^{6\\alpha}\n$$\nPhysical trajectories are level sets of this constraint, specifically $C \\approx 0$. In the gauge where the lapse function is $N=1$, the total Hamiltonian is $H = C$. Hamilton's equations, $\\dot{q} = \\partial H / \\partial p$ and $\\dot{p} = - \\partial H / \\partial q$, govern the time evolution:\n\\begin{align*}\n\\dot{\\alpha} = \\frac{\\partial C}{\\partial p_{\\alpha}} = -2p_{\\alpha} \\\\\n\\dot{\\beta}_{+} = \\frac{\\partial C}{\\partial p_{+}} = 2p_{+} \\\\\n\\dot{\\beta}_{-} = \\frac{\\partial C}{\\partial p_{-}} = 2p_{-} \\\\\n\\dot{p}_{\\alpha} = -\\frac{\\partial C}{\\partial \\alpha} = -6\\Lambda e^{6\\alpha} \\\\\n\\dot{p}_{+} = -\\frac{\\partial C}{\\partial \\beta_{+}} = 0 \\\\\n\\dot{p}_{-} = -\\frac{\\partial C}{\\partial \\beta_{-}} = 0\n\\end{align*}\nThese equations define the system of Ordinary Differential Equations (ODEs) to be integrated numerically. The initial state $(\\alpha_0, \\beta_{+,0}, \\beta_{-,0}, p_{\\alpha,0}, p_{+,0}, p_{-,0})$ is fully specified by setting $p_{\\alpha,0} = \\sqrt{p_{+,0}^{2} + p_{-,0}^{2} + \\Lambda e^{6\\alpha_0}}$ to ensure the initial state satisfies $C=0$.\n\nThe core of the task is to implement and compare two numerical integrators.\n\n**1. Symplectic Splitting (Strang/Stormer-Verlet) Integrator**\n\nThis method leverages the separable structure of the Hamiltonian, $C(q,p) = T(p) + V(q)$, where:\n$$\nT(p) = -p_{\\alpha}^{2} + p_{+}^{2} + p_{-}^{2}\n\\qquad\nV(q) = \\Lambda e^{6\\alpha}\n$$\nThe integrator is a second-order accurate composition of the exact flows generated by $T$ and $V$. A single time step $\\Delta t$ from state $(q_n, p_n)$ to $(q_{n+1}, p_{n+1})$ is performed via a kick-drift-kick sequence:\n\n- **Step 1: Half Kick.** Update momenta under the potential $V$ for a half time step, $\\Delta t/2$. The evolution is $\\dot{p} = -\\nabla_q V$.\n  $$\n  p_{n+1/2} = p_n - \\frac{\\Delta t}{2} \\nabla_q V(q_n)\n  $$\n  Since $V$ only depends on $\\alpha$, only $p_{\\alpha}$ changes:\n  \\begin{align*}\n  p_{\\alpha, n+1/2} = p_{\\alpha, n} - \\frac{\\Delta t}{2} \\left( 6\\Lambda e^{6\\alpha_n} \\right) \\\\\n  p_{+, n+1/2} = p_{+, n} \\\\\n  p_{-, n+1/2} = p_{-, n}\n  \\end{align*}\n\n- **Step 2: Full Drift.** Update coordinates under the kinetic term $T$ for a full time step, $\\Delta t$, using the half-updated momenta. The evolution is $\\dot{q} = \\nabla_p T$:\n  $$\n  q_{n+1} = q_n + \\Delta t \\, \\nabla_p T(p_{n+1/2})\n  $$\n  Specifically:\n  \\begin{align*}\n  \\alpha_{n+1} = \\alpha_n + \\Delta t (-2p_{\\alpha, n+1/2}) \\\\\n  \\beta_{+, n+1} = \\beta_{+, n} + \\Delta t (2p_{+, n+1/2}) \\\\\n  \\beta_{-, n+1} = \\beta_{-, n} + \\Delta t (2p_{-, n+1/2})\n  \\end{align*}\n\n- **Step 3: Half Kick.** Update the momenta from the drift step for another half time step, $\\Delta t/2$, using the newly computed coordinates $q_{n+1}$:\n  $$\n  p_{n+1} = p_{n+1/2} - \\frac{\\Delta t}{2} \\nabla_q V(q_{n+1})\n  $$\n  Again, only $p_{\\alpha}$ is affected:\n  \\begin{align*}\n  p_{\\alpha, n+1} = p_{\\alpha, n+1/2} - \\frac{\\Delta t}{2} \\left( 6\\Lambda e^{6\\alpha_{n+1}} \\right) \\\\\n  p_{+, n+1} = p_{+, n+1/2} = p_{+,n} \\\\\n  p_{-, n+1} = p_{-, n+1/2} = p_{-,n}\n  \\end{align*}\nNote that $p_{+}$ and $p_{-}$ are constants of motion for this system, a fact an exact solution would preserve. The symplectic integrator correctly reflects this, as they are unchanged by the update steps.\n\n**2. Runge-Kutta 4 (RK4) Integrator**\n\nThis is a general-purpose, non-symplectic explicit integrator of fourth order. We define a state vector $Y = (\\alpha, \\beta_{+}, \\beta_{-}, p_{\\alpha}, p_{+}, p_{-})^T$. The system of ODEs is written as $\\dot{Y} = \\vec{f}(Y)$, where:\n$$\n\\vec{f}(Y) = \\begin{pmatrix} -2p_{\\alpha} \\\\ 2p_{+} \\\\ 2p_{-} \\\\ -6\\Lambda e^{6\\alpha} \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\nA single time step from $Y_n$ to $Y_{n+1}$ is calculated as:\n\\begin{align*}\n  k_1 = \\vec{f}(Y_n) \\\\\n  k_2 = \\vec{f}(Y_n + \\frac{\\Delta t}{2} k_1) \\\\\n  k_3 = \\vec{f}(Y_n + \\frac{\\Delta t}{2} k_2) \\\\\n  k_4 = \\vec{f}(Y_n + \\Delta t k_3) \\\\\n  Y_{n+1} = Y_n + \\frac{\\Delta t}{6} (k_1 + 2k_2 + 2k_3 + k_4)\n\\end{align*}\n\n**Numerical Implementation**\n\nThe program is structured as follows:\n- A function `hamiltonian_constraint` computes the value of $C$ for a given state.\n- A function `ode_rhs` computes the vector $\\vec{f}(Y)$ for the RK4 method.\n- Functions `run_symplectic` and `run_rk4` implement the respective integration schemes. Each function takes the initial state and simulation parameters, iterates for $N=\\lfloor T/\\Delta t \\rfloor$ steps, and returns the maximum absolute drift of the Hamiltonian constraint, $\\Delta C_{\\max} = \\max_n |C_n - C_0|$, over the trajectory.\n- A main function `solve` sets up the test cases, calculates the initial state for each, calls both integrators, compares their resulting $\\Delta C_{\\max}$, and formats the output string as required.\n\nThe symplectic integrator is expected to show superior long-term stability by approximately conserving the Hamiltonian $C$, even though it is only a second-order method. The RK4 method, despite its higher order, is not designed to preserve such geometric structures and will typically exhibit secular drift in the value of $C$ over long integration times.", "answer": "[[0.0,1.5543122344752192e-14,True],[5.708899818819191e-11,0.00010901597818987451,True],[2.449788323680987e-09,0.00014264628886918115,True],[5.362921021751143e-07,0.007823521235451965,True]]", "id": "3489062"}]}