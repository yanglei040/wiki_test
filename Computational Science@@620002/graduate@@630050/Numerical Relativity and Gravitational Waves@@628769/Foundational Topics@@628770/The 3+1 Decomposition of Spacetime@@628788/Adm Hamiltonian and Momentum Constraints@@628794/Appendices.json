{"hands_on_practices": [{"introduction": "The Arnowitt–Deser–Misner (ADM) formalism provides a powerful way to split four-dimensional spacetime into separate space and time components, a crucial step for formulating general relativity as a dynamical initial value problem. This first exercise serves as a fundamental drill in the mechanics of this \"3+1\" decomposition. By starting with the familiar flat Minkowski spacetime but describing it in a non-inertial, rotating coordinate system, you will practice identifying the core building blocks of the ADM framework: the lapse function $N$, the shift vector $\\beta^i$, and the spatial metric $\\gamma_{ij}$ [@problem_id:3463445]. This practice solidifies the geometric meaning of these quantities by showing how they emerge from a simple coordinate transformation.", "problem": "Consider flat Minkowski spacetime written in inertial cylindrical coordinates $\\left(t',r,\\phi',z\\right)$ with line element $\\mathrm{d}s^{2}=-\\mathrm{d}t'^{2}+\\mathrm{d}r^{2}+r^{2}\\mathrm{d}\\phi'^{2}+\\mathrm{d}z^{2}$. Introduce a uniformly rotating cylindrical chart $\\left(t,r,\\phi,z\\right)$ with constant angular velocity $\\Omega$ by the smooth, time-dependent change of coordinates\n$$t'=t,\\quad r'=r,\\quad z'=z,\\quad \\phi'=\\phi+\\Omega t.$$\nWorking within the Arnowitt–Deser–Misner (ADM) $3+1$ decomposition, determine explicitly the lapse $N$, the shift components $\\beta^{i}$ for $i\\in\\{r,\\phi,z\\}$, and the spatial metric components $\\gamma_{ij}$ on $t=\\text{constant}$ slices in the rotating chart. Then verify the identity $\\sqrt{-g}=N\\sqrt{\\gamma}$ by computing both sides from first principles, where $g$ is the determinant of the spacetime metric and $\\gamma$ is the determinant of the spatial metric $\\gamma_{ij}$. Assume $r\\ge 0$ and choose the forward-in-time orientation of the lapse.\n\nAnswer specification:\n- Provide the final answer as a single row matrix in the order $\\left(N,\\beta^{r},\\beta^{\\phi},\\beta^{z},\\gamma_{rr},\\gamma_{\\phi\\phi},\\gamma_{zz}\\right)$, expressed as functions of $r$ and $\\Omega$.\n- Do not include any units.", "solution": "The problem is valid as it is scientifically grounded in the principles of general relativity, specifically the Arnowitt–Deser–Misner (ADM) $3+1$ formalism, and presents a well-posed mathematical physics problem with a unique solution. All necessary information is provided, and the problem is free of contradictions or ambiguities.\n\nOur first step is to find the spacetime metric in the rotating cylindrical coordinate system $(t, r, \\phi, z)$. We are given the coordinate transformation from the inertial cylindrical coordinates $(t', r, \\phi', z)$ to the rotating ones:\n$$t' = t$$\n$$r' = r$$\n$$z' = z$$\n$$\\phi' = \\phi + \\Omega t$$\nwhere $\\Omega$ is a constant angular velocity. To transform the line element, we first compute the differentials of the primed coordinates in terms of the unprimed ones:\n$$\\mathrm{d}t' = \\mathrm{d}t$$\n$$\\mathrm{d}r' = \\mathrm{d}r$$\n$$\\mathrm{d}z' = \\mathrm{d}z$$\n$$\\mathrm{d}\\phi' = \\mathrm{d}\\phi + \\Omega \\, \\mathrm{d}t$$\nThe line element in the inertial frame is given as:\n$$\\mathrm{d}s^{2} = -\\mathrm{d}t'^{2} + \\mathrm{d}r^{2} + r^{2}\\mathrm{d}\\phi'^{2} + \\mathrm{d}z^{2}$$\nSubstituting the differentials, we obtain the line element in the rotating frame:\n$$\\mathrm{d}s^{2} = -(\\mathrm{d}t)^{2} + (\\mathrm{d}r)^{2} + r^{2}(\\mathrm{d}\\phi + \\Omega \\, \\mathrm{d}t)^{2} + (\\mathrm{d}z)^{2}$$\nWe expand the squared term:\n$$\\mathrm{d}s^{2} = -\\mathrm{d}t^{2} + \\mathrm{d}r^{2} + r^{2}(\\mathrm{d}\\phi^{2} + 2\\Omega \\, \\mathrm{d}\\phi \\, \\mathrm{d}t + \\Omega^{2} \\, \\mathrm{d}t^{2}) + \\mathrm{d}z^{2}$$\nNext, we group the terms by the differentials $\\mathrm{d}t^{2}$, $\\mathrm{d}t \\, \\mathrm{d}x^{i}$, and $\\mathrm{d}x^{i}\\mathrm{d}x^{j}$:\n$$\\mathrm{d}s^{2} = (-1 + r^{2}\\Omega^{2})\\mathrm{d}t^{2} + 2r^{2}\\Omega \\, \\mathrm{d}t \\, \\mathrm{d}\\phi + \\mathrm{d}r^{2} + r^{2}\\mathrm{d}\\phi^{2} + \\mathrm{d}z^{2}$$\nFrom this expression, we can read off the components of the spacetime metric tensor $g_{\\mu\\nu}$ in the coordinate basis $\\{\\mathrm{d}t, \\mathrm{d}r, \\mathrm{d}\\phi, \\mathrm{d}z\\}$:\n$$g_{tt} = -1 + r^{2}\\Omega^{2}$$\n$$g_{t\\phi} = g_{\\phi t} = r^{2}\\Omega$$\n$$g_{rr} = 1$$\n$$g_{\\phi\\phi} = r^{2}$$\n$$g_{zz} = 1$$\nAll other components of $g_{\\mu\\nu}$ are zero. The metric tensor can be written as a matrix:\n$$\n(g_{\\mu\\nu}) = \\begin{pmatrix}\n-1 + r^{2}\\Omega^{2} & 0 & r^{2}\\Omega & 0 \\\\\n0 & 1 & 0 & 0 \\\\\nr^{2}\\Omega & 0 & r^{2} & 0 \\\\\n0 & 0 & 0 & 1\n\\end{pmatrix}\n$$\nNow, we relate this to the ADM $3+1$ decomposition of the line element:\n$$\\mathrm{d}s^{2} = -N^{2}\\mathrm{d}t^{2} + \\gamma_{ij}(\\mathrm{d}x^{i} + \\beta^{i}\\mathrm{d}t)(\\mathrm{d}x^{j} + \\beta^{j}\\mathrm{d}t)$$\nExpanding this form gives:\n$$\\mathrm{d}s^{2} = (-N^{2} + \\beta_{k}\\beta^{k})\\mathrm{d}t^{2} + 2\\beta_{j}\\mathrm{d}x^{j}\\mathrm{d}t + \\gamma_{ij}\\mathrm{d}x^{i}\\mathrm{d}x^{j}$$\nwhere $\\beta_{j} = \\gamma_{ji}\\beta^{i}$. By comparing the components of $g_{\\mu\\nu}$ with this general form, we can identify the lapse $N$, the shift vector components $\\beta^{i}$, and the spatial metric components $\\gamma_{ij}$.\nThe spatial metric components $\\gamma_{ij}$ are the coefficients of the purely spatial terms $\\mathrm{d}x^{i}\\mathrm{d}x^{j}$:\n$$\\gamma_{rr} = 1, \\quad \\gamma_{\\phi\\phi} = r^{2}, \\quad \\gamma_{zz} = 1$$\nAll off-diagonal components $\\gamma_{ij}$ for $i \\neq j$ are zero. The spatial metric is diagonal:\n$$\n(\\gamma_{ij}) = \\begin{pmatrix}\n1 & 0 & 0 \\\\\n0 & r^{2} & 0 \\\\\n0 & 0 & 1\n\\end{pmatrix}\n$$\nThe covariant components of the shift vector, $\\beta_{i}$, are related to the time-space components of the metric, $g_{ti}$, by $\\beta_{i} = g_{ti}$.\n$$\\beta_{r} = g_{tr} = 0$$\n$$\\beta_{\\phi} = g_{t\\phi} = r^{2}\\Omega$$\n$$\\beta_{z} = g_{tz} = 0$$\nTo find the contravariant components $\\beta^{i}$, we must raise the index using the inverse spatial metric $\\gamma^{ij}$. First, we compute $\\gamma^{ij}$:\n$$\n(\\gamma^{ij}) = (\\gamma_{ij})^{-1} = \\begin{pmatrix}\n1 & 0 & 0 \\\\\n0 & r^{-2} & 0 \\\\\n0 & 0 & 1\n\\end{pmatrix}\n$$\nNow, we compute $\\beta^{i} = \\gamma^{ij}\\beta_{j}$:\n$$\\beta^{r} = \\gamma^{rr}\\beta_{r} + \\gamma^{r\\phi}\\beta_{\\phi} + \\gamma^{rz}\\beta_{z} = 1 \\cdot 0 + 0 + 0 = 0$$\n$$\\beta^{\\phi} = \\gamma^{\\phi r}\\beta_{r} + \\gamma^{\\phi\\phi}\\beta_{\\phi} + \\gamma^{\\phi z}\\beta_{z} = 0 + (r^{-2})(r^{2}\\Omega) + 0 = \\Omega$$\n$$\\beta^{z} = \\gamma^{zr}\\beta_{r} + \\gamma^{z\\phi}\\beta_{\\phi} + \\gamma^{zz}\\beta_{z} = 0 + 0 + 1 \\cdot 0 = 0$$\nSo the shift vector components are $\\beta^{r}=0$, $\\beta^{\\phi}=\\Omega$, and $\\beta^{z}=0$.\nFinally, we determine the lapse function $N$ from the $g_{tt}$ component:\n$$g_{tt} = -N^{2} + \\beta_{i}\\beta^{i}$$\nFirst, compute the scalar product $\\beta_{i}\\beta^{i}$:\n$$\\beta_{i}\\beta^{i} = \\beta_{r}\\beta^{r} + \\beta_{\\phi}\\beta^{\\phi} + \\beta_{z}\\beta^{z} = (0)(0) + (r^{2}\\Omega)(\\Omega) + (0)(0) = r^{2}\\Omega^{2}$$\nSubstituting this and $g_{tt} = -1 + r^{2}\\Omega^{2}$ into the equation for $g_{tt}$:\n$$-1 + r^{2}\\Omega^{2} = -N^{2} + r^{2}\\Omega^{2}$$\n$$-1 = -N^{2} \\implies N^{2} = 1$$\nThe problem specifies to choose the forward-in-time orientation for the lapse, which means $N > 0$. Therefore, $N=1$.\n\nThe required ADM quantities are:\n$N=1$, $\\beta^{r}=0$, $\\beta^{\\phi}=\\Omega$, $\\beta^{z}=0$, $\\gamma_{rr}=1$, $\\gamma_{\\phi\\phi}=r^{2}$, $\\gamma_{zz}=1$.\n\nThe second part of the task is to verify the identity $\\sqrt{-g} = N\\sqrt{\\gamma}$.\nFirst, we compute the determinant $g$ of the spacetime metric $g_{\\mu\\nu}$:\n$$g = \\det \\begin{pmatrix}\n-1 + r^{2}\\Omega^{2} & 0 & r^{2}\\Omega & 0 \\\\\n0 & 1 & 0 & 0 \\\\\nr^{2}\\Omega & 0 & r^{2} & 0 \\\\\n0 & 0 & 0 & 1\n\\end{pmatrix}$$\nExpanding along the fourth row, then the second row of the resulting $3 \\times 3$ matrix:\n$$g = (1) \\det \\begin{pmatrix}\n-1 + r^{2}\\Omega^{2} & 0 & r^{2}\\Omega \\\\\n0 & 1 & 0 \\\\\nr^{2}\\Omega & 0 & r^{2}\n\\end{pmatrix} = (1)(1) \\det \\begin{pmatrix}\n-1 + r^{2}\\Omega^{2} & r^{2}\\Omega \\\\\nr^{2}\\Omega & r^{2}\n\\end{pmatrix}$$\n$$g = (-1 + r^{2}\\Omega^{2})(r^{2}) - (r^{2}\\Omega)(r^{2}\\Omega) = -r^{2} + r^{4}\\Omega^{2} - r^{4}\\Omega^{2} = -r^{2}$$\nThus, the left-hand side of the identity is:\n$$\\sqrt{-g} = \\sqrt{-(-r^{2})} = \\sqrt{r^{2}}$$\nSince we are given $r\\ge 0$, we have $\\sqrt{r^{2}} = r$. So, $\\sqrt{-g}=r$.\nNext, we compute the right-hand side, $N\\sqrt{\\gamma}$. The determinant $\\gamma$ of the spatial metric $\\gamma_{ij}$ is:\n$$\\gamma = \\det(\\gamma_{ij}) = \\det \\begin{pmatrix}\n1 & 0 & 0 \\\\\n0 & r^{2} & 0 \\\\\n0 & 0 & 1\n\\end{pmatrix} = (1)(r^{2})(1) = r^{2}$$\nThen $\\sqrt{\\gamma} = \\sqrt{r^2} = r$.\nWith $N=1$, the right-hand side is:\n$$N\\sqrt{\\gamma} = 1 \\cdot r = r$$\nSince both sides equal $r$, the identity $\\sqrt{-g}=N\\sqrt{\\gamma}$ is verified.\n\nThe final answer requires the quantities in the order $(N,\\beta^{r},\\beta^{\\phi},\\beta^{z},\\gamma_{rr},\\gamma_{\\phi\\phi},\\gamma_{zz})$.\nThese are $(1, 0, \\Omega, 0, 1, r^2, 1)$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1 & 0 & \\Omega & 0 & 1 & r^{2} & 1\n\\end{pmatrix}\n}\n$$", "id": "3463445"}, {"introduction": "After mastering the identification of ADM variables, the next logical step is to use the framework to construct a physical spacetime from scratch. This practice moves from analysis to synthesis, focusing on the constraint equations that must be satisfied by any valid \"slice\" of spacetime. You will tackle the Hamiltonian constraint for a highly symmetric case representing a single, non-spinning black hole, a configuration known as a \"puncture\" in numerical relativity [@problem_id:3463410]. This exercise bridges the gap between abstract theory and application by demonstrating how solving a deceptively simple elliptic equation—the constraint—allows one to build the initial data for one of the most important objects in the universe.", "problem": "Consider the vacuum constraint equations of General Relativity on a spatial hypersurface under the Arnowitt–Deser–Misner (ADM) $3+1$ decomposition. Assume a conformally flat $3$-metric $\\gamma_{ij} = \\psi^{4} \\delta_{ij}$, maximal slicing $K = 0$, and a single, isolated, nonspinning puncture with no linear momentum. In this time-symmetric data, the trace-free part of the extrinsic curvature vanishes, so the momentum constraints are trivially satisfied and the Hamiltonian constraint reduces to a condition on the conformal factor $\\psi$.\n\nUse the well-tested fact that under a conformal rescaling $\\gamma_{ij} = \\psi^{4} \\delta_{ij}$, the scalar curvature transforms as $R[\\gamma] = - 8 \\psi^{-5} \\nabla^{2} \\psi$, where $\\nabla^{2}$ is the flat-space Laplacian associated with $\\delta_{ij}$. Impose asymptotic flatness $\\psi \\to 1$ as $r \\to \\infty$. Adopt the puncture ansatz\n$$\n\\psi(r) = 1 + \\frac{m}{2 r} + u(r),\n$$\nwhere $m$ is a positive constant interpreted as a bare mass parameter, $r$ is the flat-space radial coordinate, and $u(r)$ is a function that is everywhere regular on $\\mathbb{R}^{3}$ and satisfies $u(r) \\to 0$ as $r \\to \\infty$.\n\n(a) Starting from the vacuum Hamiltonian constraint and the conformal transformation law for $R[\\gamma]$, determine the equation satisfied by $u(r)$ for $r > 0$ and solve it subject to the stated regularity and boundary conditions.\n\n(b) Using the standard surface-integral definition of the Arnowitt–Deser–Misner (ADM) mass in conformally flat coordinates,\n$$\nM_{\\mathrm{ADM}} = - \\frac{1}{2 \\pi} \\lim_{r \\to \\infty} \\oint_{S_{r}} \\partial_{i} \\psi \\, dS^{i},\n$$\ncompute $M_{\\mathrm{ADM}}$ for the solution found in part (a) as an analytic expression, and state its relation to the bare mass parameter $m$.\n\nWork in geometric units with $G = c = 1$, and express the final mass in these units. The final answer must be a single closed-form analytic expression.", "solution": "The problem statement is scrutinized for validity.\n\n### Step 1: Extract Givens\n- **Framework**: Vacuum constraint equations of General Relativity, ADM $3+1$ decomposition.\n- **Metric ansatz**: Conformally flat $3$-metric, $\\gamma_{ij} = \\psi^{4} \\delta_{ij}$.\n- **Slicing condition**: Maximal slicing, $K = 0$.\n- **Initial data type**: Time-symmetric, implying the trace-free extrinsic curvature vanishes ($\\tilde{A}_{ij} = 0$). This also implies the full extrinsic curvature vanishes, $K_{ij}=0$, since $K_{ij} = \\tilde{A}_{ij} + \\frac{1}{3}\\gamma_{ij}K$.\n- **Source**: Single, isolated, nonspinning puncture with no linear momentum.\n- **Conformal transformation law**: The scalar curvature $R[\\gamma]$ of the physical metric $\\gamma_{ij}$ relates to the flat-space Laplacian $\\nabla^2$ as $R[\\gamma] = -8 \\psi^{-5} \\nabla^{2} \\psi$.\n- **Boundary condition**: Asymptotic flatness, $\\psi \\to 1$ as $r \\to \\infty$.\n- **Puncture ansatz**: $\\psi(r) = 1 + \\frac{m}{2r} + u(r)$, where $m > 0$ is a constant, $r$ is the flat-space radial coordinate.\n- **Regularity condition**: $u(r)$ is a function that is regular everywhere on $\\mathbb{R}^{3}$.\n- **Boundary condition for $u$**: $u(r) \\to 0$ as $r \\to \\infty$.\n- **Definition of ADM mass**: $M_{\\mathrm{ADM}} = - \\frac{1}{2 \\pi} \\lim_{r \\to \\infty} \\oint_{S_{r}} \\partial_{i} \\psi \\, dS^{i}$.\n- **Units**: Geometric units, $G = c = 1$.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded**: The problem is firmly rooted in the standard mathematical formalism of general relativity, specifically the ADM $3+1$ decomposition and the conformal method for solving the initial value problem (the Lichnerowicz-York equations). The setup corresponds to the construction of initial data for a single, non-spinning black hole (a Schwarzschild black hole). The equations and definitions are standard in the field of numerical relativity.\n- **Well-Posed**: The problem is well-posed. It provides all the necessary equations, boundary conditions, and regularity conditions to find a unique solution for $u(r)$ and subsequently calculate the ADM mass.\n- **Objective**: The problem is stated in precise, unbiased, and formal language, using standard terminology from physics and mathematics. There is no ambiguity or subjectivity.\n- **Conclusion**: The problem is valid. It is a standard, non-trivial problem in theoretical physics that tests an understanding of the ADM formalism and initial data construction.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete solution will be provided.\n\n### (a) Equation and Solution for $u(r)$\n\nThe initial value problem in general relativity requires satisfying the Hamiltonian and momentum constraint equations on a spatial hypersurface. In vacuum, these are:\n$$\nR + K^2 - K_{ij}K^{ij} = 0 \\quad (\\text{Hamiltonian constraint})\n$$\n$$\nD_j K^{ij} - D^i K = 0 \\quad (\\text{Momentum constraint})\n$$\nwhere $R$ is the Ricci scalar of the $3$-metric $\\gamma_{ij}$, $K_{ij}$ is the extrinsic curvature, $K = \\gamma^{ij}K_{ij}$ is its trace, and $D_i$ is the covariant derivative compatible with $\\gamma_{ij}$.\n\nThe problem specifies maximal slicing ($K=0$) and time-symmetric data. Time-symmetry for a non-spinning puncture implies that the extrinsic curvature vanishes identically, $K_{ij} = 0$. In this case, the momentum constraint is trivially satisfied ($0=0$), and the Hamiltonian constraint simplifies to:\n$$\nR = 0\n$$\nThe problem provides the transformation law for the scalar curvature under the conformal transformation $\\gamma_{ij} = \\psi^{4} \\delta_{ij}$:\n$$\nR[\\gamma] = -8 \\psi^{-5} \\nabla^{2} \\psi\n$$\nwhere $\\nabla^2$ is the standard flat-space Laplacian associated with the metric $\\delta_{ij}$. Substituting this into the simplified Hamiltonian constraint gives:\n$$\n-8 \\psi^{-5} \\nabla^{2} \\psi = 0\n$$\nThe conformal factor $\\psi$ approaches $1$ at infinity, and the term $\\frac{m}{2r}$ ensures it is non-zero almost everywhere. Therefore, for the equation to hold, we must have:\n$$\n\\nabla^{2} \\psi = 0\n$$\nThis is the Laplace equation for the conformal factor $\\psi$ in flat space. The problem states that this holds for $r > 0$, which is appropriate as the physical setup contains a puncture at the origin $r=0$.\n\nNow, we substitute the provided ansatz for $\\psi(r)$:\n$$\n\\psi(r) = 1 + \\frac{m}{2r} + u(r)\n$$\nApplying the Laplacian operator:\n$$\n\\nabla^2 \\left( 1 + \\frac{m}{2r} + u(r) \\right) = 0\n$$\nBy linearity of the Laplacian operator:\n$$\n\\nabla^2(1) + \\nabla^2\\left(\\frac{m}{2r}\\right) + \\nabla^2 u(r) = 0\n$$\nThe Laplacian of a constant is zero, so $\\nabla^2(1) = 0$. For the second term, we recall that the function $1/r$ is the fundamental solution of the Laplace equation in three dimensions, meaning $\\nabla^2(1/r) = -4\\pi\\delta^{(3)}(\\mathbf{r})$, where $\\delta^{(3)}(\\mathbf{r})$ is the Dirac delta function centered at the origin. For any $r>0$, we are away from the support of the delta function, so $\\nabla^2(1/r) = 0$. Consequently, $\\nabla^2\\left(\\frac{m}{2r}\\right) = \\frac{m}{2}\\nabla^2\\left(\\frac{1}{r}\\right) = 0$ for $r>0$.\n\nThus, the equation for $u(r)$ for $r>0$ reduces to:\n$$\n\\nabla^2 u(r) = 0\n$$\nWe must solve this equation subject to the given conditions. Since the full problem is spherically symmetric, we assume $u$ is a function of the radial coordinate $r$ only, $u=u(r)$. The general spherically symmetric solution to the Laplace equation in three dimensions is:\n$$\nu(r) = A + \\frac{B}{r}\n$$\nwhere $A$ and $B$ are constants. We apply the two conditions on $u(r)$:\n1.  Asymptotic behavior: $u(r) \\to 0$ as $r \\to \\infty$. Applying this limit to the general solution gives $A = 0$. The solution must therefore be of the form $u(r) = B/r$.\n2.  Regularity: $u(r)$ must be regular on all of $\\mathbb{R}^3$, which includes the origin at $r=0$. A function of the form $B/r$ is singular at $r=0$ unless $B=0$. Therefore, for $u(r)$ to be regular everywhere, we must have $B=0$.\n\nBoth conditions together uniquely determine that $u(r)=0$ for all $r$.\n\nThe equation satisfied by $u(r)$ is $\\nabla^2 u(r) = 0$, and its solution under the given conditions is $u(r) = 0$.\n\n### (b) Calculation of the ADM Mass\n\nWith the solution from part (a), the conformal factor is:\n$$\n\\psi(r) = 1 + \\frac{m}{2r}\n$$\nThe ADM mass is given by the surface integral at infinity:\n$$\nM_{\\mathrm{ADM}} = - \\frac{1}{2 \\pi} \\lim_{r \\to \\infty} \\oint_{S_{r}} \\partial_{i} \\psi \\, dS^{i}\n$$\nHere, $S_r$ is a sphere of radius $r$, and $dS^i$ is the outward-oriented surface element vector. We first compute the gradient of $\\psi$, $\\partial_i \\psi$. Since $\\psi$ depends only on $r = \\sqrt{x^k x_k}$, we use the chain rule:\n$$\n\\partial_i \\psi = \\frac{d\\psi}{dr} \\frac{\\partial r}{\\partial x^i}\n$$\nThe derivative with respect to $r$ is:\n$$\n\\frac{d\\psi}{dr} = \\frac{d}{dr}\\left(1 + \\frac{m}{2r}\\right) = -\\frac{m}{2r^2}\n$$\nThe partial derivative of $r$ is:\n$$\n\\frac{\\partial r}{\\partial x^i} = \\frac{\\partial}{\\partial x^i} \\sqrt{x^k x_k} = \\frac{1}{2\\sqrt{x^k x_k}} (2x_i) = \\frac{x_i}{r}\n$$\nCombining these, the gradient is:\n$$\n\\partial_i \\psi = -\\frac{m}{2r^2} \\frac{x_i}{r}\n$$\nThe surface element vector is $dS^i = n^i dS$, where $n^i = x^i/r$ is the outward unit normal vector to the sphere and $dS$ is the scalar area element.\nNow we can compute the integrand of the surface integral (summation over repeated index $i$ is implied):\n$$\n\\partial_i \\psi \\, dS^i = \\left(-\\frac{m}{2r^2} \\frac{x_i}{r}\\right) \\left(\\frac{x^i}{r} dS\\right) = -\\frac{m}{2r^2} \\frac{x_i x^i}{r^2} dS\n$$\nSince $x_i x^i = r^2$, the integrand simplifies to:\n$$\n\\partial_i \\psi \\, dS^i = -\\frac{m}{2r^2} \\frac{r^2}{r^2} dS = -\\frac{m}{2r^2} dS\n$$\nNow we evaluate the integral over the sphere $S_r$:\n$$\n\\oint_{S_r} \\partial_i \\psi \\, dS^i = \\oint_{S_r} \\left(-\\frac{m}{2r^2}\\right) dS\n$$\nThe term $-\\frac{m}{2r^2}$ is constant over the sphere of radius $r$, so it can be taken out of the integral:\n$$\n-\\frac{m}{2r^2} \\oint_{S_r} dS = -\\frac{m}{2r^2} (\\text{Area of } S_r) = -\\frac{m}{2r^2} (4\\pi r^2) = -2\\pi m\n$$\nFinally, we substitute this result back into the formula for the ADM mass:\n$$\nM_{\\mathrm{ADM}} = - \\frac{1}{2 \\pi} \\lim_{r \\to \\infty} (-2\\pi m)\n$$\nSince the expression $-2\\pi m$ is independent of $r$, the limit is trivial:\n$$\nM_{\\mathrm{ADM}} = - \\frac{1}{2 \\pi} (-2\\pi m) = m\n$$\nThe ADM mass $M_{\\mathrm{ADM}}$ is exactly equal to the bare mass parameter $m$. This result is expected, as this construction corresponds to the spatial metric of a Schwarzschild black hole of mass $m$ in isotropic coordinates.", "answer": "$$\n\\boxed{m}\n$$", "id": "3463410"}, {"introduction": "Constructing valid initial data is only half the battle; evolving it stably through time is the central challenge of numerical relativity. This computational exercise explores the dynamical properties of the ADM evolution equations and reveals a critical weakness that spurred the development of modern formulations. By numerically simulating the propagation of small errors, or \"constraint violations,\" you will directly observe the difference between the \"weakly hyperbolic\" nature of the original ADM system and the robust stability of the \"strongly hyperbolic\" BSSN formulation [@problem_id:3463393]. This hands-on investigation provides a deep, practical insight into why the mathematical structure of the evolution equations is paramount for performing long-term, accurate simulations of phenomena like black hole mergers.", "problem": "You are asked to design and implement a numerical demonstration, from first principles, that distinguishes weak hyperbolicity in the Arnowitt–Deser–Misner (ADM) formulation from strong hyperbolicity in the Baumgarte–Shapiro–Shibata–Nakamura (BSSN) formulation by measuring the growth of small constraint-violating perturbations in a frozen-coefficient, one-dimensional, plane-wave reduction of the constraint propagation subsystem.\n\nBegin from the fundamental $3+1$ decomposition of the Einstein field equations, in which the spatial metric is denoted by $\\gamma_{ij}$ and the extrinsic curvature by $K_{ij}$. The Hamiltonian constraint $H$ and the momentum constraint $M_i$ vanish on exact solutions. Define $H$ and $M_i$ and recall that, when linearized about Minkowski spacetime and restricted to the principal part (highest spatial derivative terms), the constraint propagation equations are obtained by combining the contracted Bianchi identities with the evolution equations for $\\gamma_{ij}$ and $K_{ij}$ under a fixed gauge. In a frozen-coefficient approximation about a homogeneous background and under a one-dimensional plane-wave ansatz with wavenumber $k$, the principal symbol reduces the partial differential equations to constant-coefficient linear ordinary differential equations for the Fourier amplitudes of the constraints.\n\nYour tasks are:\n- Derive, at the level of the principal symbol, the minimal two-dimensional mode systems that consistently represent the propagation of the scalar Hamiltonian and longitudinal momentum constraints for the bare Arnowitt–Deser–Misner (ADM) formulation and for the Baumgarte–Shapiro–Shibata–Nakamura (BSSN) formulation, under a one-dimensional plane-wave ansatz with wavenumber $k$. Base your derivation on the $3+1$ decomposition definitions and the frozen-coefficient, plane-wave reduction. Do not assume any particular form beyond what follows from these fundamental steps.\n- Using your derived modal systems, implement an exact-in-time integrator to generate time series of the constraint amplitude for small initial data. For each time series, compute two growth diagnostics:\n  - A best-fit linear growth rate obtained by least-squares fitting the amplitude $A(t)$ to $a + b t$ over sampled times $t \\in [0,T]$, returning the slope $b$.\n  - A best-fit exponential growth rate obtained by least-squares fitting $\\ln A(t)$ to $\\alpha + \\gamma t$ over the same time interval, returning the slope $\\gamma$.\n- Compare the measured growth diagnostics to the theoretical predictions implied by the principal symbol analysis: for a weakly hyperbolic system with a defective principal symbol, polynomial-in-time growth but no exponential growth is expected; for a strongly hyperbolic system with a diagonalizable principal symbol and purely imaginary characteristic speeds, bounded oscillations with zero exponential growth are expected. Use these expectations to define pass/fail criteria for each test case below.\n\nWork in geometric units so that all quantities are nondimensional. All angles are to be interpreted in radians. Your program must output booleans, so no physical units need to be printed.\n\nTest suite specification:\n- Use the following parameterized test cases, each defined by a tuple consisting of the formulation label, the wavenumber $k$, the pair of initial modal amplitudes, the final time $T$, and the number of uniformly spaced samples $N$ between $t=0$ and $t=T$ (inclusive). For the formulation label, use the literal strings \"ADM\" and \"BSSN\". For \"ADM\", the initial pair corresponds to $(H(0),M(0))$. For \"BSSN\", the initial pair corresponds to $(C_1(0),C_2(0))$ for your chosen two-component constraint mode.\n  - Case $1$: \"ADM\", $k = 1$, $(H(0),M(0)) = (10^{-6},0)$, $T = 10^{3}$, $N = 2001$.\n  - Case $2$: \"ADM\", $k = 10$, $(H(0),M(0)) = (2\\cdot 10^{-6},10^{-7})$, $T = 10^{3}$, $N = 2001$.\n  - Case $3$: \"BSSN\", $k = 1$, $(C_1(0),C_2(0)) = (10^{-6},2\\cdot 10^{-6})$, $T = 10^{3}$, $N = 2001$.\n  - Case $4$: \"BSSN\", $k = 0$, $(C_1(0),C_2(0)) = (10^{-6},2\\cdot 10^{-6})$, $T = 10^{3}$, $N = 2001$.\n\nEvaluation criteria to convert diagnostics into booleans:\n- For \"ADM\" cases, declare success if the measured best-fit linear slope $b$ agrees with the prediction implied by your principal symbol within a relative tolerance $\\tau_{\\mathrm{rel}} = 5\\cdot 10^{-2}$, and the best-fit exponential growth rate $|\\gamma| \\le \\tau_{\\exp}$ with $\\tau_{\\exp} = 10^{-12}$.\n- For \"BSSN\" cases, declare success if the best-fit exponential growth rate satisfies $|\\gamma| \\le \\tau_{\\exp}$ with $\\tau_{\\exp} = 10^{-12}$, and the best-fit linear slope satisfies $|b| \\le \\tau_{\\mathrm{lin}}$ with $\\tau_{\\mathrm{lin}} = 10^{-12}$.\n\nYour program should produce a single line of output containing the results for the cases in the order listed above, as a comma-separated list of booleans with no spaces and enclosed in square brackets, for example, \"[True,False,True,True]\".", "solution": "The problem requires a first-principles derivation and numerical demonstration of the different hyperbolicity properties of the Arnowitt–Deser–Misner (ADM) and Baumgarte–Shapiro–Shibata–Nakamura (BSSN) formulations of Einstein's equations. This is achieved by analyzing the growth of constraint violations in a simplified one-dimensional, plane-wave context.\n\n### 1. Theoretical Framework: Constraint Propagation\n\nThe Einstein field equations in a $3+1$ decomposition result in a set of evolution equations for the spatial metric $\\gamma_{ij}$ and extrinsic curvature $K_{ij}$, alongside a set of constraints that must be satisfied at all times. These are the Hamiltonian constraint $H=0$ and the momentum constraints $M_i=0$. In vacuum, they are given by:\n$$ H = R + K^2 - K_{ij} K^{ij} = 0 $$\n$$ M_i = \\nabla_j (K^j_i - \\delta^j_i K) = 0 $$\nwhere $R$ is the spatial Ricci scalar, $K = \\gamma^{ij}K_{ij}$ is the trace of the extrinsic curvature, and $\\nabla_j$ is the covariant derivative compatible with $\\gamma_{ij}$.\n\nIf the evolution equations are satisfied, the time derivatives of the constraints are determined by the contracted Bianchi identities ($\\nabla_\\mu G^{\\mu\\nu}=0$). Analyzing the principal part (highest spatial derivative terms) of these constraint propagation equations reveals the character of the system. We perform a plane-wave analysis by assuming all fields have a spatial dependence of the form $e^{i k_l x^l}$, which transforms spatial derivatives $\\partial_j$ into algebraic multiplications by $i k_j$. We restrict our analysis to a single plane wave propagating along the $x$-axis, so $\\vec{k} = (k, 0, 0)$. We focus on the coupled system of the scalar Hamiltonian constraint $H$ and the longitudinal component of the momentum constraint, $M_L \\equiv M_x$.\n\n### 2. Arnowitt–Deser–Misner (ADM) Formulation\n\nIn the standard ADM formulation, the evolution equations for $\\gamma_{ij}$ and $K_{ij}$, when combined with the Bianchi identities, yield a constraint propagation system whose principal part is (linearized around Minkowski space in a simple gauge like harmonic or geodesic slicing):\n$$ \\partial_t \\hat{H} = 0 $$\n$$ \\partial_t \\hat{M}_i = -i k_i \\hat{H} $$\nHere, $\\hat{H}$ and $\\hat{M}_i$ are the Fourier amplitudes of the constraints. Considering the longitudinal mode $M_x$, the system for the state vector $C_{ADM}(t) = (\\hat{H}(t), \\hat{M}_x(t))^T$ is:\n$$ \\frac{d}{dt} \\begin{pmatrix} \\hat{H} \\\\ \\hat{M}_x \\end{pmatrix} = \\begin{pmatrix} 0 & 0 \\\\ -ik & 0 \\end{pmatrix} \\begin{pmatrix} \\hat{H} \\\\ \\hat{M}_x \\end{pmatrix} $$\nThe system matrix $P_{ADM} = \\begin{pmatrix} 0 & 0 \\\\ -ik & 0 \\end{pmatrix}$ has a repeated eigenvalue $\\lambda=0$. However, it has only one linearly independent eigenvector, $\\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$. This lack of a complete set of eigenvectors makes the matrix defective, which is the defining characteristic of a weakly hyperbolic system.\n\nThe solution to this system is found by calculating the matrix exponential $e^{P_{ADM}t} = I + P_{ADM}t$ (since $P_{ADM}^2=0$):\n$$ \\begin{pmatrix} \\hat{H}(t) \\\\ \\hat{M}_x(t) \\end{pmatrix} = \\begin{pmatrix} 1 & 0 \\\\ -ikt & 1 \\end{pmatrix} \\begin{pmatrix} \\hat{H}(0) \\\\ \\hat{M}_x(0) \\end{pmatrix} = \\begin{pmatrix} \\hat{H}(0) \\\\ \\hat{M}_x(0) - ikt\\hat{H}(0) \\end{pmatrix} $$\nAssuming real initial data $H_0 = \\hat{H}(0)$ and $M_0 = \\hat{M}_x(0)$, the squared L2-norm of the constraint vector (a measure of the total constraint violation amplitude) is:\n$$ A(t)^2 = |\\hat{H}(t)|^2 + |\\hat{M}_x(t)|^2 = H_0^2 + |M_0 - iktH_0|^2 = H_0^2 + M_0^2 + (kH_0t)^2 $$\nThe amplitude is $A(t) = \\sqrt{H_0^2 + M_0^2 + (kH_0t)^2}$. For large times $t$, this shows linear growth: $A(t) \\approx |kH_0|t$. This polynomial growth is a direct consequence of weak hyperbolicity. The theoretical linear growth rate is $b_{pred} = |kH_0|$, while the exponential growth rate is $\\gamma_{pred}=0$.\n\n### 3. Baumgarte–Shapiro–Shibata–Nakamura (BSSN) Formulation\n\nThe BSSN formulation introduces new variables and modifies the evolution equations by adding terms that depend on the constraints. These modifications, while vanishing on an exact solution, alter the propagation of off-shell constraint violations. A standard result for the principal part of the constraint propagation subsystem in BSSN-like formulations (including Z4c, which makes the structure manifest) is a symmetric, coupled system:\n$$ \\partial_t \\hat{H} = -ik_j \\hat{M}^j $$\n$$ \\partial_t \\hat{M}_i = -ik_i \\hat{H} $$\nFor our one-dimensional plane wave, this reduces to a two-dimensional system for the state vector $C_{BSSN}(t) = (\\hat{H}(t), \\hat{M}_x(t))^T$:\n$$ \\frac{d}{dt} \\begin{pmatrix} \\hat{H} \\\\ \\hat{M}_x \\end{pmatrix} = \\begin{pmatrix} 0 & -ik \\\\ -ik & 0 \\end{pmatrix} \\begin{pmatrix} \\hat{H} \\\\ \\hat{M}_x \\end{pmatrix} $$\nThe system matrix $P_{BSSN} = \\begin{pmatrix} 0 & -ik \\\\ -ik & 0 \\end{pmatrix}$ has distinct eigenvalues $\\lambda = \\pm ik$. Since it has a complete set of eigenvectors, it is diagonalizable. The purely imaginary eigenvalues signify a strongly hyperbolic system, whose solutions are purely oscillatory waves.\n\nWith initial conditions $C_1(0)$ and $C_2(0)$, the solution is:\n$$ \\begin{pmatrix} \\hat{H}(t) \\\\ \\hat{M}_x(t) \\end{pmatrix} = \\begin{pmatrix} \\cos(kt) & i\\sin(kt) \\\\ i\\sin(kt) & \\cos(kt) \\end{pmatrix} \\begin{pmatrix} C_1(0) \\\\ C_2(0) \\end{pmatrix} $$\nAssuming real initial data $C_{10} = \\hat{H}(0)$ and $C_{20} = \\hat{M}_x(0)$, the squared amplitude is:\n$$ A(t)^2 = |\\hat{H}(t)|^2 + |\\hat{M}_x(t)|^2_2 = |C_{10}\\cos(kt) + iC_{20}\\sin(kt)|^2 + |iC_{10}\\sin(kt) + C_{20}\\cos(kt)|^2 $$\n$$ A(t)^2 = (C_{10}^2\\cos^2(kt) + C_{20}^2\\sin^2(kt)) + (C_{10}^2\\sin^2(kt) + C_{20}^2\\cos^2(kt)) = C_{10}^2 + C_{20}^2 $$\nThe amplitude $A(t) = \\sqrt{C_{10}^2+C_{20}^2}$ is constant in time. This bounded behavior is the key feature of strongly hyperbolic systems. Consequently, the theoretical linear ($b$) and exponential ($\\gamma$) growth rates are both zero. For the special case $k=0$, the system matrix is zero, leading to constant amplitudes and again predicting $b=0$ and $\\gamma=0$.\n\n### 4. Numerical Diagnostics and Evaluation\n\nFor each test case, we generate the time series of the amplitude $A(t)$ using the exact analytical solutions derived above. We then compute two diagnostics via least-squares fitting:\n1.  Linear slope $b$: from a fit of $A(t)$ to $a+bt$.\n2.  Exponential rate $\\gamma$: from a fit of $\\ln A(t)$ to $\\alpha+\\gamma t$.\n\nThe success of each test is determined by comparing these measured diagnostics to the theoretical predictions, subject to specified tolerances. For ADM, we expect $b \\approx b_{pred}$ and $\\gamma \\approx 0$. For BSSN, we expect both $b \\approx 0$ and $\\gamma \\approx 0$.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the numerical demonstration for ADM and BSSN constraint propagation.\n    \"\"\"\n    # Test case format: (formulation, k, initial_conds, T, N)\n    test_cases = [\n        (\"ADM\", 1.0, (1e-6, 0.0), 1000.0, 2001),\n        (\"ADM\", 10.0, (2e-6, 1e-7), 1000.0, 2001),\n        (\"BSSN\", 1.0, (1e-6, 2e-6), 1000.0, 2001),\n        (\"BSSN\", 0.0, (1e-6, 2e-6), 1000.0, 2001),\n    ]\n\n    results = []\n    for case in test_cases:\n        formulation, k, initial_conds, T, N = case\n        t_samples = np.linspace(0, T, N)\n        \n        if formulation == \"ADM\":\n            H0, M0 = initial_conds\n            # Analytical solution for ADM constraint amplitude:\n            # A_adm(t) = sqrt(H0^2 + M0^2 + (k*H0*t)^2)\n            amplitudes = np.sqrt(H0**2 + M0**2 + (k * H0 * t_samples)**2)\n            \n            # Theoretical prediction for linear growth slope\n            b_pred = np.abs(k * H0)\n            \n            # --- Diagnostics ---\n            # Best-fit linear growth rate `b`\n            b, _ = np.polyfit(t_samples, amplitudes, 1)\n            \n            # Best-fit exponential growth rate `gamma`\n            # Add a small epsilon to avoid log(0), although not an issue with these inputs.\n            log_amplitudes = np.log(amplitudes + 1e-30)\n            gamma, _ = np.polyfit(t_samples, log_amplitudes, 1)\n            \n            # --- Evaluation ---\n            tol_rel = 5e-2\n            tol_exp = 1e-12\n            \n            # Check linear growth rate agreement\n            if np.abs(b_pred) < 1e-20: # If prediction is zero\n                linear_check = np.abs(b) < tol_rel # Use an absolute check\n            else:\n                rel_error_b = np.abs(b - b_pred) / np.abs(b_pred)\n                linear_check = rel_error_b <= tol_rel\n\n            # Check for lack of exponential growth\n            exp_check = np.abs(gamma) <= tol_exp\n            \n            results.append(linear_check and exp_check)\n\n        elif formulation == \"BSSN\":\n            C1_0, C2_0 = initial_conds\n            # Analytical solution for BSSN constraint amplitude is constant:\n            # A_bssn(t) = sqrt(C1_0^2 + C2_0^2)\n            const_amplitude = np.sqrt(C1_0**2 + C2_0**2)\n            amplitudes = np.full_like(t_samples, const_amplitude)\n            \n            # --- Diagnostics ---\n            # Best-fit linear growth rate `b`\n            b, _ = np.polyfit(t_samples, amplitudes, 1)\n            \n            # Best-fit exponential growth rate `gamma`\n            log_amplitudes = np.log(amplitudes + 1e-30)\n            gamma, _ = np.polyfit(t_samples, log_amplitudes, 1)\n            \n            # --- Evaluation ---\n            tol_exp = 1e-12\n            tol_lin = 1e-12\n            \n            # Check for lack of exponential and linear growth\n            exp_check = np.abs(gamma) <= tol_exp\n            linear_check = np.abs(b) <= tol_lin\n            \n            results.append(exp_check and linear_check)\n\n    # Format the final output as a comma-separated list of booleans\n    print(f\"[{','.join(map(str, results))}]\".replace(\"True\", \"True\").replace(\"False\", \"False\"))\n\n# Run the simulation\nif __name__ == \"__main__\":\n    solve()\n```", "id": "3463393"}]}