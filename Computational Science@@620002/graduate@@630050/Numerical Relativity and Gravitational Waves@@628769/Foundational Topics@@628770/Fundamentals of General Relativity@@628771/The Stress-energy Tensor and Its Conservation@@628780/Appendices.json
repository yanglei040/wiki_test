{"hands_on_practices": [{"introduction": "The foundation of any robust numerical hydrodynamics code lies in expressing the governing physical principles in a flux-conservative form. This practice guides you through the crucial process of recasting the abstract law of stress-energy conservation, $\\nabla_{\\mu} T^{\\mu \\nu} = 0$, into a concrete system of equations, $\\partial_{t} q + \\partial_{i} F^{i}(q) = 0$, defining the state vectors and fluxes that are evolved in simulations [@problem_id:3496047]. Mastering this derivation is a prerequisite for understanding and developing high-resolution shock-capturing schemes.", "problem": "Consider a perfect fluid in the context of Special Relativity (SR) written in a flat $3+1$ split with lapse $\\alpha = 1$, shift $\\beta^{i} = 0$, and spatial metric $\\gamma_{ij} = \\delta_{ij}$ in Cartesian coordinates. The stress-energy tensor is $T^{\\mu \\nu} = \\rho h u^{\\mu} u^{\\nu} + p \\eta^{\\mu \\nu}$, where $\\rho$ is the rest-mass density, $\\epsilon$ is the specific internal energy, $p$ is the pressure, $h$ is the specific enthalpy, $\\eta^{\\mu \\nu}$ is the Minkowski metric with signature $(-,+,+,+)$, and $u^{\\mu}$ is the fluid four-velocity. The ideal-gas equation of state is $p = (\\Gamma - 1) \\rho \\epsilon$, with constant adiabatic index $\\Gamma$, and units are chosen so that the speed of light is $c = 1$. Define the Eulerian three-velocity $v^{i}$ and the Lorentz factor $W = (1 - v^{2})^{-1/2}$, where $v^{2} = \\delta_{ij} v^{i} v^{j}$. \n\nStarting from the fundamental conservation laws $\\partial_{\\mu} T^{\\mu \\nu} = 0$ and $\\partial_{\\mu} (\\rho u^{\\mu}) = 0$ and the thermodynamic definition of specific enthalpy for a simple fluid, do the following:\n- Derive the specific enthalpy $h$ in terms of $\\rho$, $\\epsilon$, and $p$.\n- Construct a flux-conservative system $\\partial_{t} q + \\partial_{i} F^{i}(q) = 0$ suitable for high-resolution shock-capturing schemes by choosing the conservative variables $q = (D, S_{j}, \\tau)$, where $D$ is the conserved rest-mass density, $S_{j}$ is the conserved momentum density, and $\\tau$ is the conserved energy density excluding rest-mass. Express $D$, $S_{j}$, and $\\tau$ in terms of the primitive variables $(\\rho, v^{i}, \\epsilon, p)$ and $W$, and give the corresponding fluxes $F^{i}(D)$, $F^{i}(S_{j})$, and $F^{i}(\\tau)$ in flat spacetime.\n- Finally, using the ideal-gas equation of state, express $\\tau$ purely as a closed-form analytic function of $\\rho$, $\\epsilon$, $\\Gamma$, and $W$.\n\nYour final reported answer must be the single analytic expression for $\\tau$ requested in the last item. No numerical evaluation is required.", "solution": "The problem statement is a well-posed exercise in special relativistic hydrodynamics. It provides a complete and consistent set of definitions and equations, grounded in established physical principles. All terms are formally defined, and the task requests a sequence of derivations leading to a specific analytical expression. Therefore, the problem is valid, and a solution can be constructed.\n\nThe solution proceeds in three parts as requested by the problem statement. We are working in a flat spacetime with the Minkowski metric $\\eta_{\\mu\\nu}$ having signature $(-,+,+,+)$, and in Cartesian coordinates such that the metric components are $\\eta_{\\mu\\nu} = \\text{diag}(-1, 1, 1, 1)$. The speed of light is $c=1$.\n\nFirst, we derive the expression for the specific enthalpy $h$. The standard form of the stress-energy tensor for a perfect fluid is $T^{\\mu\\nu} = (\\mathcal{E} + p)u^\\mu u^\\nu + p g^{\\mu\\nu}$, where $\\mathcal{E}$ is the total energy density as measured in the fluid's rest frame, $p$ is the pressure, and $u^\\mu$ is the four-velocity. The rest-frame energy density $\\mathcal{E}$ is the sum of the rest-mass energy density, $\\rho c^2 = \\rho$, and the internal energy density, $\\rho\\epsilon$. Thus, $\\mathcal{E} = \\rho + \\rho\\epsilon$. The stress-energy tensor is then $T^{\\mu\\nu} = (\\rho + \\rho\\epsilon + p)u^\\mu u^\\nu + p \\eta^{\\mu\\nu}$. The problem provides the form $T^{\\mu\\nu} = \\rho h u^\\mu u^\\nu + p \\eta^{\\mu\\nu}$. By comparing these two equivalent expressions, we can identify the term $\\rho h$:\n$$\n\\rho h = \\rho + \\rho\\epsilon + p\n$$\nAssuming the rest-mass density $\\rho$ is non-zero, we can divide by it to obtain the relativistic specific enthalpy $h$:\n$$\nh = 1 + \\epsilon + \\frac{p}{\\rho}\n$$\nThis is the standard definition, which includes the rest-mass energy per unit mass (equal to $1$ since $c=1$), the specific internal energy $\\epsilon$, and a term $p/\\rho$ related to the work done by pressure.\n\nSecond, we construct the flux-conservative system $\\partial_{t} q + \\partial_{i} F^{i}(q) = 0$ for the conserved variables $q = (D, S_{j}, \\tau)$. The fluid four-velocity $u^\\mu$ is related to the three-velocity $v^i$ by $u^\\mu = (u^0, u^i) = (W, Wv^i)$, where $W = (1-v^2)^{-1/2}$ is the Lorentz factor and $v^2 = \\delta_{ij}v^i v^j$. This form satisfies the normalization condition $u_\\mu u^\\mu = \\eta_{\\mu\\nu}u^\\mu u^\\nu = -1$.\n\nThe conservation of rest mass is given by $\\partial_\\mu (\\rho u^\\mu) = 0$. In the specified $3+1$ split, this expands to:\n$$\n\\partial_t (\\rho u^0) + \\partial_i (\\rho u^i) = 0\n$$\nFrom this, we identify the conserved rest-mass density $D$ and its corresponding flux $F^i(D)$:\n$$\nD = \\rho u^0 = \\rho W\n$$\n$$\nF^i(D) = \\rho u^i = \\rho W v^i = D v^i\n$$\n\nThe conservation of momentum is embedded in the spatial components ($\\nu = j$) of the stress-energy tensor conservation law, $\\partial_\\mu T^{\\mu\\nu}=0$:\n$$\n\\partial_t T^{0j} + \\partial_i T^{ij} = 0\n$$\nThe conserved momentum density $S_j$ is defined as the temporal component of the momentum flux, so $S_j = T^{0j}$. The flux of $S_j$ is given by the spatial components, $F^i(S_j) = T^{ij}$. We compute these from the definition of $T^{\\mu\\nu}$:\n$$\nS_j = T^{0j} = \\rho h u^0 u^j + p \\eta^{0j} = \\rho h (W)(Wv_j) + p(0) = \\rho h W^2 v_j\n$$\n$$\nF^i(S_j) = T^{ij} = \\rho h u^i u^j + p \\eta^{ij} = \\rho h (Wv^i)(Wv_j) + p \\delta^{ij} = \\rho h W^2 v^i v_j + p \\delta^{ij}\n$$\nNote that for Cartesian coordinates, the covariant and contravariant components of spatial vectors are the same, $v_j=v^j$, and the Kronecker delta can be written with indices up or down, $\\delta^{ij} = \\delta_j^i$.\n\nThe conservation of energy is given by the time component ($\\nu = 0$) of $\\partial_\\mu T^{\\mu\\nu}=0$:\n$$\n\\partial_t T^{00} + \\partial_i T^{i0} = 0\n$$\nThe total energy density is $E = T^{00}$.\n$$\nE = T^{00} = \\rho h u^0 u^0 + p \\eta^{00} = \\rho h W^2 - p\n$$\nThe problem specifies the conserved variable $\\tau$ as the energy density excluding rest mass, defined as $\\tau = E - D$.\n$$\n\\tau = (\\rho h W^2 - p) - \\rho W\n$$\nTo find the flux of $\\tau$, we use the conservation laws for $E$ and $D$:\n$$\n\\partial_t E + \\partial_i T^{i0} = 0\n$$\n$$\n\\partial_t D + \\partial_i (\\rho W v^i) = 0\n$$\nSubtracting the second equation from the first yields the conservation law for $\\tau$:\n$$\n\\partial_t (E - D) + \\partial_i (T^{i0} - \\rho W v^i) = 0\n$$\nThus, $\\partial_t \\tau + \\partial_i F^i(\\tau) = 0$, where the flux $F^i(\\tau)$ is:\n$$\nF^i(\\tau) = T^{i0} - \\rho W v^i = (\\rho h u^i u^0) - (\\rho W) v^i = \\rho h W^2 v^i - \\rho W v^i = (\\rho h W^2 - \\rho W) v^i\n$$\nThe flux can also be expressed as $F^i(\\tau) = S^i - D v^i$.\n\nThird, we derive the final expression for $\\tau$ as a function of the primitive variables $\\rho$, $\\epsilon$, the adiabatic index $\\Gamma$, and the Lorentz factor $W$. We begin with the expression for $\\tau$ and substitute the derived relation for $h$:\n$$\n\\tau = \\rho h W^2 - p - \\rho W = \\rho \\left(1 + \\epsilon + \\frac{p}{\\rho}\\right) W^2 - p - \\rho W\n$$\n$$\n\\tau = (\\rho + \\rho\\epsilon + p) W^2 - p - \\rho W\n$$\nNow, we use the ideal-gas equation of state, $p = (\\Gamma - 1) \\rho \\epsilon$, to eliminate the pressure $p$:\n$$\n\\tau = (\\rho + \\rho\\epsilon + (\\Gamma-1)\\rho\\epsilon) W^2 - (\\Gamma-1)\\rho\\epsilon - \\rho W\n$$\nWe simplify the terms containing $\\epsilon$:\n$$\n\\rho\\epsilon + (\\Gamma-1)\\rho\\epsilon = \\rho\\epsilon(1 + \\Gamma - 1) = \\Gamma\\rho\\epsilon\n$$\nSubstituting this back into the expression for $\\tau$ gives the final closed-form analytic function:\n$$\n\\tau = (\\rho + \\Gamma\\rho\\epsilon) W^2 - (\\Gamma - 1)\\rho\\epsilon - \\rho W\n$$\nThis expression can be rearranged, for example, by grouping terms related to kinetic energy and internal energy:\n$$\n\\tau = \\rho W(W-1) + \\rho\\epsilon(\\Gamma W^2 - \\Gamma + 1)\n$$\nThe first term, $\\rho W(W-1)$, represents the kinetic energy density (since the total energy of a particle is $W m c^2$ and rest energy is $m c^2$, the kinetic energy is $(W-1)mc^2$). The second term represents the internal energy density and its coupling to the kinetic energy. The problem, however, only requests a single analytic expression, and the unfactored form is a direct result of the substitution.", "answer": "$$\n\\boxed{(\\rho + \\Gamma \\rho \\epsilon) W^2 - (\\Gamma - 1) \\rho \\epsilon - \\rho W}\n$$", "id": "3496047"}, {"introduction": "While numerical codes solve differential equations in smooth regions, astrophysical systems are rife with discontinuities like shock waves. This exercise moves from the differential form of conservation to its integral form, applying the Rankine-Hugoniot jump conditions to a classic relativistic shock-tube problem [@problem_id:3496097]. By solving for the post-shock state analytically, you develop the skills needed to analyze these critical phenomena and to create exact solutions for code verification.", "problem": "A one-dimensional planar shock-tube in flat spacetime is modeled with a perfect fluid in Special Relativity (SR), using units where the speed of light $c=1$. The stress-energy tensor is $T^{\\mu \\nu} = w u^{\\mu} u^{\\nu} + p g^{\\mu \\nu}$ with enthalpy density $w = \\rho h$, specific enthalpy $h = 1 + \\epsilon + p/\\rho$, four-velocity $u^{\\mu}$, rest-mass density $\\rho$, pressure $p$, and metric $g^{\\mu \\nu}$. The fluid obeys the relativistic ideal-gas equation of state (EOS) $p = (\\Gamma - 1) \\rho \\epsilon$ with adiabatic index $\\Gamma = 4/3$. The particle number current is $J^{\\mu} = \\rho u^{\\mu}$. Conservation across a discontinuity is enforced by the Rankine-Hugoniot conditions derived from $\\nabla_{\\mu} T^{\\mu \\nu} = 0$ and $\\nabla_{\\mu} J^{\\mu} = 0$.\n\nConsider the right-moving shock that forms from the initial Riemann problem. In the laboratory frame, the pre-shock (upstream) state ahead of this shock has $v_1 = 0$, $\\rho_1 = 1.0$, and $p_1 = 10^{-3}$. The shock propagates to the right with speed $s = 0.6$. Assume the post-shock (downstream) state is uniform immediately behind the shock. Using only the conservation of stress-energy and particle number across the shock (no additional empirical closure beyond the given EOS), determine the post-shock pressure $p_2$ immediately behind the shock.\n\nYou must explicitly use the shock-rest-frame flux equalities implied by conservation to determine $p_2$, and then verify that the mass-energy and momentum fluxes are equal on both sides of the shock with your computed downstream state. The required final answer is the single value of $p_2$. Round your final $p_2$ to four significant figures and express it in the same units as $p_1$.", "solution": "The user wants to find the post-shock pressure for a relativistic shock wave.\n\n### Step 1: Extract Givens\n-   Spacetime: 1D planar, flat (Minkowski metric $g^{\\mu\\nu} = \\eta^{\\mu\\nu} = \\text{diag}(-1, 1, 1, 1)$).\n-   Speed of light: $c=1$.\n-   Fluid: Perfect fluid.\n-   Stress-energy tensor: $T^{\\mu \\nu} = w\\, u^{\\mu} u^{\\nu} + p\\, g^{\\mu \\nu}$.\n-   Enthalpy density: $w = \\rho h$.\n-   Specific enthalpy: $h = 1 + \\epsilon + p/\\rho$.\n-   Equation of state (EOS): $p = (\\Gamma - 1)\\, \\rho \\epsilon$, with adiabatic index $\\Gamma = 4/3$.\n-   Particle number current: $J^{\\mu} = \\rho u^{\\mu}$.\n-   Conservation laws: $\\nabla_{\\mu} T^{\\mu \\nu} = 0$ and $\\nabla_{\\mu} J^{\\mu} = 0$.\n-   Pre-shock state (upstream, state 1) in laboratory frame: velocity $v_1 = 0$, rest-mass density $\\rho_1 = 1.0$, pressure $p_1 = 10^{-3}$.\n-   Shock speed in laboratory frame: $s = 0.6$.\n-   Post-shock state (downstream, state 2): Assumed uniform.\n-   Task: Determine the post-shock pressure $p_2$ using the Rankine-Hugoniot conditions.\n-   Final Answer: $p_2$ rounded to four significant figures.\n\n### Step 2: Validate Using Extracted Givens\n-   **Scientifically Grounded**: The problem is a standard exercise in relativistic fluid dynamics. All equations and concepts (stress-energy tensor, relativistic ideal gas EOS, Rankine-Hugoniot conditions) are cornerstones of the field. The setup is physically realistic and well-established.\n-   **Well-Posed**: The problem provides all necessary initial conditions and physical laws (EOS) to determine the post-shock state uniquely. The three Rankine-Hugoniot jump conditions, combined with the EOS, provide a solvable system for the downstream fluid variables.\n-   **Objective**: The problem is stated in precise, quantitative terms, free of any subjective or ambiguous language.\n-   **Verdict**: The problem is valid.\n\n### Step 3: Proceed with Solution\n\nThe problem is best solved in the rest frame of the shock. In the laboratory frame, the shock moves to the right with speed $s=0.6$, and the pre-shock fluid is at rest ($v_1=0$). To move to the shock-rest-frame (SRF), we apply a Lorentz boost with velocity $-s$. The velocity of the pre-shock fluid in the SRF, denoted by $u_1$, is given by the relativistic velocity addition formula:\n$$\nu_1 = \\frac{v_1 - s}{1 - v_1 s} = \\frac{0 - 0.6}{1 - 0 \\times 0.6} = -0.6\n$$\nThe negative sign indicates the fluid is moving in the $-x$ direction, flowing into the stationary shock front. The fluid must cross the shock, so the post-shock fluid velocity, $u_2$, must also be negative, and for a compressive shock, we expect its speed to be reduced, i.e., $|u_2| < |u_1|$.\n\nThe Rankine-Hugoniot conditions are the flux conservation equations across the shock front. For a 1D flow along the x-axis in the SRF, these are:\n1.  Conservation of particle number flux: $[J^x] = 0 \\implies [\\rho \\gamma u] = 0$\n2.  Conservation of energy flux: $[T^{tx}] = 0 \\implies [w \\gamma^2 u] = 0$\n3.  Conservation of momentum flux: $[T^{xx}] = 0 \\implies [w (\\gamma u)^2 + p] = 0$\n\nHere, $u$ is the fluid's 3-velocity in the SRF, $\\gamma = 1/\\sqrt{1-u^2}$ is the Lorentz factor, and $[Q] \\equiv Q_2 - Q_1$ denotes the jump of quantity $Q$ across the shock.\n\nLet's define the conserved fluxes, which are determined by the known upstream state (state 1):\nThe particle number flux: $j \\equiv \\rho_1 \\gamma_1 u_1 = \\rho_2 \\gamma_2 u_2$\nThe energy-momentum tensor fluxes can be simplified. From $[w \\gamma^2 u] = 0$ and $w = \\rho h$, we have $[\\rho h \\gamma^2 u] = [h \\gamma (\\rho \\gamma u)] = [h \\gamma j] = 0$. Since $j \\neq 0$, this implies:\n$$H \\equiv h_1 \\gamma_1 = h_2 \\gamma_2$$\nThis is the conserved specific enthalpy flux per particle.\nFrom the momentum flux conservation, we have:\n$$P \\equiv w_1 (\\gamma_1 u_1)^2 + p_1 = w_2 (\\gamma_2 u_2)^2 + p_2$$\nThis can be rewritten using $w=\\rho h$ and $j=\\rho \\gamma u$:\n$P = h_1 \\rho_1 \\gamma_1 u_1 (\\gamma_1 u_1) + p_1 = h_1 \\gamma_1 j u_1 + p_1 = j H u_1 + p_1$.\nThus, for the downstream side: $P = j H u_2 + p_2$.\nThis gives a useful relation:\n$$p_2 - p_1 = jH(u_1 - u_2) \\implies u_2 = u_1 - \\frac{p_2 - p_1}{jH}$$\n\nWe need to first calculate the upstream fluid properties and the conserved fluxes.\n-   Given: $\\rho_1 = 1.0$, $p_1 = 10^{-3}$, $\\Gamma = 4/3$.\n-   Upstream velocity in SRF: $u_1 = -0.6$.\n-   Upstream Lorentz factor: $\\gamma_1 = 1/\\sqrt{1 - (-0.6)^2} = 1/\\sqrt{0.64} = 1/0.8 = 1.25$.\n-   Upstream specific enthalpy: $h = 1 + \\frac{\\Gamma}{\\Gamma-1}\\frac{p}{\\rho}$.\n    $h_1 = 1 + \\frac{4/3}{4/3 - 1} \\frac{10^{-3}}{1.0} = 1 + 4 \\times 10^{-3} = 1.004$.\n-   Conserved particle flux: $j = \\rho_1 \\gamma_1 u_1 = 1.0 \\times 1.25 \\times (-0.6) = -0.75$.\n-   Conserved specific enthalpy flux: $H = h_1 \\gamma_1 = 1.004 \\times 1.25 = 1.255$.\n-   Product $jH = (-0.75) \\times 1.255 = -0.94125$.\n\nNow we have a system of equations for the downstream state ($p_2, \\rho_2, h_2, u_2, \\gamma_2$):\n(a) $u_2 = u_1 - \\frac{p_2 - p_1}{jH} = -0.6 - \\frac{p_2 - 0.001}{-0.94125} = -0.6 + \\frac{p_2 - 0.001}{0.94125}$.\n(b) $\\gamma_2 = 1/\\sqrt{1 - u_2^2}$.\n(c) $h_2 = H/\\gamma_2 = 1.255/\\gamma_2$.\n(d) $\\rho_2 = j/(\\gamma_2 u_2) = -0.75/(\\gamma_2 u_2)$.\n(e) $h_2 = 1 + \\frac{\\Gamma}{\\Gamma-1}\\frac{p_2}{\\rho_2} = 1 + 4 \\frac{p_2}{\\rho_2}$.\n\nThis system can be reduced to a single-variable, transcendental equation for $p_2$. We can then solve it numerically. From (e), we can express $p_2$ in terms of the other downstream variables:\n$$p_2 = \\frac{1}{4} \\rho_2 (h_2-1)$$\nThis suggests an iterative solution. We can guess a value for $p_2$, calculate $u_2, \\gamma_2, h_2, \\rho_2$ using equations (a)-(d), and then compute a new value for $p_2$ using the expression above. A solution is found when the guessed $p_2$ equals the computed $p_2$.\nLet $g(p_2) = \\frac{1}{4} \\rho_2(p_2) (h_2(p_2)-1)$. We are looking for a fixed point $p_2 = g(p_2)$.\n\nWe perform a bisection search for the root of $f(p_2) = g(p_2) - p_2 = 0$. For a shock, $p_2 > p_1$. The downstream velocity $u_2$ must be negative for the fluid to cross the shock, which implies an upper bound on $p_2 < jHu_1+p_1 = P \\approx 0.56575$.\n\nLet's test an initial guess, $p_2 = 0.4$:\n1. $u_2 = -0.6 + (0.4 - 0.001)/0.94125 = -0.17612$.\n2. $\\gamma_2 = 1/\\sqrt{1 - (-0.17612)^2} = 1.01588$.\n3. $h_2 = 1.255 / 1.01588 = 1.23538$.\n4. $\\rho_2 = -0.75 / (1.01588 \\times -0.17612) = 4.1923$.\n5. $g(0.4) = \\frac{1}{4} \\times 4.1923 \\times (1.23538 - 1) = 0.2467$.\n$f(0.4) = 0.2467 - 0.4 = -0.1533$.\n\nLet's test another guess, $p_2 = 0.5$:\n1. $u_2 = -0.6 + (0.5 - 0.001)/0.94125 = -0.069854$.\n2. $\\gamma_2 = 1/\\sqrt{1 - (-0.069854)^2} = 1.002449$.\n3. $h_2 = 1.255 / 1.002449 = 1.25191$.\n4. $\\rho_2 = -0.75 / (1.002449 \\times -0.069854) = 10.712$.\n5. $g(0.5) = \\frac{1}{4} \\times 10.712 \\times (1.25191 - 1) = 0.6745$.\n$f(0.5) = 0.6745 - 0.5 = 0.1745$.\n\nSince $f(0.4) < 0$ and $f(0.5) > 0$, a root exists in $(0.4, 0.5)$. We continue with bisection or a more advanced root-finding method.\nLet's try $p_2=0.4734$:\n1. $u_2 = -0.6 + (0.4734 - 0.001)/0.94125 = -0.6 + 0.4724/0.94125 = -0.098113$.\n2. $\\gamma_2 = 1/\\sqrt{1 - (-0.098113)^2} = 1.004838$.\n3. $h_2 = 1.255 / 1.004838 = 1.249$.\n4. $\\rho_2 = -0.75 / (1.004838 \\times -0.098113) = 7.608$.\n5. $g(0.4734) = \\frac{1}{4} \\times 7.608 \\times (1.249 - 1) = 1.902 \\times 0.249 = 0.4736$.\n$f(0.4734) = 0.4736 - 0.4734 = +0.0002$.\nThis is very close to zero. The solution is approximately $p_2 \\approx 0.4734$.\n\nTo fulfill the verification requirement, let's explicitly calculate the fluxes for the upstream and downstream states.\nUpstream (State 1):\n$p_1=0.001, \\rho_1=1.0, u_1=-0.6, \\gamma_1=1.25, h_1=1.004, w_1=1.004$.\n- Particle flux: $J^x_1 = \\rho_1 \\gamma_1 u_1 = -0.75$.\n- Energy flux: $T^{tx}_1 = w_1 \\gamma_1^2 u_1 = 1.004 \\times (1.25)^2 \\times (-0.6) = -0.94125$.\n- Momentum flux: $T^{xx}_1 = w_1 (\\gamma_1 u_1)^2 + p_1 = 1.004_1 (-0.75)^2 + 0.001 = 0.56575$.\n\nDownstream (State 2) with $p_2=0.4734$:\n$p_2=0.4734, \\rho_2=7.608, u_2=-0.09811, \\gamma_2=1.0048, h_2=1.249, w_2=\\rho_2 h_2=9.502$.\n- Particle flux: $J^x_2 = \\rho_2 \\gamma_2 u_2 = 7.608 \\times 1.0048 \\times (-0.09811) = -0.7500$.\n- Energy flux: $T^{tx}_2 = w_2 \\gamma_2^2 u_2 = 9.502 \\times (1.0048)^2 \\times (-0.09811) = -0.9414$.\n- Momentum flux: $T^{xx}_2 = w_2 (\\gamma_2 u_2)^2 + p_2 = 9.502 \\times (1.0048 \\times -0.09811)^2 + 0.4734 = 9.502 \\times (-0.09858)^2 + 0.4734 = 0.09228 + 0.4734 = 0.5657$.\n\nThe conserved fluxes match to the precision of the calculation, confirming the validity of the solution. The post-shock pressure, rounded to four significant figures, is $0.4734$.", "answer": "$$\n\\boxed{0.4734}\n$$", "id": "3496097"}, {"introduction": "A central challenge in computational physics is that properties holding exactly in the continuum, such as conservation laws, can be violated by numerical discretization error. This hands-on coding practice delves into the design of \"mimetic\" finite-difference schemes, which are constructed to preserve fundamental mathematical identities at the discrete level [@problem_id:3496084]. By implementing and comparing a mimetic scheme against a standard one, you will gain direct insight into how the choice of discretization profoundly impacts the accuracy and physical fidelity of a simulation.", "problem": "Consider conservation of the stress-energy tensor in General Relativity (GR), expressed as the vanishing covariant divergence $\\nabla_{\\mu} T^{\\mu\\nu} = 0$. Work in a time-independent, conformally flat 2-dimensional spatial slice with coordinates $x$ and $y$, periodic on the domain $[0,2\\pi) \\times [0,2\\pi)$, and with metric $g_{ij}(x,y) = a(x,y)^2 \\delta_{ij}$, where $a(x,y) = 1 + \\epsilon \\cos(k_x x)\\cos(k_y y)$ for a small amplitude $\\epsilon$ and integer wavenumbers $k_x$ and $k_y$. Assume $g_{0i} = 0$ and no explicit time dependence. Denote the spatial metric determinant by $g$ so that $\\sqrt{g} = a^2$ for this 2-dimensional metric. All angles are in radians.\n\nYour goal is to design and implement a discrete mimetic finite difference scheme that approximates $\\nabla_{\\mu} T^{\\mu\\nu}$ for the case $\\nu = 0$ in such a way that the connection terms cancel at the discrete level in the weak-field limit. You will compare its conservation error against a standard finite difference scheme that directly discretizes the covariant divergence formula in terms of partial derivatives and Christoffel symbols.\n\nUse the following fundamental bases and facts only, without introducing any untested or ad hoc formulas:\n- The covariant divergence of a contravariant rank-2 tensor $T^{\\mu\\nu}$ is $\\nabla_{\\mu} T^{\\mu\\nu} = \\partial_{\\mu} T^{\\mu\\nu} + \\Gamma^{\\mu}_{\\mu\\lambda} T^{\\lambda\\nu} + \\Gamma^{\\nu}_{\\mu\\lambda} T^{\\mu\\lambda}$.\n- The Levi-Civita connection is metric compatible $\\nabla_{\\lambda} g_{\\mu\\nu} = 0$ and torsion-free.\n- For the Levi-Civita connection, the contracted Christoffel symbol satisfies $\\Gamma^{\\mu}_{\\mu\\lambda} = \\partial_{\\lambda} \\ln \\sqrt{|g|}$ where $g$ is the determinant of $g_{\\alpha\\beta}$.\n- In the given static background with $g_{0i} = 0$ and no time dependence, $\\Gamma^{0}_{\\mu\\lambda} = 0$ and the nontrivial geometric contributions for $\\nabla_{i} T^{i0}$ arise from the spatial trace $\\Gamma^{i}_{ik}$.\n\nDefine a stress-energy flux field $T^{i0}(x,y)$ as follows. Let the stream function $\\psi(x,y) = A_{\\psi} \\sin(\\ell_x x)\\sin(\\ell_y y)$ for given integer wavenumbers $\\ell_x$ and $\\ell_y$ and amplitude $A_{\\psi}$. Define the coordinate-space vector density $J^i$ by $J^x = \\partial_y \\psi$ and $J^y = -\\partial_x \\psi$, and set the contravariant components $T^{i0} = V^i = J^i / \\sqrt{g}$. This choice yields an exactly conserved field in the continuum, $\\nabla_{i} T^{i0} = 0$, as a direct consequence of the properties above.\n\nDiscretization requirements:\n- Use a uniform grid with $N \\times N$ points and spacings $\\Delta x = 2\\pi/N$ and $\\Delta y = 2\\pi/N$. Use periodic boundary conditions.\n- Use centered finite differences for all spatial derivatives. For a scalar field $f_{i,j}$ on the grid, define\n  $$\n  D_x f_{i,j} = \\frac{f_{i+1,j} - f_{i-1,j}}{2 \\Delta x}, \\quad\n  D_y f_{i,j} = \\frac{f_{i,j+1} - f_{i,j-1}}{2 \\Delta y},\n  $$\n  where indices are wrapped periodically. Apply these operators componentwise to vector and tensor components.\n- Construct $J^x$ and $J^y$ from the discrete $\\psi$ using the same centered difference operators, then set $V^x = J^x/\\sqrt{g}$ and $V^y = J^y/\\sqrt{g}$.\n\nSchemes to implement and compare:\n- The mimetic scheme should approximate $\\nabla_{i} T^{i0}$ using a metric-compatible finite difference expression that ensures discrete cancellation of the connection trace terms for weak fields when applied to the test field defined above. Your design must be based on the fundamental facts listed and the metric compatibility of the Levi-Civita connection, and it must employ the same discrete operators used to construct $J^i$ to achieve exact cancellation at the discrete level for the given test field.\n- The standard scheme should approximate $\\nabla_{i} T^{i0}$ by directly discretizing $\\partial_i T^{i0} + \\Gamma^{i}_{ik} T^{k0}$, where $\\Gamma^{i}_{ik} = \\partial_k \\ln \\sqrt{g}$, using the same centered difference operators for $\\partial_i$ and $\\partial_k$.\n\nError metric:\n- For each scheme, define the root-mean-square (RMS) conservation error as\n  $$\n  \\mathcal{E} = \\sqrt{\\frac{1}{N^2}\\sum_{i,j} \\left(\\nabla_{i} T^{i0}\\Big|_{i,j}\\right)^2 }.\n  $$\n  Report $\\mathcal{E}_{\\text{mimetic}}$ and $\\mathcal{E}_{\\text{standard}}$ as floating-point values.\n\nTest suite:\n- Use the following parameter sets $(N,\\epsilon,k_x,k_y,\\ell_x,\\ell_y,A_{\\psi})$:\n  - Case 1: $(32, 0.0, 1, 1, 2, 2, 1.0)$\n  - Case 2: $(64, 0.1, 1, 2, 2, 1, 1.0)$\n  - Case 3: $(64, 0.3, 3, 2, 1, 3, 1.0)$\n  - Case 4: $(16, 0.2, 2, 2, 3, 3, 1.0)$\n  - Case 5: $(128, 0.1, 5, 3, 7, 4, 1.0)$\n\nYour program should compute $\\mathcal{E}_{\\text{mimetic}}$ and $\\mathcal{E}_{\\text{standard}}$ for each case and produce a single line of output containing the results as a comma-separated list enclosed in square brackets, ordered as\n$$\n[\\mathcal{E}_{\\text{mimetic}}^{(1)},\\mathcal{E}_{\\text{standard}}^{(1)},\\mathcal{E}_{\\text{mimetic}}^{(2)},\\mathcal{E}_{\\text{standard}}^{(2)},\\ldots,\\mathcal{E}_{\\text{mimetic}}^{(5)},\\mathcal{E}_{\\text{standard}}^{(5)}].\n$$\nThere are no physical units in this problem; all quantities are dimensionless. Ensure all trigonometric functions use angles in radians. The output must be exactly one line in the specified format.", "solution": "The problem requires the design and comparison of two finite difference schemes for calculating the covariant divergence of a specific stress-energy tensor component, $\\nabla_{\\mu} T^{\\mu 0}$, in a curved 2D spatial geometry. The core of the problem lies in recognizing how a \"mimetic\" scheme can preserve a key property of the continuum equations—in this case, conservation—at the discrete level, while a more naive \"standard\" discretization fails to do so.\n\nFirst, let us analyze the continuum expression for the quantity of interest. The problem considers a static spacetime with no time dependence and $g_{0i}=0$. The $\\nu=0$ component of the conservation law $\\nabla_{\\mu} T^{\\mu\\nu}=0$ simplifies to $\\nabla_i T^{i0} = 0$, where indices $i, j, k$ run over the spatial coordinates $(x, y)$. This can be expressed as $\\partial_i T^{i0} + \\Gamma^i_{ik} T^{k0} = 0$, where $\\Gamma^i_{jk}$ are the Christoffel symbols of the spatial metric $g_{ij}$.\n\nA fundamental identity for the covariant divergence of a contravariant vector field $V^i$ on a manifold with metric $g_{ij}$ and determinant $g$ is:\n$$\n\\nabla_i V^i = \\frac{1}{\\sqrt{g}} \\partial_i (\\sqrt{g} V^i)\n$$\nThis identity elegantly bundles the connection terms into a compact form. Applying this to our vector-like quantity $T^{i0}$, we get:\n$$\n\\nabla_i T^{i0} = \\frac{1}{\\sqrt{g}} \\partial_i (\\sqrt{g} T^{i0})\n$$\nThe problem defines the stress-energy flux $T^{i0}$ using a stream function $\\psi(x,y)$, such that $T^{i0} = V^i = J^i / \\sqrt{g}$, where $J^x = \\partial_y \\psi$ and $J^y = -\\partial_x \\psi$. The field $J^i$ is a vector density. Substituting this definition into the compact divergence expression yields a profound simplification:\n$$\n\\nabla_i T^{i0} = \\frac{1}{\\sqrt{g}} \\partial_i \\left(\\sqrt{g} \\frac{J^i}{\\sqrt{g}}\\right) = \\frac{1}{\\sqrt{g}} \\partial_i J^i\n$$\nThe divergence of the density $J^i$ is $\\partial_i J^i = \\partial_x J^x + \\partial_y J^y = \\partial_x(\\partial_y \\psi) + \\partial_y(-\\partial_x \\psi) = \\partial_x\\partial_y \\psi - \\partial_y\\partial_x \\psi$. For any sufficiently smooth function $\\psi$, the mixed partial derivatives commute, so $\\partial_x\\partial_y \\psi - \\partial_y\\partial_x \\psi = 0$. Therefore, in the continuum, $\\partial_i J^i = 0$, which in turn means $\\nabla_i T^{i0} = 0$ exactly.\n\nThis analysis forms the basis for designing the two numerical schemes.\n\n**Mimetic Scheme Design**\n\nThe mimetic (\"imitative\") scheme is designed to preserve the property $\\partial_i J^i = 0$ at the discrete level. It starts from the most compact, \"conservative\" form of the divergence: $\\nabla_i T^{i0} = \\frac{1}{\\sqrt{g}} \\partial_i J^i$.\n1.  On the discrete grid $\\psi_{i,j}$, we first construct the components of the vector density $J^i$ using the provided centered finite difference operators $D_x$ and $D_y$:\n    $$\n    J^x_{i,j} = D_y \\psi_{i,j} \\quad , \\quad J^y_{i,j} = -D_x \\psi_{i,j}\n    $$\n2.  Next, we compute the divergence of the discrete field $J^i$ using the same operators:\n    $$\n    (D_i J^i)_{i,j} = D_x J^x_{i,j} + D_y J^y_{i,j} = D_x(D_y \\psi)_{i,j} - D_y(D_x \\psi)_{i,j}\n    $$\n    Crucially, for centered difference operators on a uniform grid, the discrete commutator is identically zero: $D_x D_y f - D_y D_x f = 0$ for any grid function $f$. This is because both operators expand to the same stencil:\n    $$\n    (D_x D_y f)_{i,j} = (D_y D_x f)_{i,j} = \\frac{f_{i+1,j+1} - f_{i-1,j+1} - f_{i+1, j-1} + f_{i-1,j-1}}{4 \\Delta x \\Delta y}\n    $$\n3.  Finally, the discrete covariant divergence is computed as:\n    $$\n    (\\nabla_i T^{i0})_{\\text{mimetic}, i,j} = \\frac{1}{\\sqrt{g_{i,j}}} (D_i J^i)_{i,j}\n    $$\nSince $(D_i J^i)_{i,j}=0$ up to machine floating-point precision, this scheme guarantees that the discrete conservation law holds by construction. The error $\\mathcal{E}_{\\text{mimetic}}$ is expected to be near zero for all test cases.\n\n**Standard Scheme Design**\n\nThe standard scheme is based on a more naive approach. It discretizes an expanded form of the divergence that is equivalent in the continuum but not at the discrete level. The problem specifies discretizing the expression $\\partial_i T^{i0} + \\Gamma^i_{ik} T^{k0}$ with the provided prescription $\\Gamma^i_{ik} = \\partial_k \\ln\\sqrt{g}$. This results in the expression $\\partial_i T^{i0} + (\\partial_k \\ln \\sqrt{g}) T^{k0}$, which upon relabeling the dummy index $k$ to $i$ gives $\\partial_i T^{i0} + T^{i0} \\partial_i(\\ln \\sqrt{g})$. In the continuum, this is indeed equivalent to $\\frac{1}{\\sqrt{g}} \\partial_i (\\sqrt{g} T^{i0}) = \\frac{1}{\\sqrt{g}} \\partial_i J^i$, as can be seen by applying the product rule.\n\nHowever, the standard scheme discretizes each part of the expanded form separately:\n1.  First, compute the fields $T^{x0}$ and $T^{y0}$ on the grid: $T^{x0}_{i,j} = J^x_{i,j}/\\sqrt{g_{i,j}}$ and $T^{y0}_{i,j} = J^y_{i,j}/\\sqrt{g_{i,j}}$, where $J^x$ and $J^y$ are computed as in the mimetic scheme.\n2.  Discretize the expanded expression term by term using centered differences:\n    $$\n    (\\nabla_i T^{i0})_{\\text{standard}, i,j} = (D_x T^{x0} + D_y T^{y0}) + (T^{x0} D_x(\\ln\\sqrt{g}) + T^{y0} D_y(\\ln\\sqrt{g}))\n    $$\nThe failure of this scheme lies in the fact that the discrete product rule for centered differences is not exact. That is, for two grid functions $f$ and $h$:\n$$\nD_x(f h) \\neq f_i (D_x h) + h_i (D_x f)\n$$\nThe standard scheme effectively computes a discrete version of $\\partial_i (J^i/\\sqrt{g}) + (J^i/\\sqrt{g})\\partial_i(\\ln\\sqrt{g})$. While the continuum versions of these terms combine via the product rule to give $\\frac{1}{\\sqrt{g}}\\partial_i J^i$, their discrete counterparts do not. The residual from the inexact discrete product rule results in a non-zero value for the computed divergence. This systematic error, known as a truncation error, will be captured by the error metric $\\mathcal{E}_{\\text{standard}}$. This error will be zero only in the trivial case where the metric is flat ($\\epsilon=0$, so $\\sqrt{g}=1$), as the product rule terms vanish. For $\\epsilon > 0$, we expect $\\mathcal{E}_{\\text{standard}} \\gg \\mathcal{E}_{\\text{mimetic}}$.\n\nThe following program implements both schemes and calculates their respective RMS conservation errors for the given test cases.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Designs and compares mimetic and standard finite difference schemes for\n    the conservation of the stress-energy tensor.\n    \"\"\"\n\n    test_cases = [\n        # (N, epsilon, kx, ky, lx, ly, A_psi)\n        (32, 0.0, 1, 1, 2, 2, 1.0),\n        (64, 0.1, 1, 2, 2, 1, 1.0),\n        (64, 0.3, 3, 2, 1, 3, 1.0),\n        (16, 0.2, 2, 2, 3, 3, 1.0),\n        (128, 0.1, 5, 3, 7, 4, 1.0),\n    ]\n\n    results = []\n\n    def Dx(f, dx):\n        \"\"\"Computes the centered finite difference derivative along axis 1 (x).\"\"\"\n        return (np.roll(f, -1, axis=1) - np.roll(f, 1, axis=1)) / (2.0 * dx)\n\n    def Dy(f, dy):\n        \"\"\"Computes the centered finite difference derivative along axis 0 (y).\"\"\"\n        return (np.roll(f, -1, axis=0) - np.roll(f, 1, axis=0)) / (2.0 * dy)\n\n    for case in test_cases:\n        N, epsilon, kx, ky, lx, ly, A_psi = case\n        \n        # Grid setup\n        dx = 2.0 * np.pi / N\n        dy = 2.0 * np.pi / N\n        x_1d = np.linspace(0, 2.0 * np.pi, N, endpoint=False)\n        y_1d = np.linspace(0, 2.0 * np.pi, N, endpoint=False)\n        x, y = np.meshgrid(x_1d, y_1d)\n\n        # Define metric and fields\n        a = 1.0 + epsilon * np.cos(kx * x) * np.cos(ky * y)\n        sqrt_g = a**2\n        psi = A_psi * np.sin(lx * x) * np.sin(ly * y)\n        \n        # Calculate J^i from psi\n        Jx = Dy(psi, dy)\n        Jy = -Dx(psi, dx)\n\n        # 1. Mimetic Scheme Calculation\n        # Discretizes nabla_i T^i0 = (1/sqrt(g)) * d_i J^i\n        # This form ensures discrete cancellation.\n        div_J = Dx(Jx, dx) + Dy(Jy, dy)\n        mimetic_div = div_J / sqrt_g\n        error_mimetic = np.sqrt(np.mean(mimetic_div**2))\n        results.append(error_mimetic)\n\n        # 2. Standard Scheme Calculation\n        # Discretizes nabla_i T^i0 = d_i T^i0 + T^i0 * d_i(ln(sqrt(g)))\n        # This form suffers from discrete product rule error.\n        Tx0 = Jx / sqrt_g\n        Ty0 = Jy / sqrt_g\n\n        # Term 1: d_i T^i0\n        div_T = Dx(Tx0, dx) + Dy(Ty0, dy)\n\n        # Term 2: T^i0 * d_i(ln(sqrt(g)))\n        ln_sqrt_g = 2.0 * np.log(a)\n        d_ln_sqrt_g_dx = Dx(ln_sqrt_g, dx)\n        d_ln_sqrt_g_dy = Dy(ln_sqrt_g, dy)\n        connection_term = Tx0 * d_ln_sqrt_g_dx + Ty0 * d_ln_sqrt_g_dy\n        \n        standard_div = div_T + connection_term\n        error_standard = np.sqrt(np.mean(standard_div**2))\n        results.append(error_standard)\n\n    # Format and print the final results\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3496084"}]}