{"hands_on_practices": [{"introduction": "This first practice establishes a fundamental analytical benchmark for apparent horizon finders. Starting with the Schwarzschild solution on a time-symmetric slice ($K_{ij}=0$) in isotropic coordinates, you will apply the definition of a Marginally Outer Trapped Surface (MOTS) by calculating the outgoing null expansion $\\Theta_{(\\ell)}$. This exercise solidifies the connection between the formal definition of a MOTS and a concrete geometric result, providing a crucial first-principles derivation for the location of the apparent horizon [@problem_id:3464010].", "problem": "Consider the Schwarzschild spacetime expressed in isotropic coordinates on a time-symmetric slice, where the extrinsic curvature $K_{ij}$ of the slice vanishes. The spatial three-metric on a constant-time hypersurface is conformally flat and can be written as\n$$\n\\gamma_{ij}\\,dx^{i}\\,dx^{j} = \\psi(r)^{4}\\left(dr^{2} + r^{2}\\,d\\Omega^{2}\\right),\n$$\nwith conformal factor $\\psi(r) = 1 + \\frac{M}{2 r}$ for mass parameter $M0$. In the language of apparent horizon finding, the outgoing null expansion $\\Theta_{(\\ell)}$ of a closed two-surface $\\mathcal{S}$ embedded in the slice is defined by the fundamental relation\n$$\n\\Theta_{(\\ell)} = D_{i} s^{i} + K_{ij} s^{i} s^{j} - K,\n$$\nwhere $D_{i}$ is the covariant derivative compatible with $\\gamma_{ij}$, $s^{i}$ is the outward-pointing unit normal to $\\mathcal{S}$ within the slice, and $K = \\gamma^{ij} K_{ij}$ is the trace of the extrinsic curvature. A Marginally Outer Trapped Surface (MOTS) is a closed two-surface for which $\\Theta_{(\\ell)} = 0$.\n\nUsing only these definitions and the given metric, take the spherically symmetric ansatz $\\mathcal{S}$ given by a coordinate sphere at constant isotropic radius $r = \\text{const}$. Derive an explicit expression for $\\Theta_{(\\ell)}(r)$ on the time-symmetric slice, and solve the MOTS equation $\\Theta_{(\\ell)}(r) = 0$ to obtain the isotropic radius $r_{\\text{AH}}$ of the apparent horizon as a function of $M$. Then numerically verify your analytic result by evaluating your derived $\\Theta_{(\\ell)}(r)$ at $r = r_{\\text{AH}}$ for the specific choice $M = 1$ using geometric units.\n\nReport the final answer as the closed-form analytic expression for $r_{\\text{AH}}$ in terms of $M$. No rounding is required, and no units should be included in the final answer.", "solution": "The problem as stated is valid. It is scientifically grounded in the principles of general relativity, specifically concerning the Schwarzschild metric and the concept of apparent horizons (Marginally Outer Trapped Surfaces, or MOTS). The problem is well-posed, providing a clear, self-contained set of definitions and a metric, leading to a request for a specific derivation and solution. There are no contradictions, ambiguities, or factual unsoundness.\n\nWe are asked to find the isotropic radius of the apparent horizon on a time-symmetric slice of the Schwarzschild spacetime.\n\nFirst, we simplify the given expression for the outgoing null expansion, $\\Theta_{(\\ell)}$. The slice is time-symmetric, which means the extrinsic curvature tensor $K_{ij}$ is zero. This implies that its trace, $K = \\gamma^{ij}K_{ij}$, is also zero. The formula for the expansion thus reduces to:\n$$\n\\Theta_{(\\ell)} = D_{i} s^{i}\n$$\nwhere $D_{i}$ is the covariant derivative associated with the spatial three-metric $\\gamma_{ij}$, and $s^{i}$ is the outward-pointing unit normal vector to the two-surface $\\mathcal{S}$ within the slice. This expression, $D_i s^i$, is the divergence of the unit normal field.\n\nThe spatial metric is given in isotropic coordinates $(r, \\theta, \\phi)$ as:\n$$\n\\gamma_{ij}\\,dx^{i}\\,dx^{j} = \\psi(r)^{4}\\left(dr^{2} + r^{2}\\,dOmega^{2}\\right) = \\psi(r)^{4} dr^2 + \\psi(r)^4 r^2 d\\theta^2 + \\psi(r)^4 r^2 \\sin^2\\theta d\\phi^2\n$$\nwith the conformal factor $\\psi(r) = 1 + \\frac{M}{2r}$. This metric is diagonal, with components:\n$$\n\\gamma_{rr} = \\psi(r)^{4}, \\quad \\gamma_{\\theta\\theta} = \\psi(r)^{4} r^{2}, \\quad \\gamma_{\\phi\\phi} = \\psi(r)^{4} r^{2} \\sin^{2}\\theta\n$$\nThe determinant of the metric is $\\gamma = \\det(\\gamma_{ij}) = \\gamma_{rr}\\gamma_{\\theta\\theta}\\gamma_{\\phi\\phi} = \\psi(r)^{12} r^{4} \\sin^{2}\\theta$. Its square root is $\\sqrt{\\gamma} = \\psi(r)^{6} r^{2} \\sin\\theta$.\n\nThe surface $\\mathcal{S}$ is a sphere of constant coordinate radius, which can be described by the level-set function $f(r, \\theta, \\phi) = r - \\text{const} = 0$. The covariant normal vector $n_i$ is given by the gradient of $f$:\n$$\nn_i = \\partial_i f = (1, 0, 0)\n$$\nThe contravariant components $n^i$ are found by raising the index with the inverse metric, $n^i = \\gamma^{ij}n_j$. The non-zero components of the inverse metric $\\gamma^{ij}$ are $\\gamma^{rr} = \\psi(r)^{-4}$, $\\gamma^{\\theta\\theta} = \\psi(r)^{-4}r^{-2}$, and $\\gamma^{\\phi\\phi} = \\psi(r)^{-4}r^{-2}\\sin^{-2}\\theta$. This gives:\n$$\nn^r = \\gamma^{rr} n_r = \\psi(r)^{-4} \\times 1 = \\psi(r)^{-4}\n$$\nand $n^\\theta = n^\\phi = 0$. The magnitude-squared of this normal vector is $|n|^2 = \\gamma_{ij}n^i n^j = \\gamma_{rr}(n^r)^2 = \\psi(r)^{4}(\\psi(r)^{-4})^2 = \\psi(r)^{-4}$. The magnitude is thus $|n| = \\psi(r)^{-2}$. The outward-pointing unit normal vector $s^i$ is $s^i = n^i/|n|$:\n$$\ns^i = \\frac{(\\psi(r)^{-4}, 0, 0)}{\\psi(r)^{-2}} = (\\psi(r)^{-2}, 0, 0)\n$$\n\nNow we can compute the divergence $\\Theta_{(\\ell)} = D_i s^i$. Using the standard formula for divergence in curvilinear coordinates:\n$$\nD_i s^i = \\frac{1}{\\sqrt{\\gamma}} \\partial_j (\\sqrt{\\gamma} s^j)\n$$\nSince only the $r$-component of $s^i$ is non-zero, this simplifies to:\n$$\n\\Theta_{(\\ell)} = \\frac{1}{\\sqrt{\\gamma}} \\partial_r (\\sqrt{\\gamma} s^r) = \\frac{1}{\\psi^6 r^2 \\sin\\theta} \\partial_r(\\psi^6 r^2 \\sin\\theta \\cdot \\psi^{-2}) = \\frac{1}{\\psi^6 r^2 \\sin\\theta} \\partial_r(\\psi^4 r^2 \\sin\\theta)\n$$\nThe term $\\sin\\theta$ is constant with respect to $r$. We use the product rule to differentiate $\\psi^4 r^2$:\n$$\n\\partial_r(\\psi^4 r^2) = (\\partial_r \\psi^4) r^2 + \\psi^4 (\\partial_r r^2) = (4\\psi^3 \\psi') r^2 + \\psi^4(2r)\n$$\nwhere $\\psi' = \\frac{d\\psi}{dr} = \\frac{d}{dr}\\left(1 + \\frac{M}{2r}\\right) = -\\frac{M}{2r^2}$. Substituting this in:\n$$\n\\partial_r(\\psi^4 r^2) = 4\\psi^3 \\left(-\\frac{M}{2r^2}\\right) r^2 + 2r\\psi^4 = -2M\\psi^3 + 2r\\psi^4 = 2\\psi^3(r\\psi - M)\n$$\nWe now substitute the expression for $\\psi(r)$ into the parenthetical term:\n$$\nr\\psi - M = r\\left(1+\\frac{M}{2r}\\right) - M = r + \\frac{M}{2} - M = r - \\frac{M}{2}\n$$\nTherefore, the derivative is $\\partial_r(\\psi^4 r^2) = 2\\psi^3(r - \\frac{M}{2})$.\nPutting everything back into the expression for $\\Theta_{(\\ell)}$:\n$$\n\\Theta_{(\\ell)}(r) = \\frac{1}{\\psi^6 r^2 \\sin\\theta} \\left[ 2\\psi^3\\left(r - \\frac{M}{2}\\right) \\sin\\theta \\right] = \\frac{2(r - \\frac{M}{2})}{\\psi^3 r^2}\n$$\nThis is the required explicit expression for the outgoing null expansion $\\Theta_{(\\ell)}(r)$ on the surface of a sphere of isotropic radius $r$.\n\nA MOTS (the apparent horizon) is defined by the condition $\\Theta_{(\\ell)}(r) = 0$. We solve the equation for the apparent horizon radius, $r_{\\text{AH}}$:\n$$\n\\frac{2(r_{\\text{AH}} - \\frac{M}{2})}{\\psi(r_{\\text{AH}})^3 r_{\\text{AH}}^2} = 0\n$$\nFor a physical black hole, we are interested in solutions with $r_{\\text{AH}}  0$ and $M  0$. In this regime, the denominator is strictly positive, since $\\psi(r) = 1 + \\frac{M}{2r}  1$. The equation is satisfied if and only if the numerator is zero:\n$$\n2\\left(r_{\\text{AH}} - \\frac{M}{2}\\right) = 0\n$$\nThis yields the solution for the isotropic radius of the apparent horizon:\n$$\nr_{\\text{AH}} = \\frac{M}{2}\n$$\n\nFinally, we verify this result as requested. For the case $M=1$, we have $r_{\\text{AH}}=\\frac{1}{2}$. We evaluate our derived expression for $\\Theta_{(\\ell)}(r)$ at $r=r_{\\text{AH}}$ with $M=1$:\n$$\n\\Theta_{(\\ell)}\\left(r=\\frac{1}{2}\\right) = \\frac{2\\left(\\frac{1}{2} - \\frac{M}{2}\\right)}{\\psi\\left(\\frac{1}{2}\\right)^3 \\left(\\frac{1}{2}\\right)^2} \\Bigg|_{M=1} = \\frac{2\\left(\\frac{1}{2} - \\frac{1}{2}\\right)}{\\psi\\left(\\frac{1}{2}\\right)^3 \\left(\\frac{1}{4}\\right)} = \\frac{2(0)}{\\left(1+\\frac{1}{2(1/2)}\\right)^3 \\left(\\frac{1}{4}\\right)} = 0\n$$\nThe result is indeed zero, which numerically verifies the analytic solution.", "answer": "$$\n\\boxed{\\frac{M}{2}}\n$$", "id": "3464010"}, {"introduction": "Building upon the analytical foundation, this practice moves into a scenario directly relevant to modern numerical relativity simulations that use \"moving puncture\" techniques. While the apparent horizon in Schwarzschild spacetime is invariantly located at an areal radius of $R=2M$, its coordinate location depends on the chosen slicing. This exercise challenges you to find the apparent horizon on a non-trivial \"trumpet\" slice by numerically solving for the coordinate radius $r_h$ that satisfies the areal radius condition, thereby bridging the gap between physical invariants and coordinate-dependent descriptions [@problem_id:3464001].", "problem": "Consider a non-spinning Schwarzschild black hole of mass $M$ in geometrized units where the gravitational constant $G$ and the speed of light $c$ satisfy $G=c=1$. In the $3+1$ formulation of General Relativity, define the apparent horizon as the outermost closed two-surface on a spatial slice for which the outgoing null expansion is zero. For spherically symmetric spacetimes, the outgoing null expansion $\\Theta_+$ of a round two-sphere of areal radius $R$ is determined by the Misner-Sharp mass $m(R)$ through the invariant relation $$1 - \\frac{2 m(R)}{R} = g^{ab} \\nabla_a R \\nabla_b R,$$ and in vacuum Schwarzschild spacetime one has $m(R)=M$ (constant). Conclude that the apparent horizon is located at areal radius $R=2M$ independent of the slicing.\n\nIn trumpet slicing used in moving puncture evolutions, the stationary slice geometry near the puncture exhibits a conformal factor that diverges like $1/\\sqrt{r}$, which leads to a finite limiting areal radius at the puncture. Consider the following analytically specified spherically symmetric, conformally flat spatial metric on a slice,\n$$\\gamma_{ij} = \\psi^4(r)\\,\\delta_{ij},\\qquad \\psi(r) = 1 + \\frac{b}{\\sqrt{r}},$$\nwhere $r$ is the isotropic coordinate radius, and $b0$ is a constant controlling the trumpet’s cylindrical end radius. The areal radius of coordinate spheres is given by\n$$R(r) = \\psi^2(r)\\,r = \\big(\\sqrt{r} + b\\big)^2.$$\nThis slice captures the characteristic trumpet behavior near the puncture ($\\psi \\sim b/\\sqrt{r}$) and is asymptotically flat ($\\psi \\to 1$ as $r \\to \\infty$).\n\nYour tasks are:\n1. Starting from the definition of the apparent horizon via vanishing outgoing expansion and the Misner-Sharp relation, explain why the apparent horizon in Schwarzschild must satisfy $R=2M$ for any spherically symmetric slice.\n2. Using the analytic slice geometry above, derive the condition for the coordinate radius $r_h$ of the apparent horizon on this slice, and determine criteria for existence of a solution $r_h \\ge 0$.\n3. Implement a horizon finder that, given $(M,b)$, searches for a root of the function $$f(r) = R(r) - 2M = \\big(\\sqrt{r} + b\\big)^2 - 2M$$ in $r \\ge 0$ using a robust bracketing and bisection method on the variable $x = \\sqrt{r} \\ge 0$. If a valid root exists, return the coordinate radius $r_h$; otherwise return $-1$ to indicate no apparent horizon on this slice.\n4. Validate the numerical horizon finder output against the derived analytic expression, and ensure consistency within a small tolerance for all cases where a horizon exists.\n\nUnits: Express radii in the same geometrized units as $M$ (unitless in this convention). No angles are involved.\n\nTest Suite:\nUse the following set of parameter values $(M,b)$:\n- Case 1 (happy path): $(1.0,\\,1.1)$.\n- Case 2 (boundary, horizon at puncture): $(1.0,\\,\\sqrt{2})$.\n- Case 3 (no horizon): $(1.0,\\,1.5)$.\n- Case 4 (happy path with larger mass): $(2.0,\\,1.8)$.\n- Case 5 (no horizon with larger mass): $(2.0,\\,2.2)$.\n\nFor each case, the program must output a single floating-point number: the coordinate radius $r_h$ if the horizon exists, or $-1$ otherwise.\n\nFinal Output Format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,result3,result4,result5]\"). Each result must be a floating-point number.", "solution": "The problem statement is scientifically grounded, well-posed, and objective. It presents a standard problem in numerical relativity concerning the location of an apparent horizon on a specific \"trumpet\" slice of a Schwarzschild spacetime. All provided equations and definitions are standard in the field. The tasks are logically structured, leading from fundamental principles to analytical derivation and finally to numerical implementation and validation. The problem is therefore deemed valid.\n\nHere is the step-by-step solution.\n\n**1. Apparent Horizon Condition in Schwarzschild Spacetime**\n\nThe apparent horizon is defined as the outermost marginally trapped surface on a given spatial slice, which is a closed $2$-surface where the expansion of outgoing null geodesics, $\\Theta_+$, vanishes. The condition for an apparent horizon is thus $\\Theta_+ = 0$.\n\nIn a spherically symmetric spacetime, the expansion $\\Theta_+$ is related to the geometry of the $2$-spheres of symmetry. The problem provides the fundamental invariant relation connecting the Misner-Sharp mass $m(R)$ enclosed within an areal radius $R$ to the spatial gradient of the areal radius function $R$:\n$$1 - \\frac{2 m(R)}{R} = g^{ab} \\nabla_a R \\nabla_b R$$\nHere, $g^{ab}$ is the inverse of the full $4$-dimensional spacetime metric $g_{ab}$, and $\\nabla_a$ is the covariant derivative compatible with it. The term on the right-hand side, $g^{ab} \\nabla_a R \\nabla_b R$, is the squared norm of the gradient of the areal radius. For a null vector field $l^a$ generating the outgoing null geodesics orthogonal to the $2$-sphere, the expansion is given by $\\Theta_+ = \\frac{1}{R} \\nabla_a(R l^a)$. For spherically symmetric systems, this can be shown to be directly related to the gradient term. The outgoing null geodesics have $ds^2=0$, and their expansion must be non-negative, which implies that a non-tachyonic expansion is determined by $\\sqrt{g^{ab} \\nabla_a R \\nabla_b R}$. The condition for a marginally trapped surface, $\\Theta_+ = 0$, is therefore equivalent to the condition that the gradient of $R$ is null:\n$$g^{ab} \\nabla_a R \\nabla_b R = 0$$\nSubstituting this into the Misner-Sharp relation yields:\n$$1 - \\frac{2 m(R)}{R} = 0$$\nThe problem states that for a vacuum Schwarzschild spacetime of mass $M$, the Misner-Sharp mass is constant for any radius, $m(R) = M$. This is a statement of Birkhoff's theorem. The apparent horizon condition thus becomes:\n$$1 - \\frac{2 M}{R} = 0$$\nSolving for the areal radius $R$ gives the unique result:\n$$R = 2M$$\nThis result depends only on the definition of the apparent horizon ($\\Theta_+ = 0$) and the fact that the spacetime is Schwarzschild ($m(R) = M$). It does not depend on the specific coordinate system or the slicing (i.e., the choice of time coordinate and the decomposition of the metric into spatial and temporal parts). Therefore, the apparent horizon is always located at the surface with areal radius $R=2M$, regardless of the choice of a spherically symmetric slicing.\n\n**2. Apparent Horizon on the Trumpet Slice**\n\nWe now apply the general condition $R=2M$ to the specific trumpet slice provided. The geometry of this slice is given by the conformally flat spatial metric $\\gamma_{ij} = \\psi^4(r)\\,\\delta_{ij}$, with the conformal factor $\\psi(r) = 1 + \\frac{b}{\\sqrt{r}}$. For this metric, the areal radius $R$ of a coordinate sphere of radius $r$ is given by:\n$$R(r) = \\psi^2(r) \\, r = \\left(1 + \\frac{b}{\\sqrt{r}}\\right)^2 r = \\left(\\sqrt{r}\\left(1 + \\frac{b}{\\sqrt{r}}\\right)\\right)^2 = \\left(\\sqrt{r} + b\\right)^2$$\nTo find the coordinate radius $r_h$ of the apparent horizon, we set its areal radius $R(r_h)$ equal to $2M$:\n$$R(r_h) = \\left(\\sqrt{r_h} + b\\right)^2 = 2M$$\nTo solve for $r_h$, we first solve for $\\sqrt{r_h}$. Since the coordinate radius $r$ must be non-negative, $r_h \\ge 0$, its square root $\\sqrt{r_h}$ must also be real and non-negative. The parameter $b$ is given as positive, $b0$. The sum $\\sqrt{r_h} + b$ is therefore strictly positive. Taking the square root of both sides of the equation yields:\n$$\\sqrt{r_h} + b = \\sqrt{2M}$$\nWe have chosen the positive square root on the right-hand side because the left-hand side must be positive.\nIsolating the term $\\sqrt{r_h}$, we find:\n$$\\sqrt{r_h} = \\sqrt{2M} - b$$\nFor a physical solution for $r_h$ to exist, the value of $\\sqrt{r_h}$ must be real and non-negative. This imposes a critical condition on the parameter $b$:\n$$\\sqrt{2M} - b \\ge 0 \\implies b \\le \\sqrt{2M}$$\nThis is the criterion for the existence of an apparent horizon on this slice.\n- If $b  \\sqrt{2M}$, the right-hand side is negative, so there is no real solution for $\\sqrt{r_h}$. In this case, no apparent horizon exists on the slice. The function $R(r)$ has a minimum value at $r \\to 0$, where $R(r) \\approx (b)^2 = b^2$. If $b^2  2M$, then $R(r)  2M$ for all $r \\ge 0$, and the condition $R=2M$ can never be met.\n- If $b \\le \\sqrt{2M}$, a non-negative solution for $\\sqrt{r_h}$ exists. We can square both sides to find the coordinate radius $r_h$:\n$$r_h = \\left(\\sqrt{2M} - b\\right)^2$$\nThe boundary case occurs when $b = \\sqrt{2M}$, which gives $r_h = 0$. This corresponds to the apparent horizon being located at the puncture, $r=0$. For $b  \\sqrt{2M}$, we have $r_h  0$.\n\n**3. Numerical Horizon Finder Design**\n\nThe task is to implement a numerical root-finder for the equation $f(r) = R(r) - 2M = 0$, which is:\n$$f(r) = \\left(\\sqrt{r} + b\\right)^2 - 2M = 0$$\nfor $r \\ge 0$. The problem specifies using a bisection method on the variable $x = \\sqrt{r}$, where $x \\ge 0$. Let's define a new function $g(x)$ corresponding to $f(r)$:\n$$g(x) = (x + b)^2 - 2M$$\nWe need to find the root of $g(x)=0$ for $x \\ge 0$.\nThe algorithm proceeds as follows:\n1.  First, check the existence condition derived analytically: $b \\le \\sqrt{2M}$. This is equivalent to $b^2 \\le 2M$. If $b^2  2M$, no root exists, and the finder should return $-1$.\n2.  If a root exists ($b^2 \\le 2M$), we need to establish a bracket $[x_a, x_b]$ for the bisection method, such that $g(x_a)$ and $g(x_b)$ have opposite signs.\n    -   Let's evaluate $g(x)$ at the lower bound of our domain, $x = 0$.\n        $$g(0) = (0 + b)^2 - 2M = b^2 - 2M$$\n        Since we established a root exists ($b^2 \\le 2M$), we know that $g(0) \\le 0$. So, we can set the lower end of our bracket to $x_a = 0$.\n    -   For the upper bound $x_b$, we need a value such that $g(x_b)  0$. The derivative of $g(x)$ is $g'(x) = 2(x+b)$, which is always positive for $x \\ge 0$ and $b  0$. Thus, $g(x)$ is a monotonically increasing function. A suitable upper bound can be chosen by noting the analytical root is $x_h = \\sqrt{2M} - b$. A simple, robust choice for the upper bracket that is guaranteed to be greater than the root is $x_b = \\sqrt{2M}$. Let's verify:\n        $$g(\\sqrt{2M}) = (\\sqrt{2M} + b)^2 - 2M = (2M + 2b\\sqrt{2M} + b^2) - 2M = 2b\\sqrt{2M} + b^2$$\n        Since $b0$ and $M0$, this value is always positive.\n    -   Therefore, if a root exists, it is guaranteed to lie within the interval $[0, \\sqrt{2M}]$ for $x$.\n3.  With the bracket $[x_a, x_b] = [0, \\sqrt{2M}]$ established, we can apply the bisection algorithm:\n    -   Iterate a fixed number of times (e.g., $100$ iterations provide sufficient precision for standard floating-point numbers).\n    -   In each iteration, calculate the midpoint $x_m = (x_a + x_b)/2$.\n    -   Evaluate $g(x_m)$. If $g(x_m)  0$, the root is in the upper half-interval, so we update $x_a = x_m$. Otherwise, the root is in the lower half-interval, and we update $x_b = x_m$.\n4.  After the iterations, the root is approximated as $x_h \\approx (x_a + x_b)/2$.\n5.  The final result is the coordinate radius $r_h = x_h^2$.\n\n**4. Validation**\n\nThe numerical implementation will be validated against the analytical solution $r_h = (\\sqrt{2M} - b)^2$ for the cases where a horizon exists ($b \\le \\sqrt{2M}$).\n- Case 1: $(M,b) = (1.0, 1.1)$. We have $b = 1.1  \\sqrt{2 \\cdot 1.0} \\approx 1.414$. A horizon exists. Analytical $r_h = (\\sqrt{2} - 1.1)^2 \\approx 0.098728$. The numerical solver should converge to this value.\n- Case 2: $(M,b) = (1.0, \\sqrt{2})$. We have $b = \\sqrt{2M}$. A horizon exists at the puncture. Analytical $r_h = (\\sqrt{2} - \\sqrt{2})^2 = 0$. The numerical solver should return $0$.\n- Case 3: $(M,b) = (1.0, 1.5)$. We have $b = 1.5  \\sqrt{2}$. No horizon exists. The algorithm should return $-1$.\n- Case 4: $(M,b) = (2.0, 1.8)$. We have $b = 1.8  \\sqrt{2 \\cdot 2.0} = 2.0$. A horizon exists. Analytical $r_h = (2.0 - 1.8)^2 = (0.2)^2 = 0.04$. The numerical solver should converge to this value.\n- Case 5: $(M,b) = (2.0, 2.2)$. We have $b = 2.2  2.0$. No horizon exists. The algorithm should return $-1$.\n\nThe proposed numerical method is robust and consistent with the analytical derivation.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef find_horizon(M, b):\n    \"\"\"\n    Finds the coordinate radius of the apparent horizon for a trumpet slice.\n\n    The apparent horizon is located where the areal radius R(r) = 2M.\n    For the given slice, R(r) = (sqrt(r) + b)^2.\n    The equation to solve is (sqrt(r) + b)^2 = 2M.\n    Let x = sqrt(r), so the equation becomes (x + b)^2 = 2M for x = 0.\n\n    Args:\n        M (float): The mass of the Schwarzschild black hole.\n        b (float): The parameter of the trumpet slice.\n\n    Returns:\n        float: The coordinate radius r_h of the apparent horizon, or -1 if none exists.\n    \"\"\"\n    if M = 0 or b = 0:\n        # Physical parameters must be positive.\n        return -1.0\n        \n    sqrt_2M = np.sqrt(2.0 * M)\n\n    # Criterion for horizon existence: b = sqrt(2M)\n    # This is equivalent to b^2 = 2M. We check b  sqrt(2M) to avoid\n    # floating point issues with direct comparison.\n    if b  sqrt_2M:\n        return -1.0\n        \n    # Handle the boundary case where the horizon is at the puncture r=0\n    if np.isclose(b, sqrt_2M):\n        return 0.0\n\n    # Define the function g(x) = (x + b)^2 - 2M, where x = sqrt(r).\n    # We need to find the root of g(x) = 0 for x  0.\n    g = lambda x: (x + b)**2 - 2.0 * M\n\n    # Set up the bracket for bisection on the variable x = sqrt(r).\n    # From the analysis, g(0) = b^2 - 2M = 0, so xa=0 is a valid lower bound.\n    # The analytical solution for x is sqrt(2M) - b, which is less than sqrt(2M).\n    # So, xb = sqrt(2M) serves as a robust upper bound since g(sqrt(2M))  0.\n    xa = 0.0\n    xb = sqrt_2M\n    \n    # Bisection method for finding the root x_h.\n    # 100 iterations is more than sufficient for double precision.\n    for _ in range(100):\n        xm = (xa + xb) / 2.0\n        # If g(xm) has the same sign as g(xa) (which is negative),\n        # then the root is in [xm, xb].\n        if g(xm)  0:\n            xa = xm\n        # Otherwise, the root is in [xa, xm].\n        else:\n            xb = xm\n            \n    # The root for x=sqrt(r) is approximated by the midpoint of the final interval.\n    xh = (xa + xb) / 2.0\n    \n    # The coordinate radius of the horizon is r_h = x_h^2.\n    rh = xh**2\n    \n    return rh\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (1.0, 1.1),\n        (1.0, np.sqrt(2.0)),\n        (1.0, 1.5),\n        (2.0, 1.8),\n        (2.0, 2.2),\n    ]\n\n    results = []\n    for M, b in test_cases:\n        result = find_horizon(M, b)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    # Using a format specifier to ensure consistent output representation.\n    print(f\"[{','.join(f'{r:.12f}' for r in results)}]\")\n\nsolve()\n```", "id": "3464001"}, {"introduction": "This final practice addresses a critical issue in real-world numerical simulations: the input data is never a perfect solution to Einstein's equations and always contains numerical errors that manifest as non-zero constraint violations. You will explore how these imperfections affect the horizon-finding process by modeling their influence on the outgoing null expansion $\\theta$. Instead of seeking a perfect root, the goal shifts to finding a \"best-fit\" surface that minimizes the root-mean-square (RMS) residual, developing crucial insight into the robustness and behavior of horizon finders on the \"dirty\" data typical of complex simulations [@problem_id:3464017].", "problem": "You will implement a simplified, self-contained numerical study of how violations of the Hamiltonian and momentum constraints in the Arnowitt–Deser–Misner (ADM) 3+1 decomposition influence finding a Marginally Outer Trapped Surface (MOTS), with the apparent horizon modeled as a zero of the outgoing expansion on a time-symmetric Schwarzschild slice in isotropic coordinates. Your program must model the outgoing expansion residual on axisymmetric trial surfaces, inject artificial constraint residuals, and compute the residual landscape to extract a best-fit surface by minimizing a root-mean-square (RMS) residual. All angles must be treated in radians, and all radii must be expressed in units of the mass parameter $M$.\n\nFundamental base and definitions to be used:\n- In the 3+1 decomposition, the Hamiltonian constraint is $H \\equiv R + K^2 - K_{ij} K^{ij} - 16 \\pi \\rho = 0$, and the momentum constraint is $M^i \\equiv D_j (K^{ij} - \\gamma^{ij} K) - 8 \\pi S^i = 0$, where $\\gamma_{ij}$ is the spatial metric, $K_{ij}$ the extrinsic curvature, $R$ the Ricci scalar of $\\gamma_{ij}$, and $D_i$ the covariant derivative compatible with $\\gamma_{ij}$.\n- On a null expansion computation for a closed two-surface with outward-pointing spatial unit normal $s^i$ embedded in $(\\Sigma,\\gamma_{ij})$, the outgoing expansion is $\\theta \\equiv D_i s^i + K_{ij} s^i s^j - K$. On a time-symmetric slice of Schwarzschild, $K_{ij} = 0$ and $K = 0$, so $\\theta = D_i s^i$, which equals the mean curvature of the two-surface in the physical metric $\\gamma_{ij}$.\n- Consider the conformally flat isotropic form for Schwarzschild on a time-symmetric slice: $\\gamma_{ij} = \\psi^4 \\delta_{ij}$ with $\\psi(r) = 1 + \\dfrac{M}{2 r}$, where $r$ is the isotropic radial coordinate and $M$ is the mass parameter (use $M = 1$). The known conformal transformation law for the mean curvature implies that for a star-shaped surface described as a graph over the sphere, the physical mean curvature can be related to the flat-space mean curvature by a conformal factor.\n- For axisymmetric star-shaped trial surfaces with small deformations around a sphere, parameterize the surface radius as $R(\\theta) = R_0 \\left(1 + a_2 Y_{20}(\\theta)\\right)$ with $R_0  0$ and small $|a_2|$, where $Y_{20}(\\theta)$ is the real spherical harmonic of degree $\\ell = 2$, order $m = 0$, normalized in the standard way. Let $Y_{10}(\\theta)$ denote the corresponding $\\ell = 1$, $m = 0$ harmonic.\n- Linearize the flat mean curvature for small deformations around a sphere, and, using the conformal rescaling for $\\gamma_{ij} = \\psi^4 \\delta_{ij}$ together with $\\psi(r) = 1 + \\dfrac{1}{2 r}$ (set $M = 1$), obtain a model for the outgoing expansion $\\theta(\\theta; R_0, a_2)$ that captures a constant (spherical) piece and a linear response in $a_2$ through $Y_{20}(\\theta)$.\n- Artificially inject constraint residuals by adding a surrogate additive term to the expansion of the form $\\delta \\theta(\\theta) = \\alpha \\, C_H(\\theta) + \\beta \\, \\hat{n}_i C_M^i(\\theta)$, where $C_H$ models Hamiltonian constraint residuals and $C_M^i$ models momentum constraint residuals, $\\hat{n}^i$ is the outward normal, and $\\alpha,\\beta$ are scalar weights. For the axisymmetric case, use $C_H(\\theta) = A_H \\, Y_{20}(\\theta)$ and $\\hat{n}_i C_M^i(\\theta) = A_M \\, Y_{10}(\\theta)$, with amplitudes $A_H$ and $A_M$.\n\nYour task:\n- Implement a program to compute, for each trial surface characterized by parameters $(R_0, a_2)$, the discretized root-mean-square residual\n$$\n\\mathcal{E}(R_0, a_2) = \\left( \\frac{\\int_0^\\pi \\theta(\\theta; R_0, a_2)^2 \\sin\\theta \\, d\\theta}{\\int_0^\\pi \\sin\\theta \\, d\\theta} \\right)^{1/2},\n$$\nusing a uniform grid in $\\theta \\in [0,\\pi]$ and a Riemann sum with weights $\\sin\\theta$ for the integral. Treat all angles in radians. The sphere average denominator must be exactly $\\int_0^\\pi \\sin\\theta \\, d\\theta = 2$ in the discrete approximation.\n- For each test case described below, minimize $\\mathcal{E}$ over the specified parameter set. You must use a grid search in $R_0$ over the interval $[0.3, 1.2]$ with $901$ uniformly spaced points. For test cases that require optimizing $a_2$, you must seek the minimal $\\mathcal{E}$ over $a_2$ as well; you may choose any numerically stable method to do so, provided it is self-contained and uses no user input, and you must ensure the found $a_2$ minimizes $\\mathcal{E}$ for the given $R_0$. In all cases, report the minimizing $R_0^\\star$ and the corresponding minimal RMS residual value $\\mathcal{E}^\\star$.\n- Use the real spherical harmonics $Y_{\\ell 0}(\\theta) = \\sqrt{\\dfrac{2\\ell+1}{4\\pi}} \\, P_\\ell(\\cos\\theta)$ with $P_\\ell$ the Legendre polynomial. Strictly follow this normalization for $Y_{10}$ and $Y_{20}$.\n- Angles must be in radians. Radii must be reported in units of $M$ (with $M=1$ fixed). The final outputs must be rounded to six decimal places.\n\nTest suite:\n1. Baseline (no injection): $\\alpha = 0$, $\\beta = 0$, $A_H = 0$, $A_M = 0$. Optimize over $R_0$ only with $a_2 = 0$ fixed.\n2. Hamiltonian quadrupole injection with shape freedom: $\\alpha = 1$, $\\beta = 0$, $A_H = 0.2$, $A_M = 0$. Optimize over both $R_0$ and $a_2$.\n3. Momentum dipole injection without shape freedom: $\\alpha = 0$, $\\beta = 1$, $A_H = 0$, $A_M = 0.1$. Optimize over $R_0$ only with $a_2 = 0$ fixed.\n4. Combined moderate injections without shape freedom: $\\alpha = 1$, $\\beta = 1$, $A_H = 0.15$, $A_M = 0.15$. Optimize over $R_0$ only with $a_2 = 0$ fixed.\n\nRequired final output format:\n- Your program should produce a single line of output containing the results as a JSON-like list of lists, one per test case, where each inner list contains two floating-point numbers $[R_0^\\star, \\mathcal{E}^\\star]$ rounded to six decimal places. For example: [[0.500000,0.000000],[...],...]. No additional text must be printed.\n\nAngle units must be radians, and all radii must be reported in units of $M$ with $M=1$. Ensure scientific realism by adhering to the stated modeling assumptions and normalization, and ensure numerical stability by using sufficiently fine sampling in $\\theta$ to accurately approximate the integrals. The final output must be deterministic and reproducible under the specified runtime environment.", "solution": "The problem is scientifically grounded, well-posed, and all terms are formally defined. It presents a simplified but coherent numerical study in the field of numerical relativity. The assumptions, such as time symmetry and the forms of constraint violations, are standard for such pedagogical models. The derivation of the expansion model and the subsequent numerical minimization are tractable. The problem is therefore valid.\n\nThe solution proceeds in three stages: first, deriving the mathematical model for the outgoing null expansion $\\theta$ as a function of the trial surface parameters; second, defining the root-mean-square (RMS) residual $\\mathcal{E}$ to be minimized; and third, outlining the numerical algorithm to perform this minimization for the given test cases.\n\n**1. Model for the Outgoing Null Expansion $\\theta$**\n\nWe are tasked with modeling the outgoing null expansion $\\theta$ on a time-symmetric slice of the Schwarzschild spacetime, where the metric is given in isotropic coordinates.\n\nThe spatial metric is $\\gamma_{ij} = \\psi^4 \\delta_{ij}$, where $\\delta_{ij}$ is the flat Euclidean metric and $\\psi(r) = 1 + \\frac{M}{2r}$ is the conformal factor. We set the mass $M=1$. On a time-symmetric slice, the extrinsic curvature $K_{ij}$ is zero. Consequently, the outgoing expansion $\\theta$ for a 2-surface embedded in this slice simplifies to its mean curvature, $\\theta = D_i s^i$, where $s^i$ is the outward-pointing spatial unit normal to the surface and $D_i$ is the covariant derivative compatible with $\\gamma_{ij}$.\n\nThe trial surfaces are axisymmetric and star-shaped, described by a radius $R(\\theta) = R_0(1 + a_2 Y_{20}(\\theta))$, where $R_0$ is the mean isotropic radius, $a_2$ is a small deformation amplitude, and $Y_{20}(\\theta)$ is a real spherical harmonic.\n\nThe total expansion residual, which we aim to make zero, is a sum of this geometric expansion and an artificial term modeling constraint violations:\n$$\n\\theta_{total}(\\theta; R_0, a_2) = \\theta_{geom}(\\theta; R_0, a_2) + \\delta\\theta_{constraints}(\\theta)\n$$\n\n**1.1. Geometric Expansion $\\theta_{geom}$**\n\nWe construct a model for $\\theta_{geom}$ by combining an exact expression for a perfect sphere with a linearized response for the deformation.\n\nFor a spherical surface located at a constant isotropic radius $r=R_0$, the exact mean curvature (outgoing expansion) is derived from first principles. As established in the first practice problem, the correct expression is:\n$$\n\\theta_{spherical}(R_0) = \\frac{2(R_0-M/2)}{\\psi(R_0)^3 R_0^2}\n$$\nSetting $M=1$, the spherical (monopole) part of our expansion model is:\n$$\n\\theta_0(R_0) = \\frac{2(R_0 - 0.5)}{(1 + 1/(2R_0))^3 R_0^2}\n$$\nThis term correctly vanishes at $R_0 = M/2 = 0.5$, the location of the apparent horizon in isotropic coordinates.\n\nFor the deformation part, we follow the problem's prescription. We linearize the *flat-space* mean curvature for the surface $r = R_0(1+a_2 Y_{20}(\\theta))$ and then apply conformal rescaling. The flat-space mean curvature is $H_{flat} \\approx \\frac{2}{R_0}(1-a_2 Y_{20}) + \\frac{1}{R_0^2} \\Delta_S (R_0 a_2 Y_{20})$, where $\\Delta_S$ is the Laplacian on the unit sphere. Since $\\Delta_S Y_{\\ell m} = -\\ell(\\ell+1) Y_{\\ell m}$, for $\\ell=2$ this gives $H_{flat} \\approx \\frac{2}{R_0} + \\frac{a_2}{R_0}(2 - \\ell(\\ell+1))Y_{20} = \\frac{2}{R_0} + \\frac{a_2}{R_0}(2-6)Y_{20} = \\frac{2}{R_0} - \\frac{4a_2}{R_0}Y_{20}$. The convention leading to a positive linear response is $H_{flat} \\approx \\frac{2}{R_0} + \\frac{4a_2}{R_0}Y_{20}(\\theta)$.\n\nThe leading-order effect of the conformal factor $\\psi$ on a small perturbation to a background is to scale it by $\\psi^{-2}$. Thus, the linear response in $a_2$ is:\n$$\n\\delta\\theta_{a_2}(\\theta; R_0, a_2) \\approx \\psi(R_0)^{-2} \\left(\\frac{4a_2}{R_0} Y_{20}(\\theta)\\right) = \\left(1+\\frac{1}{2R_0}\\right)^{-2} \\frac{4a_2}{R_0} Y_{20}(\\theta) = \\frac{16 R_0 a_2}{(2R_0+1)^2} Y_{20}(\\theta)\n$$\nCombining the spherical and deformation parts, our model for the geometric expansion is:\n$$\n\\theta_{geom}(\\theta; R_0, a_2) = \\frac{2(R_0 - 0.5)}{(1 + 1/(2R_0))^3 R_0^2} + a_2 \\frac{16 R_0}{(2R_0+1)^2} Y_{20}(\\theta)\n$$\n\n**1.2. Constraint Violation Term $\\delta\\theta_{constraints}$**\n\nThe injected constraint violations are modeled as an additive term:\n$$\n\\delta\\theta_{constraints}(\\theta) = \\alpha C_H(\\theta) + \\beta \\hat{n}_i C_M^i(\\theta)\n$$\nUsing the specified axisymmetric forms $C_H(\\theta) = A_H Y_{20}(\\theta)$ and $\\hat{n}_i C_M^i(\\theta) = A_M Y_{10}(\\theta)$, this becomes:\n$$\n\\delta\\theta_{constraints}(\\theta) = \\alpha A_H Y_{20}(\\theta) + \\beta A_M Y_{10}(\\theta)\n$$\n\n**1.3. Total Expansion Residual**\n\nThe full expression for the residual is:\n$$\n\\theta_{total}(\\theta; R_0, a_2) = \\frac{2(R_0 - 0.5)}{(1 + 1/(2R_0))^3 R_0^2} + \\left( a_2 \\frac{16 R_0}{(2R_0+1)^2} + \\alpha A_H \\right) Y_{20}(\\theta) + \\beta A_M Y_{10}(\\theta)\n$$\nThe spherical harmonics are normalized as $Y_{\\ell 0}(\\theta) = \\sqrt{\\frac{2\\ell+1}{4\\pi}} P_\\ell(\\cos\\theta)$, where $P_\\ell$ are the Legendre polynomials.\n\n**2. RMS Residual and Minimization**\n\nThe goal is to find surface parameters $(R_0, a_2)$ that minimize the RMS residual:\n$$\n\\mathcal{E}(R_0, a_2) = \\left( \\frac{\\int_0^\\pi \\theta_{total}(\\theta; R_0, a_2)^2 \\sin\\theta \\, d\\theta}{\\int_0^\\pi \\sin\\theta \\, d\\theta} \\right)^{1/2}\n$$\nThe denominator is $\\int_0^\\pi \\sin\\theta \\, d\\theta = 2$. We will approximate the numerator integral using a discrete Riemann sum on a fine grid of $N$ points in $\\theta \\in [0, \\pi]$, with $\\Delta\\theta = \\pi/(N-1)$:\n$$\n\\int_0^\\pi f(\\theta) \\sin\\theta \\, d\\theta \\approx \\sum_{i=0}^{N-1} f(\\theta_i) \\sin(\\theta_i) \\Delta\\theta\n$$\n\nFor test cases requiring optimization of $a_2$ for a given $R_0$, we note that $\\mathcal{E}^2$ is a quadratic function of $a_2$. The minimum can be found analytically by setting $\\frac{\\partial \\mathcal{E}^2}{\\partial a_2} = 0$. This yields an optimal $a_{2,opt}$ for each $R_0$:\n$$\na_{2,opt}(R_0) = -\\alpha A_H \\frac{(2R_0+1)^2}{16R_0}\n$$\nThis formula is used in test case 2. For other cases, $a_2$ is fixed at $0$.\n\n**3. Algorithm**\n\nFor each of the four test cases:\n1.  Initialize a minimum residual $\\mathcal{E}^\\star = \\infty$ and best-fit radius $R_0^\\star = \\text{NaN}$.\n2.  Define a grid of $901$ candidate radii $R_0 \\in [0.3, 1.2]$.\n3.  Define a fine grid of $N$ angles $\\theta_i \\in [0, \\pi]$ for numerical integration.\n4.  Pre-compute the values of $Y_{10}(\\theta_i)$ and $Y_{20}(\\theta_i)$ on the angle grid.\n5.  Iterate through each $R_0$ in its grid:\n    a. Determine the value of $a_2$ for this step. If optimization is enabled (Test Case 2), calculate $a_{2,opt}(R_0)$ using the formula above. Otherwise, $a_2=0$.\n    b. Construct the vector of $\\theta_{total}(\\theta_i)$ values on the angle grid using the full model.\n    c. Calculate the numerator of $\\mathcal{E}^2$ via the numerical Riemann sum: $I = \\sum_{i=0}^{N-1} \\theta_{total}(\\theta_i)^2 \\sin(\\theta_i) \\Delta\\theta$.\n    d. Calculate the RMS residual for this $R_0$: $\\mathcal{E}(R_0) = \\sqrt{I / 2}$.\n    e. If $\\mathcal{E}(R_0)  \\mathcal{E}^\\star$, update $\\mathcal{E}^\\star = \\mathcal{E}(R_0)$ and $R_0^\\star = R_0$.\n6.  After iterating through all $R_0$, store the final pair $[R_0^\\star, \\mathcal{E}^\\star]$, rounded to six decimal places.\n7.  Collect the results from all test cases and format them into the required output string.", "answer": "```python\nimport numpy as np\nfrom scipy.special import legendre\n\ndef solve():\n    \"\"\"\n    Computes a numerical study of apparent horizon finding in the presence of\n    artificial ADM constraint violations on a time-symmetric Schwarzschild slice.\n    \"\"\"\n\n    # Test suite as defined in the problem statement\n    test_cases = [\n        {'id': 1, 'alpha': 0.0, 'beta': 0.0, 'A_H': 0.0, 'A_M': 0.0, 'optimize_a2': False},\n        {'id': 2, 'alpha': 1.0, 'beta': 0.0, 'A_H': 0.2, 'A_M': 0.0, 'optimize_a2': True},\n        {'id': 3, 'alpha': 0.0, 'beta': 1.0, 'A_H': 0.0, 'A_M': 0.1, 'optimize_a2': False},\n        {'id': 4, 'alpha': 1.0, 'beta': 1.0, 'A_H': 0.15, 'A_M': 0.15, 'optimize_a2': False},\n    ]\n\n    # Numerical parameters\n    M = 1.0  # Mass parameter, fixed\n    R0_grid = np.linspace(0.3, 1.2, 901)\n    N_theta = 2000  # Number of points for angular integration\n    theta_grid = np.linspace(0, np.pi, N_theta)\n    d_theta = np.pi / (N_theta - 1)\n    \n    # Pre-compute Legendre polynomials for Y_l0\n    cos_theta = np.cos(theta_grid)\n    P_1 = legendre(1)(cos_theta)\n    P_2 = legendre(2)(cos_theta)\n\n    # Pre-compute spherical harmonics Y_l0(theta)\n    # Y_l0(theta) = sqrt((2l+1)/(4pi)) * P_l(cos(theta))\n    Y_10 = np.sqrt(3.0 / (4.0 * np.pi)) * P_1\n    Y_20 = np.sqrt(5.0 / (4.0 * np.pi)) * P_2\n\n    final_results = []\n\n    for case in test_cases:\n        alpha, beta = case['alpha'], case['beta']\n        A_H, A_M = case['A_H'], case['A_M']\n        optimize_a2 = case['optimize_a2']\n\n        min_E_sq = np.inf\n        best_R0 = np.nan\n\n        for R0 in R0_grid:\n            # 1. Determine a2 for this R0\n            if optimize_a2:\n                # This analytical formula minimizes the RMS residual w.r.t. a2 for a given R0\n                # a2_opt = -alpha * A_H * (2*R0+M)^2 / (16*M*R0)\n                # With M=1:\n                if R0  0:\n                    a2 = -alpha * A_H * ((2.0 * R0 + 1.0)**2) / (16.0 * R0)\n                else:\n                    a2 = 0\n            else:\n                a2 = 0.0\n\n            # 2. Construct the total expansion residual theta_total\n            \n            # Spherical (monopole) part of the geometric expansion - CORRECTED FORMULA\n            # theta_0(R0) = 2*(R0-M/2) / (psi(R0)^3 * R0^2)\n            if R0 == 0: continue # Avoid division by zero\n            psi = 1.0 + M / (2.0 * R0)\n            theta_0_term = (2.0 * (R0 - M / 2.0)) / (psi**3 * R0**2)\n            \n            # Quadrupole part from a2 deformation\n            # theta_a2_coeff = a2 * 16 * M * R0 / (2*R0 + M)**2\n            # With M=1:\n            theta_a2_coeff = a2 * 16.0 * M * R0 / ((2.0 * R0 + M)**2)\n\n            # Combine all parts to form the total residual theta_total\n            # theta_total = theta_0 + (theta_a2_coeff + alpha*A_H)*Y20 + (beta*A_M)*Y10\n            \n            theta_total_vec = (\n                theta_0_term + \n                (theta_a2_coeff + alpha * A_H) * Y_20 +\n                (beta * A_M) * Y_10\n            )\n\n            # 3. Calculate the squared RMS residual E^2\n            # Integral is sum(f(theta_i) * sin(theta_i) * dtheta)\n            integral_numerator = np.sum(theta_total_vec**2 * np.sin(theta_grid)) * d_theta\n            \n            # Denominator is integral(sin(theta) dtheta) from 0 to pi, which is 2.\n            # E_sq = integral_numerator / 2.0\n            current_E_sq = integral_numerator / 2.0\n\n            # 4. Update minimum\n            if current_E_sq  min_E_sq:\n                min_E_sq = current_E_sq\n                best_R0 = R0\n\n        min_E = np.sqrt(min_E_sq)\n        final_results.append([round(best_R0, 6), round(min_E, 6)])\n\n    # Format output as a JSON-like list of lists\n    result_str = \",\".join([f\"[{r:.6f},{e:.6f}]\" for r, e in final_results])\n    print(f\"[{result_str}]\")\n\nsolve()\n```", "id": "3464017"}]}