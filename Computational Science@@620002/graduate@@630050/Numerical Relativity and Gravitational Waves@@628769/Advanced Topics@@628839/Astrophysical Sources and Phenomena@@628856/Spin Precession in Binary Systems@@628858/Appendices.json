{"hands_on_practices": [{"introduction": "Understanding spin precession begins with deriving the equations of motion from the underlying post-Newtonian Hamiltonian. This exercise guides you through this fundamental calculation for a simplified binary system, providing a direct link between the theoretical framework and the resulting dynamics. By computing the spin and orbital precession vectors, you will solidify your grasp of the leading-order spin-orbit coupling that governs this fascinating relativistic effect. [@problem_id:3487484]", "problem": "Consider a compact binary with equal component masses $m_1=m_2=m$ in a strictly circular orbit of constant separation $r$. Assume that only body $1$ carries spin, with dimensionless spin parameter $\\chi_1$ defined by the relation $S_1 = \\chi_1 \\frac{G m_1^2}{c}$, where $S_1$ is the magnitude of the spin angular momentum of body $1$, $G$ is the gravitational constant, and $c$ is the speed of light. Neglect spin-spin interactions and gravitational radiation reaction, and work at leading order in the post-Newtonian (PN) spin-orbit coupling. Use the Hamiltonian formulation in which the spin-orbit interaction Hamiltonian has the leading-order form\n$$\nH_{\\mathrm{SO}} = \\frac{G}{c^2 r^3} \\,\\mathbf{L}\\cdot\\left[\\left(2+\\frac{3}{2}\\frac{m_2}{m_1}\\right)\\mathbf{S}_1+\\left(2+\\frac{3}{2}\\frac{m_1}{m_2}\\right)\\mathbf{S}_2\\right],\n$$\nwhere $\\mathbf{L}$ is the orbital angular momentum and $\\mathbf{S}_i$ are the spin vectors. The spin precession equations are $d\\mathbf{S}_i/dt = \\boldsymbol{\\Omega}_i\\times \\mathbf{S}_i$ with $\\boldsymbol{\\Omega}_i = \\partial H_{\\mathrm{SO}}/\\partial \\mathbf{S}_i$, and orbital angular momentum evolves according to $d\\mathbf{L}/dt = \\boldsymbol{\\Omega}_L \\times \\mathbf{L}$ in the conservative limit.\n\nAdopt an inertial Cartesian frame in which the orbital angular momentum points along the $+\\hat{\\mathbf{z}}$-axis, so $\\mathbf{L}=L\\,\\hat{\\mathbf{z}}$, with the Newtonian circular-orbit magnitude $L=\\mu\\sqrt{GMr}$, where $M=m_1+m_2$ is the total mass and $\\mu=m_1 m_2/M$ is the reduced mass. Let the spin of body $1$ be inclined by an angle $\\theta_{1L}$ with respect to $\\mathbf{L}$, lying in the $\\hat{\\mathbf{x}}$-$\\hat{\\mathbf{z}}$ plane, so that $\\hat{\\mathbf{S}}_1=\\sin\\theta_{1L}\\,\\hat{\\mathbf{x}}+\\cos\\theta_{1L}\\,\\hat{\\mathbf{z}}$ and $\\mathbf{S}_1=S_1\\,\\hat{\\mathbf{S}}_1$. Set $\\mathbf{S}_2=\\mathbf{0}$.\n\nUsing the above framework, derive from first principles the leading-order expressions for the spin precession vector $\\boldsymbol{\\Omega}_1$ and the orbital precession vector $\\boldsymbol{\\Omega}_L$ for $m_1=m_2$, and evaluate them numerically for the following parameter values:\n- $m_1=m_2=30\\,M_{\\odot}$ with $M_{\\odot}=1.98847\\times 10^{30}\\,\\mathrm{kg}$,\n- $r=1.0\\times 10^{9}\\,\\mathrm{m}$,\n- $\\chi_1=0.7$,\n- $\\theta_{1L}=0.6\\,\\mathrm{rad}$,\n- $G=6.67430\\times 10^{-11}\\,\\mathrm{m}^3\\,\\mathrm{kg}^{-1}\\,\\mathrm{s}^{-2}$,\n- $c=2.99792458\\times 10^{8}\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$.\n\nProvide the components $(\\Omega_{1x},\\Omega_{1y},\\Omega_{1z},\\Omega_{Lx},\\Omega_{Ly},\\Omega_{Lz})$ in radians per second. Round your numerical results to four significant figures. The final answer must be a single row matrix containing these six numbers.", "solution": "The user wants me to solve a physics problem.\n\n### Step 1: Extract Givens\n-   **System**: Compact binary with equal component masses, $m_1=m_2=m$.\n-   **Orbit**: Strictly circular, constant separation $r$.\n-   **Spin**: Only body $1$ carries spin, so $\\mathbf{S}_2 = \\mathbf{0}$. The spin magnitude of body $1$ is $S_1 = \\chi_1 \\frac{G m_1^2}{c}$.\n-   **Approximations**: Neglect spin-spin interactions and gravitational radiation reaction. Work at leading order in post-Newtonian (PN) spin-orbit (SO) coupling.\n-   **Hamiltonian**: The SO interaction Hamiltonian is $H_{\\mathrm{SO}} = \\frac{G}{c^2 r^3} \\,\\mathbf{L}\\cdot\\left[\\left(2+\\frac{3}{2}\\frac{m_2}{m_1}\\right)\\mathbf{S}_1+\\left(2+\\frac{3}{2}\\frac{m_1}{m_2}\\right)\\mathbf{S}_2\\right]$.\n-   **Equations of Motion**:\n    -   Spin precession: $d\\mathbf{S}_i/dt = \\boldsymbol{\\Omega}_i\\times \\mathbf{S}_i$, with $\\boldsymbol{\\Omega}_i = \\partial H_{\\mathrm{SO}}/\\partial \\mathbf{S}_i$.\n    -   Orbital precession: $d\\mathbf{L}/dt = \\boldsymbol{\\Omega}_L \\times \\mathbf{L}$.\n-   **Coordinate System and Vectors**:\n    -   Inertial Cartesian frame.\n    -   Orbital angular momentum: $\\mathbf{L}=L\\,\\hat{\\mathbf{z}}$.\n    -   Magnitude of $\\mathbf{L}$: $L=\\mu\\sqrt{GMr}$, with total mass $M=m_1+m_2$ and reduced mass $\\mu=m_1 m_2/M$.\n    -   Spin vector of body $1$: $\\mathbf{S}_1$ lies in the $\\hat{\\mathbf{x}}$-$\\hat{\\mathbf{z}}$ plane, inclined by $\\theta_{1L}$ to $\\mathbf{L}$. $\\hat{\\mathbf{S}}_1=\\sin\\theta_{1L}\\,\\hat{\\mathbf{x}}+\\cos\\theta_{1L}\\,\\hat{\\mathbf{z}}$ and $\\mathbf{S}_1=S_1\\,\\hat{\\mathbf{S}}_1$.\n-   **Task**:\n    1.  Derive expressions for $\\boldsymbol{\\Omega}_1$ and $\\boldsymbol{\\Omega}_L$ for $m_1=m_2$.\n    2.  Evaluate them numerically for the given parameters.\n-   **Numerical Values**:\n    -   $m_1=m_2=30\\,M_{\\odot}$\n    -   $M_{\\odot}=1.98847\\times 10^{30}\\,\\mathrm{kg}$\n    -   $r=1.0\\times 10^{9}\\,\\mathrm{m}$\n    -   $\\chi_1=0.7$\n    -   $\\theta_{1L}=0.6\\,\\mathrm{rad}$\n    -   $G=6.67430\\times 10^{-11}\\,\\mathrm{m}^3\\,\\mathrm{kg}^{-1}\\,\\mathrm{s}^{-2}$\n    -   $c=2.99792458\\times 10^{8}\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$\n-   **Output Format**: A single row matrix of the six components $(\\Omega_{1x},\\Omega_{1y},\\Omega_{1z},\\Omega_{Lx},\\Omega_{Ly},\\Omega_{Lz})$ in $\\mathrm{rad/s}$, rounded to four significant figures.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, rooted in the post-Newtonian approximation to general relativity, which is a standard and well-verified framework for describing binary systems. The provided Hamiltonian is the standard leading-order spin-orbit interaction Hamiltonian. The equations of motion are standard Hamiltonian equations for precession. The problem is well-posed; it provides all necessary definitions, constants, and initial conditions to uniquely determine the quantities requested. The definition of $\\boldsymbol{\\Omega}_L$ is not explicitly given in terms of the Hamiltonian, unlike $\\boldsymbol{\\Omega}_i$. However, in Hamiltonian mechanics, the evolution of a phase-space variable is determined by its Poisson bracket with the Hamiltonian. For angular momentum vectors, this leads to precession equations where the precession frequency vector is given by the partial derivative of the Hamiltonian with respect to the corresponding angular momentum vector. Thus, the natural and consistent \"first principles\" definition is $\\boldsymbol{\\Omega}_L = \\partial H_{\\mathrm{SO}}/\\partial \\mathbf{L}$. This makes the problem fully specified. The language is objective and precise. The physical parameters are realistic for a stellar-mass binary black hole system. The problem is a standard calculation in gravitational wave astrophysics and is neither trivial nor ill-posed.\n\n### Step 3: Verdict and Action\nThe problem is valid. A detailed solution will be provided.\n\n### Analytical Derivation\n\nThe analysis begins with the spin-orbit Hamiltonian $H_{\\mathrm{SO}}$ provided:\n$$\nH_{\\mathrm{SO}} = \\frac{G}{c^2 r^3} \\,\\mathbf{L}\\cdot\\left[\\left(2+\\frac{3}{2}\\frac{m_2}{m_1}\\right)\\mathbf{S}_1+\\left(2+\\frac{3}{2}\\frac{m_1}{m_2}\\right)\\mathbf{S}_2\\right]\n$$\nThe problem specifies equal masses, $m_1=m_2=m$, and a non-spinning companion, $\\mathbf{S}_2=\\mathbf{0}$. Under these conditions, the Hamiltonian simplifies significantly. The mass ratios become $m_1/m_2 = 1$ and $m_2/m_1 = 1$.\n$$\nH_{\\mathrm{SO}} = \\frac{G}{c^2 r^3} \\,\\mathbf{L}\\cdot\\left[\\left(2+\\frac{3}{2}(1)\\right)\\mathbf{S}_1+\\left(2+\\frac{3}{2}(1)\\right)\\mathbf{0}\\right] = \\frac{7}{2}\\frac{G}{c^2 r^3}\\,\\mathbf{L}\\cdot\\mathbf{S}_1\n$$\n\n**1. Derivation of the spin precession vector $\\boldsymbol{\\Omega}_1$**\n\nThe spin precession vector for body $1$ is defined as $\\boldsymbol{\\Omega}_1 = \\partial H_{\\mathrm{SO}}/\\partial \\mathbf{S}_1$. Taking the partial derivative of the simplified Hamiltonian with respect to $\\mathbf{S}_1$:\n$$\n\\boldsymbol{\\Omega}_1 = \\frac{\\partial}{\\partial \\mathbf{S}_1} \\left( \\frac{7}{2}\\frac{G}{c^2 r^3}\\,\\mathbf{L}\\cdot\\mathbf{S}_1 \\right)\n$$\nFor a function of the form $f(\\mathbf{v}) = \\mathbf{A}\\cdot\\mathbf{v}$, the gradient is $\\nabla_{\\mathbf{v}} f = \\mathbf{A}$. Therefore,\n$$\n\\boldsymbol{\\Omega}_1 = \\frac{7}{2}\\frac{G}{c^2 r^3}\\,\\mathbf{L}\n$$\nGiven that $\\mathbf{L} = L\\,\\hat{\\mathbf{z}}$, the components of $\\boldsymbol{\\Omega}_1$ are:\n$$\n\\Omega_{1x} = 0, \\quad \\Omega_{1y} = 0, \\quad \\Omega_{1z} = \\frac{7}{2}\\frac{G L}{c^2 r^3}\n$$\n\n**2. Derivation of the orbital precession vector $\\boldsymbol{\\Omega}_L$**\n\nThe problem provides the kinematic relation $d\\mathbf{L}/dt = \\boldsymbol{\\Omega}_L \\times \\mathbf{L}$. The dynamical evolution of $\\mathbf{L}$ is governed by Hamiltonian mechanics. Analogous to the definition of $\\boldsymbol{\\Omega}_i$, the precession vector for $\\mathbf{L}$ is derived by differentiating the Hamiltonian with respect to $\\mathbf{L}$:\n$$\n\\boldsymbol{\\Omega}_L = \\frac{\\partial H_{\\mathrm{SO}}}{\\partial \\mathbf{L}} = \\frac{\\partial}{\\partial \\mathbf{L}} \\left( \\frac{7}{2}\\frac{G}{c^2 r^3}\\,\\mathbf{L}\\cdot\\mathbf{S}_1 \\right)\n$$\nThis yields:\n$$\n\\boldsymbol{\\Omega}_L = \\frac{7}{2}\\frac{G}{c^2 r^3}\\,\\mathbf{S}_1\n$$\nWe can verify that this definition is consistent. The total angular momentum is $\\mathbf{J} = \\mathbf{L} + \\mathbf{S}_1 + \\mathbf{S}_2$. Since $\\mathbf{S}_2 = \\mathbf{0}$ and we neglect radiation, $\\mathbf{J}=\\mathbf{L}+\\mathbf{S}_1$ is conserved, so $d\\mathbf{J}/dt=\\mathbf{0}$.\n$d\\mathbf{L}/dt = \\boldsymbol{\\Omega}_L \\times \\mathbf{L} = \\left(\\frac{7}{2}\\frac{G}{c^2 r^3}\\,\\mathbf{S}_1\\right) \\times \\mathbf{L} = \\frac{7}{2}\\frac{G}{c^2 r^3}\\,(\\mathbf{S}_1 \\times \\mathbf{L})$.\n$d\\mathbf{S}_1/dt = \\boldsymbol{\\Omega}_1 \\times \\mathbf{S}_1 = \\left(\\frac{7}{2}\\frac{G}{c^2 r^3}\\,\\mathbf{L}\\right) \\times \\mathbf{S}_1 = \\frac{7}{2}\\frac{G}{c^2 r^3}\\,(\\mathbf{L} \\times \\mathbf{S}_1)$.\nSumming these gives $d\\mathbf{L}/dt + d\\mathbf{S}_1/dt = \\frac{7}{2}\\frac{G}{c^2 r^3}\\,(\\mathbf{S}_1 \\times \\mathbf{L} + \\mathbf{L} \\times \\mathbf{S}_1) = \\mathbf{0}$, which confirms $d\\mathbf{J}/dt = \\mathbf{0}$.\n\nThe vector $\\mathbf{S}_1$ is given by $\\mathbf{S}_1=S_1(\\sin\\theta_{1L}\\,\\hat{\\mathbf{x}}+\\cos\\theta_{1L}\\,\\hat{\\mathbf{z}})$. The components of $\\boldsymbol{\\Omega}_L$ are:\n$$\n\\Omega_{Lx} = \\frac{7}{2}\\frac{G S_1}{c^2 r^3}\\sin\\theta_{1L}, \\quad \\Omega_{Ly} = 0, \\quad \\Omega_{Lz} = \\frac{7}{2}\\frac{G S_1}{c^2 r^3}\\cos\\theta_{1L}\n$$\n\n### Numerical Evaluation\n\nFirst, we establish the values of all parameters and constants in SI units.\n-   $G = 6.67430 \\times 10^{-11}\\,\\mathrm{m}^3\\,\\mathrm{kg}^{-1}\\,\\mathrm{s}^{-2}$\n-   $c = 2.99792458 \\times 10^{8}\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$\n-   $M_{\\odot} = 1.98847 \\times 10^{30}\\,\\mathrm{kg}$\n-   $m = 30\\,M_{\\odot} = 30 \\times (1.98847 \\times 10^{30}) = 5.96541 \\times 10^{31}\\,\\mathrm{kg}$\n-   $r = 1.0 \\times 10^{9}\\,\\mathrm{m}$\n-   $\\chi_1 = 0.7$\n-   $\\theta_{1L} = 0.6\\,\\mathrm{rad}$\n\nNext, we calculate the magnitudes of the angular momenta.\n-   Total mass: $M = m_1 + m_2 = 2m = 1.193082 \\times 10^{32}\\,\\mathrm{kg}$.\n-   Reduced mass: $\\mu = \\frac{m_1 m_2}{M} = \\frac{m^2}{2m} = \\frac{m}{2} = 2.982705 \\times 10^{31}\\,\\mathrm{kg}$.\n-   Magnitude of orbital angular momentum $L$:\n    $$\n    L = \\mu\\sqrt{GMr} = (2.982705 \\times 10^{31}) \\sqrt{(6.67430 \\times 10^{-11})(1.193082 \\times 10^{32})(1.0 \\times 10^9)} \\approx 8.41505 \\times 10^{46}\\,\\mathrm{kg\\,m^2\\,s^{-1}}\n    $$\n-   Magnitude of spin angular momentum $S_1$:\n    $$\n    S_1 = \\chi_1 \\frac{G m^2}{c} = 0.7 \\times \\frac{(6.67430 \\times 10^{-11})(5.96541 \\times 10^{31})^2}{2.99792458 \\times 10^8} \\approx 5.54568 \\times 10^{44}\\,\\mathrm{kg\\,m^2\\,s^{-1}}\n    $$\n\nNow, we compute the precession vector components.\n-   The common pre-factor in our expressions is $C = \\frac{7}{2}\\frac{G}{c^2 r^3}$:\n    $$\n    C = \\frac{3.5 \\times (6.67430 \\times 10^{-11})}{(2.99792458 \\times 10^8)^2 (1.0 \\times 10^9)^3} \\approx 2.59927 \\times 10^{-54}\\,\\mathrm{kg^{-1}\\,m^{-2}\\,s}\n    $$\n-   Components of $\\boldsymbol{\\Omega}_1 = C\\,\\mathbf{L}$:\n    $$\n    \\Omega_{1x} = 0\n    $$\n    $$\n    \\Omega_{1y} = 0\n    $$\n    $$\n    \\Omega_{1z} = C \\times L \\approx (2.59927 \\times 10^{-54}) \\times (8.41505 \\times 10^{46}) \\approx 2.1873 \\times 10^{-7}\\,\\mathrm{rad/s}\n    $$\n-   Components of $\\boldsymbol{\\Omega}_L = C\\,\\mathbf{S}_1$:\n    We also need $\\sin(\\theta_{1L})$ and $\\cos(\\theta_{1L})$:\n    $\\sin(0.6) \\approx 0.564642$\n    $\\cos(0.6) \\approx 0.825336$\n    $$\n    \\Omega_{Lx} = C \\times S_1 \\sin\\theta_{1L} \\approx (2.59927 \\times 10^{-54}) \\times (5.54568 \\times 10^{44}) \\times 0.564642 \\approx 8.1388 \\times 10^{-10}\\,\\mathrm{rad/s}\n    $$\n    $$\n    \\Omega_{Ly} = 0\n    $$\n    $$\n    \\Omega_{Lz} = C \\times S_1 \\cos\\theta_{1L} \\approx (2.59927 \\times 10^{-54}) \\times (5.54568 \\times 10^{44}) \\times 0.825336 \\approx 1.1897 \\times 10^{-9}\\,\\mathrm{rad/s}\n    $$\n\nRounding the results to four significant figures:\n-   $\\Omega_{1x} = 0$\n-   $\\Omega_{1y} = 0$\n-   $\\Omega_{1z} = 2.187 \\times 10^{-7}\\,\\mathrm{rad/s}$\n-   $\\Omega_{Lx} = 8.139 \\times 10^{-10}\\,\\mathrm{rad/s}$\n-   $\\Omega_{Ly} = 0$\n-   $\\Omega_{Lz} = 1.190 \\times 10^{-9}\\,\\mathrm{rad/s}$\n\nThe final answer is the ordered set of these six components.", "answer": "$$\n\\boxed{\\begin{pmatrix} 0 & 0 & 2.187 \\times 10^{-7} & 8.139 \\times 10^{-10} & 0 & 1.190 \\times 10^{-9} \\end{pmatrix}}\n$$", "id": "3487484"}, {"introduction": "The precession of spins and the orbital plane can lead to complex and dynamically rich behaviors, such as transitional precession, where the total angular momentum can take on surprisingly small values. This practice moves from calculating the precession rates to analyzing their collective impact on the system's total angular momentum vector. By evaluating a key diagnostic for a specific configuration, you will learn to assess the potential for such exotic dynamics in a binary black hole system near its final plunge. [@problem_id:3487481]", "problem": "Consider a quasi-circular binary black hole system in geometric units where $G=c=1$. The component masses are $m_1$ and $m_2$ with mass ratio $q=m_1/m_2=2$, and the total mass is $M=m_1+m_2$. The (dimensionless) spin magnitudes are $\\chi_1=0.8$ and $\\chi_2=0.2$. Both spins are initially tilted by an angle of $45^\\circ$ relative to the orbital angular momentum direction, and their azimuthal directions coincide so that their in-plane components add. Work at leading order in the post-Newtonian (PN) regime for spin-orbit precession, assume the Newtonian expression for the orbital angular momentum of a circular orbit, treat the spin magnitudes as constant, and approximate the innermost stable circular orbit (ISCO) of the binary by the Schwarzschild value $r_{\\mathrm{ISCO}}=6M$. Let the orbital angular momentum magnitude be $L(r)=\\mu\\sqrt{Mr}$ for reduced mass $\\mu=m_1 m_2/M$, and let the spin magnitudes be $S_i=m_i^2 \\chi_i$ for $i\\in\\{1,2\\}$.\n\nTransitional precession is associated with the possibility that, as radiation reaction reduces the orbital angular momentum, the total angular momentum $\\mathbf{J}=\\mathbf{L}+\\mathbf{S}_1+\\mathbf{S}_2$ can become very small in magnitude when the spin component along $\\mathbf{L}$ is sufficiently anti-aligned to nearly cancel $L$. Using the assumptions above, compute the dimensionless diagnostic\n$$\nD \\equiv \\frac{|\\mathbf{J}|}{M^2}\n$$\nevaluated at $r=r_{\\mathrm{ISCO}}$, for the given masses and spins with the specified $45^\\circ$ tilts. Use this value to assess whether transitional precession can occur prior to reaching $r_{\\mathrm{ISCO}}$ in this configuration, but report only the value of $D$ as your final answer.\n\nRound your numerical result for $D$ to four significant figures. Express $D$ as a pure number (no units). Angles are given in radians or degrees as specified; here $45^\\circ$ denotes forty-five degrees.", "solution": "The problem statement is evaluated for validity.\n\n### Step 1: Extract Givens\n- System: Quasi-circular binary black hole.\n- Units: Geometric units, $G=c=1$.\n- Component masses: $m_1$, $m_2$.\n- Mass ratio: $q = m_1/m_2 = 2$.\n- Total mass: $M = m_1 + m_2$.\n- Dimensionless spin magnitudes: $\\chi_1 = 0.8$, $\\chi_2 = 0.2$.\n- Spin orientation: Both spins are initially tilted by an angle of $45^\\circ$ relative to the orbital angular momentum direction. Their azimuthal directions coincide so their in-plane components add.\n- Approximations: Leading order post-Newtonian (PN) for spin-orbit precession; Newtonian expression for orbital angular momentum of a circular orbit; constant spin magnitudes.\n- Innermost stable circular orbit (ISCO): Approximated as $r_{\\mathrm{ISCO}} = 6M$.\n- Orbital angular momentum magnitude: $L(r) = \\mu\\sqrt{Mr}$, where $\\mu = m_1 m_2 / M$.\n- Spin magnitude: $S_i = m_i^2 \\chi_i$ for $i \\in \\{1, 2\\}$.\n- Total angular momentum: $\\mathbf{J} = \\mathbf{L} + \\mathbf{S}_1 + \\mathbf{S}_2$.\n- Diagnostic quantity: $D \\equiv |\\mathbf{J}| / M^2$.\n- Evaluation point: $r = r_{\\mathrm{ISCO}}$.\n- Final output: Numerical value of $D$ rounded to four significant figures.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded**: The problem is set within the well-established framework of post-Newtonian theory applied to binary black holes in general relativity. All concepts, such as orbital and spin angular momenta, mass ratio, ISCO, and transitional precession, are standard in this field. The provided formulas for $L(r)$ and $S_i$ are correct for the specified physical context and units. The approximation $r_{\\mathrm{ISCO}}=6M$ is the standard Schwarzschild value, a common and acceptable simplification in such problems.\n- **Well-Posed**: The problem is fully specified. It provides all necessary parameters ($q$, $\\chi_1$, $\\chi_2$, the tilt angle), explicit formulas, and a clear objective: to compute a specific diagnostic quantity $D$ at a defined orbital separation. The structure allows for a unique, stable, and meaningful solution.\n- **Objective**: The problem is formulated with precise, unbiased, and formal language, free from any subjective or ambiguous terms.\n\n### Step 3: Verdict and Action\nThe problem is valid as it is scientifically grounded, self-contained, and well-posed. The solution process may proceed.\n\n### Solution Derivation\nThe objective is to compute the dimensionless diagnostic $D \\equiv |\\mathbf{J}| / M^2$ for the given binary black hole system at the innermost stable circular orbit (ISCO).\n\nFirst, we determine the individual masses $m_1$, $m_2$ and the reduced mass $\\mu$ in terms of the total mass $M$. Given the mass ratio $q = m_1/m_2 = 2$ and the total mass $M = m_1 + m_2$:\n$$m_1 = 2m_2$$\n$$M = 2m_2 + m_2 = 3m_2 \\implies m_2 = \\frac{1}{3}M, \\quad m_1 = \\frac{2}{3}M$$\nThe reduced mass $\\mu$ is:\n$$\\mu = \\frac{m_1 m_2}{m_1 + m_2} = \\frac{(\\frac{2}{3}M)(\\frac{1}{3}M)}{M} = \\frac{2}{9}M$$\n\nNext, we establish a coordinate system. Let the orbital angular momentum vector $\\mathbf{L}$ define the $z$-axis, so $\\mathbf{L} = L \\hat{\\mathbf{z}}$. The problem specifies the evaluation at $r = r_{\\mathrm{ISCO}} = 6M$. The magnitude of the orbital angular momentum $L$ at this separation is:\n$$L = L(r_{\\mathrm{ISCO}}) = \\mu\\sqrt{M r_{\\mathrm{ISCO}}} = \\left(\\frac{2}{9}M\\right)\\sqrt{M(6M)} = \\frac{2}{9}M\\sqrt{6M^2} = \\frac{2\\sqrt{6}}{9} M^2$$\n\nNow, we calculate the magnitudes of the spin angular momenta, $S_1$ and $S_2$:\n$$S_1 = m_1^2 \\chi_1 = \\left(\\frac{2}{3}M\\right)^2 (0.8) = \\frac{4}{9}M^2 (0.8) = \\frac{3.2}{9}M^2$$\n$$S_2 = m_2^2 \\chi_2 = \\left(\\frac{1}{3}M\\right)^2 (0.2) = \\frac{1}{9}M^2 (0.2) = \\frac{0.2}{9}M^2$$\nThe total spin magnitude is $S = S_1 + S_2 = \\frac{3.2+0.2}{9}M^2 = \\frac{3.4}{9}M^2$.\n\nThe spin vectors $\\mathbf{S}_1$ and $\\mathbf{S}_2$ are both tilted by an angle $\\theta = 45^\\circ$ with respect to $\\mathbf{L}$ (the $z$-axis). Their in-plane components add, which means they share the same azimuthal angle. We can align their common in-plane projection with the $x$-axis without loss of generality. Thus, the spin vectors can be written as:\n$$\\mathbf{S}_i = S_i (\\sin\\theta \\hat{\\mathbf{x}} + \\cos\\theta \\hat{\\mathbf{z}})$$\nThe total spin vector $\\mathbf{S} = \\mathbf{S}_1 + \\mathbf{S}_2$ is:\n$$\\mathbf{S} = (S_1 + S_2)(\\sin\\theta \\hat{\\mathbf{x}} + \\cos\\theta \\hat{\\mathbf{z}}) = S(\\sin\\theta \\hat{\\mathbf{x}} + \\cos\\theta \\hat{\\mathbf{z}})$$\nUsing $\\theta = 45^\\circ$, we have $\\sin(45^\\circ) = \\cos(45^\\circ) = 1/\\sqrt{2}$.\n$$\\mathbf{S} = \\frac{3.4}{9}M^2 \\left(\\frac{1}{\\sqrt{2}}\\hat{\\mathbf{x}} + \\frac{1}{\\sqrt{2}}\\hat{\\mathbf{z}}\\right) = \\frac{3.4}{9\\sqrt{2}}M^2 \\hat{\\mathbf{x}} + \\frac{3.4}{9\\sqrt{2}}M^2 \\hat{\\mathbf{z}}$$\n\nThe total angular momentum vector is $\\mathbf{J} = \\mathbf{L} + \\mathbf{S}$:\n$$\\mathbf{J} = (L\\hat{\\mathbf{z}}) + (S\\sin\\theta\\hat{\\mathbf{x}} + S\\cos\\theta\\hat{\\mathbf{z}}) = (S\\sin\\theta)\\hat{\\mathbf{x}} + (L + S\\cos\\theta)\\hat{\\mathbf{z}}$$\nSubstituting the expressions for $L$ and $S$:\n$$\\mathbf{J} = \\left(\\frac{3.4}{9}M^2 \\frac{1}{\\sqrt{2}}\\right)\\hat{\\mathbf{x}} + \\left(\\frac{2\\sqrt{6}}{9}M^2 + \\frac{3.4}{9}M^2 \\frac{1}{\\sqrt{2}}\\right)\\hat{\\mathbf{z}}$$\n\nThe squared magnitude of the total angular momentum, $|\\mathbf{J}|^2$, is:\n$$|\\mathbf{J}|^2 = \\left(\\frac{3.4}{9\\sqrt{2}}M^2\\right)^2 + \\left(\\frac{2\\sqrt{6}}{9}M^2 + \\frac{3.4}{9\\sqrt{2}}M^2\\right)^2$$\nFactoring out common terms:\n$$|\\mathbf{J}|^2 = \\frac{M^4}{81} \\left[ \\left(\\frac{3.4}{\\sqrt{2}}\\right)^2 + \\left(2\\sqrt{6} + \\frac{3.4}{\\sqrt{2}}\\right)^2 \\right]$$\nLet's evaluate the terms inside the bracket. Let $A = 3.4/\\sqrt{2} = 1.7\\sqrt{2}$ and $B = 2\\sqrt{6}$.\n$$|\\mathbf{J}|^2 = \\frac{M^4}{81} [A^2 + (B+A)^2] = \\frac{M^4}{81} [A^2 + B^2 + 2AB + A^2] = \\frac{M^4}{81} [2A^2 + B^2 + 2AB]$$\n$A^2 = (1.7\\sqrt{2})^2 = 1.7^2 \\times 2 = 2.89 \\times 2 = 5.78$.\n$B^2 = (2\\sqrt{6})^2 = 4 \\times 6 = 24$.\n$2AB = 2(1.7\\sqrt{2})(2\\sqrt{6}) = 6.8\\sqrt{12} = 6.8(2\\sqrt{3}) = 13.6\\sqrt{3}$.\n$$|\\mathbf{J}|^2 = \\frac{M^4}{81} [2(5.78) + 24 + 13.6\\sqrt{3}] = \\frac{M^4}{81} [11.56 + 24 + 13.6\\sqrt{3}] = \\frac{M^4}{81} [35.56 + 13.6\\sqrt{3}]$$\n\nThe dimensionless diagnostic $D$ is given by $D = |\\mathbf{J}|/M^2$. Therefore, $D^2 = |\\mathbf{J}|^2/M^4$.\n$$D^2 = \\frac{1}{81} (35.56 + 13.6\\sqrt{3})$$\nNow we compute the numerical value:\n$$\\sqrt{3} \\approx 1.7320508$$\n$$D^2 \\approx \\frac{1}{81} (35.56 + 13.6 \\times 1.7320508) = \\frac{1}{81} (35.56 + 23.55589) = \\frac{59.11589}{81} \\approx 0.7298258$$\nTaking the square root to find $D$:\n$$D = \\sqrt{0.7298258} \\approx 0.8542984$$\nRounding to four significant figures, we get $D \\approx 0.8543$.\n\nTransitional precession occurs when $|\\mathbf{J}|$ becomes very small, implying $D \\ll 1$. The computed value $D \\approx 0.8543$ is of order unity, not close to zero. This is expected, as the spins are tilted by $45^\\circ$, giving a significant component aligned with $\\mathbf{L}$, which adds to $L$ rather than cancelling it. Therefore, for this specific configuration evaluated at $r=r_{\\mathrm{ISCO}}$, the system is not in a state of transitional precession.", "answer": "$$\n\\boxed{0.8543}\n$$", "id": "3487481"}, {"introduction": "While many theoretical examples assume simple circular orbits, real astrophysical binaries can be eccentric, complicating the calculation of long-term precession effects. This coding exercise challenges you to compute the orbit-averaged precession rate for an eccentric binary, comparing an exact result with approximations common in gravitational-wave modeling. This practice will sharpen your numerical skills and provide valuable insight into the sources and magnitudes of error that arise from model simplifications and gauge choices. [@problem_id:3487478]", "problem": "Consider a compact binary system with component masses $m_1$ and $m_2$ on a bound Newtonian Keplerian orbit with semi-major axis $a$ and eccentricity $e = 0.2$. Let $G$ denote the gravitational constant and $c$ the speed of light. Define the total mass $M = m_1 + m_2$, the reduced mass $\\mu = \\frac{m_1 m_2}{M}$, and the Newtonian specific orbital angular momentum magnitude $h = \\sqrt{G M a (1 - e^2)}$. The Newtonian orbital angular momentum magnitude is $L_\\mathrm{N} = \\mu h$. At leading-order spin-orbit coupling (first and a half order in the post-Newtonian expansion, also called $1.5$ post-Newtonian), the spin $\\mathbf{S}_1$ of body $1$ undergoes precession according to $\\frac{d \\mathbf{S}_1}{dt} = \\boldsymbol{\\Omega}_1 \\times \\mathbf{S}_1$, where the precession vector is aligned with the Newtonian orbital angular momentum direction and has magnitude\n$$\n\\Omega_1(t) = \\frac{G}{c^2} \\frac{K_1 L_\\mathrm{N}}{r(t)^3},\n$$\nwith $K_1 = 2 + \\tfrac{3}{2} \\frac{m_2}{m_1}$ and $r(t)$ the instantaneous relative separation. The Keplerian radial separation as a function of true anomaly $f$ is\n$$\nr(f) = \\frac{a(1 - e^2)}{1 + e \\cos f},\n$$\nand the time-true anomaly relation is given by Keplerâ€™s second law in the form\n$$\n\\frac{dt}{df} = \\frac{r(f)^2}{h}.\n$$\n\nYour task is to numerically evaluate and compare two formulations for the orbit-averaged precession rate of body $1$ over one orbital period, and to quantify the fractional differences attributable to truncation in eccentricity and to a model of coordinate gauge shift:\n\n1. An exact (within Newtonian orbital dynamics) analytic average computed from first principles by\n$$\n\\langle \\Omega_1 \\rangle_\\mathrm{exact} = \\frac{G}{c^2} K_1 L_\\mathrm{N} \\left\\langle r^{-3} \\right\\rangle,\n$$\nwhere the time-average over one orbital period is\n$$\n\\left\\langle r^{-3} \\right\\rangle = \\frac{1}{P} \\int_0^P r(t)^{-3} \\, dt,\n$$\nand $P$ is the orbital period.\n\n2. A numerical formulation that truncates the eccentricity expansion of the inverse radial factor by replacing $r(f)$ with its series expansion to second order in $e$,\n$$\nr_\\mathrm{tr}(f) = a(1 - e^2) \\left(1 - e \\cos f + e^2 \\cos^2 f \\right),\n$$\nand computes the corresponding average numerically using\n$$\n\\langle \\Omega_1 \\rangle_\\mathrm{trunc} = \\frac{\\int_0^{2\\pi} \\Omega_1^\\mathrm{tr}(f)\\,\\frac{dt_\\mathrm{tr}}{df} \\, df}{\\int_0^{2\\pi} \\frac{dt_\\mathrm{tr}}{df} \\, df},\n$$\nwhere\n$$\n\\Omega_1^\\mathrm{tr}(f) = \\frac{G}{c^2} \\frac{K_1 L_\\mathrm{N}}{r_\\mathrm{tr}(f)^3}, \\quad \\frac{dt_\\mathrm{tr}}{df} = \\frac{r_\\mathrm{tr}(f)^2}{h}.\n$$\n\nAdditionally, to model a coordinate gauge shift at first post-Newtonian order, consider a radially shifted coordinate\n$$\nr'(f) = r(f) + \\epsilon, \\quad \\epsilon = \\xi \\frac{G M}{c^2},\n$$\nwith $\\xi = 1$ a dimensionless constant representing an order unity difference between two coordinate gauges at this order. Use this to define a gauge-shifted numerical average\n$$\n\\langle \\Omega_1 \\rangle_\\mathrm{gauge} = \\frac{\\int_0^{2\\pi} \\Omega_1'(f)\\,\\frac{dt'}{df} \\, df}{\\int_0^{2\\pi} \\frac{dt'}{df} \\, df},\n$$\nwith\n$$\n\\Omega_1'(f) = \\frac{G}{c^2} \\frac{K_1 L_\\mathrm{N}}{r'(f)^3}, \\quad \\frac{dt'}{df} = \\frac{r'(f)^2}{h}.\n$$\n\nStarting only from the fundamental Keplerian dynamics above and the leading-order spin-orbit precession law, do the following:\n\n- Derive the analytic expression for $\\left\\langle r^{-3} \\right\\rangle$ needed in $\\langle \\Omega_1 \\rangle_\\mathrm{exact}$ without invoking any pre-known orbit-averaged formula for $\\left\\langle r^{-3} \\right\\rangle$.\n- Implement numerical quadrature over $f$ to evaluate the truncated and gauge-shifted averages.\n- For each case in the test suite below, compute:\n  - the exact analytic average precession rate $\\langle \\Omega_1 \\rangle_\\mathrm{exact}$ in radians per second,\n  - the fractional truncation difference\n    $$\n    \\delta_\\mathrm{trunc} = \\frac{\\left| \\langle \\Omega_1 \\rangle_\\mathrm{trunc} - \\langle \\Omega_1 \\rangle_\\mathrm{exact} \\right|}{\\langle \\Omega_1 \\rangle_\\mathrm{exact}},\n    $$\n  - the fractional gauge difference\n    $$\n    \\delta_\\mathrm{gauge} = \\frac{\\left| \\langle \\Omega_1 \\rangle_\\mathrm{gauge} - \\langle \\Omega_1 \\rangle_\\mathrm{exact} \\right|}{\\langle \\Omega_1 \\rangle_\\mathrm{exact}}.\n    $$\n\nUse the following constants in the International System of Units (SI): $G = 6.67430 \\times 10^{-11}\\,\\mathrm{m^3\\,kg^{-1}\\,s^{-2}}$, $c = 299792458\\,\\mathrm{m\\,s^{-1}}$, and the solar mass $M_\\odot = 1.98847 \\times 10^{30}\\,\\mathrm{kg}$. Angles must be in radians. Express all precession rates in radians per second, and express all fractional differences as decimals (not percentages).\n\nTest suite (all with $e = 0.2$ and $\\xi = 1$):\n- Case A (general): $m_1 = 35\\,M_\\odot$, $m_2 = 25\\,M_\\odot$, $a = \\tilde{A}\\,\\frac{G M}{c^2}$ with $\\tilde{A} = 200$.\n- Case B (boundary toward stronger field and unequal masses): $m_1 = 10\\,M_\\odot$, $m_2 = 1.4\\,M_\\odot$, $a = \\tilde{A}\\,\\frac{G M}{c^2}$ with $\\tilde{A} = 100$.\n- Case C (edge toward very weak field and equal masses): $m_1 = 50\\,M_\\odot$, $m_2 = 50\\,M_\\odot$, $a = \\tilde{A}\\,\\frac{G M}{c^2}$ with $\\tilde{A} = 10000$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case contributes a list of five floats in the following order:\n$$\n\\left[ \\langle \\Omega_1 \\rangle_\\mathrm{exact},\\, \\langle \\Omega_1 \\rangle_\\mathrm{trunc},\\, \\langle \\Omega_1 \\rangle_\\mathrm{gauge},\\, \\delta_\\mathrm{trunc},\\, \\delta_\\mathrm{gauge} \\right].\n$$\nThe overall output must therefore be a list of three such lists, one per test case, for example:\n$$\n\\left[ [x_{1},x_{2},x_{3},x_{4},x_{5}], [y_{1},y_{2},y_{3},y_{4},y_{5}], [z_{1},z_{2},z_{3},z_{4},z_{5}] \\right].\n$$", "solution": "The problem is valid as it is scientifically grounded in established principles of Newtonian celestial mechanics and post-Newtonian theory, is well-posed with sufficient information for a unique solution, and is stated objectively. All provided constants and equations are standard in the field of gravitational physics.\n\nThe primary objective is to compute and compare three different evaluations of the orbit-averaged spin precession rate, $\\langle \\Omega_1 \\rangle$, for the primary body in a compact binary system. The three evaluations are an exact analytic average, an average based on a truncated eccentricity expansion, and an average incorporating a coordinate gauge shift.\n\n### Part 1: Analytic Derivation of the Exact Average Precession Rate\n\nThe instantaneous precession rate is given by $\\Omega_1(t) = \\frac{G}{c^2} \\frac{K_1 L_\\mathrm{N}}{r(t)^3}$. The orbit-averaged rate is therefore\n$$\n\\langle \\Omega_1 \\rangle_\\mathrm{exact} = \\frac{1}{P} \\int_0^P \\Omega_1(t) \\, dt = \\frac{G K_1 L_\\mathrm{N}}{c^2} \\left( \\frac{1}{P} \\int_0^P r(t)^{-3} \\, dt \\right) = \\frac{G K_1 L_\\mathrm{N}}{c^2} \\left\\langle r^{-3} \\right\\rangle.\n$$\nThe core of the analytic calculation is the evaluation of the time-average $\\left\\langle r^{-3} \\right\\rangle$. The problem requires this to be derived from first principles. We perform a change of integration variable from time $t$ to true anomaly $f$, using the provided relation from Kepler's second law, $\\frac{dt}{df} = \\frac{r(f)^2}{h}$. The integration over one orbital period $P$ in time corresponds to an integration from $0$ to $2\\pi$ in true anomaly.\n\nThe integral in the numerator of the average becomes:\n$$\n\\int_0^P r(t)^{-3} \\, dt = \\int_0^{2\\pi} r(f)^{-3} \\frac{dt}{df} \\, df = \\int_0^{2\\pi} r(f)^{-3} \\frac{r(f)^2}{h} \\, df = \\frac{1}{h} \\int_0^{2\\pi} \\frac{1}{r(f)} \\, df.\n$$\nSubstituting the Keplerian orbit equation $r(f) = \\frac{a(1 - e^2)}{1 + e \\cos f}$:\n$$\n\\int_0^{2\\pi} \\frac{1}{r(f)} \\, df = \\int_0^{2\\pi} \\frac{1 + e \\cos f}{a(1 - e^2)} \\, df = \\frac{1}{a(1 - e^2)} \\left[ \\int_0^{2\\pi} 1 \\, df + e \\int_0^{2\\pi} \\cos f \\, df \\right].\n$$\nThe integral of $\\cos f$ over a full period is $0$, and the integral of $1$ is $2\\pi$. Thus,\n$$\n\\int_0^{2\\pi} \\frac{1}{r(f)} \\, df = \\frac{2\\pi}{a(1 - e^2)}.\n$$\nThe orbital period $P$ is given by Kepler's third law, $P = 2\\pi \\sqrt{\\frac{a^3}{GM}}$. For completeness, we can also derive this by integrating $dt$ over an orbit:\n$$\nP = \\int_0^P dt = \\int_0^{2\\pi} \\frac{dt}{df} \\, df = \\frac{1}{h} \\int_0^{2\\pi} r(f)^2 \\, df.\n$$\nUsing standard integral tables for celestial mechanics, $\\int_0^{2\\pi} r(f)^2 \\, df = 2\\pi a^2 \\sqrt{1-e^2}$. With $h = \\sqrt{GMa(1-e^2)}$, we find:\n$$\nP = \\frac{1}{\\sqrt{GMa(1-e^2)}} \\left( 2\\pi a^2 \\sqrt{1-e^2} \\right) = \\frac{2\\pi a^2}{\\sqrt{GMa}} = 2\\pi \\sqrt{\\frac{a^3}{GM}}.\n$$\nCombining these results to find $\\left\\langle r^{-3} \\right\\rangle$:\n$$\n\\left\\langle r^{-3} \\right\\rangle = \\frac{1}{P} \\left( \\frac{1}{h} \\int_0^{2\\pi} \\frac{1}{r(f)} \\, df \\right) = \\frac{1}{2\\pi \\sqrt{\\frac{a^3}{GM}}} \\frac{1}{\\sqrt{GMa(1-e^2)}} \\frac{2\\pi}{a(1 - e^2)}.\n$$\nSimplifying the expression:\n$$\n\\left\\langle r^{-3} \\right\\rangle = \\frac{\\sqrt{GM}}{2\\pi a^{3/2}} \\frac{1}{\\sqrt{GM} a^{1/2} \\sqrt{1-e^2}} \\frac{2\\pi}{a(1-e^2)} = \\frac{1}{a^2 \\sqrt{1-e^2}} \\frac{1}{a(1-e^2)} = \\frac{1}{a^3 (1-e^2)^{3/2}}.\n$$\nFinally, substituting this into the expression for $\\langle \\Omega_1 \\rangle_\\mathrm{exact}$:\n$$\n\\langle \\Omega_1 \\rangle_\\mathrm{exact} = \\frac{G K_1 L_\\mathrm{N}}{c^2} \\frac{1}{a^3 (1-e^2)^{3/2}} = \\frac{G K_1 (\\mu h)}{c^2 a^3 (1-e^2)^{3/2}}.\n$$\nUsing $h = \\sqrt{GMa(1-e^2)}$, we get the final analytic formula for implementation:\n$$\n\\langle \\Omega_1 \\rangle_\\mathrm{exact} = \\frac{G K_1 \\mu \\sqrt{GMa(1-e^2)}}{c^2 a^3 (1-e^2)^{3/2}} = \\frac{G K_1 \\mu \\sqrt{GM}}{\\ c^2 a^{5/2} (1-e^2)}.\n$$\n\n### Part 2: Formulation of Numerical Averages\n\nFor the truncated and gauge-shifted cases, the precession rate is averaged over the true anomaly $f$, weighted by the time element $dt/df$:\n$$\n\\langle \\Omega \\rangle = \\frac{\\int_0^{2\\pi} \\Omega(f) \\frac{dt}{df} \\, df}{\\int_0^{2\\pi} \\frac{dt}{df} \\, df}.\n$$\nFor a generic radial separation function $\\tilde{r}(f)$ and its corresponding time element $\\frac{d\\tilde{t}}{df} = \\frac{\\tilde{r}(f)^2}{h}$, the precession rate is $\\tilde{\\Omega}(f) = \\frac{G K_1 L_\\mathrm{N}}{c^2 \\tilde{r}(f)^3}$. The numerator of the average becomes:\n$$\n\\int_0^{2\\pi} \\tilde{\\Omega}(f) \\frac{d\\tilde{t}}{df} \\, df = \\int_0^{2\\pi} \\frac{G K_1 L_\\mathrm{N}}{c^2 \\tilde{r}(f)^3} \\frac{\\tilde{r}(f)^2}{h} \\, df = \\frac{G K_1 L_\\mathrm{N}}{c^2 h} \\int_0^{2\\pi} \\frac{1}{\\tilde{r}(f)} \\, df.\n$$\nThe denominator is the corresponding orbital period, $\\tilde{P} = \\int_0^{2\\pi} \\frac{\\tilde{r}(f)^2}{h} \\, df$. The factor of $h$ cancels, yielding the general form for the numerical averages:\n$$\n\\langle \\tilde{\\Omega}_1 \\rangle = \\frac{G K_1 L_\\mathrm{N}}{c^2} \\frac{\\int_0^{2\\pi} \\tilde{r}(f)^{-1} \\, df}{\\int_0^{2\\pi} \\tilde{r}(f)^2 \\, df}.\n$$\nThis formula is applied for both the truncated case, with $\\tilde{r}(f) = r_\\mathrm{tr}(f)$, and the gauge-shifted case, with $\\tilde{r}(f) = r'(f)$. The integrals are computed numerically.\n\n### Part 3: Algorithmic Implementation\n\nThe solution is implemented in Python. The procedure for each test case is as follows:\n1.  Define the physical constants $G$, $c$, and $M_\\odot$ in SI units.\n2.  For each test case $(\\text{mass } m_1, \\text{mass } m_2, \\text{semimajor axis parameter } \\tilde{A})$, convert masses from solar mass units to kilograms.\n3.  Calculate the total mass $M$, reduced mass $\\mu$, and semi-major axis $a = \\tilde{A} \\frac{GM}{c^2}$.\n4.  Calculate the Newtonian specific angular momentum $h$ and total angular momentum $L_\\mathrm{N}$.\n5.  Compute the constant $K_1 = 2 + \\frac{3}{2}\\frac{m_2}{m_1}$.\n6.  Calculate $\\langle \\Omega_1 \\rangle_\\mathrm{exact}$ using the derived analytic formula.\n7.  To find $\\langle \\Omega_1 \\rangle_\\mathrm{trunc}$, define the functions for the integrands $r_\\mathrm{tr}(f)^{-1}$ and $r_\\mathrm{tr}(f)^2$, where $r_\\mathrm{tr}(f) = a(1 - e^2) (1 - e \\cos f + e^2 \\cos^2 f)$. Numerically integrate these functions from $f=0$ to $f=2\\pi$ using `scipy.integrate.quad` and compute the average using the formula from Part 2.\n8.  To find $\\langle \\Omega_1 \\rangle_\\mathrm{gauge}$, define the integrands $r'(f)^{-1}$ and $r'(f)^2$, where $r'(f) = \\frac{a(1-e^2)}{1+e\\cos f} + \\epsilon$ and $\\epsilon = \\xi \\frac{GM}{c^2}$ with $\\xi=1$. Numerically integrate and compute the average as in the previous step.\n9.  Calculate the fractional differences $\\delta_\\mathrm{trunc} = \\frac{| \\langle \\Omega_1 \\rangle_\\mathrm{trunc} - \\langle \\Omega_1 \\rangle_\\mathrm{exact} |}{\\langle \\Omega_1 \\rangle_\\mathrm{exact}}$ and $\\delta_\\mathrm{gauge} = \\frac{| \\langle \\Omega_1 \\rangle_\\mathrm{gauge} - \\langle \\Omega_1 \\rangle_\\mathrm{exact} |}{\\langle \\Omega_1 \\rangle_\\mathrm{exact}}$.\n10. Collate the five results ($\\langle\\Omega_1\\rangle_\\mathrm{exact}$, $\\langle\\Omega_1\\rangle_\\mathrm{trunc}$, $\\langle\\Omega_1\\rangle_\\mathrm{gauge}$, $\\delta_\\mathrm{trunc}$, $\\delta_\\mathrm{gauge}$) for each case and format the final output as a list of lists.", "answer": "```python\nimport numpy as np\nfrom scipy import integrate\n\ndef solve():\n    \"\"\"\n    Computes and compares exact, truncated, and gauge-shifted orbit-averaged\n    spin precession rates for compact binary systems.\n    \"\"\"\n    # Physical Constants in SI units\n    G = 6.67430e-11  # Gravitational constant (m^3 kg^-1 s^-2)\n    c = 299792458.0   # Speed of light (m s^-1)\n    M_sun = 1.98847e30 # Solar mass (kg)\n\n    # Problem parameters\n    e = 0.2  # Eccentricity\n    xi = 1.0 # Gauge shift parameter\n\n    # Test suite: (m1_msun, m2_msun, a_tilde)\n    test_cases = [\n        (35.0, 25.0, 200.0),  # Case A\n        (10.0, 1.4, 100.0),   # Case B\n        (50.0, 50.0, 10000.0) # Case C\n    ]\n\n    results_all_cases = []\n\n    for m1_msun, m2_msun, a_tilde in test_cases:\n        # Step 1: Calculate basic system parameters\n        m1 = m1_msun * M_sun\n        m2 = m2_msun * M_sun\n        M = m1 + m2\n        mu = (m1 * m2) / M\n        \n        # Step 2: Calculate orbital parameters\n        a = a_tilde * G * M / c**2\n        h = np.sqrt(G * M * a * (1 - e**2))\n        L_N = mu * h\n        \n        # Step 3: Calculate precession coefficient K1\n        K1 = 2.0 + 1.5 * (m2 / m1)\n        \n        # Step 4: Calculate the exact analytic average precession rate\n        omega_1_exact = (G / c**2) * K1 * mu * np.sqrt(G * M) / (a**2.5 * (1 - e**2))\n        \n        # Step 5: Numerically evaluate the truncated average precession rate\n        def r_tr(f):\n            return a * (1 - e**2) * (1 - e * np.cos(f) + e**2 * np.cos(f)**2)\n            \n        def integrand_num_trunc(f):\n            return 1.0 / r_tr(f)\n            \n        def integrand_den_trunc(f):\n            return r_tr(f)**2\n            \n        num_int_trunc, _ = integrate.quad(integrand_num_trunc, 0, 2 * np.pi)\n        den_int_trunc, _ = integrate.quad(integrand_den_trunc, 0, 2 * np.pi)\n        \n        omega_1_trunc = (G / c**2) * K1 * L_N * (num_int_trunc / den_int_trunc)\n        \n        # Step 6: Numerically evaluate the gauge-shifted average precession rate\n        epsilon = xi * G * M / c**2\n        \n        def r_newtonian(f):\n            return a * (1 - e**2) / (1 + e * np.cos(f))\n            \n        def r_prime(f):\n            return r_newtonian(f) + epsilon\n            \n        def integrand_num_gauge(f):\n            return 1.0 / r_prime(f)\n            \n        def integrand_den_gauge(f):\n            return r_prime(f)**2\n            \n        num_int_gauge, _ = integrate.quad(integrand_num_gauge, 0, 2 * np.pi)\n        den_int_gauge, _ = integrate.quad(integrand_den_gauge, 0, 2 * np.pi)\n        \n        omega_1_gauge = (G / c**2) * K1 * L_N * (num_int_gauge / den_int_gauge)\n        \n        # Step 7: Calculate fractional differences\n        delta_trunc = abs(omega_1_trunc - omega_1_exact) / omega_1_exact\n        delta_gauge = abs(omega_1_gauge - omega_1_exact) / omega_1_exact\n        \n        # Step 8: Store results for the current case\n        case_results = [\n            omega_1_exact, \n            omega_1_trunc, \n            omega_1_gauge, \n            delta_trunc, \n            delta_gauge\n        ]\n        results_all_cases.append(case_results)\n\n    # Format the output string as a list of lists, with comma-separated values\n    # and no spaces within the inner lists, as per the specified format.\n    formatted_cases = []\n    for case in results_all_cases:\n        formatted_cases.append(f\"[{','.join(map(str, case))}]\")\n    \n    final_output = f\"[{','.join(formatted_cases)}]\"\n    print(final_output)\n\nsolve()\n```", "id": "3487478"}]}