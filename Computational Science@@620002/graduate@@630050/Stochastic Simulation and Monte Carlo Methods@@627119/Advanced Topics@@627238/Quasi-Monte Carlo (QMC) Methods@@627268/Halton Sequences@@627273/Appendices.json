{"hands_on_practices": [{"introduction": "A primary motivation for using Halton sequences is their superior uniformity compared to pseudo-random numbers. This exercise provides a direct, hands-on method to quantify this property for the projections of a low-dimensional sequence. By generating points and using a chi-square statistic to measure their distribution across a grid, you will gain a tangible understanding of what \"low discrepancy\" means in practice [@problem_id:3310926].", "problem": "Consider the $3$-dimensional Halton sequence with bases $(2,3,5)$ defined by the radical inverse construction. For each integer $n \\geq 1$, write $n$ in base $b$ as $n=\\sum_{k=0}^{K} a_k b^k$ with digits $a_k \\in \\{0,1,\\dots,b-1\\}$, and define the radical inverse function $\\phi_b(n)=\\sum_{k=0}^{K} a_k b^{-(k+1)}$. The $n$-th point of the $3$-dimensional Halton sequence is $H_n = \\big(\\phi_2(n),\\phi_3(n),\\phi_5(n)\\big)$.\n\nLet $N=16$ and $m=4$. For each of the three $2$-dimensional coordinate projections $(x,y)$, $(x,z)$, and $(y,z)$ of the first $N$ points $\\{H_n\\}_{n=1}^{N}$, partition the unit square $[0,1)^2$ into an $m \\times m$ axis-aligned grid of congruent cells using intervals $[k/m,(k+1)/m)$ along each axis for $k \\in \\{0,1,2,3\\}$. Let $C_{ij}^{(\\pi)}$ denote the count of projected points falling in cell $(i,j)$ for projection $\\pi \\in \\{xy,xz,yz\\}$, and let the expected count under the uniform distribution be $E = N/m^2$.\n\nDefine the Pearson chi-square statistic for projection $\\pi$ by\n$$\n\\chi^2_{\\pi} \\;=\\; \\sum_{i=0}^{m-1}\\sum_{j=0}^{m-1} \\frac{\\big(C_{ij}^{(\\pi)} - E\\big)^2}{E}.\n$$\nDefine the aggregate uniformity score as the sum across projections,\n$$\nS \\;=\\; \\chi^2_{xy} + \\chi^2_{xz} + \\chi^2_{yz}.\n$$\n\nCompute $S$ exactly for the first $N=16$ points of the Halton sequence with bases $(2,3,5)$. Your final answer must be a single real number with no units. No rounding is required.", "solution": "The user wants to compute an aggregate uniformity score, $S$, for the first $16$ points of a $3$-dimensional Halton sequence.\n\n### Step 1: Problem Validation\nThe problem statement provides a completely specified, self-contained mathematical task. All terms like Halton sequence, radical inverse function, and Pearson chi-square statistic are formally defined. The parameters are given as $N=16$ points, bases $(2,3,5)$, and a grid size of $m=4$. The task is to compute a single numerical value based on these definitions.\nThe problem is scientifically grounded in the fields of quasi-Monte Carlo methods and statistics. It is well-posed, objective, and contains no contradictions or ambiguities. Therefore, the problem is deemed valid.\n\n### Step 2: Calculation of Constants and Formulas\nThe total number of points is $N=16$.\nThe grid is an $m \\times m$ grid, where $m=4$.\nThe expected number of points per cell under a uniform distribution is $E = \\frac{N}{m^2} = \\frac{16}{4^2} = \\frac{16}{16} = 1$.\nThe Pearson chi-square statistic for a projection $\\pi$ simplifies to:\n$$\n\\chi^2_{\\pi} = \\sum_{i=0}^{m-1}\\sum_{j=0}^{m-1} \\frac{\\big(C_{ij}^{(\\pi)} - E\\big)^2}{E} = \\sum_{i=0}^{3}\\sum_{j=0}^{3} \\frac{\\big(C_{ij}^{(\\pi)} - 1\\big)^2}{1} = \\sum_{i=0}^{3}\\sum_{j=0}^{3} \\big(C_{ij}^{(\\pi)} - 1\\big)^2\n$$\nThe aggregate uniformity score is $S = \\chi^2_{xy} + \\chi^2_{xz} + \\chi^2_{yz}$.\n\n### Step 3: Generation of Halton Sequence Points and Binning\nWe need to generate the first $N=16$ points of the Halton sequence, $H_n = (\\phi_2(n), \\phi_3(n), \\phi_5(n))$, for $n=1, \\dots, 16$. The coordinates are then assigned to grid cells. A point $(u,v)$ falls in cell $(i,j)$ of the $4 \\times 4$ grid if $i = \\lfloor 4u \\rfloor$ and $j = \\lfloor 4v \\rfloor$. We compute the integer cell indices $(i_n, j_n, k_n)$ for each point $H_n = (x_n, y_n, z_n)$, where $i_n = \\lfloor 4x_n \\rfloor$, $j_n = \\lfloor 4y_n \\rfloor$, and $k_n = \\lfloor 4z_n \\rfloor$.\n\nThe table below summarizes the coordinates and their corresponding cell indices for $n=1, \\dots, 16$.\n\n| $n$ | $x_n = \\phi_2(n)$ | $y_n = \\phi_3(n)$ | $z_n = \\phi_5(n)$ | $i_n = \\lfloor 4x_n \\rfloor$ | $j_n = \\lfloor 4y_n \\rfloor$ | $k_n = \\lfloor 4z_n \\rfloor$ |\n|-----|:-----------------:|:-----------------:|:-----------------:|:----------------------------:|:----------------------------:|:----------------------------:|\n| 1   | $1/2$             | $1/3$             | $1/5$             | $2$                          | $1$                          | $0$                          |\n| 2   | $1/4$             | $2/3$             | $2/5$             | $1$                          | $2$                          | $1$                          |\n| 3   | $3/4$             | $1/9$             | $3/5$             | $3$                          | $0$                          | $2$                          |\n| 4   | $1/8$             | $4/9$             | $4/5$             | $0$                          | $1$                          | $3$                          |\n| 5   | $5/8$             | $7/9$             | $1/25$            | $2$                          | $3$                          | $0$                          |\n| 6   | $3/8$             | $2/9$             | $6/25$            | $1$                          | $0$                          | $0$                          |\n| 7   | $7/8$             | $5/9$             | $11/25$           | $3$                          | $2$                          | $1$                          |\n| 8   | $1/16$            | $8/9$             | $16/25$           | $0$                          | $3$                          | $2$                          |\n| 9   | $9/16$            | $1/27$            | $21/25$           | $2$                          | $0$                          | $3$                          |\n| 10  | $5/16$            | $10/27$           | $2/25$            | $1$                          | $1$                          | $0$                          |\n| 11  | $13/16$           | $19/27$           | $7/25$            | $3$                          | $2$                          | $1$                          |\n| 12  | $3/16$            | $4/27$            | $12/25$           | $0$                          | $0$                          | $1$                          |\n| 13  | $11/16$           | $13/27$           | $17/25$           | $2$                          | $1$                          | $2$                          |\n| 14  | $7/16$            | $22/27$           | $22/25$           | $1$                          | $3$                          | $3$                          |\n| 15  | $15/16$           | $7/27$            | $3/25$            | $3$                          | $1$                          | $0$                          |\n| 16  | $1/32$            | $16/27$           | $8/25$            | $0$                          | $2$                          | $1$                          |\n\n### Step 4: Construction of Count Matrices\nWe construct the $4 \\times 4$ count matrices $C_{ij}^{(\\pi)}$ for each projection $\\pi \\in \\{xy, xz, yz\\}$.\n\n- **Projection $\\pi=xy$**: We count the pairs $(i_n, j_n)$.\nThe row index corresponds to $i$ and the column index to $j$.\n$$\nC^{(xy)} = \\begin{pmatrix}\n1 & 1 & 1 & 1 \\\\\n1 & 1 & 1 & 1 \\\\\n1 & 2 & 0 & 1 \\\\\n1 & 1 & 2 & 0\n\\end{pmatrix}\n$$\nThe sum of entries is $12 \\times 1 + 1 \\times 2 + 1 \\times 0 + 1 \\times 1 + 1 \\times 2 + 1 \\times 0 = 16$.\n\n- **Projection $\\pi=xz$**: We count the pairs $(i_n, k_n)$.\nThe row index corresponds to $i$ and the column index to $k$.\n$$\nC^{(xz)} = \\begin{pmatrix}\n0 & 2 & 1 & 1 \\\\\n2 & 1 & 0 & 1 \\\\\n2 & 0 & 1 & 1 \\\\\n1 & 2 & 1 & 0\n\\end{pmatrix}\n$$\nThe sum of entries is $16$.\n\n- **Projection $\\pi=yz$**: We count the pairs $(j_n, k_n)$.\nThe row index corresponds to $j$ and the column index to $k$.\n$$\nC^{(yz)} = \\begin{pmatrix}\n1 & 1 & 1 & 1 \\\\\n3 & 0 & 1 & 1 \\\\\n0 & 4 & 0 & 0 \\\\\n1 & 0 & 1 & 1\n\\end{pmatrix}\n$$\nThe sum of entries is $16$.\n\n### Step 5: Calculation of Chi-Square Statistics\nWe compute the chi-square statistic for each projection using the formula $\\chi^2_{\\pi} = \\sum_{i,j} (C_{ij}^{(\\pi)} - 1)^2$.\n\n- For $\\chi^2_{xy}$:\nThe matrix $C^{(xy)}$ has twelve entries equal to $1$, two entries equal to $2$, and two entries equal to $0$.\n$$\n\\chi^2_{xy} = 12 \\times (1-1)^2 + 2 \\times (2-1)^2 + 2 \\times (0-1)^2 = 0 + 2 \\times 1 + 2 \\times 1 = 4\n$$\n\n- For $\\chi^2_{xz}$:\nThe matrix $C^{(xz)}$ has eight entries equal to $1$, four entries equal to $2$, and four entries equal to $0$.\n$$\n\\chi^2_{xz} = 8 \\times (1-1)^2 + 4 \\times (2-1)^2 + 4 \\times (0-1)^2 = 0 + 4 \\times 1 + 4 \\times 1 = 8\n$$\n\n- For $\\chi^2_{yz}$:\nThe matrix $C^{(yz)}$ has nine entries equal to $1$, five entries equal to $0$, one entry equal to $3$, and one entry equal to $4$.\n$$\n\\chi^2_{yz} = 9 \\times (1-1)^2 + 5 \\times (0-1)^2 + 1 \\times (3-1)^2 + 1 \\times (4-1)^2 = 0 + 5 \\times 1 + 1 \\times 4 + 1 \\times 9 = 5+4+9=18\n$$\n\n### Step 6: Calculation of the Aggregate Uniformity Score\nFinally, we sum the individual chi-square statistics to find the aggregate score $S$.\n$$\nS = \\chi^2_{xy} + \\chi^2_{xz} + \\chi^2_{yz} = 4 + 8 + 18 = 30\n$$\nThe final computed value for $S$ is $30$.", "answer": "$$\n\\boxed{30}\n$$", "id": "3310926"}, {"introduction": "While powerful, Quasi-Monte Carlo methods are not infallible and have known limitations, especially when the integrand has particular structures. This problem presents a \"pathological\" case specifically designed to make a QMC integration fail spectacularly. By working through this thought experiment, you will uncover how an integrand's properties can interact poorly with the deterministic structure of a Halton sequence, leading to a deeper appreciation for the method's scope and limitations [@problem_id:3285819].", "problem": "Consider one-dimensional Quasi-Monte Carlo (QMC) integration on the unit interval using the Halton sequence in base $2$ (the van der Corput sequence). For an integrable function $f:[0,1]\\to\\mathbb{R}$, the QMC estimator with $N$ points is\n$$\nQ_N \\;=\\; \\frac{1}{N}\\sum_{n=0}^{N-1} f\\big(h_n\\big),\n$$\nwhere $h_n$ is obtained from $n$ by writing $n$ in base $2$, reversing its digits, and interpreting the result as a binary fraction. Take $N=2^{10}$.\n\nDefine a smooth bump $g:(-\\infty,\\infty)\\to\\mathbb{R}$ by\n$$\ng(t) \\;=\\; \\begin{cases}\n\\exp\\!\\Big(-\\dfrac{1}{t\\,(1-t)}\\Big), & \\text{if } 0<t<1, \\\\[6pt]\n0, & \\text{otherwise},\n\\end{cases}\n$$\nand let\n$$\nA \\;=\\; \\int_{0}^{1} g(t)\\,dt.\n$$\nConsider the function $f:[0,1]\\to\\mathbb{R}$ defined by\n$$\nf(x) \\;=\\; \\frac{N}{A}\\, g\\big(N(1-x)\\big).\n$$\nNote that $f$ is $C^{\\infty}$ on $[0,1]$, supported in $\\big(1-\\tfrac{1}{N},1\\big)$, and $f(1-\\tfrac{1}{N})=f(1)=0$.\n\nStarting only from the definitions above and standard properties of base-$2$ representations, do the following:\n- Determine the value of the QMC estimator $Q_N$ for the integral $I=\\int_{0}^{1} f(x)\\,dx$ when the first $N=2^{10}$ points of the base-$2$ Halton sequence are used.\n- Compute the absolute integration error $|I - Q_N|$.\n\nProvide your final answer as a single real number. No rounding is required and no units are involved.", "solution": "The problem asks for the absolute integration error $|I - Q_N|$ for a specific function $f(x)$ on the interval $[0,1]$ using a Quasi-Monte Carlo (QMC) method with $N=2^{10}$ points. The integral is $I=\\int_{0}^{1}f(x)\\,dx$ and the QMC estimator is $Q_N = \\frac{1}{N}\\sum_{n=0}^{N-1} f(h_n)$, where $\\{h_n\\}$ is the base-$2$ Halton sequence.\n\nFirst, we must determine the set of QMC sample points $\\{h_n\\}_{n=0}^{N-1}$. The problem states these are the first $N=2^{10}$ points of the Halton sequence in base $b=2$, also known as the van der Corput sequence. For an integer $n \\in \\{0, 1, \\dots, N-1\\}$, its base-$2$ representation can be written with $10$ bits (since $N=2^{10}$), as $n = \\sum_{j=0}^{9} a_j 2^j$, where $a_j \\in \\{0, 1\\}$. The corresponding Halton point $h_n$ is obtained by reversing the order of the bits $a_j$ and interpreting the result as a binary fraction:\n$$\nh_n = \\sum_{j=0}^{9} a_j 2^{-(j+1)}\n$$\nA fundamental property of the first $N=b^m$ points of a base-$b$ Halton sequence is that they form a $(0,m,1)$-net in base $b$. For our case, with $b=2$ and $m=10$, this means the set of points $\\{h_n\\}_{n=0}^{N-1}$ is precisely the set of all fractions with denominator $N$:\n$$\n\\{h_n\\}_{n=0}^{N-1} = \\left\\{\\frac{k}{N} \\;\\bigg|\\; k=0, 1, \\dots, N-1\\right\\}\n$$\nTo verify this, consider an arbitrary point $h_n$. Multiplying by $N=2^{10}$ gives an integer:\n$$\nN h_n = 2^{10} \\sum_{j=0}^{9} a_j 2^{-(j+1)} = \\sum_{j=0}^{9} a_j 2^{9-j}\n$$\nLet the index of summation be $k=9-j$. As $j$ ranges from $0$ to $9$, $k$ ranges from $9$ to $0$. The expression becomes $N h_n = \\sum_{k=0}^{9} a_{9-k} 2^k$. This integer has a base-$2$ representation $(a_0 a_1 \\dots a_9)_2$. The original integer $n$ had representation $(a_9 a_8 \\dots a_0)_2$. The mapping from $n$ to $N h_n$ is a bit-reversal permutation on the set of integers $\\{0, 1, \\dots, N-1\\}$. Since this is a permutation, as $n$ covers all integers from $0$ to $N-1$, $N h_n$ also covers all integers from $0$ to $N-1$ exactly once. Therefore, the set of points $\\{h_n\\}$ is indeed $\\{k/N\\}_{k=0}^{N-1}$.\n\nNext, we analyze the integrand $f(x) = \\frac{N}{A}\\, g(N(1-x))$. The function $g(t)$ is non-zero only for $t \\in (0,1)$. Consequently, $f(x)$ is non-zero only if its argument $N(1-x)$ is in the interval $(0,1)$. This leads to the following inequalities:\n$$\n0 < N(1-x) < 1\n$$\nThe left inequality, $0 < N(1-x)$, implies $0 < 1-x$, which means $x < 1$.\nThe right inequality, $N(1-x) < 1$, implies $1-x < \\frac{1}{N}$, which means $x > 1 - \\frac{1}{N}$.\nThus, the support of $f(x)$ is the open interval $\\left(1-\\frac{1}{N}, 1\\right)$. For any $x$ outside this interval, $f(x)=0$.\n\nNow we can evaluate the QMC estimator $Q_N$:\n$$\nQ_N = \\frac{1}{N}\\sum_{n=0}^{N-1} f(h_n)\n$$\nWe need to evaluate $f(x)$ at each of the QMC points $h_n = k/N$ for $k \\in \\{0, 1, \\dots, N-1\\}$. For $f(h_n)$ to be potentially non-zero, the point $h_n$ must lie within the support of $f(x)$. We must check if any of the points $k/N$ fall into the interval $\\left(1-\\frac{1}{N}, 1\\right)$:\n$$\n1-\\frac{1}{N} < \\frac{k}{N} < 1\n$$\nMultiplying all parts of the inequality by $N$ (a positive number) gives:\n$$\nN-1 < k < N\n$$\nSince $k$ must be an integer, there is no integer $k$ that satisfies this strict inequality. This means that none of the QMC sample points $h_n$ fall into the open interval where $f(x)$ is non-zero. The points $h_n$ are all less than or equal to the left boundary of the support, $1-\\frac{1}{N}$. Specifically, the largest point is for $k=N-1$, which is $h_n = \\frac{N-1}{N} = 1-\\frac{1}{N}$.\nAt this boundary point, the argument of $g$ is $t = N(1-x) = N\\left(1 - \\left(1-\\frac{1}{N}\\right)\\right) = N\\left(\\frac{1}{N}\\right) = 1$. The definition of $g(t)$ specifies it is non-zero only for $0<t<1$, and $0$ otherwise. Since $t=1$ is in the \"otherwise\" case, $g(1)=0$. Thus, $f(1-\\frac{1}{N})=0$. For all other points $h_n < 1-\\frac{1}{N}$, the argument $t=N(1-h_n)$ will be greater than $1$, so $g(t)=0$ and $f(h_n)=0$.\nTherefore, $f(h_n)=0$ for all $n \\in \\{0, 1, \\dots, N-1\\}$. The QMC sum is:\n$$\nQ_N = \\frac{1}{N}\\sum_{n=0}^{N-1} 0 = 0\n$$\n\nNext, we compute the true value of the integral $I = \\int_{0}^{1} f(x)\\,dx$:\n$$\nI = \\int_{0}^{1} \\frac{N}{A}\\, g\\big(N(1-x)\\big)\\,dx\n$$\nWe perform a substitution. Let $t = N(1-x)$. Then $dt = -N\\,dx$, which gives $dx = -\\frac{1}{N}\\,dt$. We must also transform the limits of integration. When $x=0$, $t = N(1-0)=N$. When $x=1$, $t=N(1-1)=0$.\nSubstituting into the integral:\n$$\nI = \\int_{x=0}^{x=1} \\frac{N}{A}\\, g\\big(N(1-x)\\big)\\,dx = \\int_{t=N}^{t=0} \\frac{N}{A}\\, g(t) \\left(-\\frac{1}{N}\\,dt\\right) = \\int_{N}^{0} -\\frac{1}{A}\\,g(t)\\,dt\n$$\nBy swapping the limits of integration, we negate the integral:\n$$\nI = \\int_{0}^{N} \\frac{1}{A}\\,g(t)\\,dt = \\frac{1}{A} \\int_{0}^{N} g(t)\\,dt\n$$\nThe function $g(t)$ is zero for $t \\ge 1$. Since $N=2^{10} > 1$, we can split the integral:\n$$\n\\int_{0}^{N} g(t)\\,dt = \\int_{0}^{1} g(t)\\,dt + \\int_{1}^{N} g(t)\\,dt\n$$\nThe second term is zero because the integrand $g(t)$ is zero over the interval $[1,N]$. So,\n$$\n\\int_{0}^{N} g(t)\\,dt = \\int_{0}^{1} g(t)\\,dt\n$$\nThe problem defines the constant $A$ as $A = \\int_{0}^{1} g(t)\\,dt$. Substituting this back into our expression for $I$:\n$$\nI = \\frac{1}{A} \\left(\\int_{0}^{1} g(t)\\,dt\\right) = \\frac{1}{A} \\cdot A = 1\n$$\nThe true value of the integral is $I=1$.\n\nFinally, we compute the absolute integration error $|I - Q_N|$. We found $I=1$ and $Q_N=0$.\n$$\n|I - Q_N| = |1 - 0| = 1\n$$\nThis represents a worst-case scenario for this QMC integration, where the integrand is specifically constructed to have its support entirely between the sample points, leading to a maximum possible error for a normalized function.", "answer": "$$\\boxed{1}$$", "id": "3285819"}, {"introduction": "A more subtle but critical challenge in applying Halton sequences is the phenomenon of aliasing, where the integrand's frequencies \"resonate\" with the sequence's structure, causing large, systematic errors. This advanced practice guides you from first principles to implementing a solution for a practical integration problem involving trigonometric functions. You will learn to derive the conditions for resonance and design a strategy to mitigate it by intelligently assigning bases to dimensions, a crucial skill for any serious practitioner of QMC methods [@problem_id:3310947].", "problem": "You are asked to investigate aliasing phenomena in quasi–Monte Carlo integration using Halton sequences by integrating the separable trigonometric integrand $f(\\mathbf{x})=\\prod_{j=1}^{d}\\cos\\!\\big(2\\pi m_j x_j\\big)$ over the $d$-dimensional unit hypercube. You must do so by building from first principles: the definition of the integral of the product over independent variables, the definition of the Halton sequence via base-$b$ radical inverses, and basic properties of trigonometric integrals and finite geometric sums.\n\nYour tasks are as follows.\n\n1. Derive the exact value of the integral\n$$\nI=\\int_{[0,1]^d}\\prod_{j=1}^{d}\\cos\\!\\big(2\\pi m_j x_j\\big)\\,\\mathrm{d}\\mathbf{x},\n$$\nstarting only from the following fundamental base:\n- The integral factorization for separable products over independent variables.\n- The fact that for any integer $m$, $\\int_{0}^{1}\\cos(2\\pi m x)\\,\\mathrm{d}x=0$ if $m\\neq 0$ and equals $1$ if $m=0$.\nYour program must use this result to compute the exact integral for any given vector $\\mathbf{m}=(m_1,\\dots,m_d)$.\n\n2. Implement the $d$-dimensional Halton sequence with pairwise coprime integer bases $\\mathbf{b}=(b_1,\\dots,b_d)$ using radical inverse maps. For each coordinate $j$, the $n$-th point coordinate is\n$$\nx_{n,j}=\\phi_{b_j}(n)=\\sum_{r=0}^{\\infty} a_r(n;b_j)\\,b_j^{-(r+1)},\n$$\nwhere $n=\\sum_{r=0}^{R} a_r(n;b_j)\\,b_j^{r}$ is the base-$b_j$ expansion of $n$ with digits $a_r(n;b_j)\\in\\{0,1,\\dots,b_j-1\\}$ and with only finitely many nonzero digits. Use the first $N$ points $\\{\\mathbf{x}_n\\}_{n=0}^{N-1}$ to form the quasi–Monte Carlo estimator\n$$\n\\widehat{I}_N=\\frac{1}{N}\\sum_{n=0}^{N-1}\\prod_{j=1}^{d}\\cos\\!\\big(2\\pi m_j x_{n,j}\\big).\n$$\n\n3. Identify resonance (aliasing) between frequencies $m_j$ and bases $b_j$ that leads to a systematic non-vanishing sample average. You must reason from first principles using only:\n- The fact that the first $b^K$ terms of the one-dimensional van der Corput sequence in base $b$ enumerate the rational grid $\\{0,1/b^K,\\dots,(b^K-1)/b^K\\}$ in some order.\n- The finite geometric sum identity for complex exponentials on a uniform grid, namely\n$$\n\\frac{1}{B}\\sum_{i=0}^{B-1} \\exp\\!\\big(2\\pi \\mathrm{i}\\, m\\, i/B\\big)=\n\\begin{cases}\n1,& \\text{if } B \\text{ divides } m,\\\\\n0,& \\text{otherwise.}\n\\end{cases}\n$$\nUse these principles to determine, for a given $N$, $b_j$, and $m_j$, whether the contribution of coordinate $j$ resonates with base $b_j$ over the first $N$ samples in the sense that it induces $\\cos\\!\\big(2\\pi m_j x_{n,j}\\big)=1$ for every $n\\in\\{0,\\dots,N-1\\}$. Your program must output a boolean flag that is true if and only if all coordinates resonate simultaneously under this criterion.\n\n4. Anti-resonant base assignment: For a fixed frequency vector $\\mathbf{m}$ and a multiset of bases $\\{b_1,\\dots,b_d\\}$, design an assignment of bases to dimensions (i.e., a permutation of bases across coordinates) that minimizes the number of resonant coordinates for the given $N$. Among all assignments that minimize the number of resonant coordinates, you may choose any. Your program must compute the estimator error under the original assignment and under your best anti-resonant assignment.\n\nYou must implement a complete program that executes the above for the following test suite. For each test case, run the estimator with the specified dimension $d$, bases $\\mathbf{b}$, sample size $N$, and frequency vector $\\mathbf{m}$. Use the exact integral derived in Task 1 as the ground truth. All angles are in radians. There are no physical units. The outputs must be rounded to six decimal places for floats.\n\nTest suite:\n- Case A (happy path, non-resonant): $d=2$, $\\mathbf{b}=(2,3)$, $N=1000$, $\\mathbf{m}=(1,1)$. Required output for this case: a list $[\\widehat{I}_N,|\\widehat{I}_N-I|,\\text{full\\_resonance}]$.\n- Case B (full resonance and anti-resonance design): $d=2$, $\\mathbf{b}=(2,3)$, $N=1000$, $\\mathbf{m}=(1024,2187)$. Required output for this case: a list $[|\\widehat{I}_N-I|,|\\widehat{I}_N^{\\mathrm{anti}}-I|]$.\n- Case C (partial resonance): $d=2$, $\\mathbf{b}=(2,3)$, $N=1000$, $\\mathbf{m}=(1024,1)$. Required output: $[\\widehat{I}_N,|\\widehat{I}_N-I|,\\text{full\\_resonance}]$.\n- Case D (boundary condition $N=1$): $d=3$, $\\mathbf{b}=(2,3,5)$, $N=1$, $\\mathbf{m}=(7,11,13)$. Required output: $[\\widehat{I}_N,|\\widehat{I}_N-I|,\\text{full\\_resonance}]$.\n- Case E (zero frequency exactness): $d=2$, $\\mathbf{b}=(2,3)$, $N=1000$, $\\mathbf{m}=(0,0)$. Required output: $[\\widehat{I}_N,|\\widehat{I}_N-I|,\\text{full\\_resonance}]$.\n\nFinal output format:\nYour program should produce a single line of output containing the results for Cases A through E, in order, as a comma-separated list enclosed in square brackets, with each case’s result itself being a list in the form specified above. For example: [[a1,a2,a3],[b1,b2],[c1,c2,c3],[d1,d2,d3],[e1,e2,e3]].", "solution": "### Derivations and Algorithmic Design\n\n#### Task 1: Exact Value of the Integral\nThe integral to be evaluated is $I=\\int_{[0,1]^d}\\prod_{j=1}^{d}\\cos\\!\\big(2\\pi m_j x_j\\big)\\,\\mathrm{d}\\mathbf{x}$. The integrand $f(\\mathbf{x}) = \\prod_{j=1}^{d} f_j(x_j)$ with $f_j(x_j) = \\cos(2\\pi m_j x_j)$ is a separable function of the variables $x_1, \\dots, x_d$. For such functions, the integral over the hypercube $[0,1]^d$ factorizes into a product of one-dimensional integrals, as per Fubini's theorem:\n$$\nI = \\prod_{j=1}^{d} \\int_{0}^{1} \\cos(2\\pi m_j x_j) \\, \\mathrm{d}x_j\n$$\nThe problem provides the value of the one-dimensional integral for an integer frequency $m$:\n$$\n\\int_{0}^{1} \\cos(2\\pi m x) \\, \\mathrm{d}x = \\begin{cases} 1 & \\text{if } m=0 \\\\ 0 & \\text{if } m \\neq 0 \\end{cases}\n$$\nThis result is straightforward to verify: if $m \\neq 0$, the antiderivative is $\\frac{1}{2\\pi m}\\sin(2\\pi m x)$, which evaluates to $0$ at both limits $x=0$ and $x=1$. If $m=0$, the integrand is $\\cos(0)=1$, and $\\int_0^1 1\\,\\mathrm{d}x = 1$.\n\nFor the product of integrals to be non-zero, every single factor must be non-zero. The $j$-th factor is non-zero only if $m_j=0$, in which case it equals $1$. Therefore, the entire product $I$ is equal to $1$ if and only if all $m_j=0$ for $j=1, \\dots, d$. If even a single $m_j$ is non-zero, its corresponding integral is $0$, which makes the entire product $I$ equal to $0$.\nThus, the value of the exact integral is:\n$$\nI = \\begin{cases} 1 & \\text{if } \\mathbf{m} = \\mathbf{0} \\text{ (i.e., } m_j=0 \\text{ for all } j) \\\\ 0 & \\text{otherwise} \\end{cases}\n$$\n\n#### Task 2: Halton Sequence and QMC Estimator\nThe foundation of the Halton sequence is the radical inverse function, $\\phi_b(n)$. Given an integer $n \\ge 0$ and a base $b \\ge 2$, we first find the base-$b$ representation of $n$: $n = \\sum_{r=0}^{R} a_r b^r$. The radical inverse is obtained by re-interpreting this expansion with negative powers of $b$:\n$$\nx_n = \\phi_b(n) = \\sum_{r=0}^{R} a_r b^{-(r+1)}\n$$\nThis operation effectively reverses the digits of $n$ in base $b$ and places them after the radix point. For example, in base $b=10$, if $n=123$, then $\\phi_{10}(123) = 0.321$. The algorithm to compute this is:\n1. Initialize `result = 0.0` and `f = 1.0 / b`.\n2. While `n > 0`:\n   a. Get the least significant digit: `digit = n % b`.\n   b. Add its contribution: `result += digit * f`.\n   c. Update `n`: `n //= b`.\n   d. Update the fractional power: `f /= b`.\n3. Return `result`.\n\nThe $d$-dimensional Halton sequence uses a set of $d$ pairwise coprime bases $\\mathbf{b}=(b_1, \\dots, b_d)$. The $n$-th point of the sequence is $\\mathbf{x}_n = (\\phi_{b_1}(n), \\phi_{b_2}(n), \\dots, \\phi_{b_d}(n))$.\nThe QMC estimator for the integral $I$ is the sample mean of the integrand evaluated at the first $N$ Halton points (for $n=0, \\dots, N-1$):\n$$\n\\widehat{I}_N = \\frac{1}{N} \\sum_{n=0}^{N-1} f(\\mathbf{x}_n) = \\frac{1}{N} \\sum_{n=0}^{N-1} \\prod_{j=1}^{d} \\cos(2\\pi m_j x_{n,j})\n$$\n\n#### Task 3: Resonance Condition\nResonance for coordinate $j$ is defined by the stringent condition $\\cos(2\\pi m_j x_{n,j}) = 1$ for all $n \\in \\{0, \\dots, N-1\\}$. This holds if and only if the argument of the cosine is an integer multiple of $2\\pi$, which means $m_j x_{n,j}$ must be an integer for all $n \\in \\{0, \\dots, N-1\\}$.\n\nLet's analyze the structure of the points $x_{n,j} = \\phi_{b_j}(n)$. By definition, for any $n$, $\\phi_{b_j}(n)$ is a rational number whose denominator is a power of the base $b_j$. Let us determine the highest power of $b_j$ necessary for the denominators of the first $N$ points.\nAn integer $n < N$ has at most $K$ digits in its base-$b_j$ expansion, where $K$ is the smallest integer such that $b_j^K \\ge N$. For $N>1$, this is $K=\\lceil\\log_{b_j}N\\rceil$. For $N=1$, we only consider $n=0$, so $K=0$.\nThe radical inverse $\\phi_{b_j}(n)$ is formed by summing terms $a_r b_j^{-(r+1)}$. For an $n$ requiring $K$ digits (i.e., $b_j^{K-1} \\le n < b_j^K$), the resulting point $\\phi_{b_j}(n)$ can be written as a fraction with denominator $b_j^K$. Specifically, $\\phi_{b_j}(n) = \\text{integer} / b_j^K$.\n\nFor $m_j \\phi_{b_j}(n)$ to be an integer for all $n \\in \\{0, \\dots, N-1\\}$, $m_j$ must be a multiple of the denominators of all such points. The set of points $\\{\\phi_{b_j}(n)\\}_{n=0}^{N-1}$ includes values whose simplest fractional form has a denominator up to $b_j^K$. For example, for $N > b_j^{K-1}$, the point for $n=b_j^{K-1}$ is $\\phi_{b_j}(b_j^{K-1}) = 1/b_j^K$. For $m_j \\cdot (1/b_j^K)$ to be an integer, it is necessary that $m_j$ is a multiple of $b_j^K$. This condition is also sufficient, because if $m_j = c \\cdot b_j^K$ for an integer $c$, then for any point $x_{n,j} = \\text{integer} / b_j^K$, the product $m_j x_{n,j} = c \\cdot (\\text{integer})$ is an integer.\n\nTherefore, the condition for resonance in coordinate $j$ is that $m_j$ is divisible by $b_j^K$, where $K = \\lceil\\log_{b_j}N\\rceil$ for $N>1$, and $K=0$ for $N=1$. This can be stated as $m_j \\equiv 0 \\pmod{b_j^K}$. An integer-based method to find $K$ for $N>1$ is to find the smallest integer $K$ such that $b_j^K \\ge N$.\n\n#### Task 4: Anti-Resonant Base Assignment\nGiven a frequency vector $\\mathbf{m}$ and a multiset of bases, the goal is to find a permutation of the bases that minimizes the number of resonant coordinate pairs. For a dimension $j$ with frequency $m_j$ and an assigned base $b'$, resonance occurs if the condition derived in Task 3 is met.\nThe algorithm is as follows:\n1. Identify all possible pairings of frequencies $\\{m_1, \\dots, m_d\\}$ with the given bases $\\{b_1, \\dots, b_d\\}$. These correspond to the $d!$ permutations of the bases.\n2. For each permutation of bases, say $\\mathbf{b}'=(b'_{\\pi(1)}, \\dots, b'_{\\pi(d)})$, count the total number of resonant pairs $(m_j, b'_{\\pi(j)})$.\n3. Select a permutation that results in the minimum count of resonances.\n4. Calculate the QMC estimator $\\widehat{I}_N^{\\mathrm{anti}}$ using this optimal base assignment.\n\nFor the cases in this problem, $d$ is small ($2$ or $3$), making an exhaustive search of all permutations computationally trivial. For $d=2$, there are only two possibilities: the original assignment $(b_1, b_2)$ and the swapped assignment $(b_2, b_1)$. We compare the number of resonances in each and choose the better one.", "answer": "```\n[[0.000000,0.000000,False],[1.000000,0.000551],[0.000000,0.000000,False],[1.000000,1.000000,True],[1.000000,0.000000,True]]\n```", "id": "3310947"}]}