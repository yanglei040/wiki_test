{"hands_on_practices": [{"introduction": "The most fundamental property we demand of a pseudo-random number generator is uniformity. A good generator should produce outputs that are evenly distributed over the unit interval. This exercise provides a direct, hands-on method for quantifying this property by calculating the star discrepancy, $D_N^*$, which measures the worst-case deviation between the empirical distribution of a finite set of points and the ideal uniform distribution. By working through this calculation, you will develop a concrete intuition for how statistical tests like the Kolmogorov-Smirnov test diagnose failures in uniformity [@problem_id:3332021].", "problem": "Consider a finite output sample from a uniform random number generator on the unit interval, consisting of the ordered points $x_{1}, x_{2}, \\dots, x_{N} \\in [0,1]$ with $N = 8$ and\n$$\nx_{1} = 0.03,\\quad x_{2} = 0.14,\\quad x_{3} = 0.22,\\quad x_{4} = 0.49,\\quad x_{5} = 0.55,\\quad x_{6} = 0.77,\\quad x_{7} = 0.88,\\quad x_{8} = 0.97.\n$$\nThe star discrepancy $D_{N}^{\\ast}$ of the point set in one dimension is defined as the supremum over anchored intervals of the absolute deviation between the empirical content and the Lebesgue measure, that is,\n$$\nD_{N}^{\\ast} \\equiv \\sup_{t \\in [0,1]} \\left| \\frac{1}{N} \\sum_{i=1}^{N} \\mathbf{1}\\{ x_{i} \\in [0,t) \\} \\;-\\; t \\right|.\n$$\nThe Kolmogorov–Smirnov statistic (KS) for testing uniformity on $[0,1]$ is defined as\n$$\n\\sup_{t \\in [0,1]} \\left| F_{N}(t) - t \\right|,\n$$\nwhere $F_{N}(t) \\equiv \\frac{1}{N}\\sum_{i=1}^{N} \\mathbf{1}\\{ x_{i} \\le t \\}$ is the empirical cumulative distribution function.\n\nStarting only from these definitions and fundamental properties of step functions and the Lebesgue measure on $[0,1]$, compute $D_{N}^{\\ast}$ for the given sample by explicitly evaluating the supremum over anchored intervals $[0,t)$, and then compare it to the Kolmogorov–Smirnov statistic in one dimension for the same sample. Express your final answer as a single exact rational number equal to both quantities.", "solution": "The problem requires the calculation of the star discrepancy $D_N^*$ for a given one-dimensional point set and a comparison with the Kolmogorov-Smirnov (KS) statistic.\n\nLet the ordered point set be $x_{1}, x_{2}, \\dots, x_{N}$ in $[0,1]$, with $N=8$. The given points are:\n$x_{1} = 0.03$, $x_{2} = 0.14$, $x_{3} = 0.22$, $x_{4} = 0.49$, $x_{5} = 0.55$, $x_{6} = 0.77$, $x_{7} = 0.88$, $x_{8} = 0.97$.\n\nFirst, we analyze the star discrepancy, $D_{N}^{\\ast}$, defined as:\n$$\nD_{N}^{\\ast} \\equiv \\sup_{t \\in [0,1]} \\left| \\frac{1}{N} \\sum_{i=1}^{N} \\mathbf{1}\\{ x_{i} \\in [0,t) \\} \\;-\\; t \\right|\n$$\nLet us define the empirical distribution function based on the open interval $[0,t)$ as $G_N(t) = \\frac{1}{N} \\sum_{i=1}^{N} \\mathbf{1}\\{ x_{i} \\in [0,t) \\}$. The quantity to be maximized is $|G_N(t) - t|$. The function $G_N(t)$ is a step function that counts the number of points strictly less than $t$. Since the points $x_i$ are ordered, this function is constant between them. Specifically, for $t \\in (x_{i-1}, x_i]$ (with $x_0 \\equiv 0$), the number of points in $[0, t)$ is $i-1$. Thus, $G_N(t) = \\frac{i-1}{N}$. At the point $t=x_i$, $G_N(x_i) = \\frac{i-1}{N}$ since we count points strictly less than $x_i$. The function $G_N(t)$ is left-continuous.\n\nThe function $d(t) = G_N(t) - t$ is piecewise linear. On any interval $(x_{i-1}, x_i]$, $d(t) = \\frac{i-1}{N} - t$. As this is a continuous function on a compact interval, the supremum of its absolute value $|d(t)|$ will be attained at the endpoints of the interval. Therefore, to find the global supremum over $[0,1]$, we must check the values of $|d(t)|$ at points infinitesimally to the right of each $x_i$ and at points $x_i$ themselves.\nThe limits of $|G_N(t)-t|$ as $t$ approaches a point $x_i$ from the left and right are:\n- $\\lim_{t \\to x_i^{-}} |G_N(t) - t| = |\\frac{i-1}{N} - x_i|$ because for $t<x_i$ but close to it, $G_N(t)=\\frac{i-1}{N}$.\n- $\\lim_{t \\to x_i^{+}} |G_N(t) - t| = |\\frac{i}{N} - x_i|$ because for $t>x_i$ but close to it, $G_N(t)=\\frac{i}{N}$.\n\nThe supremum must be the maximum of these values over all $i=1, \\dots, N$. We also check the boundaries $t=0$ and $t=1$. At $t=0$, $|G_N(0)-0|=|0-0|=0$. At $t=1$, assuming all $x_i < 1$, $|G_N(1)-1|=|\\frac{N}{N}-1|=0$. Thus,\n$$\nD_{N}^{\\ast} = \\max_{1 \\le i \\le N} \\left\\{ \\left|\\frac{i-1}{N} - x_i\\right|, \\left|\\frac{i}{N} - x_i\\right| \\right\\}\n$$\n\nNext, we analyze the Kolmogorov-Smirnov statistic for uniformity, defined as $\\sup_{t \\in [0,1]} |F_N(t) - t|$, where $F_N(t) = \\frac{1}{N}\\sum_{i=1}^{N} \\mathbf{1}\\{ x_{i} \\le t \\}$ is the empirical cumulative distribution function (CDF). $F_N(t)$ is a right-continuous step function. For $t \\in [x_i, x_{i+1})$, $F_N(t) = \\frac{i}{N}$.\nThe function $k(t) = F_N(t) - t$ is also piecewise linear. An identical argument concerning its supremum applies. The supremum of $|k(t)|$ must be found by examining the values at the points of discontinuity $t=x_i$.\nThe value at $t=x_i$ and the limit from the left are:\n- $|F_N(x_i) - x_i| = |\\frac{i}{N} - x_i|$.\n- $\\lim_{t \\to x_i^{-}} |F_N(t) - t| = |\\frac{i-1}{N} - x_i|$.\n\nThe set of candidate values for the supremum is identical to that for $D_N^*$. Therefore, for a one-dimensional sample, the star discrepancy and the KS statistic are numerically equal.\n\nWe now compute this value for $N=8$. We must compute $|\\frac{i-1}{8} - x_i|$ and $|\\frac{i}{8} - x_i|$ for $i=1, \\dots, 8$. For precision, we convert all decimals to rational numbers.\n$x_{1} = \\frac{3}{100}$, $x_{2} = \\frac{14}{100}$, $x_{3} = \\frac{22}{100}$, $x_{4} = \\frac{49}{100}$, $x_{5} = \\frac{55}{100}$, $x_{6} = \\frac{77}{100}$, $x_{7} = \\frac{88}{100}$, $x_{8} = \\frac{97}{100}$.\n\nFor $i=1$: $x_1 = 0.03$. Values are $|0 - 0.03| = 0.03$ and $|\\frac{1}{8} - 0.03| = |0.125 - 0.03| = 0.095$.\nFor $i=2$: $x_2 = 0.14$. Values are $|\\frac{1}{8} - 0.14| = |0.125 - 0.14| = 0.015$ and $|\\frac{2}{8} - 0.14| = |0.25 - 0.14| = 0.11$.\nFor $i=3$: $x_3 = 0.22$. Values are $|\\frac{2}{8} - 0.22| = |0.25 - 0.22| = 0.03$ and $|\\frac{3}{8} - 0.22| = |0.375 - 0.22| = 0.155$.\nFor $i=4$: $x_4 = 0.49$. Values are $|\\frac{3}{8} - 0.49| = |0.375 - 0.49| = 0.115$ and $|\\frac{4}{8} - 0.49| = |0.5 - 0.49| = 0.01$.\nFor $i=5$: $x_5 = 0.55$. Values are $|\\frac{4}{8} - 0.55| = |0.5 - 0.55| = 0.05$ and $|\\frac{5}{8} - 0.55| = |0.625 - 0.55| = 0.075$.\nFor $i=6$: $x_6 = 0.77$. Values are $|\\frac{5}{8} - 0.77| = |0.625 - 0.77| = 0.145$ and $|\\frac{6}{8} - 0.77| = |0.75 - 0.77| = 0.02$.\nFor $i=7$: $x_7 = 0.88$. Values are $|\\frac{6}{8} - 0.88| = |0.75 - 0.88| = 0.13$ and $|\\frac{7}{8} - 0.88| = |0.875 - 0.88| = 0.005$.\nFor $i=8$: $x_8 = 0.97$. Values are $|\\frac{7}{8} - 0.97| = |0.875 - 0.97| = 0.095$ and $|\\frac{8}{8} - 0.97| = |1 - 0.97| = 0.03$.\n\nThe set of computed deviation values is $\\{0.03, 0.095, 0.015, 0.11, 0.03, 0.155, 0.115, 0.01, 0.05, 0.075, 0.145, 0.02, 0.13, 0.005, 0.095, 0.03\\}$.\nThe maximum of these values is $0.155$. This occurred at $i=3$ for the term $|\\frac{3}{8} - x_3|$.\nWe compute this value as an exact rational number:\n$$\n\\left|\\frac{3}{8} - x_3\\right| = \\left|\\frac{3}{8} - \\frac{22}{100}\\right| = \\left|\\frac{3}{8} - \\frac{11}{50}\\right| = \\left|\\frac{3 \\times 25}{200} - \\frac{11 \\times 4}{200}\\right| = \\left|\\frac{75 - 44}{200}\\right| = \\frac{31}{200}.\n$$\nThe value $\\frac{31}{200}$ corresponds to $0.155$. Let us verify the second largest value, $0.145$, which is $|\\frac{5}{8} - x_6|$:\n$$\n\\left|\\frac{5}{8} - x_6\\right| = \\left|\\frac{5}{8} - \\frac{77}{100}\\right| = \\left|\\frac{5 \\times 25}{200} - \\frac{77 \\times 2}{200}\\right| = \\left|\\frac{125 - 154}{200}\\right| = \\frac{29}{200}.\n$$\nThis corresponds to $0.145$. Since $\\frac{31}{200} > \\frac{29}{200}$, the maximum is indeed $\\frac{31}{200}$.\n\nThus, the star discrepancy $D_N^*$ and the Kolmogorov-Smirnov statistic for this sample are both equal to $\\frac{31}{200}$.", "answer": "$$ \\boxed{\\frac{31}{200}} $$", "id": "3332021"}, {"introduction": "A long period is a necessary, but not sufficient, condition for a high-quality generator. Even generators with a maximal period can harbor subtle structural flaws that make them unsuitable for serious applications. This practice exposes one of the most famous weaknesses of linear congruential generators (LCGs) that use a power-of-two modulus. You will derive from first principles why the least significant bits of these generators have shockingly short periods, a defect that renders them highly non-random and predictable [@problem_id:3332070].", "problem": "Consider a Linear Congruential Generator (LCG) defined over the ring of integers modulo a power of two, with recurrence\n$$\nX_{n+1} \\equiv a\\,X_n + c \\pmod{2^{w}},\n$$\nwhere $a$ and $c$ are integers, $w \\geq 1$, and $X_0 \\in \\{0,1,\\dots,2^{w}-1\\}$. Assume $a$ and $c$ satisfy the standard necessary and sufficient conditions for a full-period LCG modulo $2^{w}$ on the ring $\\mathbb{Z}/2^{w}\\mathbb{Z}$, namely that $c$ is odd and $a \\equiv 1 \\pmod{4}$, so the period of $(X_n)$ equals $2^{w}$.\n\nDefine the truncation to the $r$ least significant bits by $Y_n \\equiv X_n \\pmod{2^{r}}$ with $1 \\leq r \\leq w$, and define the $k$-th bit (least significant bit indexed by $k=0$) of $X_n$ as $b_k(n) \\in \\{0,1\\}$ such that\n$$\nX_n \\equiv \\sum_{j=0}^{w-1} b_j(n)\\,2^j, \\quad \\text{so } b_k(n) = \\left\\lfloor \\frac{X_n}{2^k} \\right\\rfloor \\bmod 2,\n$$\nfor $0 \\leq k \\leq r-1$.\n\nStarting from the core definitions of modular arithmetic and the structure of LCGs on $\\mathbb{Z}/2^{q}\\mathbb{Z}$, and using only well-tested results (including the characterization of full-period LCGs modulo powers of two and basic properties of $2$-adic valuation), do the following:\n\n- Show from first principles that $(Y_n)$ evolves as an LCG modulo $2^{r}$ with the same parameters $a$ and $c$.\n- Using the structural conditions on $a$ and $c$ and the properties of $\\mathbb{Z}/2^{r}\\mathbb{Z}$, derive the exact period of $(Y_n)$.\n- For a fixed bit index $k$ with $0 \\leq k \\leq r-1$, analyze the induced map on $\\mathbb{Z}/2^{k+1}\\mathbb{Z}$ that governs $b_k(n)$, and derive the exact period $T_k$ of the bit sequence $(b_k(n))$. Your derivation must be explicit and must make clear why the low bits exhibit short cycles.\n- Express your final answer as closed-form analytic expressions for the period of $(Y_n)$ and for $T_k$ as a function of $k$.\n\nNo numerical rounding is required. Provide the final expressions with no units. For the multiple requested quantities, present them together as a single row matrix in your final answer.", "solution": "The solution will be presented in three parts, corresponding to the tasks specified in the problem statement.\n\n**Part 1: The truncated sequence $(Y_n)$**\n\nThe original LCG is defined by the recurrence relation\n$$\nX_{n+1} \\equiv a X_n + c \\pmod{2^w}\n$$\nThis congruence means that there exists an integer $k_n$ such that $X_{n+1} = a X_n + c + k_n 2^w$.\nThe truncated sequence is defined as $Y_n = X_n \\pmod{2^r}$ for $1 \\leq r \\leq w$. This means $Y_n$ is the remainder of the division of $X_n$ by $2^r$. By definition, $X_n \\equiv Y_n \\pmod{2^r}$.\nTo find the recurrence for $(Y_n)$, we consider the main recurrence relation modulo $2^r$. Since $r \\leq w$, $2^w$ is a multiple of $2^r$, so $2^w \\equiv 0 \\pmod{2^r}$.\nTaking the equation $X_{n+1} = a X_n + c + k_n 2^w$ modulo $2^r$, we get:\n$$\nX_{n+1} \\equiv a X_n + c \\pmod{2^r}\n$$\nUsing the definition of $Y_n$, we have $X_{n+1} \\equiv Y_{n+1} \\pmod{2^r}$ and $X_n \\equiv Y_n \\pmod{2^r}$. Substituting these into the congruence gives:\n$$\nY_{n+1} \\equiv a Y_n + c \\pmod{2^r}\n$$\nThis shows that the sequence $(Y_n)$ is itself a Linear Congruential Generator with the same multiplier $a$ and increment $c$, but with the modulus reduced to $2^r$.\n\n**Part 2: The period of $(Y_n)$**\n\nWe have established that $(Y_n)$ is an LCG with modulus $2^r$. The period of such a generator is the smallest integer $p > 0$ such that $Y_{n+p} \\equiv Y_n \\pmod{2^r}$ for all possible initial states $Y_0$ and for all $n \\geq 0$.\nThe general solution to the LCG recurrence is $Y_n \\equiv a^n Y_0 + c \\frac{a^n-1}{a-1} \\pmod{2^r}$.\nFor the period to be $p$, we require $Y_{n+p} \\equiv Y_n \\pmod{2^r}$ for all $n$. This becomes\n$$\na^{n+p} Y_0 + c \\frac{a^{n+p}-1}{a-1} \\equiv a^n Y_0 + c \\frac{a^n-1}{a-1} \\pmod{2^r}\n$$\n$a^n (a^p-1) Y_0 + c \\frac{a^n(a^p-1)}{a-1} \\equiv 0 \\pmod{2^r}$.\nSince $a$ is odd (as $a \\equiv 1 \\pmod{4}$), $a$ is invertible modulo $2^r$. This must hold for any $Y_0$. This implies two conditions:\n$1.$ $a^p \\equiv 1 \\pmod{2^r}$.\n$2.$ $c \\frac{a^p-1}{a-1} \\equiv 0 \\pmod{2^r}$.\nSince $c$ is given to be odd, it is also invertible modulo $2^r$. The second condition simplifies to $\\frac{a^p-1}{a-1} \\equiv 0 \\pmod{2^r}$, or $v_2(\\frac{a^p-1}{a-1}) \\geq r$, where $v_2(z)$ is the $2$-adic valuation of $z$ (the exponent of the highest power of $2$ that divides $z$).\nThis second condition is stricter than the first. The period $p$ is the smallest positive integer satisfying $v_2( (a^p-1)/(a-1) ) \\geq r$.\n\nTo proceed, we use a key lemma regarding the $2$-adic valuation of $a^n-1$ when $a \\equiv 1 \\pmod 4$.\n**Lemma:** If $a$ is an integer such that $a \\equiv 1 \\pmod{4}$, then for any integer $n \\geq 1$, $v_2(a^n-1) = v_2(a-1) + v_2(n)$.\n**Proof of Lemma:** We are given $a \\equiv 1 \\pmod 4$, so $v_2(a-1) \\ge 2$. We proceed by induction on $v_2(n)$.\nBase case: $v_2(n) = 0$, so $n$ is odd. Then $a^n-1 = (a-1)(a^{n-1} + a^{n-2} + \\dots + 1)$. Since $a$ is odd, each of the $n$ terms in the second factor is odd. As $n$ is odd, their sum is odd. Thus, $v_2(a^n-1) = v_2(a-1) = v_2(a-1) + 0 = v_2(a-1) + v_2(n)$.\nInductive step: Assume the lemma holds for all integers $m$ where $v_2(m) = k$, for some $k \\geq 0$. Let $n$ be an integer with $v_2(n) = k+1$. Then we can write $n=2m$ where $v_2(m)=k$.\nWe have $a^n - 1 = a^{2m} - 1 = (a^m - 1)(a^m + 1)$.\nBy the inductive hypothesis, $v_2(a^m-1) = v_2(a-1) + v_2(m)$. Since $v_2(a-1) \\ge 2$ and $v_2(m) \\ge 0$, we have $v_2(a^m-1) \\ge 2$, which implies $a^m \\equiv 1 \\pmod 4$.\nThen $a^m+1 \\equiv 1+1 \\equiv 2 \\pmod 4$, which means $v_2(a^m+1) = 1$.\nTherefore, $v_2(a^n-1) = v_2(a^{2m}-1) = v_2(a^m-1) + v_2(a^m+1) = (v_2(a-1)+v_2(m)) + 1 = v_2(a-1) + (v_2(m)+1) = v_2(a-1) + v_2(2m) = v_2(a-1) + v_2(n)$.\nThe Lemma is proven by induction.\n\nUsing the lemma, the condition for the period $p$ becomes:\n$v_2(a^p-1) - v_2(a-1) \\geq r$\n$(v_2(a-1) + v_2(p)) - v_2(a-1) \\geq r$\n$v_2(p) \\geq r$\nThe smallest positive integer $p$ that satisfies this condition is $p=2^r$.\nThus, the period of the sequence $(Y_n)$ is $2^r$.\n\n**Part 3: The period of the bit sequence $(b_k(n))$**\n\nWe want to find the period $T_k$ of the sequence $(b_k(n))$ for a fixed $k$ where $0 \\leq k \\leq r-1$. The bit $b_k(n)$ is determined by the value of $X_n \\pmod{2^{k+1}}$. Let $Y_n^{(j)} = X_n \\pmod{2^j}$. From Part 2, the sequence $(Y_n^{(k+1)})$ has period $2^{k+1}$.\nThe bit $b_k(n)$ is given by $b_k(n) = \\lfloor Y_n^{(k+1)}/2^k \\rfloor$.\n\nLet's analyze the evolution of the sequence $(Y_n^{(k+1)})$ over $2^k$ steps. The recurrence is $Y_{n+1}^{(k+1)} \\equiv a Y_n^{(k+1)} + c \\pmod{2^{k+1}}$.\nIterating this recurrence $T = 2^k$ times gives:\n$$\nY_{n+2^k}^{(k+1)} \\equiv a^{2^k} Y_n^{(k+1)} + c \\frac{a^{2^k}-1}{a-1} \\pmod{2^{k+1}}\n$$\nLet's analyze the terms $a^{2^k}$ and $\\frac{a^{2^k}-1}{a-1}$ modulo $2^{k+1}$. We use the lemma from Part 2.\nLet $s = v_2(a-1)$. We are given $a \\equiv 1 \\pmod 4$, so $s \\ge 2$.\n$v_2(a^{2^k}-1) = v_2(a-1) + v_2(2^k) = s+k$.\nSince $s \\ge 2$, $s+k \\ge k+2 > k+1$. This implies $a^{2^k} \\equiv 1 \\pmod{2^{k+1}}$.\n\nFor the second term, we have:\n$v_2\\left(\\frac{a^{2^k}-1}{a-1}\\right) = v_2(a^{2^k}-1) - v_2(a-1) = (s+k) - s = k$.\nThis means $\\frac{a^{2^k}-1}{a-1} = M \\cdot 2^k$ for some odd integer $M$.\nTherefore, $c \\frac{a^{2^k}-1}{a-1} = c M 2^k$. Since $c$ and $M$ are both odd, their product $cM$ is also odd.\nSo, $c \\frac{a^{2^k}-1}{a-1} \\equiv 2^k \\pmod{2^{k+1}}$.\n\nSubstituting these findings back into the recurrence for $Y_{n+2^k}^{(k+1)}$:\n$$\nY_{n+2^k}^{(k+1)} \\equiv 1 \\cdot Y_n^{(k+1)} + 2^k \\pmod{2^{k+1}}\n$$\nThis relation is central. Now, we decompose $Y_n^{(k+1)}$ into its $k$-th bit and the lower bits:\n$Y_n^{(k+1)} = b_k(n) 2^k + (Y_n^{(k+1)} \\bmod 2^k)$.\nThe relation becomes:\n$$\nb_k(n+2^k) 2^k + (Y_{n+2^k}^{(k+1)} \\bmod 2^k) \\equiv \\left(b_k(n) 2^k + (Y_n^{(k+1)} \\bmod 2^k)\\right) + 2^k \\pmod{2^{k+1}}\n$$\nThis equation implies congruences modulo $2^k$ and for the $2^k$ coefficient.\nModulo $2^k$: $Y_{n+2^k}^{(k+1)} \\bmod 2^k \\equiv Y_n^{(k+1)} \\bmod 2^k$. This means $Y_{n+2^k}^{(k)} \\equiv Y_n^{(k)}$. This is consistent with the fact that the period of $(Y_n^{(k)})$ is $2^k$.\n\nBy comparing the coefficients of $2^k$, we get a relation for the bits:\n$$\nb_k(n+2^k) \\equiv b_k(n) + 1 \\pmod 2\n$$\nThis shows that the bit $b_k(n)$ flips after $2^k$ steps. Therefore, the sequence of bits $(b_k(n))$ is not periodic with period $2^k$. To return to its original state, we must apply this transformation twice:\n$$\nb_k(n+2 \\cdot 2^k) = b_k(n+2^{k+1}) \\equiv b_k(n+2^k)+1 \\equiv (b_k(n)+1)+1 \\equiv b_k(n) \\pmod 2\n$$\nThe sequence $(b_k(n))$ first repeats after $2^{k+1}$ steps. The period is not a divisor of $2^k$, so the period must be exactly $T_k = 2^{k+1}$. This result makes clear why the low-order bits (small $k$) of LCGs with power-of-two moduli have very short periods ($T_0=2$, $T_1=4$, etc.), making them unsuitable for applications requiring high-quality randomness.\n\n### Summary of Results\n-   The period of the truncated sequence $(Y_n) = (X_n \\pmod{2^r})$ is $2^r$.\n-   The period of the $k$-th bit sequence $(b_k(n))$ is $T_k = 2^{k+1}$.", "answer": "$$\\boxed{\\begin{pmatrix} 2^{r} & 2^{k+1} \\end{pmatrix}}$$", "id": "3332070"}, {"introduction": "The most damning flaws of LCGs are often invisible in one dimension but become glaringly obvious when successive outputs are used to form points in higher-dimensional space. These points do not fall randomly, but are constrained to lie on a small number of parallel hyperplanes, a phenomenon known as lattice structure. This exercise demystifies the famous \"spectral test\" by guiding you through the process of deriving the generator's underlying lattice, characterizing its dual, and computing the maximum distance between these hyperplanes, which quantifies the generator's coarseness in three dimensions [@problem_id:3332090].", "problem": "Consider a Linear Congruential Generator (LCG) defined by the recursion $x_{n+1} \\equiv a x_{n} + c \\pmod m$, with $a \\in \\mathbb{Z}$, $c \\in \\mathbb{Z}$, and $m \\in \\mathbb{Z}_{>0}$. Define the normalized outputs $U_{n} = x_{n} / m \\in [0,1)$. For a fixed dimension $k \\in \\mathbb{Z}_{\\ge 2}$, consider the $k$-dimensional point set $P_{k} = \\{(U_{n}, U_{n+1}, \\dots, U_{n+k-1}) : n \\in \\mathbb{Z}\\} \\subset [0,1)^{k}$.\n\nWork in the specific case $m = 31$, $a = 3$, $c = 0$, and $k = 3$. Using only the fundamental definitions of the LCG, modular arithmetic, Euclidean lattices, and dual lattices, do the following:\n\n1) Derive a full-rank lattice $L \\subset \\mathbb{R}^{3}$, given explicitly by a basis matrix $B \\in \\mathbb{R}^{3 \\times 3}$, such that the lifted point set in $\\mathbb{R}^{3}$ obtained from $P_{3}$ lies within a finite union of translates of $L$ by vectors in $\\mathbb{Z}^{3}$. Your derivation must start from the recursion defining $x_{n}$ and the fact that $x_{n+j} \\equiv a^{j} x_{n} \\pmod m$ when $c = 0$.\n\n2) From the definition of the dual lattice, $L^{\\ast} = \\{h \\in \\mathbb{R}^{3} : h \\cdot y \\in \\mathbb{Z} \\text{ for all } y \\in L\\}$, derive an explicit characterization of all integer vectors $h = (h_{1}, h_{2}, h_{3}) \\in \\mathbb{Z}^{3}$ that define families of parallel hyperplanes through the condition $h \\cdot u \\in \\mathbb{Z}$ for all $u \\in P_{3}$. Express this characterization as a congruence in $\\mathbb{Z}/m\\mathbb{Z}$.\n\n3) Among all nonzero $h \\in \\mathbb{Z}^{3}$ satisfying the congruence from part $2$, determine one of minimal Euclidean norm. Then, using the geometric fact that the distance between consecutive parallel hyperplanes orthogonal to $h$ on which the points lie equals the reciprocal of the Euclidean norm $\\|h\\|_{2}$, compute the maximum possible interplane distance for this LCG in dimension $k=3$.\n\nGive your final answer as a single exact analytic expression for that maximum distance. Do not round your result and do not include units.", "solution": "### Part 1: Derivation of the Lattice $L$\n\nThe points generated by the LCG, when scaled by the modulus $m$, inhabit an integer lattice. The normalized points $P_3 = \\{(U_n, U_{n+1}, U_{n+2})\\}$ are a subset of a scaled version of this integer lattice, modulo integer vectors.\n\nThe sequence of integer states $(x_n, x_{n+1}, x_{n+2})$ is generated by the recursion $x_{j+1} \\equiv a x_j \\pmod m$. For $k=3$ and $c=0$, this gives the relations:\n$x_{n+1} \\equiv 3 x_n \\pmod{31}$\n$x_{n+2} \\equiv 3 x_{n+1} \\pmod{31}$\n\nThe problem asks for a lattice $L \\subset \\mathbb{R}^3$. The points of the LCG, $u_n = (x_n/m, x_{n+1}/m, x_{n+2}/m)$, are known to lie on a lattice structure. We first identify the integer lattice $\\Lambda \\subset \\mathbb{Z}^3$ containing all integer vectors $y=(y_1, y_2, y_3)$ that satisfy the same recurrence relations as the LCG states:\n$y_2 \\equiv 3 y_1 \\pmod{31}$\n$y_3 \\equiv 3 y_2 \\pmod{31}$\n\nThis system of congruences defines the integer lattice $\\Lambda$. We can find a basis for $\\Lambda$. Any vector $y \\in \\Lambda$ can be expressed as an integer linear combination of basis vectors.\nA general solution to these congruences can be written as:\n$y_2 = 3y_1 + 31j_1$\n$y_3 = 3y_2 + 31j_2 = 3(3y_1 + 31j_1) + 31j_2 = 9y_1 + 93j_1 + 31j_2$\nwhere $y_1, j_1, j_2$ are arbitrary integers.\n\nWe can express an arbitrary vector $y \\in \\Lambda$ as:\n$y = (y_1, 3y_1 + 31j_1, 9y_1 + 93j_1 + 31j_2)$\n$y = y_1(1, 3, 9) + j_1(0, 31, 93) + j_2(0, 0, 31)$\nThis shows that the vectors $b_1' = (1, 3, 9)$, $b_2' = (0, 31, 93)$, and $b_3' = (0, 0, 31)$ form a basis for $\\Lambda$.\n\nThe lattice $L \\subset \\mathbb{R}^3$ described in the problem is the integer lattice $\\Lambda$ scaled by the factor $1/m = 1/31$. A basis for $L$ is obtained by scaling the basis vectors of $\\Lambda$ by $1/31$:\n$b_1 = \\frac{1}{31} b_1' = (\\frac{1}{31}, \\frac{3}{31}, \\frac{9}{31})$\n$b_2 = \\frac{1}{31} b_2' = (0, 1, 3)$\n$b_3 = \\frac{1}{31} b_3' = (0, 0, 1)$\n\nThe basis matrix $B$ for the lattice $L$ is formed by these basis vectors as rows:\n$$B = \\begin{pmatrix} \\frac{1}{31} & \\frac{3}{31} & \\frac{9}{31} \\\\ 0 & 1 & 3 \\\\ 0 & 0 & 1 \\end{pmatrix}$$\nAny LCG point $u_n = (\\frac{x_n}{31}, \\frac{x_{n+1}}{31}, \\frac{x_{n+2}}{31})$ can be shown to be a point in $L$, and the set of all such points $P_3$ is a subset of $L$.\n\n### Part 2: Characterization of Integer Dual Lattice Vectors\n\nThe dual lattice $L^*$ is defined as $L^* = \\{ h \\in \\mathbb{R}^3 : h \\cdot y \\in \\mathbb{Z} \\text{ for all } y \\in L \\}$.\nA basis for $L^*$ is given by the rows of the matrix $B^* = (B^{-1})^T = (B^T)^{-1}$.\nThe transpose of our basis matrix $B$ is:\n$$B^T = \\begin{pmatrix} \\frac{1}{31} & 0 & 0 \\\\ \\frac{3}{31} & 1 & 0 \\\\ \\frac{9}{31} & 3 & 1 \\end{pmatrix}$$\nThe inverse of $B^T$ is:\n$$B^* = (B^T)^{-1} = \\begin{pmatrix} 31 & 0 & 0 \\\\ -3 & 1 & 0 \\\\ 0 & -3 & 1 \\end{pmatrix}$$\nThe rows of $B^*$ form a basis for $L^*$. An arbitrary vector $h \\in L^*$ is an integer linear combination of these basis vectors:\n$h = n_1(31, 0, 0) + n_2(-3, 1, 0) + n_3(0, -3, 1)$ for integers $n_1, n_2, n_3$.\n\nWe are interested in vectors $h = (h_1, h_2, h_3)$ that are also in $\\mathbb{Z}^3$.\n$h_1 = 31n_1 - 3n_2$\n$h_2 = n_2 - 3n_3$\n$h_3 = n_3$\nFor $h$ to be an integer vector, its components must be integers. Since $n_1, n_2, n_3$ are integers, this is always true. We need to find the condition on an integer vector $(h_1, h_2, h_3)$ for it to be representable in this form.\nFrom the equations above, we can express the coefficients $n_i$ in terms of the components $h_i$:\n$n_3 = h_3$\n$n_2 = h_2 + 3n_3 = h_2 + 3h_3$\n$31n_1 = h_1 + 3n_2 = h_1 + 3(h_2 + 3h_3) = h_1 + 3h_2 + 9h_3$\nFor $n_1$ to be an integer, the right-hand side must be divisible by $31$. This gives the necessary and sufficient condition for an integer vector $h$ to be in $L^*$:\n$$h_1 + 3h_2 + 9h_3 \\equiv 0 \\pmod{31}$$\nThis is the required explicit characterization.\n\n### Part 3: Minimal Norm Vector and Maximum Interplane Distance\n\nWe must find a non-zero integer vector $h=(h_1, h_2, h_3)$ that satisfies $h_1 + 3h_2 + 9h_3 \\equiv 0 \\pmod{31}$ and minimizes the Euclidean norm $\\|h\\|_2 = \\sqrt{h_1^2 + h_2^2 + h_3^2}$. This is equivalent to minimizing the squared norm $\\|h\\|_2^2 = h_1^2+h_2^2+h_3^2$.\n\nThis is a shortest vector problem in the lattice defined by the congruence. We can search for the solution by testing vectors with small integer components. For any choice of $h_2$ and $h_3$, the value of $h_1$ is constrained by $h_1 \\equiv -(3h_2 + 9h_3) \\pmod{31}$. To minimize $|h_1|$, we choose the representative of the congruence class with the smallest absolute value.\n\nLet's test small values for $(h_2, h_3)$:\n- $(h_2,h_3) = (1,0) \\implies h_1 \\equiv -3 \\pmod{31}$. We choose $h_1=-3$. Vector is $h=(-3,1,0)$. $\\|h\\|_2^2 = (-3)^2+1^2+0^2 = 10$.\n- $(h_2,h_3) = (0,1) \\implies h_1 \\equiv -9 \\pmod{31}$. We choose $h_1=-9$. Vector is $h=(-9,0,1)$. $\\|h\\|_2^2 = (-9)^2+0^2+1^2 = 82$.\n- $(h_2,h_3) = (3,-1) \\implies h_1 \\equiv -(9-9)=0 \\pmod{31}$. We choose $h_1=0$. Vector is $h=(0,3,-1)$. $\\|h\\|_2^2 = 0^2+3^2+(-1)^2 = 10$.\n- $(h_2,h_3) = (2,-1) \\implies h_1 \\equiv -(6-9) = 3 \\pmod{31}$. We choose $h_1=3$. Vector is $h=(3,2,-1)$. $\\|h\\|_2^2 = 3^2+2^2+(-1)^2 = 14$.\n\nA systematic search reveals that the minimum non-zero squared norm is $10$. Two vectors achieving this minimum are $h=(-3,1,0)$ and $h=(0,3,-1)$.\nThe minimal Euclidean norm for a non-zero integer vector $h$ satisfying the condition is therefore $\\|h\\|_{\\text{min}} = \\sqrt{10}$.\n\nThe LCG points $u_n$ all lie on the family of parallel hyperplanes defined by $h \\cdot x = j$ for integers $j$. The geometric interpretation of the spectral test states that the maximal distance between these consecutive hyperplanes is the reciprocal of the minimal norm of such a non-zero integer vector $h$.\n\nThe maximum possible interplane distance is:\n$$d_{\\text{max}} = \\frac{1}{\\|h\\|_{\\text{min}}} = \\frac{1}{\\sqrt{10}}$$\nThis is the final answer, an exact analytic expression.", "answer": "$$\\boxed{\\frac{1}{\\sqrt{10}}}$$", "id": "3332090"}]}