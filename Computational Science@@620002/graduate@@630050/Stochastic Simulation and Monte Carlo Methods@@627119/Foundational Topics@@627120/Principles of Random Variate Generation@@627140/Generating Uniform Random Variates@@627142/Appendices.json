{"hands_on_practices": [{"introduction": "Linear Congruential Generators (LCGs) form the bedrock of classical pseudorandom number generation, built upon a simple yet powerful recurrence relation. This exercise invites you to look beyond generating numbers one by one and explore the generator's underlying algebraic structure. By deriving a closed-form expression for advancing the generator's state, you will develop a \"skip-ahead\" technique that is indispensable for initializing parallel streams in large-scale simulations [@problem_id:3310000].", "problem": "Consider the linear congruential generator (LCG) defined on the ring of integers modulo $m$, denoted $\\mathbb{Z}_m$, by the recurrence $X_{n+1} \\equiv a X_n + c \\pmod{m}$ with fixed parameters $a \\in \\mathbb{Z}_m$, $c \\in \\mathbb{Z}_m$, and $m \\geq 2$. The corresponding sequence of uniform variates is $U_n = X_n / m$. Starting from this definition and the algebraic properties of $\\mathbb{Z}_m$, derive a closed-form expression for $X_{n+t}$ in terms of $X_n$, $a$, $c$, $t$, and $m$, without assuming any special number-theoretic properties of $a$, $c$, or $m$. Then, using only first-principles reasoning and ring algebra, explain how to compute the skip-ahead $X_{n+t}$ efficiently in time $\\mathcal{O}(\\log t)$ by combining exponentiation by squaring in $\\mathbb{Z}_m$ with modular inverses when they exist (that is, when $\\gcd(a-1, m) = 1$). If $\\gcd(a-1, m) \\neq 1$, explain an alternative method that avoids division in $\\mathbb{Z}_m$.\n\nFinally, apply your derivation and method to the specific instance with $m = 1009$, $a = 7$, $c = 11$, initial state $X_0 = 123$, and skip length $t = 20$. Compute the exact value of $X_{20}$ satisfying $0 \\leq X_{20}  m$, and report this integer. No rounding is required, and no units are involved in the final answer.", "solution": "The problem asks for a derivation of a closed-form expression for a linear congruential generator (LCG), an explanation of efficient computation methods, and a specific calculation.\n\nFirst, we derive the closed-form expression for $X_{n+t}$. The LCG is defined by the recurrence relation $X_{k+1} \\equiv a X_k + c \\pmod{m}$ for $k \\ge 0$. We can unroll this recurrence starting from state $X_n$.\nFor $t=1$:\n$X_{n+1} \\equiv a X_n + c \\pmod{m}$\n\nFor $t=2$:\n$X_{n+2} \\equiv a X_{n+1} + c \\equiv a(a X_n + c) + c \\equiv a^2 X_n + ac + c \\pmod{m}$\n\nFor $t=3$:\n$X_{n+3} \\equiv a X_{n+2} + c \\equiv a(a^2 X_n + ac + c) + c \\equiv a^3 X_n + a^2 c + ac + c \\pmod{m}$\n\nA pattern emerges. For a general integer $t \\ge 1$, the expression appears to be:\n$$X_{n+t} \\equiv a^t X_n + c(a^{t-1} + a^{t-2} + \\dots + a + 1) \\pmod{m}$$\nThis can be written more compactly using summation notation:\n$$X_{n+t} \\equiv a^t X_n + c \\sum_{i=0}^{t-1} a^i \\pmod{m}$$\nWe prove this formula by induction on $t$. The base case for $t=1$ is $X_{n+1} \\equiv a^1 X_n + c \\sum_{i=0}^{0} a^i \\equiv a X_n + c a^0 \\equiv aX_n + c$, which is the definition of the LCG.\nAssume the formula holds for some integer $k \\ge 1$: $X_{n+k} \\equiv a^k X_n + c \\sum_{i=0}^{k-1} a^i \\pmod{m}$.\nWe then show it holds for $k+1$:\n\\begin{align*} X_{n+k+1}  \\equiv a X_{n+k} + c \\\\  \\equiv a \\left( a^k X_n + c \\sum_{i=0}^{k-1} a^i \\right) + c \\\\  \\equiv a^{k+1} X_n + c \\left( a \\sum_{i=0}^{k-1} a^i \\right) + c \\\\  \\equiv a^{k+1} X_n + c \\left( \\sum_{i=0}^{k-1} a^{i+1} \\right) + c \\\\  \\equiv a^{k+1} X_n + c \\left( \\sum_{j=1}^{k} a^j + 1 \\right) \\\\  \\equiv a^{k+1} X_n + c \\sum_{j=0}^{k} a^j \\pmod{m}\\end{align*}\nThe formula holds for $k+1$, so by the principle of mathematical induction, the closed-form expression for $X_{n+t}$ for any $t \\ge 1$ is:\n$$X_{n+t} \\equiv a^t X_n + c \\sum_{i=0}^{t-1} a^i \\pmod{m}$$\nThis expression is derived using only the recurrence definition and ring properties of $\\mathbb{Z}_m$ and does not depend on any special properties of $a$, $c$, or $m$.\n\nNext, we explain how to compute $X_{n+t}$ efficiently in time $\\mathcal{O}(\\log t)$. The computation requires evaluating $a^t \\pmod{m}$ and the geometric sum $S_t = \\sum_{i=0}^{t-1} a^i \\pmod{m}$.\n\nCase 1: $\\gcd(a-1, m) = 1$.\nIn this case, the element $(a-1)$ has a multiplicative inverse in the ring $\\mathbb{Z}_m$, denoted $(a-1)^{-1}$. The sum of a finite geometric series has a well-known formula, which holds in any ring where the denominator is invertible:\n$$\\sum_{i=0}^{t-1} a^i = (a^t - 1)(a-1)^{-1}$$\nSubstituting this into the closed-form expression gives:\n$$X_{n+t} \\equiv a^t X_n + c (a^t - 1)(a-1)^{-1} \\pmod{m}$$\nThe computation proceeds as follows:\n1. Compute $A = a^t \\pmod{m}$. This can be done efficiently using exponentiation by squaring in $\\mathcal{O}(\\log t)$ time.\n2. Compute $B = (a-1)^{-1} \\pmod{m}$. This is found using the Extended Euclidean Algorithm, which has a time complexity of $\\mathcal{O}(\\log m)$.\n3. Assemble the final result using modular operations: $X_{n+t} \\equiv A \\cdot X_n + c \\cdot (A - 1) \\cdot B \\pmod{m}$. These are a constant number of operations.\nThe dominant cost is the modular exponentiation, so the total time complexity is $\\mathcal{O}(\\log t+\\log m)$, which is typically simplified to $\\mathcal{O}(\\log t)$ as $t$ is the variable of interest for skipping ahead.\n\nCase 2: $\\gcd(a-1, m) \\neq 1$.\nIn this scenario, $(a-1)$ is not invertible modulo $m$, and the fractional formula for the geometric sum cannot be directly used. We must use an alternative method. The recurrence relation can be expressed in matrix form by augmenting the state vector:\n$$\\begin{pmatrix} X_{k+1} \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} a  c \\\\ 0  1 \\end{pmatrix} \\begin{pmatrix} X_k \\\\ 1 \\end{pmatrix}$$\nThis is a linear transformation on the augmented state vector. Applying this transformation $t$ times gives:\n$$\\begin{pmatrix} X_{n+t} \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} a  c \\\\ 0  1 \\end{pmatrix}^t \\begin{pmatrix} X_n \\\\ 1 \\end{pmatrix}$$\nThe problem reduces to computing the $t$-th power of the $2 \\times 2$ matrix $M = \\begin{pmatrix} a  c \\\\ 0  1 \\end{pmatrix}$. This can be done in $\\mathcal{O}(\\log t)$ time using exponentiation by squaring for matrices. The entries of $M^t$ can be found by induction to be:\n$$M^t = \\begin{pmatrix} a^t  c \\sum_{i=0}^{t-1} a^i \\\\ 0  1 \\end{pmatrix}$$\nThus, performing matrix exponentiation by squaring computes both $a^t$ and $c \\sum_{i=0}^{t-1} a^i$ simultaneously, without requiring any modular division. Each step in the squaring algorithm involves one $2 \\times 2$ matrix multiplication, which consists of $8$ integer multiplications and $4$ integer additions in $\\mathbb{Z}_m$. The overall complexity is therefore $\\mathcal{O}(\\log t)$. This method is general and works for any parameters $a, c, m$.\n\nFinally, we apply this to the specific instance: $m = 1009$, $a = 7$, $c = 11$, $X_0 = 123$, and $t = 20$. We need to compute $X_{20}$.\nFirst, we check the condition for using the simpler method (Case 1). We evaluate $\\gcd(a-1, m) = \\gcd(7-1, 1009) = \\gcd(6, 1009)$. Since $1009$ is not divisible by $2$ (it is odd) and not divisible by $3$ (its digit sum is $1+0+0+9=10$), we have $\\gcd(6, 1009) = 1$. Thus, we can use the method involving the modular inverse.\n\nThe formula is $X_{20} \\equiv a^{20} X_0 + c (a^{20} - 1)(a-1)^{-1} \\pmod m$.\n\n1. Compute $a^{20} \\pmod m$, i.e., $7^{20} \\pmod{1009}$. We use exponentiation by squaring. The binary representation of $t=20$ is $10100_2$, so $20 = 16+4$.\n$7^1 \\equiv 7 \\pmod{1009}$\n$7^2 \\equiv 49 \\pmod{1009}$\n$7^4 \\equiv 49^2 = 2401 \\equiv 2 \\cdot 1009 + 383 \\equiv 383 \\pmod{1009}$\n$7^8 \\equiv 383^2 = 146689 \\equiv 145 \\cdot 1009 + 384 \\equiv 384 \\pmod{1009}$\n$7^{16} \\equiv 384^2 = 147456 \\equiv 146 \\cdot 1009 + 142 \\equiv 142 \\pmod{1009}$\n$7^{20} = 7^{16} \\cdot 7^4 \\equiv 142 \\cdot 383 = 54386 \\equiv 53 \\cdot 1009 + 909 \\equiv 909 \\pmod{1009}$.\n\n2. Compute $(a-1)^{-1} \\pmod m$, i.e., $6^{-1} \\pmod{1009}$. We use the Extended Euclidean Algorithm on $1009$ and $6$.\n$1009 = 168 \\cdot 6 + 1$\nRearranging gives the Bézout's identity: $1 = 1009 - 168 \\cdot 6$.\nTaking this equation modulo $1009$, we get $1 \\equiv -168 \\cdot 6 \\pmod{1009}$.\nSo, $6^{-1} \\equiv -168 \\equiv -168 + 1009 \\equiv 841 \\pmod{1009}$.\n\n3. Combine the results to find $X_{20}$.\n$X_{20} \\equiv 7^{20} \\cdot X_0 + 11 \\cdot (7^{20} - 1) \\cdot 6^{-1} \\pmod{1009}$\n$X_{20} \\equiv 909 \\cdot 123 + 11 \\cdot (909 - 1) \\cdot 841 \\pmod{1009}$\n$X_{20} \\equiv 909 \\cdot 123 + 11 \\cdot 908 \\cdot 841 \\pmod{1009}$\n\nCalculate the two terms separately:\nTerm 1: $909 \\cdot 123 = 111807$.\n$111807 = 110 \\cdot 1009 + 817$. So, $909 \\cdot 123 \\equiv 817 \\pmod{1009}$.\n\nTerm 2: $11 \\cdot 908 \\cdot 841 \\pmod{1009}$.\n$11 \\cdot 908 = 9988$. $9988 = 9 \\cdot 1009 + 907$. So, $11 \\cdot 908 \\equiv 907 \\pmod{1009}$.\nNow compute $907 \\cdot 841 = 762787$.\n$762787 = 755 \\cdot 1009 + 992$. So, $907 \\cdot 841 \\equiv 992 \\pmod{1009}$.\n\nFinally, add the two terms:\n$X_{20} \\equiv 817 + 992 \\pmod{1009}$\n$X_{20} \\equiv 1809 \\pmod{1009}$\n$X_{20} \\equiv 1 \\cdot 1009 + 800 \\pmod{1009}$\n$X_{20} \\equiv 800 \\pmod{1009}$\n\nThe value of $X_{20}$ is $800$.", "answer": "$$\\boxed{800}$$", "id": "3310000"}, {"introduction": "While LCGs produce sequences that can appear random at first glance, their simple linear nature imposes hidden geometric structures. This practice challenges you to uncover one of the most famous flaws of multiplicative LCGs: the fact that sequential points lie on a small number of parallel hyperplanes. By deriving this property from first principles and verifying it with a concrete example, you will gain a deep, intuitive understanding of the lattice structure that underpins generator quality and the motivation for the spectral test [@problem_id:3309974].", "problem": "Consider a Linear Congruential Generator (LCG), defined by the recurrence $X_{n+1} \\equiv a X_{n} + c \\pmod{m}$, used to generate pseudorandom integers $X_{n} \\in \\{0,1,\\dots,m-1\\}$, and its associated normalized sequence $U_{n} = X_{n}/m$, which is used to approximate independent draws from the uniform distribution on the unit interval. Let $s \\geq 2$ be fixed and form the $s$-dimensional points $\\mathbf{U}_{n} = (U_{n}, U_{n+1}, \\dots, U_{n+s-1}) \\in [0,1)^{s}$.\n\nStarting only from modular arithmetic and the definition of the LCG and normalization, derive the exact count of distinct parallel affine hyperplanes in $\\mathbb{R}^{s}$ (codimension $1$ subsets) of the form $b \\cdot \\mathbf{U}_{n} = t$ that are occupied by the point set $\\{\\mathbf{U}_{n}\\}$ when $c=0$ and $a  m$, where $b = (a, -1, 0, \\dots, 0)$ and $t$ ranges over values determined by the generator’s arithmetic. Your derivation must justify why these hyperplanes arise and must determine the precise number of distinct $t$ values that occur across all possible seeds $X_{0} \\in \\{0,1,\\dots,m-1\\}$.\n\nThen, set $s=3$ and the LCG parameters to $m = 13$, $a = 5$, and $c = 0$. Using exhaustive enumeration over all $X_{n} \\in \\{0,1,\\dots,12\\}$, verify your theoretical count empirically by determining the set of distinct values taken by $a U_{n} - U_{n+1}$ and counting them. Conclude with the exact number of distinct parallel affine hyperplanes of the form $a U_{n} - U_{n+1} = t$ occupied by the three-dimensional point set $\\{\\mathbf{U}_{n}\\}$ for these parameters. Provide your final answer as a single real-valued number. No rounding is required.", "solution": "The problem statement has been validated and is determined to be a well-posed and scientifically grounded problem in the mathematical analysis of pseudorandom number generators. It is free of any internal contradictions, ambiguities, or factual unsoundness. We may therefore proceed with a formal solution.\n\nThe problem asks for two main results: first, a general derivation for the number of hyperplanes that contain the points generated by a specific type of Linear Congruential Generator (LCG), and second, an empirical verification of this result for a given set of parameters.\n\n**Part 1: General Theoretical Derivation**\n\nWe are given a Linear Congruential Generator defined by the recurrence relation:\n$$X_{n+1} \\equiv a X_{n} + c \\pmod{m}$$\nThe problem specifies the case where the additive constant $c=0$. The recurrence simplifies to:\n$$X_{n+1} \\equiv a X_{n} \\pmod{m}$$\nThe values $X_n$ are integers in the set $\\{0, 1, \\dots, m-1\\}$. From these integers, a sequence of normalized real numbers $U_n$ is generated by $U_n = X_n / m$. These values fall in the interval $[0, 1)$. Subsequently, $s$-dimensional vectors are formed as $\\mathbf{U}_{n} = (U_{n}, U_{n+1}, \\dots, U_{n+s-1})$.\n\nWe are asked to investigate the geometric structure of the set of points $\\{\\mathbf{U}_n\\}$ by considering the affine hyperplanes they occupy. The family of hyperplanes is defined by the equation $b \\cdot \\mathbf{U}_{n} = t$, where the normal vector is given as $b = (a, -1, 0, \\dots, 0)$. The dot product is:\n$$b \\cdot \\mathbf{U}_{n} = a U_n + (-1) U_{n+1} + \\sum_{i=2}^{s-1} 0 \\cdot U_{n+i} = a U_n - U_{n+1}$$\nTherefore, the equation for the hyperplanes is:\n$$a U_n - U_{n+1} = t$$\nOur goal is to find the number of distinct values that $t$ can take as $X_n$ ranges over all possible values $\\{0, 1, \\dots, m-1\\}$.\n\nLet us substitute the definitions of $U_n$ and $U_{n+1}$ in terms of $X_n$ and $X_{n+1}$:\n$$t = a \\frac{X_n}{m} - \\frac{X_{n+1}}{m} = \\frac{a X_n - X_{n+1}}{m}$$\nFrom the LCG recurrence $X_{n+1} \\equiv a X_n \\pmod{m}$, we know that $a X_n - X_{n+1}$ must be an integer multiple of $m$. Let us write this explicitly. The definition of the modulo operator implies that there exists an integer, let's call it $k_n$, such that:\n$$a X_n = k_n m + X_{n+1}$$\nwhere $X_{n+1}$ is the remainder of the division of $a X_n$ by $m$. The integer $k_n$ is the quotient of this division, which can be expressed using the floor function:\n$$k_n = \\left\\lfloor \\frac{a X_n}{m} \\right\\rfloor$$\nRearranging the equation $a X_n = k_n m + X_{n+1}$ gives $a X_n - X_{n+1} = k_n m$.\n\nNow we substitute this back into our expression for $t$:\n$$t = \\frac{k_n m}{m} = k_n$$\nThis is a critical insight: the values $t$ that define the distinct hyperplanes are precisely the integer values $k_n$ generated by the LCG's arithmetic. To find the number of distinct hyperplanes, we must find the number of distinct values taken by $k_n = \\lfloor \\frac{a X_n}{m} \\rfloor$ as $X_n$ spans all possibilities. The problem specifies that we consider all possible seeds $X_0 \\in \\{0, 1, \\dots, m-1\\}$, which implies we must consider all possible states $X_n \\in \\{0, 1, \\dots, m-1\\}$.\n\nLet's analyze the range of values for $k_n$ for $X_n \\in \\{0, 1, \\dots, m-1\\}$.\nThe argument of the floor function is $\\frac{a X_n}{m}$.\nThe minimum value occurs at $X_n=0$:\n$$k_{\\min} = \\left\\lfloor \\frac{a \\cdot 0}{m} \\right\\rfloor = \\lfloor 0 \\rfloor = 0$$\nThe maximum value occurs at $X_n=m-1$:\n$$k_{\\max} = \\left\\lfloor \\frac{a (m-1)}{m} \\right\\rfloor = \\left\\lfloor \\frac{am - a}{m} \\right\\rfloor = \\left\\lfloor a - \\frac{a}{m} \\right\\rfloor$$\nThe problem states that $a$ is an integer and $a  m$. This implies that $0  \\frac{a}{m}  1$.\nTherefore, $a-1  a - \\frac{a}{m}  a$. The floor of this value is:\n$$k_{\\max} = a-1$$\nThe values of $k_n$ are integers ranging from a minimum of $0$ to a maximum of $a-1$. We must also confirm that all integer values between $0$ and $a-1$ are achieved. An integer $j$ is in the set of possible values for $k_n$ if there exists an $X_n \\in \\{0, 1, \\dots, m-1\\}$ such that $\\lfloor \\frac{a X_n}{m} \\rfloor = j$. This is equivalent to the condition $j \\le \\frac{a X_n}{m}  j+1$, or $\\frac{jm}{a} \\le X_n  \\frac{(j+1)m}{a}$. The length of this interval for $X_n$ is $\\frac{m}{a}$. Since $a  m$, the length is greater than $1$, guaranteeing that at least one integer $X_n$ exists in the interval. Thus, all integers $j$ from $0$ to $a-1$ are indeed possible values for $k_n$.\n\nThe set of all possible values for $t$ is $\\{0, 1, \\dots, a-1\\}$. The number of distinct values is $(a-1) - 0 + 1 = a$.\nTherefore, for an LCG with $c=0$ and $am$, the points $\\mathbf{U}_n$ lie on exactly $a$ distinct parallel hyperplanes of the form $aU_n - U_{n+1} = t$.\n\n**Part 2: Empirical Verification**\n\nWe are given the specific parameters $s=3$, $m=13$, $a=5$, and $c=0$. The condition $am$ ($513$) is satisfied.\nBased on our theoretical derivation, the number of distinct hyperplanes should be $a=5$. The hyperplanes should correspond to $t \\in \\{0, 1, 2, 3, 4\\}$.\n\nWe are asked to verify this by exhaustive enumeration. We need to compute the value of $t = a U_n - U_{n+1}$ for all possible values of $X_n \\in \\{0, 1, \\dots, 12\\}$.\nThe LCG is $X_{n+1} \\equiv 5 X_n \\pmod{13}$. The expression for $t$ is $t = \\frac{5 X_n - X_{n+1}}{13}$, where $X_{n+1}$ is the result of the LCG step. Let's compute $X_{n+1}$ and then $t$ for each $X_n$:\n\n- For $X_n=0$: $X_{n+1} = 5 \\cdot 0 \\pmod{13} = 0$. So, $t = \\frac{5(0) - 0}{13} = 0$.\n- For $X_n=1$: $X_{n+1} = 5 \\cdot 1 \\pmod{13} = 5$. So, $t = \\frac{5(1) - 5}{13} = 0$.\n- For $X_n=2$: $X_{n+1} = 5 \\cdot 2 \\pmod{13} = 10$. So, $t = \\frac{5(2) - 10}{13} = 0$.\n- For $X_n=3$: $X_{n+1} = 5 \\cdot 3 \\pmod{13} = 15 \\pmod{13} = 2$. So, $t = \\frac{5(3) - 2}{13} = \\frac{13}{13} = 1$.\n- For $X_n=4$: $X_{n+1} = 5 \\cdot 4 \\pmod{13} = 20 \\pmod{13} = 7$. So, $t = \\frac{5(4) - 7}{13} = \\frac{13}{13} = 1$.\n- For $X_n=5$: $X_{n+1} = 5 \\cdot 5 \\pmod{13} = 25 \\pmod{13} = 12$. So, $t = \\frac{5(5) - 12}{13} = \\frac{13}{13} = 1$.\n- For $X_n=6$: $X_{n+1} = 5 \\cdot 6 \\pmod{13} = 30 \\pmod{13} = 4$. So, $t = \\frac{5(6) - 4}{13} = \\frac{26}{13} = 2$.\n- For $X_n=7$: $X_{n+1} = 5 \\cdot 7 \\pmod{13} = 35 \\pmod{13} = 9$. So, $t = \\frac{5(7) - 9}{13} = \\frac{26}{13} = 2$.\n- For $X_n=8$: $X_{n+1} = 5 \\cdot 8 \\pmod{13} = 40 \\pmod{13} = 1$. So, $t = \\frac{5(8) - 1}{13} = \\frac{39}{13} = 3$.\n- For $X_n=9$: $X_{n+1} = 5 \\cdot 9 \\pmod{13} = 45 \\pmod{13} = 6$. So, $t = \\frac{5(9) - 6}{13} = \\frac{39}{13} = 3$.\n- For $X_n=10$: $X_{n+1} = 5 \\cdot 10 \\pmod{13} = 50 \\pmod{13} = 11$. So, $t = \\frac{5(10) - 11}{13} = \\frac{39}{13} = 3$.\n- For $X_n=11$: $X_{n+1} = 5 \\cdot 11 \\pmod{13} = 55 \\pmod{13} = 3$. So, $t = \\frac{5(11) - 3}{13} = \\frac{52}{13} = 4$.\n- For $X_n=12$: $X_{n+1} = 5 \\cdot 12 \\pmod{13} = 60 \\pmod{13} = 8$. So, $t = \\frac{5(12) - 8}{13} = \\frac{52}{13} = 4$.\n\nThe set of distinct values taken by $t = a U_n - U_{n+1}$ is $\\{0, 1, 2, 3, 4\\}$.\nThe count of these distinct values is $5$. This empirical result perfectly matches the theoretical prediction of $a=5$.\n\n**Conclusion**\n\nThe theoretical derivation shows that for an LCG with $c=0$ and multiplier $a  m$, the points $\\mathbf{U}_n$ are constrained to lie on $a$ parallel hyperplanes. For the specific parameters $m=13$ and $a=5$, the expected number of hyperplanes is $5$. This is confirmed by direct computation over all possible states of the generator. The specified three-dimensional points $\\{\\mathbf{U}_n\\}$ for this LCG are therefore confined to exactly $5$ distinct parallel planes given by $5U_n - U_{n+1} = t$ for $t \\in \\{0, 1, 2, 3, 4\\}$. The number of these planes is $5$.", "answer": "$$\\boxed{5}$$", "id": "3309974"}, {"introduction": "The journey from a pseudorandom integer to a usable uniform variate involves a crucial final step: mapping the integer into the unit interval. This exercise explores how subtle differences in this mapping can have dramatic consequences for simulation applications. By analyzing the probability of generating the exact endpoint values of $0$ and $1$, you will discover how a seemingly innocuous choice can lead to catastrophic failures, such as producing infinite values, when using the inverse transform method [@problem_id:3309936].", "problem": "A pseudorandom number generator (PRNG) produces independent and identically distributed bits. Consider generating floating-point approximations to a Uniform distribution on the unit interval using two integer-to-float mapping schemes based on $b=53$ bits of precision, as typically used to populate the significand of a double-precision floating-point number.\n\n- Scheme A (right-open discretization): Sample $I$ uniformly from the discrete set $\\{0,1,2,\\ldots,2^{53}-1\\}$ and set $U_{A} = I / 2^{53}$.\n- Scheme B (closed discretization): Sample $J$ uniformly from the discrete set $\\{0,1,2,\\ldots,2^{53}\\}$ and set $U_{B} = J / 2^{53}$.\n\nYou will analyze the exact probabilities of generating the boundary values $U=0$ and $U=1$ under each scheme, and then assess the consequence of these probabilities on inverse-transform sampling for a heavy-tailed distribution.\n\nLet $F$ be the cumulative distribution function of a Pareto distribution with tail index $\\alpha > 0$ and scale $x_{m} > 0$, that is,\n$$ F(x) = \\begin{cases} 0,  x  x_{m} \\\\ 1 - \\left(\\dfrac{x_{m}}{x}\\right)^{\\alpha},  x \\ge x_{m} \\end{cases} $$\nIn inverse-transform sampling, one sets $X = F^{-1}(U)$ with $U$ uniform on $[0,1]$.\n\nStarting from the definitions of the discrete uniform distributions on finite sets and the inverse-transform method, do the following:\n\n1. Derive $P(U_{A} = 0)$, $P(U_{A} = 1)$, $P(U_{B} = 0)$, and $P(U_{B} = 1)$.\n2. Using only the definition of the Pareto cumulative distribution function above, derive $F^{-1}(u)$ for $u \\in [0,1]$ and determine, under each scheme, the exact probability that $X$ is infinite, i.e., $P(X = +\\infty)$.\n3. Now suppose you generate $N = 10^{12}$ independent variates $U_{B}^{(1)},\\ldots,U_{B}^{(N)}$ under Scheme B and transform each to $X^{(i)} = F^{-1}(U_{B}^{(i)})$. Compute the probability that at least one of the $X^{(i)}$ is $+\\infty$. Round your final numerical answer to four significant figures.\n\nYour final answer must be the single numerical value requested in item 3, rounded as specified, with no units.", "solution": "The problem requires an analysis of two different schemes for generating discrete approximations to a uniform random variate on the unit interval, and the consequences for inverse-transform sampling of a Pareto distribution. The solution is structured in three parts as requested.\n\n### Part 1: Probabilities of Boundary Values\n\nLet $b=53$.\n\n**Scheme A (right-open discretization)**\n\nUnder Scheme A, a random integer $I$ is drawn uniformly from the set $\\mathcal{I} = \\{0, 1, 2, \\ldots, 2^{b}-1\\}$. The size of this set is $|\\mathcal{I}| = 2^{b}$. The probability mass function for $I$ is $P(I=i) = \\frac{1}{2^{b}}$ for any $i \\in \\mathcal{I}$. The random variate is $U_{A} = I / 2^{b}$.\n\nWe determine the probabilities of generating the boundary values $0$ and $1$.\n\n-   **Probability of generating $U_{A}=0$**:\n    The event $U_{A}=0$ occurs if and only if $I=0$. Since $0 \\in \\mathcal{I}$, this event is possible. Its probability is:\n    $$P(U_{A}=0) = P(I=0) = \\frac{1}{2^{b}} = \\frac{1}{2^{53}}$$\n\n-   **Probability of generating $U_{A}=1$**:\n    The event $U_{A}=1$ occurs if and only if $I/2^{b}=1$, which implies $I=2^{b}$. However, the maximum value in the set $\\mathcal{I}$ is $2^{b}-1$. Therefore, $I=2^{b}$ is an impossible event.\n    $$P(U_{A}=1) = P(I=2^{b}) = 0$$\n\n**Scheme B (closed discretization)**\n\nUnder Scheme B, a random integer $J$ is drawn uniformly from the set $\\mathcal{J} = \\{0, 1, 2, \\ldots, 2^{b}\\}$. The size of this set is $|\\mathcal{J}| = 2^{b}+1$. The probability mass function for $J$ is $P(J=j) = \\frac{1}{2^{b}+1}$ for any $j \\in \\mathcal{J}$. The random variate is $U_{B} = J / 2^{b}$.\n\nWe determine the probabilities of generating the boundary values $0$ and $1$.\n\n-   **Probability of generating $U_{B}=0$**:\n    The event $U_{B}=0$ occurs if and only if $J=0$. Since $0 \\in \\mathcal{J}$, this event is possible. Its probability is:\n    $$P(U_{B}=0) = P(J=0) = \\frac{1}{2^{b}+1} = \\frac{1}{2^{53}+1}$$\n\n-   **Probability of generating $U_{B}=1$**:\n    The event $U_{B}=1$ occurs if and only if $J/2^{b}=1$, which implies $J=2^{b}$. Since $2^{b} \\in \\mathcal{J}$, this event is possible. Its probability is:\n    $$P(U_{B}=1) = P(J=2^{b}) = \\frac{1}{2^{b}+1} = \\frac{1}{2^{53}+1}$$\n\n### Part 2: Inverse CDF and Probability of Infinity\n\nFirst, we derive the inverse cumulative distribution function, $F^{-1}(u)$, for the Pareto distribution. The CDF is given by $F(x) = 1 - (x_{m}/x)^{\\alpha}$ for $x \\ge x_{m}$. We set $u = F(x)$ for $u$ in the range of $F$, which is $[0, 1)$, and solve for $x$:\n$$u = 1 - \\left(\\frac{x_{m}}{x}\\right)^{\\alpha}$$\n$$\\left(\\frac{x_{m}}{x}\\right)^{\\alpha} = 1 - u$$\n$$\\frac{x_{m}}{x} = (1 - u)^{1/\\alpha}$$\n$$x = \\frac{x_{m}}{(1 - u)^{1/\\alpha}} = x_{m}(1-u)^{-1/\\alpha}$$\nThus, for $u \\in [0, 1)$, the inverse CDF is $F^{-1}(u) = x_{m}(1-u)^{-1/\\alpha}$.\n\nThe problem requires considering $u \\in [0, 1]$. We must examine the behavior at $u=1$. As $u \\to 1^{-}$, the term $(1-u) \\to 0^{+}$, and thus $(1-u)^{-1/\\alpha} \\to +\\infty$ since $\\alpha  0$. It is therefore standard to define $F^{-1}(1) = +\\infty$.\n\nA sampled value $X$ from the Pareto distribution using the inverse-transform method, $X = F^{-1}(U)$, will be infinite if and only if the uniform variate $U$ is exactly $1$. Therefore, the probability $P(X=+\\infty)$ is equal to the probability $P(U=1)$.\n\nWe can now find this probability for each scheme using the results from Part 1.\n\n-   **Scheme A**:\n    $$P(X=+\\infty) = P(U_{A}=1) = 0$$\n\n-   **Scheme B**:\n    $$P(X=+\\infty) = P(U_{B}=1) = \\frac{1}{2^{53}+1}$$\n\nThis highlights a critical difference: Scheme A can never generate an infinite value, while Scheme B can, albeit with a very small probability.\n\n### Part 3: Probability of at Least One Infinite Variate\n\nWe are given $N = 10^{12}$ independent variates $U_{B}^{(i)}$ generated under Scheme B. For each $i \\in \\{1, \\ldots, N\\}$, we transform it to $X^{(i)} = F^{-1}(U_{B}^{(i)})$. We need to find the probability that at least one of these $X^{(i)}$ is $+\\infty$.\n\nLet $E_{i}$ be the event that $X^{(i)} = +\\infty$. As determined in Part 2, the probability of this event for a single trial is:\n$$p = P(E_{i}) = P(X = +\\infty \\text{ under Scheme B}) = \\frac{1}{2^{53}+1}$$\nThe trials are independent. The probability that at least one event $E_{i}$ occurs is $1$ minus the probability that none of them occur. The probability that a single event $E_{i}$ does not occur is $1-p$. The probability that none of the $N$ independent events occur is $(1-p)^{N}$.\n\nThe desired probability is:\n$$P(\\text{at least one } X^{(i)} = +\\infty) = 1 - (1-p)^{N} = 1 - \\left(1 - \\frac{1}{2^{53}+1}\\right)^{10^{12}}$$\n\nThis expression is exact. To compute its numerical value, we note that $N$ is very large and $p$ is very small. In such cases, the number of \"successes\" (occurrences of $X^{(i)}=+\\infty$) is well-approximated by a Poisson distribution with parameter $\\lambda = Np$. The probability of zero successes is $\\exp(-\\lambda)$. The probability of at least one success is $1 - \\exp(-\\lambda)$. This approximation is highly accurate.\n\nLet's compute $\\lambda$:\n$$\\lambda = Np = \\frac{10^{12}}{2^{53}+1}$$\nUsing $2^{53} = 9007199254740992$, we get:\n$$\\lambda = \\frac{10^{12}}{9007199254740993} \\approx 0.0001110223024625$$\nNow we compute the probability:\n$$P(\\text{at least one } \\infty) \\approx 1 - \\exp(-\\lambda) = 1 - \\exp(-0.0001110223024625)$$\nUsing a calculator,\n$$P(\\text{at least one } \\infty) \\approx 1 - 0.9998889838318...$$\n$$P(\\text{at least one } \\infty) \\approx 0.00011101616818...$$\nThe problem requires rounding the final answer to four significant figures. The first four significant figures are $1, 1, 1, 0$. The fifth significant figure is $1$, so we do not round up the fourth figure.\n\nThe final numerical value is $0.0001110$.", "answer": "$$\\boxed{0.0001110}$$", "id": "3309936"}]}