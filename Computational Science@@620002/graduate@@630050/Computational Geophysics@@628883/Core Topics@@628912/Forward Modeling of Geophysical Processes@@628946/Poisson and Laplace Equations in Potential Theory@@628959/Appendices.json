{"hands_on_practices": [{"introduction": "Mastering the analytical solution of Laplace's equation, $\\nabla^2 u = 0$, is a crucial first step in understanding potential fields. This practice focuses on the canonical problem of a potential within a rectangular domain, applying the powerful method of separation of variables. By constructing the solution from first principles and using a Fourier series to match the prescribed boundary conditions, you will solidify your understanding of how boundary data uniquely determines the interior field in a well-posed problem [@problem_id:3612931].", "problem": "Consider a steady-state scalar potential field in a homogeneous, isotropic rectangular domain modeling a two-dimensional cross-section of a geophysical medium. Let the domain be $\\Omega=\\{(x,y)\\,|\\,0\\le x\\le L_{x},\\,0\\le y\\le L_{y}\\}$ with $L_{x}>0$ and $L_{y}>0$. The governing equation is Laplaceâ€™s equation, a second-order linear partial differential equation (PDE) for the potential $u(x,y)$:\n$$\n\\nabla^{2}u=\\frac{\\partial^{2}u}{\\partial x^{2}}+\\frac{\\partial^{2}u}{\\partial y^{2}}=0 \\quad \\text{in } \\Omega.\n$$\nImpose Dirichlet data on the entire boundary:\n- $u(0,y)=0$ for $0\\le y\\le L_{y}$,\n- $u(L_{x},y)=0$ for $0\\le y\\le L_{y}$,\n- $u(x,0)=0$ for $0\\le x\\le L_{x}$,\n- $u(x,L_{y})=U_{0}\\sin\\!\\big(\\frac{3\\pi x}{L_{x}}\\big)+2U_{0}\\sin\\!\\big(\\frac{5\\pi x}{L_{x}}\\big)$ for $0\\le x\\le L_{x}$,\nwhere $U_{0}>0$ is a prescribed constant.\n\nUsing separation of variables from first principles and the orthogonality of the sine basis on $[0,L_{x}]$, derive the Fourier sine series representation of the unique harmonic solution $u(x,y)$ in $\\Omega$. Then, by evaluating the derived series, determine the value of $u\\!\\big(\\frac{L_{x}}{2},\\frac{L_{y}}{2}\\big)$ as a single closed-form analytic expression in terms of $U_{0}$, $L_{x}$, and $L_{y}$. Do not provide a numerical approximation; your final answer must be a single exact expression with standard mathematical constants and functions. Express angles in radians if any arise.", "solution": "The problem as stated will first be subjected to a rigorous validation process.\n\n### Step 1: Extract Givens\nThe given information is as follows:\n- **Domain:** $\\Omega=\\{(x,y)\\,|\\,0\\le x\\le L_{x},\\,0\\le y\\le L_{y}\\}$ with $L_{x}>0$ and $L_{y}>0$.\n- **Governing Equation:** Laplace's equation for a scalar potential $u(x,y)$, $\\nabla^{2}u=\\frac{\\partial^{2}u}{\\partial x^{2}}+\\frac{\\partial^{2}u}{\\partial y^{2}}=0$ in $\\Omega$.\n- **Boundary Conditions (Dirichlet):**\n  1. $u(0,y)=0$ for $0\\le y\\le L_{y}$.\n  2. $u(L_{x},y)=0$ for $0\\le y\\le L_{y}$.\n  3. $u(x,0)=0$ for $0\\le x\\le L_{x}$.\n  4. $u(x,L_{y})=U_{0}\\sin(\\frac{3\\pi x}{L_{x}})+2U_{0}\\sin(\\frac{5\\pi x}{L_{x}})$ for $0\\le x\\le L_{x}$, where $U_{0}>0$.\n- **Objective:** Derive the solution $u(x,y)$ and determine the value of $u(L_{x}/2, L_{y}/2)$.\n\n### Step 2: Validate Using Extracted Givens\n1.  **Scientific Grounding:** The problem is a canonical example of a boundary value problem for Laplace's equation, a fundamental equation in potential theory, electrostatics, steady-state heat conduction, and other areas of physics and engineering. It is scientifically sound.\n2.  **Well-Posedness:** The problem specifies Laplace's equation on a closed, bounded domain with continuous Dirichlet boundary conditions specified on the entire boundary. The boundary data is consistent at the corners of the rectangle:\n    - At $(0,0)$: $u(0,y)=0$ and $u(x,0)=0$ both give $0$.\n    - At $(L_{x},0)$: $u(L_{x},y)=0$ and $u(x,0)=0$ both give $0$.\n    - At $(0,L_{y})$: $u(0,y)=0$ gives $0$. The top boundary $u(x,L_{y})$ at $x=0$ is $U_{0}\\sin(0)+2U_{0}\\sin(0)=0$.\n    - At $(L_{x},L_{y})$: $u(L_{x},y)=0$ gives $0$. The top boundary $u(x,L_{y})$ at $x=L_{x}$ is $U_{0}\\sin(3\\pi)+2U_{0}\\sin(5\\pi)=0$.\n    The boundary conditions are continuous. Standard existence and uniqueness theorems for elliptic partial differential equations guarantee that a unique, stable solution exists. The problem is well-posed.\n3.  **Objectivity:** The problem is stated in precise mathematical language, free from any subjective or ambiguous terminology.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. It is a well-posed, scientifically grounded problem from potential theory. A solution will be derived.\n\nThe method of separation of variables is appropriate for this problem geometry and governing equation. We assume a solution of the form $u(x,y) = X(x)Y(y)$. Substituting this into Laplace's equation gives:\n$$\nX''(x)Y(y) + X(x)Y''(y) = 0\n$$\nwhere primes denote ordinary differentiation with respect to the function's argument. For non-trivial solutions, we can separate the variables:\n$$\n\\frac{X''(x)}{X(x)} = -\\frac{Y''(y)}{Y(y)} = -\\lambda\n$$\nHere, $-\\lambda$ is the separation constant. This yields two ordinary differential equations (ODEs):\n$$\nX''(x) + \\lambda X(x) = 0\n$$\n$$\nY''(y) - \\lambda Y(y) = 0\n$$\nWe apply the homogeneous boundary conditions first.\nThe conditions $u(0,y)=0$ and $u(L_{x},y)=0$ imply $X(0)Y(y)=0$ and $X(L_{x})Y(y)=0$. For a non-trivial solution $u(x,y)$, we must have $Y(y) \\not\\equiv 0$, which forces the conditions on $X(x)$:\n$$\nX(0)=0, \\quad X(L_{x})=0\n$$\nThis is a Sturm-Liouville eigenvalue problem for $X(x)$. We examine the cases for $\\lambda$:\n- If $\\lambda<0$, let $\\lambda = -k^2$ with $k>0$. The solution is $X(x) = A\\cosh(kx) + B\\sinh(kx)$. $X(0)=0$ gives $A=0$. Then $X(L_{x})=B\\sinh(kL_{x})=0$, which implies $B=0$ since $k>0$ and $L_{x}>0$. This leads to the trivial solution $X(x)=0$.\n- If $\\lambda=0$, the solution is $X(x) = Ax+B$. $X(0)=0$ gives $B=0$. Then $X(L_{x})=AL_{x}=0$, which implies $A=0$. This also leads to the trivial solution.\n- If $\\lambda>0$, let $\\lambda=k^2$ with $k>0$. The solution is $X(x) = A\\cos(kx) + B\\sin(kx)$. $X(0)=0$ gives $A=0$. Then $X(L_{x})=B\\sin(kL_{x})=0$. For a non-trivial solution, we need $B\\ne 0$, so $\\sin(kL_{x})=0$. This requires $kL_{x} = n\\pi$ for $n=1, 2, 3, \\dots$.\n\nThe eigenvalues are $\\lambda_{n} = k_{n}^{2} = (\\frac{n\\pi}{L_{x}})^{2}$ for $n=1, 2, 3, \\dots$. The corresponding eigenfunctions are $X_{n}(x) = \\sin(\\frac{n\\pi x}{L_{x}})$.\n\nNow we solve the ODE for $Y(y)$ for each eigenvalue $\\lambda_{n}$:\n$$\nY_{n}''(y) - \\left(\\frac{n\\pi}{L_{x}}\\right)^{2} Y_{n}(y) = 0\n$$\nThe general solution is $Y_{n}(y) = C_{n}\\cosh(\\frac{n\\pi y}{L_{x}}) + D_{n}\\sinh(\\frac{n\\pi y}{L_{x}})$.\nWe apply the homogeneous boundary condition $u(x,0)=0$, which implies $X(x)Y(0)=0$. For a non-trivial solution, this means $Y(0)=0$. Applying this to the solution for $Y_{n}(y)$:\n$$\nY_{n}(0) = C_{n}\\cosh(0) + D_{n}\\sinh(0) = C_{n} = 0\n$$\nThus, the solution for $Y_{n}(y)$ is of the form $Y_{n}(y) = D_{n}\\sinh(\\frac{n\\pi y}{L_{x}})$.\n\nBy the principle of superposition, the general solution $u(x,y)$ is a linear combination of the product solutions $X_{n}(x)Y_{n}(y)$:\n$$\nu(x,y) = \\sum_{n=1}^{\\infty} D_{n} \\sin\\left(\\frac{n\\pi x}{L_{x}}\\right) \\sinh\\left(\\frac{n\\pi y}{L_{x}}\\right)\n$$\nThe remaining coefficients $D_{n}$ are determined by the final non-homogeneous boundary condition at $y=L_{y}$:\n$$\nu(x,L_{y}) = \\sum_{n=1}^{\\infty} D_{n} \\sin\\left(\\frac{n\\pi x}{L_{x}}\\right) \\sinh\\left(\\frac{n\\pi L_{y}}{L_{x}}\\right) = U_{0}\\sin\\left(\\frac{3\\pi x}{L_{x}}\\right)+2U_{0}\\sin\\left(\\frac{5\\pi x}{L_{x}}\\right)\n$$\nThis is a Fourier sine series representation. By comparing the coefficients of the basis functions $\\sin(\\frac{n\\pi x}{L_{x}})$ on both sides (which is permissible due to their orthogonality on the interval $[0,L_{x}]$), we find:\n- For $n=3$: $D_{3}\\sinh(\\frac{3\\pi L_{y}}{L_{x}}) = U_{0} \\implies D_{3} = \\frac{U_{0}}{\\sinh(\\frac{3\\pi L_{y}}{L_{x}})}$.\n- For $n=5$: $D_{5}\\sinh(\\frac{5\\pi L_{y}}{L_{x}}) = 2U_{0} \\implies D_{5} = \\frac{2U_{0}}{\\sinh(\\frac{5\\pi L_{y}}{L_{x}})}$.\n- For all other integers $n \\ge 1$ where $n \\ne 3$ and $n \\ne 5$, the coefficient is $0$.\n\nThe specific solution is therefore the sum of only two terms from the series:\n$$\nu(x,y) = \\frac{U_{0}}{\\sinh(\\frac{3\\pi L_{y}}{L_{x}})} \\sin\\left(\\frac{3\\pi x}{L_{x}}\\right) \\sinh\\left(\\frac{3\\pi y}{L_{x}}\\right) + \\frac{2U_{0}}{\\sinh(\\frac{5\\pi L_{y}}{L_{x}})} \\sin\\left(\\frac{5\\pi x}{L_{x}}\\right) \\sinh\\left(\\frac{5\\pi y}{L_{x}}\\right)\n$$\nWe are asked to evaluate this solution at the point $(x,y) = (\\frac{L_{x}}{2}, \\frac{L_{y}}{2})$.\nFirst, we evaluate the sine terms at $x = L_{x}/2$:\n$$\n\\sin\\left(\\frac{3\\pi (L_{x}/2)}{L_{x}}\\right) = \\sin\\left(\\frac{3\\pi}{2}\\right) = -1\n$$\n$$\n\\sin\\left(\\frac{5\\pi (L_{x}/2)}{L_{x}}\\right) = \\sin\\left(\\frac{5\\pi}{2}\\right) = \\sin\\left(2\\pi + \\frac{\\pi}{2}\\right) = \\sin\\left(\\frac{\\pi}{2}\\right) = 1\n$$\nNext, we evaluate the hyperbolic sine terms at $y = L_{y}/2$:\n$$\n\\sinh\\left(\\frac{3\\pi (L_{y}/2)}{L_{x}}\\right) = \\sinh\\left(\\frac{3\\pi L_{y}}{2L_{x}}\\right)\n$$\n$$\n\\sinh\\left(\\frac{5\\pi (L_{y}/2)}{L_{x}}\\right) = \\sinh\\left(\\frac{5\\pi L_{y}}{2L_{x}}\\right)\n$$\nSubstituting these into the expression for $u(x,y)$:\n$$\nu\\left(\\frac{L_{x}}{2}, \\frac{L_{y}}{2}\\right) = \\frac{U_{0}}{\\sinh(\\frac{3\\pi L_{y}}{L_{x}})}(-1)\\sinh\\left(\\frac{3\\pi L_{y}}{2L_{x}}\\right) + \\frac{2U_{0}}{\\sinh(\\frac{5\\pi L_{y}}{L_{x}})}(1)\\sinh\\left(\\frac{5\\pi L_{y}}{2L_{x}}\\right)\n$$\n$$\nu\\left(\\frac{L_{x}}{2}, \\frac{L_{y}}{2}\\right) = -U_{0}\\frac{\\sinh(\\frac{3\\pi L_{y}}{2L_{x}})}{\\sinh(\\frac{3\\pi L_{y}}{L_{x}})} + 2U_{0}\\frac{\\sinh(\\frac{5\\pi L_{y}}{2L_{x}})}{\\sinh(\\frac{5\\pi L_{y}}{L_{x}})}\n$$\nWe use the hyperbolic double-angle identity $\\sinh(2z) = 2\\sinh(z)\\cosh(z)$.\nFor the first term, let $z = \\frac{3\\pi L_{y}}{2L_{x}}$. Then $\\sinh(\\frac{3\\pi L_{y}}{L_{x}}) = \\sinh(2z) = 2\\sinh(\\frac{3\\pi L_{y}}{2L_{x}})\\cosh(\\frac{3\\pi L_{y}}{2L_{x}})$.\nThe fraction becomes $\\frac{\\sinh(z)}{2\\sinh(z)\\cosh(z)} = \\frac{1}{2\\cosh(z)}$.\nFor the second term, let $w = \\frac{5\\pi L_{y}}{2L_{x}}$, so $\\sinh(\\frac{5\\pi L_{y}}{L_{x}}) = \\sinh(2w) = 2\\sinh(\\frac{5\\pi L_{y}}{2L_{x}})\\cosh(\\frac{5\\pi L_{y}}{2L_{x}})$.\nThe fraction becomes $\\frac{\\sinh(w)}{2\\sinh(w)\\cosh(w)} = \\frac{1}{2\\cosh(w)}$.\n\nSubstituting these simplified fractions back into the expression for $u(\\frac{L_{x}}{2}, \\frac{L_{y}}{2})$:\n$$\nu\\left(\\frac{L_{x}}{2}, \\frac{L_{y}}{2}\\right) = -U_{0} \\left( \\frac{1}{2\\cosh(\\frac{3\\pi L_{y}}{2L_{x}})} \\right) + 2U_{0} \\left( \\frac{1}{2\\cosh(\\frac{5\\pi L_{y}}{2L_{x}})} \\right)\n$$\n$$\nu\\left(\\frac{L_{x}}{2}, \\frac{L_{y}}{2}\\right) = \\frac{U_{0}}{\\cosh(\\frac{5\\pi L_{y}}{2L_{x}})} - \\frac{U_{0}}{2\\cosh(\\frac{3\\pi L_{y}}{2L_{x}})}\n$$\nThis can be written as a single expression:\n$$\nu\\left(\\frac{L_{x}}{2}, \\frac{L_{y}}{2}\\right) = U_{0} \\left( \\frac{1}{\\cosh(\\frac{5\\pi L_{y}}{2L_{x}})} - \\frac{1}{2\\cosh(\\frac{3\\pi L_{y}}{2L_{x}})} \\right)\n$$\nThis is the final closed-form analytic expression.", "answer": "$$\n\\boxed{U_{0} \\left( \\frac{1}{\\cosh\\left(\\frac{5\\pi L_{y}}{2L_{x}}\\right)} - \\frac{1}{2\\cosh\\left(\\frac{3\\pi L_{y}}{2L_{x}}\\right)} \\right)}\n$$", "id": "3612931"}, {"introduction": "Many geophysical problems, such as modeling a planet's external gravitational field, are naturally posed in spherical coordinates. This exercise extends the principles of separation of variables to this new geometry, where the angular solutions are the famous Legendre polynomials. By solving for the axisymmetric potential outside a sphere, you will see how these fundamental building blocks combine with radial dependence and boundary conditions to form solutions that are the basis for spherical harmonic models [@problem_id:3612990].", "problem": "In computational geophysics, harmonic potentials describe the source-free exterior gravitational or magnetic fields of planetary bodies. Consider the exterior domain of a spherically symmetric reference Earth of radius $a$, defined by $r \\geq a$ in spherical coordinates $(r,\\theta,\\phi)$. Let $u(r,\\theta)$ be an axisymmetric (no $\\phi$-dependence) nondimensional potential field that satisfies Laplace's equation\n$$\n\\nabla^{2} u \\;=\\; 0\n$$\nin the exterior domain and decays as $r \\to \\infty$. The potential is specified on the spherical boundary by a single zonal spherical harmonic of degree $3$:\n$$\nu(a,\\theta) \\;=\\; P_{3}(\\cos\\theta),\n$$\nwhere $P_{3}$ is the Legendre polynomial of degree $3$.\n\nStarting from the governing equation in spherical coordinates and enforcing axisymmetry, derive the separated form, identify the admissible angular eigenfunctions, and enforce the decay and boundary conditions to determine the unique exterior solution. Express your final answer as a single closed-form analytic expression for $u(r,\\theta)$ in terms of $a$, $r$, and $P_{3}(\\cos\\theta)$. Since the potential has been nondimensionalized, no units are required. No rounding is needed; provide the exact expression.", "solution": "The problem is subjected to validation before a solution is attempted.\n\n### Step 1: Extract Givens\n- **Governing Equation**: Laplace's equation, $\\nabla^{2} u = 0$.\n- **Domain**: The exterior of a sphere of radius $a$, defined by $r \\geq a$ in spherical coordinates $(r, \\theta, \\phi)$.\n- **Symmetry**: The potential $u$ is axisymmetric, meaning $u = u(r, \\theta)$.\n- **Boundary Condition at Infinity**: The potential decays as $r \\to \\infty$.\n- **Boundary Condition at Surface**: On the spherical boundary $r=a$, the potential is $u(a,\\theta) = P_{3}(\\cos\\theta)$, where $P_{3}$ is the Legendre polynomial of degree $3$.\n\n### Step 2: Validate Using Extracted Givens\n1.  **Scientifically Grounded**: The problem is based on potential theory and Laplace's equation, which are fundamental concepts in physics, geophysics, and engineering. The use of spherical harmonics to solve boundary value problems in spherical geometries is a standard and well-established method. The problem is scientifically sound.\n2.  **Well-Posed**: The problem is a classic exterior Dirichlet problem for Laplace's equation. A unique and stable solution is guaranteed by the theory of elliptic partial differential equations, given the specified boundary condition on a closed surface and the decay condition at infinity. The setup is well-posed.\n3.  **Objective**: The problem is stated using precise mathematical language and definitions. There are no subjective or ambiguous terms.\n4.  **Complete and Consistent**: All necessary information (governing equation, domain, boundary conditions) to find a unique solution is provided. There are no contradictions in the given information.\n\n### Step 3: Verdict and Action\nThe problem is valid as it is scientifically grounded, well-posed, objective, and self-contained. A full solution will be derived.\n\n***\n\nThe governing equation is Laplace's equation, $\\nabla^{2} u = 0$. In spherical coordinates $(r, \\theta, \\phi)$, the Laplacian operator is:\n$$\n\\nabla^{2} u = \\frac{1}{r^{2}}\\frac{\\partial}{\\partial r}\\left(r^{2} \\frac{\\partial u}{\\partial r}\\right) + \\frac{1}{r^{2}\\sin\\theta}\\frac{\\partial}{\\partial \\theta}\\left(\\sin\\theta \\frac{\\partial u}{\\partial \\theta}\\right) + \\frac{1}{r^{2}\\sin^{2}\\theta}\\frac{\\partial^{2} u}{\\partial \\phi^{2}}\n$$\nGiven that the potential $u$ is axisymmetric, it has no dependence on the azimuthal angle $\\phi$. Therefore, $\\frac{\\partial u}{\\partial \\phi} = 0$, and the last term in the Laplacian vanishes. Laplace's equation simplifies to:\n$$\n\\frac{1}{r^{2}}\\frac{\\partial}{\\partial r}\\left(r^{2} \\frac{\\partial u}{\\partial r}\\right) + \\frac{1}{r^{2}\\sin\\theta}\\frac{\\partial}{\\partial \\theta}\\left(\\sin\\theta \\frac{\\partial u}{\\partial \\theta}\\right) = 0\n$$\nMultiplying the entire equation by $r^{2}$ gives:\n$$\n\\frac{\\partial}{\\partial r}\\left(r^{2} \\frac{\\partial u}{\\partial r}\\right) + \\frac{1}{\\sin\\theta}\\frac{\\partial}{\\partial \\theta}\\left(\\sin\\theta \\frac{\\partial u}{\\partial \\theta}\\right) = 0\n$$\nWe seek a solution using the method of separation of variables, assuming the potential can be written as a product of a function of $r$ only and a function of $\\theta$ only, $u(r,\\theta) = R(r)\\Theta(\\theta)$. Substituting this form into the equation yields:\n$$\n\\Theta(\\theta)\\frac{d}{dr}\\left(r^{2}\\frac{dR}{dr}\\right) + \\frac{R(r)}{\\sin\\theta}\\frac{d}{d\\theta}\\left(\\sin\\theta\\frac{d\\Theta}{d\\theta}\\right) = 0\n$$\nDividing by $u(r,\\theta) = R(r)\\Theta(\\theta)$ allows us to separate the variables:\n$$\n\\frac{1}{R(r)}\\frac{d}{dr}\\left(r^{2}\\frac{dR}{dr}\\right) = -\\frac{1}{\\Theta(\\theta)\\sin\\theta}\\frac{d}{d\\theta}\\left(\\sin\\theta\\frac{d\\Theta}{d\\theta}\\right)\n$$\nThe left side of the equation is a function of $r$ only, while the right side is a function of $\\theta$ only. For this equality to hold for all $r$ and $\\theta$, both sides must be equal to a constant, which we shall denote by $\\lambda$. This gives two ordinary differential equations:\n\n1.  The radial equation:\n    $$\n    \\frac{d}{dr}\\left(r^{2}\\frac{dR}{dr}\\right) - \\lambda R(r) = 0\n    $$\n2.  The angular equation:\n    $$\n    \\frac{1}{\\sin\\theta}\\frac{d}{d\\theta}\\left(\\sin\\theta\\frac{d\\Theta}{d\\theta}\\right) + \\lambda\\Theta(\\theta) = 0\n    $$\nThe angular equation is the Legendre differential equation. For the solution $\\Theta(\\theta)$ to be physically regular (i.e., finite at the poles $\\theta=0$ and $\\theta=\\pi$), the separation constant $\\lambda$ must be of the form $l(l+1)$, where $l$ is a non-negative integer ($l=0, 1, 2, \\dots$). The corresponding solutions are the Legendre polynomials, $\\Theta(\\theta) = P_{l}(\\cos\\theta)$. These are the admissible angular eigenfunctions.\n\nWith $\\lambda = l(l+1)$, the radial equation becomes:\n$$\nr^{2}\\frac{d^{2}R}{dr^{2}} + 2r\\frac{dR}{dr} - l(l+1)R = 0\n$$\nThis is a Cauchy-Euler equation. Seeking solutions of the form $R(r) = r^{k}$, we obtain the characteristic equation:\n$$\nk(k-1) + 2k - l(l+1) = 0 \\implies k^{2} + k - l(l+1) = 0\n$$\nFactoring this quadratic equation gives $(k-l)(k+l+1) = 0$, which yields the roots $k=l$ and $k=-(l+1)$. The general solution for the radial part is therefore a linear combination of these two solutions:\n$$\nR_{l}(r) = A_{l}r^{l} + B_{l}r^{-(l+1)}\n$$\nwhere $A_{l}$ and $B_{l}$ are constants for each degree $l$.\n\nThe general solution for the axisymmetric potential $u(r,\\theta)$ is a superposition of the product solutions for all possible values of $l$:\n$$\nu(r,\\theta) = \\sum_{l=0}^{\\infty} (A_{l}r^{l} + B_{l}r^{-(l+1)})P_{l}(\\cos\\theta)\n$$\nWe now apply the given conditions to determine the unknown coefficients $A_{l}$ and $B_{l}$.\n\nFirst, we enforce the decay condition that the potential must vanish at infinity, i.e., $u(r,\\theta) \\to 0$ as $r \\to \\infty$. The term $A_{l}r^{l}$ grows with $r$ for $l>0$ and is constant for $l=0$. For the potential to decay to zero, the coefficients of all non-decaying terms must be zero. This requires $A_{l} = 0$ for all $l \\geq 0$. The solution then simplifies to:\n$$\nu(r,\\theta) = \\sum_{l=0}^{\\infty} B_{l}r^{-(l+1)}P_{l}(\\cos\\theta)\n$$\nThis form is characteristic of potentials in an exterior domain that vanish at infinity.\n\nNext, we apply the boundary condition on the surface of the sphere, $r=a$:\n$$\nu(a,\\theta) = P_{3}(\\cos\\theta)\n$$\nSubstituting $r=a$ into our series solution gives:\n$$\nu(a,\\theta) = \\sum_{l=0}^{\\infty} B_{l}a^{-(l+1)}P_{l}(\\cos\\theta)\n$$\nEquating the two expressions for $u(a,\\theta)$:\n$$\n\\sum_{l=0}^{\\infty} B_{l}a^{-(l+1)}P_{l}(\\cos\\theta) = P_{3}(\\cos\\theta)\n$$\nThe Legendre polynomials form a complete orthogonal set. By the principle of orthogonality, we can equate the coefficients of each $P_{l}(\\cos\\theta)$ term on both sides of the equation.\nThe right side can be written as $1 \\cdot P_{3}(\\cos\\theta)$ plus zero for all other Legendre polynomials.\n- For $l \\neq 3$, the coefficient of $P_{l}(\\cos\\theta)$ on the right side is $0$. Thus, $B_{l}a^{-(l+1)} = 0$, which implies $B_{l}=0$ for all $l \\neq 3$.\n- For $l = 3$, the coefficient of $P_{3}(\\cos\\theta)$ on the right side is $1$. Thus:\n$$\nB_{3}a^{-(3+1)} = 1 \\implies B_{3}a^{-4} = 1\n$$\nSolving for $B_{3}$ gives:\n$$\nB_{3} = a^{4}\n$$\nThe only non-zero coefficient in the series is $B_{3}$. Substituting this back into the solution form gives the unique exterior potential:\n$$\nu(r,\\theta) = B_{3}r^{-(3+1)}P_{3}(\\cos\\theta) = a^{4}r^{-4}P_{3}(\\cos\\theta)\n$$\nThis can be written as:\n$$\nu(r,\\theta) = \\left(\\frac{a}{r}\\right)^{4}P_{3}(\\cos\\theta)\n$$\nThis expression satisfies all conditions of the problem: it is a solution to Laplace's equation, it is axisymmetric, it decays as $r^{-4}$ when $r \\to \\infty$, and it reduces to $P_{3}(\\cos\\theta)$ at $r=a$.", "answer": "$$\n\\boxed{\\left(\\frac{a}{r}\\right)^{4} P_{3}(\\cos\\theta)}\n$$", "id": "3612990"}, {"introduction": "While analytical methods are powerful, most real-world geophysical problems involve complex geometries that require numerical solutions. This hands-on computational exercise tackles the Laplace equation in a multiply connected domain using the finite difference method to compute harmonic measures. This exploration not only illustrates numerical potential field modeling but also reveals a subtle yet critical issue of non-uniqueness that arises in geophysical inverse problems based on gradient data, a key concept for any computational geophysicist [@problem_id:3612950].", "problem": "Consider two-dimensional potential theory in a multiply connected domain. Let the computational domain be the closed square $\\left[-1,1\\right]\\times\\left[-1,1\\right]$ with two circular holes removed, making the domain multiply connected. The holes are the open disks centered at $\\mathbf{c}_1=\\left(-0.3,0.0\\right)$ with radius $r_1=0.25$ and $\\mathbf{c}_2=\\left(0.35,0.1\\right)$ with radius $r_2=0.20$. Thus, the physical domain $\\Omega$ is the set of points in the square that are outside both disks. The outer boundary is the boundary of the square, and the two inner boundaries are the circumferences of the disks.\n\nYou will work with the Laplace equation $\\nabla^2 u = 0$ on $\\Omega$ using only the following fundamental base:\n- The superposition principle: if $u_1$ and $u_2$ solve $\\nabla^2 u = 0$ on $\\Omega$, then so does any linear combination $\\alpha u_1 + \\beta u_2$ for scalars $\\alpha$ and $\\beta$.\n- The maximum principle for harmonic functions: a non-constant harmonic function attains its extrema on the boundary.\n- The definition of harmonic measure for a boundary component: for a boundary partition $\\partial \\Omega = \\Gamma_{\\text{out}} \\cup \\Gamma_1 \\cup \\Gamma_2$, the harmonic measure $\\omega_j(\\mathbf{x})$ of $\\Gamma_j$ at $\\mathbf{x}\\in\\Omega$ is the unique harmonic function on $\\Omega$ that takes boundary value $1$ on $\\Gamma_j$ and $0$ on the other boundary components.\n- The uniqueness classes: Dirichlet boundary value problem has a unique solution, whereas the Neumann boundary value problem determines the solution only up to an additive constant.\n\nYour task is to compute discrete approximations to the harmonic measures for the three boundary components and to design and analyze a gradient-only inversion that reveals non-uniqueness. Use a finite difference discretization on a uniform Cartesian grid with $N = 129$ points per coordinate in the square. The two holes are imposed by masking grid nodes lying strictly inside the corresponding disks. For each discrete harmonic measure, impose boundary conditions as follows:\n- For the harmonic measure $\\omega_1$, impose $u=1$ on the inner hole at $\\mathbf{c}_1$ and $u=0$ on the other hole and on the outer square boundary.\n- For the harmonic measure $\\omega_2$, impose $u=1$ on the inner hole at $\\mathbf{c}_2$ and $u=0$ on the other hole and on the outer square boundary.\n- For the harmonic measure $\\omega_{\\text{out}}$, impose $u=1$ on the outer square boundary and $u=0$ on both inner holes.\n\nDiscretize $\\nabla^2 u = 0$ on the grid nodes that are not masked (i.e., nodes in $\\Omega$), using the standard five-point stencil. Treat the masked holes as embedded Dirichlet boundaries with constant values equal to the boundary data for their respective components; handle the outer square boundary as Dirichlet as well. Solve the resulting linear systems exactly to floating-point precision.\n\nDefine the following target interior points in physical coordinates for evaluation:\n- $\\mathbf{p}_0=(0.0,0.0)$,\n- $\\mathbf{p}_1=(-0.05,0.0)$,\n- $\\mathbf{p}_2=(0.65,-0.25)$,\n- $\\mathbf{p}_3=(0.15,0.15)$,\n- $\\mathbf{p}_4=(-0.6,0.4)$,\n- $\\mathbf{p}_5=(0.4,-0.5)$.\nMap each target to the nearest grid node and, if necessary, adjust to the nearest safe interior node whose four von Neumann neighbors also lie in $\\Omega$ to allow central differences.\n\nUse the computed harmonic measures to test fundamental properties and to set up an inversion problem that uses only gradient information:\n- Property test: verify that $\\omega_1(\\mathbf{p}_0)+\\omega_2(\\mathbf{p}_0)+\\omega_{\\text{out}}(\\mathbf{p}_0)$ equals $1$ within tolerance $\\varepsilon_1=10^{-6}$.\n- Proximity test: verify that at a point near the first hole (chosen as $\\mathbf{p}_1$), the value $\\omega_1$ exceeds both $\\omega_2$ and $\\omega_{\\text{out}}$.\n- Inversion design: let the true boundary constants be $\\boldsymbol{\\alpha}^{\\star} = \\left[\\alpha_1^{\\star},\\alpha_2^{\\star},\\alpha_{\\text{out}}^{\\star}\\right] = \\left[0.8,-0.4,0.2\\right]$. By linearity, the potential corresponding to these boundary constants is $u(\\mathbf{x})=\\alpha_1^{\\star}\\,\\omega_1(\\mathbf{x})+\\alpha_2^{\\star}\\,\\omega_2(\\mathbf{x})+\\alpha_{\\text{out}}^{\\star}\\,\\omega_{\\text{out}}(\\mathbf{x})$. However, suppose that only the gradient field $\\nabla u$ is observed at the $K=6$ interior points $\\mathbf{p}_k$, $k\\in\\{0,1,2,3,4,5\\}$, and consider the linear system for the unknown boundary constants:\n$$\n\\begin{bmatrix}\n\\nabla \\omega_1(\\mathbf{p}_0) & \\nabla \\omega_2(\\mathbf{p}_0) & \\nabla \\omega_{\\text{out}}(\\mathbf{p}_0) \\\\\n\\vdots & \\vdots & \\vdots \\\\\n\\nabla \\omega_1(\\mathbf{p}_5) & \\nabla \\omega_2(\\mathbf{p}_5) & \\nabla \\omega_{\\text{out}}(\\mathbf{p}_5)\n\\end{bmatrix}\n\\begin{bmatrix}\n\\alpha_1 \\\\ \\alpha_2 \\\\ \\alpha_{\\text{out}}\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n\\nabla u(\\mathbf{p}_0) \\\\ \\vdots \\\\ \\nabla u(\\mathbf{p}_5)\n\\end{bmatrix}.\n$$\nBecause $\\nabla \\omega_1+\\nabla \\omega_2+\\nabla \\omega_{\\text{out}}=\\nabla 1=\\mathbf{0}$ at each point, this gradient-only system is rank-deficient and non-unique up to an additive constant in $\\boldsymbol{\\alpha}$. Compute the numerical rank using the singular value decomposition with a threshold $\\tau=10^{-10}$.\n\nTo illustrate the non-uniqueness and its remedy:\n- Compute the minimal-norm least-squares estimate $\\widehat{\\boldsymbol{\\alpha}}$ from the gradient-only data and verify it differs from $\\boldsymbol{\\alpha}^{\\star}$ by an additive constant vector, i.e., $\\widehat{\\boldsymbol{\\alpha}} - \\boldsymbol{\\alpha}^{\\star} = c\\,[1,1,1]^T$ for some scalar $c$, within tolerance $\\varepsilon_2=10^{-6}$.\n- Impose a gauge by fixing $\\alpha_{\\text{out}}=0$ and solve the reduced least-squares problem to obtain $\\widetilde{\\boldsymbol{\\alpha}}$ with $\\widetilde{\\alpha}_{\\text{out}}=0$. Compare $\\widetilde{\\boldsymbol{\\alpha}}$ against the gauge-fixed truth $\\boldsymbol{\\alpha}^{\\star}_{\\text{gf}}=\\boldsymbol{\\alpha}^{\\star}-\\alpha_{\\text{out}}^{\\star}\\,[1,1,1]^T$, and report the Euclidean norm of the error $\\|\\widetilde{\\boldsymbol{\\alpha}}-\\boldsymbol{\\alpha}^{\\star}_{\\text{gf}}\\|_2$ as a floating-point number.\n\nTest suite and required outputs:\n- Use $N=129$, $\\mathbf{c}_1=\\left(-0.3,0.0\\right)$, $r_1=0.25$, $\\mathbf{c}_2=\\left(0.35,0.1\\right)$, $r_2=0.20$, $\\varepsilon_1=10^{-6}$, $\\varepsilon_2=10^{-6}$, and $\\tau=10^{-10}$.\n- Your program should compute the following five results in order:\n  1. A boolean indicating whether $\\omega_1(\\mathbf{p}_0)+\\omega_2(\\mathbf{p}_0)+\\omega_{\\text{out}}(\\mathbf{p}_0)$ is within $\\varepsilon_1$ of $1$.\n  2. A boolean indicating whether $\\omega_1(\\mathbf{p}_1)>\\max\\{\\omega_2(\\mathbf{p}_1),\\omega_{\\text{out}}(\\mathbf{p}_1)\\}$.\n  3. An integer equal to the numerical rank of the gradient-only design matrix with threshold $\\tau$.\n  4. A boolean indicating whether there exists an additive constant $c$ such that $\\widehat{\\boldsymbol{\\alpha}} - \\boldsymbol{\\alpha}^{\\star} \\approx c\\,[1,1,1]^T$ within $\\varepsilon_2$.\n  5. A float equal to $\\|\\widetilde{\\boldsymbol{\\alpha}}-\\boldsymbol{\\alpha}^{\\star}_{\\text{gf}}\\|_2$.\n- Final output format: your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the exact order above, for example, $\\left[\\text{True},\\text{True},2,\\text{True},0.000001\\right]$. No additional text or formatting is allowed in the output.", "solution": "The user has provided a valid, well-posed, and scientifically grounded problem statement. All necessary data and conditions for a unique solution to the defined computational tasks are provided. The problem is a standard exercise in computational potential theory, involving the numerical solution of the Laplace equation using the finite difference method and the analysis of an associated inverse problem.\n\nThe problem will be solved by following these steps:\n1.  Discretize the continuous domain $\\Omega$ onto a uniform Cartesian grid and identify the interior and boundary nodes.\n2.  Formulate the finite difference approximation of the Laplace equation, leading to a sparse linear system.\n3.  Solve this linear system for three different sets of Dirichlet boundary conditions to compute the discrete harmonic measures $\\omega_1$, $\\omega_2$, and $\\omega_{\\text{out}}$.\n4.  Evaluate the computed harmonic measures and their gradients at specified interior points.\n5.  Perform the required tests: verifying the sum property of harmonic measures, checking the proximity effect, and analyzing the rank and non-uniqueness of a gradient-based inversion problem.\n6.  Demonstrate the remedy for non-uniqueness using gauge fixing and compute the final required metrics.\n\n**1. Discretization and Domain Representation**\nThe computational domain is a square $\\left[-1,1\\right]\\times\\left[-1,1\\right]$ with two circular holes. We discretize this domain using a uniform Cartesian grid of $N \\times N$ points, where $N=129$. The grid coordinates are given by $x_j = -1 + j h$ and $y_i = -1 + i h$ for $i, j \\in \\{0, 1, \\dots, N-1\\}$, with a grid spacing of $h = 2/(N-1)$.\n\nThe physical domain $\\Omega$ is represented by the set of grid nodes that do not fall strictly inside the open disks defined by $(\\mathbf{x}-\\mathbf{c}_1)^2 < r_1^2$ and $(\\mathbf{x}-\\mathbf{c}_2)^2 < r_2^2$. We create a boolean mask to identify these valid domain nodes. The boundary $\\partial\\Omega$ is partitioned into three components: the outer square boundary $\\Gamma_{\\text{out}}$ and the two inner hole boundaries, $\\Gamma_1$ and $\\Gamma_2$. On the discrete grid, these boundaries correspond to the set of domain nodes that are adjacent to either the exterior of the square or one of the masked holes. The remaining domain nodes are classified as interior nodes.\n\n**2. Finite Difference Formulation for the Laplace Equation**\nThe Laplace equation, $\\nabla^2 u = 0$, is approximated at each interior grid node $(i,j)$ using the standard five-point stencil:\n$$\n\\nabla^2 u(x_j, y_i) \\approx \\frac{u_{i,j+1} + u_{i,j-1} + u_{i+1,j} + u_{i-1,j} - 4u_{i,j}}{h^2} = 0\n$$\nThis simplifies to a linear equation for the potential $u$ at each interior node:\n$$\n4u_{i,j} - u_{i,j+1} - u_{i,j-1} - u_{i+1,j} - u_{i-1,j} = 0\n$$\nBy assembling one such equation for every interior node, we obtain a large, sparse system of linear equations of the form $A\\mathbf{u}_{\\text{int}} = \\mathbf{b}$. Here, $\\mathbf{u}_{\\text{int}}$ is a vector of the unknown potential values at all interior nodes. The matrix $A$ is the discrete Laplacian operator, containing the coefficients $4$ on the diagonal and $-1$ for each neighboring interior node. The right-hand side vector $\\mathbf{b}$ is non-zero when a neighbor of an interior node is a boundary node, incorporating the known Dirichlet boundary values into the system.\n\n**3. Computation of Harmonic Measures**\nThe harmonic measure $\\omega_k(\\mathbf{x})$ of a boundary component $\\Gamma_k$ is the harmonic function on $\\Omega$ that equals $1$ on $\\Gamma_k$ and $0$ on all other boundary components. We compute the discrete approximations to the three harmonic measures, $\\omega_1$, $\\omega_2$, and $\\omega_{\\text{out}}$, by solving the linear system $A\\mathbf{u}_{\\text{int}} = \\mathbf{b}$ three times, each with a different right-hand side $\\mathbf{b}$ corresponding to the boundary conditions:\n-   For $\\omega_1$: $u=1$ on $\\Gamma_1$, $u=0$ on $\\Gamma_2$ and $\\Gamma_{\\text{out}}$.\n-   For $\\omega_2$: $u=1$ on $\\Gamma_2$, $u=0$ on $\\Gamma_1$ and $\\Gamma_{\\text{out}}$.\n-   For $\\omega_{\\text{out}}$: $u=1$ on $\\Gamma_{\\text{out}}$, $u=0$ on $\\Gamma_1$ and $\\Gamma_2$.\nThe resulting sparse linear systems are efficiently solved using a direct solver, such as `scipy.sparse.linalg.spsolve`.\n\n**4. Analysis of the Gradient-Based Inverse Problem**\nBy the superposition principle, a harmonic function $u$ with piecewise constant boundary values $\\alpha_1, \\alpha_2, \\alpha_{\\text{out}}$ on $\\Gamma_1, \\Gamma_2, \\Gamma_{\\text{out}}$ is given by the linear combination:\n$$\nu(\\mathbf{x}) = \\alpha_1 \\omega_1(\\mathbf{x}) + \\alpha_2 \\omega_2(\\mathbf{x}) + \\alpha_{\\text{out}} \\omega_{\\text{out}}(\\mathbf{x})\n$$\nThe gradient of the potential is therefore:\n$$\n\\nabla u(\\mathbf{x}) = \\alpha_1 \\nabla\\omega_1(\\mathbf{x}) + \\alpha_2 \\nabla\\omega_2(\\mathbf{x}) + \\alpha_{\\text{out}} \\nabla\\omega_{\\text{out}}(\\mathbf{x})\n$$\nThe inverse problem attempts to recover the constants $\\boldsymbol{\\alpha} = [\\alpha_1, \\alpha_2, \\alpha_{\\text{out}}]^T$ from measurements of the gradient $\\nabla u$ at several interior points $\\mathbf{p}_k$. This sets up a linear system $G\\boldsymbol{\\alpha} = \\mathbf{d}$, where $G$ is the design matrix whose columns are the stacked gradients of the harmonic measures, and $\\mathbf{d}$ is the vector of observed gradients.\n\nA fundamental property of harmonic measures is that their sum is unity, $\\sum_k \\omega_k(\\mathbf{x}) = 1$, for any $\\mathbf{x} \\in \\Omega$. This is a consequence of the maximum principle, as the function $v(\\mathbf{x}) = \\sum_k \\omega_k(\\mathbf{x})$ is harmonic and has boundary value $1$ everywhere on $\\partial\\Omega$. By uniqueness, $v(\\mathbf{x})$ must be identically $1$. Taking the gradient of this identity yields $\\sum_k \\nabla\\omega_k(\\mathbf{x}) = \\nabla 1 = \\mathbf{0}$. This implies that the columns of the design matrix $G$ are linearly dependent, as their sum is the zero vector. Consequently, the matrix $G$ is rank-deficient (its rank is $2$, not $3$), and the inverse problem does not have a unique solution. The non-uniqueness is an additive constant: if $\\boldsymbol{\\alpha}$ is a solution, so is $\\boldsymbol{\\alpha} + c[1,1,1]^T$ for any scalar $c$.\n\nWe analyze this by:\n1.  Computing the numerical rank of $G$ via its singular values, confirming it is $2$.\n2.  Finding the minimal-norm least-squares solution $\\widehat{\\boldsymbol{\\alpha}}$ using `numpy.linalg.lstsq`. This solution is unique but differs from the true constants $\\boldsymbol{\\alpha}^{\\star}$ by a vector proportional to $[1,1,1]^T$.\n3.  Restoring uniqueness by gauge fixing. We impose the constraint $\\alpha_{\\text{out}}=0$, remove the third column from $G$, and solve the resulting (now full-rank) least-squares problem for $[\\alpha_1, \\alpha_2]^T$. The solution $\\widetilde{\\boldsymbol{\\alpha}}$ is then compared to the correspondingly gauge-fixed true vector $\\boldsymbol{\\alpha}^{\\star}_{\\text{gf}} = \\boldsymbol{\\alpha}^{\\star} - \\alpha_{\\text{out}}^{\\star}[1,1,1]^T$.\n\nGradients at the target points are computed using a second-order central difference approximation on the grid, which requires that the evaluation points and their four von Neumann neighbors are all interior nodes (i.e., \"safe\" nodes). We map each physical target point to the nearest such safe grid node.", "answer": "```python\nimport numpy as np\nfrom scipy.sparse import lil_matrix\nfrom scipy.sparse.linalg import spsolve\n\ndef solve():\n    \"\"\"\n    Solves the Laplace equation for harmonic measures in a multiply connected domain\n    and performs an analysis of a gradient-based inverse problem.\n    \"\"\"\n    # 1. Define problem parameters\n    N = 129\n    c1 = np.array([-0.3, 0.0])\n    r1 = 0.25\n    c2 = np.array([0.35, 0.1])\n    r2 = 0.20\n    target_points_phys = [\n        (0.0, 0.0), (-0.05, 0.0), (0.65, -0.25),\n        (0.15, 0.15), (-0.6, 0.4), (0.4, -0.5)\n    ]\n    alpha_star = np.array([0.8, -0.4, 0.2])\n    epsilon1 = 1e-6\n    epsilon2 = 1e-6\n    tau = 1e-10\n\n    # 2. Set up grid and domain masks\n    x = np.linspace(-1.0, 1.0, N)\n    y = np.linspace(-1.0, 1.0, N)\n    h = x[1] - x[0]\n    X, Y = np.meshgrid(x, y)\n\n    mask_hole1 = (X - c1[0])**2 + (Y - c1[1])**2 < r1**2\n    mask_hole2 = (X - c2[0])**2 + (Y - c2[1])**2 < r2**2\n    is_domain = ~mask_hole1 & ~mask_hole2\n\n    # 3. Identify boundary and interior nodes\n    bdy_out = np.zeros((N, N), dtype=bool)\n    bdy_out[[0, -1], :] = True\n    bdy_out[:, [0, -1]] = True\n    bdy_out[~is_domain] = False\n\n    def get_inner_boundary(hole_mask):\n        dilated_mask = np.copy(hole_mask)\n        rows, cols = np.where(hole_mask)\n        for r, c in zip(rows, cols):\n            if r > 0: dilated_mask[r-1, c] = True\n            if r < N-1: dilated_mask[r+1, c] = True\n            if c > 0: dilated_mask[r, c-1] = True\n            if c < N-1: dilated_mask[r, c+1] = True\n        return dilated_mask & is_domain\n\n    bdy_1 = get_inner_boundary(mask_hole1)\n    bdy_2 = get_inner_boundary(mask_hole2)\n    bdy_1[bdy_out] = False\n    bdy_2[bdy_out] = False\n    bdy_1[bdy_2] = False\n\n    bdy_all = bdy_out | bdy_1 | bdy_2\n    interior_nodes = is_domain & ~bdy_all\n\n    interior_indices = np.where(interior_nodes)\n    num_interior = len(interior_indices[0])\n    interior_map = -np.ones((N, N), dtype=int)\n    interior_map[interior_indices] = np.arange(num_interior)\n\n    # 4. Assemble the finite difference matrix A\n    A = lil_matrix((num_interior, num_interior))\n    for k in range(num_interior):\n        i, j = interior_indices[0][k], interior_indices[1][k]\n        A[k, k] = 4.0\n        for ni, nj in [(i+1, j), (i-1, j), (i, j+1), (i, j-1)]:\n            if interior_nodes[ni, nj]:\n                A[k, interior_map[ni, nj]] = -1.0\n    A = A.tocsc()\n\n    # 5. Solve for harmonic measures\n    def solve_laplace(bc_out_val, bc_1_val, bc_2_val):\n        u_full = np.zeros((N, N))\n        u_full[bdy_out] = bc_out_val\n        u_full[bdy_1] = bc_1_val\n        u_full[bdy_2] = bc_2_val\n        \n        b = np.zeros(num_interior)\n        for k in range(num_interior):\n            i, j = interior_indices[0][k], interior_indices[1][k]\n            for ni, nj in [(i+1, j), (i-1, j), (i, j+1), (i, j-1)]:\n                if bdy_all[ni, nj]:\n                    b[k] += u_full[ni, nj]\n        \n        u_interior_flat = spsolve(A, b)\n        u_full[interior_indices] = u_interior_flat\n        return u_full\n\n    omega1_grid = solve_laplace(0.0, 1.0, 0.0)\n    omega2_grid = solve_laplace(0.0, 0.0, 1.0)\n    omega_out_grid = solve_laplace(1.0, 0.0, 0.0)\n\n    # 6. Find safe interior nodes for evaluation\n    padded_interior = np.pad(interior_nodes, 1, mode='constant', constant_values=False)\n    is_safe = np.zeros_like(interior_nodes)\n    for i in range(N):\n        for j in range(N):\n            if (padded_interior[i+1, j+1] and padded_interior[i, j+1] and\n                padded_interior[i+2, j+1] and padded_interior[i+1, j] and\n                padded_interior[i+1, j+2]):\n                is_safe[i, j] = True\n\n    target_indices = []\n    for p_x, p_y in target_points_phys:\n        j_approx = int(round((p_x - (-1.0)) / h))\n        i_approx = int(round((p_y - (-1.0)) / h))\n        \n        if is_safe[i_approx, j_approx]:\n            target_indices.append((i_approx, j_approx))\n            continue\n        \n        dist = 1\n        found = False\n        while not found:\n            min_dist_sq = float('inf')\n            best_idx = None\n            for i_s in range(max(0, i_approx - dist), min(N, i_approx + dist + 1)):\n                for j_s in range(max(0, j_approx - dist), min(N, j_approx + dist + 1)):\n                    if max(abs(i_s - i_approx), abs(j_s - j_approx)) == dist:\n                        if is_safe[i_s, j_s]:\n                            dist_sq = (i_s - i_approx)**2 + (j_s - j_approx)**2\n                            if dist_sq < min_dist_sq:\n                                min_dist_sq = dist_sq\n                                best_idx = (i_s, j_s)\n                                found = True\n            if found:\n                target_indices.append(best_idx)\n            dist += 1\n    \n    # 7. Perform required tests\n    results = []\n\n    # Test 1: Sum of harmonic measures\n    p0_idx = target_indices[0]\n    sum_at_p0 = omega1_grid[p0_idx] + omega2_grid[p0_idx] + omega_out_grid[p0_idx]\n    results.append(np.abs(sum_at_p0 - 1.0) < epsilon1)\n\n    # Test 2: Proximity test\n    p1_idx = target_indices[1]\n    val_w1_p1 = omega1_grid[p1_idx]\n    val_w2_p1 = omega2_grid[p1_idx]\n    val_wout_p1 = omega_out_grid[p1_idx]\n    results.append(val_w1_p1 > max(val_w2_p1, val_wout_p1))\n\n    # Inversion problem setup\n    def get_grad(grid, idx):\n        i, j = idx\n        grad_x = (grid[i, j+1] - grid[i, j-1]) / (2.0 * h)\n        grad_y = (grid[i+1, j] - grid[i-1, j]) / (2.0 * h)\n        return np.array([grad_x, grad_y])\n\n    G = np.zeros((len(target_points_phys) * 2, 3))\n    for k, idx in enumerate(target_indices):\n        G[2*k:2*k+2, 0] = get_grad(omega1_grid, idx)\n        G[2*k:2*k+2, 1] = get_grad(omega2_grid, idx)\n        G[2*k:2*k+2, 2] = get_grad(omega_out_grid, idx)\n\n    # Test 3: Numerical rank\n    s = np.linalg.svd(G, compute_uv=False)\n    results.append(np.sum(s > tau))\n\n    # Test 4: Non-uniqueness check\n    d = G @ alpha_star\n    alpha_hat = np.linalg.lstsq(G, d, rcond=None)[0]\n    diff = alpha_hat - alpha_star\n    c = np.mean(diff)\n    results.append(np.allclose(diff, c, atol=epsilon2))\n\n    # Test 5: Gauge-fixed solution error\n    G_reduced = G[:, :2]\n    alpha_tilde_reduced = np.linalg.lstsq(G_reduced, d, rcond=None)[0]\n    alpha_tilde = np.array([alpha_tilde_reduced[0], alpha_tilde_reduced[1], 0.0])\n    alpha_star_gf = alpha_star - alpha_star[2]\n    results.append(np.linalg.norm(alpha_tilde - alpha_star_gf))\n\n    # 8. Final Output\n    print(f\"[{results[0]},{results[1]},{results[2]},{results[3]},{results[4]}]\")\n\nsolve()\n```", "id": "3612950"}]}