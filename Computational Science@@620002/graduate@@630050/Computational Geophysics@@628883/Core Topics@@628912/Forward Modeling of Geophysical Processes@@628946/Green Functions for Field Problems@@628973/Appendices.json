{"hands_on_practices": [{"introduction": "Understanding Green's functions begins with the fundamental relationship between the differential operator and the Dirac delta source. This exercise solidifies this core concept by having you directly verify the normalization of the Green's function for the Laplace operator in free space [@problem_id:3602276]. By applying the divergence theorem, you will connect the abstract distributional definition, $\\nabla^2 G = -\\delta(\\mathbf{x}-\\mathbf{x}_0)$, to the tangible physical concept of flux, confirming that the Green's function correctly represents the field from a unit point source.", "problem": "In a homogeneous, isotropic, unbounded medium in $\\mathbb{R}^3$, the free-space Green's function $G(\\mathbf{x};\\mathbf{x}_0)$ for the static Laplace operator is defined by the distributional equation\n$$\n\\nabla^2 G(\\mathbf{x};\\mathbf{x}_0) = -\\delta(\\mathbf{x}-\\mathbf{x}_0),\n$$\nwhere $\\delta$ is the Dirac delta function, together with the radiation condition that $G(\\mathbf{x};\\mathbf{x}_0) \\to 0$ as $|\\mathbf{x}| \\to \\infty$. This normalization is fundamental in computational geophysics for boundary-integral and volume-integral formulations of potential field problems.\n\nLet $B_R(\\mathbf{x}_0) = \\{\\mathbf{x} \\in \\mathbb{R}^3 : |\\mathbf{x}-\\mathbf{x}_0| < R\\}$ denote a ball of radius $R>0$ centered at $\\mathbf{x}_0$, and let $\\partial B_R(\\mathbf{x}_0)$ denote its boundary sphere with outward unit normal $\\mathbf{n}$. Starting only from the defining equation for $G(\\mathbf{x};\\mathbf{x}_0)$, the properties of the Dirac delta function, and the divergence theorem, do the following:\n\n1. Integrate $\\nabla^2 G(\\mathbf{x};\\mathbf{x}_0)$ over $B_R(\\mathbf{x}_0)$ and use the divergence theorem to express the volume integral in terms of the surface flux $\\int_{\\partial B_R(\\mathbf{x}_0)} \\nabla G(\\mathbf{x};\\mathbf{x}_0) \\cdot \\mathbf{n} \\, \\mathrm{d}S$.\n\n2. Evaluate the volume integral exactly using only the defining property of the Dirac delta function to obtain the value of the surface flux. Argue why this value is independent of $R$.\n\n3. To cross-check consistency, assume $G(\\mathbf{x};\\mathbf{x}_0)$ is spherically symmetric outside $\\mathbf{x}_0$, i.e., $G(\\mathbf{x};\\mathbf{x}_0) = f(r)$ with $r = |\\mathbf{x}-\\mathbf{x}_0|$, and satisfies $\\nabla^2 G(\\mathbf{x};\\mathbf{x}_0) = 0$ for $r>0$ and $G(\\mathbf{x};\\mathbf{x}_0) \\to 0$ as $r \\to \\infty$. Derive the general form of $f(r)$, compute the corresponding surface flux through $\\partial B_R(\\mathbf{x}_0)$, and confirm that it matches the value found in part $2$.\n\nExpress your final answer as a dimensionless real number equal to the value of the surface flux $\\int_{\\partial B_R(\\mathbf{x}_0)} \\nabla G(\\mathbf{x};\\mathbf{x}_0) \\cdot \\mathbf{n} \\, \\mathrm{d}S$. No rounding is required.", "solution": "The problem asks for the value of the surface flux of the gradient of the free-space Green's function for the Laplacian in $\\mathbb{R}^3$. The derivation proceeds in three steps as outlined in the problem statement.\n\nThe Green's function $G(\\mathbf{x};\\mathbf{x}_0)$ is defined by the distributional equation:\n$$\n\\nabla^2 G(\\mathbf{x};\\mathbf{x}_0) = -\\delta(\\mathbf{x}-\\mathbf{x}_0)\n$$\nwhere $\\delta$ is the Dirac delta function. We are also given the boundary condition at infinity, $G(\\mathbf{x};\\mathbf{x}_0) \\to 0$ as $|\\mathbf{x}| \\to \\infty$. The integration volume is a ball $B_R(\\mathbf{x}_0)$ of radius $R>0$ centered at the source point $\\mathbf{x}_0$, and its boundary is the sphere $\\partial B_R(\\mathbf{x}_0)$.\n\n**Part 1: Application of the Divergence Theorem**\n\nWe begin by integrating the defining equation for $G(\\mathbf{x};\\mathbf{x}_0)$ over the volume of the ball $B_R(\\mathbf{x}_0)$. The integral of the left-hand side is:\n$$\n\\int_{B_R(\\mathbf{x}_0)} \\nabla^2 G(\\mathbf{x};\\mathbf{x}_0) \\, \\mathrm{d}V\n$$\nThe Laplacian operator can be written as the divergence of the gradient, $\\nabla^2 G = \\nabla \\cdot (\\nabla G)$. Substituting this into the integral gives:\n$$\n\\int_{B_R(\\mathbf{x}_0)} \\nabla \\cdot (\\nabla G(\\mathbf{x};\\mathbf{x}_0)) \\, \\mathrm{d}V\n$$\nThe divergence theorem states that for a continuously differentiable vector field $\\mathbf{F}$ defined on a volume $V$ with a piecewise smooth boundary $\\partial V$, the following relation holds:\n$$\n\\int_V (\\nabla \\cdot \\mathbf{F}) \\, \\mathrm{d}V = \\oint_{\\partial V} \\mathbf{F} \\cdot \\mathbf{n} \\, \\mathrm{d}S\n$$\nwhere $\\mathbf{n}$ is the outward unit normal to the surface $\\partial V$. In our case, the vector field is $\\mathbf{F} = \\nabla G$, the volume is $V = B_R(\\mathbf{x}_0)$, and the boundary is $\\partial V = \\partial B_R(\\mathbf{x}_0)$. Note that while $G$ has a singularity at $\\mathbf{x}_0$, its gradient $\\nabla G$ is well-behaved on the boundary $\\partial B_R(\\mathbf{x}_0)$ for any $R>0$. Applying the theorem yields:\n$$\n\\int_{B_R(\\mathbf{x}_0)} \\nabla^2 G(\\mathbf{x};\\mathbf{x}_0) \\, \\mathrm{d}V = \\int_{\\partial B_R(\\mathbf{x}_0)} \\nabla G(\\mathbf{x};\\mathbf{x}_0) \\cdot \\mathbf{n} \\, \\mathrm{d}S\n$$\nThis equation expresses the volume integral of the Laplacian of $G$ as the total flux of its gradient through the enclosing spherical surface.\n\n**Part 2: Evaluation using the Dirac Delta Function**\n\nNext, we evaluate the volume integral directly using the right-hand side of the defining equation for $G$.\n$$\n\\int_{B_R(\\mathbf{x}_0)} \\nabla^2 G(\\mathbf{x};\\mathbf{x}_0) \\, \\mathrm{d}V = \\int_{B_R(\\mathbf{x}_0)} -\\delta(\\mathbf{x}-\\mathbf{x}_0) \\, \\mathrm{d}V = - \\int_{B_R(\\mathbf{x}_0)} \\delta(\\mathbf{x}-\\mathbf{x}_0) \\, \\mathrm{d}V\n$$\nThe fundamental defining property of the Dirac delta function (the sifting property) is that for any function $f(\\mathbf{x})$ that is continuous at $\\mathbf{x}_0$,\n$$\n\\int_V f(\\mathbf{x}) \\delta(\\mathbf{x}-\\mathbf{x}_0) \\, \\mathrm{d}V = f(\\mathbf{x}_0)\n$$\nprovided that the point $\\mathbf{x}_0$ lies within the integration volume $V$. In our case, the integration volume is the ball $B_R(\\mathbf{x}_0)$ centered at $\\mathbf{x}_0$, so the singularity is always inside the volume for any $R>0$. We can use the sifting property with the constant function $f(\\mathbf{x}) = 1$. This gives:\n$$\n\\int_{B_R(\\mathbf{x}_0)} \\delta(\\mathbf{x}-\\mathbf{x}_0) \\, \\mathrm{d}V = 1\n$$\nTherefore, the value of the volume integral is:\n$$\n\\int_{B_R(\\mathbf{x}_0)} \\nabla^2 G(\\mathbf{x};\\mathbf{x}_0) \\, \\mathrm{d}V = -1\n$$\nCombining this result with the conclusion from Part 1, we find the value of the surface flux:\n$$\n\\int_{\\partial B_R(\\mathbf{x}_0)} \\nabla G(\\mathbf{x};\\mathbf{x}_0) \\cdot \\mathbf{n} \\, \\mathrm{d}S = -1\n$$\nThis result is a constant, specifically $-1$. It is independent of the radius $R$ of the ball because for any $R>0$, the ball $B_R(\\mathbf{x}_0)$ encloses the entirety of the source, which is concentrated at the single point $\\mathbf{x}_0$ as described by the delta function. The divergence theorem relates the flux through a closed surface to the total source strength enclosed, which in this case is constant and equal to $-1$.\n\n**Part 3: Consistency Check with Spherically Symmetric Solution**\n\nFinally, we cross-check this result by assuming a spherically symmetric form for the Green's function, $G(\\mathbf{x};\\mathbf{x}_0) = f(r)$, where $r = |\\mathbf{x}-\\mathbf{x}_0|$. For $r > 0$, the point $\\mathbf{x}$ is not equal to $\\mathbf{x}_0$, so $\\delta(\\mathbf{x}-\\mathbf{x}_0) = 0$. The defining equation reduces to Laplace's equation:\n$$\n\\nabla^2 G(\\mathbf{x};\\mathbf{x}_0) = 0 \\quad \\text{for } r > 0\n$$\nIn spherical coordinates centered at $\\mathbf{x}_0$, the Laplacian of a function $f(r)$ that depends only on the radial distance $r$ is:\n$$\n\\nabla^2 f(r) = \\frac{1}{r^2} \\frac{\\mathrm{d}}{\\mathrm{d}r} \\left( r^2 \\frac{\\mathrm{d}f}{\\mathrm{d}r} \\right)\n$$\nSetting this to zero for $r>0$ gives $\\frac{\\mathrm{d}}{\\mathrm{d}r} \\left( r^2 \\frac{\\mathrm{d}f}{\\mathrm{d}r} \\right) = 0$. Integrating once with respect to $r$ yields $r^2 \\frac{\\mathrm{d}f}{\\mathrm{d}r} = C_1$, where $C_1$ is a constant of integration. Rearranging gives $\\frac{\\mathrm{d}f}{\\mathrm{d}r} = \\frac{C_1}{r^2}$. Integrating a second time yields:\n$$\nf(r) = -\\frac{C_1}{r} + C_2\n$$\nwhere $C_2$ is a second integration constant. The radiation condition requires that $G \\to 0$ as $r \\to \\infty$. Applying this condition:\n$$\n\\lim_{r\\to\\infty} \\left(-\\frac{C_1}{r} + C_2\\right) = 0 + C_2 = 0\n$$\nThis forces $C_2=0$. The general form for $G$ satisfying the conditions for $r>0$ is thus $G(\\mathbf{x};\\mathbf{x}_0) = f(r) = -C_1/r$.\n\nNow, we compute the surface flux for this functional form. The gradient of a spherically symmetric function $f(r)$ is $\\nabla f = \\frac{\\mathrm{d}f}{\\mathrm{d}r} \\hat{\\mathbf{r}}$, where $\\hat{\\mathbf{r}} = (\\mathbf{x}-\\mathbf{x}_0)/r$ is the radial unit vector.\n$$\n\\nabla G = \\frac{\\mathrm{d}}{\\mathrm{d}r}\\left(-\\frac{C_1}{r}\\right) \\hat{\\mathbf{r}} = \\frac{C_1}{r^2} \\hat{\\mathbf{r}}\n$$\nThe flux is calculated over the sphere $\\partial B_R(\\mathbf{x}_0)$ where $r=R$. The outward unit normal is $\\mathbf{n} = \\hat{\\mathbf{r}}$.\n$$\n\\int_{\\partial B_R(\\mathbf{x}_0)} \\nabla G \\cdot \\mathbf{n} \\, \\mathrm{d}S = \\int_{\\partial B_R(\\mathbf{x}_0)} \\left(\\frac{C_1}{r^2} \\hat{\\mathbf{r}}\\right) \\cdot \\hat{\\mathbf{r}} \\, \\mathrm{d}S\n$$\nOn the surface of integration, $r=R$ is constant, so the integrand is $\\frac{C_1}{R^2}$. The integral becomes:\n$$\n\\frac{C_1}{R^2} \\int_{\\partial B_R(\\mathbf{x}_0)} \\, \\mathrm{d}S = \\frac{C_1}{R^2} \\times (\\text{Surface Area of Sphere}) = \\frac{C_1}{R^2} (4\\pi R^2) = 4\\pi C_1\n$$\nThis flux value, $4\\pi C_1$, must be consistent with the value $-1$ derived in Part 2 from first principles. Equating the two results:\n$$\n4\\pi C_1 = -1\n$$\nThis confirms the consistency between the two approaches. The constant must be $C_1 = -1/(4\\pi)$ to satisfy the defining equation for the Green's function. The flux is indeed $-1$, independent of the specific form of the Green's function so long as it satisfies the defining differential equation. The value of the flux is therefore definitively established.", "answer": "$$\\boxed{-1}$$", "id": "3602276"}, {"introduction": "Green's functions are not limited to static problems; they are essential for describing the evolution of fields in time. This practice guides you through the derivation of the 'heat kernel,' the Green's function for the diffusion equation, using the powerful method of Fourier transforms [@problem_id:3602304]. Mastering this derivation will provide you with a key tool for solving a wide class of time-dependent linear partial differential equations and a deeper appreciation for how solutions are built through convolution with the fundamental response.", "problem": "Consider a homogeneous, isotropic, unbounded medium in $d$ spatial dimensions with constant thermal diffusivity $\\kappa>0$. The temperature field $u(\\mathbf{x},t)$ obeys the heat conduction equation\n$$\n\\partial_{t} u(\\mathbf{x},t) - \\kappa \\nabla^{2} u(\\mathbf{x},t) = f(\\mathbf{x},t), \\quad t>0,\\ \\mathbf{x}\\in\\mathbb{R}^{d},\n$$\nwith initial data $u(\\mathbf{x},0)=u_{0}(\\mathbf{x})$. Define the Green's function $G(\\mathbf{x},t)$ for this field problem to be the unique solution of the homogeneous equation with an impulsive initial condition,\n$$\n\\partial_{t} G(\\mathbf{x},t) - \\kappa \\nabla^{2} G(\\mathbf{x},t) = 0,\\quad t>0,\\ \\mathbf{x}\\in\\mathbb{R}^{d},\\qquad G(\\mathbf{x},0)=\\delta(\\mathbf{x}),\n$$\nwhere $\\delta(\\mathbf{x})$ is the Dirac delta distribution. Starting from the governing equation, conservation of energy, and the definitions of translation invariance and isotropy for $\\mathbb{R}^{d}$, derive the closed-form expression of $G(\\mathbf{x},t)$ that satisfies:\n- normalization for all $t>0$, $\\int_{\\mathbb{R}^{d}} G(\\mathbf{x},t)\\,\\mathrm{d}\\mathbf{x}=1$,\n- semigroup property in time, $G(\\cdot,t)\\ast G(\\cdot,s)=G(\\cdot,t+s)$ for all $s,t>0$,\n- positivity and radial symmetry in $\\mathbf{x}$.\n\nThen, using your derived $G(\\mathbf{x},t)$, justify the representation of solutions to the forced problem via superposition with initial data, namely\n$$\nu(\\mathbf{x},t) = \\int_{\\mathbb{R}^{d}} G(\\mathbf{x}-\\mathbf{y},t)\\,u_{0}(\\mathbf{y})\\,\\mathrm{d}\\mathbf{y} + \\int_{0}^{t}\\int_{\\mathbb{R}^{d}} G(\\mathbf{x}-\\mathbf{y},t-\\tau)\\,f(\\mathbf{y},\\tau)\\,\\mathrm{d}\\mathbf{y}\\,\\mathrm{d}\\tau,\n$$\nby invoking the appropriate fundamental principles of linear systems and causality, without appealing to any prefabricated formulas.\n\nProvide your final answer as a single, closed-form analytical expression for $G(\\mathbf{x},t)$ in terms of $\\mathbf{x}$, $t$, $\\kappa$, and $d$. Use the International System of Units (SI): $\\mathbf{x}$ in meters, $t$ in seconds, and $\\kappa$ in square meters per second. Do not include units in your final expression.", "solution": "We are tasked with two objectives: first, to derive the Green's function $G(\\mathbf{x},t)$ for the $d$-dimensional heat equation, and second, to justify the superposition principle for constructing solutions to the inhomogeneous problem.\n\n### Part 1: Derivation of the Green's Function $G(\\mathbf{x},t)$\n\nThe Green's function $G(\\mathbf{x},t)$ is defined as the solution to the homogeneous heat equation in an unbounded domain $\\mathbb{R}^d$ for an initial point source at the origin:\n$$\n\\partial_{t} G(\\mathbf{x},t) - \\kappa \\nabla^{2} G(\\mathbf{x},t) = 0, \\quad t>0, \\ \\mathbf{x}\\in\\mathbb{R}^{d}\n$$\nwith the initial condition:\n$$\nG(\\mathbf{x},0) = \\delta(\\mathbf{x})\n$$\nwhere $\\delta(\\mathbf{x})$ is the $d$-dimensional Dirac delta distribution.\n\nThe most direct method to solve this linear partial differential equation with constant coefficients is via the spatial Fourier transform. Let $\\hat{G}(\\mathbf{k},t)$ be the Fourier transform of $G(\\mathbf{x},t)$ with respect to the spatial variables $\\mathbf{x}$:\n$$\n\\hat{G}(\\mathbf{k},t) = \\mathcal{F}_{\\mathbf{x}}\\{G(\\mathbf{x},t)\\}(\\mathbf{k}) = \\int_{\\mathbb{R}^d} G(\\mathbf{x},t) e^{-i\\mathbf{k}\\cdot\\mathbf{x}} \\mathrm{d}\\mathbf{x}\n$$\nApplying the Fourier transform to the PDE, we use the properties $\\mathcal{F}\\{\\partial_t G\\} = \\partial_t \\hat{G}$ and $\\mathcal{F}\\{\\nabla^2 G\\} = -|\\mathbf{k}|^2 \\hat{G}$. The PDE transforms into a first-order ordinary differential equation in time for each wavevector $\\mathbf{k}$:\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t}\\hat{G}(\\mathbf{k},t) + \\kappa |\\mathbf{k}|^2 \\hat{G}(\\mathbf{k},t) = 0\n$$\nThe initial condition $G(\\mathbf{x},0) = \\delta(\\mathbf{x})$ is also transformed:\n$$\n\\hat{G}(\\mathbf{k},0) = \\int_{\\mathbb{R}^d} \\delta(\\mathbf{x}) e^{-i\\mathbf{k}\\cdot\\mathbf{x}} \\mathrm{d}\\mathbf{x} = 1\n$$\nThe solution to the ODE with this initial condition is:\n$$\n\\hat{G}(\\mathbf{k},t) = \\exp\\left(-\\kappa |\\mathbf{k}|^2 t\\right)\n$$\nTo find $G(\\mathbf{x},t)$, we compute the inverse Fourier transform of $\\hat{G}(\\mathbf{k},t)$:\n$$\nG(\\mathbf{x},t) = \\mathcal{F}_{\\mathbf{k}}^{-1}\\{\\hat{G}(\\mathbf{k},t)\\}(\\mathbf{x}) = \\frac{1}{(2\\pi)^d} \\int_{\\mathbb{R}^d} \\hat{G}(\\mathbf{k},t) e^{i\\mathbf{k}\\cdot\\mathbf{x}} \\mathrm{d}\\mathbf{k} = \\frac{1}{(2\\pi)^d} \\int_{\\mathbb{R}^d} \\exp\\left(-\\kappa t |\\mathbf{k}|^2\\right) e^{i\\mathbf{k}\\cdot\\mathbf{x}} \\mathrm{d}\\mathbf{k}\n$$\nThis integral is a standard Gaussian integral in $\\mathbb{R}^d$. We can evaluate it by separating the components of $\\mathbf{k}=(k_1, \\dots, k_d)$ and $\\mathbf{x}=(x_1, \\dots, x_d)$:\n$$\nG(\\mathbf{x},t) = \\frac{1}{(2\\pi)^d} \\int_{\\mathbb{R}^d} \\exp\\left(-\\kappa t \\sum_{j=1}^d k_j^2\\right) \\exp\\left(i \\sum_{j=1}^d k_j x_j\\right) \\prod_{j=1}^d \\mathrm{d}k_j\n$$\n$$\nG(\\mathbf{x},t) = \\frac{1}{(2\\pi)^d} \\prod_{j=1}^d \\int_{-\\infty}^{\\infty} \\exp\\left(-\\kappa t k_j^2 + i k_j x_j\\right) \\mathrm{d}k_j\n$$\nUsing the standard result for a one-dimensional Gaussian integral $\\int_{-\\infty}^{\\infty} e^{-az^2+ibz} \\mathrm{d}z = \\sqrt{\\frac{\\pi}{a}} e^{-b^2/(4a)}$, with $a = \\kappa t$ and $b = x_j$, we get:\n$$\n\\int_{-\\infty}^{\\infty} \\exp\\left(-\\kappa t k_j^2 + i k_j x_j\\right) \\mathrm{d}k_j = \\sqrt{\\frac{\\pi}{\\kappa t}} \\exp\\left(-\\frac{x_j^2}{4\\kappa t}\\right)\n$$\nSubstituting this back into the expression for $G(\\mathbf{x},t)$:\n$$\nG(\\mathbf{x},t) = \\frac{1}{(2\\pi)^d} \\prod_{j=1}^d \\left[ \\sqrt{\\frac{\\pi}{\\kappa t}} \\exp\\left(-\\frac{x_j^2}{4\\kappa t}\\right) \\right] = \\frac{1}{(2\\pi)^d} \\left(\\frac{\\pi}{\\kappa t}\\right)^{d/2} \\exp\\left(-\\frac{\\sum_{j=1}^d x_j^2}{4\\kappa t}\\right)\n$$\nRecognizing that $(2\\pi)^d = 2^d \\pi^d = (4\\pi^2)^{d/2}$ and $\\sum_{j=1}^d x_j^2 = |\\mathbf{x}|^2$, we simplify the expression:\n$$\nG(\\mathbf{x},t) = \\frac{\\pi^{d/2}}{(4\\pi^2\\kappa t)^{d/2}} \\exp\\left(-\\frac{|\\mathbf{x}|^2}{4\\kappa t}\\right) = \\frac{1}{(4\\pi\\kappa t)^{d/2}} \\exp\\left(-\\frac{|\\mathbf{x}|^2}{4\\kappa t}\\right)\n$$\nThis is the closed-form expression for the Green's function, also known as the heat kernel.\n\nWe verify that this solution satisfies the required properties.\n- **Positivity**: For $t>0$ and $\\kappa>0$, the pre-factor $(4\\pi\\kappa t)^{-d/2}$ is positive, and the exponential function is always positive. Thus, $G(\\mathbf{x},t) > 0$.\n- **Radial Symmetry**: The expression for $G(\\mathbf{x},t)$ depends only on the magnitude $|\\mathbf{x}|$, not on the direction of $\\mathbf{x}$. This is a direct consequence of the isotropy of the medium and the $\\nabla^2$ operator.\n- **Normalization (Conservation of Energy)**: The total \"heat\" must be conserved. Integrating the PDE for $G$ over $\\mathbb{R}^d$ shows that $\\frac{d}{dt}\\int G(\\mathbf{x},t) \\mathrm{d}\\mathbf{x} = 0$. Since $\\int G(\\mathbf{x},0)\\mathrm{d}\\mathbf{x} = \\int \\delta(\\mathbf{x})\\mathrm{d}\\mathbf{x} = 1$, the integral must remain $1$ for all $t>0$. Let's check:\n$$\n\\int_{\\mathbb{R}^d} G(\\mathbf{x},t) \\mathrm{d}\\mathbf{x} = \\int_{\\mathbb{R}^d} \\frac{1}{(4\\pi\\kappa t)^{d/2}} \\exp\\left(-\\frac{|\\mathbf{x}|^2}{4\\kappa t}\\right) \\mathrm{d}\\mathbf{x}\n$$\nUsing the $d$-dimensional Gaussian integral formula $\\int_{\\mathbb{R}^d} e^{-a|\\mathbf{x}|^2} \\mathrm{d}\\mathbf{x} = (\\pi/a)^{d/2}$ with $a = 1/(4\\kappa t)$:\n$$\n\\int_{\\mathbb{R}^d} G(\\mathbf{x},t) \\mathrm{d}\\mathbf{x} = \\frac{1}{(4\\pi\\kappa t)^{d/2}} \\left(\\pi \\cdot 4\\kappa t\\right)^{d/2} = 1\n$$\nThe normalization is satisfied.\n- **Semigroup Property**: $G(\\cdot,t)\\ast G(\\cdot,s)=G(\\cdot,t+s)$. In the Fourier domain, this corresponds to $\\hat{G}(\\mathbf{k},t)\\hat{G}(\\mathbf{k},s)=\\hat{G}(\\mathbf{k},t+s)$. From our derivation, we have $\\hat{G}(\\mathbf{k},t) = \\exp(-\\kappa |\\mathbf{k}|^2 t)$. Thus, $\\exp(-\\kappa |\\mathbf{k}|^2 t) \\exp(-\\kappa |\\mathbf{k}|^2 s) = \\exp(-\\kappa |\\mathbf{k}|^2 (t+s))$, which is $\\hat{G}(\\mathbf{k},t+s)$. This confirms the semigroup property.\n\n### Part 2: Justification of the Superposition Representation\n\nThe solution to the forced problem with initial data is given by:\n$$\nu(\\mathbf{x},t) = \\int_{\\mathbb{R}^{d}} G(\\mathbf{x}-\\mathbf{y},t)\\,u_{0}(\\mathbf{y})\\,\\mathrm{d}\\mathbf{y} + \\int_{0}^{t}\\int_{\\mathbb{R}^{d}} G(\\mathbf{x}-\\mathbf{y},t-\\tau)\\,f(\\mathbf{y},\\tau)\\,\\mathrm{d}\\mathbf{y}\\,\\mathrm{d}\\tau\n$$\nThis formula is a direct consequence of the linearity of the heat equation. By the principle of superposition, the general solution is the sum of the solution to the homogeneous equation for the given initial data, $u_h(\\mathbf{x},t)$, and the solution to the inhomogeneous equation with zero initial data, $u_p(\\mathbf{x},t)$.\n\n**1. Homogeneous Solution (Initial Value Problem):**\nLet $u_h(\\mathbf{x},t) = \\int_{\\mathbb{R}^{d}} G(\\mathbf{x}-\\mathbf{y},t)\\,u_{0}(\\mathbf{y})\\,\\mathrm{d}\\mathbf{y} = (G(\\cdot, t) \\ast u_0)(\\mathbf{x})$.\nThis represents the evolution of the initial temperature distribution $u_0(\\mathbf{x})$. The formulation relies on decomposing the initial state into a continuum of point sources: $u_0(\\mathbf{x}) = \\int_{\\mathbb{R}^d} u_0(\\mathbf{y})\\delta(\\mathbf{x}-\\mathbf{y})\\,\\mathrm{d}\\mathbf{y}$. By linearity and translation invariance, if an impulse $\\delta(\\mathbf{x}-\\mathbf{y})$ at $t=0$ evolves into $G(\\mathbf{x}-\\mathbf{y},t)$ at time $t$, then the superposition of these impulses weighted by $u_0(\\mathbf{y})$ evolves into the convolution integral shown. We verify this formally:\n-   **PDE**: $L u_h = (\\partial_t - \\kappa\\nabla^2)u_h = \\int_{\\mathbb{R}^d} L[G(\\mathbf{x}-\\mathbf{y},t)]u_0(\\mathbf{y})\\,\\mathrm{d}\\mathbf{y} = \\int_{\\mathbb{R}^d} 0 \\cdot u_0(\\mathbf{y})\\,\\mathrm{d}\\mathbf{y} = 0$, since $G$ solves the homogeneous equation.\n-   **Initial Condition**: As $t \\to 0^+$, $G(\\mathbf{x},t)$ behaves like the Dirac delta distribution $\\delta(\\mathbf{x})$. Thus, $\\lim_{t\\to 0^+} u_h(\\mathbf{x},t) = \\int_{\\mathbb{R}^d} \\delta(\\mathbf{x}-\\mathbf{y})u_0(\\mathbf{y})\\,\\mathrm{d}\\mathbf{y} = u_0(\\mathbf{x})$.\n\n**2. Particular Solution (Forced Problem):**\nLet $u_p(\\mathbf{x},t) = \\int_{0}^{t} \\int_{\\mathbb{R}^{d}} G(\\mathbf{x}-\\mathbf{y},t-\\tau)\\,f(\\mathbf{y},\\tau)\\,\\mathrm{d}\\mathbf{y}\\,\\mathrm{d}\\tau$.\nThis is an application of Duhamel's principle, which expresses the solution to a forced linear system as a superposition of impulse responses. The forcing function $f(\\mathbf{y},\\tau)$ can be viewed as a sequence of infinitesimal impulses in space and time. An impulse of strength $f(\\mathbf{y},\\tau)\\,\\mathrm{d}\\mathbf{y}\\,\\mathrm{d}\\tau$ occurring at position $\\mathbf{y}$ and time $\\tau$ generates a response at $(\\mathbf{x},t)$ given by $G(\\mathbf{x}-\\mathbf{y}, t-\\tau) f(\\mathbf{y},\\tau)\\,\\mathrm{d}\\mathbf{y}\\,\\mathrm{d}\\tau$. The principle of causality dictates that the response can only occur for $t > \\tau$. Integrating over all past times $\\tau \\in [0,t]$ and all source locations $\\mathbf{y} \\in \\mathbb{R}^d$ yields the particular solution $u_p$. We verify this:\n- **PDE**: Let $L = \\partial_t - \\kappa\\nabla^2$. Applying $L$ to $u_p$ and using the Leibniz integral rule for the time derivative yields:\n$$\n\\partial_t u_p(\\mathbf{x},t) = \\int_{\\mathbb{R}^d} G(\\mathbf{x}-\\mathbf{y}, t-t) f(\\mathbf{y},t)\\,\\mathrm{d}\\mathbf{y} + \\int_0^t \\int_{\\mathbb{R}^d} \\partial_t G(\\mathbf{x}-\\mathbf{y}, t-\\tau) f(\\mathbf{y},\\tau)\\,\\mathrm{d}\\mathbf{y}\\,\\mathrm{d}\\tau\n$$\nThe first term simplifies to $\\int_{\\mathbb{R}^d} \\delta(\\mathbf{x}-\\mathbf{y})f(\\mathbf{y},t)\\,\\mathrm{d}\\mathbf{y} = f(\\mathbf{x},t)$. Thus,\n$$\nL u_p = f(\\mathbf{x},t) + \\int_0^t \\int_{\\mathbb{R}^d} (\\partial_t - \\kappa\\nabla^2_{\\mathbf{x}})G(\\mathbf{x}-\\mathbf{y},t-\\tau) f(\\mathbf{y},\\tau) \\,\\mathrm{d}\\mathbf{y}\\,\\mathrm{d}\\tau\n$$\nSince $G$ solves the homogeneous equation for time argument $t-\\tau > 0$, the integrand is zero. Therefore, $L u_p = f(\\mathbf{x},t)$.\n- **Initial Condition**: $u_p(\\mathbf{x},0) = \\int_0^0 \\dots \\mathrm{d}\\tau = 0$.\n\nThe total solution $u(\\mathbf{x},t) = u_h(\\mathbf{x},t) + u_p(\\mathbf{x},t)$ correctly satisfies $L u = f$ and $u(\\mathbf{x},0)=u_0(\\mathbf{x})$, justifying the representation based on linearity, causality, and translation invariance.", "answer": "$$\n\\boxed{\\frac{1}{(4\\pi\\kappa t)^{d/2}} \\exp\\left(-\\frac{|\\mathbf{x}|^2}{4\\kappa t}\\right)}\n$$", "id": "3602304"}, {"introduction": "Theoretical properties of differential operators, such as self-adjointness, have profound physical consequences like reciprocity. This computational exercise tasks you with exploring what happens when this property is broken by an advection term in the governing equation [@problem_id:3602355]. By discretizing the operator and numerically computing the Green's function, you will directly observe and quantify the breakdown of symmetry and reciprocity, gaining valuable insight into the connection between abstract operator theory and practical wavefield simulation.", "problem": "Consider a one-dimensional scalar field in a moving medium occupying the interval $(0,L_x)$, governed in the frequency domain by a linear differential operator $L$ acting on a field $u(x)$ with homogeneous Dirichlet boundary conditions. The operator $L$ is defined by $L u = -\\partial_x^2 u + \\beta \\,\\partial_x u - k^2 u$, where $\\beta$ is the constant advection parameter and $k$ is a positive real wavenumber-like parameter. The Green's function $G(x,x')$ is defined by $L G(\\cdot,x') = \\delta(\\cdot-x')$ together with $G(0,x') = 0$ and $G(L_x,x') = 0$. In the standard $L^2$ inner product $\\langle f,g \\rangle = \\int_0^{L_x} f(x)\\,g(x)\\,dx$ with the aforementioned boundary conditions, self-adjointness requires $\\langle u, L v \\rangle = \\langle L u, v \\rangle$ for all sufficiently smooth $u,v$. The presence of the $\\beta\\,\\partial_x$ term renders $L$ non-self-adjoint unless $\\beta=0$. Non-self-adjointness can lead to broken symmetry and reciprocity of $G(x,x')$, meaning that $G(x,x') \\neq G(x',x)$ in general.\n\nYour task is to compute numerical Green's functions for the operator $L$ on $(0,L_x)$ under homogeneous Dirichlet boundary conditions, evaluate symmetry and reciprocity of the discrete Green's function matrix, and quantify interferometric retrieval bias arising when $L$ is non-self-adjoint. Use a second-order central-difference discretization on the interior grid points and assemble the discrete operator matrix $L_h \\in \\mathbb{R}^{N\\times N}$ for $N$ interior points with spacing $h = L_x/(N+1)$, incorporating the Dirichlet boundary conditions by eliminating the boundary nodes. Specifically, for interior row index $i \\in \\{1,\\dots,N\\}$, the discrete action of $L$ on a vector $u\\in\\mathbb{R}^N$ is\n$$(L_h u)_i = \\frac{-u_{i-1} + 2 u_i - u_{i+1}}{h^2} + \\beta \\,\\frac{u_{i+1} - u_{i-1}}{2h} - k^2 u_i,$$\nwith the understanding that $u_0=u_{N+1}=0$ due to the homogeneous Dirichlet boundary conditions. Assemble $L_h$ accordingly as a tridiagonal matrix with non-symmetric off-diagonal entries when $\\beta\\neq 0$.\n\nDefine the discrete Green's function matrix $G_h \\in \\mathbb{R}^{N\\times N}$ to be the inverse of $L_h$, so that $L_h G_h = I_N$, where $I_N$ is the $N\\times N$ identity matrix. Evaluate the following quantitative measures:\n\n- Symmetry deviation ratio $S = \\|G_h - G_h^\\top\\|_F / \\|G_h\\|_F$, where $\\|\\cdot\\|_F$ is the Frobenius norm and $(\\cdot)^\\top$ denotes transpose.\n\n- Reciprocity deviation between two receiver locations $x_A$ and $x_B$ chosen at $x_A = L_x/3$ and $x_B = 2 L_x/3$. Let $i_A$ and $i_B$ be the nearest interior grid indices to $x_A$ and $x_B$, respectively. Define $R = |G_{h}[i_A,i_B] - G_{h}[i_B,i_A]| / \\max(|G_{h}[i_A,i_B]|,|G_{h}[i_B,i_A]|)$.\n\n- Interferometric retrieval bias $B$ under spatially white, temporally uncorrelated source excitation with covariance proportional to the identity matrix. In the discrete setting, the ensemble-averaged cross-correlation matrix is proportional to $C = G_h G_h^\\top$. The nominal symmetric target for retrieval is $G_{\\mathrm{sym}} = (G_h + G_h^\\top)/2$. To quantify the bias, determine the scalar $\\gamma$ that minimizes the Frobenius norm mismatch $\\|\\gamma C - G_{\\mathrm{sym}}\\|_F$. The optimal scalar is $\\gamma^\\star = \\frac{\\langle C, G_{\\mathrm{sym}}\\rangle_F}{\\|C\\|_F^2}$, where $\\langle A,B\\rangle_F = \\mathrm{trace}(A^\\top B)$. Then define $B = \\|\\gamma^\\star C - G_{\\mathrm{sym}}\\|_F / \\|G_{\\mathrm{sym}}\\|_F$.\n\nImplement a program that constructs $L_h$, computes $G_h$, evaluates $S$, $R$, and $B$ for each test case, and prints the results. The program must use the specified runtime environment and produce a single line of output following the required format.\n\nUse the following test suite of parameter tuples $(N,L_x,\\beta,k)$:\n\n- Test $1$: $(50,1.0,0.0,8.0)$, a baseline self-adjoint case.\n\n- Test $2$: $(50,1.0,4.0,8.0)$, a moderate advection case.\n\n- Test $3$: $(50,1.0,20.0,8.0)$, a strong advection case.\n\n- Test $4$: $(50,1.0,-8.0,8.0)$, a counter-flow case.\n\nAll quantities are dimensionless and unitless in this formulation. For each test case, compute the triple $(S,B,R)$ as real-valued floats.\n\nFinal output format: Your program should produce a single line of output containing a list of lists, one per test case, each inner list being the triple $[S,B,R]$. For example, the printed line should look like $[[S_1,B_1,R_1],[S_2,B_2,R_2],[S_3,B_3,R_3],[S_4,B_4,R_4]]$, with numeric values replacing the symbols. No other text should be printed.", "solution": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef calculate_metrics(N, Lx, beta, k):\n    \"\"\"\n    Constructs the discrete operator, computes the Green's function matrix,\n    and evaluates the specified metrics S, B, and R.\n\n    Args:\n        N (int): Number of interior grid points.\n        Lx (float): Length of the domain.\n        beta (float): Advection parameter.\n        k (float): Wavenumber-like parameter.\n\n    Returns:\n        list: A list containing the three computed metrics [S, B, R].\n    \"\"\"\n    # 1. Discretization Setup\n    h = Lx / (N + 1)\n\n    # 2. Operator Matrix Assembly\n    # (L_h u)_i = (-1/h^2 - beta/(2h)) * u_{i-1} \n    #           + (2/h^2 - k^2) * u_i \n    #           + (-1/h^2 + beta/(2h)) * u_{i+1}\n    \n    diag_main = (2.0 / h**2 - k**2) * np.ones(N)\n    diag_upper = (-1.0 / h**2 + beta / (2.0 * h)) * np.ones(N - 1)\n    diag_lower = (-1.0 / h**2 - beta / (2.0 * h)) * np.ones(N - 1)\n    \n    Lh = np.diag(diag_main) + np.diag(diag_upper, k=1) + np.diag(diag_lower, k=-1)\n    \n    # 3. Green's Function Calculation\n    Gh = np.linalg.inv(Lh)\n    \n    # 4. Metric Evaluation\n\n    # 4a. Symmetry deviation ratio S\n    Gh_T = Gh.T\n    norm_Gh = np.linalg.norm(Gh, 'fro')\n    \n    if norm_Gh == 0:\n        S = 0.0\n    else:\n        norm_diff_S = np.linalg.norm(Gh - Gh_T, 'fro')\n        S = norm_diff_S / norm_Gh\n\n    # 4b. Reciprocity deviation R\n    # Find nearest 0-based interior grid indices for x_A = Lx/3 and x_B = 2*Lx/3\n    idx_A = int(np.round((N + 1) / 3.0)) - 1\n    idx_B = int(np.round(2.0 * (N + 1) / 3.0)) - 1\n    \n    G_AB = Gh[idx_A, idx_B]\n    G_BA = Gh[idx_B, idx_A]\n    \n    max_abs_G = max(abs(G_AB), abs(G_BA))\n    \n    if max_abs_G == 0:\n        R = 0.0\n    else:\n        R = abs(G_AB - G_BA) / max_abs_G\n        \n    # 4c. Interferometric retrieval bias B\n    C = Gh @ Gh_T\n    G_sym = (Gh + Gh_T) / 2.0\n    \n    # Optimal scalar gamma_star\n    # The Frobenius inner product <A, B>_F can be computed as np.sum(A * B)\n    fro_inner_prod = np.sum(C * G_sym)\n    norm_C_sq = np.linalg.norm(C, 'fro')**2\n    \n    if norm_C_sq == 0:\n        gamma_star = 0.0\n    else:\n        gamma_star = fro_inner_prod / norm_C_sq\n        \n    # Bias B\n    norm_G_sym = np.linalg.norm(G_sym, 'fro')\n    \n    if norm_G_sym == 0:\n        B = 0.0\n    else:\n        norm_diff_B = np.linalg.norm(gamma_star * C - G_sym, 'fro')\n        B = norm_diff_B / norm_G_sym\n        \n    return [S, B, R]\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (50, 1.0, 0.0, 8.0),   # Test 1: baseline self-adjoint\n        (50, 1.0, 4.0, 8.0),   # Test 2: moderate advection\n        (50, 1.0, 20.0, 8.0),  # Test 3: strong advection\n        (50, 1.0, -8.0, 8.0),  # Test 4: counter-flow\n    ]\n\n    results = []\n    for case in test_cases:\n        N, Lx, beta, k = case\n        result = calculate_metrics(N, Lx, beta, k)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    # The map(str, ...) correctly converts each sublist to its string representation.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "answer": "[[0.0, 0.01772655519307779, 0.0],[0.03859659063259881, 0.0232537549301918, 0.03901966556487858],[0.1878345719875429, 0.10664977239169608, 0.2031751508240502],[0.07684824559190779, 0.04018337774136894, 0.0792510255959074]]", "id": "3602355"}]}