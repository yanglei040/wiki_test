{"hands_on_practices": [{"introduction": "Understanding the origin of seismic wave speeds is fundamental to geophysics. This exercise connects the abstract elastic properties of a medium—described by the Lamé parameters $\\lambda$ and $\\mu$—to the observable speeds of P-waves ($v_p$) and S-waves ($v_s$). By deriving the wave speeds directly from the elastodynamic equations and then computing their values for a given rock type, you will solidify your understanding of how a material's stiffness and density govern seismic propagation [@problem_id:3612495].", "problem": "Consider a crystalline rock idealized as a homogeneous, isotropic, linearly elastic continuum. Let the Cauchy stress tensor be related to the infinitesimal strain tensor by Hooke’s law for isotropic materials, and let balance of linear momentum hold in the absence of body forces. You are provided the Lamé parameters $\\lambda$ and $\\mu$, and the mass density $\\rho$ of the rock: $\\lambda = 20$ GPa, $\\mu = 30$ GPa, and $\\rho = 2500$ kg/m$^3$. Starting from the fundamental field equations of elastodynamics and the constitutive law for isotropic elasticity, derive the phase velocities of the dilatational (primary, $P$) and shear (secondary, $S$) wave modes that emerge from the displacement field. Use these results to compute the numerical values of the $P$-wave speed $v_{p}$, the $S$-wave speed $v_{s}$, and their ratio $v_{p}/v_{s}$ for the given parameters. Express $v_{p}$ and $v_{s}$ in meters per second (m/s), express $v_{p}/v_{s}$ as a dimensionless decimal, and round all three quantities to four significant figures. Finally, assess whether the computed values are physically plausible for crystalline rock by discussing stability constraints and typical property ranges.", "solution": "The problem requires the derivation of the phase velocities of dilatational ($P$) and shear ($S$) waves in a homogeneous, isotropic, linearly elastic continuum, followed by a numerical calculation and a plausibility assessment.\n\nThe fundamental field equations governing the dynamics of an elastic medium are the balance of linear momentum and the constitutive relation. In the absence of body forces, the balance of linear momentum (Cauchy's first law of motion) is given by:\n$$ \\nabla \\cdot \\boldsymbol{\\sigma} = \\rho \\frac{\\partial^2 \\mathbf{u}}{\\partial t^2} $$\nIn Cartesian index notation, this is:\n$$ \\frac{\\partial \\sigma_{ij}}{\\partial x_j} = \\rho \\frac{\\partial^2 u_i}{\\partial t^2} $$\nwhere $\\boldsymbol{\\sigma}$ is the Cauchy stress tensor, $\\mathbf{u}$ is the displacement vector, $\\rho$ is the mass density, and $t$ is time.\n\nThe constitutive relation for a homogeneous, isotropic, linearly elastic material is Hooke's law, which relates the stress tensor $\\sigma_{ij}$ to the infinitesimal strain tensor $\\epsilon_{ij}$:\n$$ \\sigma_{ij} = \\lambda \\epsilon_{kk} \\delta_{ij} + 2\\mu \\epsilon_{ij} $$\nHere, $\\lambda$ and $\\mu$ are the Lamé parameters, and $\\delta_{ij}$ is the Kronecker delta. The strain tensor is related to the displacement field by:\n$$ \\epsilon_{ij} = \\frac{1}{2} \\left( \\frac{\\partial u_i}{\\partial x_j} + \\frac{\\partial u_j}{\\partial x_i} \\right) $$\nThe trace of the strain tensor, $\\epsilon_{kk}$, represents the volumetric strain (dilatation), and is given by $\\epsilon_{kk} = \\nabla \\cdot \\mathbf{u}$.\n\nTo derive the wave equation, we first express stress in terms of displacement by substituting the strain-displacement relation into Hooke's law:\n$$ \\sigma_{ij} = \\lambda (\\nabla \\cdot \\mathbf{u}) \\delta_{ij} + \\mu \\left( \\frac{\\partial u_i}{\\partial x_j} + \\frac{\\partial u_j}{\\partial x_i} \\right) $$\nNext, we substitute this expression for stress into the equation of motion:\n$$ \\rho \\frac{\\partial^2 u_i}{\\partial t^2} = \\frac{\\partial}{\\partial x_j} \\left[ \\lambda (\\nabla \\cdot \\mathbf{u}) \\delta_{ij} + \\mu \\left( \\frac{\\partial u_i}{\\partial x_j} + \\frac{\\partial u_j}{\\partial x_i} \\right) \\right] $$\n$$ \\rho \\frac{\\partial^2 u_i}{\\partial t^2} = \\lambda \\frac{\\partial}{\\partial x_i} (\\nabla \\cdot \\mathbf{u}) + \\mu \\frac{\\partial^2 u_i}{\\partial x_j \\partial x_j} + \\mu \\frac{\\partial}{\\partial x_j} \\left( \\frac{\\partial u_j}{\\partial x_i} \\right) $$\nRearranging the order of differentiation in the last term, we get:\n$$ \\rho \\frac{\\partial^2 u_i}{\\partial t^2} = \\lambda \\frac{\\partial}{\\partial x_i} (\\nabla \\cdot \\mathbf{u}) + \\mu \\nabla^2 u_i + \\mu \\frac{\\partial}{\\partial x_i} \\left( \\frac{\\partial u_j}{\\partial x_j} \\right) $$\n$$ \\rho \\frac{\\partial^2 u_i}{\\partial t^2} = (\\lambda + \\mu) \\frac{\\partial}{\\partial x_i} (\\nabla \\cdot \\mathbf{u}) + \\mu \\nabla^2 u_i $$\nThis is the Navier-Cauchy equation for elastodynamics. In vector form:\n$$ \\rho \\frac{\\partial^2 \\mathbf{u}}{\\partial t^2} = (\\lambda + \\mu) \\nabla(\\nabla \\cdot \\mathbf{u}) + \\mu \\nabla^2 \\mathbf{u} $$\nTo separate this into P- and S-wave equations, we use the Helmholtz decomposition, which resolves the displacement vector field $\\mathbf{u}$ into the sum of a curl-free (irrotational) component and a divergence-free (solenoidal) component:\n$$ \\mathbf{u} = \\nabla \\phi + \\nabla \\times \\boldsymbol{\\psi} $$\nwhere $\\phi$ is a scalar potential and $\\boldsymbol{\\psi}$ is a vector potential. Taking the divergence and curl of $\\mathbf{u}$:\n$$ \\nabla \\cdot \\mathbf{u} = \\nabla \\cdot (\\nabla \\phi) + \\nabla \\cdot (\\nabla \\times \\boldsymbol{\\psi}) = \\nabla^2 \\phi $$\n$$ \\nabla \\times \\mathbf{u} = \\nabla \\times (\\nabla \\phi) + \\nabla \\times (\\nabla \\times \\boldsymbol{\\psi}) = \\nabla(\\nabla \\cdot \\boldsymbol{\\psi}) - \\nabla^2 \\boldsymbol{\\psi} $$\nBy substituting the decomposition into the Navier-Cauchy equation and using the vector identity $\\nabla^2 \\mathbf{u} = \\nabla(\\nabla \\cdot \\mathbf{u}) - \\nabla \\times (\\nabla \\times \\mathbf{u})$, we obtain:\n$$ \\rho \\frac{\\partial^2}{\\partial t^2}(\\nabla \\phi + \\nabla \\times \\boldsymbol{\\psi}) = (\\lambda + 2\\mu) \\nabla(\\nabla^2 \\phi) - \\mu \\nabla \\times (\\nabla \\times (\\nabla \\times \\boldsymbol{\\psi})) $$\nWe can set the gauge for $\\boldsymbol{\\psi}$ such that $\\nabla \\cdot \\boldsymbol{\\psi} = 0$. The equation becomes:\n$$ \\rho \\nabla \\left( \\frac{\\partial^2 \\phi}{\\partial t^2} \\right) + \\rho \\nabla \\times \\left( \\frac{\\partial^2 \\boldsymbol{\\psi}}{\\partial t^2} \\right) = (\\lambda + 2\\mu) \\nabla (\\nabla^2 \\phi) + \\mu \\nabla \\times (\\nabla^2 \\boldsymbol{\\psi}) $$\nThis equation can be separated into two independent equations by grouping the gradient and curl terms:\n$$ \\nabla \\left[ (\\lambda + 2\\mu) \\nabla^2 \\phi - \\rho \\frac{\\partial^2 \\phi}{\\partial t^2} \\right] - \\nabla \\times \\left[ \\mu \\nabla^2 \\boldsymbol{\\psi} - \\rho \\frac{\\partial^2 \\boldsymbol{\\psi}}{\\partial t^2} \\right] = \\mathbf{0} $$\nFor this to hold, both bracketed terms must independently be zero (up to a function of time for the scalar potential, which can be absorbed into its definition).\n\nThe first equation, governing the scalar potential $\\phi$, is:\n$$ \\frac{\\partial^2 \\phi}{\\partial t^2} = \\frac{\\lambda + 2\\mu}{\\rho} \\nabla^2 \\phi $$\nThis is a standard wave equation describing a wave that propagates with phase velocity $v_p$. This wave corresponds to the dilatational, or P-wave (Primary wave), and its speed is:\n$$ v_p = \\sqrt{\\frac{\\lambda + 2\\mu}{\\rho}} $$\nThe second equation, governing the vector potential $\\boldsymbol{\\psi}$, is:\n$$ \\frac{\\partial^2 \\boldsymbol{\\psi}}{\\partial t^2} = \\frac{\\mu}{\\rho} \\nabla^2 \\boldsymbol{\\psi} $$\nThis is a vector wave equation describing a wave that propagates with phase velocity $v_s$. This wave corresponds to the shear, or S-wave (Secondary wave), and its speed is:\n$$ v_s = \\sqrt{\\frac{\\mu}{\\rho}} $$\nNow, we compute the numerical values using the given parameters: $\\lambda = 20$ GPa, $\\mu = 30$ GPa, and $\\rho = 2500$ kg/m$^3$. We must use SI units, so $1 \\text{ GPa} = 10^9 \\text{ N/m}^2 = 10^9 \\text{ kg} \\cdot \\text{m}^{-1} \\cdot \\text{s}^{-2}$.\n\nThe P-wave speed is:\n$$ v_p = \\sqrt{\\frac{20 \\times 10^9 \\text{ Pa} + 2 \\times (30 \\times 10^9 \\text{ Pa})}{2500 \\text{ kg/m}^3}} = \\sqrt{\\frac{80 \\times 10^9}{2500}} \\text{ m/s} = \\sqrt{32 \\times 10^6} \\text{ m/s} $$\n$$ v_p = 5656.85... \\text{ m/s} $$\nRounding to four significant figures, $v_p = 5657$ m/s.\n\nThe S-wave speed is:\n$$ v_s = \\sqrt{\\frac{30 \\times 10^9 \\text{ Pa}}{2500 \\text{ kg/m}^3}} = \\sqrt{\\frac{300 \\times 10^8}{2500}} \\text{ m/s} = \\sqrt{12 \\times 10^6} \\text{ m/s} $$\n$$ v_s = 3464.10... \\text{ m/s} $$\nRounding to four significant figures, $v_s = 3464$ m/s.\n\nThe ratio of the P-wave speed to the S-wave speed is:\n$$ \\frac{v_p}{v_s} = \\frac{\\sqrt{(\\lambda + 2\\mu)/\\rho}}{\\sqrt{\\mu/\\rho}} = \\sqrt{\\frac{\\lambda + 2\\mu}{\\mu}} = \\sqrt{\\frac{\\lambda}{\\mu} + 2} $$\n$$ \\frac{v_p}{v_s} = \\sqrt{\\frac{20 \\text{ GPa}}{30 \\text{ GPa}} + 2} = \\sqrt{\\frac{2}{3} + 2} = \\sqrt{\\frac{8}{3}} $$\n$$ \\frac{v_p}{v_s} = 1.63299... $$\nRounding to four significant figures, $v_p/v_s = 1.633$.\n\nFinally, we assess the physical plausibility of these results.\nFor an elastic material to be stable, the strain energy density must be positive definite. For an isotropic material, this imposes constraints on the Lamé parameters, namely $\\mu > 0$ and the bulk modulus $K = \\lambda + \\frac{2}{3}\\mu > 0$. The given parameters are $\\mu = 30 \\text{ GPa} > 0$ and $K = 20 + \\frac{2}{3}(30) = 40 \\text{ GPa} > 0$. The stability conditions are met. These conditions ensure that the wave speeds $v_p$ and $v_s$ are real and positive.\nThe calculated P-wave speed of $5657$ m/s and S-wave speed of $3464$ m/s are within the typical range for crystalline rocks such as granite (where $v_p \\approx 5.5-6.5$ km/s and $v_s \\approx 3.0-3.8$ km/s).\nThe ratio $v_p/v_s \\approx 1.633$ is also physically plausible. This ratio depends on Poisson's ratio $\\nu = \\frac{\\lambda}{2(\\lambda+\\mu)}$. For the given values, $\\nu = \\frac{20}{2(20+30)} = 0.2$. Common rocks have Poisson's ratios between $0.1$ and $0.4$. A value of $0.2$ is very typical. For comparison, a Poisson's ratio of $\\nu=0.25$ yields a common benchmark ratio of $v_p/v_s = \\sqrt{3} \\approx 1.732$. Our calculated ratio of $1.633$ is consistent with a material having a Poisson's ratio slightly less than $0.25$. Therefore, the computed values are physically plausible for the specified material.", "answer": "$$ \\boxed{ \\begin{pmatrix} 5657 & 3464 & 1.633 \\end{pmatrix} } $$", "id": "3612495"}, {"introduction": "In practice, geophysicists often work in the opposite direction: using measured wave speeds to infer subsurface properties. This exercise [@problem_id:3612504] challenges you to derive an expression for Poisson's ratio, a critical indicator of rock properties, using only $v_p$ and $v_s$. More importantly, you will use error propagation to quantify how uncertainties in field measurements affect the reliability of your derived parameters, a crucial skill in any quantitative science.", "problem": "A homogeneous, isotropic, linear elastic solid is characterized by its Primary (P) wave speed $v_p$, Secondary (S) wave speed $v_s$, Lamé parameters $\\lambda$ and $\\mu$, density $\\rho$, and Poisson’s ratio $\\nu$. You are given measurements $v_p = 6.20$ km/s and $v_s = 3.58$ km/s from a refraction survey in crystalline basement. The reported one-standard-deviation uncertainties are $\\sigma_{v_p} = 0.03$ km/s and $\\sigma_{v_s} = 0.02$ km/s, and the measurement errors in $v_p$ and $v_s$ can be treated as independent. Assume any uncertainty in $\\rho$ is negligible.\n\nStarting from the fundamental relations of isotropic linear elasticity connecting $v_p$, $v_s$, $\\lambda$, $\\mu$, $\\rho$, and $\\nu$, do the following:\n\n1) Derive an explicit analytic expression for $\\nu$ in terms of only $v_p$ and $v_s$ by eliminating $\\lambda$, $\\mu$, and $\\rho$.\n\n2) Using first-order (linear) error propagation under the assumption of independent errors in $v_p$ and $v_s$, derive the expression for the variance of $\\nu$ in terms of the partial derivatives of $\\nu$ with respect to $v_p$ and $v_s$, and the given $\\sigma_{v_p}$ and $\\sigma_{v_s}$.\n\n3) Evaluate the propagated one-standard-deviation uncertainty in $\\nu$ numerically using the provided measurements. Round your final numerical answer to three significant figures. Express the final uncertainty as a unitless value.\n\nYour final answer must be a single real number (the propagated one-standard-deviation uncertainty in $\\nu$).", "solution": "The problem statement is critically validated before proceeding to a solution.\n\n### Step 1: Extract Givens\nThe verbatim givens extracted from the problem statement are:\n- Primary (P) wave speed: $v_p = 6.20$ km/s\n- Secondary (S) wave speed: $v_s = 3.58$ km/s\n- Standard deviation of P-wave speed: $\\sigma_{v_p} = 0.03$ km/s\n- Standard deviation of S-wave speed: $\\sigma_{v_s} = 0.02$ km/s\n- The solid is a homogeneous, isotropic, linear elastic medium.\n- The parameters are $v_p$, $v_s$, Lamé parameters $\\lambda$ and $\\mu$, density $\\rho$, and Poisson’s ratio $\\nu$.\n- The measurement errors in $v_p$ and $v_s$ are to be treated as independent.\n- The uncertainty in density $\\rho$ is assumed to be negligible.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded:** The problem is based on the fundamental principles of isotropic linear elasticity and seismology, which are well-established fields of physics and geophysics. The given wave speeds are realistic for crystalline basement rock.\n- **Well-Posed:** The problem provides sufficient information and a clear objective for each of its three parts. The derivation of $\\nu$ from $v_p$ and $v_s$ is a standard procedure, and the method of linear error propagation is well-defined. A unique, stable, and meaningful solution exists.\n- **Objective:** The problem is stated in precise, quantitative, and unbiased language. It does not contain subjective or opinion-based claims.\n- **No other flaws are detected.** The problem is not scientifically unsound, incomplete, contradictory, unrealistic, ill-posed, or trivial. It is a standard, formalizable problem in applied geophysics.\n\n### Step 3: Verdict and Action\nThe problem is deemed **valid**. A complete, reasoned solution will be provided.\n\n***\n\n### Solution\nThe solution is presented in three parts as requested by the problem statement.\n\n#### 1) Derivation of an expression for $\\nu$ in terms of $v_p$ and $v_s$\nIn a homogeneous, isotropic, linear elastic solid, the P-wave speed $v_p$ and S-wave speed $v_s$ are defined in terms of the Lamé parameters $\\lambda$ and $\\mu$ and the density $\\rho$ as:\n$$v_p = \\sqrt{\\frac{\\lambda + 2\\mu}{\\rho}}$$\n$$v_s = \\sqrt{\\frac{\\mu}{\\rho}}$$\nSquaring these equations gives:\n$$v_p^2 = \\frac{\\lambda + 2\\mu}{\\rho} \\implies \\rho v_p^2 = \\lambda + 2\\mu$$\n$$v_s^2 = \\frac{\\mu}{\\rho} \\implies \\rho v_s^2 = \\mu$$\nWe can express $\\lambda$ in terms of $\\mu$ and the wave speeds:\n$$\\lambda = \\rho v_p^2 - 2\\mu$$\nSubstituting the expression for $\\mu$ from the S-wave speed equation into the equation for $\\lambda$:\n$$\\lambda = \\rho v_p^2 - 2(\\rho v_s^2) = \\rho(v_p^2 - 2v_s^2)$$\nPoisson’s ratio, $\\nu$, is defined in terms of the Lamé parameters as:\n$$\\nu = \\frac{\\lambda}{2(\\lambda + \\mu)}$$\nNow, substitute the expressions for $\\lambda$ and $\\mu$ in terms of wave speeds and density into the definition of $\\nu$:\n$$\\nu = \\frac{\\rho(v_p^2 - 2v_s^2)}{2[\\rho(v_p^2 - 2v_s^2) + \\rho v_s^2]}$$\nThe density $\\rho$ is a common factor in the numerator and denominator and thus cancels out:\n$$\\nu = \\frac{v_p^2 - 2v_s^2}{2(v_p^2 - 2v_s^2 + v_s^2)}$$\nSimplifying the denominator gives the final expression for $\\nu$ solely in terms of $v_p$ and $v_s$:\n$$\\nu(v_p, v_s) = \\frac{v_p^2 - 2v_s^2}{2(v_p^2 - v_s^2)}$$\n\n#### 2) Derivation of the variance of $\\nu$\nThe problem states to use first-order (linear) error propagation, assuming independent errors in $v_p$ and $v_s$. For a function $\\nu(v_p, v_s)$, the variance $\\sigma_\\nu^2$ is given by:\n$$\\sigma_\\nu^2 = \\left(\\frac{\\partial \\nu}{\\partial v_p}\\right)^2 \\sigma_{v_p}^2 + \\left(\\frac{\\partial \\nu}{\\partial v_s}\\right)^2 \\sigma_{v_s}^2$$\nWe must compute the partial derivatives of $\\nu$ with respect to $v_p$ and $v_s$.\n\nFirst, the partial derivative with respect to $v_p$:\n$$\\frac{\\partial \\nu}{\\partial v_p} = \\frac{\\partial}{\\partial v_p}\\left[\\frac{v_p^2 - 2v_s^2}{2(v_p^2 - v_s^2)}\\right]$$\nUsing the quotient rule, $\\frac{d}{dx}\\left(\\frac{f}{g}\\right) = \\frac{f'g - fg'}{g^2}$, with $f(v_p) = v_p^2 - 2v_s^2$ and $g(v_p) = 2(v_p^2 - v_s^2)$:\n$$\\frac{\\partial \\nu}{\\partial v_p} = \\frac{(2v_p)[2(v_p^2 - v_s^2)] - (v_p^2 - 2v_s^2)[2(2v_p)]}{[2(v_p^2 - v_s^2)]^2}$$\n$$\\frac{\\partial \\nu}{\\partial v_p} = \\frac{4v_p(v_p^2 - v_s^2) - 4v_p(v_p^2 - 2v_s^2)}{4(v_p^2 - v_s^2)^2}$$\n$$\\frac{\\partial \\nu}{\\partial v_p} = \\frac{v_p[(v_p^2 - v_s^2) - (v_p^2 - 2v_s^2)]}{(v_p^2 - v_s^2)^2}$$\n$$\\frac{\\partial \\nu}{\\partial v_p} = \\frac{v_p v_s^2}{(v_p^2 - v_s^2)^2}$$\n\nSecond, the partial derivative with respect to $v_s$:\n$$\\frac{\\partial \\nu}{\\partial v_s} = \\frac{\\partial}{\\partial v_s}\\left[\\frac{v_p^2 - 2v_s^2}{2(v_p^2 - v_s^2)}\\right]$$\nUsing the quotient rule with $f(v_s) = v_p^2 - 2v_s^2$ and $g(v_s) = 2(v_p^2 - v_s^2)$:\n$$\\frac{\\partial \\nu}{\\partial v_s} = \\frac{(-4v_s)[2(v_p^2 - v_s^2)] - (v_p^2 - 2v_s^2)[2(-2v_s)]}{[2(v_p^2 - v_s^2)]^2}$$\n$$\\frac{\\partial \\nu}{\\partial v_s} = \\frac{-8v_s(v_p^2 - v_s^2) + 4v_s(v_p^2 - 2v_s^2)}{4(v_p^2 - v_s^2)^2}$$\n$$\\frac{\\partial \\nu}{\\partial v_s} = \\frac{-2v_s(v_p^2 - v_s^2) + v_s(v_p^2 - 2v_s^2)}{(v_p^2 - v_s^2)^2}$$\n$$\\frac{\\partial \\nu}{\\partial v_s} = \\frac{-2v_s v_p^2 + 2v_s^3 + v_s v_p^2 - 2v_s^3}{(v_p^2 - v_s^2)^2}$$\n$$\\frac{\\partial \\nu}{\\partial v_s} = \\frac{-v_s v_p^2}{(v_p^2 - v_s^2)^2}$$\n\nSubstituting these partial derivatives into the formula for the variance $\\sigma_\\nu^2$:\n$$\\sigma_\\nu^2 = \\left(\\frac{v_p v_s^2}{(v_p^2 - v_s^2)^2}\\right)^2 \\sigma_{v_p}^2 + \\left(\\frac{-v_s v_p^2}{(v_p^2 - v_s^2)^2}\\right)^2 \\sigma_{v_s}^2$$\nThis can be written more compactly as:\n$$\\sigma_\\nu^2 = \\frac{v_p^2 v_s^2}{(v_p^2 - v_s^2)^4} (v_s^2 \\sigma_{v_p}^2 + v_p^2 \\sigma_{v_s}^2)$$\nThis is the required expression for the variance of $\\nu$.\n\n#### 3) Numerical evaluation of the uncertainty in $\\nu$\nThe one-standard-deviation uncertainty in $\\nu$ is $\\sigma_\\nu = \\sqrt{\\sigma_\\nu^2}$. We use the given values:\n$v_p = 6.20$ km/s, $v_s = 3.58$ km/s, $\\sigma_{v_p} = 0.03$ km/s, and $\\sigma_{v_s} = 0.02$ km/s.\n\nFirst, calculate the squared terms:\n$v_p^2 = (6.20)^2 = 38.44$\n$v_s^2 = (3.58)^2 = 12.8164$\n$\\sigma_{v_p}^2 = (0.03)^2 = 0.0009$\n$\\sigma_{v_s}^2 = (0.02)^2 = 0.0004$\n\nNext, calculate the values of the partial derivatives:\n$$\\frac{\\partial \\nu}{\\partial v_p} = \\frac{v_p v_s^2}{(v_p^2 - v_s^2)^2} = \\frac{(6.20)(12.8164)}{(38.44 - 12.8164)^2} = \\frac{79.46168}{(25.6236)^2} \\approx \\frac{79.46168}{656.568} \\approx 0.121025$$\n$$\\frac{\\partial \\nu}{\\partial v_s} = \\frac{-v_s v_p^2}{(v_p^2 - v_s^2)^2} = \\frac{-(3.58)(38.44)}{(38.44 - 12.8164)^2} = \\frac{-137.6152}{(25.6236)^2} \\approx \\frac{-137.6152}{656.568} \\approx -0.209590$$\n\nNow, calculate the variance $\\sigma_\\nu^2$:\n$$\\sigma_\\nu^2 = \\left(\\frac{\\partial \\nu}{\\partial v_p}\\right)^2 \\sigma_{v_p}^2 + \\left(\\frac{\\partial \\nu}{\\partial v_s}\\right)^2 \\sigma_{v_s}^2$$\n$$\\sigma_\\nu^2 \\approx (0.121025)^2 (0.03)^2 + (-0.209590)^2 (0.02)^2$$\n$$\\sigma_\\nu^2 \\approx (0.014647) (0.0009) + (0.043928) (0.0004)$$\n$$\\sigma_\\nu^2 \\approx 1.31823 \\times 10^{-5} + 1.75712 \\times 10^{-5}$$\n$$\\sigma_\\nu^2 \\approx 3.07535 \\times 10^{-5}$$\n\nThe one-standard-deviation uncertainty is the square root of the variance:\n$$\\sigma_\\nu = \\sqrt{\\sigma_\\nu^2} \\approx \\sqrt{3.07535 \\times 10^{-5}} \\approx 0.00554558$$\nRounding this value to three significant figures gives $0.00555$.\nThe propagated one-standard-deviation uncertainty in $\\nu$ is a unitless value.", "answer": "$$\n\\boxed{0.00555}\n$$", "id": "3612504"}, {"introduction": "Translating the continuous physics of wave propagation to a discrete computer grid is a cornerstone of computational geophysics, but this process can introduce numerical artifacts. This hands-on coding exercise [@problem_id:3612540] explores numerical dispersion, a phenomenon where the simulated wave speed incorrectly depends on its frequency and direction of travel relative to the grid. By analyzing the performance of second-order versus fourth-order finite-difference schemes, you will gain practical insight into the critical trade-offs between computational cost and accuracy in wave simulations.", "problem": "You are tasked with a principle-based numerical dispersion analysis for Primary (P) and Secondary (S) waves in a homogeneous, isotropic elastic medium using Finite Difference (FD) spatial discretizations. Start from the isotropic elastic wave equations and a Helmholtz decomposition that separates P- and S-wave potentials. Treat spatial discretization by central differences of order two and order four, while keeping time continuous (semi-discrete analysis). Derive the discrete spatial Fourier symbols for these FD Laplacians and obtain a semi-discrete dispersion relation $\\omega(\\mathbf{k})$ for a plane wave. Using that relation, compute phase velocity errors at $10$ points per wavelength for selected propagation directions.\n\nFundamental bases to use:\n- Newton’s second law and linear isotropic elasticity leading to Navier’s equations, and the Helmholtz decomposition into P- and S-wave potentials.\n- Plane wave ansatz with wavevector $\\mathbf{k}$ in a homogeneous medium.\n- Central difference stencils of order two and order four for approximating the Laplacian operator $\\nabla^{2}$ on a Cartesian grid with spacing $h$.\n\nSpecifications:\n1. Begin from the isotropic linear elastic equations and use the Helmholtz decomposition to show that the scalar P-wave potential $\\phi$ and the vector S-wave potential $\\boldsymbol{\\psi}$ satisfy scalar wave equations $\\partial^{2}\\phi/\\partial t^{2} = \\alpha^{2}\\nabla^{2}\\phi$ and $\\partial^{2}\\boldsymbol{\\psi}/\\partial t^{2} = \\beta^{2}\\nabla^{2}\\boldsymbol{\\psi}$, where $\\alpha$ and $\\beta$ are the P- and S-wave speeds, respectively.\n2. Discretize space only using central difference approximations of the Laplacian $\\nabla^{2}$:\n   - A second-order accurate stencil.\n   - A fourth-order accurate stencil.\n   Assume a uniform Cartesian grid spacing $h$ in each coordinate direction and periodicity sufficient for a spatial Fourier analysis.\n3. For a plane wave $\\exp\\left(i(\\mathbf{k}\\cdot\\mathbf{x}-\\omega t)\\right)$, derive the semi-discrete dispersion relation $\\omega(\\mathbf{k})$ for each stencil. Express the relation in terms of the discrete Fourier symbol of the FD Laplacian and the wave speed $c$, where $c=\\alpha$ for P waves and $c=\\beta$ for S waves.\n4. Define phase velocity as $c_{\\mathrm{ph}}(\\mathbf{k})=\\omega(\\mathbf{k})/\\lVert\\mathbf{k}\\rVert$. Define the fractional phase velocity error as $\\varepsilon = c_{\\mathrm{ph}}/c - 1$. Report errors as decimal fractions (unitless).\n5. Use the following test suite, each at $10$ points per wavelength (PPW). Let $N=10$ be the PPW and $\\theta = 2\\pi/N$ the non-dimensional wavenumber magnitude times grid spacing. Use $h=1$ without loss of generality. For each case, evaluate for both P and S waves and for both second-order and fourth-order spatial stencils:\n   - Test A (one-dimensional, axis-aligned): spatial dimension $d=1$, direction $\\hat{\\mathbf{d}}=[1]$, so that $\\mathbf{k}=k\\hat{\\mathbf{d}}$ with $\\theta = kh$.\n   - Test B (two-dimensional, axis-aligned): spatial dimension $d=2$, direction $\\hat{\\mathbf{d}}=[1,0]$.\n   - Test C (two-dimensional, diagonal): spatial dimension $d=2$, direction $\\hat{\\mathbf{d}}=\\left[\\frac{1}{\\sqrt{2}},\\frac{1}{\\sqrt{2}}\\right]$.\n   In all cases, use $N=10$ so that $\\theta = 2\\pi/10$ and component-wise non-dimensional wavenumbers are $\\theta_{a} = \\theta \\hat{d}_{a}$ for coordinate index $a$.\n6. Your program should compute, for each test case, the fractional phase velocity error $\\varepsilon$ for:\n   - P wave with second-order stencil.\n   - P wave with fourth-order stencil.\n   - S wave with second-order stencil.\n   - S wave with fourth-order stencil.\n   Collect results in the following single-line output format, a comma-separated list enclosed in square brackets: \n   [$\\varepsilon_{\\mathrm{P},2,\\mathrm{A}}$,$\\varepsilon_{\\mathrm{P},4,\\mathrm{A}}$,$\\varepsilon_{\\mathrm{S},2,\\mathrm{A}}$,$\\varepsilon_{\\mathrm{S},4,\\mathrm{A}}$,$\\varepsilon_{\\mathrm{P},2,\\mathrm{B}}$,$\\varepsilon_{\\mathrm{P},4,\\mathrm{B}}$,$\\varepsilon_{\\mathrm{S},2,\\mathrm{B}}$,$\\varepsilon_{\\mathrm{S},4,\\mathrm{B}}$,$\\varepsilon_{\\mathrm{P},2,\\mathrm{C}}$,$\\varepsilon_{\\mathrm{P},4,\\mathrm{C}}$,$\\varepsilon_{\\mathrm{S},2,\\mathrm{C}}$,$\\varepsilon_{\\mathrm{S},4,\\mathrm{C}}$]\n   where subscript $\\mathrm{P}$ or $\\mathrm{S}$ denotes wave type, $2$ or $4$ denotes stencil order, and $\\mathrm{A},\\mathrm{B},\\mathrm{C}$ denote the test cases above.\n7. Angles are measured in radians. No physical units need to be reported because the requested outputs are unitless fractional errors.\n\nYour final answer must be a complete, runnable program that produces exactly the single line described above, with numerical values for the $12$ entries corresponding to the specified test suite at $10$ points per wavelength.", "solution": "The user has provided a valid problem statement. The task is to perform a numerical dispersion analysis for P and S waves using finite difference methods. We will derive the necessary relations from first principles and then apply them to the specified test cases.\n\n### Part 1: Derivation of P- and S-Wave Equations\n\nThe motion in a homogeneous, isotropic, linear elastic medium is governed by Navier's equation, which combines Newton's second law and the constitutive relations of linear elasticity:\n$$\n\\rho \\frac{\\partial^2 \\mathbf{u}}{\\partial t^2} = (\\lambda + \\mu) \\nabla(\\nabla \\cdot \\mathbf{u}) + \\mu \\nabla^2 \\mathbf{u}\n$$\nwhere $\\mathbf{u}$ is the displacement vector, $\\rho$ is the density, and $\\lambda$ and $\\mu$ are the Lamé parameters.\n\nUsing the Helmholtz decomposition, the displacement vector field $\\mathbf{u}$ can be expressed as the sum of the gradient of a scalar potential $\\phi$ (the P-wave potential) and the curl of a vector potential $\\boldsymbol{\\psi}$ (the S-wave potential):\n$$\n\\mathbf{u} = \\nabla\\phi + \\nabla \\times \\boldsymbol{\\psi}\n$$\nThis decomposition is unique if we enforce the gauge condition that the S-wave potential is divergence-free, i.e., $\\nabla \\cdot \\boldsymbol{\\psi} = 0$.\n\nSubstituting this decomposition into Navier's equation, we first evaluate the divergence and Laplacian of $\\mathbf{u}$:\n$$\n\\nabla \\cdot \\mathbf{u} = \\nabla \\cdot (\\nabla\\phi + \\nabla \\times \\boldsymbol{\\psi}) = \\nabla^2\\phi + \\nabla \\cdot (\\nabla \\times \\boldsymbol{\\psi}) = \\nabla^2\\phi\n$$\nsince the divergence of a curl is always zero.\n$$\n\\nabla^2\\mathbf{u} = \\nabla^2(\\nabla\\phi + \\nabla \\times \\boldsymbol{\\psi}) = \\nabla(\\nabla^2\\phi) + \\nabla \\times (\\nabla^2\\boldsymbol{\\psi})\n$$\nThe left-hand side of Navier's equation becomes:\n$$\n\\rho \\frac{\\partial^2 \\mathbf{u}}{\\partial t^2} = \\rho \\frac{\\partial^2}{\\partial t^2}(\\nabla\\phi + \\nabla \\times \\boldsymbol{\\psi}) = \\rho \\nabla\\left(\\frac{\\partial^2\\phi}{\\partial t^2}\\right) + \\rho \\nabla \\times \\left(\\frac{\\partial^2\\boldsymbol{\\psi}}{\\partial t^2}\\right)\n$$\nSubstituting these expressions back into Navier's equation yields:\n$$\n\\rho \\nabla\\left(\\frac{\\partial^2\\phi}{\\partial t^2}\\right) + \\rho \\nabla \\times \\left(\\frac{\\partial^2\\boldsymbol{\\psi}}{\\partial t^2}\\right) = (\\lambda + \\mu) \\nabla(\\nabla^2\\phi) + \\mu \\left( \\nabla(\\nabla^2\\phi) + \\nabla \\times (\\nabla^2\\boldsymbol{\\psi}) \\right)\n$$\nGrouping terms with gradient and curl operators:\n$$\n\\nabla\\left[\\rho \\frac{\\partial^2\\phi}{\\partial t^2} - (\\lambda + 2\\mu)\\nabla^2\\phi\\right] + \\nabla \\times \\left[\\rho \\frac{\\partial^2\\boldsymbol{\\psi}}{\\partial t^2} - \\mu\\nabla^2\\boldsymbol{\\psi}\\right] = \\mathbf{0}\n$$\nFor this equation to hold for any arbitrary wavefield, the terms in the square brackets must be zero. This separates the equation into two uncoupled wave equations:\n$$\n\\frac{\\partial^2\\phi}{\\partial t^2} = \\frac{\\lambda + 2\\mu}{\\rho} \\nabla^2\\phi \\quad \\text{and} \\quad \\frac{\\partial^2\\boldsymbol{\\psi}}{\\partial t^2} = \\frac{\\mu}{\\rho} \\nabla^2\\boldsymbol{\\psi}\n$$\nDefining the P-wave velocity $\\alpha = \\sqrt{(\\lambda+2\\mu)/\\rho}$ and the S-wave velocity $\\beta = \\sqrt{\\mu/\\rho}$, we obtain the standard scalar and vector wave equations for the potentials:\n$$\n\\frac{\\partial^2\\phi}{\\partial t^2} = \\alpha^2 \\nabla^2\\phi \\quad \\text{(P-wave equation)}\n$$\n$$\n\\frac{\\partial^2\\boldsymbol{\\psi}}{\\partial t^2} = \\beta^2 \\nabla^2\\boldsymbol{\\psi} \\quad \\text{(S-wave equation)}\n$$\nBoth equations are of the form $\\frac{\\partial^2 f}{\\partial t^2} = c^2 \\nabla^2 f$, where $c$ is the wave speed ($\\alpha$ or $\\beta$).\n\n### Part 2: Semi-Discrete Dispersion Analysis\n\nWe analyze the scalar wave equation $\\frac{\\partial^2 u}{\\partial t^2} = c^2 \\nabla^2 u$. We discretize in space but not in time (semi-discretization). On a uniform Cartesian grid with spacing $h$ in all $d$ dimensions, the Laplacian operator $\\nabla^2$ is approximated by a discrete operator $\\nabla_h^2$. The semi-discrete equation is:\n$$\n\\frac{d^2 u_{\\mathbf{j}}}{dt^2} = c^2 \\nabla_h^2 u_{\\mathbf{j}}\n$$\nwhere $\\mathbf{j}$ is a multi-index for the grid points.\n\nWe probe the dispersive properties of this system by substituting a plane wave ansatz, $u(\\mathbf{x}, t) = e^{i(\\mathbf{k} \\cdot \\mathbf{x} - \\omega t)}$, where $\\mathbf{k}$ is the wavevector and $\\omega$ is the angular frequency. At a grid point $\\mathbf{x}_{\\mathbf{j}}$, the plane wave is $u_{\\mathbf{j}}(t) = e^{i(\\mathbf{k} \\cdot \\mathbf{x}_{\\mathbf{j}} - \\omega t)}$.\nApplying the time derivative and the discrete spatial operator:\n$$\n(-i\\omega)^2 e^{i(\\mathbf{k} \\cdot \\mathbf{x}_{\\mathbf{j}} - \\omega t)} = c^2 \\nabla_h^2 e^{i(\\mathbf{k} \\cdot \\mathbf{x}_{\\mathbf{j}} - \\omega t)}\n$$\nThe action of a linear, shift-invariant discrete operator like $\\nabla_h^2$ on a discrete plane wave $e^{i\\mathbf{k} \\cdot \\mathbf{x}_{\\mathbf{j}}}$ is multiplicative. It introduces a factor known as the Fourier symbol of the operator, denoted $\\hat{\\nabla}_h^2(\\mathbf{k})$:\n$$\n\\nabla_h^2 e^{i\\mathbf{k} \\cdot \\mathbf{x}_{\\mathbf{j}}} = \\hat{\\nabla}_h^2(\\mathbf{k}) e^{i\\mathbf{k} \\cdot \\mathbf{x}_{\\mathbf{j}}}\n$$\nThe equation thus becomes an algebraic relation:\n$$\n-\\omega^2 = c^2 \\hat{\\nabla}_h^2(\\mathbf{k})\n$$\nThis gives the semi-discrete dispersion relation:\n$$\n\\omega(\\mathbf{k}) = c \\sqrt{-\\hat{\\nabla}_h^2(\\mathbf{k})}\n$$\nThe numerical phase velocity is $c_{\\mathrm{ph}}(\\mathbf{k}) = \\omega(\\mathbf{k}) / \\|\\mathbf{k}\\|$. In the continuous case, $\\omega = c\\|\\mathbf{k}\\|$, so $c_{\\mathrm{ph}} = c$. The numerical approximation introduces a dependence of $c_{\\mathrm{ph}}$ on $\\mathbf{k}$, an effect known as numerical dispersion.\n\n### Part 3: Fourier Symbols of Finite Difference Laplacians\n\nLet $\\theta_a = k_a h$ be the non-dimensional wavenumber in coordinate direction $a$. The discrete Laplacian is a sum of 1D second-derivative operators, $\\nabla_h^2 = \\sum_{a=1}^d \\delta_{aa,h}^2$.\n\n**Second-Order Stencil:**\nThe 1D second-order central difference operator is $\\delta_{xx,h}^2 u(x) = \\frac{u(x+h) - 2u(x) + u(x-h)}{h^2}$. Its symbol is found by applying it to $e^{ik_x x}$:\n$$\n\\hat{\\delta}_{xx,h}^2(k_x) = \\frac{e^{ik_x h} - 2 + e^{-ik_x h}}{h^2} = \\frac{2\\cos(k_x h) - 2}{h^2} = -\\frac{4}{h^2}\\sin^2\\left(\\frac{k_x h}{2}\\right)\n$$\nFor a $d$-dimensional grid, the symbol of the Laplacian is the sum over dimensions:\n$$\n\\hat{\\nabla}_{h,2}^2(\\mathbf{k}) = \\sum_{a=1}^d \\left( -\\frac{4}{h^2}\\sin^2\\left(\\frac{k_a h}{2}\\right) \\right) = -\\frac{4}{h^2} \\sum_{a=1}^d \\sin^2\\left(\\frac{\\theta_a}{2}\\right)\n$$\n\n**Fourth-Order Stencil:**\nThe 1D fourth-order central difference operator is $\\delta_{xx,h}^2 u(x) = \\frac{-u(x+2h) + 16u(x+h) - 30u(x) + 16u(x-h) - u(x-2h)}{12h^2}$. Its symbol is:\n$$\n\\hat{\\delta}_{xx,h}^2(k_x) = \\frac{-e^{i2k_x h} + 16e^{ik_x h} - 30 + 16e^{-ik_x h} - e^{-i2k_x h}}{12h^2} = \\frac{-2\\cos(2k_x h) + 32\\cos(k_x h) - 30}{12h^2}\n$$\nThe symbol for the $d$-dimensional Laplacian is:\n$$\n\\hat{\\nabla}_{h,4}^2(\\mathbf{k}) = \\sum_{a=1}^d \\frac{-2\\cos(2\\theta_a) + 32\\cos(\\theta_a) - 30}{12h^2}\n$$\n\n### Part 4: Phase Velocity Error Calculation\n\nThe fractional phase velocity error is defined as $\\varepsilon = c_{\\mathrm{ph}}/c - 1$.\n$$\n\\varepsilon = \\frac{\\omega(\\mathbf{k})}{c \\|\\mathbf{k}\\|} - 1 = \\frac{\\sqrt{-\\hat{\\nabla}_h^2(\\mathbf{k})}}{\\|\\mathbf{k}\\|} - 1\n$$\nLet $\\|\\boldsymbol{\\theta}\\| = \\sqrt{\\sum \\theta_a^2} = \\sqrt{\\sum (k_a h)^2} = h\\|\\mathbf{k}\\|$.\n$$\n\\varepsilon = \\frac{h \\sqrt{-\\hat{\\nabla}_h^2(\\boldsymbol{\\theta})}}{\\|\\boldsymbol{\\theta}\\|} - 1\n$$\nThis error is independent of the physical wave speed $c$, thus it is identical for P-waves and S-waves.\n\n**For the second-order stencil:**\n$$\n\\varepsilon_2 = \\frac{h \\sqrt{\\frac{4}{h^2} \\sum_{a=1}^d \\sin^2(\\frac{\\theta_a}{2})}}{\\|\\boldsymbol{\\theta}\\|} - 1 = \\frac{2 \\sqrt{\\sum_{a=1}^d \\sin^2(\\frac{\\theta_a}{2})}}{\\|\\boldsymbol{\\theta}\\|} - 1\n$$\n\n**For the fourth-order stencil:**\n$$\n-\\hat{\\nabla}_{h,4}^2(\\mathbf{k}) = \\frac{1}{12h^2} \\sum_{a=1}^d (30 - 32\\cos(\\theta_a) + 2\\cos(2\\theta_a))\n$$\n$$\n\\varepsilon_4 = \\frac{h \\sqrt{\\frac{1}{12h^2} \\sum_{a=1}^d (30 - 32\\cos(\\theta_a) + 2\\cos(2\\theta_a))}}{\\|\\boldsymbol{\\theta}\\|} - 1 = \\frac{\\sqrt{\\frac{1}{12} \\sum_{a=1}^d (30 - 32\\cos(\\theta_a) + 2\\cos(2\\theta_a))}}{\\|\\boldsymbol{\\theta}\\|} - 1\n$$\n\n### Part 5: Application to Test Cases\n\nThe problem specifies $N=10$ points per wavelength (PPW). The non-dimensional wavenumber magnitude is thus $\\theta = \\|\\boldsymbol{\\theta}\\| = \\|\\mathbf{k}\\|h = \\frac{2\\pi}{\\lambda} h = \\frac{2\\pi}{\\lambda} (\\frac{\\lambda}{N}) = \\frac{2\\pi}{N}$. With $N=10$, we have $\\theta = \\pi/5$. The components are $\\theta_a = \\theta \\hat{d}_a$, where $\\hat{\\mathbf{d}}$ is the propagation direction vector.\n\n**Test A (1D, axis-aligned):** $\\hat{\\mathbf{d}}=[1]$, $d=1$.\n$\\theta_1 = \\pi/5$, $\\|\\boldsymbol{\\theta}\\| = \\pi/5$.\n- $\\varepsilon_{2,A} = \\frac{2 \\sin(\\pi/10)}{\\pi/5} - 1$\n- $\\varepsilon_{4,A} = \\frac{\\sqrt{\\frac{1}{12} (30 - 32\\cos(\\pi/5) + 2\\cos(2\\pi/5))}}{\\pi/5} - 1$\n\n**Test B (2D, axis-aligned):** $\\hat{\\mathbf{d}}=[1, 0]$, $d=2$.\n$\\theta_1 = \\pi/5$, $\\theta_2 = 0$, $\\|\\boldsymbol{\\theta}\\| = \\pi/5$.\n- $\\varepsilon_{2,B} = \\frac{2 \\sqrt{\\sin^2(\\pi/10) + \\sin^2(0)}}{\\pi/5} - 1 = \\varepsilon_{2,A}$\n- For $\\varepsilon_{4,B}$, the summand for $a=2$ ($\\theta_2=0$) is $30 - 32\\cos(0) + 2\\cos(0) = 30-32+2=0$. The sum reduces to the single term for $a=1$, making it identical to the 1D case. Thus, $\\varepsilon_{4,B} = \\varepsilon_{4,A}$.\n\n**Test C (2D, diagonal):** $\\hat{\\mathbf{d}}=[\\frac{1}{\\sqrt{2}}, \\frac{1}{\\sqrt{2}}]$, $d=2$.\n$\\theta_1 = \\theta_2 = \\frac{\\pi}{5\\sqrt{2}}$, $\\|\\boldsymbol{\\theta}\\| = \\pi/5$.\n- $\\varepsilon_{2,C} = \\frac{2 \\sqrt{2\\sin^2(\\frac{\\pi}{10\\sqrt{2}})}}{\\pi/5} - 1 = \\frac{2\\sqrt{2}\\sin(\\frac{\\pi}{10\\sqrt{2}})}{\\pi/5} - 1$\n- $\\varepsilon_{4,C} = \\frac{\\sqrt{\\frac{1}{12} \\cdot 2 \\cdot (30 - 32\\cos(\\frac{\\pi}{5\\sqrt{2}}) + 2\\cos(\\frac{2\\pi}{5\\sqrt{2}}))}}{\\pi/5} - 1$\n\nThese formulas will be implemented to compute the required numerical values.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the fractional phase velocity error for P and S waves\n    using 2nd- and 4th-order finite difference stencils for three test cases.\n    \"\"\"\n\n    def calculate_error(stencil_order, theta_vec, theta_norm):\n        \"\"\"\n        Calculates the fractional phase velocity error for a given stencil order and wavevector.\n\n        Args:\n            stencil_order (int): The order of the spatial stencil (2 or 4).\n            theta_vec (np.ndarray): The vector of non-dimensional wavenumbers (k_i * h).\n            theta_norm (float): The norm of the non-dimensional wavevector (||k|| * h).\n\n        Returns:\n            float: The fractional phase velocity error (c_ph/c - 1).\n        \"\"\"\n        if stencil_order == 2:\n            # Formula for the 2nd-order accurate stencil\n            sum_sin_sq = np.sum(np.sin(theta_vec / 2.0)**2)\n            # The numerator is the norm of the numerical wavevector\n            k_num_norm = 2.0 * np.sqrt(sum_sin_sq)\n            error = (k_num_norm / theta_norm) - 1.0\n        elif stencil_order == 4:\n            # Formula for the 4th-order accurate stencil\n            sum_cos_terms = np.sum(30.0 - 32.0 * np.cos(theta_vec) + 2.0 * np.cos(2.0 * theta_vec))\n            # The numerator is the norm of the numerical wavevector\n            k_num_norm = np.sqrt(sum_cos_terms / 12.0)\n            error = (k_num_norm / theta_norm) - 1.0\n        else:\n            raise ValueError(\"Stencil order must be 2 or 4.\")\n        \n        return error\n\n    # Common problem parameters\n    N = 10.0  # Points per wavelength\n    theta_norm = 2.0 * np.pi / N  # Non-dimensional wavenumber magnitude\n\n    # --- Test Case A: 1D, axis-aligned ---\n    dir_A = np.array([1.0])\n    theta_vec_A = theta_norm * dir_A\n    err_2_A = calculate_error(2, theta_vec_A, theta_norm)\n    err_4_A = calculate_error(4, theta_vec_A, theta_norm)\n\n    # --- Test Case B: 2D, axis-aligned ---\n    # Propagation along a grid axis in 2D is numerically identical to the 1D case.\n    dir_B = np.array([1.0, 0.0])\n    theta_vec_B = theta_norm * dir_B\n    err_2_B = calculate_error(2, theta_vec_B, theta_norm)\n    err_4_B = calculate_error(4, theta_vec_B, theta_norm)\n    \n    # --- Test Case C: 2D, diagonal ---\n    dir_C = np.array([1.0/np.sqrt(2), 1.0/np.sqrt(2)])\n    theta_vec_C = theta_norm * dir_C\n    err_2_C = calculate_error(2, theta_vec_C, theta_norm)\n    err_4_C = calculate_error(4, theta_vec_C, theta_norm)\n\n    # The fractional error is independent of wave type (P or S).\n    # Assemble the results in the specified single-line output format:\n    # [eps_P,2,A, eps_P,4,A, eps_S,2,A, eps_S,4,A,\n    #  eps_P,2,B, eps_P,4,B, eps_S,2,B, eps_S,4,B,\n    #  eps_P,2,C, eps_P,4,C, eps_S,2,C, eps_S,4,C]\n    results = [\n        err_2_A, err_4_A, err_2_A, err_4_A,\n        err_2_B, err_4_B, err_2_B, err_4_B,\n        err_2_C, err_4_C, err_2_C, err_4_C\n    ]\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3612540"}]}