{"hands_on_practices": [{"introduction": "Understanding the flow of energy is fundamental to analyzing any physical system. In fluid dynamics, this involves tracking how kinetic energy is generated, transported, and ultimately dissipated. This exercise guides you through a foundational derivation, starting from the Cauchy momentum equation, to isolate the term responsible for viscous dissipation—the irreversible conversion of mechanical energy into heat due to fluid friction. Mastering this derivation [@problem_id:3597106] provides a deep understanding of the relationship between stress, strain rate, and energy loss, a critical concept for modeling everything from turbulent mixing in the ocean to heat generation in glacial ice.", "problem": "Consider an incompressible Newtonian fluid of constant dynamic viscosity $\\mu$ and mass density $\\rho$ in three spatial dimensions. The velocity field is a steady, spatially uniform simple shear,\n$$\n\\boldsymbol{u}(x,y,z) = \\left(S\\,y,\\,0,\\,0\\right),\n$$\nwhere $S$ is a constant shear rate. Starting from the Cauchy momentum equation in index form,\n$$\n\\rho\\,\\frac{D u_{i}}{D t} = \\partial_{j}\\,\\sigma_{ij} + \\rho\\,b_{i},\n$$\nwith the Newtonian stress $\\sigma_{ij} = -p\\,\\delta_{ij} + 2\\,\\mu\\,S_{ij}$, the rate-of-strain tensor $S_{ij} = \\frac{1}{2}\\left(\\partial_{i}u_{j} + \\partial_{j}u_{i}\\right)$, and incompressibility $\\partial_{i}u_{i} = 0$, derive the kinetic energy budget and identify the volumetric viscous sink term (the viscous dissipation rate per unit volume) in terms of $S_{ij}$ and $\\mu$. Then, for the given shear flow, compute this viscous dissipation rate explicitly in closed form as a function of $S$ and $\\mu$. Briefly interpret its role in the mechanical energy budget for this flow. Provide your final result for the viscous dissipation rate as a single symbolic expression in terms of $S$ and $\\mu$ only; do not include units.", "solution": "We begin with the Cauchy momentum equation for an incompressible Newtonian fluid,\n$$\n\\rho\\,\\frac{D u_{i}}{D t} = \\partial_{j}\\,\\sigma_{ij} + \\rho\\,b_{i},\n$$\nwhere the stress is $\\sigma_{ij} = -p\\,\\delta_{ij} + 2\\,\\mu\\,S_{ij}$ and $S_{ij} = \\frac{1}{2}\\left(\\partial_{i}u_{j} + \\partial_{j}u_{i}\\right)$. The goal is to obtain the kinetic energy budget and identify the viscous dissipation rate per unit volume.\n\nDotting the momentum equation with $u_{i}$ and using the product rule yields\n$$\n\\rho\\,u_{i}\\,\\frac{D u_{i}}{D t} = u_{i}\\,\\partial_{j}\\,\\sigma_{ij} + \\rho\\,u_{i}\\,b_{i}.\n$$\nWe use the identity $u_{i}\\,\\frac{D u_{i}}{D t} = \\frac{D}{D t}\\left(\\frac{1}{2}u_{i}u_{i}\\right)$ and rewrite the stress divergence term as\n$$\nu_{i}\\,\\partial_{j}\\,\\sigma_{ij} = \\partial_{j}\\left(u_{i}\\,\\sigma_{ij}\\right) - \\sigma_{ij}\\,\\partial_{j}u_{i}.\n$$\nTherefore,\n$$\n\\rho\\,\\frac{D}{D t}\\left(\\frac{1}{2}u_{i}u_{i}\\right) = \\partial_{j}\\left(u_{i}\\,\\sigma_{ij}\\right) - \\sigma_{ij}\\,\\partial_{j}u_{i} + \\rho\\,u_{i}\\,b_{i}.\n$$\nSubstituting $\\sigma_{ij} = -p\\,\\delta_{ij} + 2\\,\\mu\\,S_{ij}$ into $\\sigma_{ij}\\,\\partial_{j}u_{i}$ gives\n$$\n\\sigma_{ij}\\,\\partial_{j}u_{i} = \\left(-p\\,\\delta_{ij} + 2\\,\\mu\\,S_{ij}\\right)\\partial_{j}u_{i} = -p\\,\\partial_{i}u_{i} + 2\\,\\mu\\,S_{ij}\\,\\partial_{j}u_{i}.\n$$\nUnder incompressibility, $\\partial_{i}u_{i} = 0$, so the pressure work term vanishes locally in the kinetic energy equation. Next, decompose the velocity gradient into its symmetric and antisymmetric parts:\n$$\n\\partial_{j}u_{i} = S_{ij} + \\Omega_{ij}, \\quad \\text{where} \\quad \\Omega_{ij} = \\frac{1}{2}\\left(\\partial_{j}u_{i} - \\partial_{i}u_{j}\\right),\n$$\nand note that $S_{ij}\\,\\Omega_{ij} = 0$ because $S_{ij}$ is symmetric and $\\Omega_{ij}$ is antisymmetric. Thus,\n$$\n2\\,\\mu\\,S_{ij}\\,\\partial_{j}u_{i} = 2\\,\\mu\\,S_{ij}\\,(S_{ij} + \\Omega_{ij}) = 2\\,\\mu\\,S_{ij}\\,S_{ij}.\n$$\nThe local kinetic energy budget then becomes\n$$\n\\rho\\,\\frac{D}{D t}\\left(\\frac{1}{2}u_{i}u_{i}\\right) = \\partial_{j}\\left(u_{i}\\,\\sigma_{ij}\\right) - 2\\,\\mu\\,S_{ij}\\,S_{ij} + \\rho\\,u_{i}\\,b_{i}.\n$$\nTherefore, the viscous dissipation rate per unit volume, denoted $\\varepsilon$, is identified as\n$$\n\\varepsilon = 2\\,\\mu\\,S_{ij}\\,S_{ij},\n$$\nwhich is manifestly nonnegative because $S_{ij}\\,S_{ij} \\ge 0$.\n\nWe now evaluate $\\varepsilon$ for the given simple shear flow $\\boldsymbol{u} = \\left(S\\,y,\\,0,\\,0\\right)$. The nonzero components of the velocity gradient are\n$$\n\\partial_{y}u_{x} = S,\n$$\nwith all other $\\partial_{j}u_{i}$ equal to zero. Compute the rate-of-strain tensor components:\n$$\nS_{xy} = S_{yx} = \\frac{1}{2}\\left(\\partial_{x}u_{y} + \\partial_{y}u_{x}\\right) = \\frac{1}{2}\\left(0 + S\\right) = \\frac{S}{2},\n$$\nand all diagonal components $S_{xx}, S_{yy}, S_{zz}$ vanish because there are no normal strains in this flow, while all other off-diagonal components are zero. The contraction $S_{ij}\\,S_{ij}$ is the sum of the squares of all components:\n$$\nS_{ij}\\,S_{ij} = S_{xy}^{2} + S_{yx}^{2} = 2\\left(\\frac{S}{2}\\right)^{2} = \\frac{S^{2}}{2}.\n$$\nHence,\n$$\n\\varepsilon = 2\\,\\mu\\,S_{ij}\\,S_{ij} = 2\\,\\mu\\,\\left(\\frac{S^{2}}{2}\\right) = \\mu\\,S^{2}.\n$$\n\nInterpretation in the mechanical energy budget: The term $\\varepsilon = \\mu\\,S^{2}$ is a strictly positive, spatially uniform sink of kinetic energy per unit volume in this flow. In the kinetic energy equation, it appears with a negative sign, reducing the kinetic energy unless balanced by external work or energy input through boundary fluxes or body forces. For a steady, spatially uniform simple shear maintained against viscosity, mechanical work must be supplied (for example, by moving boundaries or an external forcing) at a rate per unit volume equal to $\\mu\\,S^{2}$ to offset viscous dissipation and sustain the shear.", "answer": "$$\\boxed{\\mu\\,S^{2}}$$", "id": "3597106"}, {"introduction": "While differential equations offer a detailed, local view of fluid motion, many geophysical problems require a broader perspective. The integral momentum balance, an application of Newton's second law to a finite region or control volume, is a powerful tool for analyzing bulk flow properties through complex geometries. This practice [@problem_id:3597053] challenges you to apply this principle to a geophysical strait, balancing pressure forces and momentum fluxes to determine the net force the solid earth exerts on the water. This skill is essential for modeling hydraulic controls, understanding form drag in varied bathymetry, and quantifying the large-scale interactions between ocean currents and the seafloor.", "problem": "A short, rectangular geophysical strait of horizontal axis connects two large basins. At a chosen control volume spanning the strait between two vertical cross-sections, the width varies from $B_1$ at the upstream section to $B_2$ at the downstream section, and the still-water depths at those sections are $h_1$ and $h_2$, respectively. Assume an incompressible fluid of density $\\rho$ with a free surface open to a uniform ambient pressure at both sections, hydrostatic vertical pressure distribution at each section, and depth-averaged, laterally uniform streamwise velocities at the two sections. Let the steady volumetric flow rate be $Q0$ from section $1$ to section $2$. To account for nonuniformity of the actual velocity profiles in the cross-sections, include momentum-correction coefficients $\\beta_1$ and $\\beta_2$ at sections $1$ and $2$, respectively.\n\nUsing Newton’s second law for a continuum and the steady integral momentum balance applied to the control volume, derive from first principles an expression for the net streamwise force that the solid boundaries of the strait (bed and sidewalls) exert on the fluid within the control volume, $F_w$, taking positive in the downstream direction. Express your final result entirely in terms of $\\rho$, $g$, $Q$, $B_1$, $B_2$, $h_1$, $h_2$, $\\beta_1$, and $\\beta_2$. Treat pressure as a gauge pressure relative to the common ambient reference.\n\nAs part of your derivation, clearly state the physical conditions, expressed in terms of appropriate nondimensional parameters and scale analysis, under which viscous contributions to the momentum balance may be neglected for such a control volume in a geophysical strait. Your final answer must be a single closed-form analytic expression for $F_w$ as specified above. Do not include units in the final boxed answer.", "solution": "The problem is first validated and found to be a well-posed, scientifically grounded problem in geophysical fluid dynamics. The derivation of the net streamwise force, $F_w$, exerted by the solid boundaries of the strait on the fluid within the control volume will proceed from first principles using the integral form of the steady momentum equation.\n\nThe integral momentum equation for a steady flow in a fixed control volume (CV) is a statement of Newton's second law for a continuum. In the streamwise direction, which we denote as the $x$-direction, the equation is:\n$$ \\sum F_x = \\iint_{CS} (\\rho \\mathbf{v} \\cdot \\mathbf{n}) v_x \\, dA $$\nHere, $\\sum F_x$ represents the sum of all external forces acting on the fluid within the CV in the $x$-direction. The right-hand side represents the net rate of momentum flux out of the CV across the control surface (CS), where $\\rho$ is the fluid density, $\\mathbf{v}$ is the velocity vector, $\\mathbf{n}$ is the outward-pointing unit normal vector to the control surface, and $v_x$ is the $x$-component of the velocity.\n\nThe control volume is defined as the fluid contained between the upstream cross-section $1$ and the downstream cross-section $2$. The control surface consists of the inlet area $A_1$, the outlet area $A_2$, the free surface, and the solid boundaries (bed and sidewalls).\n\nThe external forces acting on the fluid in the CV in the $x$-direction are:\n$1$. The pressure force at the upstream section $1$, $F_{p1}$, acting in the positive $x$-direction.\n$2$. The pressure force at the downstream section $2$, $F_{p2}$, acting in the negative $x$-direction.\n$3$. The net force from the solid boundaries (bed and sidewalls) on the fluid, $F_w$. This is the quantity to be determined, defined as positive in the downstream ($+x$) direction.\n\nWe assume the strait has a horizontal axis, so there is no component of gravitational force in the streamwise direction. We also neglect wind shear on the free surface, as it is stated to be open to a uniform ambient pressure. Thus, the sum of forces is:\n$$ \\sum F_x = F_{p1} - F_{p2} + F_w $$\n\nThe problem states a hydrostatic pressure distribution at sections $1$ and $2$. Working with gauge pressure, the pressure at a depth $z$ below the free surface is $p = \\rho g (h-z)$, where $h$ is the total water depth at that section. The pressure force on a rectangular cross-section of width $B$ and depth $h$ is the integral of this pressure over the area:\n$$ F_p = \\int_A p \\, dA = \\int_0^h (\\rho g (h-z)) B \\, dz = \\rho g B \\left[ hz - \\frac{z^2}{2} \\right]_0^h = \\frac{1}{2} \\rho g B h^2 $$\nApplying this to sections $1$ and $2$:\n$$ F_{p1} = \\frac{1}{2} \\rho g B_1 h_1^2 $$\n$$ F_{p2} = \\frac{1}{2} \\rho g B_2 h_2^2 $$\n\nNext, we evaluate the momentum flux term. The flux occurs only through the inlet and outlet, as there is no flow through the solid boundaries or the free surface.\nThe net rate of momentum flux out of the CV is:\n$$ \\text{Net Momentum Flux} = \\left. \\int_{A_2} \\rho v_2^2 \\, dA \\right|_{\\text{outlet}} - \\left. \\int_{A_1} \\rho v_1^2 \\, dA \\right|_{\\text{inlet}} $$\nwhere $v_1$ and $v_2$ are the local streamwise velocities at sections $1$ and $2$.\nThe problem provides depth-averaged velocities and momentum-correction coefficients $\\beta_1$ and $\\beta_2$. The momentum-correction coefficient $\\beta$ is defined to relate the true momentum flux to the flux calculated using the cross-sectionally averaged velocity, $U$, as:\n$$ \\int_A \\rho v^2 \\, dA = \\rho \\beta U^2 A $$\nThe average velocities $U_1$ and $U_2$ are related to the steady volumetric flow rate $Q$ and the cross-sectional areas $A_1 = B_1 h_1$ and $A_2 = B_2 h_2$ by the continuity equation for incompressible flow:\n$$ U_1 = \\frac{Q}{A_1} = \\frac{Q}{B_1 h_1} $$\n$$ U_2 = \\frac{Q}{A_2} = \\frac{Q}{B_2 h_2} $$\nThe net momentum flux can therefore be expressed as:\n$$ \\text{Net Momentum Flux} = \\rho \\beta_2 U_2^2 A_2 - \\rho \\beta_1 U_1^2 A_1 $$\nSubstituting the expressions for $U_1$ and $U_2$:\n$$ \\text{Net Momentum Flux} = \\rho \\beta_2 \\left(\\frac{Q}{A_2}\\right)^2 A_2 - \\rho \\beta_1 \\left(\\frac{Q}{A_1}\\right)^2 A_1 = \\rho Q^2 \\left(\\frac{\\beta_2}{A_2} - \\frac{\\beta_1}{A_1}\\right) $$\nSubstituting the geometric expressions for the areas:\n$$ \\text{Net Momentum Flux} = \\rho Q^2 \\left(\\frac{\\beta_2}{B_2 h_2} - \\frac{\\beta_1}{B_1 h_1}\\right) $$\n\nNow, we assemble the full momentum balance equation:\n$$ \\sum F_x = \\text{Net Momentum Flux} $$\n$$ F_{p1} - F_{p2} + F_w = \\rho Q^2 \\left(\\frac{\\beta_2}{B_2 h_2} - \\frac{\\beta_1}{B_1 h_1}\\right) $$\nSubstituting the expressions for the pressure forces:\n$$ \\frac{1}{2} \\rho g B_1 h_1^2 - \\frac{1}{2} \\rho g B_2 h_2^2 + F_w = \\rho Q^2 \\left(\\frac{\\beta_2}{B_2 h_2} - \\frac{\\beta_1}{B_1 h_1}\\right) $$\nFinally, we solve for the desired force, $F_w$:\n$$ F_w = \\rho Q^2 \\left(\\frac{\\beta_2}{B_2 h_2} - \\frac{\\beta_1}{B_1 h_1}\\right) - \\frac{1}{2} \\rho g B_1 h_1^2 + \\frac{1}{2} \\rho g B_2 h_2^2 $$\nRearranging the terms for clarity, we get the final expression for the force exerted by the solid boundaries on the fluid:\n$$ F_w = \\frac{1}{2} \\rho g (B_2 h_2^2 - B_1 h_1^2) + \\rho Q^2 \\left( \\frac{\\beta_2}{B_2 h_2} - \\frac{\\beta_1}{B_1 h_1} \\right) $$\n\nThe problem also requires stating the conditions under which viscous contributions to the momentum balance may be neglected. The derived force $F_w$ represents the total integrated force from the solid boundaries, which is a sum of pressure forces on non-parallel boundaries (form drag) and viscous shear forces (skin friction). The question asks when the skin friction component is negligible. This can be assessed through scale analysis.\n\n$1$. **High Reynolds Number**: The primary condition for viscous effects to be unimportant in the bulk flow dynamics (away from boundaries) is that the flow must have a high Reynolds number. For open-channel flow, the relevant Reynolds number is typically based on the hydraulic depth or hydraulic radius. Let $H$ be the characteristic water depth and $U$ be the characteristic velocity. The Reynolds number is $Re_H = \\frac{\\rho U H}{\\mu}$, where $\\mu$ is the dynamic viscosity of the fluid. For $Re_H \\gg 1$, inertial forces dominate over viscous forces in the bulk of the flow. The flow becomes turbulent, and viscous effects are confined to a thin boundary layer near the solid surfaces. Geophysical flows in straits almost always satisfy this condition, with $Re_H$ often being $O(10^6)$ or greater.\n\n$2$. **Short Control Volume with Dominant Form Effects**: While a high Reynolds number confines viscous action to the boundary layer, the integrated effect of boundary shear (skin friction) over the length of the control volume, $L$, may still be significant. The total viscous friction force on the wetted area is $F_{visc} \\approx \\tau_w A_{wetted}$, where $\\tau_w$ is the average wall shear stress and $A_{wetted}$ is the wetted surface area of the boundaries. $\\tau_w$ is often parameterized using a friction factor, $f$, as $\\tau_w \\propto f \\rho U^2$. The friction force is then $F_{visc} \\propto f \\rho U^2 P L$, where $P$ is the wetted perimeter.\n\nFor this viscous force to be negligible, it must be much smaller than the other terms in the momentum balance: the change in momentum flux, $\\Delta(\\rho \\beta U^2 A)$, and the net pressure force, $\\Delta(\\frac{1}{2}\\rho g B h^2)$. The relative importance of friction is often assessed by comparing the friction term to the inertial term:\n$$ \\frac{\\text{Friction Force}}{\\text{Inertial Force}} \\sim \\frac{f \\rho U^2 P L}{\\rho U^2 A} = \\frac{f L}{A/P} = \\frac{f L}{R_h} $$\nwhere $R_h$ is the hydraulic radius. Therefore, the condition to neglect the integrated viscous friction force is $\\frac{fL}{R_h} \\ll 1$. This means the control volume must be \"short\" relative to a characteristic friction length scale, $R_h/f$. In such a short, rapidly varying channel, the momentum change is dominated by acceleration/deceleration due to geometric changes (form drag and inertial effects), and the contribution from skin friction along the short length is minor.\n\nIn summary, viscous contributions can be neglected when the Reynolds number is very large ($Re_H \\gg 1$) and the geometry is such that form effects dominate skin friction, a condition quantified by the strait being short relative to its hydraulic radius ($fL/R_h \\ll 1$).", "answer": "$$\n\\boxed{\\frac{1}{2} \\rho g (B_2 h_2^2 - B_1 h_1^2) + \\rho Q^2 \\left( \\frac{\\beta_2}{B_2 h_2} - \\frac{\\beta_1}{B_1 h_1} \\right)}\n$$", "id": "3597053"}, {"introduction": "The Boussinesq approximation is a cornerstone of geophysical fluid dynamics, simplifying the governing equations for buoyancy-driven flows by assuming density is constant except where it is coupled with gravity. While this approximation is invaluable, a skilled computational scientist must understand its limitations. This problem [@problem_id:3597130] requires you to first analytically derive the error terms associated with the Boussinesq approximation in both the momentum and buoyancy budgets, and then to implement them computationally. This combined analytical and numerical exercise provides quantitative insight into the validity of one of the most common assumptions in ocean and atmospheric modeling, sharpening your ability to critically assess the accuracy of numerical simulations.", "problem": "Consider a single-layer turbidity current of uniform thickness $H$ flowing horizontally into an ambient fluid of reference density $\\rho_0$. The current has uniform velocity $U$ and uniform density $\\rho$, where the density contrast is $\\Delta \\rho = \\rho - \\rho_0$. Assume the flow is incompressible and sufficiently well-mixed that a depth-averaged description is appropriate. Begin from the variable-density incompressible mass and momentum balances,\n$$\\nabla \\cdot \\mathbf{u} = 0,$$\n$$\\frac{\\partial}{\\partial t}(\\rho \\mathbf{u}) + \\nabla \\cdot (\\rho \\mathbf{u}\\mathbf{u}) = -\\nabla p + \\rho \\mathbf{g} + \\nabla \\cdot \\boldsymbol{\\tau},$$\nand the Boussinesq approximation in which $\\rho$ is replaced by $\\rho_0$ everywhere except in the buoyancy term, where the buoyancy is modeled as $b = \\dfrac{g \\Delta \\rho}{\\rho_0}$. The turbidity current is characterized by the Froude number (Fr) based on the Boussinesq reduced gravity, defined by\n$$Fr = \\frac{U}{\\sqrt{g' H}}, \\quad g' = \\frac{g \\Delta \\rho}{\\rho_0}.$$\nIn a control volume description for a uniform layer of thickness $H$ and velocity $U$, define the following depth-integrated flux budgets per unit width:\n- The exact momentum flux $\\mathcal{F}_M^{\\text{exact}} = \\int_0^H \\rho u^2 \\, dz$ and the momentum flux under the Boussinesq approximation $\\mathcal{F}_M^{\\text{B}} = \\int_0^H \\rho_0 u^2 \\, dz$.\n- The exact buoyancy acceleration entering the budget $b^{\\text{exact}} = \\dfrac{g \\Delta \\rho}{\\rho}$ and the Boussinesq buoyancy $b^{\\text{B}} = \\dfrac{g \\Delta \\rho}{\\rho_0}$.\n\nYour task is to derive, from the above fundamental balances, expressions for the following three dimensionless error measures, and then implement them in a program:\n1. The relative error in the momentum budget due to using $\\rho_0$ in the inertia, defined as\n$$\\varepsilon_M = \\frac{\\mathcal{F}_M^{\\text{B}} - \\mathcal{F}_M^{\\text{exact}}}{\\mathcal{F}_M^{\\text{exact}}}.$$\n2. The relative error in the buoyancy budget due to using $\\rho_0$ in the denominator of $b$, defined as\n$$\\varepsilon_B = \\frac{b^{\\text{B}} - b^{\\text{exact}}}{b^{\\text{exact}}}.$$\n3. A dimensionless closure residual that quantifies the mismatch between the inertial-to-buoyancy ratio computed with the exact density and the squared Froude number defined with the Boussinesq reduced gravity, for the same $U$ inferred from $Fr$ and $g'$:\n$$\\mathcal{R} = \\frac{\\rho U^2}{g \\Delta \\rho \\, H} - Fr^2.$$\n\nAll quantities must be expressed in International System of Units (SI): densities in $\\mathrm{kg/m^3}$, gravity $g$ in $\\mathrm{m/s^2}$, layer thickness $H$ in $\\mathrm{m}$, and velocity $U$ in $\\mathrm{m/s}$. The output errors $\\varepsilon_M$, $\\varepsilon_B$, and $\\mathcal{R}$ must be reported as decimal numbers (not percentages).\n\nUse the following constants in your calculations: $\\rho_0 = 1025 \\ \\mathrm{kg/m^3}$, $g = 9.81 \\ \\mathrm{m/s^2}$, and $H = 10 \\ \\mathrm{m}$. You are given a test suite of four cases, each specifying the density contrast ratio $\\Delta \\rho / \\rho$ and the Froude number $Fr$ defined with $g' = \\dfrac{g \\Delta \\rho}{\\rho_0}$:\n- Case $1$: $\\Delta \\rho / \\rho = 0$, $Fr = 0$.\n- Case $2$: $\\Delta \\rho / \\rho = 0.02$, $Fr = 1.0$.\n- Case $3$: $\\Delta \\rho / \\rho = 0.05$, $Fr = 1.5$.\n- Case $4$: $\\Delta \\rho / \\rho = 0.10$, $Fr = 0.8$.\n\nFor each case, treat $\\Delta \\rho / \\rho$ as fundamental; infer $\\rho$ from $\\rho_0$ and $\\Delta \\rho / \\rho$, and then infer $\\Delta \\rho$. Use the given $Fr$ and $g'$ to infer $U$ when needed. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case contributes a sub-list in the order $[\\varepsilon_M,\\varepsilon_B,\\mathcal{R}]$. Express all outputs as decimal numbers rounded to six decimal places. For example, the final output should look like\n$$\\big[\\,[\\varepsilon_M^{(1)},\\varepsilon_B^{(1)},\\mathcal{R}^{(1)}],\\ldots,[\\varepsilon_M^{(4)},\\varepsilon_B^{(4)},\\mathcal{R}^{(4)}]\\,\\big].$$", "solution": "The problem statement has been validated and is deemed scientifically grounded, well-posed, objective, and self-contained. There are no contradictions, ambiguities, or factual errors. The problem is a standard exercise in geophysical fluid dynamics, addressing the quantitative impact of the Boussinesq approximation. We may therefore proceed with the solution.\n\nThe objective is to derive expressions for three dimensionless error metrics ($\\varepsilon_M$, $\\varepsilon_B$, and $\\mathcal{R}$) that quantify discrepancies arising from the Boussinesq approximation in a model of a turbidity current. The derivations will begin from the fundamental definitions provided. Once derived, these expressions will be used to compute the metrics for a given set of test cases.\n\nThe flow is assumed to be a uniform layer of thickness $H$ with constant velocity $U$ and density $\\rho$. The ambient fluid has density $\\rho_0$. All mathematical symbols, variables, and numbers will be rendered in LaTeX as per the formatting requirements.\n\n**1. Derivation of the Momentum Budget Error, $\\varepsilon_M$**\n\nThe relative error in the momentum budget is defined as:\n$$\n\\varepsilon_M = \\frac{\\mathcal{F}_M^{\\text{B}} - \\mathcal{F}_M^{\\text{exact}}}{\\mathcal{F}_M^{\\text{exact}}}\n$$\nThe terms $\\mathcal{F}_M^{\\text{exact}}$ and $\\mathcal{F}_M^{\\text{B}}$ represent the depth-integrated momentum fluxes per unit width. Given the uniform velocity profile $u(z) = U$ and uniform density $\\rho$ within the layer (from $z=0$ to $z=H$), the integrals are evaluated as follows:\n$$\n\\mathcal{F}_M^{\\text{exact}} = \\int_0^H \\rho u^2 \\, dz = \\int_0^H \\rho U^2 \\, dz = \\rho U^2 H\n$$\n$$\n\\mathcal{F}_M^{\\text{B}} = \\int_0^H \\rho_0 u^2 \\, dz = \\int_0^H \\rho_0 U^2 \\, dz = \\rho_0 U^2 H\n$$\nSubstituting these expressions into the definition of $\\varepsilon_M$:\n$$\n\\varepsilon_M = \\frac{\\rho_0 U^2 H - \\rho U^2 H}{\\rho U^2 H}\n$$\nAssuming the current is in motion ($U \\neq 0$), we can cancel the term $U^2 H$:\n$$\n\\varepsilon_M = \\frac{\\rho_0 - \\rho}{\\rho} = -\\frac{\\rho - \\rho_0}{\\rho}\n$$\nUsing the definition of the density contrast, $\\Delta \\rho = \\rho - \\rho_0$, we arrive at the final expression:\n$$\n\\varepsilon_M = -\\frac{\\Delta \\rho}{\\rho}\n$$\nThis expression is independent of velocity $U$ and thus holds even in the limit $U \\to 0$. The error is simply the negative of the specified input ratio $\\Delta \\rho / \\rho$.\n\n**2. Derivation of the Buoyancy Budget Error, $\\varepsilon_B$**\n\nThe relative error in the buoyancy budget is defined as:\n$$\n\\varepsilon_B = \\frac{b^{\\text{B}} - b^{\\text{exact}}}{b^{\\text{exact}}}\n$$\nThe exact and Boussinesq buoyancy accelerations are given as:\n$$\nb^{\\text{exact}} = \\frac{g \\Delta \\rho}{\\rho}\n$$\n$$\nb^{\\text{B}} = \\frac{g \\Delta \\rho}{\\rho_0}\n$$\nSubstituting these into the definition of $\\varepsilon_B$:\n$$\n\\varepsilon_B = \\frac{\\frac{g \\Delta \\rho}{\\rho_0} - \\frac{g \\Delta \\rho}{\\rho}}{\\frac{g \\Delta \\rho}{\\rho}}\n$$\nAssuming a non-zero density contrast ($\\Delta \\rho \\neq 0$), we can cancel the term $g \\Delta \\rho$:\n$$\n\\varepsilon_B = \\frac{\\frac{1}{\\rho_0} - \\frac{1}{\\rho}}{\\frac{1}{\\rho}} = \\left(\\frac{1}{\\rho_0} - \\frac{1}{\\rho}\\right) \\rho = \\frac{\\rho}{\\rho_0} - 1 = \\frac{\\rho - \\rho_0}{\\rho_0}\n$$\nThus, we find:\n$$\n\\varepsilon_B = \\frac{\\Delta \\rho}{\\rho_0}\n$$\nFor computational purposes, it is useful to express $\\varepsilon_B$ in terms of the input ratio $\\Delta \\rho / \\rho$. We start with the identity $\\Delta \\rho / \\rho = 1 - \\rho_0 / \\rho$. Rearranging gives $\\rho_0 / \\rho = 1 - \\Delta \\rho / \\rho$, which implies $\\rho / \\rho_0 = (1 - \\Delta \\rho / \\rho)^{-1}$. Substituting this into our expression for $\\varepsilon_B$:\n$$\n\\varepsilon_B = \\frac{\\rho}{\\rho_0} - 1 = \\frac{1}{1 - \\frac{\\Delta \\rho}{\\rho}} - 1 = \\frac{1 - (1 - \\frac{\\Delta \\rho}{\\rho})}{1 - \\frac{\\Delta \\rho}{\\rho}} = \\frac{\\frac{\\Delta \\rho}{\\rho}}{1 - \\frac{\\Delta \\rho}{\\rho}}\n$$\nThis form is computationally robust, particularly for the case $\\Delta \\rho / \\rho = 0$, where it correctly evaluates to $\\varepsilon_B = 0$.\n\n**3. Derivation of the Closure Residual, $\\mathcal{R}$**\n\nThe dimensionless closure residual is defined as:\n$$\n\\mathcal{R} = \\frac{\\rho U^2}{g \\Delta \\rho \\, H} - Fr^2\n$$\nThe Froude number, $Fr$, is defined using the Boussinesq reduced gravity $g' = g \\Delta \\rho / \\rho_0$:\n$$\nFr = \\frac{U}{\\sqrt{g' H}} \\implies U = Fr \\sqrt{g' H} = Fr \\sqrt{\\frac{g \\Delta \\rho}{\\rho_0} H}\n$$\nSquaring this expression for $U$ gives:\n$$\nU^2 = Fr^2 \\left(\\frac{g \\Delta \\rho}{\\rho_0} H\\right)\n$$\nNow, substitute this expression for $U^2$ into the definition of $\\mathcal{R}$:\n$$\n\\mathcal{R} = \\frac{\\rho}{g \\Delta \\rho H} \\left(Fr^2 \\frac{g \\Delta \\rho H}{\\rho_0}\\right) - Fr^2\n$$\nAssuming $g \\neq 0$, $H \\neq 0$, and $\\Delta \\rho \\neq 0$, we can cancel terms:\n$$\n\\mathcal{R} = \\frac{\\rho}{\\rho_0} Fr^2 - Fr^2 = \\left(\\frac{\\rho}{\\rho_0} - 1\\right) Fr^2\n$$\nWe recognize the term $(\\rho / \\rho_0 - 1)$ as being equal to $\\varepsilon_B$:\n$$\n\\mathcal{R} = \\varepsilon_B Fr^2\n$$\nUsing the expression for $\\varepsilon_B$ in terms of $\\Delta \\rho / \\rho$, we obtain the final computational formula:\n$$\n\\mathcal{R} = \\left(\\frac{\\frac{\\Delta \\rho}{\\rho}}{1 - \\frac{\\Delta \\rho}{\\rho}}\\right) Fr^2\n$$\nThis final form depends only on the given parameters for each test case, $\\Delta \\rho / \\rho$ and $Fr$.\n\n**Summary of Computational Formulas**\nFor each test case, defined by a value for $\\Delta \\rho / \\rho$ and $Fr$, the three required quantities are computed as follows:\n1. $\\varepsilon_M = -(\\Delta \\rho / \\rho)$\n2. $\\varepsilon_B = \\frac{\\Delta \\rho / \\rho}{1 - \\Delta \\rho / \\rho}$\n3. $\\mathcal{R} = \\varepsilon_B \\cdot Fr^2 = \\left(\\frac{\\Delta \\rho / \\rho}{1 - \\Delta \\rho / \\rho}\\right) Fr^2$\n\nThese formulas are implemented in the provided Python code to generate the final results. The constants $\\rho_0$, $g$, and $H$ are not directly needed for computing the dimensionless error metrics once these simplified expressions are derived, showcasing the power of nondimensionalization.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates three dimensionless error metrics related to the Boussinesq\n    approximation for a set of test cases describing a turbidity current.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Each case is a tuple (density_contrast_ratio, froude_number).\n    test_cases = [\n        (0.0, 0.0),  # Case 1: Δρ/ρ = 0, Fr = 0\n        (0.02, 1.0), # Case 2: Δρ/ρ = 0.02, Fr = 1.0\n        (0.05, 1.5), # Case 3: Δρ/ρ = 0.05, Fr = 1.5\n        (0.10, 0.8), # Case 4: Δρ/ρ = 0.10, Fr = 0.8\n    ]\n\n    results = []\n    for case in test_cases:\n        delta_rho_over_rho, fr = case\n\n        # 1. Calculate the relative error in the momentum budget, ε_M.\n        # ε_M = -Δρ/ρ\n        epsilon_M = -delta_rho_over_rho\n\n        # 2. Calculate the relative error in the buoyancy budget, ε_B.\n        # This handles the case where delta_rho_over_rho is 0, avoiding division by zero.\n        # ε_B = (Δρ/ρ) / (1 - Δρ/ρ)\n        if delta_rho_over_rho == 1.0:\n            # This would correspond to rho_0 = 0, a physical impossibility\n            # and mathematical singularity in the formula.\n            epsilon_B = float('inf')\n        else:\n            epsilon_B = delta_rho_over_rho / (1.0 - delta_rho_over_rho)\n\n        # 3. Calculate the dimensionless closure residual, R.\n        # R = ε_B * Fr^2\n        residual_R = epsilon_B * (fr ** 2)\n        \n        # Round results to six decimal places as required.\n        # Note: round() provides standard rounding behavior.\n        # For Case 1, -0.0 rounds to -0.0. We will store it as 0.0 for cleaner representation.\n        if epsilon_M == -0.0:\n            epsilon_M = 0.0\n            \n        res_list = [\n            round(epsilon_M, 6),\n            round(epsilon_B, 6),\n            round(residual_R, 6)\n        ]\n        results.append(res_list)\n\n    # Final print statement in the exact required format.\n    # The format is a string representation of a list of lists.\n    # Example: [[-0.0, 0.0, 0.0],[-0.02, 0.020408, 0.020408]]\n    # map(str, results) converts each sublist to its string representation.\n    # ','.join() concatenates these strings with a comma.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3597130"}]}