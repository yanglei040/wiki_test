{"hands_on_practices": [{"introduction": "A primary application of ambient noise interferometry is to measure the travel times of surface waves between pairs of seismic stations. This practice guides you through the fundamental process of converting a set of travel-time measurements, each with its own uncertainty, into a single, robust estimate of group velocity. By applying a weighted least-squares inversion, you will learn a cornerstone data analysis technique used in surface wave tomography to derive Earth structure from noisy data [@problem_id:3575697].", "problem": "A set of seismic stations records a month-long ambient noise field that is approximately stationary and horizontally diffuse. For each station pair, the time-domain cross-correlation function $C_{ij}(\\tau)$ is computed and then narrowband filtered around a fixed central frequency $f_0$ with a small fractional bandwidth. The analytic signal envelope of the bandpassed $C_{ij}(\\tau)$ is formed via the Hilbert transform, and the arrival time of the envelope peak is picked as the group delay $\\tau_k(f_0)$ for pair $k$. Assume a one-dimensional path, a single dispersive surface-wave mode dominating around $f_0$, and that the cross-correlation converges to the symmetrized Green’s function so that the envelope peak time is an unbiased estimator of the modal group delay.\n\nFor $N=5$ station pairs, the interstation distance $L_k$ and the picked peak time $\\tau_k$ with one-standard-deviation uncertainty $\\sigma_{\\tau,k}$ (assumed Gaussian, independent, and uncorrelated across pairs) are:\n- $L_1 = 110\\,\\mathrm{km}$, $\\tau_1 = 31.8\\,\\mathrm{s}$, $\\sigma_{\\tau,1} = 1.2\\,\\mathrm{s}$.\n- $L_2 = 180\\,\\mathrm{km}$, $\\tau_2 = 50.6\\,\\mathrm{s}$, $\\sigma_{\\tau,2} = 0.8\\,\\mathrm{s}$.\n- $L_3 = 250\\,\\mathrm{km}$, $\\tau_3 = 72.1\\,\\mathrm{s}$, $\\sigma_{\\tau,3} = 1.0\\,\\mathrm{s}$.\n- $L_4 = 320\\,\\mathrm{km}$, $\\tau_4 = 90.9\\,\\mathrm{s}$, $\\sigma_{\\tau,4} = 1.5\\,\\mathrm{s}$.\n- $L_5 = 390\\,\\mathrm{km}$, $\\tau_5 = 111.7\\,\\mathrm{s}$, $\\sigma_{\\tau,5} = 0.9\\,\\mathrm{s}$.\n\nModel the travel-time–distance relation at $f_0$ as\n$$\n\\tau_k(f_0) \\;=\\; \\frac{L_k}{U(f_0)} \\;+\\; \\epsilon_k,\n$$\nwith $\\epsilon_k$ zero-mean, independent Gaussian errors of variance $\\sigma_{\\tau,k}^2$, and with distances $L_k$ known exactly. Using a weighted least-squares fit of $\\tau$ versus $L$ constrained to pass through the origin, estimate the group velocity $U(f_0)$ and propagate the time-pick uncertainties to obtain the one-standard-deviation uncertainty of $U(f_0)$ using linear error propagation.\n\nReport the final answer as a two-entry row matrix containing, in order, the estimated group velocity and its one-standard-deviation uncertainty at $f_0$, both in $\\mathrm{km\\,s}^{-1}$. Round both values to four significant figures.", "solution": "The user wants me to solve a weighted least-squares problem to determine the group velocity and its uncertainty from a set of travel-time and distance measurements.\n\n### Problem Validation\n\n#### Step 1: Extract Givens\n- A set of $N=5$ station pairs.\n- For each pair $k$, an interstation distance $L_k$ and a group delay (peak time) $\\tau_k$ with a one-standard-deviation uncertainty $\\sigma_{\\tau,k}$.\n- Data points $(L_k, \\tau_k, \\sigma_{\\tau,k})$ for $k=1, \\dots, 5$:\n    - $k=1$: $L_1 = 110\\,\\mathrm{km}$, $\\tau_1 = 31.8\\,\\mathrm{s}$, $\\sigma_{\\tau,1} = 1.2\\,\\mathrm{s}$\n    - $k=2$: $L_2 = 180\\,\\mathrm{km}$, $\\tau_2 = 50.6\\,\\mathrm{s}$, $\\sigma_{\\tau,2} = 0.8\\,\\mathrm{s}$\n    - $k=3$: $L_3 = 250\\,\\mathrm{km}$, $\\tau_3 = 72.1\\,\\mathrm{s}$, $\\sigma_{\\tau,3} = 1.0\\,\\mathrm{s}$\n    - $k=4$: $L_4 = 320\\,\\mathrm{km}$, $\\tau_4 = 90.9\\,\\mathrm{s}$, $\\sigma_{\\tau,4} = 1.5\\,\\mathrm{s}$\n    - $k=5$: $L_5 = 390\\,\\mathrm{km}$, $\\tau_5 = 111.7\\,\\mathrm{s}$, $\\sigma_{\\tau,5} = 0.9\\,\\mathrm{s}$\n- The errors $\\epsilon_k$ in the travel times are zero-mean, independent Gaussian errors with variance $\\sigma_{\\tau,k}^2$.\n- The distances $L_k$ are known exactly.\n- The model for the travel time is $\\tau_k(f_0) = \\frac{L_k}{U(f_0)} + \\epsilon_k$.\n- The task is to use a weighted least-squares fit of $\\tau$ versus $L$, constrained to pass through the origin $(0,0)$.\n- The goal is to estimate the group velocity $U(f_0)$ and its one-standard-deviation uncertainty $\\sigma_{U(f_0)}$ using linear error propagation.\n- The final answer should be rounded to four significant figures and reported in $\\mathrm{km\\,s}^{-1}$.\n\n#### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded:** The problem is firmly rooted in seismology, specifically in the context of ambient noise interferometry. The relationship between travel time $\\tau$, distance $L$, and group velocity $U$ ($\\tau = L/U$) is a fundamental principle. The use of weighted least-squares to estimate parameters from noisy data is a standard scientific method. The provided data values (distances, times) are physically realistic for surface waves in the Earth's crust.\n- **Well-Posed:** The problem is well-posed. It provides a clear physical model, a complete dataset with uncertainties, and specifies the exact statistical method (weighted least-squares with a zero-intercept constraint) to be used. This leads to a unique and stable solution for the group velocity and its uncertainty.\n- **Objective:** The problem is stated in precise, quantitative, and objective language, free of any subjective or opinion-based claims.\n\n#### Step 3: Verdict and Action\nThe problem is valid as it is scientifically sound, well-posed, and objective. There are no contradictions, ambiguities, or missing information. I will proceed with the solution.\n\n### Solution Derivation\n\nThe model relating the travel time $\\tau_k$ to the distance $L_k$ for each station pair $k$ is given by\n$$\n\\tau_k = \\frac{L_k}{U} + \\epsilon_k\n$$\nwhere $U$ is the group velocity at the central frequency $f_0$ (we will drop the explicit $f_0$ dependence for notational simplicity), and $\\epsilon_k$ represents the measurement error. This model is linear in the distance $L_k$ with a zero intercept. We can write it as\n$$\n\\tau_k = m L_k + \\epsilon_k\n$$\nwhere the slope $m$ is the group slowness, defined as $m = 1/U$. Our goal is to find the best estimate for $m$ and then derive the estimate for $U$ and its uncertainty.\n\nWe use the method of weighted least-squares, which aims to minimize the chi-squared statistic, $\\chi^2$, defined as the sum of squared, weighted residuals:\n$$\n\\chi^2 = \\sum_{k=1}^{N} \\left( \\frac{\\tau_k - m L_k}{\\sigma_{\\tau,k}} \\right)^2\n$$\nwhere $N=5$ is the number of data points and $\\sigma_{\\tau,k}$ is the standard deviation of the measurement $\\tau_k$. The weights are $w_k = 1/\\sigma_{\\tau,k}^2$.\n\nTo find the value of $m$ that minimizes $\\chi^2$, we take the derivative with respect to $m$ and set it to zero:\n$$\n\\frac{d\\chi^2}{dm} = \\sum_{k=1}^{N} \\frac{d}{dm} \\left( \\frac{\\tau_k - m L_k}{\\sigma_{\\tau,k}} \\right)^2 = \\sum_{k=1}^{N} 2 \\left( \\frac{\\tau_k - m L_k}{\\sigma_{\\tau,k}^2} \\right) (-L_k) = 0\n$$\n$$\n-2 \\sum_{k=1}^{N} \\frac{L_k \\tau_k - m L_k^2}{\\sigma_{\\tau,k}^2} = 0\n$$\n$$\n\\sum_{k=1}^{N} \\frac{L_k \\tau_k}{\\sigma_{\\tau,k}^2} - m \\sum_{k=1}^{N} \\frac{L_k^2}{\\sigma_{\\tau,k}^2} = 0\n$$\nSolving for the estimated slope, $\\hat{m}$, we get:\n$$\n\\hat{m} = \\frac{\\sum_{k=1}^{N} (L_k \\tau_k / \\sigma_{\\tau,k}^2)}{\\sum_{k=1}^{N} (L_k^2 / \\sigma_{\\tau,k}^2)}\n$$\nThe variance of this estimate, $\\sigma_{\\hat{m}}^2$, is given by the inverse of the curvature of the $\\chi^2$ function. The second derivative is:\n$$\n\\frac{d^2\\chi^2}{dm^2} = \\frac{d}{dm} \\left( -2 \\sum_{k=1}^{N} \\frac{L_k \\tau_k - m L_k^2}{\\sigma_{\\tau,k}^2} \\right) = \\sum_{k=1}^{N} \\frac{2 L_k^2}{\\sigma_{\\tau,k}^2}\n$$\nThe variance is $\\sigma_{\\hat{m}}^2 = \\left(\\frac{1}{2} \\frac{d^2\\chi^2}{dm^2}\\right)^{-1}$, which gives:\n$$\n\\sigma_{\\hat{m}}^2 = \\left( \\sum_{k=1}^{N} \\frac{L_k^2}{\\sigma_{\\tau,k}^2} \\right)^{-1}\n$$\n\nNow, we compute the necessary sums using the provided data:\n- $k=1$: $L_1=110$, $\\tau_1=31.8$, $\\sigma_{\\tau,1}=1.2$.\n  $\\frac{L_1\\tau_1}{\\sigma_{\\tau,1}^2} = \\frac{110 \\times 31.8}{1.2^2} = \\frac{3498}{1.44} \\approx 2429.167$.\n  $\\frac{L_1^2}{\\sigma_{\\tau,1}^2} = \\frac{110^2}{1.2^2} = \\frac{12100}{1.44} \\approx 8402.778$.\n- $k=2$: $L_2=180$, $\\tau_2=50.6$, $\\sigma_{\\tau,2}=0.8$.\n  $\\frac{L_2\\tau_2}{\\sigma_{\\tau,2}^2} = \\frac{180 \\times 50.6}{0.8^2} = \\frac{9108}{0.64} = 14231.25$.\n  $\\frac{L_2^2}{\\sigma_{\\tau,2}^2} = \\frac{180^2}{0.8^2} = \\frac{32400}{0.64} = 50625$.\n- $k=3$: $L_3=250$, $\\tau_3=72.1$, $\\sigma_{\\tau,3}=1.0$.\n  $\\frac{L_3\\tau_3}{\\sigma_{\\tau,3}^2} = \\frac{250 \\times 72.1}{1.0^2} = 18025$.\n  $\\frac{L_3^2}{\\sigma_{\\tau,3}^2} = \\frac{250^2}{1.0^2} = 62500$.\n- $k=4$: $L_4=320$, $\\tau_4=90.9$, $\\sigma_{\\tau,4}=1.5$.\n  $\\frac{L_4\\tau_4}{\\sigma_{\\tau,4}^2} = \\frac{320 \\times 90.9}{1.5^2} = \\frac{29088}{2.25} = 12928$.\n  $\\frac{L_4^2}{\\sigma_{\\tau,4}^2} = \\frac{320^2}{1.5^2} = \\frac{102400}{2.25} \\approx 45511.111$.\n- $k=5$: $L_5=390$, $\\tau_5=111.7$, $\\sigma_{\\tau,5}=0.9$.\n  $\\frac{L_5\\tau_5}{\\sigma_{\\tau,5}^2} = \\frac{390 \\times 111.7}{0.9^2} = \\frac{43563}{0.81} \\approx 53781.481$.\n  $\\frac{L_5^2}{\\sigma_{\\tau,5}^2} = \\frac{390^2}{0.9^2} = \\frac{152100}{0.81} \\approx 187777.778$.\n\nSumming these values:\n$$\n\\sum_{k=1}^{5} \\frac{L_k \\tau_k}{\\sigma_{\\tau,k}^2} \\approx 2429.167 + 14231.25 + 18025 + 12928 + 53781.481 = 101394.898 \\, \\mathrm{km} \\cdot \\mathrm{s}^{-1}\n$$\n$$\n\\sum_{k=1}^{5} \\frac{L_k^2}{\\sigma_{\\tau,k}^2} \\approx 8402.778 + 50625 + 62500 + 45511.111 + 187777.778 = 354816.667 \\, \\mathrm{km}^2 \\cdot \\mathrm{s}^{-2}\n$$\nNow we can compute $\\hat{m}$ and its variance:\n$$\n\\hat{m} = \\frac{101394.898}{354816.667} \\approx 0.2857683 \\, \\mathrm{s} \\cdot \\mathrm{km}^{-1}\n$$\n$$\n\\sigma_{\\hat{m}}^2 = \\left( 354816.667 \\right)^{-1} \\approx 2.81836 \\times 10^{-6} \\, \\mathrm{s}^2 \\cdot \\mathrm{km}^{-2}\n$$\nThe standard deviation of the slope is:\n$$\n\\sigma_{\\hat{m}} = \\sqrt{\\sigma_{\\hat{m}}^2} \\approx \\sqrt{2.81836 \\times 10^{-6}} \\approx 0.0016788 \\, \\mathrm{s} \\cdot \\mathrm{km}^{-1}\n$$\nThe estimated group velocity $\\hat{U}$ is the inverse of the estimated slowness $\\hat{m}$:\n$$\n\\hat{U} = \\frac{1}{\\hat{m}} = \\frac{1}{0.2857683} \\approx 3.49909 \\, \\mathrm{km} \\cdot \\mathrm{s}^{-1}\n$$\nTo find the uncertainty in $\\hat{U}$, we use linear error propagation for the function $U = 1/m$. The variance $\\sigma_{\\hat{U}}^2$ is related to the variance $\\sigma_{\\hat{m}}^2$ by:\n$$\n\\sigma_{\\hat{U}}^2 \\approx \\left( \\frac{dU}{dm} \\right)^2 \\sigma_{\\hat{m}}^2\n$$\nThe derivative is $\\frac{dU}{dm} = \\frac{d}{dm}(m^{-1}) = -m^{-2} = -U^2$.\n$$\n\\sigma_{\\hat{U}}^2 \\approx (-U^2)^2 \\sigma_{\\hat{m}}^2 = U^4 \\sigma_{\\hat{m}}^2\n$$\nTaking the square root, the standard deviation is:\n$$\n\\sigma_{\\hat{U}} \\approx \\hat{U}^2 \\sigma_{\\hat{m}}\n$$\nSubstituting the calculated values:\n$$\n\\sigma_{\\hat{U}} \\approx (3.49909)^2 \\times 0.0016788 \\approx 12.24363 \\times 0.0016788 \\approx 0.020556 \\, \\mathrm{km} \\cdot \\mathrm{s}^{-1}\n$$\nThe problem requires rounding the final answers to four significant figures.\nThe estimated group velocity is $\\hat{U} \\approx 3.49909 \\, \\mathrm{km} \\cdot \\mathrm{s}^{-1}$, which rounds to $3.499 \\, \\mathrm{km} \\cdot \\mathrm{s}^{-1}$.\nThe uncertainty is $\\sigma_{\\hat{U}} \\approx 0.020556 \\, \\mathrm{km} \\cdot \\mathrm{s}^{-1}$, which rounds to $0.02056 \\, \\mathrm{km} \\cdot \\mathrm{s}^{-1}$.\n\nThe final answer is composed of the estimated group velocity and its one-standard-deviation uncertainty.\nEstimated group velocity: $3.499 \\, \\mathrm{km} \\cdot \\mathrm{s}^{-1}$\nUncertainty: $0.02056 \\, \\mathrm{km} \\cdot \\mathrm{s}^{-1}$", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n3.499  0.02056\n\\end{pmatrix}\n}\n$$", "id": "3575697"}, {"introduction": "The precision of any geophysical measurement is fundamentally limited by the quality of the instrumentation. This exercise explores how to quantify the impact of real-world instrument imperfections—specifically, clock drift and sampling jitter—on phase velocity estimates derived from cross-correlation. By applying error propagation analysis, you will connect theoretical models to practical engineering, learning how to establish tolerance specifications for seismic instruments to meet a desired measurement accuracy [@problem_id:3575692].", "problem": "Consider two single-component seismic stations, $\\mathrm{A}$ and $\\mathrm{B}$, separated by an interstation distance $L$, recording an isotropic, diffuse ambient seismic noise field over a duration sufficiently long to retrieve the empirical Green’s function between the stations by cross-correlation. Under ideal instrumentation, the causal cross-correlation peak identifies the travel time $\\tau_{0}$ of the surface-wave arrival, and the phase velocity estimate is defined by $c_{0} = L / \\tau_{0}$.\n\nNow suppose that the time base of station $\\mathrm{B}$ exhibits a constant fractional clock drift $\\epsilon$, modeled as a uniform time-axis scaling of the measured record such that the measured time coordinate $t_{\\mathrm{m}}$ relates to the true physical time $t$ by $t_{\\mathrm{m}} = (1+\\epsilon)t$, with $|\\epsilon| \\ll 1$. Additionally, both stations’ sampling systems exhibit independent, zero-mean Gaussian sampling jitter, modeled as additive random perturbations to the time stamps with identical standard deviations $\\sigma_{j}$ at each station. Assume that this jitter induces an effective additive perturbation $\\delta \\tau$ to the measured cross-correlation lag with standard deviation $\\sigma_{\\tau} = \\sqrt{\\sigma_{j,\\mathrm{A}}^{2} + \\sigma_{j,\\mathrm{B}}^{2}} = \\sqrt{2}\\,\\sigma_{j}$, and that $\\delta \\tau$ is statistically independent of $\\epsilon$.\n\nStarting only from the fundamental definition $c = L/\\tau$ for a measured lag $\\tau$ and the stated instrumentation error models, perform the following:\n\n1. Derive the phase-velocity estimate $c(\\epsilon)$ under the clock drift model and compute the analytical sensitivity $\\mathrm{d}c/\\mathrm{d}\\epsilon$ as a function of $\\epsilon$ and appropriately defined quantities.\n\n2. Using a first-order (linear) error propagation in $\\delta \\tau$, derive the one-standard-deviation random uncertainty $\\sigma_{c}$ in the phase-velocity estimate due to sampling jitter, expressed in terms of $L$, $c_{0}$, and $\\sigma_{j}$.\n\n3. For a design specification that limits the total phase-velocity error budget to a fraction $\\alpha$ of the true velocity $c_{0}$, allocate the budget equally between the deterministic bias induced by $\\epsilon$ and the one-standard-deviation random uncertainty induced by jitter, i.e., require $|\\Delta c_{\\text{bias}}| \\le \\alpha c_{0}/2$ and $\\sigma_{c} \\le \\alpha c_{0}/2$. Under these allocation rules, derive tolerances for the instrumentation:\n   - the maximum allowed absolute fractional drift $|\\epsilon|_{\\max}$,\n   - and the maximum allowed sampling jitter standard deviation $\\sigma_{j,\\max}$.\n\nFinally, evaluate these tolerances numerically for $L = 60\\,\\mathrm{km}$, $c_{0} = 3.2\\,\\mathrm{km\\,s^{-1}}$, and $\\alpha = 0.01$. Express the jitter tolerance $\\sigma_{j,\\max}$ in seconds, and round both numerical tolerances to three significant figures. The final answer must present:\n- the closed-form analytic expression for $\\mathrm{d}c/\\mathrm{d}\\epsilon$, and\n- the two numerical tolerances,\nas a single composite result.", "solution": "The problem statement has been validated and is deemed scientifically grounded, well-posed, and objective. It presents a standard exercise in instrumentation error analysis within the context of computational geophysics. All required data and models are provided, and the tasks are clearly defined.\n\nThe solution proceeds in three parts as requested by the problem statement, followed by a numerical evaluation.\n\n### Part 1: Clock Drift Analysis and Sensitivity\n\nLet the true, ideal travel time of the surface wave between stations A and B be $\\tau_{0}$. The true phase velocity is given by $c_{0} = L / \\tau_{0}$, where $L$ is the interstation distance.\n\nStation B's clock has a constant fractional drift $\\epsilon$, modeled by the relationship between measured time $t_{\\mathrm{m}}$ and true time $t$ as $t_{\\mathrm{m}} = (1+\\epsilon)t$. This implies that a true time interval $\\Delta t$ is measured at station B as a time interval $\\Delta t_{\\mathrm{m}} = (1+\\epsilon)\\Delta t$.\n\nThe travel time $\\tau_{0}$ is a true time interval. Assuming station A's clock is the reference and is perfect, the cross-correlation process will measure a travel time lag, denoted here as $\\tau(\\epsilon)$, which corresponds to how station B's clock measures the interval $\\tau_{0}$. Therefore, the measured lag under the influence of clock drift is:\n$$\n\\tau(\\epsilon) = (1+\\epsilon)\\tau_{0}\n$$\nThe phase velocity estimate based on this measured lag is defined as $c = L/\\tau$. Substituting the expression for $\\tau(\\epsilon)$, we obtain the phase-velocity estimate as a function of the clock drift, $c(\\epsilon)$:\n$$\nc(\\epsilon) = \\frac{L}{\\tau(\\epsilon)} = \\frac{L}{(1+\\epsilon)\\tau_{0}}\n$$\nSince $c_{0} = L/\\tau_{0}$, we can rewrite $c(\\epsilon)$ in terms of the true velocity $c_{0}$:\n$$\nc(\\epsilon) = \\frac{1}{1+\\epsilon} \\left(\\frac{L}{\\tau_{0}}\\right) = \\frac{c_{0}}{1+\\epsilon}\n$$\nThis is the phase-velocity estimate under the clock drift model.\n\nNext, we compute the analytical sensitivity, $\\mathrm{d}c/\\mathrm{d}\\epsilon$. This is the first derivative of $c(\\epsilon)$ with respect to $\\epsilon$:\n$$\n\\frac{\\mathrm{d}c}{\\mathrm{d}\\epsilon} = \\frac{\\mathrm{d}}{\\mathrm{d}\\epsilon} \\left[ c_{0} (1+\\epsilon)^{-1} \\right]\n$$\nUsing the power rule for differentiation, we find:\n$$\n\\frac{\\mathrm{d}c}{\\mathrm{d}\\epsilon} = c_{0} \\cdot (-1) (1+\\epsilon)^{-2} \\cdot \\frac{\\mathrm{d}}{\\mathrm{d}\\epsilon}(1+\\epsilon) = -c_{0}(1+\\epsilon)^{-2} = -\\frac{c_{0}}{(1+\\epsilon)^2}\n$$\nThis is the required analytical expression for the sensitivity of the phase-velocity estimate to the fractional clock drift.\n\n### Part 2: Random Uncertainty from Sampling Jitter\n\nThe phase velocity $c$ is a function of the measured travel time $\\tau$, given by $c(\\tau) = L/\\tau$. The sampling jitter introduces a random perturbation $\\delta\\tau$ to the measured lag, with a standard deviation $\\sigma_{\\tau} = \\sqrt{2}\\sigma_{j}$. We use the first-order linear error propagation formula to find the corresponding uncertainty in phase velocity, $\\sigma_{c}$. For a function of a single variable, this is given by:\n$$\n\\sigma_{c} = \\left| \\frac{\\mathrm{d}c}{\\mathrm{d}\\tau} \\right| \\sigma_{\\tau}\n$$\nThe derivative is evaluated at the expected value of $\\tau$, which is the true travel time $\\tau_{0}$. First, we compute the derivative of $c(\\tau)$ with respect to $\\tau$:\n$$\n\\frac{\\mathrm{d}c}{\\mathrm{d}\\tau} = \\frac{\\mathrm{d}}{\\mathrm{d}\\tau} \\left( \\frac{L}{\\tau} \\right) = -L\\tau^{-2} = -\\frac{L}{\\tau^2}\n$$\nEvaluating this derivative at $\\tau = \\tau_{0}$:\n$$\n\\left. \\frac{\\mathrm{d}c}{\\mathrm{d}\\tau} \\right|_{\\tau=\\tau_{0}} = -\\frac{L}{\\tau_{0}^2}\n$$\nWe can express this in terms of $c_{0}$ and $L$. Since $\\tau_{0}=L/c_{0}$, we have:\n$$\n-\\frac{L}{\\tau_{0}^2} = -\\frac{L}{(L/c_{0})^2} = -\\frac{L}{L^2/c_{0}^2} = -\\frac{c_{0}^2}{L}\n$$\nNow, we substitute this into the error propagation formula:\n$$\n\\sigma_{c} = \\left| -\\frac{c_{0}^2}{L} \\right| \\sigma_{\\tau} = \\frac{c_{0}^2}{L} \\sigma_{\\tau}\n$$\nThe problem states that $\\sigma_{\\tau} = \\sqrt{2}\\sigma_{j}$. Substituting this relationship yields the final expression for the random uncertainty $\\sigma_{c}$ in terms of $L$, $c_{0}$, and $\\sigma_{j}$:\n$$\n\\sigma_{c} = \\frac{\\sqrt{2}\\,c_{0}^2}{L}\\sigma_{j}\n$$\n\n### Part 3: Instrumentation Tolerances\n\nThe total phase-velocity error budget is a fraction $\\alpha$ of the true velocity $c_{0}$. This budget is allocated equally to deterministic bias and random uncertainty.\n\n**Tolerance for Fractional Clock Drift $|\\epsilon|_{\\max}$**:\nThe deterministic bias is $\\Delta c_{\\text{bias}} = c(\\epsilon) - c_{0}$. The budget allocation requires $|\\Delta c_{\\text{bias}}| \\le \\alpha c_{0}/2$.\n$$\n|\\Delta c_{\\text{bias}}| = \\left| \\frac{c_{0}}{1+\\epsilon} - c_{0} \\right| = \\left| c_{0} \\left( \\frac{1 - (1+\\epsilon)}{1+\\epsilon} \\right) \\right| = \\left| -\\frac{c_{0}\\epsilon}{1+\\epsilon} \\right| = \\frac{c_{0}|\\epsilon|}{|1+\\epsilon|}\n$$\nGiven the condition $|\\epsilon| \\ll 1$, we can make the first-order approximation $|1+\\epsilon| \\approx 1$. The inequality becomes:\n$$\nc_{0}|\\epsilon| \\le \\frac{\\alpha c_{0}}{2}\n$$\nDividing by $c_{0}$ (since $c_{0} > 0$), we get:\n$$\n|\\epsilon| \\le \\frac{\\alpha}{2}\n$$\nTherefore, the maximum allowed absolute fractional drift is:\n$$\n|\\epsilon|_{\\max} = \\frac{\\alpha}{2}\n$$\n\n**Tolerance for Sampling Jitter $\\sigma_{j,\\max}$**:\nThe one-standard-deviation random uncertainty $\\sigma_{c}$ must satisfy $\\sigma_{c} \\le \\alpha c_{0}/2$. Using the expression for $\\sigma_{c}$ from Part 2:\n$$\n\\frac{\\sqrt{2}\\,c_{0}^2}{L}\\sigma_{j} \\le \\frac{\\alpha c_{0}}{2}\n$$\nTo find the maximum allowed jitter, $\\sigma_{j,\\max}$, we solve for $\\sigma_{j}$:\n$$\n\\sigma_{j} \\le \\frac{\\alpha c_{0}}{2} \\cdot \\frac{L}{\\sqrt{2}\\,c_{0}^2} = \\frac{\\alpha L}{2\\sqrt{2}\\,c_{0}}\n$$\nThus, the maximum allowed sampling jitter standard deviation is:\n$$\n\\sigma_{j,\\max} = \\frac{\\alpha L}{2\\sqrt{2}\\,c_{0}}\n$$\n\n### Numerical Evaluation\n\nWe are given the following values:\n$L = 60\\,\\mathrm{km} = 6 \\times 10^4\\,\\mathrm{m}$\n$c_{0} = 3.2\\,\\mathrm{km\\,s^{-1}} = 3.2 \\times 10^3\\,\\mathrm{m\\,s^{-1}}$\n$\\alpha = 0.01$\n\nFirst, we calculate the tolerance for the fractional clock drift, $|\\epsilon|_{\\max}$:\n$$\n|\\epsilon|_{\\max} = \\frac{\\alpha}{2} = \\frac{0.01}{2} = 0.005\n$$\nExpressed in scientific notation to three significant figures, this is $5.00 \\times 10^{-3}$.\n\nNext, we calculate the tolerance for the sampling jitter, $\\sigma_{j,\\max}$:\n$$\n\\sigma_{j,\\max} = \\frac{\\alpha L}{2\\sqrt{2}\\,c_{0}} = \\frac{0.01 \\times (6 \\times 10^4\\,\\mathrm{m})}{2\\sqrt{2} \\times (3.2 \\times 10^3\\,\\mathrm{m\\,s^{-1}})} = \\frac{600}{6400\\sqrt{2}}\\,\\mathrm{s} = \\frac{3}{32\\sqrt{2}}\\,\\mathrm{s}\n$$\nNumerically evaluating this expression:\n$$\n\\sigma_{j,\\max} \\approx \\frac{3}{32 \\times 1.41421356} \\,\\mathrm{s} \\approx \\frac{3}{45.254834} \\,\\mathrm{s} \\approx 0.0662913\\,\\mathrm{s}\n$$\nRounding to three significant figures, we get $\\sigma_{j,\\max} = 0.0663\\,\\mathrm{s}$. In scientific notation, this is $6.63 \\times 10^{-2}\\,\\mathrm{s}$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix} -\\frac{c_0}{(1+\\epsilon)^2}  5.00 \\times 10^{-3}  6.63 \\times 10^{-2} \\end{pmatrix}\n}\n$$", "id": "3575692"}, {"introduction": "While travel-time analysis is powerful, the full waveform of an empirical cross-correlation contains richer information about Earth's structure and the noise field itself. To leverage this information, the empirical data must be quantitatively compared to a theoretical Green's function, which requires careful amplitude normalization. This problem demonstrates how to determine the optimal scaling factor by minimizing the least-squares misfit between the empirical and theoretical waveforms, revealing how phase discrepancies can affect amplitude recovery [@problem_id:3575715].", "problem": "Consider two receivers labeled $i$ and $j$ in a homogeneous, isotropic elastic medium. The inter-receiver distance is $L = 30\\,\\mathrm{km}$ and the compressional-wave speed is $v = 3\\,\\mathrm{km\\,s^{-1}}$, so the ballistic arrival time is $\\tau_0 = L/v$. After long-time stacking of ambient noise, the empirical cross-correlation between the receivers, $C_{ij}(\\tau)$, is measured, and a reference Green's function (the fundamental solution of the wave equation), $G_{ij}(\\tau)$, is computed in the same homogeneous model using a frequency-domain solver. Both $C_{ij}(\\tau)$ and $G_{ij}(\\tau)$ have been pre-normalized to be dimensionless amplitudes. Because of imperfect source distribution and preprocessing, the empirical cross-correlation is expected to match the reference Green's function up to a scalar amplitude factor.\n\nTo determine a scalar normalization constant $a$ such that $a\\,C_{ij}(\\tau)$ best approximates $G_{ij}(\\tau)$ near the ballistic arrival, define the least-squares ($L^2$) error in a symmetric time window $W = [\\tau_0 - T,\\, \\tau_0 + T]$:\n$$\nE(a) = \\int_{\\tau_0 - T}^{\\tau_0 + T} \\left( a\\,C_{ij}(\\tau) - G_{ij}(\\tau) \\right)^2 \\, \\mathrm{d}\\tau,\n$$\nand select $a$ that minimizes $E(a)$. Assume $T = 3\\,\\mathrm{s}$, and model the empirical cross-correlation and the reference Green's function in the window as\n$$\nC_{ij}(\\tau) = A_C\\,\\exp\\!\\left(-\\frac{(\\tau - \\tau_0)^2}{2\\sigma^2}\\right)\\,\\cos\\!\\left(\\omega\\,(\\tau - \\tau_0)\\right),\n$$\n$$\nG_{ij}(\\tau) = A_G\\,\\exp\\!\\left(-\\frac{(\\tau - \\tau_0)^2}{2\\sigma^2}\\right)\\,\\cos\\!\\left(\\omega\\,(\\tau - \\tau_0) + \\phi\\right),\n$$\nwith parameters $A_C = 1$, $A_G = 1.5$, $\\sigma = 0.5\\,\\mathrm{s}$, $\\omega = 40\\,\\mathrm{rad\\,s^{-1}}$, and $\\phi = 0.1\\,\\mathrm{rad}$. These choices are consistent with a narrowband wavelet whose envelope is centered on the ballistic arrival and whose phase in the reference model is slightly shifted due to numerical dispersion.\n\nDetermine the scalar normalization constant $a^{\\ast}$ that minimizes $E(a)$, and provide its numerical value. Express your final normalization constant as a dimensionless number rounded to four significant figures.", "solution": "The physical basis for using ambient noise cross-correlation to recover the Green's function is that, in a diffuse field with sufficiently isotropic illumination and uniform source distribution, the time-domain cross-correlation between receivers $i$ and $j$ approximates the Green's function between those receivers up to a constant factor due to source power and preprocessing. In practice, one determines a scalar $a$ to match amplitudes by minimizing a least-squares misfit in a window around the ballistic arrival to suppress coda and multiple contributions.\n\nWe begin from the definition of the error functional,\n$$\nE(a) = \\int_{\\tau_0 - T}^{\\tau_0 + T} \\left( a\\,C_{ij}(\\tau) - G_{ij}(\\tau) \\right)^2 \\, \\mathrm{d}\\tau.\n$$\nTo minimize $E(a)$, differentiate with respect to $a$ and set the derivative to zero:\n$$\n\\frac{\\mathrm{d}E}{\\mathrm{d}a} = 2 \\int_{\\tau_0 - T}^{\\tau_0 + T} \\left( a\\,C_{ij}(\\tau) - G_{ij}(\\tau) \\right) C_{ij}(\\tau) \\, \\mathrm{d}\\tau = 0.\n$$\nSolving for $a$ yields the unique minimizer\n$$\na^{\\ast} = \\frac{\\int_{\\tau_0 - T}^{\\tau_0 + T} C_{ij}(\\tau)\\,G_{ij}(\\tau) \\,\\mathrm{d}\\tau}{\\int_{\\tau_0 - T}^{\\tau_0 + T} C_{ij}(\\tau)^2 \\,\\mathrm{d}\\tau}.\n$$\nInsert the given functional forms with $t \\equiv \\tau - \\tau_0$ for brevity:\n$$\nC_{ij}(t) = A_C\\,\\exp\\!\\left(-\\frac{t^2}{2\\sigma^2}\\right)\\,\\cos(\\omega t), \\quad\nG_{ij}(t) = A_G\\,\\exp\\!\\left(-\\frac{t^2}{2\\sigma^2}\\right)\\,\\cos(\\omega t + \\phi),\n$$\nand the symmetric window $t \\in [-T,\\,T]$. Then\n$$\na^{\\ast} = \\frac{A_C A_G \\int_{-T}^{T} \\exp\\!\\left(-\\frac{t^2}{\\sigma^2}\\right)\\,\\cos(\\omega t)\\,\\cos(\\omega t + \\phi)\\,\\mathrm{d}t}{A_C^2 \\int_{-T}^{T} \\exp\\!\\left(-\\frac{t^2}{\\sigma^2}\\right)\\,\\cos^2(\\omega t)\\,\\mathrm{d}t}.\n$$\nUse the trigonometric identity $\\cos(\\omega t + \\phi) = \\cos\\phi\\,\\cos(\\omega t) - \\sin\\phi\\,\\sin(\\omega t)$ to write\n$$\n\\cos(\\omega t)\\,\\cos(\\omega t + \\phi) = \\cos\\phi\\,\\cos^2(\\omega t) - \\sin\\phi\\,\\cos(\\omega t)\\,\\sin(\\omega t).\n$$\nTherefore\n$$\na^{\\ast} = \\frac{A_G}{A_C}\\,\\frac{\\cos\\phi \\int_{-T}^{T} \\exp\\!\\left(-\\frac{t^2}{\\sigma^2}\\right)\\,\\cos^2(\\omega t)\\,\\mathrm{d}t - \\sin\\phi \\int_{-T}^{T} \\exp\\!\\left(-\\frac{t^2}{\\sigma^2}\\right)\\,\\cos(\\omega t)\\,\\sin(\\omega t)\\,\\mathrm{d}t}{\\int_{-T}^{T} \\exp\\!\\left(-\\frac{t^2}{\\sigma^2}\\right)\\,\\cos^2(\\omega t)\\,\\mathrm{d}t}.\n$$\nThe second integral in the numerator vanishes exactly because the integrand is an odd function over a symmetric interval:\n$$\n\\exp\\!\\left(-\\frac{t^2}{\\sigma^2}\\right) \\text{ is even in } t, \\quad \\cos(\\omega t) \\text{ is even in } t, \\quad \\sin(\\omega t) \\text{ is odd in } t,\n$$\nso $\\exp\\!\\left(-\\frac{t^2}{\\sigma^2}\\right)\\,\\cos(\\omega t)\\,\\sin(\\omega t)$ is odd, implying\n$$\n\\int_{-T}^{T} \\exp\\!\\left(-\\frac{t^2}{\\sigma^2}\\right)\\,\\cos(\\omega t)\\,\\sin(\\omega t)\\,\\mathrm{d}t = 0.\n$$\nConsequently,\n$$\na^{\\ast} = \\frac{A_G}{A_C}\\,\\cos\\phi\\,\\frac{\\int_{-T}^{T} \\exp\\!\\left(-\\frac{t^2}{\\sigma^2}\\right)\\,\\cos^2(\\omega t)\\,\\mathrm{d}t}{\\int_{-T}^{T} \\exp\\!\\left(-\\frac{t^2}{\\sigma^2}\\right)\\,\\cos^2(\\omega t)\\,\\mathrm{d}t} = \\frac{A_G}{A_C}\\,\\cos\\phi.\n$$\nThis closed-form result is independent of the exact values of $\\omega$, $\\sigma$, and $T$, provided the window remains symmetric about $\\tau_0$. Using the given parameters $A_G = 1.5$, $A_C = 1$, and $\\phi = 0.1\\,\\mathrm{rad}$,\n$$\na^{\\ast} = 1.5\\,\\cos(0.1).\n$$\nEvaluate numerically,\n$$\n\\cos(0.1) \\approx 0.9950041653,\n$$\nhence\n$$\na^{\\ast} \\approx 1.5 \\times 0.9950041653 \\approx 1.492506248.\n$$\nRounded to four significant figures as required, the dimensionless normalization constant is\n$$\na^{\\ast} \\approx 1.493.\n$$", "answer": "$$\\boxed{1.493}$$", "id": "3575715"}]}