{"hands_on_practices": [{"introduction": "A robust numerical method should produce physically meaningful results. For diffusion phenomena, this often means satisfying a discrete maximum principle, ensuring that temperatures or pressures do not spontaneously generate spurious local maxima or minima. This desirable behavior is mathematically linked to the system matrix being an M-matrix, a property that, for the finite element stiffness matrix, depends critically on the mesh geometry. This practice [@problem_id:3594914] provides a concrete, hands-on calculation to demonstrate how the presence of obtuse triangles can violate this condition, leading to positive off-diagonal entries in the stiffness matrix and creating the potential for non-physical oscillations in the solution.", "problem": "Consider the two-dimensional heat conduction equation in a homogeneous, isotropic medium,\n$$c\\,\\partial_t u - \\nabla \\cdot (k\\,\\nabla u) = f \\quad \\text{in } \\Omega \\subset \\mathbb{R}^2,$$\nwith constant thermal conductivity $k>0$ and volumetric heat capacity $c>0$. In a linear finite element spatial discretization on a triangular mesh, the semidiscrete system has the form\n$$M\\,\\dot{\\mathbf{u}} + K\\,\\mathbf{u} = \\mathbf{F},$$\nwhere $M$ is the mass matrix, $K$ is the stiffness matrix, and $\\mathbf{F}$ is the load vector. After a backward Euler time step of size $\\Delta t>0$, the fully discrete system is\n$$(M + \\Delta t\\,K)\\,\\mathbf{u}^{n+1} = M\\,\\mathbf{u}^n + \\Delta t\\,\\mathbf{F}^{n+1}.$$\nA matrix with nonpositive off-diagonals and an inverse that is entrywise nonnegative is called an M-matrix (monotone matrix). On meshes that yield an M-matrix for the discrete operator, the discrete maximum principle holds and spurious overshoots are avoided.\n\nConstruct the following simple mesh patch: two triangles share the interior edge between nodes $1$ and $2$, with coordinates\n$$\\mathbf{x}_1=(0,0),\\quad \\mathbf{x}_2=(1,0),\\quad \\mathbf{x}_3=(0.5,\\,0.1),\\quad \\mathbf{x}_4=(0.5,\\,-0.1),$$\nand triangles $T_1=(1,2,3)$ and $T_2=(1,2,4)$. Take $k=1$ and $c=1$. Work strictly from the weak form and the definition of linear shape functions to derive the element stiffness contributions $K_{12}^{T_1}$ and $K_{12}^{T_2}$ and assemble the off-diagonal stiffness entry $K_{12}$ for this patch. Then, reasoning from the properties of $(M+\\Delta t\\,K)$ and the discrete maximum principle, assess the implications for the backward Euler solution and whether overshoots can occur.\n\nWhich of the following statements are correct?\n\nA. For this mesh, the assembled stiffness off-diagonal $K_{12}$ is strictly positive, violating the M-matrix property for the spatial operator and enabling overshoots near the interior edge in backward Euler solutions.\n\nB. Using mass lumping (diagonal $M$) guarantees that $(M+\\Delta t\\,K)$ has nonpositive off-diagonals even on obtuse triangles, so the discrete maximum principle holds.\n\nC. Decreasing the time step $\\Delta t$ alone cannot guarantee removal of overshoots on a fixed mesh if some stiffness off-diagonals are positive; the violation is geometric in origin.\n\nD. Remeshing to an acute or Delaunay triangulation (by appropriate edge flips) restores nonpositive stiffness off-diagonals and the monotonicity needed for the discrete maximum principle.", "solution": "The core of the problem is to determine the sign of the off-diagonal entry $K_{12}$ of the stiffness matrix for the given mesh patch and analyze its consequences for the backward Euler time-stepping scheme.\n\nThe stiffness matrix $K$ arises from the spatial discretization of the term $-\\nabla \\cdot (k\\,\\nabla u)$. Its entries are given by the weak form:\n$$ K_{ij} = \\int_\\Omega k (\\nabla \\phi_j \\cdot \\nabla \\phi_i) \\, d\\Omega $$\nwhere $\\phi_i$ and $\\phi_j$ are the linear basis (hat) functions associated with nodes $i$ and $j$. The global entry $K_{12}$ is assembled by summing the contributions from all elements that contain both nodes $1$ and $2$. In this case, these are triangles $T_1 = (1,2,3)$ and $T_2 = (1,2,4)$.\n$$ K_{12} = K_{12}^{T_1} + K_{12}^{T_2} = \\int_{T_1} k (\\nabla \\phi_2 \\cdot \\nabla \\phi_1) \\, d\\Omega + \\int_{T_2} k (\\nabla \\phi_2 \\cdot \\nabla \\phi_1) \\, d\\Omega $$\nFor linear elements on a triangle, a standard formula relates the off-diagonal element stiffness entry to the cotangent of the angle opposite the corresponding edge. For an edge shared by nodes $i$ and $j$, with the third vertex of the triangle being $k$, the contribution is:\n$$ K_{ij}^T = -k \\frac{\\cot \\theta_k}{2} $$\nwhere $\\theta_k$ is the interior angle of the triangle at vertex $k$.\n\nWe apply this formula to the given mesh patch with $k=1$.\n\nFor triangle $T_1 = (1,2,3)$:\nThe vertices are $\\mathbf{x}_1=(0,0)$, $\\mathbf{x}_2=(1,0)$, and $\\mathbf{x}_3=(0.5,\\,0.1)$. The off-diagonal entry $K_{12}^{T_1}$ corresponds to the edge $(1,2)$, so we need the angle $\\theta_3$ at the opposite vertex $\\mathbf{x}_3$. We can find this using the dot product of the vectors forming the angle:\n$$ \\mathbf{v}_{31} = \\mathbf{x}_1 - \\mathbf{x}_3 = (0-0.5, \\, 0-0.1) = (-0.5, -0.1) $$\n$$ \\mathbf{v}_{32} = \\mathbf{x}_2 - \\mathbf{x}_3 = (1-0.5, \\, 0-0.1) = (0.5, -0.1) $$\nThe cosine of the angle $\\theta_3$ is:\n$$ \\cos \\theta_3 = \\frac{\\mathbf{v}_{31} \\cdot \\mathbf{v}_{32}}{|\\mathbf{v}_{31}| |\\mathbf{v}_{32}|} = \\frac{(-0.5)(0.5) + (-0.1)(-0.1)}{\\sqrt{(-0.5)^2 + (-0.1)^2} \\sqrt{(0.5)^2 + (-0.1)^2}} = \\frac{-0.25 + 0.01}{0.25 + 0.01} = \\frac{-0.24}{0.26} = -\\frac{12}{13} $$\nSince $\\cos \\theta_3 < 0$, the angle $\\theta_3$ is obtuse. To find the cotangent, we first find the sine:\n$$ \\sin \\theta_3 = \\sqrt{1 - \\cos^2 \\theta_3} = \\sqrt{1 - \\left(-\\frac{12}{13}\\right)^2} = \\sqrt{1 - \\frac{144}{169}} = \\sqrt{\\frac{25}{169}} = \\frac{5}{13} $$\nThe cotangent is:\n$$ \\cot \\theta_3 = \\frac{\\cos \\theta_3}{\\sin \\theta_3} = \\frac{-12/13}{5/13} = -\\frac{12}{5} = -2.4 $$\nNow we calculate the stiffness contribution from $T_1$:\n$$ K_{12}^{T_1} = -k \\frac{\\cot \\theta_3}{2} = -(1) \\frac{-2.4}{2} = 1.2 $$\n\nFor triangle $T_2 = (1,2,4)$:\nThe vertices are $\\mathbf{x}_1=(0,0)$, $\\mathbf{x}_2=(1,0)$, and $\\mathbf{x}_4=(0.5,\\,-0.1)$. This triangle is a mirror image of $T_1$ across the x-axis. By symmetry, the angle $\\theta_4$ at vertex $\\mathbf{x}_4$ is equal to $\\theta_3$. Therefore, $\\cot \\theta_4 = -2.4$.\nThe stiffness contribution from $T_2$ is:\n$$ K_{12}^{T_2} = -k \\frac{\\cot \\theta_4}{2} = -(1) \\frac{-2.4}{2} = 1.2 $$\n\nFinally, we assemble the global (patch) stiffness entry $K_{12}$ by summing the contributions:\n$$ K_{12} = K_{12}^{T_1} + K_{12}^{T_2} = 1.2 + 1.2 = 2.4 $$\nThe result is that the off-diagonal stiffness entry $K_{12}$ is strictly positive.\n\nThe fully discrete system for the backward Euler method is $(M + \\Delta t\\,K)\\,\\mathbf{u}^{n+1} = M\\,\\mathbf{u}^n + \\Delta t\\,\\mathbf{F}^{n+1}$. Let $A = M + \\Delta t\\,K$ be the system matrix. An M-matrix must have nonpositive off-diagonal entries. The off-diagonal entry $A_{12}$ is given by:\n$$ A_{12} = M_{12} + \\Delta t\\,K_{12} $$\nThe consistent mass matrix entry $M_{12}$ is greater than zero ($M_{12} = \\sum_e \\int_{T_e} c \\phi_1 \\phi_2 d\\Omega > 0$). With $c=1$, $M_{12} = M_{12}^{T_1} + M_{12}^{T_2} = \\frac{1 \\cdot \\text{Area}(T_1)}{12} + \\frac{1 \\cdot \\text{Area}(T_2)}{12} = \\frac{0.05}{12} + \\frac{0.05}{12} = \\frac{0.1}{12} > 0$.\nSince $M_{12} > 0$, $K_{12} = 2.4 > 0$, and $\\Delta t > 0$, the off-diagonal entry $A_{12}$ is strictly positive for any choice of $\\Delta t > 0$.\n$$ A_{12} = M_{12} + 2.4\\,\\Delta t > 0 $$\nThe system matrix $A$ is not an M-matrix. The discrete maximum principle, which prevents spurious oscillations, is therefore not guaranteed to hold.\n\nNow, we evaluate each of the given options.\n\nA. For this mesh, the assembled stiffness off-diagonal $K_{12}$ is strictly positive, violating the M-matrix property for the spatial operator and enabling overshoots near the interior edge in backward Euler solutions.\nOur calculation shows $K_{12}=2.4$, which is strictly positive. This violates the necessary condition ($K_{ij} \\le 0$ for $i \\ne j$) for the stiffness matrix to be related to an M-matrix. The resulting backward Euler system matrix $A=M+\\Delta t K$ will also have a positive off-diagonal $A_{12}$, meaning it is not an M-matrix. The absence of the M-matrix property is known to permit non-physical overshoots and undershoots in the numerical solution. This statement is therefore accurate.\n**Verdict: Correct.**\n\nB. Using mass lumping (diagonal $M$) guarantees that $(M+\\Delta t\\,K)$ has nonpositive off-diagonals even on obtuse triangles, so the discrete maximum principle holds.\nIf mass lumping is used, the mass matrix $M$ becomes diagonal, so its off-diagonal entries are zero, i.e., $M_{12}=0$. The system matrix off-diagonal entry becomes $A_{12} = 0 + \\Delta t\\,K_{12} = \\Delta t(2.4)$. Since $\\Delta t > 0$ and $K_{12} > 0$, $A_{12}$ remains strictly positive. The statement that the off-diagonals become nonpositive is false. Consequently, the discrete maximum principle is not guaranteed.\n**Verdict: Incorrect.**\n\nC. Decreasing the time step $\\Delta t$ alone cannot guarantee removal of overshoots on a fixed mesh if some stiffness off-diagonals are positive; the violation is geometric in origin.\nThe positivity of $K_{12}$ is a direct consequence of the obtuse angles in the mesh triangles, a purely geometric property. As shown, the system matrix off-diagonal is $A_{12} = M_{12} + \\Delta t\\,K_{12}$. Since both $M_{12}$ (whether consistent or lumped) and $K_{12}$ are non-negative, and at least $K_{12}$ is strictly positive, $A_{12}$ is strictly positive for any $\\Delta t > 0$. Reducing $\\Delta t$ shrinks the magnitude of the $\\Delta t K_{12}$ term but does not change its sign. The M-matrix condition remains violated for all $\\Delta t >0$. The root cause is the mesh geometry, not the time step size.\n**Verdict: Correct.**\n\nD. Remeshing to an acute or Delaunay triangulation (by appropriate edge flips) restores nonpositive stiffness off-diagonals and the monotonicity needed for the discrete maximum principle.\nAn off-diagonal entry $K_{ij}$ assembled from triangles sharing edge $(i,j)$ is nonpositive ($K_{ij} \\le 0$) if and only if the sum of the cotangents of the angles opposite the edge is non-negative. This condition is equivalent to requiring the sum of the opposite angles to be less than or equal to $\\pi$ ($180^\\circ$), which is precisely the Delaunay condition for that edge. A triangulation where this holds for all interior edges is a Delaunay triangulation. Creating a mesh composed entirely of acute (or non-obtuse) triangles is a stricter condition that also guarantees $K_{ij} \\le 0$ for all $i \\ne j$. Therefore, remeshing to satisfy either the Delaunay or the non-obtuse angle condition will ensure all off-diagonal stiffness entries are nonpositive. This restores the M-matrix property for the system matrix (with a suitable mass matrix, like lumped mass) and thus the discrete maximum principle.\n**Verdict: Correct.**", "answer": "$$\\boxed{ACD}$$", "id": "3594914"}, {"introduction": "Beyond mesh geometry, the accuracy of a finite element simulation is also governed by how we approximate the integrals that define the mass and stiffness matrices. While exact integration is theoretically ideal, computationally cheaper alternatives like reduced-integration quadrature are common, which often leads to a diagonal or \"lumped\" mass matrix. This exercise [@problem_id:3594966] moves from geometric considerations to algebraic ones, using discrete Fourier analysis to precisely quantify the consequences of this choice. By deriving the eigenvalues of the discrete diffusion operator, you will uncover how mass lumping distorts the numerical wave propagation speeds, selectively damping or accelerating different modes compared to the exactly integrated system.", "problem": "Consider one-dimensional heat diffusion in a homogeneous medium representative of a lithospheric transect with periodic boundary conditions. The governing equation is the parabolic partial differential equation $u_{t} = \\kappa u_{xx}$ on the domain $x \\in [0,L]$, where $\\kappa>0$ is constant. Let $V_{h}$ be the space of continuous, piecewise-linear functions on a uniform mesh with $N$ elements of size $h=L/N$. The standard Galerkin semi-discretization yields the matrix ordinary differential equation $M \\dot{\\mathbf{u}} + K \\mathbf{u} = \\mathbf{0}$, where the mass matrix $M$ and stiffness matrix $K$ have entries $M_{ij} = \\int_{0}^{L} \\phi_{i} \\phi_{j} \\, \\mathrm{d}x$ and $K_{ij} = \\kappa \\int_{0}^{L} \\phi_{i}' \\phi_{j}' \\, \\mathrm{d}x$, with $\\{\\phi_{i}\\}$ denoting the standard hat basis functions.\n\nDefine the discrete diffusion operator $A = M^{-1}K$ and assume periodic boundary conditions so that the discrete Fourier modes are eigenvectors of circulant matrices arising from uniform assembly. Let $K$ be integrated exactly. Consider two choices for $M$: the exactly integrated mass matrix $M^{\\mathrm{ex}}$ and a reduced-integration mass matrix $M^{\\mathrm{ri}}$ computed by a single Gauss point per element located at the element center.\n\nUsing only fundamental definitions of the Galerkin method, element assembly on a uniform mesh, and discrete Fourier analysis of circulant matrices, derive the exact expressions for the eigenvalues $\\lambda^{\\mathrm{ex}}(\\theta)$ and $\\lambda^{\\mathrm{ri}}(\\theta)$ of $A$ corresponding to the nondimensional wavenumber $\\theta \\in (0,\\pi)$, where $\\theta = 2\\pi m/N$ for some integer $m \\in \\{1,2,\\dots,N-1\\}$ and $m \\neq N/2$ when $N$ is even. From these, determine the exact multiplicative distortion factor\n$$\nR(\\theta) = \\frac{\\lambda^{\\mathrm{ri}}(\\theta)}{\\lambda^{\\mathrm{ex}}(\\theta)}\n$$\nthat isolates the impact of the quadrature-induced consistency error in the mass matrix on the eigenvalues of the discrete diffusion operator. Provide $R(\\theta)$ as a closed-form analytic expression in terms of $\\theta$ only. No numerical approximation or rounding is required. Express the final answer as an exact symbolic expression without units.", "solution": "The problem asks for the ratio of eigenvalues of the discrete diffusion operator $A = M^{-1}K$ under two different choices for the mass matrix $M$. The discretization is performed on a uniform mesh with $N$ elements of size $h = L/N$ under periodic boundary conditions. This setup ensures that the global stiffness matrix $K$ and both mass matrices ($M^{\\mathrm{ex}}$ for exact integration and $M^{\\mathrm{ri}}$ for reduced integration) are circulant matrices.\n\nA fundamental property of circulant matrices is that they are diagonalized by the discrete Fourier transform. This means they all share the same set of eigenvectors, which are the discrete Fourier modes $\\mathbf{v}_m$ with components $(\\mathbf{v}_m)_j = \\exp(i j \\theta)$, where $\\theta = 2\\pi m / N$ is the nondimensional wavenumber for mode $m$. If $\\hat{K}(\\theta)$ and $\\hat{M}(\\theta)$ are the eigenvalues of $K$ and $M$ corresponding to the eigenvector for wavenumber $\\theta$, then the eigenvalue $\\lambda(\\theta)$ of the operator $A = M^{-1}K$ is given by the ratio of these eigenvalues:\n$$\nA \\mathbf{v} = M^{-1}K \\mathbf{v} = M^{-1}(\\hat{K}(\\theta)\\mathbf{v}) = \\hat{K}(\\theta) M^{-1}\\mathbf{v} = \\hat{K}(\\theta) \\frac{1}{\\hat{M}(\\theta)} \\mathbf{v} = \\frac{\\hat{K}(\\theta)}{\\hat{M}(\\theta)} \\mathbf{v}\n$$\nThus, $\\lambda(\\theta) = \\frac{\\hat{K}(\\theta)}{\\hat{M}(\\theta)}$.\n\nThe two sets of eigenvalues for the discrete diffusion operator are:\n$$\n\\lambda^{\\mathrm{ex}}(\\theta) = \\frac{\\hat{K}(\\theta)}{\\hat{M}^{\\mathrm{ex}}(\\theta)} \\quad \\text{and} \\quad \\lambda^{\\mathrm{ri}}(\\theta) = \\frac{\\hat{K}(\\theta)}{\\hat{M}^{\\mathrm{ri}}(\\theta)}\n$$\nThe required distortion factor $R(\\theta)$ is their ratio:\n$$\nR(\\theta) = \\frac{\\lambda^{\\mathrm{ri}}(\\theta)}{\\lambda^{\\mathrm{ex}}(\\theta)} = \\frac{\\hat{K}(\\theta) / \\hat{M}^{\\mathrm{ri}}(\\theta)}{\\hat{K}(\\theta) / \\hat{M}^{\\mathrm{ex}}(\\theta)} = \\frac{\\hat{M}^{\\mathrm{ex}}(\\theta)}{\\hat{M}^{\\mathrm{ri}}(\\theta)}\n$$\nThis result significantly simplifies the problem, as it shows the stiffness matrix properties cancel out, and we only need to compare the eigenvalues of the two mass matrices. To be complete, as requested by the problem statement, we will derive the eigenvalues for all three matrices ($K$, $M^{\\mathrm{ex}}$, $M^{\\mathrm{ri}}$) before computing the final ratio.\n\nFirst, we compute the element matrices for a generic element $[x_j, x_{j+1}]$ of length $h$. The local basis functions are the linear \"hat\" functions, which on this element are $n_j(x) = (x_{j+1}-x)/h$ and $n_{j+1}(x) = (x-x_j)/h$. Their derivatives are $n_j'(x) = -1/h$ and $n_{j+1}'(x) = 1/h$.\n\nThe element stiffness matrix $K^e$ has entries $K^e_{ab} = \\int_{x_j}^{x_{j+1}} \\kappa \\, n'_a(x) n'_b(x) \\, \\mathrm{d}x$:\n$K^e_{11} = \\int_{x_j}^{x_{j+1}} \\kappa (-\\frac{1}{h})^2 \\, \\mathrm{d}x = \\frac{\\kappa}{h^2} h = \\frac{\\kappa}{h}$.\n$K^e_{12} = \\int_{x_j}^{x_{j+1}} \\kappa (-\\frac{1}{h})(\\frac{1}{h}) \\, \\mathrm{d}x = -\\frac{\\kappa}{h}$.\nBy symmetry, $K^e_{21} = -\\frac{\\kappa}{h}$ and $K^e_{22} = \\frac{\\kappa}{h}$.\n$$\nK^e = \\frac{\\kappa}{h} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}\n$$\n\nThe exactly integrated element mass matrix $M^{e, \\mathrm{ex}}$ has entries $M^{e, \\mathrm{ex}}_{ab} = \\int_{x_j}^{x_{j+1}} n_a(x) n_b(x) \\, \\mathrm{d}x$:\n$M^{e, \\mathrm{ex}}_{11} = \\int_{x_j}^{x_{j+1}} \\left(\\frac{x_{j+1}-x}{h}\\right)^2 \\, \\mathrm{d}x = \\frac{h}{3}$.\n$M^{e, \\mathrm{ex}}_{12} = \\int_{x_j}^{x_{j+1}} \\left(\\frac{x_{j+1}-x}{h}\\right)\\left(\\frac{x-x_j}{h}\\right) \\, \\mathrm{d}x = \\frac{h}{6}$.\nBy symmetry, $M^{e, \\mathrm{ex}}_{21} = \\frac{h}{6}$ and $M^{e, \\mathrm{ex}}_{22} = \\frac{h}{3}$.\n$$\nM^{e, \\mathrm{ex}} = \\frac{h}{6} \\begin{pmatrix} 2 & 1 \\\\ 1 & 2 \\end{pmatrix}\n$$\n\nThe reduced-integration element mass matrix $M^{e, \\mathrm{ri}}$ is computed using a single Gauss point at the element center $x_c = (x_j+x_{j+1})/2$. The quadrature rule is $\\int_{x_j}^{x_{j+1}} f(x) \\, \\mathrm{d}x \\approx h f(x_c)$. The integrand is $n_a(x)n_b(x)$. At $x_c$, we have $n_j(x_c) = 1/2$ and $n_{j+1}(x_c) = 1/2$.\n$M^{e, \\mathrm{ri}}_{11} \\approx h \\cdot n_j(x_c) \\cdot n_j(x_c) = h(\\frac{1}{2})(\\frac{1}{2}) = \\frac{h}{4}$.\n$M^{e, \\mathrm{ri}}_{12} \\approx h \\cdot n_j(x_c) \\cdot n_{j+1}(x_c) = h(\\frac{1}{2})(\\frac{1}{2}) = \\frac{h}{4}$.\nBy symmetry, $M^{e, \\mathrm{ri}}_{21} = M^{e, \\mathrm{ri}}_{22} = \\frac{h}{4}$.\n$$\nM^{e, \\mathrm{ri}} = \\frac{h}{4} \\begin{pmatrix} 1 & 1 \\\\ 1 & 1 \\end{pmatrix}\n$$\n\nNext, we assemble the global matrices. For a generic node $i$, the diagonal entry $C_{ii}$ of a global matrix $C$ is the sum of the local $C^e_{22}$ from the left element $[x_{i-1}, x_i]$ and $C^e_{11}$ from the right element $[x_i, x_{i+1}]$. The off-diagonal entry $C_{i, i+1}$ is the local $C^e_{12}$ from element $[x_i, x_{i+1}]$. The structure generates a symmetric tridiagonal circulant matrix defined by a stencil $(c_1, c_0, c_1)$, where $c_0$ is the main diagonal entry and $c_1$ is the off-diagonal entry.\n$c_0(C) = C^e_{11} + C^e_{22}$, $c_1(C) = C^e_{12}$.\n\nStencil for $K$: $c_0 = \\frac{\\kappa}{h} + \\frac{\\kappa}{h} = \\frac{2\\kappa}{h}$, $c_1 = -\\frac{\\kappa}{h}$. Stencil: $\\frac{\\kappa}{h}(-1, 2, -1)$.\nStencil for $M^{\\mathrm{ex}}$: $c_0 = \\frac{2h}{6} + \\frac{2h}{6} = \\frac{4h}{6}$, $c_1 = \\frac{h}{6}$. Stencil: $\\frac{h}{6}(1, 4, 1)$.\nStencil for $M^{\\mathrm{ri}}$: $c_0 = \\frac{h}{4} + \\frac{h}{4} = \\frac{2h}{4}$, $c_1 = \\frac{h}{4}$. Stencil: $\\frac{h}{4}(1, 2, 1)$.\n\nThe eigenvalue of a symmetric circulant matrix with stencil $(c_1, c_0, c_1)$ is $\\hat{C}(\\theta) = c_0 + 2c_1\\cos(\\theta)$.\nUsing this formula, we find the eigenvalues of our matrices:\n$\\hat{K}(\\theta) = \\frac{2\\kappa}{h} + 2(-\\frac{\\kappa}{h})\\cos(\\theta) = \\frac{2\\kappa}{h}(1 - \\cos(\\theta)) = \\frac{4\\kappa}{h}\\sin^2(\\frac{\\theta}{2})$.\n$\\hat{M}^{\\mathrm{ex}}(\\theta) = \\frac{4h}{6} + 2(\\frac{h}{6})\\cos(\\theta) = \\frac{h}{3}(2 + \\cos(\\theta))$.\n$\\hat{M}^{\\mathrm{ri}}(\\theta) = \\frac{2h}{4} + 2(\\frac{h}{4})\\cos(\\theta) = \\frac{h}{2}(1 + \\cos(\\theta))$.\n\nNow we can write the expressions for $\\lambda^{\\mathrm{ex}}(\\theta)$ and $\\lambda^{\\mathrm{ri}}(\\theta)$:\n$$\n\\lambda^{\\mathrm{ex}}(\\theta) = \\frac{\\hat{K}(\\theta)}{\\hat{M}^{\\mathrm{ex}}(\\theta)} = \\frac{\\frac{2\\kappa}{h}(1 - \\cos(\\theta))}{\\frac{h}{3}(2 + \\cos(\\theta))} = \\frac{6\\kappa}{h^2}\\frac{1 - \\cos(\\theta)}{2 + \\cos(\\theta)}\n$$\n$$\n\\lambda^{\\mathrm{ri}}(\\theta) = \\frac{\\hat{K}(\\theta)}{\\hat{M}^{\\mathrm{ri}}(\\theta)} = \\frac{\\frac{2\\kappa}{h}(1 - \\cos(\\theta))}{\\frac{h}{2}(1 + \\cos(\\theta))} = \\frac{4\\kappa}{h^2}\\frac{1 - \\cos(\\theta)}{1 + \\cos(\\theta)}\n$$\nFinally, we compute the distortion factor $R(\\theta)$:\n$$\nR(\\theta) = \\frac{\\lambda^{\\mathrm{ri}}(\\theta)}{\\lambda^{\\mathrm{ex}}(\\theta)} = \\frac{\\frac{4\\kappa}{h^2}\\frac{1 - \\cos(\\theta)}{1 + \\cos(\\theta)}}{\\frac{6\\kappa}{h^2}\\frac{1 - \\cos(\\theta)}{2 + \\cos(\\theta)}} = \\frac{4}{6} \\frac{2 + \\cos(\\theta)}{1 + \\cos(\\theta)}\n$$\nSimplifying the constant gives the final expression for the distortion factor:\n$$\nR(\\theta) = \\frac{2}{3} \\frac{2 + \\cos(\\theta)}{1 + \\cos(\\theta)}\n$$\nThis expression is a function of $\\theta$ only, as required, isolating the spectral distortion due to the quadrature error in the mass matrix. The denominator $1+\\cos(\\theta)$ is non-zero for the specified range $\\theta \\in (0, \\pi)$.", "answer": "$$\n\\boxed{\\frac{2(2+\\cos(\\theta))}{3(1+\\cos(\\theta))}}\n$$", "id": "3594966"}, {"introduction": "While classical methods often discretize space first and then march forward in time, modern space-time finite element methods treat space and time as a unified domain. This monolithic approach can offer superior accuracy and unlock possibilities for parallel computation across the time dimension. This practice [@problem_id:3594901] takes you to the frontier of these advanced techniques by guiding you through the assembly of a space-time system matrix for a discontinuous Galerkin (dG) method in time. By constructing the block matrix over two time intervals, you will see firsthand how information is propagated and how the characteristic block-banded structure of space-time methods emerges from the underlying weak formulation.", "problem": "A transient heat diffusion process in a homogeneous, isotropic geologic formation is modeled on a bounded Lipschitz domain $\\Omega \\subset \\mathbb{R}^{d}$ with $d \\in \\{2,3\\}$ by the partial differential equation (PDE)\n$$\n\\rho c \\,\\partial_{t} u(\\boldsymbol{x},t) - \\nabla \\cdot \\big(\\kappa \\nabla u(\\boldsymbol{x},t)\\big) = s(\\boldsymbol{x},t) \\quad \\text{in } \\Omega \\times (0,T],\n$$\nwith homogeneous Dirichlet boundary conditions $u(\\boldsymbol{x},t) = 0$ on $\\partial \\Omega \\times (0,T]$ and a given initial condition $u(\\boldsymbol{x},0) = u_{0}(\\boldsymbol{x})$ in $\\Omega$. Here $\\rho$ is the density, $c$ is the specific heat, $\\kappa$ is the thermal conductivity, and $s$ is a source term, all taken as positive and bounded functions or constants consistent with scientific realism in computational geophysics. Using the finite element method (FEM) with piecewise linear ($P_1$) shape functions on a conforming simplicial mesh of $\\Omega$, the semi-discrete spatial system can be written in the form\n$$\nM \\,\\frac{\\mathrm{d}}{\\mathrm{d}t} U(t) + A \\,U(t) = F(t),\n$$\nwhere $U(t)$ is the vector of nodal values, $M$ is the symmetric positive-definite mass matrix with entries $M_{ij} = \\int_{\\Omega} \\rho c \\,\\varphi_{i} \\varphi_{j}\\,\\mathrm{d}\\boldsymbol{x}$, $A$ is the symmetric positive semi-definite stiffness matrix with entries $A_{ij} = \\int_{\\Omega} \\kappa \\,\\nabla \\varphi_{i} \\cdot \\nabla \\varphi_{j}\\,\\mathrm{d}\\boldsymbol{x}$, and $F(t)$ is the load vector with entries $F_{i}(t) = \\int_{\\Omega} s(\\boldsymbol{x},t)\\,\\varphi_{i}(\\boldsymbol{x})\\,\\mathrm{d}\\boldsymbol{x}$. Consider a discontinuous Galerkin of degree $1$ (dG($1$)) time discretization over $2$ consecutive time intervals $I_{1} = (t_{0},t_{1}]$ and $I_{2} = (t_{1},t_{2}]$ with a uniform time step $\\Delta t = t_{n} - t_{n-1}$. On each interval $I_{n}$, approximate $U(t)$ by\n$$\nU_{h}(t)\\big|_{I_{n}} = U_{n,0}\\,\\psi_{0}(s) + U_{n,1}\\,\\psi_{1}(s), \\quad s = \\frac{t - t_{n-1}}{\\Delta t} \\in [0,1],\n$$\nwhere $\\psi_{0}(s) = 1 - s$ and $\\psi_{1}(s) = s$ are the local time basis functions and $U_{n,0},U_{n,1}$ are the spatial coefficient vectors on $I_{n}$. Use the standard broken-in-time Galerkin weak form with upwind interface flux, in which the jump term at the left endpoint $t_{n-1}$ is included in the test functional as $\\langle M [U_{h}]_{n-1}, V_{h}(t_{n-1}^{+}) \\rangle$, where $[U_{h}]_{n-1} = U_{h}(t_{n-1}^{+}) - U_{h}(t_{n-1}^{-})$. Taking time test functions from the same local polynomial space spanned by $\\{\\psi_{0},\\psi_{1}\\}$ on each interval and assembling over $I_{1}$ and $I_{2}$, derive the global block spaceâ€“time linear system that maps the stacked unknown vector $(U_{1,0},U_{1,1},U_{2,0},U_{2,1})$ to the residual, expressed in terms of the spatial mass matrix $M$, the spatial stiffness matrix $A$, and the uniform time step $\\Delta t$ only. Clearly indicate the block-banded structure arising from the interface coupling between $I_{1}$ and $I_{2}$. Write your final answer as a single matrix expression in terms of $M$, $A$, and $\\Delta t$. No numerical rounding is required.", "solution": "The problem is well-posed and scientifically grounded, providing a complete specification for deriving a linear system from the discontinuous Galerkin (dG) time discretization of a semi-discretized heat equation. We proceed with the derivation.\n\nThe semi-discrete system is given by the ordinary differential equation (ODE) in time:\n$$\nM \\,\\frac{\\mathrm{d}}{\\mathrm{d}t} U(t) + A \\,U(t) = F(t)\n$$\nWe seek to solve this system using the discontinuous Galerkin method of degree $1$ (dG($1$)) over two consecutive time intervals $I_{1} = (t_{0},t_{1}]$ and $I_{2} = (t_{1},t_{2}]$, with a uniform time step $\\Delta t = t_{n} - t_{n-1}$. The problem asks for the matrix operator mapping the unknown solution coefficients to the residual, ignoring the source term $F(t)$ and initial condition $u_0$.\n\nThe weak formulation for the dG method, summed over the intervals $I_n$ for $n \\in \\{1,2\\}$, is: Find $U_h(t)$ such that for all suitable test functions $V_h(t)$,\n$$\n\\sum_{n=1}^{2} \\int_{I_{n}} V_h(t)^T \\left( M \\frac{\\mathrm{d}U_h}{\\mathrm{d}t} + A U_h \\right) \\mathrm{d}t + V_h(t_0^+)^T M [U_h]_{0} + V_h(t_1^+)^T M [U_h]_{1} = 0\n$$\nwhere we have set the source term to zero as per the problem's requirement to find the system operator. The jump at time $t_{n-1}$ is defined as $[U_h]_{n-1} = U_h(t_{n-1}^{+}) - U_h(t_{n-1}^{-})$. For our two intervals, the jumps are $[U_h]_{0} = U_h(t_0^+) - U_h(t_0^-)$ and $[U_h]_{1} = U_h(t_1^+) - U_h(t_1^-)$.\n\nOn each interval $I_n = (t_{n-1}, t_n]$, the solution $U_h(t)$ is approximated by a linear polynomial in time:\n$$\nU_{h}(t)\\big|_{I_{n}} = U_{n,0}\\,\\psi_{0}(s) + U_{n,1}\\,\\psi_{1}(s)\n$$\nwhere $s = \\frac{t - t_{n-1}}{\\Delta t} \\in [0,1]$ is the local coordinate, and the basis functions are $\\psi_{0}(s) = 1 - s$ and $\\psi_{1}(s) = s$. The unknown vectors $U_{n,0}$ and $U_{n,1}$ represent the spatial degrees of freedom at the start and end of the interval $I_n$, respectively. Specifically, $U_h(t_{n-1}^+) = U_{n,0}$ and $U_h(t_n^-) = U_{n,1}$. The time derivative on $I_n$ is constant:\n$$\n\\frac{\\mathrm{d}U_h}{\\mathrm{d}t} = \\frac{1}{\\Delta t} \\frac{\\mathrm{d}U_h}{\\mathrm{d}s} = \\frac{1}{\\Delta t} (U_{n,1} - U_{n,0})\n$$\nThe test functions $V_h(t)$ are chosen from the same space. The global unknown vector is $\\mathcal{U} = (U_{1,0}, U_{1,1}, U_{2,0}, U_{2,1})^T$. We derive the system by testing against a basis for the test space. This space is spanned by functions that are non-zero only on a single interval $I_n$ and are one of the local basis functions $\\psi_k(s)$.\n\nLet us define the change of variables $t = t_{n-1} + s \\Delta t$, so $\\mathrm{d}t = \\Delta t \\mathrm{d}s$. The weak form over a single interval $I_n$ with a test function $V_h(t) = W \\psi_k(s)$ (where $W$ is an arbitrary vector of spatial coefficients) becomes:\n$$\n\\int_{0}^{1} W^T \\psi_k(s) \\left( M \\frac{U_{n,1}-U_{n,0}}{\\Delta t} + A (U_{n,0}\\psi_0(s) + U_{n,1}\\psi_1(s)) \\right) \\Delta t \\mathrm{d}s + W^T \\psi_k(0) M (U_{n,0} - U_{n-1,1}) = 0\n$$\nSince this holds for any $W$, we can write the equation in terms of the vector unknowns:\n$$\n\\int_{0}^{1} \\psi_k(s) \\left( M(U_{n,1}-U_{n,0}) + \\Delta t A (U_{n,0}\\psi_0(s) + U_{n,1}\\psi_1(s)) \\right) \\mathrm{d}s + \\psi_k(0) M (U_{n,0} - U_{n-1,1}) = 0\n$$\nNote that $U_{h}(t_{n-1}^{-}) = U_{n-1,1}$. The term $U_{0,1}$ corresponds to the initial condition $U_h(t_0^-) = u_0(\\boldsymbol{x})$, which is moved to the right-hand side and does not form part of the system matrix.\n\nWe require the following integrals of the time basis functions over $[0,1]$:\n$$\n\\int_0^1 \\psi_0(s) \\mathrm{d}s = \\frac{1}{2}, \\quad \\int_0^1 \\psi_1(s) \\mathrm{d}s = \\frac{1}{2}\n$$\n$$\n\\int_0^1 \\psi_0(s)^2 \\mathrm{d}s = \\frac{1}{3}, \\quad \\int_0^1 \\psi_1(s)^2 \\mathrm{d}s = \\frac{1}{3}, \\quad \\int_0^1 \\psi_0(s)\\psi_1(s) \\mathrm{d}s = \\frac{1}{6}\n$$\n\nWe generate four equations by testing on $I_1$ and $I_2$ with $\\psi_0$ and $\\psi_1$.\n\n1. Test on $I_1$ with $\\psi_0(s)$: $n=1$, $k=0$. Here $\\psi_0(0)=1$ and $U_{0,1} = U_h(t_0^-)$ is the initial condition.\n$$\nM(U_{1,1}-U_{1,0})\\int_0^1\\psi_0 \\mathrm{d}s + \\Delta t A(U_{1,0}\\int_0^1\\psi_0^2 \\mathrm{d}s + U_{1,1}\\int_0^1\\psi_0\\psi_1 \\mathrm{d}s) + M(U_{1,0}-U_h(t_0^-)) = 0\n$$\n$$\n\\frac{1}{2}M(U_{1,1}-U_{1,0}) + \\Delta t A(\\frac{1}{3}U_{1,0} + \\frac{1}{6}U_{1,1}) + M U_{1,0} = M U_h(t_0^-)\n$$\nCollecting terms for the unknowns gives the first block row:\n$$\n(\\frac{1}{2}M + \\frac{1}{3}\\Delta t A)U_{1,0} + (\\frac{1}{2}M + \\frac{1}{6}\\Delta t A)U_{1,1} = M U_h(t_0^-)\n$$\n\n2. Test on $I_1$ with $\\psi_1(s)$: $n=1$, $k=1$. Here $\\psi_1(0)=0$.\n$$\nM(U_{1,1}-U_{1,0})\\int_0^1\\psi_1 \\mathrm{d}s + \\Delta t A(U_{1,0}\\int_0^1\\psi_1\\psi_0 \\mathrm{d}s + U_{1,1}\\int_0^1\\psi_1^2 \\mathrm{d}s) = 0\n$$\n$$\n\\frac{1}{2}M(U_{1,1}-U_{1,0}) + \\Delta t A(\\frac{1}{6}U_{1,0} + \\frac{1}{3}U_{1,1}) = 0\n$$\nCollecting terms gives the second block row:\n$$\n(-\\frac{1}{2}M + \\frac{1}{6}\\Delta t A)U_{1,0} + (\\frac{1}{2}M + \\frac{1}{3}\\Delta t A)U_{1,1} = 0\n$$\n\n3. Test on $I_2$ with $\\psi_0(s)$: $n=2$, $k=0$. Here $\\psi_0(0)=1$ and $U_{1,1} = U_h(t_1^-)$.\n$$\nM(U_{2,1}-U_{2,0})\\int_0^1\\psi_0 \\mathrm{d}s + \\Delta t A(U_{2,0}\\int_0^1\\psi_0^2 \\mathrm{d}s + U_{2,1}\\int_0^1\\psi_0\\psi_1 \\mathrm{d}s) + M(U_{2,0}-U_{1,1}) = 0\n$$\n$$\n\\frac{1}{2}M(U_{2,1}-U_{2,0}) + \\Delta t A(\\frac{1}{3}U_{2,0} + \\frac{1}{6}U_{2,1}) + M U_{2,0} - M U_{1,1} = 0\n$$\nCollecting terms for all unknowns gives the third block row of the global system:\n$$\n-M U_{1,1} + (\\frac{1}{2}M + \\frac{1}{3}\\Delta t A)U_{2,0} + (\\frac{1}{2}M + \\frac{1}{6}\\Delta t A)U_{2,1} = 0\n$$\n\n4. Test on $I_2$ with $\\psi_1(s)$: $n=2$, $k=1$. Here $\\psi_1(0)=0$.\n$$\nM(U_{2,1}-U_{2,0})\\int_0^1\\psi_1 \\mathrm{d}s + \\Delta t A(U_{2,0}\\int_0^1\\psi_1\\psi_0 \\mathrm{d}s + U_{2,1}\\int_0^1\\psi_1^2 \\mathrm{d}s) = 0\n$$\n$$\n\\frac{1}{2}M(U_{2,1}-U_{2,0}) + \\Delta t A(\\frac{1}{6}U_{2,0} + \\frac{1}{3}U_{2,1}) = 0\n$$\nCollecting terms gives the fourth block row:\n$$\n(-\\frac{1}{2}M + \\frac{1}{6}\\Delta t A)U_{2,0} + (\\frac{1}{2}M + \\frac{1}{3}\\Delta t A)U_{2,1} = 0\n$$\n\nAssembling these four equations into a single matrix system for the unknown vector $(U_{1,0}, U_{1,1}, U_{2,0}, U_{2,1})^T$ yields the requested block space-time matrix. The matrix maps the vector of unknowns to the residual, which contains terms from initial conditions and sources (here set to zero, except for the initial condition which does not affect the matrix itself). The resulting $4 \\times 4$ block matrix is:\n$$\n\\begin{pmatrix}\n\\frac{1}{2}M + \\frac{1}{3}\\Delta t A & \\frac{1}{2}M + \\frac{1}{6}\\Delta t A & 0 & 0 \\\\\n-\\frac{1}{2}M + \\frac{1}{6}\\Delta t A & \\frac{1}{2}M + \\frac{1}{3}\\Delta t A & 0 & 0 \\\\\n0 & -M & \\frac{1}{2}M + \\frac{1}{3}\\Delta t A & \\frac{1}{2}M + \\frac{1}{6}\\Delta t A \\\\\n0 & 0 & -\\frac{1}{2}M + \\frac{1}{6}\\Delta t A & \\frac{1}{2}M + \\frac{1}{3}\\Delta t A\n\\end{pmatrix}\n$$\nThis matrix has a distinct block-banded structure. The two diagonal $2 \\times 2$ blocks represent the intra-interval coupling for $I_1$ and $I_2$, while the off-diagonal block, $-M$, represents the inter-interval coupling from the upwind flux term at the time interface $t_1$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{1}{2}M + \\frac{1}{3}\\Delta t A & \\frac{1}{2}M + \\frac{1}{6}\\Delta t A & 0 & 0 \\\\\n-\\frac{1}{2}M + \\frac{1}{6}\\Delta t A & \\frac{1}{2}M + \\frac{1}{3}\\Delta t A & 0 & 0 \\\\\n0 & -M & \\frac{1}{2}M + \\frac{1}{3}\\Delta t A & \\frac{1}{2}M + \\frac{1}{6}\\Delta t A \\\\\n0 & 0 & -\\frac{1}{2}M + \\frac{1}{6}\\Delta t A & \\frac{1}{2}M + \\frac{1}{3}\\Delta t A\n\\end{pmatrix}\n}\n$$", "id": "3594901"}]}