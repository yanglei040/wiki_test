{"hands_on_practices": [{"introduction": "A crucial first step in mastering computational methods is understanding that a numerical scheme is not a perfect mirror of the partial differential equation it aims to solve. Discretization introduces errors, which can sometimes manifest in ways that surprisingly mimic physical phenomena. This exercise uses a powerful technique, modified equation analysis, to peel back the layers of a simple advection scheme and reveal its hidden behavior, a phenomenon known as numerical diffusion [@problem_id:3575280]. By working through this analysis, you will gain a concrete understanding of why low-order schemes tend to smear sharp gradients and how to quantify this effect.", "problem": "A one-dimensional passive tracer concentration field $c(x,t)$ is transported by a steady, positive velocity $u>0$ in a straight geophysical conduit of uniform cross section. The governing conservation law is the linear advection partial differential equation (PDE)\n$$\n\\frac{\\partial c}{\\partial t} + u\\,\\frac{\\partial c}{\\partial x} = 0,\n$$\nposed on a uniform grid with spacing $\\Delta x$. Consider a semi-discrete finite volume method (FVM) with first-order upwind numerical fluxes, so that for cell-averaged unknowns $c_i(t) \\approx c(x_i,t)$ the method-of-lines ordinary differential equation is\n$$\n\\frac{\\mathrm{d} c_i}{\\mathrm{d} t} = -\\frac{F_{i+1/2}-F_{i-1/2}}{\\Delta x},\n$$\nwith $F_{i+1/2} = u\\,c_i$ and $F_{i-1/2} = u\\,c_{i-1}$ under the assumption $u>0$.\n\nUsing only fundamental series expansions and keeping terms consistently through second spatial derivatives, perform a modified equation analysis by Taylor expanding $c_{i-1}(t)$ about $x_i$ to derive a continuous PDE that the semi-discrete scheme approximates to leading order. From the coefficient multiplying the term $\\partial^2 c/\\partial x^2$ in the resulting modified equation, identify the effective numerical diffusion coefficient $\\tilde{D}$ induced by the first-order upwind discretization.\n\nYour final answer must be a single closed-form analytic expression for $\\tilde{D}$ in terms of $u$ and $\\Delta x$. Express the effective diffusion coefficient in $\\mathrm{m}^2\\,\\mathrm{s}^{-1}$. Do not use any pre-tabulated truncation error formulas and do not assume any particular time integrator beyond the semi-discrete formulation described here. Do not include any intermediate or auxiliary quantities in your final answer.", "solution": "The analysis begins with the semi-discrete finite volume method (FVM) formulation provided for the one-dimensional linear advection equation. The governing ordinary differential equation (ODE) for the cell-averaged concentration $c_i(t)$ in cell $i$ is given by the method of lines:\n$$\n\\frac{\\mathrm{d} c_i}{\\mathrm{d} t} = -\\frac{F_{i+1/2}-F_{i-1/2}}{\\Delta x}\n$$\nThe problem specifies a first-order upwind numerical flux for a steady, positive velocity $u>0$. The fluxes at the cell interfaces $i+1/2$ and $i-1/2$ are:\n$$\nF_{i+1/2} = u\\,c_i\n$$\n$$\nF_{i-1/2} = u\\,c_{i-1}\n$$\nSubstituting these flux definitions into the semi-discrete FVM equation yields the specific ODE for the evolution of $c_i$:\n$$\n\\frac{\\mathrm{d} c_i}{\\mathrm{d} t} = -\\frac{u\\,c_i - u\\,c_{i-1}}{\\Delta x} = -u \\frac{c_i - c_{i-1}}{\\Delta x}\n$$\nTo derive the modified equation, we relate the discrete quantities in this equation to a continuous concentration field $c(x,t)$. We interpret $c_i(t)$ as the point value of the continuous function at the cell center, $c_i(t) \\equiv c(x_i, t)$. The term on the left-hand side, $\\frac{\\mathrm{d} c_i}{\\mathrm{d} t}$, is identified with the partial derivative with respect to time, $\\frac{\\partial c}{\\partial t}$, evaluated at $(x_i, t)$. The term $c_{i-1}(t)$ represents the concentration at the center of the adjacent upwind cell, $x_{i-1} = x_i - \\Delta x$. We use a Taylor series expansion to express $c_{i-1}(t) = c(x_i - \\Delta x, t)$ in terms of the concentration and its spatial derivatives at position $x_i$:\n$$\nc_{i-1} = c(x_i - \\Delta x, t) = c(x_i, t) - \\Delta x \\frac{\\partial c}{\\partial x}\\bigg|_{x_i} + \\frac{(\\Delta x)^2}{2!} \\frac{\\partial^2 c}{\\partial x^2}\\bigg|_{x_i} - \\mathcal{O}((\\Delta x)^3)\n$$\nThe problem requires retaining terms consistently through the second spatial derivative. Therefore, we substitute this expansion into the right-hand side of our semi-discrete equation. For clarity, we will omit the explicit evaluation notation $\\big|_{x_i}$ as it is understood that all spatial derivatives are evaluated at $x_i$.\n$$\n\\frac{\\partial c}{\\partial t} = -u \\frac{c_i - \\left( c_i - \\Delta x \\frac{\\partial c}{\\partial x} + \\frac{(\\Delta x)^2}{2} \\frac{\\partial^2 c}{\\partial x^2} - \\mathcal{O}((\\Delta x)^3) \\right)}{\\Delta x}\n$$\nSimplifying the numerator inside the parentheses:\n$$\nc_i - \\left( c_i - \\Delta x \\frac{\\partial c}{\\partial x} + \\frac{(\\Delta x)^2}{2} \\frac{\\partial^2 c}{\\partial x^2} - \\mathcal{O}((\\Delta x)^3) \\right) = \\Delta x \\frac{\\partial c}{\\partial x} - \\frac{(\\Delta x)^2}{2} \\frac{\\partial^2 c}{\\partial x^2} + \\mathcal{O}((\\Delta x)^3)\n$$\nNow, substitute this simplified expression back into the equation for $\\frac{\\partial c}{\\partial t}$:\n$$\n\\frac{\\partial c}{\\partial t} = - \\frac{u}{\\Delta x} \\left( \\Delta x \\frac{\\partial c}{\\partial x} - \\frac{(\\Delta x)^2}{2} \\frac{\\partial^2 c}{\\partial x^2} + \\mathcal{O}((\\Delta x)^3) \\right)\n$$\nDistributing the factor $-u/\\Delta x$ across the terms in the parenthesis gives:\n$$\n\\frac{\\partial c}{\\partial t} = -u \\frac{\\partial c}{\\partial x} + u \\frac{\\Delta x}{2} \\frac{\\partial^2 c}{\\partial x^2} - \\mathcal{O}((\\Delta x)^2)\n$$\nThis is the modified equation, representing the continuous PDE that is actually being solved by the semi-discrete scheme to leading order. We can rearrange this equation to better see the relationship to the original PDE:\n$$\n\\frac{\\partial c}{\\partial t} + u \\frac{\\partial c}{\\partial x} = u \\frac{\\Delta x}{2} \\frac{\\partial^2 c}{\\partial x^2} + \\mathcal{O}((\\Delta x)^2)\n$$\nThe left-hand side is the original linear advection equation, $\\frac{\\partial c}{\\partial t} + u \\frac{\\partial c}{\\partial x} = 0$. The leading-order truncation error term, which appears on the right-hand side, is $u \\frac{\\Delta x}{2} \\frac{\\partial^2 c}{\\partial x^2}$. This term has the mathematical form of a diffusion (or dissipation) term. The general form of an advection-diffusion equation is:\n$$\n\\frac{\\partial c}{\\partial t} + u \\frac{\\partial c}{\\partial x} = D \\frac{\\partial^2 c}{\\partial x^2}\n$$\nwhere $D$ is the diffusion coefficient. By comparing the modified equation with the general advection-diffusion equation, we can identify the effective numerical diffusion coefficient, denoted as $\\tilde{D}$, which is induced by the spatial discretization scheme.\nThe coefficient multiplying the term $\\frac{\\partial^2 c}{\\partial x^2}$ in our derived modified equation is $u \\frac{\\Delta x}{2}$. Therefore, the effective numerical diffusion coefficient is:\n$$\n\\tilde{D} = \\frac{u \\Delta x}{2}\n$$\nThis quantity has an adverse effect in numerical simulations, as it introduces artificial smearing or diffusion of sharp gradients in the concentration field, a well-known characteristic of first-order upwind schemes.", "answer": "$$\\boxed{\\frac{u \\Delta x}{2}}$$", "id": "3575280"}, {"introduction": "While modified equation analysis reveals the leading-order error, a more comprehensive picture of a scheme's performance requires understanding its effect on all components of the solution. Von Neumann analysis is a cornerstone of numerical methods for this purpose, treating the numerical solution as a sum of waves and examining how the scheme amplifies or dampens their amplitude and shifts their phase. This practice problem extends our analysis to a full advection-diffusion-reaction model, allowing you to derive the scheme's amplification factor and see how it governs both numerical stability and phase accuracyâ€”the key to preventing simulations from becoming unstable or producing non-physical oscillations [@problem_id:3575315].", "problem": "A saturated, homogeneous porous medium transports a conservative tracer subject to advection, molecular diffusion, and first-order decay. Consider one spatial dimension with uniform, steady pore velocity $a &gt; 0$, constant molecular diffusion coefficient $D \\ge 0$, and decay rate $r \\ge 0$. The linear advection-diffusion-reaction (ADR) model governing the concentration $c(x,t)$ is\n$$\n\\frac{\\partial c}{\\partial t} + a \\frac{\\partial c}{\\partial x} \\;=\\; D \\frac{\\partial^2 c}{\\partial x^2} \\;-\\; r\\,c\\,.\n$$\nOn an infinite uniform grid $x_j = j\\,\\Delta x$ and time levels $t^n = n\\,\\Delta t$, discretize this equation using forward Euler in time, first-order upwind for advection (appropriate for $a&gt;0$), second-order central differences for diffusion, and explicit reaction:\n$$\n\\frac{c_j^{n+1} - c_j^n}{\\Delta t} \\;+\\; a\\,\\frac{c_j^n - c_{j-1}^n}{\\Delta x} \\;=\\; D\\,\\frac{c_{j+1}^n - 2c_j^n + c_{j-1}^n}{\\Delta x^2} \\;-\\; r\\,c_j^n\\,.\n$$\nDefine the dimensionless parameters (commonly known in transport and stability analysis) $C = a\\,\\Delta t/\\Delta x$, $\\mu = D\\,\\Delta t/\\Delta x^2$, and $\\lambda = r\\,\\Delta t$. Assume an infinite or periodic domain so that a von Neumann Fourier analysis is appropriate, and consider a single Fourier mode with grid wavenumber $\\theta \\in \\mathbb{R}$ (in radians), of the form $c_j^n = \\hat{c}^n \\exp(i\\,j\\,\\theta)$ with $i^2=-1$.\n\nStarting from the conservation law statement above and the given finite-difference discretization, perform a von Neumann analysis to:\n- derive the one-step amplification factor $G(\\theta)$ defined by $\\hat{c}^{n+1} = G(\\theta)\\,\\hat{c}^n$,\n- identify, in terms of $G(\\theta)$, how magnitude and argument control stability and phase errors for this scheme.\n\nExpress your final answer as a single closed-form analytic expression for the amplification factor $G(\\theta)$ in terms of $\\theta$, $C$, $\\mu$, and $\\lambda$. No numerical evaluation is required. State angles in radians. Do not include any inequalities in your final answer.", "solution": "The task is to perform a von Neumann stability analysis on a given finite difference scheme for the one-dimensional advection-diffusion-reaction (ADR) equation. We need to derive the amplification factor $G(\\theta)$ and discuss its role in controlling stability and phase error.\n\nThe governing partial differential equation (PDE) is:\n$$\n\\frac{\\partial c}{\\partial t} + a \\frac{\\partial c}{\\partial x} \\;=\\; D \\frac{\\partial^2 c}{\\partial x^2} \\;-\\; r\\,c\n$$\nThe provided finite difference equation (FDE) discretizes this PDE:\n$$\n\\frac{c_j^{n+1} - c_j^n}{\\Delta t} \\;+\\; a\\,\\frac{c_j^n - c_{j-1}^n}{\\Delta x} \\;=\\; D\\,\\frac{c_{j+1}^n - 2c_j^n + c_{j-1}^n}{\\Delta x^2} \\;-\\; r\\,c_j^n\n$$\nHere, $c_j^n$ approximates the concentration $c(x_j, t^n)$ at grid point $x_j = j\\,\\Delta x$ and time level $t^n = n\\,\\Delta t$.\n\nFor the von Neumann analysis, we substitute a single Fourier mode ansatz, $c_j^n = \\hat{c}^n \\exp(i\\,j\\,\\theta)$, into the FDE. The term $\\hat{c}^n$ is the amplitude of the mode at time level $n$, $i$ is the imaginary unit ($i^2 = -1$), $j$ is the spatial grid index, and $\\theta = k\\,\\Delta x$ is the dimensionless grid wavenumber for a continuous wavenumber $k$.\n\nWe express each term in the FDE using this ansatz:\n- $c_j^{n+1} = \\hat{c}^{n+1} \\exp(i\\,j\\,\\theta)$\n- $c_j^n = \\hat{c}^n \\exp(i\\,j\\,\\theta)$\n- $c_{j-1}^n = \\hat{c}^n \\exp(i\\,(j-1)\\,\\theta) = \\hat{c}^n \\exp(i\\,j\\,\\theta) \\exp(-i\\,\\theta)$\n- $c_{j+1}^n = \\hat{c}^n \\exp(i\\,(j+1)\\,\\theta) = \\hat{c}^n \\exp(i\\,j\\,\\theta) \\exp(i\\,\\theta)$\n\nSubstituting these expressions into the FDE yields:\n$$\n\\frac{\\hat{c}^{n+1} e^{ij\\theta} - \\hat{c}^n e^{ij\\theta}}{\\Delta t} + a\\,\\frac{\\hat{c}^n e^{ij\\theta} - \\hat{c}^n e^{ij\\theta}e^{-i\\theta}}{\\Delta x} = D\\,\\frac{\\hat{c}^n e^{ij\\theta}e^{i\\theta} - 2\\hat{c}^n e^{ij\\theta} + \\hat{c}^n e^{ij\\theta}e^{-i\\theta}}{\\Delta x^2} - r\\,\\hat{c}^n e^{ij\\theta}\n$$\nThe common factor $\\exp(i\\,j\\,\\theta)$ is non-zero and can be divided out from every term:\n$$\n\\frac{\\hat{c}^{n+1} - \\hat{c}^n}{\\Delta t} + a\\,\\frac{\\hat{c}^n(1 - e^{-i\\theta})}{\\Delta x} = D\\,\\frac{\\hat{c}^n(e^{i\\theta} - 2 + e^{-i\\theta})}{\\Delta x^2} - r\\,\\hat{c}^n\n$$\nThe amplification factor $G(\\theta)$ is defined by the relation $\\hat{c}^{n+1} = G(\\theta)\\,\\hat{c}^n$. We rearrange the equation to solve for the ratio $\\hat{c}^{n+1} / \\hat{c}^n$.\nFirst, isolate the $\\hat{c}^{n+1}$ term:\n$$\n\\frac{\\hat{c}^{n+1}}{\\Delta t} = \\frac{\\hat{c}^n}{\\Delta t} - a\\,\\frac{\\hat{c}^n(1 - e^{-i\\theta})}{\\Delta x} + D\\,\\frac{\\hat{c}^n(e^{i\\theta} - 2 + e^{-i\\theta})}{\\Delta x^2} - r\\,\\hat{c}^n\n$$\nFactor out $\\hat{c}^n$ on the right-hand side:\n$$\n\\frac{\\hat{c}^{n+1}}{\\Delta t} = \\hat{c}^n \\left[ \\frac{1}{\\Delta t} - \\frac{a}{\\Delta x}(1 - e^{-i\\theta}) + \\frac{D}{\\Delta x^2}(e^{i\\theta} - 2 + e^{-i\\theta}) - r \\right]\n$$\nMultiply both sides by $\\Delta t$:\n$$\n\\hat{c}^{n+1} = \\hat{c}^n \\left[ 1 - \\frac{a\\Delta t}{\\Delta x}(1 - e^{-i\\theta}) + \\frac{D\\Delta t}{\\Delta x^2}(e^{i\\theta} - 2 + e^{-i\\theta}) - r\\Delta t \\right]\n$$\nBy definition, $G(\\theta) = \\hat{c}^{n+1}/\\hat{c}^n$, so the amplification factor is the expression in the brackets. We now substitute the given dimensionless parameters: the Courant number $C = a\\,\\Delta t/\\Delta x$, the diffusion number $\\mu = D\\,\\Delta t/\\Delta x^2$, and the reaction number $\\lambda = r\\,\\Delta t$.\n$$\nG(\\theta) = 1 - C(1 - e^{-i\\theta}) + \\mu(e^{i\\theta} - 2 + e^{-i\\theta}) - \\lambda\n$$\nThis is the required closed-form analytic expression for the amplification factor.\n\nThe second part of the task is to discuss how the magnitude and argument of $G(\\theta)$ relate to stability and phase errors.\n\n$1$. **Stability**: The numerical stability of the scheme is governed by the magnitude of the amplification factor, $|G(\\theta)|$. For a solution to remain bounded, the amplitude of any Fourier mode must not grow in time. This leads to the von Neumann stability condition:\n$$\n|G(\\theta)| \\le 1 \\quad \\forall \\theta \\in [-\\pi, \\pi]\n$$\nIf $|G(\\theta)| > 1$ for any wavenumber $\\theta$, the corresponding Fourier component will be amplified exponentially with each time step, leading to a rapid and unbounded growth of error, rendering the numerical solution useless. The scheme is conditionally stable, meaning this inequality imposes constraints on the values of $C$, $\\mu$, and $\\lambda$.\n\n$2$. **Phase Error**: The phase error is related to the argument (or phase angle) of the amplification factor, $\\arg(G(\\theta))$. For a complex number $z = x+iy$, $\\arg(z)$ is the angle $\\phi$ such that $z = |z|\\exp(i\\phi)$. The amplification factor determines how both the amplitude and phase of a Fourier mode change over one time step. The numerical phase velocity, $v_{p, \\text{num}}$, indicates the speed at which a wave of a given wavenumber propagates on the grid. It is given by:\n$$\nv_{p, \\text{num}} = -\\frac{\\arg(G(\\theta))}{k\\,\\Delta t} = -\\frac{\\arg(G(\\theta))}{\\theta} \\frac{\\Delta x}{\\Delta t}\n$$\nFor the pure advection part of the exact PDE, all Fourier components propagate at the same velocity, $a$. This corresponds to an exact phase shift of $-a\\,k\\,\\Delta t = -C\\,\\theta$ per timestep for a Fourier mode $\\exp(ikx)$. The numerical dispersion relation is generally not linear with $k$, meaning $v_{p, \\text{num}}$ depends on $\\theta$. The phase error is the discrepancy between the numerical phase velocity and the true physical phase velocity, $a$. This error manifests as numerical dispersion, where different wave components travel at incorrect speeds, distorting the shape of the solution profile. A large deviation of $\\arg(G(\\theta))$ from the ideal linear phase shift $-C\\theta$ signifies a substantial phase error.", "answer": "$$\n\\boxed{1 - C(1 - \\exp(-i\\theta)) + \\mu(\\exp(i\\theta) - 2 + \\exp(-i\\theta)) - \\lambda}\n$$", "id": "3575315"}, {"introduction": "Real-world geophysical transport involves the interplay of multiple processes that can have vastly different mathematical characters and time scales; for example, advection is hyperbolic, diffusion is parabolic, and chemical reactions can be extremely stiff. A \"one-size-fits-all\" numerical method is often inefficient or unstable. This hands-on problem moves from analyzing monolithic schemes to the practical art of solver design, exploring how to build a robust method using operator splitting [@problem_id:3575260]. You will weigh different strategies for composing individual solvers for advection, diffusion, and reaction, learning how to preserve fundamental physical properties like mass and positivity while achieving higher-order accuracy and stability for stiff systems.", "problem": "Consider a single-species tracer concentration field $c(\\mathbf{x}, t)$ evolving on a bounded Lipschitz domain $\\Omega \\subset \\mathbb{R}^d$ under the combined effects of advection, diffusion, and nonlinear reaction, governed by the partial differential equation (PDE)\n$$\n\\partial_t c + \\nabla \\cdot \\left( \\mathbf{u} \\, c \\right) = \\nabla \\cdot \\left( \\mathbf{K} \\nabla c \\right) + R(c),\n$$\nwith boundary conditions $\\mathbf{u} \\cdot \\mathbf{n} = 0$ and $\\mathbf{K} \\nabla c \\cdot \\mathbf{n} = 0$ on $\\partial \\Omega$, where $\\mathbf{u}(\\mathbf{x}, t)$ is a prescribed velocity field, $\\mathbf{K}(\\mathbf{x})$ is a symmetric positive definite diffusivity tensor, and $R(c)$ is a locally Lipschitz nonlinear reaction term. Assume $\\nabla \\cdot \\mathbf{u} = 0$ in $\\Omega$, $R(0) \\ge 0$, and for any initial datum $c_0(\\mathbf{x}) \\ge 0$, the ordinary differential equation (ODE) $\\partial_t y = R(y)$ preserves nonnegativity for $t \\ge 0$.\n\nDefine the operators $A$, $D$, and $R$ by the subproblems over a time interval of length $\\Delta t > 0$:\n- Advection: $\\partial_t c + \\nabla \\cdot (\\mathbf{u} c) = 0$,\n- Diffusion: $\\partial_t c = \\nabla \\cdot (\\mathbf{K} \\nabla c)$,\n- Reaction: $\\partial_t c = R(c)$.\n\nLet $S_A(\\tau)$, $S_D(\\tau)$, and $S_R(\\tau)$ denote the exact subflows over time $\\tau$ for the advection, diffusion, and reaction subproblems, respectively. Suppose each subflow is approximated by a numerical subsolver that is:\n- For advection: conservative and positivity-preserving under the stated boundary conditions.\n- For diffusion: conservative and positivity-preserving under the stated boundary conditions.\n- For reaction: positivity-preserving and unconditionally stable for stiff $R(c)$.\n\nUsing only fundamental conservation principles and the generator properties of the subflows, select the operator-splitting composition over a single time step of size $\\Delta t$ that:\n- Preserves total mass for the advection-diffusion subdynamics (i.e., when $R \\equiv 0$),\n- Preserves nonnegativity of $c$ provided $c(\\mathbf{x}, 0) \\ge 0$,\n- Achieves order $2$ accuracy with respect to the advection-diffusion commutator in the special case $R \\equiv 0$,\n- Treats a potentially stiff reaction in a manner consistent with stability.\n\nChoose the most appropriate splitting sequence:\nA. $S_R(\\Delta t)\\, S_D(\\Delta t)\\, S_A(\\Delta t)$\n\nB. $S_A(\\Delta t/2)\\, S_D(\\Delta t/2)\\, S_R(\\Delta t)\\, S_D(\\Delta t/2)\\, S_A(\\Delta t/2)$\n\nC. $S_R(\\Delta t/2)\\, S_D(\\Delta t)\\, S_A(\\Delta t)\\, S_R(\\Delta t/2)$\n\nD. $S_A(\\Delta t/2)\\, S_R(\\Delta t)\\, S_D(\\Delta t/2)$\n\nProvide your choice and justify it from first principles, explicitly invoking mass conservation via the divergence theorem, positivity via maximum principles and flow properties, and the order of accuracy implications for compositions of noncommuting generators.", "solution": "The task is to select the operator-splitting composition that satisfies four distinct requirements. We will analyze each requirement in the context of the provided options. Let $c^n$ be the numerical solution at time $t_n$. The goal is to find a composition of operators $S_A$, $S_D$, and $S_R$ to compute $c^{n+1}$ at time $t_{n+1} = t_n + \\Delta t$.\n\n**Requirement 1: Mass Conservation (for $R \\equiv 0$)**\nThe total mass of the tracer is $M(t) = \\int_{\\Omega} c(\\mathbf{x}, t) \\, d\\mathbf{x}$. The rate of change of total mass for the advection-diffusion system is:\n$$\n\\frac{dM}{dt} = \\int_{\\Omega} \\partial_t c \\, d\\mathbf{x} = \\int_{\\Omega} \\left[ - \\nabla \\cdot (\\mathbf{u}c) + \\nabla \\cdot (\\mathbf{K} \\nabla c) \\right] d\\mathbf{x}\n$$\nUsing the divergence theorem, we convert the volume integrals to surface integrals:\n$$\n\\frac{dM}{dt} = \\int_{\\partial\\Omega} \\left[ - (\\mathbf{u}c) \\cdot \\mathbf{n} + (\\mathbf{K} \\nabla c) \\cdot \\mathbf{n} \\right] dS\n$$\nThe boundary conditions are $\\mathbf{u} \\cdot \\mathbf{n} = 0$ and $\\mathbf{K} \\nabla c \\cdot \\mathbf{n} = 0$. Substituting these into the integral gives:\n$$\n\\frac{dM}{dt} = \\int_{\\partial\\Omega} \\left[ - c(\\mathbf{u} \\cdot \\mathbf{n}) + (\\mathbf{K} \\nabla c \\cdot \\mathbf{n}) \\right] dS = \\int_{\\partial\\Omega} [0 + 0] \\, dS = 0\n$$\nThus, the exact advection-diffusion dynamics are mass-conservative. The problem states that the numerical subsolvers for advection, $S_A(\\tau)$, and diffusion, $S_D(\\tau)$, are both conservative. Any composition of conservative operators is also conservative. Since all options, when $R \\equiv 0$, are compositions of $S_A$ and $S_D$, all four options satisfy this requirement.\n\n**Requirement 2: Positivity Preservation**\nWe are given that the initial data is non-negative, $c(\\mathbf{x}, 0) \\ge 0$. The physical processes of advection, diffusion (with no-flux boundaries), and the given reaction dynamics are known to preserve nonnegativity. The problem explicitly states that the numerical subsolvers $S_A(\\tau)$, $S_D(\\tau)$, and $S_R(\\tau)$ are all positivity-preserving. A composition of positivity-preserving operators is itself positivity-preserving. Therefore, all four options satisfy this requirement.\n\n**Requirement 3: Second-Order Accuracy for Advection-Diffusion ($R \\equiv 0$)**\nThis is a critical requirement that distinguishes the schemes. The overall accuracy of an operator-splitting scheme is determined by how it approximates the exponential of the sum of the operators. Let the advection and diffusion problems be generated by operators $A_{op}$ and $D_{op}$ respectively, such that $\\partial_t c = (A_{op} + D_{op})c$.\n- A first-order splitting (Godunov splitting) is of the form $S_D(\\Delta t)S_A(\\Delta t)$. The local truncation error is $O(\\Delta t^2)$, leading to a global error of $O(\\Delta t)$. This is a first-order accurate scheme. The leading error term is proportional to the commutator $[A_{op}, D_{op}] = A_{op}D_{op} - D_{op}A_{op}$.\n- A second-order splitting (Strang splitting) is a symmetric composition, such as $S_A(\\Delta t/2)S_D(\\Delta t)S_A(\\Delta t/2)$. This form cancels the leading error term, resulting in a local truncation error of $O(\\Delta t^3)$ and a global error of $O(\\Delta t^2)$.\n\nWe analyze each option for the case $R \\equiv 0$, where the reaction subflow $S_R(\\tau)$ is the identity operator, $I$.\n- **Option A:** $S_R(\\Delta t) S_D(\\Delta t) S_A(\\Delta t) \\to I \\, S_D(\\Delta t) S_A(\\Delta t) = S_D(\\Delta t) S_A(\\Delta t)$. This is a first-order Godunov splitting. It does not meet the requirement.\n- **Option B:** $S_A(\\Delta t/2) S_D(\\Delta t/2) S_R(\\Delta t) S_D(\\Delta t/2) S_A(\\Delta t/2) \\to S_A(\\Delta t/2) S_D(\\Delta t/2) I S_D(\\Delta t/2) S_A(\\Delta t/2)$. This simplifies to $S_A(\\Delta t/2) S_D(\\Delta t/2) S_D(\\Delta t/2) S_A(\\Delta t/2)$. Because the diffusion operator is linear, applying its flow consecutively is equivalent to applying the flow for the sum of the times: $S_D(\\tau_1)S_D(\\tau_2) = S_D(\\tau_1+\\tau_2)$. Thus, the scheme becomes $S_A(\\Delta t/2) S_D(\\Delta t) S_A(\\Delta t/2)$. This is the classic second-order Strang splitting. It meets the requirement.\n- **Option C:** $S_R(\\Delta t/2) S_D(\\Delta t) S_A(\\Delta t) S_R(\\Delta t/2) \\to I S_D(\\Delta t) S_A(\\Delta t) I = S_D(\\Delta t) S_A(\\Delta t)$. This is a first-order Godunov splitting. It does not meet the requirement.\n- **Option D:** $S_A(\\Delta t/2) S_R(\\Delta t) S_D(\\Delta t/2) \\to S_A(\\Delta t/2) I S_D(\\Delta t/2) = S_A(\\Delta t/2) S_D(\\Delta t/2)$. This is an asymmetric, sequential splitting and is first-order accurate. It does not meet the requirement.\n\nBased on accuracy, only Option B is viable.\n\n**Requirement 4: Stable Treatment of Stiff Reaction**\nStiff ODE systems require numerical methods that are stable for step sizes $\\Delta t$ much larger than the fastest timescale of the system. The problem states the reaction subsolver for $S_R(\\tau)$ is unconditionally stable (e.g., an implicit method). In operator splitting, it is standard practice to handle the stiff component differently from the non-stiff components.\nA common and robust strategy is to group the non-stiff operators and split them symmetrically around the stiff operator, which is integrated over the full time step $\\Delta t$. This avoids splitting the stiff part, which could compromise stability or efficiency, and maintains the overall structure of the symmetric splitting.\nLet's evaluate the options based on this principle.\n- **Option A:** $S_R(\\Delta t)\\, S_D(\\Delta t)\\, S_A(\\Delta t)$. It integrates $R$ for the full step $\\Delta t$, which is good for stiffness, but the scheme is only first-order.\n- **Option B:** $S_A(\\Delta t/2)\\, S_D(\\Delta t/2)\\, S_R(\\Delta t)\\, S_D(\\Delta t/2)\\, S_A(\\Delta t/2)$. This scheme integrates the stiff reaction term $R$ over the full time step $\\Delta t$ and places it in the middle of a symmetric (palindromic) sequence of the non-stiff advection and diffusion operators. This is an excellent and widely-used strategy. It combines the second-order accuracy for the non-stiff parts with a stable treatment of the stiff part. This is a form of Strang-Marchuk splitting.\n- **Option C:** $S_R(\\Delta t/2)\\, S_D(\\Delta t)\\, S_A(\\Delta t)\\, S_R(\\Delta t/2)$. This scheme splits the stiff operator $R$, requiring two solves of the stiff system per time step. This is generally less efficient and can be less stable than integrating the stiff part in a single step.\n- **Option D:** $S_A(\\Delta t/2)\\, S_R(\\Delta t)\\, S_D(\\Delta t/2)$. This is a non-symmetric scheme. While it integrates $R$ for the full $\\Delta t$, the lack of symmetry renders it first-order, failing Requirement 3.\n\nIn conclusion, only Option B satisfies all four requirements laid out in the problem statement. It provides second-order accuracy for the well-behaved advection-diffusion part, while treating the stiff reaction term in a robust and stable manner.", "answer": "$$\\boxed{B}$$", "id": "3575260"}]}