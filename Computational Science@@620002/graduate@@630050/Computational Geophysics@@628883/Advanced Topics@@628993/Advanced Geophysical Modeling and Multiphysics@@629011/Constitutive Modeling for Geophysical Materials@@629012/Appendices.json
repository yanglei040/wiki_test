{"hands_on_practices": [{"introduction": "The viscosity of geophysical materials is not a fixed constant; it is profoundly influenced by ambient conditions, most notably temperature. This practice delves into the Arrhenius relationship, a cornerstone model describing how the viscosity of mantle rocks decreases exponentially with increasing temperature. By working through this problem [@problem_id:3581334], you will derive the sensitivity of viscosity to temperature and quantify the dramatic changes in material strength that drive processes like mantle convection.", "problem": "A mantle rheology model for an olivine-rich aggregate assumes a temperature-dependent viscosity of Arrhenius form, with viscosity $\\eta$ expressed as a function of absolute temperature $T$ by\n$$\n\\eta(T) = \\eta_0 \\exp\\!\\left(\\frac{Q}{R\\,T}\\right),\n$$\nwhere $\\eta_0$ is a pre-exponential factor assumed independent of $T$ over the temperature range of interest, $Q$ is an activation energy, and $R$ is the universal gas constant. The model is intended for an isobaric segment of the upper mantle so that pressure effects on viscosity can be neglected.\n\nUsing only the constitutive relation above and basic calculus, carry out the following:\n\n1. Starting from the given Arrhenius form, derive an expression for the sensitivity of the natural logarithm of viscosity to temperature, namely the derivative $d\\ln\\eta/dT$, as a function of $T$, $Q$, and $R$.\n\n2. Define the viscosity contrast factor $C$ across a uniform temperature increase $\\Delta T$ applied to a mantle parcel initially at temperature $T_1$ as\n$$\nC \\equiv \\frac{\\eta(T_1)}{\\eta(T_1+\\Delta T)}.\n$$\nEvaluate $C$ for $Q = 3.0\\times 10^5\\,\\text{J mol}^{-1}$, $R = 8.314\\,\\text{J mol}^{-1}\\,\\text{K}^{-1}$, $T_1 = 1600\\,\\text{K}$, and $\\Delta T = 200\\,\\text{K}$. Round your final value of $C$ to four significant figures. Express $C$ as a dimensionless number.", "solution": "The problem statement has been validated and is deemed scientifically grounded, well-posed, and objective. All necessary data and definitions are provided, and there are no internal contradictions or logical flaws. The problem represents a standard application of constitutive modeling in geophysics.\n\nThe solution is presented in two parts as requested.\n\n### Part 1: Derivation of Viscosity Sensitivity to Temperature\n\nThe constitutive relation for viscosity, $\\eta$, as a function of absolute temperature, $T$, is given by the Arrhenius form:\n$$\n\\eta(T) = \\eta_0 \\exp\\left(\\frac{Q}{R\\,T}\\right)\n$$\nwhere $\\eta_0$ is a pre-exponential factor, $Q$ is the activation energy, and $R$ is the universal gas constant.\n\nTo find the sensitivity of the natural logarithm of viscosity to temperature, we first take the natural logarithm of both sides of the equation:\n$$\n\\ln\\eta(T) = \\ln\\left[\\eta_0 \\exp\\left(\\frac{Q}{R\\,T}\\right)\\right]\n$$\nUsing the properties of logarithms, specifically $\\ln(a \\cdot b) = \\ln(a) + \\ln(b)$ and $\\ln(\\exp(x)) = x$, we can simplify the expression:\n$$\n\\ln\\eta(T) = \\ln(\\eta_0) + \\frac{Q}{R\\,T}\n$$\nNow, we differentiate this expression with respect to temperature $T$. The term $\\ln(\\eta_0)$ is a constant because $\\eta_0$ is assumed to be independent of $T$. The derivative of a constant is zero. The term $\\frac{Q}{R\\,T}$ can be written as $\\frac{Q}{R} T^{-1}$.\n$$\n\\frac{d}{dT}(\\ln\\eta) = \\frac{d}{dT}\\left(\\ln(\\eta_0) + \\frac{Q}{R} T^{-1}\\right)\n$$\n$$\n\\frac{d\\ln\\eta}{dT} = 0 + \\frac{Q}{R} \\frac{d}{dT}(T^{-1})\n$$\nThe derivative of $T^{-1}$ with respect to $T$ is $-1 \\cdot T^{-2} = -\\frac{1}{T^2}$.\nSubstituting this result back, we obtain the expression for the sensitivity:\n$$\n\\frac{d\\ln\\eta}{dT} = \\frac{Q}{R} \\left(-\\frac{1}{T^2}\\right) = -\\frac{Q}{R\\,T^2}\n$$\nThis is the derived expression for the sensitivity of the natural logarithm of viscosity to temperature, as a function of $T$, $Q$, and $R$.\n\n### Part 2: Evaluation of the Viscosity Contrast Factor\n\nThe viscosity contrast factor, $C$, is defined as the ratio of the viscosity at an initial temperature $T_1$ to the viscosity at a higher temperature $T_1 + \\Delta T$:\n$$\nC \\equiv \\frac{\\eta(T_1)}{\\eta(T_1+\\Delta T)}\n$$\nWe substitute the Arrhenius expression for $\\eta(T)$ into this definition:\n$$\nC = \\frac{\\eta_0 \\exp\\left(\\frac{Q}{R\\,T_1}\\right)}{\\eta_0 \\exp\\left(\\frac{Q}{R(T_1+\\Delta T)}\\right)}\n$$\nThe pre-exponential factor $\\eta_0$ cancels from the numerator and denominator. Using the property of exponents $\\frac{\\exp(a)}{\\exp(b)} = \\exp(a-b)$, we get:\n$$\nC = \\exp\\left(\\frac{Q}{R\\,T_1} - \\frac{Q}{R(T_1+\\Delta T)}\\right)\n$$\nWe can factor out the common term $\\frac{Q}{R}$:\n$$\nC = \\exp\\left[\\frac{Q}{R}\\left(\\frac{1}{T_1} - \\frac{1}{T_1+\\Delta T}\\right)\\right]\n$$\nTo simplify the expression in the parentheses, we find a common denominator:\n$$\n\\frac{1}{T_1} - \\frac{1}{T_1+\\Delta T} = \\frac{(T_1+\\Delta T) - T_1}{T_1(T_1+\\Delta T)} = \\frac{\\Delta T}{T_1(T_1+\\Delta T)}\n$$\nSubstituting this back into the expression for $C$ yields the final symbolic form:\n$$\nC = \\exp\\left(\\frac{Q\\,\\Delta T}{R\\,T_1(T_1+\\Delta T)}\\right)\n$$\nNow, we substitute the given numerical values:\n$Q = 3.0 \\times 10^5\\,\\text{J mol}^{-1}$\n$R = 8.314\\,\\text{J mol}^{-1}\\,\\text{K}^{-1}$\n$T_1 = 1600\\,\\text{K}$\n$\\Delta T = 200\\,\\text{K}$\n\nThe argument of the exponential function is calculated as follows:\n$$\n\\frac{Q\\,\\Delta T}{R\\,T_1(T_1+\\Delta T)} = \\frac{(3.0 \\times 10^5) \\cdot (200)}{8.314 \\cdot 1600 \\cdot (1600+200)} = \\frac{6.0 \\times 10^7}{8.314 \\cdot 1600 \\cdot 1800}\n$$\n$$\n\\frac{6.0 \\times 10^7}{8.314 \\cdot (2.88 \\times 10^6)} = \\frac{60}{8.314 \\cdot 2.88} \\approx \\frac{60}{23.94432} \\approx 2.50579\n$$\nThe argument is dimensionless, as expected. Now we compute $C$:\n$$\nC = \\exp(2.50579) \\approx 12.25253\n$$\nThe problem requires the final value to be rounded to four significant figures.\n$$\nC \\approx 12.25\n$$\nThis dimensionless number indicates that a $200\\,\\text{K}$ temperature increase from $1600\\,\\text{K}$ reduces the mantle viscosity by a factor of approximately $12.25$.", "answer": "$$\n\\boxed{12.25}\n$$", "id": "3581334"}, {"introduction": "Moving from the bulk deformation of the mantle to the behavior of discrete faults, we encounter the complex nature of friction. Simple models of friction are inadequate for explaining earthquake phenomena; instead, we turn to rate-and-state friction (RSF) laws, which posit that frictional strength evolves with both slip velocity and the history of contact, encapsulated in a 'state' variable. This exercise [@problem_id:3581299] guides you through a classic velocity-step simulation, allowing you to compute the immediate \"direct effect\" and the subsequent \"evolution effect\" that govern fault stability and the nucleation of earthquakes.", "problem": "A rate-and-state friction (RSF) interface subject to a normal stress $\\sigma_n$ is governed by a constitutive relationship for the friction coefficient $\\mu(t)$ that depends on slip velocity $V(t)$ and an internal state variable $\\theta(t)$ with dimensions of time. Adopt the Dieterich-Ruina (aging) state evolution. Use the following fundamental and widely accepted starting laws:\n\n- Friction law: $\\mu(t) = \\mu_\\star + a \\ln\\!\\left(\\dfrac{V(t)}{V_\\star}\\right) + b \\ln\\!\\left(\\dfrac{\\theta(t)\\,V_\\star}{D_c}\\right)$, where $\\mu_\\star$ is the reference friction at reference velocity $V_\\star$, $a$ and $b$ are dimensionless empirical parameters, and $D_c$ is the characteristic slip distance with dimensions of length.\n- Aging law for the state variable (an ordinary differential equation (ODE)): $\\dfrac{d\\theta}{dt} = 1 - \\dfrac{V(t)\\,\\theta(t)}{D_c}$.\n- Shear stress: $\\tau(t) = \\sigma_n\\,\\mu(t)$.\n\nConsider a prescribed velocity step history: the interface is in steady state at velocity $V_1$ for times $t  0$, and at $t = 0$ the slip velocity steps to a constant value $V_2$ and remains there for $t \\in [0, T_{\\text{end}}]$. Assume the system is in steady state at $t=0^-$, which implies the initial condition $\\theta(0) = D_c / V_1$. Using only these laws and definitions as the starting point, derive the computational procedure to obtain $\\mu(t)$ for $t \\in [0, T_{\\text{end}}]$ and compute the cumulative stress drop over the interval, defined as $\\Delta \\tau = \\tau(0^-) - \\tau(T_{\\text{end}})$, expressed in Pascals. Here $\\tau(0^-)=\\sigma_n\\,\\mu_{\\text{ss}}(V_1)$ is the steady-state shear stress just before the step. All velocities must be strictly positive.\n\nPhysical units to use throughout:\n- Slip velocity $V$ in meters per second ($\\text{m/s}$).\n- Characteristic slip distance $D_c$ in meters ($\\text{m}$).\n- Time $t$ in seconds ($\\text{s}$).\n- Normal stress $\\sigma_n$ in Pascals ($\\text{Pa}$).\n- Friction coefficient $\\mu$ is dimensionless.\n- The final stress drop $\\Delta \\tau$ must be expressed in Pascals.\n\nYour program must implement the solution for the following test suite. Each test case is a tuple $(a, b, D_c, \\sigma_n, \\mu_\\star, V_\\star, V_1, V_2, T_{\\text{end}})$ with values:\n- Case A (step up in velocity, velocity-weakening, short transient):\n  - $(a, b, D_c, \\sigma_n, \\mu_\\star, V_\\star, V_1, V_2, T_{\\text{end}}) = (\\,0.008,\\,0.012,\\,10^{-5},\\,5\\times 10^{7},\\,0.6,\\,10^{-6},\\,10^{-6},\\,10^{-3},\\,1\\,)$.\n- Case B (step down in velocity, velocity-weakening, long transient):\n  - $(a, b, D_c, \\sigma_n, \\mu_\\star, V_\\star, V_1, V_2, T_{\\text{end}}) = (\\,0.008,\\,0.012,\\,10^{-5},\\,5\\times 10^{7},\\,0.6,\\,10^{-6},\\,10^{-4},\\,10^{-6},\\,50\\,)$.\n- Case C (step up with $a=b$, zero net steady-state change):\n  - $(a, b, D_c, \\sigma_n, \\mu_\\star, V_\\star, V_1, V_2, T_{\\text{end}}) = (\\,0.01,\\,0.01,\\,10^{-5},\\,5\\times 10^{7},\\,0.6,\\,10^{-6},\\,10^{-6},\\,10^{-3},\\,1\\,)$.\n\nFor each case, compute and report the following three quantities:\n- $\\mu(0^+)$, the immediate friction value after the velocity step at $t=0^+$.\n- $\\mu(T_{\\text{end}})$, the friction value at the end time.\n- $\\Delta \\tau = \\tau(0^-) - \\tau(T_{\\text{end}})$ in Pascals.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. For each case, output a three-element list $[\\mu(0^+), \\mu(T_{\\text{end}}), \\Delta \\tau]$, with each float rounded to six decimal places, and aggregate the three case-results into a single top-level list. For example, the required format is like $[[x_1,x_2,x_3],[y_1,y_2,y_3],[z_1,z_2,z_3]]$ with no additional whitespace or text.", "solution": "The problem is scientifically valid and well-posed, resting on the established principles of rate-and-state friction models commonly used in computational geophysics and seismology. We may proceed with a formal derivation of the quantities of interest.\n\nThe system is described by three fundamental laws:\n$1$. The friction law: $\\mu(t) = \\mu_\\star + a \\ln\\left(\\dfrac{V(t)}{V_\\star}\\right) + b \\ln\\left(\\dfrac{\\theta(t)\\,V_\\star}{D_c}\\right)$.\n$2$. The state evolution law (aging): $\\dfrac{d\\theta}{dt} = 1 - \\dfrac{V(t)\\,\\theta(t)}{D_c}$.\n$3$. The shear stress definition: $\\tau(t) = \\sigma_n\\,\\mu(t)$.\n\nOur goal is to compute the friction at the moment of the velocity step, $\\mu(0^+)$, the friction at a later time, $\\mu(T_{\\text{end}})$, and the total stress drop over the interval, $\\Delta \\tau = \\tau(0^-) - \\tau(T_{\\text{end}})$.\n\nFirst, we analyze the steady-state (ss) condition, which is crucial for defining the initial state of the system. In steady state, all time derivatives are zero, so $\\dfrac{d\\theta}{dt} = 0$. From the state evolution law, this implies:\n$$1 - \\dfrac{V_{\\text{ss}}\\,\\theta_{\\text{ss}}}{D_c} = 0 \\implies \\theta_{\\text{ss}}(V) = \\dfrac{D_c}{V}$$\nThe steady-state value of the state variable, $\\theta_{\\text{ss}}$, is inversely proportional to the steady-state velocity, $V_{\\text{ss}}$. Substituting this into the friction law yields the steady-state friction coefficient $\\mu_{\\text{ss}}$ as a function of velocity $V$:\n$$ \\mu_{\\text{ss}}(V) = \\mu_\\star + a \\ln\\left(\\dfrac{V}{V_\\star}\\right) + b \\ln\\left(\\dfrac{(D_c/V)\\,V_\\star}{D_c}\\right) $$\n$$ \\mu_{\\text{ss}}(V) = \\mu_\\star + a \\ln\\left(\\dfrac{V}{V_\\star}\\right) + b \\ln\\left(\\dfrac{V_\\star}{V}\\right) = \\mu_\\star + (a-b)\\ln\\left(\\dfrac{V}{V_\\star}\\right) $$\n\nThe problem states the system is in steady state at velocity $V_1$ for $t  0$. Therefore, the initial condition for the state variable at $t=0$ is:\n$$ \\theta(0) = \\theta_{\\text{ss}}(V_1) = \\dfrac{D_c}{V_1} $$\nThe shear stress just before the step, at $t=0^-$, is based on the steady-state friction at $V_1$:\n$$ \\tau(0^-) = \\sigma_n\\,\\mu_{\\text{ss}}(V_1) = \\sigma_n\\left[\\mu_\\star + (a-b)\\ln\\left(\\dfrac{V_1}{V_\\star}\\right)\\right] $$\n\nAt $t=0$, the velocity steps instantaneously to $V_2$. The state variable $\\theta$ cannot change instantaneously, so $\\theta(0^+) = \\theta(0^-) = D_c/V_1$. The friction coefficient $\\mu$, however, responds immediately to the change in $V$. To find $\\mu(0^+)$, we use $V(0^+) = V_2$ and $\\theta(0) = D_c/V_1$ in the friction law:\n$$ \\mu(0^+) = \\mu_\\star + a \\ln\\left(\\dfrac{V_2}{V_\\star}\\right) + b \\ln\\left(\\dfrac{\\theta(0)\\,V_\\star}{D_c}\\right) $$\n$$ \\mu(0^+) = \\mu_\\star + a \\ln\\left(\\dfrac{V_2}{V_\\star}\\right) + b \\ln\\left(\\dfrac{(D_c/V_1)\\,V_\\star}{D_c}\\right) = \\mu_\\star + a \\ln\\left(\\dfrac{V_2}{V_\\star}\\right) + b \\ln\\left(\\dfrac{V_\\star}{V_1}\\right) $$\nUsing the property $\\ln(x/y) = -\\ln(y/x)$, this is equivalent to:\n$$ \\mu(0^+) = \\mu_\\star + a \\ln\\left(\\dfrac{V_2}{V_\\star}\\right) - b \\ln\\left(\\dfrac{V_1}{V_\\star}\\right) $$\nThis expression provides the first required quantity, $\\mu(0^+)$. This is known as the \"direct effect\" of the velocity change.\n\nFor $t  0$, the velocity is held constant at $V(t) = V_2$. The state evolution law becomes a first-order linear ordinary differential equation for $\\theta(t)$:\n$$ \\dfrac{d\\theta}{dt} = 1 - \\dfrac{V_2\\,\\theta(t)}{D_c} \\quad \\text{or} \\quad \\dfrac{d\\theta}{dt} + \\left(\\dfrac{V_2}{D_c}\\right)\\theta = 1 $$\nThe solution to this ODE with the initial condition $\\theta(0) = D_c/V_1$ can be found using an integrating factor or by recognizing its standard form. The general solution is $\\theta(t) = \\theta_{\\text{ss}}(V_2) + C \\exp(-t / (D_c/V_2))$, where $\\theta_{\\text{ss}}(V_2) = D_c/V_2$ is the new steady-state value. We solve for the constant of integration $C$:\n$$ \\theta(0) = \\dfrac{D_c}{V_1} = \\dfrac{D_c}{V_2} + C \\implies C = \\dfrac{D_c}{V_1} - \\dfrac{D_c}{V_2} $$\nThe particular solution for the state variable for $t \\ge 0$ is:\n$$ \\theta(t) = \\dfrac{D_c}{V_2} + \\left(\\dfrac{D_c}{V_1} - \\dfrac{D_c}{V_2}\\right) e^{-t\\,V_2/D_c} $$\n\nTo find the friction at $t=T_{\\text{end}}$, we first evaluate $\\theta(T_{\\text{end}})$ using the above solution:\n$$ \\theta(T_{\\text{end}}) = \\dfrac{D_c}{V_2} + \\left(\\dfrac{D_c}{V_1} - \\dfrac{D_c}{V_2}\\right) e^{-T_{\\text{end}}\\,V_2/D_c} $$\nThen, we substitute this value and $V=V_2$ into the friction law to obtain the second required quantity, $\\mu(T_{\\text{end}})$:\n$$ \\mu(T_{\\text{end}}) = \\mu_\\star + a \\ln\\left(\\dfrac{V_2}{V_\\star}\\right) + b \\ln\\left(\\dfrac{\\theta(T_{\\text{end}})\\,V_\\star}{D_c}\\right) $$\n\nFinally, we compute the cumulative stress drop $\\Delta\\tau = \\tau(0^-) - \\tau(T_{\\text{end}})$. Using the expressions for the stresses:\n$$ \\Delta\\tau = \\sigma_n\\,\\mu_{\\text{ss}}(V_1) - \\sigma_n\\,\\mu(T_{\\text{end}}) = \\sigma_n\\left(\\mu_{\\text{ss}}(V_1) - \\mu(T_{\\text{end}})\\right) $$\nwhere $\\mu_{\\text{ss}}(V_1)$ and $\\mu(T_{\\text{end}})$ are given by the formulas derived above. This is the third and final required quantity. The computational procedure is to implement these derived analytical expressions.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (a, b, Dc, sigma_n, mu_star, V_star, V1, V2, T_end)\n    test_cases = [\n        # Case A (step up in velocity, velocity-weakening, short transient)\n        (0.008, 0.012, 1e-5, 5e7, 0.6, 1e-6, 1e-6, 1e-3, 1),\n        # Case B (step down in velocity, velocity-weakening, long transient)\n        (0.008, 0.012, 1e-5, 5e7, 0.6, 1e-6, 1e-4, 1e-6, 50),\n        # Case C (step up with a=b, zero net steady-state change)\n        (0.01, 0.01, 1e-5, 5e7, 0.6, 1e-6, 1e-6, 1e-3, 1),\n    ]\n\n    all_results = []\n    \n    for case in test_cases:\n        a, b, Dc, sigma_n, mu_star, V_star, V1, V2, T_end = case\n\n        # 1. Calculate mu(0+), the immediate friction value after the velocity step.\n        # Formula: mu(0+) = mu_star + a*ln(V2/V_star) - b*ln(V1/V_star)\n        term_a = a * np.log(V2 / V_star)\n        term_b = b * np.log(V1 / V_star)\n        mu_0_plus = mu_star + term_a - term_b\n\n        # 2. Calculate theta(T_end), the state variable at the end of the interval.\n        # This is the solution to the ODE d(theta)/dt = 1 - V2*theta/Dc\n        # with initial condition theta(0) = Dc/V1.\n        # Formula: theta(t) = Dc/V2 + (Dc/V1 - Dc/V2) * exp(-t*V2/Dc)\n        C = Dc / V1 - Dc / V2\n        exponent = -T_end * V2 / Dc\n        theta_T_end = (Dc / V2) + C * np.exp(exponent)\n\n        # 3. Calculate mu(T_end), the friction value at the end time.\n        # Formula: mu(T_end) = mu_star + a*ln(V2/V_star) + b*ln(theta(T_end)*V_star/Dc)\n        log_term_b = b * np.log(theta_T_end * V_star / Dc)\n        mu_T_end = mu_star + term_a + log_term_b\n        \n        # 4. Calculate Delta tau = tau(0-) - tau(T_end).\n        # First, find mu_ss(V1), the steady-state friction before the step.\n        # Formula: mu_ss(V) = mu_star + (a-b)*ln(V/V_star)\n        mu_ss_V1 = mu_star + (a - b) * np.log(V1 / V_star)\n        \n        # Delta tau is then sigma_n * (mu_ss(V1) - mu(T_end))\n        delta_tau = sigma_n * (mu_ss_V1 - mu_T_end)\n\n        # Append the results for the current case.\n        all_results.append([mu_0_plus, mu_T_end, delta_tau])\n\n    # Format the final output string exactly as required.\n    # Example: [[x1,x2,x3],[y1,y2,y3],[z1,z2,z3]]\n    # with 6 decimal places for each float and no extra whitespace.\n    result_strings = []\n    for res in all_results:\n        # Format each number to 6 decimal places\n        mu0_str = f\"{res[0]:.6f}\"\n        muT_str = f\"{res[1]:.6f}\"\n        dT_str = f\"{res[2]:.6f}\"\n        # Construct the inner list string\n        inner_str = f\"[{mu0_str},{muT_str},{dT_str}]\"\n        result_strings.append(inner_str)\n    \n    # Join the inner list strings and enclose in the outer list brackets\n    final_output = f\"[{','.join(result_strings)}]\"\n    \n    print(final_output)\n\nsolve()\n```", "id": "3581299"}, {"introduction": "When stresses in the Earth's crust exceed a material's strength, it undergoes permanent, irreversible deformation. The framework of elastoplasticity provides the mathematical tools to model this behavior, combining an elastic response with plastic flow once a stress limit, or yield criterion, is reached. This advanced practice introduces the Mohr-Coulomb model and the essential numerical technique known as the 'return-mapping' algorithm [@problem_id:3581296]. Implementing this algorithm is a fundamental skill in computational geomechanics, as it ensures that simulated stresses correctly adhere to the material's failure envelope.", "problem": "Consider small-strain, rate-independent elastoplasticity for a cohesion-frictional geomaterial obeying the Mohr–Coulomb criterion under an axisymmetric compression state. Adopt the compression-positive sign convention for stress. The elastic response is isotropic with bulk modulus $K$ and shear modulus $G$. Let the principal stresses satisfy $\\sigma_1 \\ge \\sigma_2 = \\sigma_3$ and assume the loading and return-mapping steps preserve the principal directions. Define the first invariant of stress (mean stress) as $p = (\\sigma_1 + \\sigma_2 + \\sigma_3)/3$, the deviatoric stress tensor $\\mathbf{s} = \\boldsymbol{\\sigma} - p \\mathbf{I}$, and the second invariant $J_2 = \\tfrac{1}{2} \\mathbf{s}:\\mathbf{s}$. Define the deviatoric stress measure $q = \\sqrt{3 J_2}$. Under axisymmetric compression with $\\sigma_2 = \\sigma_3$, it is a fundamental fact that $q = \\sigma_1 - \\sigma_3$ and $p = (\\sigma_1 + 2 \\sigma_3)/3$.\n\nLet the Mohr–Coulomb yield function along the triaxial compression meridian be posed in the invariant form $f(p,q) = q - M_c p - k_c$, where the friction dependence is $M_c = \\dfrac{6 \\sin \\phi}{3 - \\sin \\phi}$ and the cohesion-dependent intercept is $k_c = \\dfrac{6 c \\cos \\phi}{3 - \\sin \\phi}$. Consider non-associative plastic flow with plastic potential $g(p,q) = q - M_g p$, where $M_g = \\dfrac{6 \\sin \\psi}{3 - \\sin \\psi}$ uses the dilation angle $\\psi$. The return-mapping step updates a trial stress state to satisfy the yield condition and the consistency condition while obeying isotropic elasticity and the flow rule.\n\nStarting from the fundamental definitions above (isotropic linear elasticity, invariants $p$ and $q$, yield condition $f(p,q) \\le 0$, plastic potential $g(p,q)$, and $\\dot{\\boldsymbol{\\sigma}} = \\mathbb{D} : (\\dot{\\boldsymbol{\\varepsilon}} - \\dot{\\boldsymbol{\\varepsilon}}^p)$ with $\\dot{\\boldsymbol{\\varepsilon}}^p = \\dot{\\lambda} \\, \\partial g/\\partial \\boldsymbol{\\sigma}$), derive from first principles a closed-form return-mapping update for an axisymmetric trial state on the triaxial compression meridian. Specifically, for a given trial principal stress state $(\\sigma_1^{\\text{tr}}, \\sigma_2^{\\text{tr}}, \\sigma_3^{\\text{tr}})$ with $\\sigma_2^{\\text{tr}} = \\sigma_3^{\\text{tr}}$, material parameters $(\\phi, c, \\psi)$, and elastic moduli $(K, G)$, determine:\n- the plastic multiplier increment $\\Delta \\gamma$ obtained from the consistency condition,\n- the updated principal stresses $(\\sigma_1^{\\text{new}}, \\sigma_2^{\\text{new}}, \\sigma_3^{\\text{new}})$ in the same principal basis.\n\nIf the trial state satisfies the yield condition strictly ($f(p^{\\text{tr}}, q^{\\text{tr}}) lt; 0$ within numerical tolerance), the update must leave the stress unchanged and use $\\Delta \\gamma = 0$.\n\nAngles $\\phi$ and $\\psi$ must be interpreted in degrees for input and converted to radians for trigonometric evaluations. All stresses and moduli must be treated in megapascal (MPa). The final answers for updated stresses must be expressed in MPa. The program must output each test case result as a list $[\\Delta \\gamma, \\sigma_1^{\\text{new}}, \\sigma_2^{\\text{new}}, \\sigma_3^{\\text{new}}]$ of floats rounded to six decimal places.\n\nTest Suite:\n- Case $1$ (elastic interior): $K = 5000$ MPa, $G = 3000$ MPa, $\\phi = 30$ degrees, $c = 30$ MPa, $\\psi = 5$ degrees, trial principal stresses $(\\sigma_1^{\\text{tr}}, \\sigma_2^{\\text{tr}}, \\sigma_3^{\\text{tr}}) = (50, 45, 45)$ MPa.\n- Case $2$ (plastic return to smooth meridian): $K = 5000$ MPa, $G = 3000$ MPa, $\\phi = 30$ degrees, $c = 5$ MPa, $\\psi = 10$ degrees, trial principal stresses $(\\sigma_1^{\\text{tr}}, \\sigma_2^{\\text{tr}}, \\sigma_3^{\\text{tr}}) = (28, 1, 1)$ MPa.\n- Case $3$ (on the yield surface, boundary): $K = 5000$ MPa, $G = 3000$ MPa, $\\phi = 30$ degrees, $c = 5$ MPa, $\\psi = 10$ degrees, trial principal stresses $(\\sigma_1^{\\text{tr}}, \\sigma_2^{\\text{tr}}, \\sigma_3^{\\text{tr}}) = (33.928, 5.536, 5.536)$ MPa.\n- Case $4$ (plastic return, zero dilation): $K = 5000$ MPa, $G = 3000$ MPa, $\\phi = 30$ degrees, $c = 5$ MPa, $\\psi = 0$ degrees, trial principal stresses $(\\sigma_1^{\\text{tr}}, \\sigma_2^{\\text{tr}}, \\sigma_3^{\\text{tr}}) = (28, 1, 1)$ MPa.\n\nFinal Output Format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element is the list $[\\Delta \\gamma, \\sigma_1^{\\text{new}}, \\sigma_2^{\\text{new}}, \\sigma_3^{\\text{new}}]$ for a test case, in the same order as the cases listed above. For example, the output should look like:\n$[[\\Delta \\gamma_1,\\sigma_{1,1}^{\\text{new}},\\sigma_{2,1}^{\\text{new}},\\sigma_{3,1}^{\\text{new}}],[\\Delta \\gamma_2,\\sigma_{1,2}^{\\text{new}},\\sigma_{2,2}^{\\text{new}},\\sigma_{3,2}^{\\text{new}}],\\ldots]$\nAll reported numbers must be rounded to six decimal places. Angles are in degrees, and all stresses and moduli are in MPa. The angle unit has been explicitly specified as degrees; do not use radians in inputs.", "solution": "The problem requires the derivation and implementation of a closed-form return-mapping algorithm for a small-strain, rate-independent elastoplastic material governed by the Mohr-Coulomb yield criterion with a non-associative flow rule. The analysis is specialized for an axisymmetric compression stress state.\n\nThe foundation of the algorithm lies in the operator split methodology common in computational plasticity, where a total strain increment is first assumed to produce a purely elastic stress response, yielding a \"trial\" stress state. If this trial state violates the yield condition, a plastic corrector step is applied to return the stress state to the updated yield surface. This process is discretized using a backward Euler integration scheme for its unconditional stability.\n\nThe fundamental relationship between stress rate $\\dot{\\boldsymbol{\\sigma}}$, elastic stiffness tensor $\\mathbb{D}$, total strain rate $\\dot{\\boldsymbol{\\varepsilon}}$, and plastic strain rate $\\dot{\\boldsymbol{\\varepsilon}}^p$ is given by:\n$$ \\dot{\\boldsymbol{\\sigma}} = \\mathbb{D} : (\\dot{\\boldsymbol{\\varepsilon}} - \\dot{\\boldsymbol{\\varepsilon}}^p) $$\nIntegrating over a time step $\\Delta t$, we obtain the incremental update. The trial stress state, $\\boldsymbol{\\sigma}^{\\text{tr}}$, is defined as the stress that would be reached if the entire strain increment $\\Delta\\boldsymbol{\\varepsilon}$ were purely elastic:\n$$ \\boldsymbol{\\sigma}^{\\text{tr}} = \\boldsymbol{\\sigma}^{\\text{old}} + \\mathbb{D} : \\Delta\\boldsymbol{\\varepsilon} $$\nwhere $\\boldsymbol{\\sigma}^{\\text{old}}$ is the stress at the beginning of the step. The updated stress, $\\boldsymbol{\\sigma}^{\\text{new}}$, is then related to the trial stress by correcting for the plastic strain increment, $\\Delta\\boldsymbol{\\varepsilon}^p$:\n$$ \\boldsymbol{\\sigma}^{\\text{new}} = \\boldsymbol{\\sigma}^{\\text{tr}} - \\mathbb{D} : \\Delta\\boldsymbol{\\varepsilon}^p $$\nThe plastic strain increment is determined by the flow rule. For a backward Euler scheme, the flow rule is evaluated at the end-of-step state:\n$$ \\Delta\\boldsymbol{\\varepsilon}^p = \\Delta\\gamma \\, \\left. \\frac{\\partial g}{\\partial \\boldsymbol{\\sigma}} \\right|_{\\boldsymbol{\\sigma} = \\boldsymbol{\\sigma}^{\\text{new}}} $$\nwhere $\\Delta\\gamma$ is the non-negative plastic multiplier increment and $g$ is the plastic potential function. The final stress state $\\boldsymbol{\\sigma}^{\\text{new}}$ must satisfy the yield condition, known as the consistency condition: $f(\\boldsymbol{\\sigma}^{\\text{new}}) = 0$.\n\nFor isotropic elasticity and pressure-dependent plasticity models, it is advantageous to decompose the stress and strain tensors into volumetric and deviatoric components. The elastic constitutive relations are given by:\n$$ p = K \\varepsilon_v^e $$\n$$ \\mathbf{s} = 2G \\mathbf{e}^e $$\nwhere $p$ is the mean stress, $\\mathbf{s}$ is the deviatoric stress tensor, $\\varepsilon_v^e$ is the elastic volumetric strain, $\\mathbf{e}^e$ is the elastic deviatoric strain tensor, $K$ is the bulk modulus, and $G$ is the shear modulus. The stress update equations can be written in terms of invariants:\n$$ p^{\\text{new}} = p^{\\text{tr}} - K \\Delta\\varepsilon_v^p $$\n$$ \\mathbf{s}^{\\text{new}} = \\mathbf{s}^{\\text{tr}} - 2G \\Delta\\mathbf{e}^p $$\nThe plastic strain increments are derived from the plastic potential $g(p, q)$, where $q = \\sqrt{3J_2}$ is the deviatoric stress measure. The required derivatives are:\n$$ \\Delta\\varepsilon_v^p = \\Delta\\gamma \\frac{\\partial g}{\\partial p} $$\n$$ \\Delta\\mathbf{e}^p = \\Delta\\gamma \\frac{\\partial g}{\\partial \\mathbf{s}} = \\Delta\\gamma \\frac{\\partial g}{\\partial q} \\frac{\\partial q}{\\partial \\mathbf{s}} $$\nThe plastic potential is $g(p,q) = q - M_g p$. Its derivatives are:\n$$ \\frac{\\partial g}{\\partial p} = -M_g $$\n$$ \\frac{\\partial g}{\\partial q} = 1 $$\nSubstituting these into the invariant update equations:\n$$ p^{\\text{new}} = p^{\\text{tr}} - K (\\Delta\\gamma (-M_g)) = p^{\\text{tr}} + K M_g \\Delta\\gamma $$\nFor the deviatoric update, we note that $\\frac{\\partial q}{\\partial \\mathbf{s}} = \\frac{3}{2q}\\mathbf{s}$. Therefore, $\\Delta\\mathbf{e}^p = \\Delta\\gamma \\frac{3}{2q^{\\text{new}}}\\mathbf{s}^{\\text{new}}$. The update is:\n$$ \\mathbf{s}^{\\text{new}} = \\mathbf{s}^{\\text{tr}} - 2G \\left( \\Delta\\gamma \\frac{3}{2q^{\\text{new}}}\\mathbf{s}^{\\text{new}} \\right) \\implies \\mathbf{s}^{\\text{new}}\\left(1 + \\frac{3G\\Delta\\gamma}{q^{\\text{new}}}\\right) = \\mathbf{s}^{\\text{tr}} $$\nThis indicates that $\\mathbf{s}^{\\text{new}}$ is collinear with $\\mathbf{s}^{\\text{tr}}$, allowing us to write a scalar update for $q$:\n$$ q^{\\text{new}} = q^{\\text{tr}} - 3G\\Delta\\gamma $$\nWe now have two update equations for the invariants $(p^{\\text{new}}, q^{\\text{new}})$ and one unknown, $\\Delta\\gamma$. The final piece is the consistency condition, $f(p^{\\text{new}}, q^{\\text{new}}) = 0$. The Mohr-Coulomb yield function is $f(p,q) = q - M_c p - k_c$. Substituting the expressions for $p^{\\text{new}}$ and $q^{\\text{new}}$:\n$$ (q^{\\text{tr}} - 3G\\Delta\\gamma) - M_c (p^{\\text{tr}} + K M_g \\Delta\\gamma) - k_c = 0 $$\nRearranging the terms yields an explicit expression for the plastic multiplier $\\Delta\\gamma$:\n$$ q^{\\text{tr}} - M_c p^{\\text{tr}} - k_c = \\Delta\\gamma(3G + K M_c M_g) $$\nThe term on the left is the value of the yield function at the trial state, $f^{\\text{tr}} = f(p^{\\text{tr}}, q^{\\text{tr}})$. Thus, we solve for $\\Delta\\gamma$:\n$$ \\Delta\\gamma = \\frac{f^{\\text{tr}}}{3G + K M_c M_g} $$\nThis calculation is performed only if $f^{\\text{tr}}  0$. If $f^{\\text{tr}} \\le 0$, the step is elastic and $\\Delta\\gamma = 0$, resulting in $\\boldsymbol{\\sigma}^{\\text{new}} = \\boldsymbol{\\sigma}^{\\text{tr}}$.\n\nOnce $\\Delta\\gamma$ is determined for a plastic step, the updated invariants are calculated. Finally, the principal stresses are reconstructed from the updated invariants $(p^{\\text{new}}, q^{\\text{new}})$. For the specified axisymmetric compression state ($\\sigma_1 \\ge \\sigma_2 = \\sigma_3$), the relationships are:\n$$ p = \\frac{\\sigma_1 + 2\\sigma_3}{3}, \\quad q = \\sigma_1 - \\sigma_3 $$\nInverting this system gives the principal stresses as a function of the invariants:\n$$ \\sigma_1 = p + \\frac{2}{3}q $$\n$$ \\sigma_3 = p - \\frac{1}{3}q $$\n$$ \\sigma_2 = \\sigma_3 $$\nThe updated principal stresses $(\\sigma_1^{\\text{new}}, \\sigma_2^{\\text{new}}, \\sigma_3^{\\text{new}})$ are thus found by substituting $(p^{\\text{new}}, q^{\\text{new}})$ into these reconstruction formulas.\n\nThe complete algorithm is as follows:\n1.  Given material parameters $(K, G, \\phi, c, \\psi)$ and a trial stress state $(\\sigma_1^{\\text{tr}}, \\sigma_2^{\\text{tr}}, \\sigma_3^{\\text{tr}})$.\n2.  Calculate the Mohr-Coulomb parameters $M_c$ and $k_c$ and the non-associative flow parameter $M_g$. The input angles $\\phi$ and $\\psi$ in degrees must be converted to radians for trigonometric functions.\n3.  Compute the trial invariants $p^{\\text{tr}}$ and $q^{\\text{tr}}$.\n4.  Evaluate the yield function $f^{\\text{tr}} = q^{\\text{tr}} - M_c p^{\\text{tr}} - k_c$.\n5.  If $f^{\\text{tr}} \\le \\epsilon$ (where $\\epsilon$ is a small tolerance, e.g., $10^{-9}$), the step is elastic. Set $\\Delta\\gamma = 0$ and $\\boldsymbol{\\sigma}^{\\text{new}} = \\boldsymbol{\\sigma}^{\\text{tr}}$.\n6.  If $f^{\\text{tr}}  \\epsilon$, the step is plastic. Compute $\\Delta\\gamma = f^{\\text{tr}} / (3G + K M_c M_g)$.\n7.  Update the invariants: $p^{\\text{new}} = p^{\\text{tr}} + K M_g \\Delta\\gamma$ and $q^{\\text{new}} = q^{\\text{tr}} - 3G\\Delta\\gamma$.\n8.  Reconstruct the new principal stresses: $\\sigma_1^{\\text{new}} = p^{\\text{new}} + \\frac{2}{3}q^{\\text{new}}$ and $\\sigma_2^{\\text{new}} = \\sigma_3^{\\text{new}} = p^{\\text{new}} - \\frac{1}{3}q^{\\text{new}}$.\n9.  The final output for a case is the list $[\\Delta\\gamma, \\sigma_1^{\\text{new}}, \\sigma_2^{\\text{new}}, \\sigma_3^{\\text{new}}]$.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef calculate_update(K, G, phi_deg, c, psi_deg, sigma_tr):\n    \"\"\"\n    Performs a return-mapping update for a Mohr-Coulomb material in axisymmetric compression.\n\n    Args:\n        K (float): Bulk modulus in MPa.\n        G (float): Shear modulus in MPa.\n        phi_deg (float): Friction angle in degrees.\n        c (float): Cohesion in MPa.\n        psi_deg (float): Dilation angle in degrees.\n        sigma_tr (tuple): Trial principal stresses (s1, s2, s3) in MPa.\n\n    Returns:\n        list: A list containing [delta_gamma, s1_new, s2_new, s3_new].\n    \"\"\"\n    # 1. Convert angles to radians\n    phi_rad = np.deg2rad(phi_deg)\n    psi_rad = np.deg2rad(psi_deg)\n\n    # 2. Calculate material constants\n    sin_phi = np.sin(phi_rad)\n    cos_phi = np.cos(phi_rad)\n    sin_psi = np.sin(psi_rad)\n\n    denominator_mc = 3.0 - sin_phi\n    Mc = (6.0 * sin_phi) / denominator_mc\n    kc = (6.0 * c * cos_phi) / denominator_mc\n\n    denominator_mg = 3.0 - sin_psi\n    Mg = (6.0 * sin_psi) / denominator_mg\n\n    # 3. Trial state from principal stresses\n    s1_tr, s2_tr, s3_tr = sigma_tr\n\n    # Calculate trial invariants\n    p_tr = (s1_tr + s2_tr + s3_tr) / 3.0\n    # For axisymmetric compression with s1 = s3, q = s1 - s3\n    q_tr = s1_tr - s3_tr\n\n    # 4. Evaluate yield function at trial state\n    f_tr = q_tr - Mc * p_tr - kc\n\n    # 5. Check for plasticity. Use a small tolerance for floating-point comparison.\n    if f_tr = 1e-9:\n        # Elastic step or on the yield surface\n        delta_gamma = 0.0\n        s1_new, s2_new, s3_new = s1_tr, s2_tr, s3_tr\n    else:\n        # Plastic step: perform return mapping\n        # Calculate plastic multiplier increment\n        denominator_dg = 3.0 * G + K * Mc * Mg\n        delta_gamma = f_tr / denominator_dg\n\n        # Update invariants\n        p_new = p_tr + K * Mg * delta_gamma\n        q_new = q_tr - 3.0 * G * delta_gamma\n\n        # Reconstruct updated principal stresses from new invariants\n        s1_new = p_new + (2.0 / 3.0) * q_new\n        s3_new = p_new - (1.0 / 3.0) * q_new\n        s2_new = s3_new\n\n    return [delta_gamma, s1_new, s2_new, s3_new]\n\ndef solve():\n    \"\"\"\n    Main function to run test cases and print results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (K, G, phi, c, psi, (s1_tr, s2_tr, s3_tr))\n        (5000.0, 3000.0, 30.0, 30.0, 5.0, (50.0, 45.0, 45.0)),\n        (5000.0, 3000.0, 30.0, 5.0, 10.0, (28.0, 1.0, 1.0)),\n        (5000.0, 3000.0, 30.0, 5.0, 10.0, (33.928, 5.536, 5.536)),\n        (5000.0, 3000.0, 30.0, 5.0, 0.0, (28.0, 1.0, 1.0)),\n    ]\n\n    all_results_formatted = []\n    for case in test_cases:\n        K, G, phi, c, psi, sigma_tr = case\n        result = calculate_update(K, G, phi, c, psi, sigma_tr)\n        \n        # Format each number to 6 decimal places and create the list string\n        formatted_numbers = [f\"{num:.6f}\" for num in result]\n        all_results_formatted.append(f\"[{','.join(formatted_numbers)}]\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(all_results_formatted)}]\")\n\nsolve()\n```", "id": "3581296"}]}