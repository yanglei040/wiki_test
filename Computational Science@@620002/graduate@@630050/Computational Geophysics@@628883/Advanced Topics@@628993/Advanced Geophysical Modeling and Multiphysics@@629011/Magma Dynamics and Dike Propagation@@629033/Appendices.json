{"hands_on_practices": [{"introduction": "The relationship between pressure gradient and flux in a dike is governed by the 'cubic law,' where flow rate is highly sensitive to the dike's aperture, $w$. This foundational exercise delves into the consequences of this law by analyzing flow through a channel with a systematically varying aperture. By deriving a dimensionless shape factor, $S$, you will quantify how geometric irregularities enhance the effective hydraulic conductivity of the dike, a crucial concept for realistic flow modeling [@problem_id:3608410].", "problem": "In a magma-filled dike segment idealized as a long, planar fracture, assume steady, incompressible, isothermal flow of a Newtonian melt of dynamic viscosity $\\mu$ under a constant pressure gradient $\\partial p/\\partial x$ along the strike coordinate $x$. The fracture walls are locally parallel over scales large compared to the local aperture $w(x)$, so that the lubrication approximation is valid and inertia is negligible. The no-slip condition holds at the walls.\n\nThe aperture varies periodically along strike as\n$$\nw(x) \\;=\\; \\bar{w}\\,\\bigl(1 + m \\cos(2\\pi x/\\lambda)\\bigr),\n$$\nwith $0  m  1$, mean aperture scale $\\bar{w} > 0$, and wavelength $\\lambda > 0$. Define the spatial average over one wavelength by\n$$\n\\langle f \\rangle \\;=\\; \\frac{1}{\\lambda} \\int_{0}^{\\lambda} f(x)\\, dx.\n$$\n\nTasks:\n- Starting from the steady Stokes equations and the lubrication approximation between parallel plates, derive the local flux per unit out-of-plane thickness $q(x)$ in terms of $w(x)$ and $\\partial p/\\partial x$.\n- Compute the spatially averaged aperture $\\langle w \\rangle$.\n- Compute the shape factor\n$$\nS \\;=\\; \\frac{\\langle w^{3} \\rangle}{\\langle w \\rangle^{3}}\n$$\nfor the cosine-shaped aperture specified above, expressing your final result for $S$ as a closed-form analytic expression in terms of $m$ only.\n- Using the flux expression you derived, interpret how $S$ controls the ratio of the spatially averaged flux in the variable-aperture dike to that in a uniform-aperture dike with aperture $\\langle w \\rangle$, and explain physically why this ratio departs from unity.\n\nYour final reported answer must be the closed-form analytic expression for $S$ only. No numerical evaluation is required and no units should be reported in the final answer box.", "solution": "The problem statement is subjected to validation.\n\n### Step 1: Extract Givens\n- **Flow conditions**: Steady, incompressible, isothermal flow of a Newtonian melt.\n- **Fluid property**: Dynamic viscosity $\\mu$.\n- **Driving force**: Constant pressure gradient $\\partial p/\\partial x$ along the strike coordinate $x$.\n- **Geometry**: A long, planar fracture (dike) with locally parallel walls.\n- **Model**: Lubrication approximation is valid; inertia is negligible.\n- **Boundary conditions**: No-slip condition at the walls.\n- **Aperture function**: $w(x) = \\bar{w}(1 + m \\cos(2\\pi x/\\lambda))$, with constraints $0  m  1$, $\\bar{w} > 0$, and $\\lambda > 0$.\n- **Definition of spatial average**: $\\langle f \\rangle = \\frac{1}{\\lambda} \\int_{0}^{\\lambda} f(x)\\, dx$.\n- **Tasks**:\n  1.  Derive the local flux per unit out-of-plane thickness, $q(x)$.\n  2.  Compute the spatially averaged aperture, $\\langle w \\rangle$.\n  3.  Compute the shape factor $S = \\frac{\\langle w^{3} \\rangle}{\\langle w \\rangle^{3}}$ in terms of $m$.\n  4.  Interpret the physical meaning of $S$ in relation to the average flux.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded**: The problem is based on the Stokes equations for slow, viscous flow, simplified by the lubrication approximation. This is a standard and fundamental model in fluid mechanics (Hele-Shaw flow) and is widely applied in geophysics to model magma flow in dikes. The assumptions (Newtonian fluid, incompressibility, no-slip) are standard for a first-order model. The periodic aperture is a valid idealization of natural fracture roughness or segmentation. The problem is scientifically sound.\n- **Well-Posed**: The problem is well-defined. The governing equations, geometry, and boundary conditions are specified, allowing for the derivation of a unique velocity profile and flux. The tasks are specific, and the mathematical operations (integration, averaging) are standard. The constraint $0  m  1$ ensures that the aperture $w(x) = \\bar{w}(1 + m \\cos(2\\pi x/\\lambda))$ is always positive, since $1 + m \\cos(\\cdot) \\geq 1 - m > 0$, preventing the fracture from closing, which is physically realistic and mathematically convenient.\n- **Objective**: The problem is stated in precise, objective, mathematical language. It contains no subjective claims or opinions.\n\n### Step 3: Verdict and Action\nThe problem is valid. It is a standard exercise in geophysical fluid dynamics that is scientifically sound, well-posed, and objective. A complete solution will be provided.\n\n***\n\nWe address the tasks sequentially.\n\n**Task 1: Derive the local flux $q(x)$**\n\nThe flow is governed by the steady-state Stokes equations for an incompressible fluid with constant viscosity $\\mu$:\n$$\n\\nabla p = \\mu \\nabla^{2}\\mathbf{v}\n$$\nwhere $\\mathbf{v}$ is the velocity vector and $p$ is the pressure. Let $z$ be the coordinate across the aperture, with the walls located at $z = \\pm w(x)/2$. The flow is primarily along the $x$-direction, so $\\mathbf{v} \\approx (u(x,z), 0, 0)$.\n\nThe lubrication approximation assumes that the length scale of variation in the flow direction, $\\lambda$, is much larger than the aperture scale, $\\bar{w}$. This implies that velocity gradients across the aperture are much larger than along it, i.e., $|\\partial u / \\partial z| \\gg |\\partial u / \\partial x|$. The $x$-component of the Stokes equation thus simplifies to:\n$$\n\\frac{\\partial p}{\\partial x} = \\mu \\frac{\\partial^{2} u}{\\partial z^{2}}\n$$\nAt any given location $x$, we can treat $w(x)$ and the constant pressure gradient $\\partial p/\\partial x$ as parameters and integrate with respect to $z$ to find the velocity profile $u(z)$.\n$$\n\\frac{d^{2}u}{dz^{2}} = \\frac{1}{\\mu} \\frac{\\partial p}{\\partial x}\n$$\nIntegrating once with respect to $z$ yields:\n$$\n\\frac{du}{dz} = \\frac{z}{\\mu} \\frac{\\partial p}{\\partial x} + C_{1}\n$$\nIntegrating a second time yields:\n$$\nu(z) = \\frac{z^{2}}{2\\mu} \\frac{\\partial p}{\\partial x} + C_{1}z + C_{2}\n$$\nThe constants of integration, $C_{1}$ and $C_{2}$, are determined by the no-slip boundary conditions at the fracture walls, $u(z = \\pm w(x)/2) = 0$.\n$$\nu\\left(+\\frac{w(x)}{2}\\right) = \\frac{1}{2\\mu}\\frac{\\partial p}{\\partial x}\\left(\\frac{w(x)}{2}\\right)^2 + C_{1}\\frac{w(x)}{2} + C_{2} = 0\n$$\n$$\nu\\left(-\\frac{w(x)}{2}\\right) = \\frac{1}{2\\mu}\\frac{\\partial p}{\\partial x}\\left(-\\frac{w(x)}{2}\\right)^2 - C_{1}\\frac{w(x)}{2} + C_{2} = 0\n$$\nSubtracting the second equation from the first gives $C_{1}w(x) = 0$. Since $w(x) > 0$, we must have $C_{1}=0$. Substituting $C_{1}=0$ into the first equation gives:\n$$\nC_{2} = -\\frac{w(x)^{2}}{8\\mu} \\frac{\\partial p}{\\partial x}\n$$\nThe velocity profile is therefore a parabolic Poiseuille profile:\n$$\nu(z) = \\frac{1}{2\\mu} \\frac{\\partial p}{\\partial x} \\left( z^{2} - \\frac{w(x)^{2}}{4} \\right)\n$$\nThe local flux per unit out-of-plane thickness, $q(x)$, is the integral of this velocity profile across the aperture:\n$$\nq(x) = \\int_{-w(x)/2}^{+w(x)/2} u(z) \\,dz = \\frac{1}{2\\mu} \\frac{\\partial p}{\\partial x} \\int_{-w(x)/2}^{+w(x)/2} \\left( z^{2} - \\frac{w(x)^{2}}{4} \\right) dz\n$$\n$$\nq(x) = \\frac{1}{2\\mu} \\frac{\\partial p}{\\partial x} \\left[ \\frac{z^{3}}{3} - \\frac{w(x)^{2}}{4}z \\right]_{-w(x)/2}^{+w(x)/2}\n$$\n$$\nq(x) = \\frac{1}{2\\mu} \\frac{\\partial p}{\\partial x} \\left[ \\left( \\frac{w(x)^{3}}{24} - \\frac{w(x)^{3}}{8} \\right) - \\left( -\\frac{w(x)^{3}}{24} + \\frac{w(x)^{3}}{8} \\right) \\right]\n$$\n$$\nq(x) = \\frac{1}{2\\mu} \\frac{\\partial p}{\\partial x} \\left[ 2 \\left( \\frac{w(x)^{3}}{24} - \\frac{3w(x)^{3}}{24} \\right) \\right] = \\frac{1}{\\mu} \\frac{\\partial p}{\\partial x} \\left( -\\frac{2w(x)^{3}}{24} \\right)\n$$\n$$\nq(x) = -\\frac{w(x)^{3}}{12\\mu} \\frac{\\partial p}{\\partial x}\n$$\nThis expression relates the local flux to the cube of the local aperture, the fluid viscosity, and the pressure gradient. This is the well-known \"cubic law\" for flow between parallel plates.\n\n**Task 2: Compute the spatially averaged aperture $\\langle w \\rangle$**\n\nThe spatially averaged aperture is given by:\n$$\n\\langle w \\rangle = \\frac{1}{\\lambda} \\int_{0}^{\\lambda} w(x) \\,dx = \\frac{1}{\\lambda} \\int_{0}^{\\lambda} \\bar{w}\\left(1 + m \\cos\\left(\\frac{2\\pi x}{\\lambda}\\right)\\right) dx\n$$\n$$\n\\langle w \\rangle = \\frac{\\bar{w}}{\\lambda} \\left[ \\int_{0}^{\\lambda} 1 \\,dx + m \\int_{0}^{\\lambda} \\cos\\left(\\frac{2\\pi x}{\\lambda}\\right) dx \\right]\n$$\nThe first integral is $\\int_{0}^{\\lambda} 1 \\,dx = \\lambda$. The second integral is over a full period of the cosine function, which evaluates to zero:\n$$\n\\int_{0}^{\\lambda} \\cos\\left(\\frac{2\\pi x}{\\lambda}\\right) dx = \\left[ \\frac{\\lambda}{2\\pi} \\sin\\left(\\frac{2\\pi x}{\\lambda}\\right) \\right]_{0}^{\\lambda} = \\frac{\\lambda}{2\\pi}(\\sin(2\\pi) - \\sin(0)) = 0\n$$\nTherefore, the average aperture is:\n$$\n\\langle w \\rangle = \\frac{\\bar{w}}{\\lambda} [ \\lambda + m \\cdot 0 ] = \\bar{w}\n$$\n\n**Task 3: Compute the shape factor $S$**\n\nThe shape factor is defined as $S = \\frac{\\langle w^{3} \\rangle}{\\langle w \\rangle^{3}}$. We have already found $\\langle w \\rangle = \\bar{w}$, so $\\langle w \\rangle^{3} = \\bar{w}^{3}$. We now need to compute $\\langle w^{3} \\rangle$.\n$$\nw(x)^{3} = \\left[ \\bar{w}\\left(1 + m \\cos\\left(\\frac{2\\pi x}{\\lambda}\\right)\\right) \\right]^{3} = \\bar{w}^{3} \\left(1 + m \\cos\\left(\\frac{2\\pi x}{\\lambda}\\right)\\right)^{3}\n$$\nUsing the binomial expansion $(a+b)^{3} = a^{3} + 3a^{2}b + 3ab^{2} + b^{3}$ with $a=1$ and $b=m \\cos(2\\pi x/\\lambda)$:\n$$\nw(x)^{3} = \\bar{w}^{3} \\left[ 1 + 3m \\cos\\left(\\frac{2\\pi x}{\\lambda}\\right) + 3m^{2} \\cos^{2}\\left(\\frac{2\\pi x}{\\lambda}\\right) + m^{3} \\cos^{3}\\left(\\frac{2\\pi x}{\\lambda}\\right) \\right]\n$$\nNow, we average this expression over one wavelength. By linearity of the averaging operator:\n$$\n\\langle w^{3} \\rangle = \\bar{w}^{3} \\left[ \\langle 1 \\rangle + 3m \\left\\langle \\cos\\left(\\frac{2\\pi x}{\\lambda}\\right) \\right\\rangle + 3m^{2} \\left\\langle \\cos^{2}\\left(\\frac{2\\pi x}{\\lambda}\\right) \\right\\rangle + m^{3} \\left\\langle \\cos^{3}\\left(\\frac{2\\pi x}{\\lambda}\\right) \\right\\rangle \\right]\n$$\nWe evaluate the averages of the trigonometric terms:\n- $\\langle 1 \\rangle = 1$.\n- $\\langle \\cos(2\\pi x/\\lambda) \\rangle = 0$, as shown in Task 2.\n- For $\\langle \\cos^{2}(2\\pi x/\\lambda) \\rangle$, we use the identity $\\cos^{2}\\theta = \\frac{1 + \\cos(2\\theta)}{2}$:\n$$\n\\left\\langle \\cos^{2}\\left(\\frac{2\\pi x}{\\lambda}\\right) \\right\\rangle = \\left\\langle \\frac{1}{2} + \\frac{1}{2}\\cos\\left(\\frac{4\\pi x}{\\lambda}\\right) \\right\\rangle = \\frac{1}{2} \\langle 1 \\rangle + \\frac{1}{2} \\left\\langle \\cos\\left(\\frac{4\\pi x}{\\lambda}\\right) \\right\\rangle\n$$\nThe average of $\\cos(4\\pi x/\\lambda)$ over the interval $[0, \\lambda]$ is also zero. Thus, $\\langle \\cos^{2}(2\\pi x/\\lambda) \\rangle = 1/2$.\n- For $\\langle \\cos^{3}(2\\pi x/\\lambda) \\rangle$, we use the identity $\\cos^{3}\\theta = \\frac{3\\cos\\theta + \\cos(3\\theta)}{4}$:\n$$\n\\left\\langle \\cos^{3}\\left(\\frac{2\\pi x}{\\lambda}\\right) \\right\\rangle = \\left\\langle \\frac{3}{4}\\cos\\left(\\frac{2\\pi x}{\\lambda}\\right) + \\frac{1}{4}\\cos\\left(\\frac{6\\pi x}{\\lambda}\\right) \\right\\rangle = \\frac{3}{4}\\left\\langle \\cos\\left(\\frac{2\\pi x}{\\lambda}\\right) \\right\\rangle + \\frac{1}{4}\\left\\langle \\cos\\left(\\frac{6\\pi x}{\\lambda}\\right) \\right\\rangle\n$$\nBoth averages on the right-hand side are zero, so $\\langle \\cos^{3}(2\\pi x/\\lambda) \\rangle = 0$.\n\nSubstituting these results back into the expression for $\\langle w^{3} \\rangle$:\n$$\n\\langle w^{3} \\rangle = \\bar{w}^{3} \\left[ 1 + 3m(0) + 3m^{2}\\left(\\frac{1}{2}\\right) + m^{3}(0) \\right] = \\bar{w}^{3} \\left( 1 + \\frac{3}{2}m^{2} \\right)\n$$\nFinally, we compute the shape factor $S$:\n$$\nS = \\frac{\\langle w^{3} \\rangle}{\\langle w \\rangle^{3}} = \\frac{\\bar{w}^{3} \\left( 1 + \\frac{3}{2}m^{2} \\right)}{\\bar{w}^{3}} = 1 + \\frac{3}{2}m^{2}\n$$\n\n**Task 4: Interpretation of $S$**\n\nLet's define a constant $C = -\\frac{1}{12\\mu} \\frac{\\partial p}{\\partial x}$. The local flux is $q(x) = C w(x)^{3}$. The spatially averaged flux is $\\langle q \\rangle = \\langle C w(x)^{3} \\rangle = C \\langle w^{3} \\rangle$, since $C$ is constant.\n\nNow consider a uniform-aperture dike whose aperture is equal to the average aperture of our variable dike, i.e., $w_{uniform} = \\langle w \\rangle$. The flux in this uniform dike would be $q_{uniform} = C w_{uniform}^{3} = C \\langle w \\rangle^{3}$.\n\nThe ratio of the average flux in the variable-aperture dike to the flux in the equivalent uniform-aperture dike is:\n$$\n\\frac{\\langle q \\rangle}{q_{uniform}} = \\frac{C \\langle w^{3} \\rangle}{C \\langle w \\rangle^{3}} = \\frac{\\langle w^{3} \\rangle}{\\langle w \\rangle^{3}} = S\n$$\nSo, the shape factor $S$ represents the enhancement of the mean flux due to aperture variability, compared to a uniform channel with the same mean aperture. Since we found $S = 1 + \\frac{3}{2}m^{2}$ and the problem states $0  m  1$, it follows that $S > 1$.\n\nPhysically, this means that the average flow rate through a channel with a variable aperture is always greater than the flow rate through a uniform channel of the same average aperture. This departure from unity is due to the highly nonlinear \"cubic law\" relationship between flux and aperture, $q(x) \\propto w(x)^{3}$. The function $f(w) = w^{3}$ is a convex function for $w>0$. By Jensen's inequality, for any non-constant random variable (or spatially varying function) $w$, the average of the function is greater than the function of the average: $\\langle f(w) \\rangle > f(\\langle w \\rangle)$. In our context, this is $\\langle w^{3} \\rangle > \\langle w \\rangle^{3}$.\n\nThe physical reason is that the wider sections of the dike contribute disproportionately to the total flux. An increase in aperture at a wide spot enhances the flux much more significantly than an equivalent decrease in aperture at a narrow spot reduces it. The flow preferentially exploits the high-conductance pathways offered by the wider segments, leading to an overall higher average flux than would be predicted by simply using the average aperture.", "answer": "$$\n\\boxed{1 + \\frac{3}{2}m^{2}}\n$$", "id": "3608410"}, {"introduction": "A propagating dike is a dynamic system where energy is constantly being partitioned between driving the flow and deforming the surrounding rock. This practice examines this fundamental energy balance in an idealized, steadily propagating dike. By applying principles of mass conservation in a moving reference frame, you will derive the exact ratio between the power lost to viscous dissipation and the rate of elastic energy storage, revealing a surprisingly simple and elegant result [@problem_id:3608413].", "problem": "A vertical magma-filled dike of length $L(t)$ and unit out-of-plane thickness propagates upward through an elastic host rock at a constant tip speed $U=\\mathrm{d}L/\\mathrm{d}t > 0$. The magma is a Newtonian fluid of viscosity $\\mu$. The dike aperture (opening) is $w(x,t)$ for $x\\in[0,L(t)]$, where $x=0$ denotes the inlet and $x=L(t)$ the tip. Assume the following idealized model.\n\n- Lubrication flow in a narrow crack: the volumetric flux $q(x,t)$ satisfies\n$$\nq(x,t)\\;=\\;-\\frac{w(x,t)^{3}}{12\\,\\mu}\\,\\partial_{x} p(x,t),\n$$\nwhere $p(x,t)$ is the net fluid pressure (fluid pressure minus normal stress from the host rock) and $\\partial_{x}$ denotes $\\partial/\\partial x$.\n\n- Incompressible magma with no leak-off into the formation: local conservation of mass gives\n$$\n\\partial_{x} q(x,t)\\;+\\;\\partial_{t} w(x,t)\\;=\\;0.\n$$\n\n- Linear, local elastic compliance of the walls (a plane-strain “local stiffness” or Perkins–Kern–Nordgren-type closure): there is a constant stiffness $k_{e} > 0$ such that\n$$\np(x,t)\\;=\\;k_{e}\\,w(x,t),\n$$\nfor all $x\\in[0,L(t)]$.\n\nAt the propagating tip, $w(L(t),t)=0$ and $p(L(t),t)=0$. Assume a quasi-steady propagation in the frame of the tip so that the shape $w(\\cdot,t)$ and $p(\\cdot,t)$ are stationary functions of the distance to the tip while $L(t)$ increases at the constant rate $U$.\n\nDefine the viscous dissipation power\n$$\nP_{v}(t)\\;=\\;-\\int_{0}^{L(t)} q(x,t)\\,\\partial_{x} p(x,t)\\,\\mathrm{d}x,\n$$\nand the rate of elastic energy storage in the host rock\n$$\n\\dot{U}_{\\mathrm{el}}(t)\\;=\\;\\frac{\\mathrm{d}}{\\mathrm{d}t}\\left[\\int_{0}^{L(t)} \\frac{1}{2}\\,p(x,t)\\,w(x,t)\\,\\mathrm{d}x\\right].\n$$\n\nStarting from the stated governing relations only, derive the exact ratio\n$$\n\\mathcal{R}\\;=\\;\\frac{P_{v}(t)}{\\dot{U}_{\\mathrm{el}}(t)}\n$$\nunder the above steady propagation assumptions. Express your final result as a single dimensionless number with no units. Provide the exact value (no rounding).", "solution": "The problem is first validated to ensure it is scientifically sound, well-posed, and objective. The provided problem statement describes a standard model for the propagation of a fluid-driven fracture, specifically under the Perkins–Kern–Nordgren (PKN) assumptions of a local elastic relationship between pressure and opening. The governing equations for lubrication flow and mass conservation are standard. The concept of a quasi-steady propagation in a moving frame is a valid and common simplification. The definitions for viscous dissipation and elastic energy are standard physical quantities. The problem is self-contained and free of contradictions. Therefore, the problem is deemed valid and a solution can be formulated.\n\nThe objective is to find the ratio $\\mathcal{R} = P_{v}(t) / \\dot{U}_{\\mathrm{el}}(t)$, where $P_{v}(t)$ is the viscous dissipation power and $\\dot{U}_{\\mathrm{el}}(t)$ is the rate of elastic energy storage.\n\nThe problem states that the dike propagates at a constant tip speed $U=\\mathrm{d}L/\\mathrm{d}t$. A key modeling assumption is that the propagation is quasi-steady in a reference frame moving with the tip. Let us define a coordinate $\\xi = L(t) - x$, where $\\xi=0$ is the dike tip and $\\xi = L(t)$ is the inlet. In this frame, the aperture $w$, pressure $p$, and flux $q$ are stationary functions of $\\xi$ alone:\n$w(x,t) = W(\\xi)$\n$p(x,t) = P(\\xi)$\n$q(x,t) = Q(\\xi)$\n\nWe must transform the time and space derivatives from the $(x,t)$ frame to the $\\xi$ frame. Using the chain rule:\n$$\n\\partial_{x} = \\frac{\\partial \\xi}{\\partial x} \\frac{\\mathrm{d}}{\\mathrm{d}\\xi} = -\\frac{\\mathrm{d}}{\\mathrm{d}\\xi}\n$$\n$$\n\\partial_{t} = \\frac{\\partial \\xi}{\\partial t} \\frac{\\mathrm{d}}{\\mathrm{d}\\xi} = \\left(\\frac{\\mathrm{d}L}{\\mathrm{d}t}\\right) \\frac{\\mathrm{d}}{\\mathrm{d}\\xi} = U \\frac{\\mathrm{d}}{\\mathrm{d}\\xi}\n$$\nThe mass conservation equation, $\\partial_{x} q + \\partial_{t} w = 0$, becomes:\n$$\n-\\frac{\\mathrm{d}Q}{\\mathrm{d}\\xi} + U \\frac{\\mathrm{d}W}{\\mathrm{d}\\xi} = 0\n$$\nIntegrating this ordinary differential equation with respect to $\\xi$ yields $Q(\\xi) = U W(\\xi) + C$, where $C$ is an integration constant. At the dike tip ($\\xi=0$), the aperture is zero, so $W(0)=0$. The flux $Q$ at the tip must also be zero (no fluid can flow past the tip), so $Q(0)=0$. This can be confirmed from the lubrication equation $q = - (w^3 / (12\\mu)) \\partial_x p$, which implies $Q=0$ where $W=0$ (assuming $\\partial_x p$ is not infinitely singular in a way to make the product non-zero, which is the case for this physical system). Applying these conditions gives $C=0$. Therefore, we obtain a crucial relationship between flux and aperture in the moving frame:\n$$\nQ(\\xi) = U W(\\xi)\n$$\nThis relation has a clear physical meaning: the flux at any station is the volume of the crack ahead of it, propagating past at speed $U$.\n\nNext, we analyze the rate of elastic energy storage, $\\dot{U}_{\\mathrm{el}}(t)$. The total elastic energy is $U_{\\mathrm{el}}(t) = \\int_{0}^{L(t)} \\frac{1}{2} p(x,t) w(x,t) \\mathrm{d}x$. We differentiate this with respect to time using the Leibniz integral rule:\n$$\n\\dot{U}_{\\mathrm{el}}(t) = \\frac{\\mathrm{d}}{\\mathrm{d}t} \\int_{0}^{L(t)} \\frac{1}{2} p w \\mathrm{d}x = \\frac{1}{2} p(L(t),t) w(L(t),t) \\frac{\\mathrm{d}L}{\\mathrm{d}t} + \\int_{0}^{L(t)} \\frac{1}{2} \\partial_{t}(p w) \\mathrm{d}x\n$$\nThe boundary term at the tip $x=L(t)$ is zero because $w(L(t),t)=0$. Using the elastic law $p = k_e w$, we have $\\partial_t(p w) = \\partial_t(k_e w^2) = 2 k_e w \\partial_t w = 2 p \\partial_t w$. Thus,\n$$\n\\dot{U}_{\\mathrm{el}}(t) = \\int_{0}^{L(t)} \\frac{1}{2} (2 p \\partial_{t}w) \\mathrm{d}x = \\int_{0}^{L(t)} p(x,t) \\partial_{t}w(x,t) \\mathrm{d}x\n$$\nNow, we transform this expression to the $\\xi$ coordinate system. The integration element is $\\mathrm{d}x = -\\mathrm{d}\\xi$, and the limits change from $[0, L(t)]$ to $[L(t), 0]$.\n$$\n\\dot{U}_{\\mathrm{el}}(t) = \\int_{L(t)}^{0} P(\\xi) \\left(U \\frac{\\mathrm{d}W}{\\mathrm{d}\\xi}\\right) (-\\mathrm{d}\\xi) = U \\int_{0}^{L(t)} P(\\xi) \\frac{\\mathrm{d}W}{\\mathrm{d}\\xi} \\mathrm{d}\\xi\n$$\nUsing the elastic law $P(\\xi) = k_e W(\\xi)$:\n$$\n\\dot{U}_{\\mathrm{el}}(t) = U k_e \\int_{0}^{L(t)} W(\\xi) \\frac{\\mathrm{d}W}{\\mathrm{d}\\xi} \\mathrm{d}\\xi\n$$\nNext, we analyze the viscous dissipation power, $P_{v}(t) = -\\int_{0}^{L(t)} q(x,t) \\partial_{x}p(x,t) \\mathrm{d}x$. Transforming to the $\\xi$ coordinate system:\n$$\nP_{v}(t) = -\\int_{L(t)}^{0} Q(\\xi) \\left(-\\frac{\\mathrm{d}P}{\\mathrm{d}\\xi}\\right) (-\\mathrm{d}\\xi) = \\int_{0}^{L(t)} Q(\\xi) \\frac{\\mathrm{d}P}{\\mathrm{d}\\xi} \\mathrm{d}\\xi\n$$\nNow, we substitute the relationships derived from the problem's assumptions. Using $Q(\\xi) = U W(\\xi)$ and $P(\\xi) = k_e W(\\xi)$ (which implies $\\frac{\\mathrm{d}P}{\\mathrm{d}\\xi} = k_e \\frac{\\mathrm{d}W}{\\mathrm{d}\\xi}$):\n$$\nP_{v}(t) = \\int_{0}^{L(t)} \\left(U W(\\xi)\\right) \\left(k_e \\frac{\\mathrm{d}W}{\\mathrm{d}\\xi}\\right) \\mathrm{d}\\xi = U k_e \\int_{0}^{L(t)} W(\\xi) \\frac{\\mathrm{d}W}{\\mathrm{d}\\xi} \\mathrm{d}\\xi\n$$\nBy comparing the final expressions for $\\dot{U}_{\\mathrm{el}}(t)$ and $P_{v}(t)$, we find they are identical:\n$$\nP_{v}(t) = \\dot{U}_{\\mathrm{el}}(t) = U k_e \\int_{0}^{L(t)} W(\\xi) \\, \\frac{\\mathrm{d}W}{\\mathrm{d}\\xi} \\, \\mathrm{d}\\xi\n$$\nThis identity holds for any time $t$ and any corresponding length $L(t)$. It's not even necessary to solve for the shape $W(\\xi)$ to establish this equality. The integral itself evaluates to $\\frac{1}{2} U k_e W(L(t))^2$, but this is not needed to find the ratio.\n\nThe desired ratio $\\mathcal{R}$ is therefore:\n$$\n\\mathcal{R} = \\frac{P_{v}(t)}{\\dot{U}_{\\mathrm{el}}(t)} = 1\n$$\nThis result indicates that for this specific idealized model of steady dike propagation, the power supplied to the system is partitioned equally between viscous dissipation within the fluid and the work done to open the crack (which is stored as elastic energy).", "answer": "$$\\boxed{1}$$", "id": "3608413"}, {"introduction": "While analytical models provide deep insight, quantitative prediction of dike behavior often requires numerical methods. This practice introduces the Boundary Element Method (BEM), a powerful technique for solving the elastic problem of how a dike opens under magmatic pressure. You will implement a BEM solver from first principles, validate it against a known analytical solution, and apply it to a scenario with heterogeneous rock properties, building a core tool for computational geophysics [@problem_id:3608435].", "problem": "You are asked to implement a boundary element method for a two-dimensional, plane-strain, pressurized crack (a magma-filled dike) of finite length embedded in an elastic medium. The crack lies along the $x$-axis from $x=-a$ to $x=+a$, with opening displacement $w(x)$ in the normal direction. The net internal pressure is $p(x)$ (positive in compression on the crack faces), and the medium has plane-strain modulus $E'(x)$ which may vary with position along the crack (to emulate layered host rocks projected onto the crack line). Under the quasi-static, linear elastic, plane-strain approximation, derive a discretized boundary integral equation from fundamental elasticity that relates $p(x)$ to $w(x)$ and implement a numerical solver using constant elements and collocation. Then validate the solver against an analytic solution for a homogeneous medium with uniform pressure.\n\nFundamental base:\n- Linear elasticity in plane strain, with the plane-strain modulus defined as $E' \\equiv E/(1-\\nu^2)$, where $E$ is Young’s modulus and $\\nu$ is Poisson’s ratio.\n- The Mode I traction–opening relation for a straight crack in an infinite medium, expressible as a hypersingular integral equation that, for a homogeneous medium with constant $E'$, relates the net pressure $p(x)$ to the derivative of the opening $w'(s)$ via a Cauchy principal value integral.\n\nDiscretization requirement:\n- Discretize the interval $[-a,a]$ into $N$ constant-opening elements with edges $x_i$ for $i=0,\\dots,N$, where $x_0=-a$, $x_N=+a$, $x_i=-a + i h$, and $h=2a/N$.\n- Let the unknown opening on element $i$ be $w_i$ for $i=1,\\dots,N$, taken as constant over $[x_{i-1},x_i]$.\n- Collocate the traction equation at the element midpoints $x_j^c=(x_{j-1}+x_j)/2$ for $j=1,\\dots,N$.\n- Use the hypersingular integral equation in a piecewise-constant discretization so that the contribution of element $i$ to the traction at collocation point $x_j^c$ is represented by the difference of simple pole terms at the element’s endpoints. Specifically, for a homogeneous medium with constant $E'$, the discrete system has the form\n$$\np(x_j^c) \\;=\\; \\frac{E'}{4\\pi} \\sum_{i=1}^N w_i \\left[ \\frac{1}{x_i - x_j^c} - \\frac{1}{x_{i-1}-x_j^c} \\right], \\quad j=1,\\dots,N.\n$$\n- To emulate layering along the crack line, allow $E'$ to vary with the observation point $x$ by using $E'(x_j^c)$ multiplicatively in each row, i.e.,\n$$\np(x_j^c) \\;=\\; \\frac{E'(x_j^c)}{4\\pi} \\sum_{i=1}^N w_i \\left[ \\frac{1}{x_i - x_j^c} - \\frac{1}{x_{i-1}-x_j^c} \\right], \\quad j=1,\\dots,N,\n$$\nwhich recovers the exact homogeneous kernel when $E'$ is constant.\n\nValidation requirement:\n- For a homogeneous medium with constant $E'$ under uniform internal pressure $p_0$, the analytic opening profile is\n$$\nw_{\\mathrm{ana}}(x) \\;=\\; \\frac{4 p_0 a}{E'} \\sqrt{1 - \\left(\\frac{x}{a}\\right)^2}, \\quad x \\in (-a,a).\n$$\n- You must compute and report errors between the numerical solution and the analytic solution at the collocation points. Use the relative $\\ell^2$ error\n$$\n\\varepsilon_2 \\;=\\; \\sqrt{ \\frac{ \\sum_{j=1}^N \\left( w_j - w_{\\mathrm{ana}}(x_j^c) \\right)^2 }{ \\sum_{j=1}^N \\left( w_{\\mathrm{ana}}(x_j^c) \\right)^2 } }\n$$\nand the relative maximum error\n$$\n\\varepsilon_\\infty \\;=\\; \\frac{ \\max_{1\\le j\\le N} \\left| w_j - w_{\\mathrm{ana}}(x_j^c) \\right| }{ \\max_{1\\le j\\le N} \\left| w_{\\mathrm{ana}}(x_j^c) \\right| }.\n$$\n\nLayered case quantity:\n- For a heterogeneous $E'(x)$ and uniform internal pressure $p_0$, compute the fracture volume per unit thickness,\n$$\nV \\;=\\; \\int_{-a}^{a} w(x)\\, dx,\n$$\nand report it in square meters ($\\mathrm{m}^2$), using the midpoint rule for your piecewise-constant $w_i$ as\n$$\nV \\;\\approx\\; \\sum_{i=1}^N w_i \\, h.\n$$\n\nUnits and conventions:\n- Use meters ($\\mathrm{m}$) for lengths, Pascals ($\\mathrm{Pa}$) for pressures and moduli, and seconds ($\\mathrm{s}$) are not explicitly needed.\n- All reported error metrics $\\varepsilon_2$ and $\\varepsilon_\\infty$ are dimensionless. The fracture volume $V$ must be reported in $\\mathrm{m}^2$.\n- Angles are not used and need not be reported.\n- If any ratio is required, report it as a decimal (not with a percentage sign).\n\nTest suite:\nImplement your program to solve the following three test cases and aggregate the results into a single output line.\n\n- Test case A (homogeneous, fine discretization “happy path”):\n  - Half-length $a = 1500\\,\\mathrm{m}$.\n  - Uniform pressure $p_0 = 3.0\\times 10^6\\,\\mathrm{Pa}$.\n  - Elastic properties: $E=60.0\\times 10^9\\,\\mathrm{Pa}$, $\\nu=0.25$, hence $E' = E/(1-\\nu^2)$.\n  - Number of elements $N=256$.\n  - Output: the relative $\\ell^2$ error $\\varepsilon_2$ as a float.\n\n- Test case B (homogeneous, coarse discretization boundary case):\n  - Same $a$, $p_0$, $E$, $\\nu$ as in Test case A.\n  - Number of elements $N=32$.\n  - Output: the relative maximum error $\\varepsilon_\\infty$ as a float.\n\n- Test case C (piecewise-homogeneous “layered” along-crack modulus):\n  - Same $a$ and $p_0$ as in Test case A.\n  - Poisson’s ratio $\\nu=0.25$ everywhere.\n  - Young’s modulus $E(x)$ is $50.0\\times 10^9\\,\\mathrm{Pa}$ for $x  0$ and $100.0\\times 10^9\\,\\mathrm{Pa}$ for $x \\geq 0$, and $E'(x)=E(x)/(1-\\nu^2)$.\n  - Number of elements $N=256$.\n  - Output: the fracture volume per unit thickness $V$ in $\\mathrm{m}^2$ as a float.\n\nFinal output format:\n- Your program should produce a single line of output containing the three results, in order, as a comma-separated list enclosed in square brackets, i.e.,\n$$\n[\\varepsilon_2,\\varepsilon_\\infty,V].\n$$\nNo additional text should be printed.", "solution": "The user has provided a well-posed problem in computational geophysics, specifically in the domain of magma dynamics and dike propagation. The task is to implement a two-dimensional boundary element method (BEM) to model a pressurized, plane-strain crack, validate it, and apply it to a heterogeneous material case. The problem statement is scientifically grounded in linear elastic fracture mechanics, is self-contained, and provides all necessary equations, parameters, and validation criteria. Therefore, the problem is valid and a solution will be constructed.\n\nThe core of the problem is to solve for the unknown crack opening displacement, $w(x)$, given an internal net pressure, $p(x)$, and the mechanical properties of the surrounding elastic medium. The relationship between these quantities is given by a discretized hypersingular boundary integral equation.\n\nThe provided discrete system of equations is:\n$$\np(x_j^c) \\;=\\; \\frac{E'(x_j^c)}{4\\pi} \\sum_{i=1}^N w_i \\left[ \\frac{1}{x_i - x_j^c} - \\frac{1}{x_{i-1}-x_j^c} \\right], \\quad j=1,\\dots,N.\n$$\nHere, $w_i$ represents the unknown constant opening of the $i$-th element, $p(x_j^c)$ is the known pressure at the $j$-th collocation point (element center), and $E'(x_j^c)$ is the plane-strain modulus at that point. The crack is discretized into $N$ elements of equal length $h = 2a/N$, with element boundaries at $x_i$ for $i=0,\\dots,N$.\n\nThis system of $N$ equations for $N$ unknowns can be formulated as a standard matrix-vector equation. To facilitate the solution, we can rearrange the equation to isolate the unknown Fvector $w$ with components $w_i$. For each collocation point $j$, we have:\n$$\n\\frac{p(x_j^c)}{E'(x_j^c)} = \\sum_{i=1}^N w_i \\left( \\frac{1}{4\\pi} \\left[ \\frac{1}{x_i - x_j^c} - \\frac{1}{x_{i-1}-x_j^c} \\right] \\right)\n$$\nThis is a linear system of the form $\\mathbf{A} \\mathbf{w} = \\mathbf{b}$, where:\n- $\\mathbf{w}$ is the vector of unknown element openings $[w_1, w_2, \\dots, w_N]^T$.\n- $\\mathbf{A}$ is the $N \\times N$ influence matrix, whose entries depend only on the geometry of the discretization. The entry $A_{ji}$ (for row $j$ and column $i$) is given by:\n$$\nA_{ji} = \\frac{1}{4\\pi} \\left[ \\frac{1}{x_i - x_j^c} - \\frac{1}{x_{i-1}-x_j^c} \\right]\n$$\n- $\\mathbf{b}$ is the $N \\times 1$ right-hand side vector, which incorporates the loading and material properties. The $j$-th component is:\n$$\nb_j = \\frac{p(x_j^c)}{E'(x_j^c)}\n$$\n\nThe numerical implementation proceeds as follows:\n\n1.  **Discretization and Mesh Generation**: For a given half-length $a$ and number of elements $N$, the domain $[-a, a]$ is divided. The element boundaries $x_i = -a + i h$ (for $i=0, \\dots, N$) and collocation points $x_j^c = -a + (j-0.5)h$ (for $j=1, \\dots, N$) are computed.\n\n2.  **Matrix and Vector Assembly**:\n    - The geometric influence matrix $\\mathbf{A}$ is constructed. The calculation of its $N^2$ entries can be efficiently vectorized by representing the collocation points and element boundaries as column and row vectors, respectively, and using broadcasting operations.\n    - The right-hand side vector $\\mathbf{b}$ is constructed. This requires evaluating the pressure $p(x)$ and the plane-strain modulus $E'(x)$ at each of the $N$ collocation points. For Test Case C, $E'(x)$ is a piecewise function, which must be evaluated accordingly for each $x_j^c$.\n\n3.  **Solving the System**: The dense linear system $\\mathbf{A} \\mathbf{w} = \\mathbf{b}$ is solved for the opening vector $\\mathbf{w}$ using a standard-library linear algebra solver, such as `numpy.linalg.solve`.\n\n4.  **Post-processing**:\n    - **Validation (Cases A and B)**: For the homogeneous medium, the numerical solution $\\mathbf{w}$ is compared against the analytical solution $w_{\\mathrm{ana}}(x)$ evaluated at the collocation points:\n      $$\n      w_{\\mathrm{ana}}(x) = \\frac{4 p_0 a}{E'} \\sqrt{1 - (x/a)^2}\n      $$\n      The relative $\\ell^2$ error, $\\varepsilon_2$, and the relative maximum error, $\\varepsilon_\\infty$, are computed as per the problem's definitions to quantify the accuracy of the BEM solver.\n    - **Quantity of Interest (Case C)**: For the heterogeneous case, the total fracture volume per unit thickness, $V$, is computed. Using a midpoint-rule approximation consistent with the piecewise-constant opening assumption, the volume is:\n      $$\n      V = \\int_{-a}^{a} w(x) \\,dx \\approx \\sum_{i=1}^N w_i h\n      $$\n\nThe following Python code implements this logic, handling all three specified test cases and producing the output in the required format. The core logic is encapsulated in a function that can handle both constant and variable material properties.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef calculate_bem(a, p0, E_param, nu, N, output_type):\n    \"\"\"\n    Implements a Boundary Element Method for a pressurized crack.\n\n    Args:\n        a (float): Crack half-length in meters.\n        p0 (float): Uniform internal pressure in Pascals.\n        E_param (float or callable): Young's modulus in Pascals.\n                                   If float, it's constant.\n                                   If callable, it's a function E(x).\n        nu (float): Poisson's ratio.\n        N (int): Number of elements.\n        output_type (str): The quantity to compute and return.\n                           'l2_error', 'max_error', or 'volume'.\n\n    Returns:\n        float: The requested output quantity.\n    \"\"\"\n    # 1. Setup mesh\n    h = 2.0 * a / N\n    # Element boundaries (N+1 points, 0-indexed)\n    x_nodes = np.linspace(-a, a, N + 1)\n    # Collocation points (N points, element centers)\n    x_colloc = x_nodes[:-1] + h / 2.0\n\n    # 2. Define E' and p vectors\n    p_vec = np.full(N, p0)\n    \n    if callable(E_param):  # Heterogeneous case\n        E_vals = np.array([E_param(x) for x in x_colloc])\n        E_prime_vals = E_vals / (1.0 - nu**2)\n    else:  # Homogeneous case\n        E_prime_const = E_param / (1.0 - nu**2)\n        E_prime_vals = np.full(N, E_prime_const)\n\n    # 3. Construct the influence matrix A and RHS vector b\n    # The system is A * w = b, where b_j = p_j / E'(x_j^c) and\n    # A_ji = (1/(4*pi)) * [ 1/(x_i - x_j^c) - 1/(x_{i-1} - x_j^c) ]\n    # Using 0-based indexing for i, j in [0, N-1]:\n    # x_i - x_nodes[i+1], x_{i-1} - x_nodes[i], x_j^c - x_colloc[j]\n    \n    x_colloc_col = x_colloc.reshape(-1, 1)    # Shape (N, 1)\n    xi_row = x_nodes[1:].reshape(1, -1)       # Shape (1, N), represents x_i\n    xi_m1_row = x_nodes[:-1].reshape(1, -1)   # Shape (1, N), represents x_{i-1}\n\n    # Broadcasting creates (N, N) matrices\n    term1_matrix = 1.0 / (xi_row - x_colloc_col)\n    term2_matrix = 1.0 / (xi_m1_row - x_colloc_col)\n\n    kernel_matrix = term1_matrix - term2_matrix\n    A = (1.0 / (4.0 * np.pi)) * kernel_matrix\n\n    b_vec = p_vec / E_prime_vals\n\n    # 4. Solve for w\n    w = np.linalg.solve(A, b_vec)\n\n    # 5. Calculate and return the required output\n    if output_type == 'l2_error':\n        E_prime = E_param / (1.0 - nu**2)\n        w_ana = (4.0 * p0 * a / E_prime) * np.sqrt(1.0 - (x_colloc / a)**2)\n        l2_error = np.linalg.norm(w - w_ana) / np.linalg.norm(w_ana)\n        return l2_error\n    \n    elif output_type == 'max_error':\n        E_prime = E_param / (1.0 - nu**2)\n        w_ana = (4.0 * p0 * a / E_prime) * np.sqrt(1.0 - (x_colloc / a)**2)\n        max_error = np.max(np.abs(w - w_ana)) / np.max(np.abs(w_ana))\n        return max_error\n        \n    elif output_type == 'volume':\n        volume = np.sum(w) * h\n        return volume\n        \n    else:\n        raise ValueError(\"Invalid output type specified.\")\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print the final result.\n    \"\"\"\n    # Test Case A: Homogeneous, fine discretization\n    a_A, p0_A, E_A, nu_A, N_A = 1500.0, 3.0e6, 60.0e9, 0.25, 256\n    result_A = calculate_bem(a_A, p0_A, E_A, nu_A, N_A, 'l2_error')\n    \n    # Test Case B: Homogeneous, coarse discretization\n    a_B, p0_B, E_B, nu_B, N_B = 1500.0, 3.0e6, 60.0e9, 0.25, 32\n    result_B = calculate_bem(a_B, p0_B, E_B, nu_B, N_B, 'max_error')\n    \n    # Test Case C: Layered modulus\n    a_C, p0_C, nu_C, N_C = 1500.0, 3.0e6, 0.25, 256\n    def E_func_C(x):\n        return 50.0e9 if x  0 else 100.0e9\n    result_C = calculate_bem(a_C, p0_C, E_func_C, nu_C, N_C, 'volume')\n    \n    results = [result_A, result_B, result_C]\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3608435"}]}