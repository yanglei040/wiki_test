{"hands_on_practices": [{"introduction": "To perform a Direct Numerical Simulation, we must first answer a fundamental question: how fine must our grid and time steps be? The answer lies in the physics of turbulence itself. This first practice challenges you to use dimensional analysis—a cornerstone of fluid mechanics—to derive the smallest scales of turbulent motion, the Kolmogorov scales, directly from the physical properties of the flow [@problem_id:3308663]. Mastering this calculation is the first step toward understanding the immense computational demands of DNS.", "problem": "Consider an incompressible turbulent flow to be simulated by Direct Numerical Simulation (DNS). The fluid has kinematic viscosity $\\,\\nu = 1.5 \\times 10^{-5}\\,\\mathrm{m^2/s}\\,$ and the mean kinetic energy dissipation rate per unit mass $\\,\\epsilon = 0.1\\,\\mathrm{m^2/s^3}\\,$. Starting from the incompressible Navier–Stokes equations and the definition of the dissipation rate, use first-principles dimensional reasoning to deduce the unique small-scale length and time built solely from $\\,\\nu\\,$ and $\\,\\epsilon\\,$ that characterize the smallest dynamically relevant motions of the turbulence. Then, compute the corresponding numerical values of the length scale $\\,\\eta\\,$ and the time scale $\\,\\tau_{\\eta}\\,$ for the given $\\,\\nu\\,$ and $\\,\\epsilon\\,$.\n\nAssume the DNS is to resolve the smallest scales conservatively, with a uniform grid spacing $\\,\\Delta x\\,$ set to one half of the small-scale length and an explicit time-stepping scheme whose time step $\\,\\Delta t\\,$ is one tenth of the small-scale time. Determine $\\,\\Delta x\\,$ and $\\,\\Delta t\\,$ accordingly. Round your answers to four significant figures. Express $\\,\\eta\\,$ and $\\,\\Delta x\\,$ in meters, and $\\,\\tau_{\\eta}\\,$ and $\\,\\Delta t\\,$ in seconds.", "solution": "The problem is well-posed, scientifically sound, and contains all necessary information for a unique solution. The task is to derive the smallest characteristic scales of a turbulent flow, known as the Kolmogorov scales, using dimensional analysis, and then to apply these to determine the required resolution for a Direct Numerical Simulation (DNS).\n\nThe fundamental physical quantities provided are the kinematic viscosity, $\\nu$, and the mean rate of kinetic energy dissipation per unit mass, $\\epsilon$. The incompressible Navier–Stokes equations govern the fluid motion, and it is within the context of these equations that $\\nu$ and $\\epsilon$ find their meaning. The viscosity $\\nu$ is a parameter in the momentum equation, responsible for viscous dissipation of energy. The dissipation rate $\\epsilon$ represents the rate at which kinetic energy is converted into internal energy at the smallest scales of the motion, and it is formally defined from the velocity gradients. In a statistically steady turbulent flow, $\\epsilon$ is also equal to the rate at which energy is supplied at the largest scales.\n\nThe Kolmogorov theory of turbulence postulates that in the inertial range of scales, the statistics of turbulent motions are universally determined by $\\epsilon$ alone, but at the smallest, dissipative scales, the physics must also depend on the kinematic viscosity $\\nu$, which governs the dissipation mechanism. We can therefore deduce the characteristic length, time, and velocity scales of these dissipative motions by finding the unique dimensional combinations of $\\nu$ and $\\epsilon$.\n\nThe physical dimensions of the given quantities are:\n- Kinematic viscosity, $[\\nu] = L^2 T^{-1}$\n- Dissipation rate per unit mass, $[\\epsilon] = L^2 T^{-3}$\n\nFirst, we derive the Kolmogorov length scale, denoted by $\\eta$. We assume that $\\eta$ can be expressed as a product of powers of $\\nu$ and $\\epsilon$:\n$$ \\eta = C \\nu^a \\epsilon^b $$\nwhere $C$ is a dimensionless constant, conventionally taken as $1$. To find the exponents $a$ and $b$, we match the physical dimensions on both sides of the equation:\n$$ [\\eta] = [\\nu]^a [\\epsilon]^b $$\n$$ L^1 T^0 = (L^2 T^{-1})^a (L^2 T^{-3})^b $$\n$$ L^1 T^0 = L^{2a+2b} T^{-a-3b} $$\nEquating the exponents for the dimension of length ($L$) and time ($T$) gives a system of two linear equations:\n1. For $L$: $1 = 2a + 2b$\n2. For $T$: $0 = -a - 3b \\implies a = -3b$\n\nSubstituting the expression for $a$ from the second equation into the first:\n$$ 1 = 2(-3b) + 2b = -6b + 2b = -4b $$\nThis yields $b = -\\frac{1}{4}$. Substituting this value back into the expression for $a$:\n$$ a = -3 \\left(-\\frac{1}{4}\\right) = \\frac{3}{4} $$\nThus, the Kolmogorov length scale $\\eta$ is given by:\n$$ \\eta = \\left( \\frac{\\nu^3}{\\epsilon} \\right)^{1/4} $$\n\nNext, we derive the Kolmogorov time scale, $\\tau_{\\eta}$, using the same dimensional reasoning. We assume:\n$$ \\tau_{\\eta} = K \\nu^c \\epsilon^d $$\nwhere $K$ is another dimensionless constant, also taken as $1$. Matching the dimensions:\n$$ [\\tau_{\\eta}] = [\\nu]^c [\\epsilon]^d $$\n$$ L^0 T^1 = (L^2 T^{-1})^c (L^2 T^{-3})^d $$\n$$ L^0 T^1 = L^{2c+2d} T^{-c-3d} $$\nThis yields another system of linear equations for the exponents $c$ and $d$:\n1. For $L$: $0 = 2c + 2d \\implies c = -d$\n2. For $T$: $1 = -c - 3d$\n\nSubstituting $c = -d$ into the second equation:\n$$ 1 = -(-d) - 3d = d - 3d = -2d $$\nThis yields $d = -\\frac{1}{2}$. Consequently, $c = -(-\\frac{1}{2}) = \\frac{1}{2}$.\nThus, the Kolmogorov time scale $\\tau_{\\eta}$ is given by:\n$$ \\tau_{\\eta} = \\left( \\frac{\\nu}{\\epsilon} \\right)^{1/2} $$\n\nNow, we compute the numerical values of these scales using the provided data: $\\nu = 1.5 \\times 10^{-5}\\,\\mathrm{m^2/s}$ and $\\epsilon = 0.1\\,\\mathrm{m^2/s^3}$.\n\nFor the length scale $\\eta$:\n$$ \\eta = \\left( \\frac{(1.5 \\times 10^{-5}\\,\\mathrm{m^2/s})^3}{0.1\\,\\mathrm{m^2/s^3}} \\right)^{1/4} = \\left( \\frac{3.375 \\times 10^{-15}\\,\\mathrm{m^6/s^3}}{0.1\\,\\mathrm{m^2/s^3}} \\right)^{1/4} $$\n$$ \\eta = (3.375 \\times 10^{-14}\\,\\mathrm{m^4})^{1/4} = (33.75 \\times 10^{-15}\\,\\mathrm{m^4})^{1/4} $$\nTo facilitate the fourth root, we can write this as:\n$$ \\eta = (337.5 \\times 10^{-16}\\,\\mathrm{m^4})^{1/4} = (337.5)^{1/4} \\times 10^{-4}\\,\\mathrm{m} $$\nThe numerical calculation gives:\n$$ \\eta \\approx 4.28689 \\times 10^{-4}\\,\\mathrm{m} $$\nRounding to four significant figures, $\\eta = 4.287 \\times 10^{-4}\\,\\mathrm{m}$.\n\nFor the time scale $\\tau_{\\eta}$:\n$$ \\tau_{\\eta} = \\left( \\frac{1.5 \\times 10^{-5}\\,\\mathrm{m^2/s}}{0.1\\,\\mathrm{m^2/s^3}} \\right)^{1/2} = (1.5 \\times 10^{-4}\\,\\mathrm{s^2})^{1/2} $$\n$$ \\tau_{\\eta} = \\sqrt{1.5} \\times 10^{-2}\\,\\mathrm{s} $$\nThe numerical calculation gives:\n$$ \\tau_{\\eta} \\approx 1.22474 \\times 10^{-2}\\,\\mathrm{s} $$\nRounding to four significant figures, $\\tau_{\\eta} = 1.225 \\times 10^{-2}\\,\\mathrm{s}$.\n\nFinally, we determine the DNS grid spacing $\\Delta x$ and time step $\\Delta t$ based on the problem's criteria for resolving these smallest scales.\nThe spatial resolution is set to half the Kolmogorov length:\n$$ \\Delta x = \\frac{\\eta}{2} = \\frac{4.28689 \\times 10^{-4}\\,\\mathrm{m}}{2} \\approx 2.143445 \\times 10^{-4}\\,\\mathrm{m} $$\nRounding to four significant figures, $\\Delta x = 2.143 \\times 10^{-4}\\,\\mathrm{m}$.\n\nThe temporal resolution is set to one-tenth of the Kolmogorov time:\n$$ \\Delta t = \\frac{\\tau_{\\eta}}{10} = \\frac{1.22474 \\times 10^{-2}\\,\\mathrm{s}}{10} \\approx 1.22474 \\times 10^{-3}\\,\\mathrm{s} $$\nRounding to four significant figures, $\\Delta t = 1.225 \\times 10^{-3}\\,\\mathrm{s}$.\n\nThe computed values are:\n- Kolmogorov length scale, $\\eta = 4.287 \\times 10^{-4}\\,\\mathrm{m}$\n- Kolmogorov time scale, $\\tau_{\\eta} = 1.225 \\times 10^{-2}\\,\\mathrm{s}$\n- DNS grid spacing, $\\Delta x = 2.143 \\times 10^{-4}\\,\\mathrm{m}$\n- DNS time step, $\\Delta t = 1.225 \\times 10^{-3}\\,\\mathrm{s}$\nThese values will be presented in the final answer as a row matrix.", "answer": "$$ \\boxed{\n\\begin{pmatrix}\n4.287 \\times 10^{-4} & 1.225 \\times 10^{-2} & 2.143 \\times 10^{-4} & 1.225 \\times 10^{-3}\n\\end{pmatrix}\n} $$", "id": "3308663"}, {"introduction": "Building upon the concept of Kolmogorov scales, this exercise provides a comprehensive, real-world estimation of the resources needed for a full DNS. You will connect the large-scale flow characteristics, defined by the Reynolds number, to the micro-scale resolution requirements for both space and time [@problem_id:3308685]. This practice is designed to give you a tangible feel for why DNS is so computationally expensive and how its cost scales dramatically, making it a 'grand challenge' problem in computational science.", "problem": "A cubic domain of edge length $L$ is filled with water of kinematic viscosity $\\nu$. A characteristic large-scale velocity $U$ is sustained in the flow. A researcher intends to perform Direct Numerical Simulation (DNS) of the three-dimensional incompressible Navier–Stokes equations in this domain, using a uniform Cartesian grid and an explicit time integrator for the advective terms.\n\nGiven $U = 0.1\\ \\mathrm{m/s}$, $L = 0.1\\ \\mathrm{m}$, and $\\nu = 10^{-6}\\ \\mathrm{m^2/s}$, proceed as follows.\n\n1) Starting from the definition of the Reynolds number as the ratio of inertial to viscous effects, compute the Reynolds number $Re$ of the flow.\n\n2) Using the Kolmogorov 1941 phenomenology for high-Reynolds-number turbulence and the definition of the energy dissipation rate per unit mass $\\epsilon$, derive the Kolmogorov length scale $\\eta$ and the Kolmogorov time scale $\\tau_{\\eta}$ in terms of $U$, $L$, and $\\nu$. Clearly state any order-of-magnitude assumptions you adopt that relate $\\epsilon$ to $U$ and $L$.\n\n3) For DNS, require the grid spacing $\\Delta x$ to be no larger than the Kolmogorov length scale, i.e., $\\Delta x = \\eta$. For a cubic domain of size $L \\times L \\times L$, determine the number of grid points per direction $N_{d}$ and the total number of grid control volumes $N_{\\text{total}}$ needed to resolve down to $\\eta$.\n\n4) For the explicit time integrator, adopt a Courant–Friedrichs–Lewy (CFL) advective stability constraint with a maximum Courant number $C_{\\mathrm{CFL}} = 0.5$, and also consider an explicit viscous stability constraint with coefficient $C_{\\nu} = 0.5$. Starting from first principles for these stability conditions, determine the stable time step $\\Delta t$ by taking the more restrictive of the advective and viscous limits. Express $\\Delta t$ in $\\mathrm{s}$.\n\n5) Using the large-eddy turnover time $T = L/U$ as the characteristic simulation horizon, estimate the number of time steps $N_{\\text{steps}} = T/\\Delta t$ required to simulate one turnover time. Then discuss, in terms of scaling with $Re$, how $N_{\\text{total}}$ and $N_{\\text{steps}}$ contribute to the computational cost of DNS.\n\nReport the estimated total number of grid control volumes $N_{\\text{total}}$ as your final, unitless answer, rounded to two significant figures. All intermediate quantities in your derivation should be expressed in International System of Units (SI), and angles, if any, must be in radians.", "solution": "The problem is subjected to validation and is deemed valid as it is scientifically grounded in the principles of computational fluid dynamics and turbulence theory, is well-posed with a clear objective and sufficient data, and is free of any inconsistencies or ambiguities.\n\nThe solution proceeds by addressing each of the five parts of the problem in sequence. All calculations are performed using the provided values in SI units.\n\n**1) Reynolds Number Calculation**\n\nThe Reynolds number, $Re$, is a dimensionless quantity that represents the ratio of inertial forces to viscous forces within a fluid. For a flow characterized by a length scale $L$, a velocity scale $U$, and a kinematic viscosity $\\nu$, it is defined as:\n$$\nRe = \\frac{\\text{Inertial forces}}{\\text{Viscous forces}} \\sim \\frac{\\rho U^2 / L}{\\mu U / L^2} = \\frac{UL}{\\mu/\\rho} = \\frac{UL}{\\nu}\n$$\nwhere $\\rho$ is the fluid density and $\\mu$ is the dynamic viscosity.\nGiven the values $U = 0.1\\ \\mathrm{m/s}$, $L = 0.1\\ \\mathrm{m}$, and $\\nu = 10^{-6}\\ \\mathrm{m^2/s}$:\n$$\nRe = \\frac{(0.1\\ \\mathrm{m/s})(0.1\\ \\mathrm{m})}{10^{-6}\\ \\mathrm{m^2/s}} = \\frac{0.01}{10^{-6}} = 10000 = 10^4\n$$\nThis value indicates that the flow is in the turbulent regime, as $Re$ is significantly greater than the typical critical values for transition to turbulence.\n\n**2) Kolmogorov Scales Derivation**\n\nAccording to the Kolmogorov 1941 (K41) theory for homogeneous and isotropic turbulence at high Reynolds numbers, there is an energy cascade where energy is injected at the large scales and dissipated into heat at the smallest scales. The rate of energy dissipation per unit mass, $\\epsilon$, is a key parameter.\nIt is assumed that in the inertial subrange, the rate of energy transfer is constant and equal to the rate of energy injection at the large scales. The rate of energy injection is dimensionally proportional to $U^3/L$. We adopt the order-of-magnitude assumption:\n$$\n\\epsilon \\approx \\frac{U^3}{L}\n$$\nUsing the given values:\n$$\n\\epsilon \\approx \\frac{(0.1\\ \\mathrm{m/s})^3}{0.1\\ \\mathrm{m}} = \\frac{0.001}{0.1}\\ \\mathrm{m^2/s^3} = 0.01\\ \\mathrm{m^2/s^3}\n$$\nThe Kolmogorov length scale, $\\eta$, is the smallest length scale in the flow, where viscosity dominates and kinetic energy is dissipated. It is defined by dimensional analysis as:\n$$\n\\eta = \\left(\\frac{\\nu^3}{\\epsilon}\\right)^{1/4}\n$$\nSubstituting the expression for $\\epsilon$:\n$$\n\\eta \\approx \\left(\\frac{\\nu^3}{U^3/L}\\right)^{1/4} = \\left(\\frac{\\nu^3 L}{U^3}\\right)^{1/4} = L \\left(\\frac{\\nu^3}{U^3 L^3}\\right)^{1/4} = L \\left(\\frac{\\nu}{UL}\\right)^{3/4} = L Re^{-3/4}\n$$\nNumerically:\n$$\n\\eta = \\left(\\frac{(10^{-6}\\ \\mathrm{m^2/s})^3}{0.01\\ \\mathrm{m^2/s^3}}\\right)^{1/4} = \\left(\\frac{10^{-18}}{10^{-2}}\\right)^{1/4} = (10^{-16})^{1/4}\\ \\mathrm{m} = 10^{-4}\\ \\mathrm{m}\n$$\nThe Kolmogorov time scale, $\\tau_{\\eta}$, is the characteristic time scale of the smallest eddies. It is defined by dimensional analysis as:\n$$\n\\tau_{\\eta} = \\left(\\frac{\\nu}{\\epsilon}\\right)^{1/2}\n$$\nSubstituting the expression for $\\epsilon$:\n$$\n\\tau_{\\eta} \\approx \\left(\\frac{\\nu}{U^3/L}\\right)^{1/2} = \\left(\\frac{\\nu L}{U^3}\\right)^{1/2} = \\frac{L}{U} \\left(\\frac{\\nu}{UL}\\right)^{1/2} = \\frac{L}{U} Re^{-1/2}\n$$\nNumerically:\n$$\n\\tau_{\\eta} = \\left(\\frac{10^{-6}\\ \\mathrm{m^2/s}}{0.01\\ \\mathrm{m^2/s^3}}\\right)^{1/2} = (10^{-4})^{1/2}\\ \\mathrm{s} = 10^{-2}\\ \\mathrm{s}\n$$\n\n**3) Grid Resolution for DNS**\n\nDirect Numerical Simulation (DNS) resolves all turbulent scales, down to the Kolmogorov length scale $\\eta$. Therefore, the grid spacing $\\Delta x$ must be on the order of $\\eta$. The problem specifies the requirement:\n$$\n\\Delta x = \\eta = 10^{-4}\\ \\mathrm{m}\n$$\nThe computational domain is a cube of side length $L = 0.1\\ \\mathrm{m}$. For a uniform Cartesian grid, the number of grid points required in each direction, $N_d$, is:\n$$\nN_d = \\frac{L}{\\Delta x} = \\frac{0.1\\ \\mathrm{m}}{10^{-4}\\ \\mathrm{m}} = 10^3\n$$\nThe total number of grid control volumes, $N_{\\text{total}}$, for the three-dimensional domain is:\n$$\nN_{\\text{total}} = N_d \\times N_d \\times N_d = N_d^3 = (10^3)^3 = 10^9\n$$\n\n**4) Stable Time Step Calculation**\n\nFor an explicit time integration scheme, the time step $\\Delta t$ is limited by stability constraints. We consider both the advective and viscous constraints.\n\nThe advective stability is governed by the Courant–Friedrichs–Lewy (CFL) condition. For a 1D problem, it is $C = U \\Delta t / \\Delta x \\le C_{\\text{max}}$.  For a 3D flow with characteristic velocity $U$ and uniform grid spacing $\\Delta x$, the advective time step limit, $\\Delta t_{\\text{adv}}$, is given by:\n$$\n\\Delta t_{\\text{adv}} \\le \\frac{C_{\\mathrm{CFL}} \\Delta x}{U}\n$$\nWith the given maximum Courant number $C_{\\mathrm{CFL}} = 0.5$:\n$$\n\\Delta t_{\\text{adv}} = \\frac{(0.5)(10^{-4}\\ \\mathrm{m})}{0.1\\ \\mathrm{m/s}} = 0.5 \\times 10^{-3}\\ \\mathrm{s} = 5 \\times 10^{-4}\\ \\mathrm{s}\n$$\nThe viscous stability constraint for an explicit scheme applied to the diffusion term is of the form:\n$$\n\\Delta t_{\\text{visc}} \\le \\frac{C_{\\nu} (\\Delta x)^2}{\\nu}\n$$\nThis form is a common simplification; a more rigorous analysis for a 3D central difference scheme yields a denominator of $6\\nu$. However, following the problem's simplified structure with a given coefficient $C_{\\nu}=0.5$:\n$$\n\\Delta t_{\\text{visc}} = \\frac{(0.5)(10^{-4}\\ \\mathrm{m})^2}{10^{-6}\\ \\mathrm{m^2/s}} = \\frac{0.5 \\times 10^{-8}}{10^{-6}}\\ \\mathrm{s} = 0.5 \\times 10^{-2}\\ \\mathrm{s} = 5 \\times 10^{-3}\\ \\mathrm{s}\n$$\nThe overall stable time step $\\Delta t$ must satisfy both conditions. Therefore, we must choose the more restrictive (smaller) of the two:\n$$\n\\Delta t = \\min(\\Delta t_{\\text{adv}}, \\Delta t_{\\text{visc}}) = \\min(5 \\times 10^{-4}\\ \\mathrm{s}, 5 \\times 10^{-3}\\ \\mathrm{s}) = 5 \\times 10^{-4}\\ \\mathrm{s}\n$$\n\n**5) Simulation Time and Computational Cost Scaling**\n\nThe characteristic time horizon for the simulation is given by the large-eddy turnover time, $T$:\n$$\nT = \\frac{L}{U} = \\frac{0.1\\ \\mathrm{m}}{0.1\\ \\mathrm{m/s}} = 1\\ \\mathrm{s}\n$$\nThe total number of time steps, $N_{\\text{steps}}$, required to simulate one turnover time is:\n$$\nN_{\\text{steps}} = \\frac{T}{\\Delta t} = \\frac{1\\ \\mathrm{s}}{5 \\times 10^{-4}\\ \\mathrm{s}} = \\frac{1}{0.0005} = 2000\n$$\nThe computational cost of a DNS is proportional to the total number of floating-point operations, which scales with the product of the total number of grid points and the total number of time steps. We can analyze the scaling of this cost with the Reynolds number $Re$.\n\nThe number of grid points per direction scales as $N_d = L/\\eta = L/(L Re^{-3/4}) = Re^{3/4}$.\nThe total number of grid points scales as:\n$$\nN_{\\text{total}} = N_d^3 = (Re^{3/4})^3 = Re^{9/4}\n$$\nThe time step $\\Delta t$ is the minimum of two scalings:\n$\\Delta t_{\\text{adv}} \\sim \\frac{\\Delta x}{U} \\sim \\frac{\\eta}{U} = \\frac{L Re^{-3/4}}{U} = T Re^{-3/4}$\n$\\Delta t_{\\text{visc}} \\sim \\frac{(\\Delta x)^2}{\\nu} \\sim \\frac{\\eta^2}{\\nu} = \\frac{L^2 Re^{-3/2}}{\\nu} = \\frac{L}{U} Re \\cdot Re^{-3/2} = T Re^{-1/2}$\nFor high Reynolds number ($Re \\gg 1$), we have $Re^{-3/4} < Re^{-1/2}$, making the advective CFL condition more restrictive.\nThus, $\\Delta t \\sim T Re^{-3/4}$.\n\nThe number of time steps scales as:\n$$\nN_{\\text{steps}} = \\frac{T}{\\Delta t} \\sim \\frac{T}{T Re^{-3/4}} = Re^{3/4}\n$$\nThe total computational cost, Cost, is therefore:\n$$\n\\text{Cost} \\propto N_{\\text{total}} \\times N_{\\text{steps}} \\sim Re^{9/4} \\times Re^{3/4} = Re^{12/4} = Re^3\n$$\nThis cubic scaling with the Reynolds number highlights the prohibitive computational expense of DNS for high-$Re$ flows.\n\nThe problem asks for the numerical value of $N_{\\text{total}}$, rounded to two significant figures. From part 3), we found $N_{\\text{total}} = 10^9$. Expressed in scientific notation with two significant figures, this is $1.0 \\times 10^9$.", "answer": "$$\\boxed{1.0 \\times 10^9}$$", "id": "3308685"}, {"introduction": "While many DNS approaches use grid-based methods like finite differences, high-accuracy spectral methods resolve the flow in Fourier (or wavenumber) space. This practice shifts our perspective from real-space grid spacing $\\Delta x$ to the spectral resolution cutoff $k_{\\max}$ [@problem_id:3308664]. You will learn how resolution is defined for a Fourier pseudospectral method and tackle a critical practical issue: de-aliasing, a technique essential for obtaining accurate results with this class of methods.", "problem": "Consider Direct Numerical Simulation (DNS) of incompressible turbulence using a Fourier pseudospectral method with the standard Fast Fourier Transform (FFT) on a three-dimensional periodic cube of side length $2\\pi$. The computational grid uses $N$ equispaced collocation points in each spatial direction, so the total number of grid points is $N^{3}$. The Fourier wavenumbers are defined by the Discrete Fourier Transform (DFT) on this domain, so that the fundamental wavenumber spacing is $\\Delta k = 2\\pi / (2\\pi) = 1$, and one-dimensional wavenumber components are integers.\n\nAssume the $2/3$ de-aliasing rule is applied component-wise: all Fourier modes with any component satisfying $|k_{i}| &gt; N/3$ are set to zero to remove aliasing errors from quadratic nonlinearities. Define the resolved spectral cutoff as the maximum resolved one-dimensional wavenumber component, denoted $k_{\\max}$, that is retained by this $2/3$ de-aliasing mask.\n\nStarting only from the definitions above and fundamental properties of the Fourier grid on a periodic domain, derive an expression for $k_{\\max}$ in terms of $N$ under the $2/3$ de-aliasing rule on a $2\\pi$-periodic domain. Then impose the small-scale resolution requirement $k_{\\max}\\,\\eta = 1.7$, where $\\eta$ is the Kolmogorov length scale. For a given $\\eta = 0.01$, determine the smallest integer $N$ that exactly satisfies $k_{\\max}\\,\\eta = 1.7$ under the preceding definition of $k_{\\max}$.\n\nProvide only the integer value of $N$ as your final answer. No units are required. No rounding is needed, since the requested quantity is an integer.", "solution": "The problem statement is first validated to ensure it is scientifically sound, well-posed, and objective.\n\n**Step 1: Extract Givens**\n- **Simulation:** Direct Numerical Simulation (DNS) of incompressible turbulence.\n- **Method:** Fourier pseudospectral method with FFT.\n- **Domain:** $3$D periodic cube of side length $L = 2\\pi$.\n- **Grid:** $N$ equispaced points per direction, total $N^3$ points.\n- **Wavenumbers:** One-dimensional wavenumber components, $k_i$, are integers, consistent with a fundamental wavenumber $\\Delta k = 2\\pi/L = 2\\pi/(2\\pi) = 1$.\n- **De-aliasing Rule:** The $2/3$ rule is defined as setting all Fourier modes to zero for which any component satisfies $|k_i| > N/3$.\n- **Cutoff Wavenumber Definition:** $k_{\\max}$ is the maximum resolved one-dimensional wavenumber component retained after de-aliasing.\n- **Resolution Requirement:** $k_{\\max} \\eta = 1.7$.\n- **Given Value:** Kolmogorov length scale, $\\eta = 0.01$.\n- **Objective:** Find the smallest integer $N$ that exactly satisfies the resolution requirement.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded:** The problem is a standard exercise in computational fluid dynamics (CFD), specifically concerning the resolution requirements for DNS using spectral methods. The $2/3$ de-aliasing rule is a canonical technique, and the resolution criterion $k_{\\max}\\eta \\approx C$ (with $C$ typically between $1.5$ and $2.0$) is a well-established heuristic for resolving the smallest turbulent scales. The setup is physically and mathematically consistent.\n- **Well-Posed:** The problem provides all necessary definitions and values to arrive at a unique integer solution for $N$. The definitions of $k_{\\max}$ and the de-aliasing rule are unambiguous.\n- **Objective:** The problem is stated in precise, formal language, free of subjective or vague terms.\n\n**Step 3: Verdict and Action**\nThe problem is deemed **valid**. A detailed solution follows.\n\nThe core of the problem lies in first establishing a relationship between the number of grid points in one dimension, $N$, and the maximum resolved wavenumber, $k_{\\max}$, under the specified $2/3$ de-aliasing rule.\n\nAccording to the problem statement, the simulation is performed on a periodic cube of side length $2\\pi$. The basis functions for the Fourier representation are of the form $\\exp(i \\mathbf{k} \\cdot \\mathbf{x})$, where $\\mathbf{k} = (k_1, k_2, k_3)$ is the wavenumber vector. For a domain of length $L_i = 2\\pi$ in each direction $i$, the components of the wavenumber vector, $k_i$, must be integers to satisfy the periodicity condition.\n\nThe $2/3$ de-aliasing rule is explicitly defined: a Fourier mode is discarded if any of its wavenumber components $k_i$ has a magnitude greater than $N/3$. This is expressed as the condition for discarding a mode:\n$$ |k_i| > \\frac{N}{3} \\quad \\text{for any } i \\in \\{1, 2, 3\\} $$\nConsequently, a mode is retained only if all of its wavenumber components satisfy the opposite condition:\n$$ |k_i| \\le \\frac{N}{3} \\quad \\text{for all } i \\in \\{1, 2, 3\\} $$\nThe problem defines $k_{\\max}$ as the maximum resolved one-dimensional wavenumber component. This corresponds to the maximum integer value that any $|k_i|$ can assume for a retained mode. Based on the condition above, this maximum value is the largest integer that does not exceed $N/3$. This can be formally expressed using the floor function:\n$$ k_{\\max} = \\left\\lfloor \\frac{N}{3} \\right\\rfloor $$\nThis equation provides the derived expression for $k_{\\max}$ in terms of $N$.\n\nNext, we impose the small-scale resolution requirement, which is given as:\n$$ k_{\\max} \\eta = 1.7 $$\nWe are provided with the value of the Kolmogorov length scale, $\\eta = 0.01$. Substituting this value into the resolution requirement yields:\n$$ k_{\\max} \\times 0.01 = 1.7 $$\nSolving for $k_{\\max}$:\n$$ k_{\\max} = \\frac{1.7}{0.01} = 170 $$\nNow we have determined the necessary value for the maximum resolved wavenumber. The next step is to find the smallest integer $N$ that produces this value of $k_{\\max}$. We use the relationship derived earlier:\n$$ \\left\\lfloor \\frac{N}{3} \\right\\rfloor = 170 $$\nBy the definition of the floor function, if $\\lfloor x \\rfloor = m$ for an integer $m$, then it must be that $m \\le x < m+1$. Applying this to our equation:\n$$ 170 \\le \\frac{N}{3} < 170 + 1 $$\n$$ 170 \\le \\frac{N}{3} < 171 $$\nTo find the range for $N$, we multiply the inequality by $3$:\n$$ 170 \\times 3 \\le N < 171 \\times 3 $$\n$$ 510 \\le N < 513 $$\nSince $N$ must be an integer, the possible values for $N$ that satisfy the condition are $510$, $511$, and $512$. The problem asks for the *smallest* integer $N$ that satisfies the criterion. From the set of possible values $\\{510, 511, 512\\}$, the smallest is $510$.\n\nTo verify, if $N=510$, then $k_{\\max} = \\lfloor 510/3 \\rfloor = \\lfloor 170 \\rfloor = 170$. This satisfies $k_{\\max}\\eta = 170 \\times 0.01 = 1.7$ exactly. If $N$ were any smaller, for instance $N=509$, then $k_{\\max} = \\lfloor 509/3 \\rfloor = \\lfloor 169.66... \\rfloor = 169$. This would give $k_{\\max}\\eta = 1.69$, which would not satisfy the resolution requirement. Therefore, the smallest integer $N$ is $510$.", "answer": "$$\n\\boxed{510}\n$$", "id": "3308664"}]}