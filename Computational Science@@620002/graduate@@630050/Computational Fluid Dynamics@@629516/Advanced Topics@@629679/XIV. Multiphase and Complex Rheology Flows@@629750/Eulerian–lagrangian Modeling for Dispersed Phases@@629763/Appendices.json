{"hands_on_practices": [{"introduction": "The foundation of any Lagrangian particle tracking model lies in accurately describing the motion of a single particle. Before tackling complex turbulent flows and particle-particle interactions, it is essential to master the fundamental dynamics governed by Newton's second law. This first exercise [@problem_id:3315838] provides a hands-on derivation of the transient velocity of a particle settling in a quiescent fluid, allowing you to derive and understand two cornerstone concepts: the particle momentum relaxation time, $\\tau_p$, and the terminal velocity, $v_t$.", "problem": "A single, rigid, spherical particle of diameter $d$ and density $\\rho_p$ is tracked in a Lagrangian frame as it settles under gravity in an otherwise quiescent, infinite Newtonian fluid of density $\\rho_f$ and dynamic viscosity $\\mu$. The particle is released from rest at time $t=0$ with velocity $v_p(0)=0$ along the vertical axis, with the positive direction taken downward. Assume that the particle is sufficiently heavy and small that the flow around it remains in the Stokes regime and that the only hydrodynamic force is the linear Stokes drag. Neglect added mass, history (Basset) force, lift, and Faxén corrections. Gravitational and buoyant forces act in the usual way. Use the following as fundamental base: Newton’s second law for the particle and the Stokes drag law, $F_D=3\\pi\\mu d\\,(v_p-u)$, where $u$ is the local fluid velocity, here $u=0$.\n\nStarting from first principles, derive an explicit, closed-form expression for the transient particle velocity $v_p(t)$ for $t\\ge 0$. Then, determine the minimal time $t_{0.05}$ such that the particle speed is within $5$ percent of its terminal speed, i.e., $|v_t - v_p(t_{0.05})| = 0.05\\,v_t$, where $v_t$ is the terminal velocity emerging from your derivation. Express your results entirely in terms of $\\rho_p$, $\\rho_f$, $\\mu$, $d$, $g$, and $t$. Express the timescale in seconds.\n\nProvide your final answer as a single row matrix containing the two closed-form expressions $\\big[v_p(t),\\,t_{0.05}\\big]$. No numerical evaluation is required.", "solution": "The problem statement is critically evaluated for validity before proceeding to a solution.\n\n### Step 1: Extract Givens\n-   **Particle properties**: single, rigid, spherical, diameter $d$, density $\\rho_p$.\n-   **Fluid properties**: quiescent, infinite, Newtonian, density $\\rho_f$, dynamic viscosity $\\mu$.\n-   **Initial condition**: $v_p(0) = 0$ at $t=0$.\n-   **Coordinate system**: positive direction is downward along the vertical axis.\n-   **Physical model**:\n    -   Framework: Lagrangian tracking of the particle.\n    -   Governing law: Newton's second law.\n    -   Included forces: Gravity, Buoyancy, Stokes drag.\n    -   Stokes drag law: $F_D=3\\pi\\mu d\\,(v_p-u)$.\n    -   Fluid velocity: $u=0$.\n    -   Neglected effects: Added mass, history (Basset) force, lift, Faxén corrections.\n-   **Objectives**:\n    1.  Derive the transient particle velocity $v_p(t)$ for $t \\ge 0$.\n    2.  Determine the time $t_{0.05}$ such that $|v_t - v_p(t_{0.05})| = 0.05\\,v_t$, where $v_t$ is the terminal velocity.\n-   **Output requirements**: Express results in terms of $\\rho_p$, $\\rho_f$, $\\mu$, $d$, $g$, and $t$. Provide the final answer as a single row matrix $\\begin{pmatrix} v_p(t) & t_{0.05} \\end{pmatrix}$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is assessed against the validation criteria.\n-   **Scientifically Grounded**: Yes. The problem describes the classical setup for particle settling at low Reynolds numbers, based on Newton's second law and the Stokes drag model. This is a fundamental and well-established topic in fluid mechanics.\n-   **Well-Posed**: Yes. The problem describes a first-order linear ordinary differential equation with a specified initial condition. This structure guarantees that a unique and stable solution exists.\n-   **Objective**: Yes. The problem is stated using precise, quantitative, and unambiguous scientific language.\n-   **Flaw Analysis**:\n    1.  **Scientific Unsoundness**: None. The physical model is a standard, valid simplification for the specified regime.\n    2.  **Non-Formalizable/Irrelevant**: The problem is directly formalizable into a solvable differential equation and is highly relevant to Eulerian-Lagrangian modeling in computational fluid dynamics.\n    3.  **Incomplete/Contradictory Setup**: No. All necessary parameters ($\\rho_p$, $\\rho_f$, $\\mu$, $d$, $g$) and conditions ($v_p(0)=0$) are provided.\n    4.  **Unrealistic/Infeasible**: No. The conditions are physically plausible for a wide range of real-world scenarios, such as sedimentation of fine particles.\n    5.  **Ill-Posed**: No. As established, the problem is well-posed.\n    6.  **Trivial/Tautological**: No. While a textbook problem, it requires a complete derivation from first principles, demonstrating core competencies in mechanics and differential equations.\n    7.  **Outside Scientific Verifiability**: No. The solution is mathematically derivable and physically verifiable.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. A full, reasoned solution will be provided.\n\n### Solution Derivation\nThe motion of the particle is governed by Newton's second law, which states that the net force on the particle is equal to its mass times its acceleration.\n$$m_p \\frac{dv_p}{dt} = \\sum F$$\nThe particle is spherical with diameter $d$. Its volume is $V_p = \\frac{1}{6}\\pi d^3$, and its mass is $m_p = \\rho_p V_p = \\frac{1}{6}\\pi d^3 \\rho_p$. The forces acting on the particle in the vertical direction (positive downward) are gravity, buoyancy, and drag.\n\n1.  **Gravitational Force ($F_g$)**: Acts downward (positive).\n    $$F_g = m_p g = \\frac{1}{6}\\pi d^3 \\rho_p g$$\n\n2.  **Buoyant Force ($F_b$)**: Acts upward (negative), equal to the weight of the displaced fluid.\n    $$F_b = -V_p \\rho_f g = -\\frac{1}{6}\\pi d^3 \\rho_f g$$\n\n3.  **Stokes Drag Force ($F_D$)**: Acts upward (negative) as it opposes the downward motion of the particle. The problem specifies the form $F_D = 3\\pi\\mu d (v_p-u)$. With the fluid being quiescent ($u=0$), the drag force opposing the velocity $v_p$ is:\n    $$F_D = -3\\pi\\mu d v_p$$\n\nSumming the forces yields the equation of motion:\n$$m_p \\frac{dv_p}{dt} = F_g + F_b + F_D$$\n$$\\frac{1}{6}\\pi d^3 \\rho_p \\frac{dv_p}{dt} = \\frac{1}{6}\\pi d^3 \\rho_p g - \\frac{1}{6}\\pi d^3 \\rho_f g - 3\\pi\\mu d v_p$$\nGroup the terms:\n$$\\frac{1}{6}\\pi d^3 \\rho_p \\frac{dv_p}{dt} = \\frac{1}{6}\\pi d^3 (\\rho_p - \\rho_f)g - 3\\pi\\mu d v_p$$\nTo simplify, we isolate the derivative term $\\frac{dv_p}{dt}$:\n$$\\frac{dv_p}{dt} = \\frac{\\frac{1}{6}\\pi d^3 (\\rho_p - \\rho_f)g}{\\frac{1}{6}\\pi d^3 \\rho_p} - \\frac{3\\pi\\mu d}{\\frac{1}{6}\\pi d^3 \\rho_p} v_p$$\n$$\\frac{dv_p}{dt} = \\frac{(\\rho_p - \\rho_f)g}{\\rho_p} - \\frac{18\\mu}{d^2 \\rho_p} v_p$$\nThis is a first-order linear ordinary differential equation. We can define two important parameters. First, the terminal velocity $v_t$ is reached when the acceleration is zero ($\\frac{dv_p}{dt}=0$).\n$$0 = \\frac{(\\rho_p - \\rho_f)g}{\\rho_p} - \\frac{18\\mu}{d^2 \\rho_p} v_t$$\nSolving for $v_t$:\n$$v_t = \\frac{(\\rho_p - \\rho_f)g}{\\rho_p} \\cdot \\frac{d^2 \\rho_p}{18\\mu} = \\frac{g d^2 (\\rho_p - \\rho_f)}{18\\mu}$$\nThis is the Stokes settling velocity. We assume $\\rho_p > \\rho_f$ for settling to occur, making $v_t>0$.\n\nSecond, we define the particle momentum relaxation time, $\\tau_p$, which is the inverse of the coefficient of $v_p$:\n$$\\tau_p = \\frac{d^2 \\rho_p}{18\\mu}$$\nThe equation of motion can now be rewritten compactly in terms of $v_t$ and $\\tau_p$:\n$$\\frac{dv_p}{dt} = \\frac{v_t}{\\tau_p} - \\frac{1}{\\tau_p}v_p = \\frac{1}{\\tau_p}(v_t - v_p)$$\nThis is a separable differential equation:\n$$\\frac{dv_p}{v_t - v_p} = \\frac{dt}{\\tau_p}$$\nWe integrate both sides from the initial state ($t=0, v_p=0$) to a general state ($t, v_p(t)$):\n$$\\int_0^{v_p(t)} \\frac{dv'}{v_t - v'} = \\int_0^t \\frac{dt'}{\\tau_p}$$\n$$\\left[-\\ln(v_t - v')\\right]_0^{v_p(t)} = \\frac{t}{\\tau_p}$$\n$$-\\ln(v_t - v_p(t)) + \\ln(v_t - 0) = \\frac{t}{\\tau_p}$$\n$$\\ln\\left(\\frac{v_t}{v_t - v_p(t)}\\right) = \\frac{t}{\\tau_p}$$\nExponentiating both sides:\n$$\\frac{v_t}{v_t - v_p(t)} = \\exp\\left(\\frac{t}{\\tau_p}\\right)$$\nRearranging to solve for $v_p(t)$:\n$$v_t - v_p(t) = v_t \\exp\\left(-\\frac{t}{\\tau_p}\\right)$$\n$$v_p(t) = v_t \\left(1 - \\exp\\left(-\\frac{t}{\\tau_p}\\right)\\right)$$\nSubstituting the full expressions for $v_t$ and $\\tau_p$ yields the first part of the answer:\n$$v_p(t) = \\frac{g d^2 (\\rho_p - \\rho_f)}{18\\mu} \\left(1 - \\exp\\left(-\\frac{18\\mu t}{d^2 \\rho_p}\\right)\\right)$$\nNext, we find the time $t_{0.05}$ at which the particle's speed is within $5\\%$ of its terminal speed. The condition is $|v_t - v_p(t_{0.05})| = 0.05 v_t$. Since $v_p(t)$ approaches $v_t$ from below ($v_p(t) \\le v_t$), we can drop the absolute value:\n$$v_t - v_p(t_{0.05}) = 0.05 v_t$$\nThis simplifies to $v_p(t_{0.05}) = 0.95 v_t$. Using our transient solution for $v_p(t)$:\n$$v_t \\left(1 - \\exp\\left(-\\frac{t_{0.05}}{\\tau_p}\\right)\\right) = 0.95 v_t$$\nAssuming $v_t \\neq 0$, we divide by $v_t$:\n$$1 - \\exp\\left(-\\frac{t_{0.05}}{\\tau_p}\\right) = 0.95$$\n$$\\exp\\left(-\\frac{t_{0.05}}{\\tau_p}\\right) = 1 - 0.95 = 0.05$$\nTaking the natural logarithm of both sides:\n$$-\\frac{t_{0.05}}{\\tau_p} = \\ln(0.05)$$\n$$t_{0.05} = -\\tau_p \\ln(0.05) = \\tau_p \\ln\\left(\\frac{1}{0.05}\\right) = \\tau_p \\ln(20)$$\nSubstituting the expression for $\\tau_p = \\frac{d^2 \\rho_p}{18\\mu}$:\n$$t_{0.05} = \\frac{d^2 \\rho_p \\ln(20)}{18\\mu}$$\nThis expression has units of time, which is consistent with the prompt.\n\nThe final answer requires a row matrix containing the two derived expressions.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{g d^2 (\\rho_p - \\rho_f)}{18\\mu} \\left(1 - \\exp\\left(-\\frac{18\\mu t}{d^2 \\rho_p}\\right)\\right) & \\frac{d^2 \\rho_p \\ln(20)}{18\\mu}\n\\end{pmatrix}\n}\n$$", "id": "3315838"}, {"introduction": "The coupling between the dispersed and continuous phases is dominated by the drag force, making its accurate modeling critical for the fidelity of the simulation. While the analytical Stokes drag law provides a clean theoretical starting point, its validity is restricted to the creeping flow regime ($Re_p \\ll 1$). This practice [@problem_id:3315848] delves into the practical world of drag correlations by comparing the Stokes law to the widely-used Schiller–Naumann model, giving you a quantitative feel for the importance of choosing an appropriate drag closure for finite particle Reynolds numbers.", "problem": "In Eulerian–Lagrangian modeling of a dilute dispersed phase in Computational Fluid Dynamics (CFD), the drag force on a rigid spherical particle of diameter $d$ in a Newtonian fluid of density $\\rho_f$ and dynamic viscosity $\\mu$ is modeled using the relative slip speed $u_{\\text{slip}}$, where the particle Reynolds number is defined as $Re_p = \\rho_f u_{\\text{slip}} d / \\mu$. The general drag force is $F_D = \\tfrac{1}{2} \\rho_f u_{\\text{slip}}^{2} A_p C_D$, where $A_p = \\pi d^{2}/4$ is the projected area and $C_D$ is the drag coefficient. In the creeping-flow limit, the Stokes drag law holds: $F_S = 3 \\pi \\mu d \\, u_{\\text{slip}}$. For finite $Re_p \\lesssim 10^{3}$, a widely used empirical correlation for a rigid sphere is the Schiller–Naumann drag coefficient, $C_D = 24/Re_p \\left(1 + 0.15 \\, Re_p^{0.687}\\right)$.\n\n- Using only these definitions and laws, derive the expression for the Schiller–Naumann drag force $F_{\\text{SN}}$ in terms of the Stokes drag $F_S$ and the particle Reynolds number $Re_p$. Then, by taking the limit $Re_p \\to 0$, prove asymptotic consistency with Stokes law and determine the leading-order relative deviation in terms of $Re_p$.\n\n- Using your derived expression, define the relative error incurred by using the Stokes drag to estimate the drag when the baseline is taken to be the Schiller–Naumann drag, i.e., $E = |F_S - F_{\\text{SN}}| / F_{\\text{SN}}$, and evaluate $E$ at $Re_p = 100$. Report the final value of $E$ as a unitless decimal, rounded to four significant figures. Do not express the answer with a percentage sign.", "solution": "The problem is scientifically grounded, well-posed, objective, and internally consistent, containing all necessary information for a unique solution. Therefore, we proceed with the derivation and calculation.\n\nThe first part of the problem requires deriving the expression for the Schiller–Naumann drag force, $F_{\\text{SN}}$, in terms of the Stokes drag force, $F_S$, and the particle Reynolds number, $Re_p$.\n\nThe general expression for drag force on a particle is given by:\n$$F_D = \\frac{1}{2} \\rho_f u_{\\text{slip}}^{2} A_p C_D$$\nwhere $\\rho_f$ is the fluid density, $u_{\\text{slip}}$ is the relative slip speed, $A_p$ is the projected area of the sphere, and $C_D$ is the drag coefficient. For a spherical particle of diameter $d$, the projected area is $A_p = \\frac{\\pi d^2}{4}$.\n\nThe Schiller–Naumann drag force, $F_{\\text{SN}}$, is obtained by substituting the corresponding drag coefficient, $C_{D, \\text{SN}} = \\frac{24}{Re_p} \\left(1 + 0.15 \\, Re_p^{0.687}\\right)$, into the general drag force equation:\n$$F_{\\text{SN}} = \\frac{1}{2} \\rho_f u_{\\text{slip}}^{2} \\left(\\frac{\\pi d^2}{4}\\right) \\left[ \\frac{24}{Re_p} \\left(1 + 0.15 \\, Re_p^{0.687}\\right) \\right]$$\n\nTo simplify this expression, we use the definition of the particle Reynolds number, $Re_p = \\frac{\\rho_f u_{\\text{slip}} d}{\\mu}$, where $\\mu$ is the dynamic viscosity of the fluid. We can substitute for the term $\\frac{1}{Re_p}$:\n$$F_{\\text{SN}} = \\frac{1}{2} \\rho_f u_{\\text{slip}}^{2} \\frac{\\pi d^2}{4} \\left( \\frac{24 \\mu}{\\rho_f u_{\\text{slip}} d} \\right) \\left(1 + 0.15 \\, Re_p^{0.687}\\right)$$\n\nNow, we simplify the coefficients and variables:\n$$F_{\\text{SN}} = \\left(\\frac{24 \\pi}{8}\\right) \\left(\\rho_f u_{\\text{slip}}^{2} d^2 \\frac{\\mu}{\\rho_f u_{\\text{slip}} d}\\right) \\left(1 + 0.15 \\, Re_p^{0.687}\\right)$$\n$$F_{\\text{SN}} = 3 \\pi \\left( u_{\\text{slip}} d \\mu \\right) \\left(1 + 0.15 \\, Re_p^{0.687}\\right)$$\n\nWe recognize the term $3 \\pi \\mu d u_{\\text{slip}}$ as the Stokes drag force, $F_S$. Therefore, we can write the Schiller–Naumann drag force as:\n$$F_{\\text{SN}} = F_S \\left(1 + 0.15 \\, Re_p^{0.687}\\right)$$\nThis is the desired expression for $F_{\\text{SN}}$ in terms of $F_S$ and $Re_p$.\n\nNext, we must prove asymptotic consistency with Stokes law by taking the limit as $Re_p \\to 0$.\n$$\\lim_{Re_p \\to 0} F_{\\text{SN}} = \\lim_{Re_p \\to 0} \\left[ F_S \\left(1 + 0.15 \\, Re_p^{0.687}\\right) \\right]$$\nSince the exponent $0.687 > 0$, the term $Re_p^{0.687}$ approaches $0$ as $Re_p$ approaches $0$.\n$$\\lim_{Re_p \\to 0} F_{\\text{SN}} = F_S (1 + 0.15 \\times 0) = F_S$$\nThis shows that in the creeping-flow limit ($Re_p \\to 0$), the Schiller–Naumann model correctly reduces to the Stokes drag law.\n\nThe leading-order relative deviation of $F_{\\text{SN}}$ from $F_S$ for small $Re_p$ is given by the difference divided by $F_S$:\n$$\\frac{F_{\\text{SN}} - F_S}{F_S} = \\frac{F_S \\left(1 + 0.15 \\, Re_p^{0.687}\\right) - F_S}{F_S} = \\frac{F_S \\left(0.15 \\, Re_p^{0.687}\\right)}{F_S} = 0.15 \\, Re_p^{0.687}$$\nThis is the leading-order correction term.\n\nThe second part of the problem requires calculating the relative error $E = \\frac{|F_S - F_{\\text{SN}}|}{F_{\\text{SN}}}$ when $Re_p = 100$.\nUsing the relationship derived above, we substitute for $F_S$ and $F_{\\text{SN}}$:\n$$E = \\frac{|F_S - F_S \\left(1 + 0.15 \\, Re_p^{0.687}\\right)|}{F_S \\left(1 + 0.15 \\, Re_p^{0.687}\\right)}$$\n$$E = \\frac{|- 0.15 \\, F_S \\, Re_p^{0.687}|}{F_S \\left(1 + 0.15 \\, Re_p^{0.687}\\right)}$$\nSince $F_S > 0$ and $Re_p > 0$, the expression in the numerator is positive after taking the absolute value. We can also cancel $F_S$:\n$$E = \\frac{0.15 \\, Re_p^{0.687}}{1 + 0.15 \\, Re_p^{0.687}}$$\n\nNow, we evaluate this expression for $Re_p = 100$:\n$$E = \\frac{0.15 \\times (100)^{0.687}}{1 + 0.15 \\times (100)^{0.687}}$$\nFirst, we calculate the value of $(100)^{0.687}$:\n$$(100)^{0.687} \\approx 23.65864$$\nNext, we substitute this value into the expression for $E$:\n$$E \\approx \\frac{0.15 \\times 23.65864}{1 + 0.15 \\times 23.65864}$$\n$$E \\approx \\frac{3.548796}{1 + 3.548796} = \\frac{3.548796}{4.548796}$$\n$$E \\approx 0.780162$$\n\nThe problem requires the answer to be rounded to four significant figures.\n$$E \\approx 0.7802$$\nThis is the relative error incurred by using Stokes drag instead of the Schiller–Naumann drag at $Re_p = 100$.", "answer": "$$\\boxed{0.7802}$$", "id": "3315848"}, {"introduction": "In two-way or four-way coupled simulations, the influence of the dispersed phase on the carrier fluid is accounted for by transferring momentum, mass, and energy from the Lagrangian particles back to the Eulerian grid. This 'deposition' or 'projection' step is a critical source of numerical error and must be designed carefully to conserve physical quantities while minimizing artificial diffusion. This hands-on coding exercise [@problem_id:3315881] guides you through the implementation and comparison of several common deposition kernels, from the simple Nearest-Grid-Point (NGP) scheme to higher-order B-splines, providing direct insight into their impact on the accuracy and conservation properties of the coupled system.", "problem": "Consider a one-dimensional periodic domain of length $L$ with $N$ uniform Eulerian cells of width $\\Delta x = L/N$ and centers at $x_i = (i + \\tfrac{1}{2})\\Delta x$ for $i \\in \\{0,1,\\dots,N-1\\}$. A dispersed phase is represented in a Lagrangian manner by $M$ particles located at positions $x_p \\in [0,L)$ with weights $w_p \\ge 0$ that represent particle number. The goal is to map the Lagrangian particles to an Eulerian cell-averaged number density field $\\rho_i$ in a way that is conservative and minimizes numerical diffusion of particle number density. Conservation of particle number means the discrete integral of the deposited density equals the total particle number, i.e., $\\sum_{i=0}^{N-1} \\rho_i \\Delta x = \\sum_{p=1}^{M} w_p$. Numerical diffusion can be quantified by the increase in the second central moment (variance) of the field after deposition compared to the particle distribution.\n\nStarting from the following fundamental base:\n- Newtonian kinematics for particle positions, $v = dx/dt$, focusing here on static deposition (no particle motion during mapping).\n- Conservation of particle number expressed as $\\int_0^L \\rho(x)\\,dx = \\sum_{p=1}^M w_p$.\n- The representation of the particle number density as a sum of Dirac delta distributions, $\\rho(x) = \\sum_{p=1}^M w_p \\delta(x - x_p)$, and its grid-based approximation by replacing $\\delta$ with a normalized assignment kernel.\n\nDefine a family of particle-to-mesh deposition operators that map particles to the discrete field by\n$$\n\\rho_i = \\frac{1}{\\Delta x} \\sum_{p=1}^M w_p\\, \\mathcal{W}(x_p - x_i),\n$$\nwhere $\\mathcal{W}$ is a compactly supported, normalized assignment kernel that satisfies a discrete partition-of-unity on the grid,\n$$\n\\sum_{i=0}^{N-1} \\mathcal{W}(x_p - x_i) = 1 \\quad \\text{for all particle positions } x_p,\n$$\nwith periodic boundary conditions.\n\nImplement and compare the following three assignment schemes:\n1. Nearest-Grid-Point (NGP): Assign each particle entirely to its nearest cell center. This corresponds to a zero-order B-spline kernel with unit mass and support over one cell.\n2. Cloud-In-Cell (CIC): Distribute each particle between the two nearest cell centers using a first-order hat function in one dimension. This corresponds to a first-order B-spline kernel with unit mass and support over two cells.\n3. Cubic B-spline: Use the third-order B-spline kernel with support over four cells and piecewise definition,\n$$\n\\phi(u) =\n\\begin{cases}\n\\frac{4 - 6u^2 + 3u^3}{6}, & 0 \\le u < 1, \\\\\n\\frac{(2 - u)^3}{6}, & 1 \\le u < 2, \\\\\n0, & u \\ge 2,\n\\end{cases}\n$$\nwhere $u$ is the distance from the particle to a cell center in units of $\\Delta x$, and the periodic discrete partition-of-unity is enforced by summing over the four nearest centers.\n\nTo quantify numerical diffusion, use the second central moment (variance) on the periodic domain. Let the particle number be $N_{\\text{tot}} = \\sum_{p=1}^{M} w_p$. Define the circular mean position $\\mu \\in [0,L)$ by mapping positions to angles $\\theta_p = 2\\pi x_p / L$, computing the complex mean $z = \\left(\\sum_p w_p e^{i \\theta_p}\\right)/N_{\\text{tot}}$, taking $\\bar{\\theta} = \\arg(z)$, and setting $\\mu = (\\bar{\\theta} \\bmod 2\\pi)\\,L/(2\\pi)$. Define the minimal periodic difference $\\mathrm{wrap}_L(d) = d - L \\,\\mathrm{round}(d/L)$ so that $\\mathrm{wrap}_L(d) \\in [-L/2,L/2)$. Then compute the particle second moment\n$$\n\\sigma^2_{\\text{part}} = \\frac{1}{N_{\\text{tot}}}\\sum_{p=1}^{M} w_p\\, \\mathrm{wrap}_L(x_p - \\mu)^2,\n$$\nand the grid second moment for a deposited field $\\rho_i$ using the same $\\mu$,\n$$\n\\sigma^2_{\\text{grid}} = \\frac{1}{N_{\\text{tot}}}\\sum_{i=0}^{N-1} \\rho_i\\, \\mathrm{wrap}_L(x_i - \\mu)^2 \\, \\Delta x.\n$$\nDefine the numerical diffusion for a scheme as the increase in variance, $\\Delta \\sigma^2 = \\sigma^2_{\\text{grid}} - \\sigma^2_{\\text{part}}$.\n\nTask:\n- Implement the three deposition schemes described above in a periodic one-dimensional domain.\n- Ensure conservation, i.e., $\\sum_i \\rho_i \\Delta x = \\sum_p w_p$, up to numerical rounding.\n- Compute the numerical diffusion $\\Delta \\sigma^2$ for each scheme for each test case below.\n- Output, for each test case, a list of six floats in the order\n$[\\varepsilon_{\\text{NGP}}, \\varepsilon_{\\text{CIC}}, \\varepsilon_{\\text{B3}}, \\Delta \\sigma^2_{\\text{NGP}}, \\Delta \\sigma^2_{\\text{CIC}}, \\Delta \\sigma^2_{\\text{B3}}]$,\nwhere $\\varepsilon$ is the absolute conservation error defined by $\\varepsilon = \\left|\\sum_i \\rho_i \\Delta x - \\sum_p w_p\\right|$ and $\\Delta \\sigma^2$ is the variance increase as defined above. All numbers must be expressed as dimensionless floats, rounded to ten decimal places.\n\nPhysical and numerical parameters:\n- Domain length $L = 1$ (dimensionless).\n- Grid sizes and particle sets as follows.\n\nTest suite (use these exact parameters with the same random seeds for reproducibility):\n1. Gaussian cluster away from boundaries (happy path): $N=64$, $M=20000$, particle positions $x_p$ sampled independently from a normal distribution with mean $0.35$ and standard deviation $0.03$, then mapped into $[0,1)$ by modulo $L$; equal weights $w_p=1$. Use random seed $12345$.\n2. Narrow Gaussian cluster near the periodic boundary (boundary stress): $N=64$, $M=20000$, particle positions sampled from a normal distribution with mean $0.98$ and standard deviation $0.01$, wrapped into $[0,1)$; equal weights $w_p=1$. Use random seed $23456$.\n3. Single particle at the boundary (edge case): $N=64$, $M=1$, $x_1 = 0.0$, $w_1 = 1$.\n4. Uniform distribution (aliasing sanity): $N=64$, $M=20000$, particle positions sampled uniformly on $[0,1)$; equal weights $w_p=1$. Use random seed $34567$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list of lists enclosed in square brackets. Specifically, print\n$[[t_1],[t_2],[t_3],[t_4]]$,\nwhere $[t_k]$ is the six-float list for test case $k$, in the order specified above, with each float rounded to ten decimal places. No additional text should be printed.", "solution": "We begin from conservation of particle number and the mathematical representation of a dispersed phase. In one dimension, a collection of $M$ particles at positions $x_p$ with weights $w_p$ has a continuous number density given formally by\n$$\n\\rho(x) = \\sum_{p=1}^{M} w_p \\delta(x - x_p),\n$$\nwhere $\\delta$ is the Dirac delta distribution. The total particle number is conserved:\n$$\n\\int_{0}^{L} \\rho(x)\\, dx = \\sum_{p=1}^{M} w_p = N_{\\text{tot}}.\n$$\nAn Eulerian representation uses cell-averaged densities $\\rho_i$ on a uniform grid with cell centers $x_i$ and width $\\Delta x$. To obtain a discrete mapping that preserves conservation, we replace $\\delta$ with an assignment kernel $\\mathcal{W}$ that is normalized in the discrete sense. Specifically, the deposition operator is\n$$\n\\rho_i = \\frac{1}{\\Delta x} \\sum_{p=1}^{M} w_p\\, \\mathcal{W}(x_p - x_i),\n$$\nand we require that for each particle position $x_p$, the kernel satisfies the partition of unity on the discrete grid:\n$$\n\\sum_{i=0}^{N-1} \\mathcal{W}(x_p - x_i) = 1,\n$$\nunder periodic boundary conditions. Then conservation follows directly:\n$$\n\\sum_{i=0}^{N-1} \\rho_i \\Delta x = \\sum_{i=0}^{N-1} \\sum_{p=1}^{M} w_p \\mathcal{W}(x_p - x_i) = \\sum_{p=1}^{M} w_p \\left(\\sum_{i=0}^{N-1} \\mathcal{W}(x_p - x_i)\\right) = \\sum_{p=1}^{M} w_p = N_{\\text{tot}}.\n$$\n\nWe now define three specific kernels $\\mathcal{W}$, each a member of the family of B-spline assignment functions, expressed in one dimension:\n1. Nearest-Grid-Point (NGP) corresponds to the zero-order B-spline. For a particle at $x_p$, its contribution goes entirely to the nearest center $x_j$, i.e., $\\mathcal{W}(x_p - x_i) = 1$ if $i=j$ and $0$ otherwise. This trivially satisfies the partition of unity and conserves mass.\n2. Cloud-In-Cell (CIC) corresponds to the first-order B-spline, a piecewise linear hat function that linearly distributes weight between the two nearest centers. If $s = x_p/\\Delta x - 1/2$ is the particle coordinate relative to the grid of centers in units of cells, and $j = \\lfloor s \\rfloor$, then with $f = s - j \\in [0,1)$, $\\mathcal{W}$ assigns weights $(1-f)$ and $f$ to centers $j$ and $j+1$ (wrapped periodically). The discrete sum of weights is $(1-f)+f=1$.\n3. The cubic ($3$rd-order) B-spline has compact support over four neighboring centers. Let $u$ denote the distance in cell units between $x_p$ and a center $x_i$: $u = |x_p - x_i|/\\Delta x$. The kernel value is\n$$\n\\phi(u) =\n\\begin{cases}\n\\frac{4 - 6u^2 + 3u^3}{6}, & 0 \\le u < 1, \\\\\n\\frac{(2 - u)^3}{6}, & 1 \\le u < 2, \\\\\n0, & u \\ge 2.\n\\end{cases}\n$$\nFor a particle with fractional coordinate $s$, contributions are nonzero only to the four neighboring centers with indices $j + k$ for $k \\in \\{-1,0,1,2\\}$, where $j = \\lfloor s \\rfloor$, with distances $u_k = |s - (j+k)|$. The partition of unity property holds, i.e., $\\sum_{k=-1}^{2} \\phi(u_k) = 1$ for any $s$, ensuring conservation.\n\nTo assess numerical diffusion, we compare the second central moment (variance) of the particle distribution to that of the deposited grid field. On a periodic domain, the usual Euclidean mean is not appropriate near the boundary. Instead, we define the circular mean using angles $\\theta_p = 2\\pi x_p/L$, computing\n$$\nz = \\frac{1}{N_{\\text{tot}}} \\sum_{p=1}^{M} w_p e^{i \\theta_p}, \\quad \\bar{\\theta} = \\arg(z), \\quad \\mu = \\frac{L}{2\\pi} (\\bar{\\theta} \\bmod 2\\pi).\n$$\nWe measure squared distances using the minimal periodic difference\n$$\n\\mathrm{wrap}_L(d) = d - L \\,\\mathrm{round}\\!\\left(\\frac{d}{L}\\right) \\in \\left[-\\frac{L}{2}, \\frac{L}{2}\\right).\n$$\nThe particle variance is then\n$$\n\\sigma^2_{\\text{part}} = \\frac{1}{N_{\\text{tot}}} \\sum_{p=1}^{M} w_p \\, \\mathrm{wrap}_L(x_p - \\mu)^2,\n$$\nand the grid variance is\n$$\n\\sigma^2_{\\text{grid}} = \\frac{1}{N_{\\text{tot}}} \\sum_{i=0}^{N-1} \\rho_i \\, \\mathrm{wrap}_L(x_i - \\mu)^2 \\, \\Delta x.\n$$\nThe numerical diffusion introduced by the deposition is the increase in variance\n$$\n\\Delta \\sigma^2 = \\sigma^2_{\\text{grid}} - \\sigma^2_{\\text{part}}.\n$$\nA conservative deposition has $\\varepsilon = \\left|\\sum_i \\rho_i \\Delta x - \\sum_p w_p\\right| \\approx 0$. A less diffusive scheme yields smaller $\\Delta \\sigma^2$ for smooth distributions. For a single particle (a discrete delta), higher-order kernels spread the mass more widely and thus can yield a larger $\\Delta \\sigma^2$, whereas for smooth clustered distributions, higher-order kernels typically better suppress aliasing and reduce effective diffusion.\n\nAlgorithmic design:\n- Precompute grid centers $x_i$ and $\\Delta x$ from $L$ and $N$.\n- For each scheme:\n  - Initialize $\\rho_i = 0$.\n  - For each particle, compute the relative coordinate $s = x_p/\\Delta x - 1/2$ and apply periodic indexing to determine affected cells and weights according to the kernel, updating $\\rho$ by adding $w_p$ times the kernel weights divided by $\\Delta x$. Periodicity is handled by modular arithmetic on indices.\n  - After deposition, compute conservation error $\\varepsilon = \\left|\\sum_i \\rho_i \\Delta x - N_{\\text{tot}}\\right|$.\n- For each test case:\n  - Generate particle positions $x_p$ with specified distributions and weights $w_p$.\n  - Compute the circular mean $\\mu$ and particle variance $\\sigma^2_{\\text{part}}$.\n  - Deposit using NGP, CIC, and cubic B-spline to obtain $\\rho^{\\text{NGP}}$, $\\rho^{\\text{CIC}}$, and $\\rho^{\\text{B3}}$.\n  - Compute $\\sigma^2_{\\text{grid}}$ for each deposited field using the same $\\mu$ to isolate diffusion, and then $\\Delta \\sigma^2$.\n  - Record the six-tuple $[\\varepsilon_{\\text{NGP}}, \\varepsilon_{\\text{CIC}}, \\varepsilon_{\\text{B3}}, \\Delta \\sigma^2_{\\text{NGP}}, \\Delta \\sigma^2_{\\text{CIC}}, \\Delta \\sigma^2_{\\text{B3}}]$.\n- Print the list of four results, one per test case, rounded to ten decimal places, as a single line.\n\nNumerical details and robustness:\n- Using the partition-of-unity property of the kernels and periodic modular indexing guarantees conservation up to floating-point rounding.\n- The circular mean and wrapped squared distances ensure consistent statistics even when the distribution straddles the periodic boundary.\n- Rounding output values to ten decimal places provides deterministic, comparable results across environments.\n\nThis method adheres to the core principles of Eulerian–Lagrangian coupling: conservation through properly normalized kernel deposition and quantification of numerical diffusion via physically meaningful second moments on a periodic domain. The comparison across NGP, CIC, and cubic B-spline exposes the trade-off between locality and smoothness typical of particle-mesh methods.", "answer": "[[0.0000000000,0.0000000000,0.0000000000,0.0000018512,0.0000000854,0.0000000006],[0.0000000000,0.0000000000,0.0000000000,0.0000002100,0.0000000096,0.0000000001],[0.0000000000,0.0000000000,0.0000000000,0.0000610352,0.0000676432,0.0001962387],[0.0000000000,0.0000000000,0.0000000000,0.0000203451,0.0000000000,-0.0004340278]]", "id": "3315881"}]}