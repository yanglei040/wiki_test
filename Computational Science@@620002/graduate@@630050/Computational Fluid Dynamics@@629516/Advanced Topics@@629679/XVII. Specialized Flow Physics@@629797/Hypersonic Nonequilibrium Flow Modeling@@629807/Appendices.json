{"hands_on_practices": [{"introduction": "To begin our practical exploration, we will first isolate a single, fundamental nonequilibrium process: vibrational energy relaxation. This exercise models the behavior of nitrogen gas immediately following a normal shock, a classic scenario in hypersonics. By implementing the Landau–Teller model, you will calculate the time-dependent evolution of vibrational energy as it relaxes towards a new equilibrium, providing a tangible link between macroscopic gas dynamics and the microscopic energy states of molecules [@problem_id:3332484].", "problem": "Consider a one-dimensional normal shock forming in a shock-tube filled with nitrogen gas ($N_2$). The upstream flow is characterized by a specified upstream Mach number $M_{\\infty}$, upstream stagnation (total) pressure $p_0$, and upstream static temperature $T_1$. Assume a thermally and calorically perfect gas with constant ratio of specific heats $\\gamma$, and neglect chemistry, electronic excitation, and any spatial variations downstream of the shock (post-shock translational temperature is treated as uniform in time and equal to the immediately post-shock static temperature). The vibrational mode of nitrogen is modeled as a quantum harmonic oscillator with vibrational temperature $\\theta_v$.\n\nStarting from the fundamental conservation laws across a normal shock and the definition of vibrational energy for a quantum harmonic oscillator, implement the Landau–Teller vibrational relaxation model\n$$\n\\frac{dE_v}{dt} = \\frac{E_v^\\ast(T) - E_v}{\\tau_v(T)},\n$$\nwhere $E_v(t)$ is the vibrational energy per mole, $E_v^\\ast(T)$ is the equilibrium vibrational energy per mole at temperature $T$, and $\\tau_v(T)$ is the vibrational relaxation time. Use the Millikan–White correlation for nitrogen to obtain $\\tau_v(T)$, parameterized by constants $A$ and $B$. The correlation is expressed as $\\log_{10}(p \\tau_v) = A T^{-1/3} - B$, where the static pressure $p$ is in atmospheres and temperature $T$ is in Kelvin. For nitrogen, use $A=1.75$ and $B=3.94$. Pressure entering the correlation must be expressed in atmospheres, and time is in seconds.\n\nAssumptions and constants to be used:\n- Gas: nitrogen.\n- Ratio of specific heats: $\\gamma = 1.4$ (constant).\n- Upstream static temperature: $T_1 = 300\\,\\mathrm{K}$.\n- Universal gas constant: $R = 8.314462618\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$.\n- Nitrogen vibrational temperature: $\\theta_v = 3390\\,\\mathrm{K}$.\n- The upstream static pressure $p_1$ is obtained from the upstream stagnation pressure $p_0$ and $M_{\\infty}$ using the isentropic relation. The downstream post-shock static pressure $p_2$ and temperature $T_2$ are obtained from the normal shock relations for a perfect gas.\n\nThe equilibrium vibrational energy per mole for a quantum harmonic oscillator is defined in terms of temperature as a function of $\\theta_v$ and $R$. The Landau–Teller ordinary differential equation is to be integrated for a uniform post-shock temperature $T_2$ and constant $\\tau_v(T_2)$ to predict $E_v(t)$ for specified times. Use the immediately upstream equilibrium vibrational energy at $T_1$ as the initial condition $E_v(0)=E_v^\\ast(T_1)$. For cross-validation, compare the predicted $E_v(t)$ to given Direct Simulation Monte Carlo (DSMC) benchmark values at the same conditions.\n\nYour program must compute, for each test scenario, the maximum absolute relative deviation between the Landau–Teller prediction and the DSMC benchmark over the specified time points, namely\n$$\n\\max_i \\left| \\frac{E_v^{\\mathrm{LT}}(t_i) - E_v^{\\mathrm{DSMC}}(t_i)}{E_v^{\\mathrm{DSMC}}(t_i)} \\right|,\n$$\nwhich is dimensionless. The program must output a single line containing these maximum deviations for all scenarios as a comma-separated list enclosed in square brackets. No other text should be printed.\n\nUse the following test suite (all pressures in atmospheres, all times in seconds, all vibrational energies in $\\mathrm{J}\\,\\mathrm{mol}^{-1}$):\n\nTest Scenario 1 (happy path, moderate hypersonic shock):\n- Parameters: $M_{\\infty} = 6.0$, $p_0 = 2.0$.\n- Time points: $t = [10\\times 10^{-6}, 50\\times 10^{-6}, 100\\times 10^{-6}]$.\n- DSMC benchmarks for $E_v(t)$ at these times: $[31.6, 153.3, 298.3]$.\n\nTest Scenario 2 (edge case, very low post-shock pressure at high Mach):\n- Parameters: $M_{\\infty} = 12.0$, $p_0 = 0.5$.\n- Time points: $t = [20\\times 10^{-6}, 100\\times 10^{-6}, 500\\times 10^{-6}]$.\n- DSMC benchmarks for $E_v(t)$ at these times: $[5.22, 26.11, 123.60]$.\n\nTest Scenario 3 (boundary case, weak shock):\n- Parameters: $M_{\\infty} = 2.0$, $p_0 = 1.0$.\n- Time points: $t = [10\\times 10^{-6}, 100\\times 10^{-6}, 10^{-3}]$.\n- DSMC benchmarks for $E_v(t)$ at these times: $[1.37, 9.35, 33.18]$.\n\nImplementation details to observe:\n- Compute $p_1$ (in atmospheres) from $p_0$ and $M_{\\infty}$ via the isentropic relation for a perfect gas.\n- Compute $p_2$ and $T_2$ from $M_{\\infty}$ and $p_1$, using the perfect-gas normal shock relations derived from conservation of mass, momentum, and energy.\n- Express $p_2$ in atmospheres before inserting into the Millikan–White correlation.\n- Use $E_v^\\ast(T)$ appropriate for a quantum harmonic oscillator in terms of $\\theta_v$ and $R$, and then solve the Landau–Teller equation at constant $T_2$ to obtain $E_v(t)$.\n- Report the maximum absolute relative deviation for each scenario as a float.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,result3]\"), where each result is the maximum absolute relative deviation for the corresponding test scenario.", "solution": "The problem requires the modeling of vibrational energy relaxation for nitrogen gas ($N_2$) behind a one-dimensional normal shock wave. The core of the problem is to solve the Landau–Teller vibrational relaxation equation and compare the result against benchmark data from Direct Simulation Monte Carlo (DSMC) methods. This involves a multi-step calculation combining principles from gas dynamics, statistical mechanics, and chemical kinetics.\n\n### Step 1: Determination of Post-Shock Thermodynamic State\n\nFirst, we must establish the thermodynamic conditions of the gas immediately downstream of the shock front. The gas is treated as thermally and calorically perfect, with a constant ratio of specific heats $\\gamma = 1.4$. The upstream state is defined by the Mach number $M_{\\infty}$, stagnation pressure $p_0$, and static temperature $T_1 = 300\\,\\mathrm{K}$.\n\nThe upstream static pressure, $p_1$, is determined from the stagnation pressure $p_0$ and Mach number $M_{\\infty}$ using the isentropic relation for a perfect gas:\n$$\n\\frac{p_0}{p_1} = \\left( 1 + \\frac{\\gamma - 1}{2} M_{\\infty}^2 \\right)^{\\frac{\\gamma}{\\gamma - 1}}\n$$\nSolving for $p_1$ gives the static pressure of the gas entering the shock.\n\nNext, we apply the Rankine-Hugoniot relations for a normal shock to find the static pressure $p_2$ and static temperature $T_2$ in the post-shock region (denoted by subscript $2$). The pressure and temperature ratios across the shock are functions of the upstream Mach number $M_{\\infty}$ and the ratio of specific heats $\\gamma$:\n$$\n\\frac{p_2}{p_1} = 1 + \\frac{2\\gamma}{\\gamma + 1} (M_{\\infty}^2 - 1)\n$$\n$$\n\\frac{T_2}{T_1} = \\frac{\\left(1 + \\frac{\\gamma-1}{2}M_{\\infty}^2\\right)\\left(\\frac{2\\gamma}{\\gamma-1}M_{\\infty}^2 - 1\\right)}{\\frac{(\\gamma+1)^2}{2(\\gamma-1)}M_{\\infty}^2}\n$$\nThese equations provide the constant translational-rotational temperature $T_2$ and pressure $p_2$ that drive the vibrational relaxation process.\n\n### Step 2: Modeling Vibrational Energy and Relaxation\n\nThe vibrational energy mode of the diatomic nitrogen molecule is modeled as a quantum harmonic oscillator (QHO). The equilibrium molar vibrational energy $E_v^\\ast$ at a given temperature $T$ is given by the Planck formula from statistical mechanics:\n$$\nE_v^\\ast(T) = R \\frac{\\theta_v}{e^{\\theta_v/T} - 1}\n$$\nwhere $R$ is the universal gas constant and $\\theta_v$ is the characteristic vibrational temperature of nitrogen ($\\theta_v = 3390\\,\\mathrm{K}$).\n\nImmediately behind the shock, the translational and rotational modes of the molecules thermalize to the high temperature $T_2$ almost instantaneously. However, the vibrational mode adjusts more slowly. This relaxation process is described by the Landau–Teller equation:\n$$\n\\frac{dE_v}{dt} = \\frac{E_v^\\ast(T) - E_v}{\\tau_v(T, p)}\n$$\nThe problem states to assume a uniform post-shock temperature $T = T_2$ and pressure $p = p_2$. Thus, the equilibrium energy $E_v^\\ast(T_2)$ and the vibrational relaxation time $\\tau_v(T_2, p_2)$ are constant. The initial condition for this ordinary differential equation (ODE) is that the vibrational energy is frozen at its upstream equilibrium value, $E_v(t=0) = E_v^\\ast(T_1)$.\n\nThe vibrational relaxation time, $\\tau_v$, is calculated using the empirical Millikan–White correlation. The problem statement specifies the functional form:\n$$\n\\log_{10}(p \\tau_v) = A T^{-1/3} - B\n$$\nwhere pressure $p$ must be in atmospheres, temperature $T$ in Kelvin, and the resulting $\\tau_v$ is in seconds. For nitrogen, the constants are given as $A=1.75$ and $B=3.94$. We will use the post-shock pressure $p_2$ and temperature $T_2$ in this correlation.\n\nThe Landau–Teller ODE is a first-order linear differential equation with constant coefficients. Its solution with the initial condition $E_v(0) = E_v^\\ast(T_1)$ is:\n$$\nE_v(t) = E_v^\\ast(T_2) + \\left(E_v^\\ast(T_1) - E_v^\\ast(T_2)\\right) e^{-t/\\tau_v}\n$$\nThis equation provides the predicted vibrational energy $E_v^{\\mathrm{LT}}(t)$ at any time $t$ after the shock passage.\n\n### Step 3: Comparison with Benchmark Data and Final Metric\n\nThe final step is to compute the deviation of the Landau–Teller model prediction from the provided DSMC benchmark values. For each test scenario, we will calculate the absolute relative deviation at each specified time point $t_i$:\n$$\n\\delta_i = \\left| \\frac{E_v^{\\mathrm{LT}}(t_i) - E_v^{\\mathrm{DSMC}}(t_i)}{E_v^{\\mathrm{DSMC}}(t_i)} \\right|\n$$\nThe required output for each scenario is the maximum of these deviations over all time points:\n$$\n\\text{Deviation}_{\\max} = \\max_{i} (\\delta_i)\n$$\n\nThe computational procedure for each test case is as follows:\n1.  Given $M_{\\infty}$ and $p_0$ (in atm), convert $p_0$ to Pascals.\n2.  Calculate $p_1$ (Pa) using the isentropic relation.\n3.  Calculate $p_2$ (Pa) and $T_2$ (K) using the normal shock relations.\n4.  Convert $p_2$ from Pascals to atmospheres for use in the Millikan–White correlation.\n5.  Calculate the vibrational relaxation time $\\tau_v$ using the post-shock state $(T_2, p_{2,\\text{atm}})$.\n6.  Calculate the upstream and post-shock equilibrium vibrational energies, $E_v^\\ast(T_1)$ and $E_v^\\ast(T_2)$, respectively.\n7.  Use the analytical solution for $E_v(t)$ to compute the Landau-Teller predictions $E_v^{\\mathrm{LT}}(t_i)$ at the given time points.\n8.  Compute the maximum absolute relative deviation between the $E_v^{\\mathrm{LT}}(t_i)$ and the provided $E_v^{\\mathrm{DSMC}}(t_i)$ values.\nThis process is repeated for all three test scenarios. The large deviations observed in some scenarios highlight the limitations of this simplified model (e.g., constant post-shock temperature, empirical relaxation time correlation) compared to high-fidelity methods like DSMC, especially under extreme conditions.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the vibrational relaxation problem for nitrogen behind a normal shock\n    for three specified test scenarios and calculates the maximum deviation from\n    DSMC benchmarks.\n    \"\"\"\n\n    # Define physical and model constants\n    GAMMA = 1.4  # Ratio of specific heats for N2\n    T1_K = 300.0  # Upstream static temperature in Kelvin\n    R_GAS = 8.314462618  # Universal gas constant in J/(mol*K)\n    THETA_V_K = 3390.0  # Characteristic vibrational temperature for N2 in Kelvin\n    P_ATM_TO_PA = 101325.0  # Conversion factor from atmospheres to Pascals\n\n    # Millikan-White correlation parameters for N2\n    MW_A = 1.75\n    MW_B = 3.94\n\n    def calculate_max_deviation(m_inf, p0_atm, times_s, ev_dsmc):\n        \"\"\"\n        Calculates the maximum absolute relative deviation between the Landau-Teller\n        model and DSMC data for a single test scenario.\n\n        Args:\n            m_inf (float): Upstream Mach number.\n            p0_atm (float): Upstream stagnation pressure in atmospheres.\n            times_s (list[float]): List of time points in seconds.\n            ev_dsmc (list[float]): List of DSMC benchmark vibrational energies in J/mol.\n\n        Returns:\n            float: The maximum absolute relative deviation.\n        \"\"\"\n        # Convert stagnation pressure to SI units (Pascals)\n        p0_pa = p0_atm * P_ATM_TO_PA\n\n        # Step 1: Calculate upstream static pressure (p1) using the isentropic relation.\n        p1_pa = p0_pa / (1 + (GAMMA - 1) / 2 * m_inf**2)**(GAMMA / (GAMMA - 1))\n\n        # Step 2: Calculate post-shock pressure (p2) and temperature (T2)\n        # using normal shock relations for a perfect gas.\n        m_inf_sq = m_inf**2\n        \n        # Pressure ratio\n        p2_over_p1 = 1 + 2 * GAMMA / (GAMMA + 1) * (m_inf_sq - 1)\n        p2_pa = p1_pa * p2_over_p1\n\n        # Temperature ratio\n        t2_over_t1_num = (1 + (GAMMA - 1) / 2 * m_inf_sq) * (2 * GAMMA / (GAMMA - 1) * m_inf_sq - 1)\n        t2_over_t1_den = ((GAMMA + 1)**2 / (2 * (GAMMA - 1))) * m_inf_sq\n        t2_k = T1_K * t2_over_t1_num / t2_over_t1_den\n\n        # Step 3: Calculate equilibrium vibrational energy (Ev*) for a quantum harmonic oscillator.\n        def ev_star(T):\n            if T = 0: return 0.0\n            # To prevent overflow in exp for very small T\n            exp_arg = THETA_V_K / T\n            if exp_arg > 100: return 0.0\n            return R_GAS * THETA_V_K / (np.exp(exp_arg) - 1)\n\n        ev_star_t1 = ev_star(T1_K)\n        ev_star_t2 = ev_star(t2_k)\n\n        # Step 4: Calculate the vibrational relaxation time (tau_v) using Millikan-White correlation.\n        p2_atm = p2_pa / P_ATM_TO_PA\n        # Assumed form: log10(p*tau_v) = A * T^(-1/3) - B\n        log10_ptau = MW_A * t2_k**(-1/3) - MW_B\n        ptau = 10**log10_ptau\n        tau_v_s = ptau / p2_atm\n\n        # Step 5: Solve the Landau-Teller equation to find Ev(t).\n        # Ev(t) = Ev*(T2) + (Ev*(T1) - Ev*(T2)) * exp(-t/tau_v)\n        times_s = np.array(times_s)\n        ev_lt = ev_star_t2 + (ev_star_t1 - ev_star_t2) * np.exp(-times_s / tau_v_s)\n\n        # Step 6: Calculate maximum absolute relative deviation between LT and DSMC.\n        ev_dsmc = np.array(ev_dsmc)\n        relative_deviations = np.abs((ev_lt - ev_dsmc) / ev_dsmc)\n        max_relative_deviation = np.max(relative_deviations)\n\n        return max_relative_deviation\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (M_inf, p0_atm, times_s, ev_dsmc)\n        (6.0, 2.0, [10e-6, 50e-6, 100e-6], [31.6, 153.3, 298.3]),\n        (12.0, 0.5, [20e-6, 100e-6, 500e-6], [5.22, 26.11, 123.60]),\n        (2.0, 1.0, [10e-6, 100e-6, 1e-3], [1.37, 9.35, 33.18]),\n    ]\n\n    results = []\n    for case in test_cases:\n        m_inf, p0_atm, times, ev_dsmc_data = case\n        result = calculate_max_deviation(m_inf, p0_atm, times, ev_dsmc_data)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3332484"}, {"introduction": "Building on the concept of relaxation, we now introduce the complexity of multi-species chemical reactions, a hallmark of high-temperature hypersonic flows. This practice focuses on computing the chemical source terms for a five-species air model within a two-temperature framework, a core task in any reacting flow simulation. You will not only implement the law of mass action for a given reaction mechanism but also delve into the critical concept of chemical stiffness by calculating the Jacobian matrix of the production rates, which is essential for developing robust numerical solvers [@problem_id:3332419].", "problem": "You are given a uniform, zero-dimensional gas cell containing a five-species air mixture with species set $\\{\\mathrm{N}_2, \\mathrm{O}_2, \\mathrm{NO}, \\mathrm{N}, \\mathrm{O}\\}$. The mixture is modeled using a two-temperature nonequilibrium framework with a translational-rotational temperature $T$ and a vibrational-electronic temperature $T_v$. The gas is assumed to obey the ideal gas law. Reaction rates follow mass-action kinetics with Arrhenius-type temperature dependence. Your task is to compute the steady molar production rates $\\dot{\\omega}_s$ for each species $s$ in $\\mathrm{mol}\\,\\mathrm{m}^{-3}\\mathrm{s}^{-1}$ and to assess stiffness by the eigenvalues of the Jacobian matrix $\\partial \\dot{\\omega}/\\partial \\mathbf{X}$, where $\\mathbf{X}$ is the vector of species mole fractions. You must report a single stiffness measure per test case, defined as the largest magnitude of the real part among the eigenvalues of $\\partial \\dot{\\omega}/\\partial \\mathbf{C}$ in $\\mathrm{s}^{-1}$, where $\\mathbf{C}$ is the vector of molar concentrations. All computed production rates must be expressed in $\\mathrm{mol}\\,\\mathrm{m}^{-3}\\mathrm{s}^{-1}$, and the stiffness measure must be expressed in $\\mathrm{s}^{-1}$. Round every reported number to six significant figures.\n\nFundamental base and definitions:\n- Let the universal gas constant be $R_u = 8.314462618\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\mathrm{K}^{-1}$.\n- For a uniform cell at pressure $p$ and translational-rotational temperature $T$, the molar concentration of species $i$ with mole fraction $X_i$ is $C_i = \\dfrac{p}{R_u T} X_i$. Denote $\\alpha = \\dfrac{p}{R_u T}$ so that $C_i = \\alpha X_i$.\n- For each elementary reaction $r$, the scalar reaction rate (per unit volume) $\\dot{q}_r$ obeys mass-action kinetics, i.e., it is the product of a temperature-dependent rate coefficient and the appropriate powers of the reactant molar concentrations. The species molar production rates are $\\dot{\\omega}_s = \\sum_r \\nu_{s,r} \\dot{q}_r$, where $\\nu_{s,r}$ are the stoichiometric change coefficients for species $s$ in reaction $r$, defined as products minus reactants.\n\nMechanism:\nConsider the following five-reaction mechanism over the five species, using a two-temperature nonequilibrium formulation where unimolecular dissociation depends on $T_v$ and bimolecular exchanges depend on $T$:\n- Reaction $\\#1$: $N_2 + O \\rightarrow NO + N$. Rate coefficient $k_1(T) = A_1 T^{n_1} \\exp\\!\\left(-\\dfrac{E_{a1}}{R_u T}\\right)$ with $A_1 = 5.0\\times 10^7\\,\\mathrm{m}^3\\,\\mathrm{mol}^{-1}\\mathrm{s}^{-1}$, $n_1=0$, $E_{a1}=1.0\\times 10^5\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}$.\n- Reaction $\\#2$: $O_2 + N \\rightarrow NO + O$. Rate coefficient $k_2(T) = A_2 T^{n_2} \\exp\\!\\left(-\\dfrac{E_{a2}}{R_u T}\\right)$ with $A_2 = 5.0\\times 10^7\\,\\mathrm{m}^3\\,\\mathrm{mol}^{-1}\\mathrm{s}^{-1}$, $n_2=0$, $E_{a2}=1.2\\times 10^5\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}$.\n- Reaction $\\#3$: $NO + O \\rightarrow O_2 + N$. Rate coefficient $k_3(T) = A_3 T^{n_3} \\exp\\!\\left(-\\dfrac{E_{a3}}{R_u T}\\right)$ with $A_3 = 1.0\\times 10^7\\,\\mathrm{m}^3\\,\\mathrm{mol}^{-1}\\mathrm{s}^{-1}$, $n_3=0$, $E_{a3}=8.0\\times 10^4\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}$.\n- Reaction $\\#4$: $N_2 \\rightarrow N + N$. Two-temperature dissociation with $k_4(T_v) = A_4 T_v^{n_4} \\exp\\!\\left(-\\dfrac{E_{a4}}{R_u T_v}\\right)$ where $A_4 = 1.0\\times 10^{13}\\,\\mathrm{s}^{-1}$, $n_4=0$, $E_{a4}=9.42\\times 10^5\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}$.\n- Reaction $\\#5$: $O_2 \\rightarrow O + O$. Two-temperature dissociation with $k_5(T_v) = A_5 T_v^{n_5} \\exp\\!\\left(-\\dfrac{E_{a5}}{R_u T_v}\\right)$ where $A_5 = 1.0\\times 10^{13}\\,\\mathrm{s}^{-1}$, $n_5=0$, $E_{a5}=4.94\\times 10^5\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}$.\n\nMass-action forms for reaction rates:\n- $\\dot{q}_1 = k_1(T)\\,C_{N_2}\\,C_O$.\n- $\\dot{q}_2 = k_2(T)\\,C_{O_2}\\,C_N$.\n- $\\dot{q}_3 = k_3(T)\\,C_{NO}\\,C_O$.\n- $\\dot{q}_4 = k_4(T_v)\\,C_{N_2}$.\n- $\\dot{q}_5 = k_5(T_v)\\,C_{O_2}$.\n\nStoichiometric change coefficients $\\nu_{s,r}$ for species ordering $\\{\\mathrm{N}_2, \\mathrm{O}_2, \\mathrm{NO}, \\mathrm{N}, \\mathrm{O}\\}$:\n- Reaction $\\#1$: $\\nu_{\\cdot,1} = [-1,\\,0,\\, +1,\\, +1,\\, -1]$.\n- Reaction $\\#2$: $\\nu_{\\cdot,2} = [\\,0,\\, -1,\\, +1,\\, -1,\\, +1]$.\n- Reaction $\\#3$: $\\nu_{\\cdot,3} = [\\,0,\\, +1,\\, -1,\\, +1,\\, -1]$.\n- Reaction $\\#4$: $\\nu_{\\cdot,4} = [-1,\\, 0,\\, 0,\\, +2,\\, 0]$.\n- Reaction $\\#5$: $\\nu_{\\cdot,5} = [\\,0,\\, -1,\\, 0,\\, 0,\\, +2]$.\n\nJacobian definition and stiffness assessment:\n- Let $\\mathbf{X} = [X_{N_2}, X_{O_2}, X_{NO}, X_N, X_O]^T$. The Jacobian with respect to mole fractions is $J_X = \\dfrac{\\partial \\dot{\\omega}}{\\partial \\mathbf{X}}$, where each entry is $[J_X]_{s,j} = \\sum_{r} \\nu_{s,r} \\dfrac{\\partial \\dot{q}_r}{\\partial X_j}$.\n- Using $C_i=\\alpha X_i$ and the mass-action forms above, the nonzero partial derivatives are:\n  - For $\\dot{q}_1$: $\\dfrac{\\partial \\dot{q}_1}{\\partial X_{N_2}} = k_1(T)\\,\\alpha\\,C_O$, $\\dfrac{\\partial \\dot{q}_1}{\\partial X_O} = k_1(T)\\,\\alpha\\,C_{N_2}$.\n  - For $\\dot{q}_2$: $\\dfrac{\\partial \\dot{q}_2}{\\partial X_{O_2}} = k_2(T)\\,\\alpha\\,C_N$, $\\dfrac{\\partial \\dot{q}_2}{\\partial X_N} = k_2(T)\\,\\alpha\\,C_{O_2}$.\n  - For $\\dot{q}_3$: $\\dfrac{\\partial \\dot{q}_3}{\\partial X_{NO}} = k_3(T)\\,\\alpha\\,C_O$, $\\dfrac{\\partial \\dot{q}_3}{\\partial X_O} = k_3(T)\\,\\alpha\\,C_{NO}$.\n  - For $\\dot{q}_4$: $\\dfrac{\\partial \\dot{q}_4}{\\partial X_{N_2}} = k_4(T_v)\\,\\alpha$.\n  - For $\\dot{q}_5$: $\\dfrac{\\partial \\dot{q}_5}{\\partial X_{O_2}} = k_5(T_v)\\,\\alpha$.\n- To assess stiffness in physically meaningful time-scale units, compute $J_C = \\dfrac{\\partial \\dot{\\omega}}{\\partial \\mathbf{C}} = \\dfrac{1}{\\alpha} J_X$, whose eigenvalues have units $\\mathrm{s}^{-1}$. Define the stiffness measure $S$ as $S = \\max\\limits_i \\left| \\Re\\left(\\lambda_i(J_C)\\right) \\right|$, in $\\mathrm{s}^{-1}$.\n\nTest suite:\nCompute $\\dot{\\omega}_s$ and the stiffness measure $S$ for the following $3$ test cases. All mole fractions must be used as given; do not renormalize.\n\n- Case $\\#1$ (general hypersonic nonequilibrium): $p = 5000\\,\\mathrm{Pa}$, $T = 6000\\,\\mathrm{K}$, $T_v = 9000\\,\\mathrm{K}$, $\\mathbf{X} = [0.70,\\, 0.20,\\, 0.05,\\, 0.03,\\, 0.02]$.\n- Case $\\#2$ (high-temperature, high-dissociation): $p = 1000\\,\\mathrm{Pa}$, $T = 10000\\,\\mathrm{K}$, $T_v = 10000\\,\\mathrm{K}$, $\\mathbf{X} = [0.10,\\, 0.05,\\, 0.10,\\, 0.40,\\, 0.35]$.\n- Case $\\#3$ (strong nonequilibrium vibrational excitation with trace atoms): $p = 5000\\,\\mathrm{Pa}$, $T = 3000\\,\\mathrm{K}$, $T_v = 12000\\,\\mathrm{K}$, $\\mathbf{X} = [0.79,\\, 0.199998,\\, 0.010002,\\, 10^{-6},\\, 10^{-6}]$.\n\nRequired final output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case contributes a nested comma-separated list of six values $[\\dot{\\omega}_{N_2}, \\dot{\\omega}_{O_2}, \\dot{\\omega}_{NO}, \\dot{\\omega}_N, \\dot{\\omega}_O, S]$. Each number must be rounded to six significant figures. For example, the output should look like $[[a_1,b_1,c_1,d_1,e_1,f_1],[a_2,b_2,c_2,d_2,e_2,f_2],[a_3,b_3,c_3,d_3,e_3,f_3]]$, where $a_i$ through $f_i$ are the computed values for case $i$.", "solution": "The problem presented requires the computation of species molar production rates and a chemical stiffness measure for a five-species air mixture under hypersonic nonequilibrium conditions. The problem is scientifically well-posed and provides a complete set of physical laws, kinetic data, and initial conditions required for a unique solution. We shall proceed by systematically implementing the provided model.\n\nThe foundation of this problem lies in chemical kinetics, where the time evolution of the species molar concentration vector, $\\mathbf{C}$, is described by a system of ordinary differential equations:\n$$ \\frac{d\\mathbf{C}}{dt} = \\dot{\\mathbf{\\omega}}(\\mathbf{C}, T, T_v) $$\nHere, $\\dot{\\mathbf{\\omega}}$ represents the vector of net molar production rates for each species. Our task is to calculate the instantaneous value of $\\dot{\\mathbf{\\omega}}$ and to characterize the stiffness of the system via the Jacobian matrix of $\\dot{\\mathbf{\\omega}}$ with respect to $\\mathbf{C}$.\n\nThe species vector is ordered as $\\mathbf{C} = [C_{N_2}, C_{O_2}, C_{NO}, C_N, C_O]^T$.\n\nStep 1: Calculation of Molar Concentrations\n\nThe problem states that the gas mixture obeys the ideal gas law. Given a pressure $p$, a translational-rotational temperature $T$, and a vector of mole fractions $\\mathbf{X} = [X_{N_2}, X_{O_2}, X_{NO}, X_N, X_O]^T$, the molar concentration of species $s$ is given by:\n$$ C_s = X_s \\frac{p}{R_u T} $$\nwhere $R_u = 8.314462618\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\mathrm{K}^{-1}$ is the universal gas constant. We define the term $\\alpha = \\frac{p}{R_u T}$ to simplify the expression to $C_s = \\alpha X_s$. This conversion will be the first computational step for each test case.\n\nStep 2: Calculation of Reaction Rate Coefficients\n\nThe reaction rates depend on temperature-dependent rate coefficients, $k_r$, which follow an Arrhenius-type law. For reactions dependent on the translational-rotational temperature $T$, the form is:\n$$ k_r(T) = A_r T^{n_r} \\exp\\left(-\\frac{E_{ar}}{R_u T}\\right) \\quad \\text{for } r \\in \\{1, 2, 3\\} $$\nFor the two-temperature dissociation reactions dependent on the vibrational-electronic temperature $T_v$, the form is:\n$$ k_r(T_v) = A_r T_v^{n_r} \\exp\\left(-\\frac{E_{ar}}{R_u T_v}\\right) \\quad \\text{for } r \\in \\{4, 5\\} $$\nThe parameters $A_r$, $n_r$, and $E_{ar}$ are provided for each of the five reactions. Since all $n_r=0$, the expressions simplify to a standard Arrhenius form.\n\nStep 3: Calculation of Scalar Reaction Rates\n\nThe scalar rate of progress for each reaction, $\\dot{q}_r$ (in units of $\\mathrm{mol}\\,\\mathrm{m}^{-3}\\mathrm{s}^{-1}$), is determined by the law of mass action. The problem provides the specific form for each reaction:\n\\begin{align*}\n\\dot{q}_1 = k_1(T)\\,C_{N_2}\\,C_O \\\\\n\\dot{q}_2 = k_2(T)\\,C_{O_2}\\,C_N \\\\\n\\dot{q}_3 = k_3(T)\\,C_{NO}\\,C_O \\\\\n\\dot{q}_4 = k_4(T_v)\\,C_{N_2} \\\\\n\\dot{q}_5 = k_5(T_v)\\,C_{O_2}\n\\end{align*}\n\nStep 4: Calculation of Species Molar Production Rates\n\nThe net molar production rate for each species $s$, $\\dot{\\omega}_s$, is the sum of its production and consumption across all reactions. This is given by:\n$$ \\dot{\\omega}_s = \\sum_{r=1}^{5} \\nu_{s,r} \\dot{q}_r $$\nwhere $\\nu_{s,r}$ is the stoichiometric coefficient of species $s$ in reaction $r$ (positive for products, negative for reactants). The stoichiometric matrix $\\nu$ is provided, where rows correspond to species ($N_2, O_2, NO, N, O$) and columns to reactions ($1$ to $5$):\n$$ \\nu = \\begin{pmatrix}\n-1  0  0  -1  0 \\\\\n0  -1  1  0  -1 \\\\\n1  1  -1  0  0 \\\\\n1  -1  1  2  0 \\\\\n-1  1  -1  0  2\n\\end{pmatrix} $$\nThe vector of production rates $\\dot{\\mathbf{\\omega}}$ can be succinctly calculated as the matrix-vector product $\\dot{\\mathbf{\\omega}} = \\nu \\dot{\\mathbf{q}}$, where $\\dot{\\mathbf{q}} = [\\dot{q}_1, \\dot{q}_2, \\dot{q}_3, \\dot{q}_4, \\dot{q}_5]^T$.\n\nStep 5: Jacobian Calculation and Stiffness Assessment\n\nStiffness in a system of ordinary differential equations arises when there are vastly different time scales governing the dynamics. In chemical kinetics, this corresponds to some reactions proceeding much faster than others. Stiffness is mathematically characterized by the eigenvalues of the Jacobian matrix of the rate vector. The problem requests the Jacobian with respect to molar concentrations, $J_C$, whose elements are:\n$$ [J_C]_{s,j} = \\frac{\\partial \\dot{\\omega}_s}{\\partial C_j} $$\nUsing the definition of $\\dot{\\omega}_s$, we have:\n$$ [J_C]_{s,j} = \\frac{\\partial}{\\partial C_j} \\left( \\sum_{r=1}^{5} \\nu_{s,r} \\dot{q}_r \\right) = \\sum_{r=1}^{5} \\nu_{s,r} \\frac{\\partial \\dot{q}_r}{\\partial C_j} $$\nThe partial derivatives of the scalar reaction rates $\\dot{q}_r$ with respect to a concentration $C_j$ are derived from their mass-action forms:\n\\begin{itemize}\n    \\item $\\dfrac{\\partial \\dot{q}_1}{\\partial C_{N_2}} = k_1 C_O$, $\\dfrac{\\partial \\dot{q}_1}{\\partial C_O} = k_1 C_{N_2}$\n    \\item $\\dfrac{\\partial \\dot{q}_2}{\\partial C_{O_2}} = k_2 C_N$, $\\dfrac{\\partial \\dot{q}_2}{\\partial C_N} = k_2 C_{O_2}$\n    \\item $\\dfrac{\\partial \\dot{q}_3}{\\partial C_{NO}} = k_3 C_O$, $\\dfrac{\\partial \\dot{q}_3}{\\partial C_O} = k_3 C_{NO}$\n    \\item $\\dfrac{\\partial \\dot{q}_4}{\\partial C_{N_2}} = k_4$\n    \\item $\\dfrac{\\partial \\dot{q}_5}{\\partial C_{O_2}} = k_5$\n\\end{itemize}\nAll other partial derivatives are zero. These terms are assembled to form the $5 \\times 5$ Jacobian matrix $J_C$.\n\nThe eigenvalues $\\lambda_i$ of $J_C$ have units of inverse time ($\\mathrm{s}^{-1}$) and their real parts correspond to the exponential rates of decay or growth of perturbations around the current state. A large negative real part indicates a rapidly decaying mode, which is the source of stiffness. The stiffness measure $S$ is defined as the largest magnitude of the real parts of these eigenvalues:\n$$ S = \\max_{i} |\\Re(\\lambda_i)| $$\nThis value represents the inverse of the fastest chemical time scale in the system.\n\nThe following code implements these calculations for each of the three specified test cases, reporting the five species production rates and the stiffness measure $S$, with each value rounded to six significant figures.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes steady molar production rates and a stiffness measure for a\n    five-species nonequilibrium air mixture.\n    \"\"\"\n    # Universal gas constant in J mol^-1 K^-1\n    R_u = 8.314462618\n\n    # Reaction parameters: [A (m^3/mol/s or 1/s), n, E_a (J/mol)]\n    reaction_params = {\n        1: {'A': 5.0e7, 'n': 0.0, 'Ea': 1.0e5, 'temp_type': 'T'},\n        2: {'A': 5.0e7, 'n': 0.0, 'Ea': 1.2e5, 'temp_type': 'T'},\n        3: {'A': 1.0e7, 'n': 0.0, 'Ea': 8.0e4, 'temp_type': 'T'},\n        4: {'A': 1.0e13, 'n': 0.0, 'Ea': 9.42e5, 'temp_type': 'Tv'},\n        5: {'A': 1.0e13, 'n': 0.0, 'Ea': 4.94e5, 'temp_type': 'Tv'}\n    }\n\n    # Stoichiometric matrix (nu_sr): rows=species, cols=reactions\n    # Species order: N2, O2, NO, N, O\n    nu = np.array([\n        [-1,  0,  0, -1,  0],  # N2\n        [ 0, -1,  1,  0, -1],  # O2\n        [ 1,  1, -1,  0,  0],  # NO\n        [ 1, -1,  1,  2,  0],  # N\n        [-1,  1, -1,  0,  2]   # O\n    ])\n\n    # Test cases: [p (Pa), T (K), T_v (K), X (mole fractions)]\n    test_cases = [\n        (5000.0, 6000.0, 9000.0, np.array([0.70, 0.20, 0.05, 0.03, 0.02])),\n        (1000.0, 10000.0, 10000.0, np.array([0.10, 0.05, 0.10, 0.40, 0.35])),\n        (5000.0, 3000.0, 12000.0, np.array([0.79, 0.199998, 0.010002, 1e-6, 1e-6]))\n    ]\n    \n    # Species indices map\n    s_map = {'N2': 0, 'O2': 1, 'NO': 2, 'N': 3, 'O': 4}\n\n    results = []\n    for case in test_cases:\n        p, T, Tv, X = case\n\n        # Step 1: Molar Concentrations\n        alpha = p / (R_u * T)\n        C = alpha * X\n        C_N2, C_O2, C_NO, C_N, C_O = C\n\n        # Step 2: Rate Coefficients\n        k = {}\n        temps = {'T': T, 'Tv': Tv}\n        for r_idx, params in reaction_params.items():\n            temp_key = params['temp_type']\n            temp = temps[temp_key]\n            k[r_idx] = params['A'] * (temp**params['n']) * np.exp(-params['Ea'] / (R_u * temp))\n\n        # Step 3: Scalar Reaction Rates\n        q_dot = np.zeros(5)\n        q_dot[0] = k[1] * C_N2 * C_O      # q1\n        q_dot[1] = k[2] * C_O2 * C_N      # q2\n        q_dot[2] = k[3] * C_NO * C_O      # q3\n        q_dot[3] = k[4] * C_N2            # q4\n        q_dot[4] = k[5] * C_O2            # q5\n\n        # Step 4: Species Molar Production Rates\n        omega_dot = nu @ q_dot\n\n        # Step 5: Jacobian Matrix J_C\n        J_C = np.zeros((5, 5))\n\n        # Column 0: d/dC_N2\n        J_C[:, s_map['N2']] = nu[:, 0] * (k[1] * C_O) + nu[:, 3] * k[4]\n        \n        # Column 1: d/dC_O2\n        J_C[:, s_map['O2']] = nu[:, 1] * (k[2] * C_N) + nu[:, 4] * k[5]\n\n        # Column 2: d/dC_NO\n        J_C[:, s_map['NO']] = nu[:, 2] * (k[3] * C_O)\n\n        # Column 3: d/dC_N\n        J_C[:, s_map['N']] = nu[:, 1] * (k[2] * C_O2)\n\n        # Column 4: d/dC_O\n        J_C[:, s_map['O']] = nu[:, 0] * (k[1] * C_N2) + nu[:, 2] * (k[3] * C_NO)\n\n        # Step 6: Stiffness Measure\n        eigenvalues = np.linalg.eigvals(J_C)\n        stiffness_measure = np.max(np.abs(np.real(eigenvalues)))\n        \n        # Collect results for this case\n        case_results = list(omega_dot)\n        case_results.append(stiffness_measure)\n        results.append(case_results)\n\n    # Format the final output string with 6 significant figures per number\n    # using the 'g' format specifier.\n    output_str = f\"[{','.join(f'[{\",\".join(f\"{val:.6g}\" for val in row)}]' for row in results)}]\"\n\n    print(output_str)\n\nsolve()\n```", "id": "3332419"}, {"introduction": "This final practice integrates the physical models of the previous exercises with the advanced numerical methods required to solve them efficiently. You will tackle the primary challenge in nonequilibrium flow simulation: the inherent stiffness of the governing equations, where chemical and vibrational timescales can be orders of magnitude smaller than the fluid-dynamic timescale. By implementing a fully implicit backward Euler time step for a coupled dissociation-relaxation system, you will construct the residual vector and Jacobian matrix needed for a Newton-type solver, gaining hands-on experience with the numerical engine at the heart of modern, robust hypersonic CFD codes [@problem_id:3332459].", "problem": "Consider a single, spatially homogeneous computational cell representative of a post-shock region in hypersonic nonequilibrium flow of nitrogen, where dissociation and vibrational relaxation occur. The mixture contains two chemical species: molecular nitrogen $N_2$ and atomic nitrogen $N$. Denote the molar concentrations per unit volume by $n_{N_2}$ and $n_N$ (units: $\\mathrm{mol}\\,\\mathrm{m}^{-3}$). The translational-rotational temperature is $T$ and the vibrational temperature of $N_2$ is $T_v$ (units: $\\mathrm{K}$). The system is modeled as adiabatic and at constant volume during the time step.\n\nThe following fundamental principles and constitutive relations are used as the modeling base:\n\n- Ideal gas law for number density: $n_{\\mathrm{tot}} = n_{N_2} + n_N$ with $p = n_{\\mathrm{tot}} R T$, where $p$ is pressure (units: $\\mathrm{Pa}$), $R$ is the universal gas constant (units: $\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$).\n- Reaction mechanism: $N_2 \\leftrightharpoons 2N$. Under the law of mass action, the net reaction rate (forward minus reverse) in molar concentration form is\n$$\n\\mathcal{R}(T,T_v,n_{N_2},n_N) = k_f(T,T_v)\\, n_{N_2} - k_b(T)\\, n_N^2,\n$$\nwhere $k_f$ and $k_b$ are rate coefficients with units chosen such that $\\mathcal{R}$ has units $\\mathrm{mol}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}$. The forward rate is given by an Arrhenius form modulated by a Treanor-type vibrational nonequilibrium factor,\n$$\nk_f(T,T_v) = A_f \\exp\\!\\left(-\\frac{E_a}{R T}\\right)\\,\\exp\\!\\left(\\Theta_v\\left(\\frac{1}{T}-\\frac{1}{T_v}\\right)\\right),\n$$\nwhere $A_f$ is a pre-exponential factor (units: $\\mathrm{s}^{-1}$), $E_a$ is an activation energy (units: $\\mathrm{J}\\,\\mathrm{mol}^{-1}$), and $\\Theta_v$ is the characteristic vibrational temperature of $N_2$ (units: $\\mathrm{K}$). The reverse rate enforces chemical detailed balance at $T$ when $T_v=T$ via the equilibrium constant,\n$$\nk_b(T) = \\frac{A_f \\exp\\!\\left(-\\frac{E_a}{R T}\\right)}{K_{\\mathrm{eq}}(T)}, \\qquad K_{\\mathrm{eq}}(T) = K_{\\mathrm{pref}}\\, T^{3/2} \\exp\\!\\left(-\\frac{D}{R T}\\right),\n$$\nwhere $K_{\\mathrm{pref}}$ is a constant with units $\\mathrm{mol}\\,\\mathrm{m}^{-3}\\,\\mathrm{K}^{-3/2}$, and $D$ is the molar dissociation energy of $N_2$ (units: $\\mathrm{J}\\,\\mathrm{mol}^{-1}$).\n\n- Landau–Teller (LT) vibrational relaxation model: the vibrational temperature relaxes towards the translational-rotational temperature according to\n$$\n\\frac{d T_v}{d t} = \\frac{T - T_v}{\\tau_v},\n$$\nwhere $\\tau_v$ is the vibrational relaxation time (units: $\\mathrm{s}$). For this problem, $\\tau_v$ is treated as a constant parameter.\n- Species production rates derived from stoichiometry:\n$$\n\\frac{d n_{N_2}}{d t} = -\\mathcal{R}, \\qquad \\frac{d n_N}{d t} = 2\\,\\mathcal{R}.\n$$\nThese relations imply conservation of the total number of nitrogen atoms per unit volume, $N_{\\mathrm{atoms}} = n_N + 2 n_{N_2}$, in the continuous-time model.\n- Adiabatic total energy conservation in the cell: The total internal energy per unit volume $U$ is the sum of translational-rotational sensible energy, vibrational energy of $N_2$, and chemical bond energy,\n$$\nU(n_{N_2},n_N,T_v,T) = n_N \\left(\\frac{3}{2} R T\\right) + n_{N_2} \\left(\\frac{5}{2} R T\\right) + n_{N_2}\\, e_{\\mathrm{vib}}(T_v) - n_{N_2}\\, D,\n$$\nwhere the $N_2$ vibrational energy per mole is modeled by the quantum harmonic oscillator expression\n$$\ne_{\\mathrm{vib}}(T_v) = \\frac{R \\Theta_v}{\\exp(\\Theta_v/T_v) - 1}.\n$$\nUnder adiabatic conditions and constant volume over a time step, the total energy $U$ must remain constant.\n\nYour task is to perform a single implicit time step of size $\\Delta t$ (units: $\\mathrm{s}$) using the backward Euler method for the stiff ordinary differential equation system consisting of $n_{N_2}$, $n_N$, $T_v$, and $T$. Specifically, given the state at time $t^n$, denoted by $(n_{N_2}^n, n_N^n, T_v^n, T^n)$, compute the state at time $t^{n+1} = t^n + \\Delta t$ as $(n_{N_2}^{n+1}, n_N^{n+1}, T_v^{n+1}, T^{n+1})$ satisfying the nonlinear system\n$$\nn_{N_2}^{n+1} = n_{N_2}^{n} - \\Delta t\\, \\mathcal{R}(T^{n+1},T_v^{n+1},n_{N_2}^{n+1},n_N^{n+1}),\n$$\n$$\nn_N^{n+1} = n_{N}^{n} + 2 \\Delta t\\, \\mathcal{R}(T^{n+1},T_v^{n+1},n_{N_2}^{n+1},n_N^{n+1}),\n$$\n$$\nT_v^{n+1} = T_v^{n} + \\Delta t\\, \\frac{T^{n+1} - T_v^{n+1}}{\\tau_v},\n$$\n$$\nU(n_{N_2}^{n+1},n_N^{n+1},T_v^{n+1},T^{n+1}) = U(n_{N_2}^{n},n_{N}^{n},T_v^{n},T^{n}).\n$$\nUse a Newton-type method to solve the nonlinear system for $(n_{N_2}^{n+1}, n_N^{n+1}, T_v^{n+1}, T^{n+1})$. After computing $(n_{N_2}^{n+1}, n_N^{n+1}, T_v^{n+1}, T^{n+1})$, assess:\n- Positivity: $n_{N_2}^{n+1} \\ge 0$, $n_{N}^{n+1} \\ge 0$, $T_v^{n+1} > 0$, $T^{n+1} > 0$.\n- Atom conservation: $n_{N}^{n+1} + 2 n_{N_2}^{n+1}$ equals $n_{N}^{n} + 2 n_{N_2}^{n}$ to within a specified relative tolerance.\n- Energy conservation: $U(n_{N_2}^{n+1},n_N^{n+1},T_v^{n+1},T^{n+1})$ equals $U(n_{N_2}^{n},n_{N}^{n},T_v^{n},T^{n})$ to within a specified relative tolerance.\n\nUse the following constants and units in the program:\n- $R = 8.314462618\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$,\n- $\\Theta_v = 3390\\,\\mathrm{K}$,\n- $D = 9.76 \\times 96{,}485.33212\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}$,\n- $A_f = 10^5\\,\\mathrm{s}^{-1}$,\n- $E_a = 2.0 \\times 10^5\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}$,\n- $K_{\\mathrm{pref}} = 10^3\\,\\mathrm{mol}\\,\\mathrm{m}^{-3}\\,\\mathrm{K}^{-3/2}$,\n- $\\tau_v = 2.0 \\times 10^{-6}\\,\\mathrm{s}$.\n\nImplement the implicit step and the assessment for the following test suite of initial states and time steps. In each case, the initial molar concentrations $(n_{N_2}^n,n_N^n)$ should sum to $p/(R T^n)$ to be consistent with the ideal gas law:\n1. Case A (happy path): $p = 5.0 \\times 10^4\\,\\mathrm{Pa}$, $T^n = 8000\\,\\mathrm{K}$, $T_v^n = 5000\\,\\mathrm{K}$, $n_{N_2}^n = 0.50\\,\\mathrm{mol}\\,\\mathrm{m}^{-3}$, $n_N^n = 0.25\\,\\mathrm{mol}\\,\\mathrm{m}^{-3}$, $\\Delta t = 5.0 \\times 10^{-7}\\,\\mathrm{s}$.\n2. Case B (boundary: fully atomic initial state): $p = 2.0 \\times 10^4\\,\\mathrm{Pa}$, $T^n = 9000\\,\\mathrm{K}$, $T_v^n = 9000\\,\\mathrm{K}$, $n_{N_2}^n = 0.00\\,\\mathrm{mol}\\,\\mathrm{m}^{-3}$, $n_N^n = \\dfrac{p}{R T^n}\\,\\mathrm{mol}\\,\\mathrm{m}^{-3}$, $\\Delta t = 1.0 \\times 10^{-6}\\,\\mathrm{s}$.\n3. Case C (edge: extremely small time step): $p = 1.01325 \\times 10^5\\,\\mathrm{Pa}$, $T^n = 6000\\,\\mathrm{K}$, $T_v^n = 4000\\,\\mathrm{K}$, $n_{N_2}^n = 1.80\\,\\mathrm{mol}\\,\\mathrm{m}^{-3}$, $n_N^n = 0.23\\,\\mathrm{mol}\\,\\mathrm{m}^{-3}$, $\\Delta t = 1.0 \\times 10^{-9}\\,\\mathrm{s}$.\n4. Case D (edge: very large time step pushing stiff dynamics): $p = 8.0 \\times 10^4\\,\\mathrm{Pa}$, $T^n = 10000\\,\\mathrm{K}$, $T_v^n = 3000\\,\\mathrm{K}$, $n_{N_2}^n = 0.70\\,\\mathrm{mol}\\,\\mathrm{m}^{-3}$, $n_N^n = 0.26\\,\\mathrm{mol}\\,\\mathrm{m}^{-3}$, $\\Delta t = 1.0 \\times 10^{-4}\\,\\mathrm{s}$.\n\nAssessment tolerances:\n- Atom conservation tolerance: relative difference less than $10^{-10}$,\n- Energy conservation tolerance: relative difference less than $10^{-8}$.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case contributes a list of three booleans $[b_{\\mathrm{pos}}, b_{\\mathrm{atoms}}, b_{\\mathrm{energy}}]$. For example, for four cases, the output must be of the form $[[b_{1,\\mathrm{pos}},b_{1,\\mathrm{atoms}},b_{1,\\mathrm{energy}}],[b_{2,\\mathrm{pos}},b_{2,\\mathrm{atoms}},b_{2,\\mathrm{energy}}],[b_{3,\\mathrm{pos}},b_{3,\\mathrm{atoms}},b_{3,\\mathrm{energy}}],[b_{4,\\mathrm{pos}},b_{4,\\mathrm{atoms}},b_{4,\\mathrm{energy}}]]$ with boolean literals.", "solution": "The user has provided a problem that is scientifically grounded, well-posed, and objective. It describes a standard physical model for thermo-chemical nonequilibrium in high-temperature nitrogen, a core topic in hypersonics. The task is to implement a robust numerical method, specifically a backward Euler time-stepping scheme solved with a Newton-type method, to find the state of the system after a discrete time interval. The problem is validated as sound, and a full solution is warranted.\n\nThe solution proceeds in three stages:\n1.  Formulation of the governing nonlinear system of equations for the state variables at the new time step.\n2.  Derivation of the Jacobian matrix required for Newton's method.\n3.  Implementation of the Newton-Raphson solver to find the solution for each test case, followed by the specified physical and numerical assessments.\n\nThe state of the system at any time $t$ is described by the vector of variables $\\mathbf{x} = [n_{N_2}, n_N, T_v, T]^T$, representing the molar concentrations of $N_2$ and $N$, the vibrational temperature of $N_2$, and the translational-rotational temperature, respectively. Given the state $\\mathbf{x}^n$ at time $t^n$, we seek the state $\\mathbf{x}^{n+1}$ at time $t^{n+1} = t^n + \\Delta t$.\n\n### 1. Governing Nonlinear System\n\nThe backward Euler method discretizes a system of ordinary differential equations $\\frac{d\\mathbf{y}}{dt} = \\mathbf{f}(\\mathbf{y})$ as $\\frac{\\mathbf{y}^{n+1} - \\mathbf{y}^n}{\\Delta t} = \\mathbf{f}(\\mathbf{y}^{n+1})$. This leads to a system of nonlinear algebraic equations for $\\mathbf{y}^{n+1}$. The provided differential equations are:\n$$\n\\frac{d n_{N_2}}{d t} = -\\mathcal{R} \\\\\n\\frac{d n_N}{d t} = 2\\,\\mathcal{R} \\\\\n\\frac{d T_v}{d t} = \\frac{T - T_v}{\\tau_v}\n$$\nAdditionally, the total internal energy per unit volume, $U$, is conserved since the system is adiabatic and at constant volume:\n$$\nU(n_{N_2},n_N,T_v,T) = \\text{constant}\n$$\nThe first two differential equations for the species concentrations are linearly dependent. Summing the second equation with $2$ times the first gives $\\frac{d n_N}{dt} + 2\\frac{d n_{N_2}}{dt} = 0$, which implies that the total number of nitrogen atoms per unit volume, $N_{\\mathrm{atoms}} = n_N + 2n_{N_2}$, is a conserved quantity. The discrete-time forms of the species equations, $n_N^{n+1} - n_N^n = 2\\Delta t \\mathcal{R}^{n+1}$ and $n_{N_2}^{n+1} - n_{N_2}^n = -\\Delta t \\mathcal{R}^{n+1}$, also conserve this quantity, i.e., $n_N^{n+1} + 2n_{N_2}^{n+1} = n_N^n + 2n_{N_2}^n$.\n\nTo construct a well-posed $4 \\times 4$ system for the $4$ unknowns in $\\mathbf{x}^{n+1}$, we replace one of the redundant species equations with the atom conservation law. This results in a system of $4$ independent nonlinear equations, $\\mathbf{F}(\\mathbf{x}^{n+1}) = \\mathbf{0}$, where $\\mathbf{x}^{n+1} = [n_{N_2}^{n+1}, n_N^{n+1}, T_v^{n+1}, T^{n+1}]^T$:\n\n1.  **$N_2$ species balance:** From $n_{N_2}^{n+1} - n_{N_2}^n = -\\Delta t \\mathcal{R}(T^{n+1},T_v^{n+1},n_{N_2}^{n+1},n_N^{n+1})$, we define the first residual component:\n    $$F_1(\\mathbf{x}^{n+1}) = n_{N_2}^{n+1} - n_{N_2}^{n} + \\Delta t\\, \\mathcal{R}^{n+1} = 0$$\n2.  **Atom conservation:** The total number of nitrogen atoms is conserved. Let $N_{\\mathrm{atoms,tot}} = n_N^n + 2n_{N_2}^n$. The second residual is:\n    $$F_2(\\mathbf{x}^{n+1}) = n_N^{n+1} + 2n_{N_2}^{n+1} - N_{\\mathrm{atoms,tot}} = 0$$\n3.  **Vibrational energy balance (Landau-Teller):** From $T_v^{n+1} - T_v^n = \\Delta t \\frac{T^{n+1} - T_v^{n+1}}{\\tau_v}$, we rearrange to get the third residual:\n    $$F_3(\\mathbf{x}^{n+1}) = T_v^{n+1}(1 + \\Delta t/\\tau_v) - T_v^n - (\\Delta t/\\tau_v) T^{n+1} = 0$$\n4.  **Total energy conservation:** The total internal energy $U$ is constant, $U^{n+1} = U^n$. Let $U_n = U(n_{N_2}^{n},n_N^{n},T_v^{n},T^{n})$. The fourth residual is:\n    $$F_4(\\mathbf{x}^{n+1}) = U(n_{N_2}^{n+1},n_N^{n+1},T_v^{n+1},T^{n+1}) - U_n = 0$$\n    where $U(n_{N_2},n_N,T_v,T) = n_N \\left(\\frac{3}{2} R T\\right) + n_{N_2} \\left(\\frac{5}{2} R T\\right) + n_{N_2}\\, e_{\\mathrm{vib}}(T_v) - n_{N_2}\\, D$.\n\nWe solve this system $\\mathbf{F}(\\mathbf{x}) = \\mathbf{0}$ for $\\mathbf{x} = \\mathbf{x}^{n+1}$ using Newton's method. The iterative update is $\\mathbf{x}_{k+1} = \\mathbf{x}_k - [J(\\mathbf{x}_k)]^{-1} \\mathbf{F}(\\mathbf{x}_k)$, where $J$ is the Jacobian matrix $J_{ij} = \\partial F_i / \\partial x_j$. The iteration starts with the initial guess $\\mathbf{x}_0 = \\mathbf{x}^n$.\n\n### 2. Jacobian Matrix Derivation\n\nThe Jacobian matrix $J$ is a $4 \\times 4$ matrix of the partial derivatives of the residual vector $\\mathbf{F} = [F_1, F_2, F_3, F_4]^T$ with respect to the solution vector $\\mathbf{x} = [n_{N_2}, n_N, T_v, T]^T$. We omit the superscript $^{n+1}$ for clarity.\n\nThe required partial derivatives of the constitutive relations are:\n- $\\mathcal{R} = k_f n_{N_2} - k_b n_N^2$\n- $k_f(T,T_v) = A_f \\exp\\left(-\\frac{E_a}{R T}\\right)\\,\\exp\\left(\\Theta_v\\left(\\frac{1}{T}-\\frac{1}{T_v}\\right)\\right)$\n- $\\frac{\\partial k_f}{\\partial T} = k_f \\frac{E_a - R\\Theta_v}{RT^2}$\n- $\\frac{\\partial k_f}{\\partial T_v} = k_f \\frac{\\Theta_v}{T_v^2}$\n- $k_b(T) = \\frac{k_f(T,T)}{K_{\\mathrm{eq}}(T)} = \\frac{A_f \\exp(-E_a/RT)}{K_{\\mathrm{pref}}\\, T^{3/2} \\exp(-D/RT)}$\n- $\\frac{\\partial k_b}{\\partial T} = k_b \\left( \\frac{E_a-D}{RT^2} - \\frac{3}{2T} \\right)$\n- $e_{\\mathrm{vib}}(T_v) = \\frac{R \\Theta_v}{\\exp(\\Theta_v/T_v) - 1}$\n- $\\frac{d e_{\\mathrm{vib}}}{d T_v} = \\frac{R \\Theta_v^2}{T_v^2} \\frac{\\exp(\\Theta_v/T_v)}{(\\exp(\\Theta_v/T_v) - 1)^2}$\n\nThe elements of the Jacobian $J_{ij} = \\partial F_i / \\partial x_j$ are:\n\n**Row 1 ($F_1$ derivatives):**\n- $J_{11} = \\frac{\\partial F_1}{\\partial n_{N_2}} = 1 + \\Delta t \\frac{\\partial \\mathcal{R}}{\\partial n_{N_2}} = 1 + \\Delta t\\, k_f$\n- $J_{12} = \\frac{\\partial F_1}{\\partial n_N} = \\Delta t \\frac{\\partial \\mathcal{R}}{\\partial n_N} = -2 \\Delta t\\, k_b n_N$\n- $J_{13} = \\frac{\\partial F_1}{\\partial T_v} = \\Delta t \\frac{\\partial \\mathcal{R}}{\\partial T_v} = \\Delta t\\, n_{N_2} \\frac{\\partial k_f}{\\partial T_v}$\n- $J_{14} = \\frac{\\partial F_1}{\\partial T} = \\Delta t \\frac{\\partial \\mathcal{R}}{\\partial T} = \\Delta t \\left( n_{N_2} \\frac{\\partial k_f}{\\partial T} - n_N^2 \\frac{\\partial k_b}{\\partial T} \\right)$\n\n**Row 2 ($F_2$ derivatives):**\n- $J_{21} = \\frac{\\partial F_2}{\\partial n_{N_2}} = 2$\n- $J_{22} = \\frac{\\partial F_2}{\\partial n_N} = 1$\n- $J_{23} = \\frac{\\partial F_2}{\\partial T_v} = 0$\n- $J_{24} = \\frac{\\partial F_2}{\\partial T} = 0$\n\n**Row 3 ($F_3$ derivatives):**\n- $J_{31} = \\frac{\\partial F_3}{\\partial n_{N_2}} = 0$\n- $J_{32} = \\frac{\\partial F_3}{\\partial n_N} = 0$\n- $J_{33} = \\frac{\\partial F_3}{\\partial T_v} = 1 + \\Delta t/\\tau_v$\n- $J_{34} = \\frac{\\partial F_3}{\\partial T} = -\\Delta t/\\tau_v$\n\n**Row 4 ($F_4$ derivatives):**\n- $J_{41} = \\frac{\\partial F_4}{\\partial n_{N_2}} = \\frac{5}{2} R T + e_{\\mathrm{vib}}(T_v) - D$\n- $J_{42} = \\frac{\\partial F_4}{\\partial n_N} = \\frac{3}{2} R T$\n- $J_{43} = \\frac{\\partial F_4}{\\partial T_v} = n_{N_2} \\frac{d e_{\\mathrm{vib}}}{d T_v}$\n- $J_{44} = \\frac{\\partial F_4}{\\partial T} = \\left(\\frac{3}{2} n_N + \\frac{5}{2} n_{N_2}\\right) R$\n\n### 3. Implementation and Assessment\n\nThe Newton-Raphson algorithm is implemented in Python. For each test case, the solver iteratively computes the residual vector $\\mathbf{F}$ and the Jacobian matrix $J$ at the current guess $\\mathbf{x}_k$, solves the linear system $J \\Delta\\mathbf{x} = -\\mathbf{F}$ for the update $\\Delta\\mathbf{x}$, and updates the solution $\\mathbf{x}_{k+1} = \\mathbf{x}_k + \\Delta\\mathbf{x}$. The iteration continues until the $L_2$-norm of the residual vector falls below a tolerance of $10^{-9}$.\n\nUpon convergence, the final state $\\mathbf{x}^{n+1}$ is assessed:\n- **Positivity:** Checks if $n_{N_2}^{n+1} \\ge 0$, $n_N^{n+1} \\ge 0$, $T_v^{n+1} > 0$, and $T^{n+1} > 0$.\n- **Atom conservation:** The relative error $|(n_N^{n+1} + 2n_{N_2}^{n+1}) - N_{\\mathrm{atoms,tot}}| / |N_{\\mathrm{atoms,tot}}|$ is compared against a tolerance of $10^{-10}$. Since this conservation law is built into the nonlinear system as $F_2=0$, this check is expected to pass to near machine precision.\n- **Energy conservation:** The relative error $|U^{n+1} - U^n|/|U^n|$ is compared against a tolerance of $10^{-8}$. This verifies that the solver has converged to a state that honors the energy conservation law $F_4=0$ with sufficient accuracy.\n\nThe implementation is then run for the four specified test cases, and the results of the assessments are collected.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# No other libraries outside the Python standard library are permitted.\n\ndef solve():\n    # Constants\n    R = 8.314462618  # J mol^-1 K^-1\n    THETA_V = 3390.0  # K\n    D_EV = 9.76  # eV\n    F_CONST = 96485.33212 # C/mol or J/V/mol\n    D = D_EV * F_CONST  # J mol^-1\n    A_F = 1.0e5  # s^-1\n    E_A = 2.0e5  # J mol^-1\n    K_PREF = 1.0e3  # mol m^-3 K^(-3/2)\n    TAU_V = 2.0e-6  # s\n\n    # Tolerances\n    TOL_ATOMS = 1.0e-10\n    TOL_ENERGY = 1.0e-8\n    NEWTON_TOL = 1.0e-9\n    MAX_ITER = 100\n\n    # Constitutive Relations\n    def e_vib(Tv):\n        # Vibrational energy per mole\n        if Tv = 0: return 0.0 # handle potential unphysical states during iteration\n        arg = THETA_V / Tv\n        # Avoid overflow for large arg, exp(arg) will be huge, e_vib -> 0\n        if arg > 100: return 0.0\n        return R * THETA_V / (np.exp(arg) - 1.0)\n\n    def U_total(n_n2, n_n, Tv, T):\n        # Total internal energy per unit volume\n        return (n_n * 1.5 * R * T +\n                n_n2 * 2.5 * R * T +\n                n_n2 * e_vib(Tv) -\n                n_n2 * D)\n\n    def kf_func(T, Tv):\n        # Forward rate coefficient\n        if T = 0 or Tv = 0: return 0.0\n        return A_F * np.exp(-E_A / (R * T)) * np.exp(THETA_V * (1.0/T - 1.0/Tv))\n\n    def kf_eq_func(T):\n        # Forward rate coefficient at T_v = T\n        if T = 0: return 0.0\n        return A_F * np.exp(-E_A / (R * T))\n\n    def K_eq_func(T):\n        # Equilibrium constant\n        if T = 0: return 0.0\n        return K_PREF * T**1.5 * np.exp(-D / (R * T))\n\n    def kb_func(T):\n        # Backward rate coefficient\n        if T = 0: return 0.0\n        K_eq = K_eq_func(T)\n        if K_eq == 0.0: return float('inf') # Should not happen for T > 0\n        return kf_eq_func(T) / K_eq\n\n    def reaction_rate(T, Tv, n_n2, n_n):\n        # Net reaction rate\n        return kf_func(T, Tv) * n_n2 - kb_func(T) * n_n**2\n\n    # Jacobian-related derivatives\n    def d_kf_d_T(T, Tv):\n        if T = 0 or Tv = 0: return 0.0\n        return kf_func(T, Tv) * (E_A - R * THETA_V) / (R * T**2)\n\n    def d_kf_d_Tv(T, Tv):\n        if T = 0 or Tv = 0: return 0.0\n        return kf_func(T, Tv) * THETA_V / Tv**2\n\n    def d_kb_d_T(T):\n        if T = 0: return 0.0\n        return kb_func(T) * ((E_A - D) / (R * T**2) - 1.5 / T)\n    \n    def d_e_vib_d_Tv(Tv):\n        if Tv = 0: return 0.0\n        arg = THETA_V / Tv\n        if arg > 100: return 0.0\n        exp_arg = np.exp(arg)\n        return R * (THETA_V / Tv)**2 * exp_arg / (exp_arg - 1.0)**2\n\n    def solve_case(initial_state, dt):\n        n_n2_n, n_n_n, Tv_n, T_n = initial_state\n        \n        N_atoms_tot = n_n_n + 2.0 * n_n2_n\n        U_n = U_total(n_n2_n, n_n_n, Tv_n, T_n)\n\n        # Initial guess for Newton's method\n        x_k = np.array([n_n2_n, n_n_n, Tv_n, T_n], dtype=float)\n\n        for _ in range(MAX_ITER):\n            n_n2_k, n_n_k, Tv_k, T_k = x_k\n\n            # Build residual vector F\n            F = np.zeros(4)\n            \n            # Check for unphysical state during iteration\n            if T_k = 0 or Tv_k = 0:\n                # Iteration diverged to unphysical state, break and fail\n                return [False, False, False]\n            \n            R_k = reaction_rate(T_k, Tv_k, n_n2_k, n_n_k)\n            F[0] = n_n2_k - n_n2_n + dt * R_k\n            F[1] = n_n_k + 2.0 * n_n2_k - N_atoms_tot\n            F[2] = Tv_k * (1.0 + dt / TAU_V) - Tv_n - (dt / TAU_V) * T_k\n            F[3] = U_total(n_n2_k, n_n_k, Tv_k, T_k) - U_n\n            \n            if np.linalg.norm(F)  NEWTON_TOL:\n                break\n\n            # Build Jacobian matrix J\n            J = np.zeros((4, 4))\n            \n            kf_k = kf_func(T_k, Tv_k)\n            kb_k = kb_func(T_k)\n\n            # Row 1\n            J[0, 0] = 1.0 + dt * kf_k\n            J[0, 1] = -2.0 * dt * kb_k * n_n_k\n            J[0, 2] = dt * n_n2_k * d_kf_d_Tv(T_k, Tv_k)\n            J[0, 3] = dt * (n_n2_k * d_kf_d_T(T_k, Tv_k) - n_n_k**2 * d_kb_d_T(T_k))\n\n            # Row 2\n            J[1, 0] = 2.0\n            J[1, 1] = 1.0\n            \n            # Row 3\n            J[2, 2] = 1.0 + dt / TAU_V\n            J[2, 3] = -dt / TAU_V\n\n            # Row 4\n            J[3, 0] = 2.5 * R * T_k + e_vib(Tv_k) - D\n            J[3, 1] = 1.5 * R * T_k\n            J[3, 2] = n_n2_k * d_e_vib_d_Tv(Tv_k)\n            J[3, 3] = (1.5 * n_n_k + 2.5 * n_n2_k) * R\n            \n            try:\n                delta_x = np.linalg.solve(J, -F)\n            except np.linalg.LinAlgError:\n                # Failed to solve, likely singular Jacobian\n                return [False, False, False]\n            \n            # Basic damping to prevent unphysical states\n            alpha = 1.0\n            while alpha > 1e-8:\n                x_new = x_k + alpha * delta_x\n                if x_new[0] >= -1e-12 and x_new[1] >= -1e-12 and x_new[2] > 0 and x_new[3] > 0:\n                    x_k = x_new\n                    break\n                alpha /= 2.0\n            else: # If while loop finishes without break\n                # Damping failed, can't find physical step\n                return [False, False, False]\n        else:\n            # Newton's method did not converge\n            return [False, False, False]\n\n        n_n2_f, n_n_f, Tv_f, T_f = x_k\n        n_n2_f = max(0.0, n_n2_f)\n        n_n_f = max(0.0, n_n_f)\n\n        # Assessments\n        positivity_ok = (n_n2_f >= 0 and n_n_f >= 0 and Tv_f > 0 and T_f > 0)\n\n        N_atoms_f = n_n_f + 2.0 * n_n2_f\n        atom_consv_ok = np.abs(N_atoms_f - N_atoms_tot) / np.abs(N_atoms_tot)  TOL_ATOMS if N_atoms_tot != 0 else N_atoms_f == 0\n\n        U_f = U_total(n_n2_f, n_n_f, Tv_f, T_f)\n        energy_consv_ok = np.abs(U_f - U_n) / np.abs(U_n)  TOL_ENERGY if U_n != 0 else U_f == 0\n\n        return [positivity_ok, atom_consv_ok, energy_consv_ok]\n\n    # Test cases\n    p_A, T_n_A, Tv_n_A, n_n2_n_A, n_n_n_A, dt_A = 5.0e4, 8000.0, 5000.0, 0.50, 0.25, 5.0e-7\n    \n    p_B, T_n_B, Tv_n_B, n_n2_n_B, dt_B = 2.0e4, 9000.0, 9000.0, 0.0, 1.0e-6\n    n_n_n_B = p_B / (R * T_n_B)\n    \n    p_C, T_n_C, Tv_n_C, n_n2_n_C, n_n_n_C, dt_C = 1.01325e5, 6000.0, 4000.0, 1.80, 0.23, 1.0e-9\n    \n    p_D, T_n_D, Tv_n_D, n_n2_n_D, n_n_n_D, dt_D = 8.0e4, 10000.0, 3000.0, 0.70, 0.26, 1.0e-4\n\n    test_cases = [\n        ((n_n2_n_A, n_n_n_A, Tv_n_A, T_n_A), dt_A),\n        ((n_n2_n_B, n_n_n_B, Tv_n_B, T_n_B), dt_B),\n        ((n_n2_n_C, n_n_n_C, Tv_n_C, T_n_C), dt_C),\n        ((n_n2_n_D, n_n_n_D, Tv_n_D, T_n_D), dt_D)\n    ]\n    \n    results = []\n    for case, dt in test_cases:\n        result = solve_case(case, dt)\n        results.append(result)\n\n    # Format output as a string representation of a list of lists of booleans\n    output_str = '[' + ','.join([str(res).replace(' ', '') for res in results]) + ']'\n    print(output_str)\n\nsolve()\n\n```", "id": "3332459"}]}