{"hands_on_practices": [{"introduction": "This first exercise is a foundational exploration of the method of characteristics for nonlinear hyperbolic equations. By working through the inviscid Burgers' equation, you will derive the solution from first principles, visualizing how information propagates along characteristic curves. This practice is crucial as it reveals precisely how and when an initially smooth solution can 'break' and form a shock wave, a defining feature of nonlinear wave phenomena.", "problem": "Consider the scalar conservation law for one-dimensional inviscid flow\n$$\nu_{t} + u\\,u_{x} = 0,\\quad (x,t)\\in \\mathbb{R}\\times [0,\\infty),\n$$\nwith initial condition\n$$\nu(x,0)=\\phi(x),\n$$\nwhere $\\phi:\\mathbb{R}\\to\\mathbb{R}$ is a continuously differentiable function with $\\phi\\in C^{1}(\\mathbb{R})$ and $\\phi$ and $\\phi'$ bounded. Starting from the conservation-law structure and the definition of characteristic curves, derive the characteristic ordinary differential equations and integrate them to obtain the Lagrangian flow map from initial footpoint $a$ to current position $x$ at time $t$. Use this to construct the characteristic mapping and state the precise condition under which it is locally invertible. Then, express the classical solution $u(x,t)$, valid up to the earliest time of shock formation, in terms of $\\phi$ and the inverse of the characteristic footpoint mapping. Finally, determine the earliest shock formation time $t_{\\ast}$ in terms of $\\phi'$, understood as the supremum of times for which a classical solution with $u\\in C^{1}$ exists.\n\nYour final answer must consist of:\n- a single explicit expression for $u(x,t)$ written in terms of $\\phi$ and the inverse of the characteristic footpoint map, and\n- a single explicit expression for $t_{\\ast}$ written in terms of $\\phi'$.\n\nNo numerical evaluation or rounding is required. Express your answer symbolically. Do not include units. If your expression is piecewise-defined, you must write it explicitly as such.", "solution": "The problem as stated constitutes a valid initial value problem for the inviscid Burgers' equation, a fundamental scalar hyperbolic conservation law. All provided information is consistent and sufficient to derive the classical solution via the method of characteristics and to determine its time of validity.\n\nThe given partial differential equation is the inviscid Burgers' equation in quasi-linear form:\n$$\nu_{t} + u\\,u_{x} = 0, \\quad (x,t)\\in \\mathbb{R}\\times [0,\\infty)\n$$\nwith the initial condition $u(x,0)=\\phi(x)$. The function $\\phi$ is given to be in $C^{1}(\\mathbb{R})$ with $\\phi$ and its derivative $\\phi'$ being bounded.\n\nWe seek a solution using the method of characteristics. Let a curve in the $(x,t)$-plane be parameterized by $s \\mapsto (x(s), t(s))$. Let's choose $s=t$, so the curve is given by $x(t)$. The total derivative of the solution $u(x(t),t)$ along this curve is:\n$$\n\\frac{d}{dt}u(x(t),t) = u_{t}(x(t),t) + u_{x}(x(t),t) \\frac{dx}{dt}\n$$\nComparing this with the PDE, $u_t = -u u_x$, we see that if we define the characteristic curves by the ordinary differential equation (ODE):\n$$\n\\frac{dx}{dt} = u(x(t),t)\n$$\nthen along these curves, the total derivative of $u$ becomes:\n$$\n\\frac{d}{dt}u(x(t),t) = -u u_x + u_x u = 0\n$$\nThus, the system of characteristic ODEs is:\n$$\n\\frac{du}{dt} = 0\n$$\n$$\n\\frac{dx}{dt} = u\n$$\nThe first ODE, $\\frac{du}{dt}=0$, implies that the value of the solution $u$ is constant along any given characteristic curve. The value of this constant is determined by the initial condition. Let a characteristic curve originate at the point $(a,0)$ on the initial line $t=0$. The value of $u$ along this entire curve is $u(x(0),0) = u(a,0) = \\phi(a)$.\n\nSubstituting this constant value into the second ODE, we get:\n$$\n\\frac{dx}{dt} = \\phi(a)\n$$\nWe integrate this ODE with respect to time $t$, using the initial condition $x(0)=a$:\n$$\n\\int_{a}^{x} d\\xi = \\int_{0}^{t} \\phi(a) d\\tau\n$$\nThis yields the equation for the characteristic lines:\n$$\nx(t) = a + \\phi(a)t\n$$\nThis equation represents the Lagrangian flow map, which we will denote by $x = M(a; t)$. It gives the position $x$ at time $t$ for a characteristic that started at the footpoint $a$ at $t=0$.\n\nThe solution $u$ at any point $(x,t)$ is the value $\\phi(a)$ carried by the characteristic that passes through $(x,t)$. To find this, we must determine the footpoint $a$ corresponding to a given $(x,t)$. This requires inverting the characteristic mapping $M(a;t)$. Let us denote this inverse map by $a(x,t)$, i.e., $a(x,t) = M^{-1}(x;t)$. The function $a(x,t)$ is therefore defined implicitly by the relation:\n$$\nx = a(x,t) + \\phi(a(x,t))t\n$$\nThe classical solution, valid for as long as this inversion is possible and unique, is then given by:\n$$\nu(x,t) = \\phi(a(x,t))\n$$\nThe condition for the characteristic mapping $a \\mapsto x$ to be locally invertible for a fixed $t$ is that its Jacobian does not vanish. In this one-dimensional case, the Jacobian is the derivative $\\frac{\\partial x}{\\partial a}$:\n$$\n\\frac{\\partial M(a;t)}{\\partial a} = \\frac{\\partial}{\\partial a}(a + \\phi(a)t) = 1 + \\phi'(a)t\n$$\nA classical, single-valued solution exists as long as $1 + \\phi'(a)t \\neq 0$ for all $a \\in \\mathbb{R}$. Since $t \\ge 0$, if $\\phi'(a) \\ge 0$ for all $a$, this condition is always satisfied.\n\nA shock wave forms at the earliest time $t_{\\ast} > 0$ when characteristics intersect. This corresponds to the instant when the derivative $u_x$ first becomes infinite, signaling the breakdown of the $C^1$ solution. To find $u_x$, we differentiate the expression for the solution with respect to $x$:\n$$\nu_x(x,t) = \\phi'(a(x,t)) \\frac{\\partial a}{\\partial x}\n$$\nTo find $\\frac{\\partial a}{\\partial x}$, we differentiate the implicit relation $x = a + \\phi(a)t$ with respect to $x$:\n$$\n1 = \\frac{\\partial a}{\\partial x} \\left( 1 + \\phi'(a(x,t))t \\right) \\implies \\frac{\\partial a}{\\partial x} = \\frac{1}{1 + \\phi'(a(x,t))t}\n$$\nSubstituting this back, we get the expression for the gradient of the solution:\n$$\nu_x(x,t) = \\frac{\\phi'(a(x,t))}{1 + \\phi'(a(x,t))t}\n$$\nThe gradient $u_x$ becomes infinite when the denominator is zero:\n$$\n1 + \\phi'(a)t = 0 \\implies t = -\\frac{1}{\\phi'(a)}\n$$\nSince $t$ must be positive, this can only occur for values of $a$ where $\\phi'(a) < 0$. The earliest time of shock formation, $t_{\\ast}$, is the minimum of these times over all possible initial points $a$:\n$$\nt_{\\ast} = \\inf_{a \\in \\mathbb{R} : \\phi'(a)<0} \\left\\{ -\\frac{1}{\\phi'(a)} \\right\\}\n$$\nTo find this infimum, we need to maximize the positive quantity $-\\phi'(a)$, which is equivalent to finding the minimum (most negative) value of $\\phi'(a)$. Let $m = \\inf_{y \\in \\mathbb{R}} \\phi'(y)$.\n\nThere are two cases:\n1.  If $m \\ge 0$, then $\\phi'(y) \\ge 0$ for all $y \\in \\mathbb{R}$. The condition for shock formation is never met. The classical solution exists for all time, so $t_{\\ast} = \\infty$.\n2.  If $m < 0$, a shock will form. The earliest time it can form corresponds to the most negative value of $\\phi'$, which is $m$. The shock time is $t_{\\ast} = -\\frac{1}{m} = -\\frac{1}{\\inf_{y \\in \\mathbb{R}} \\phi'(y)}$.\n\nCombining these cases, we arrive at the expression for the earliest shock formation time.\nThe first requested item is the expression for the classical solution $u(x,t)$ in terms of $\\phi$ and the inverse of the characteristic footpoint mapping. As derived, this is $u(x,t)=\\phi(a(x,t))$, where $a(x,t)$ is the inverse mapping.\nThe second requested item is the expression for the earliest shock time $t_{\\ast}$.", "answer": "$$\n\\boxed{u(x,t) = \\phi(a(x,t))}\n$$\n$$\n\\boxed{t_{\\ast} = \\begin{cases} -\\frac{1}{\\inf_{y \\in \\mathbb{R}} \\phi'(y)} & \\text{if } \\inf_{y \\in \\mathbb{R}} \\phi'(y) < 0 \\\\ \\infty & \\text{if } \\inf_{y \\in \\mathbb{R}} \\phi'(y) \\ge 0 \\end{cases}}\n$$", "id": "3376534"}, {"introduction": "Building directly upon the theoretical foundation of shock formation, this practice applies the general principles to a concrete case. By analyzing the Burgers' equation with a simple sinusoidal initial condition, you will calculate the exact time and location where the shock first appears. This exercise provides a tangible demonstration of how the derivative of the initial data, $u_0'(x)$, governs the convergence of characteristics and the subsequent breakdown of the classical solution [@problem_id:3376534].", "problem": "Consider the inviscid Burgers equation, a prototypical nonlinear hyperbolic conservation law in Computational Fluid Dynamics (CFD), given by\n$$\nu_{t} + u\\,u_{x} = 0,\n$$\nposed on the periodic spatial domain $$x \\in [0,2\\pi]$$ with periodic boundary conditions, and with smooth initial data\n$$\nu(x,0) = u_{0}(x) = \\sin x.\n$$\nUsing only the fundamental properties of characteristics for first-order hyperbolic partial differential equations and the criterion for loss of smoothness due to characteristic crossing, proceed as follows:\n- Starting from the characteristic ordinary differential equations associated with $$u_{t} + u\\,u_{x} = 0$$, derive the expression for the mapping from an initial Lagrangian label to the current Eulerian position, and the condition under which this mapping ceases to be invertible.\n- Use this condition to obtain a general expression for the earliest time of shock formation $$t_{b}$$ in terms of the initial data $$u_{0}(x)$$, and then evaluate $$t_{b}$$ for $$u_{0}(x) = \\sin x$$.\n- Determine the corresponding first spatial location $$x_{s} \\in [0,2\\pi]$$ at which the shock forms at time $$t_{b}$$.\n\nYour final answer must be the pair $$\\left(t_{b},\\,x_{s}\\right)$$ expressed as a single closed-form analytic expression. No rounding is required. Since the variables are nondimensional, do not include units. Express the final pair as a two-entry row vector.", "solution": "The problem requires the determination of the shock formation time $t_b$ and location $x_s$ for the inviscid Burgers' equation $u_{t} + u\\,u_{x} = 0$ with initial condition $u(x,0) = \\sin x$ on a periodic domain $x \\in [0,2\\pi]$. The method of characteristics for first-order hyperbolic partial differential equations is to be used.\n\nThe given partial differential equation (PDE) is:\n$$\nu_{t} + u\\,u_{x} = 0\n$$\nThis equation describes the evolution of a quantity $u$ where the velocity of propagation is the quantity $u$ itself. The left-hand side can be interpreted as the total derivative of $u$ along a curve $x(t)$ if $\\frac{dx}{dt} = u$. This leads to the system of characteristic ordinary differential equations (ODEs):\n$$\n\\frac{du}{dt} = 0\n$$\n$$\n\\frac{dx}{dt} = u\n$$\nLet us parameterize the characteristic curves by their starting position at $t=0$, denoted by the Lagrangian label $\\xi$. Thus, for each characteristic curve, we have the initial condition $x(0) = \\xi$.\n\nThe first ODE, $\\frac{du}{dt} = 0$, implies that $u$ is constant along each characteristic curve. The value of this constant is determined by the initial condition at $t=0$:\n$$\nu(x(t), t) = u(x(0), 0) = u(\\xi, 0) = u_0(\\xi)\n$$\nSubstituting this result into the second ODE, we obtain:\n$$\n\\frac{dx}{dt} = u_0(\\xi)\n$$\nSince $u_0(\\xi)$ is constant for a given characteristic (i.e., for a given $\\xi$), we can integrate this ODE with respect to time $t$ from $0$ to $t$:\n$$\n\\int_{x(0)}^{x(t)} dx' = \\int_{0}^{t} u_0(\\xi) dt'\n$$\nUsing the initial condition $x(0) = \\xi$, this yields:\n$$\nx(t) - \\xi = u_0(\\xi)t\n$$\nThis gives the expression for the mapping from the initial Lagrangian position $\\xi$ to the current Eulerian position $x$ at time $t$:\n$$\nx(\\xi, t) = \\xi + u_0(\\xi)t\n$$\nThe solution $u(x,t)$ is then given implicitly by the relations $u = u_0(\\xi)$ and $x = \\xi + u_0(\\xi)t$. For the solution to be well-defined and smooth, we must be able to uniquely solve for $\\xi$ from the mapping $x(\\xi, t)$ for any given $x$ and $t$. This is possible as long as the mapping is one-to-one, i.e., invertible. The invertibility is lost when the Jacobian of the transformation from $\\xi$ to $x$ becomes zero. The Jacobian is given by:\n$$\nJ = \\frac{\\partial x}{\\partial \\xi} = \\frac{\\partial}{\\partial \\xi} \\left( \\xi + u_0(\\xi)t \\right) = 1 + u_0'(\\xi)t\n$$\nwhere $u_0'(\\xi) = \\frac{du_0}{d\\xi}$. The mapping ceases to be invertible when $J=0$, which is the condition for characteristic crossing:\n$$\n1 + u_0'(\\xi)t = 0\n$$\nFrom this condition, we can solve for the time $t$ at which characteristics originating from a point $\\xi$ cross:\n$$\nt = -\\frac{1}{u_0'(\\xi)}\n$$\nA physically meaningful shock can only form at a positive time $t > 0$. This requires that $u_0'(\\xi)$ must be negative. The earliest time of shock formation, known as the breaking time $t_b$, corresponds to the minimum positive value of $t$ over all possible initial positions $\\xi$. To minimize $t$, we must maximize the magnitude of its denominator, $|u_0'(\\xi)|$, for negative values of $u_0'(\\xi)$. This is equivalent to finding the minimum (most negative) value of $u_0'(\\xi)$. Therefore, the general expression for the breaking time is:\n$$\nt_b = \\min_{\\xi \\text{ s.t. } u_0'(\\xi)<0} \\left( -\\frac{1}{u_0'(\\xi)} \\right) = -\\frac{1}{\\min_{\\xi} u_0'(\\xi)}\n$$\nThis formula is valid if and only if $\\min_{\\xi} u_0'(\\xi) < 0$. If $\\min_{\\xi} u_0'(\\xi) \\ge 0$, no shocks will form.\n\nNow we apply this to the given initial data, $u_0(x) = \\sin x$. Using $\\xi$ as the initial position variable, we have $u_0(\\xi) = \\sin \\xi$. The derivative is:\n$$\nu_0'(\\xi) = \\frac{d}{d\\xi}(\\sin \\xi) = \\cos \\xi\n$$\nWe need to find the minimum value of $u_0'(\\xi)$ on the domain $\\xi \\in [0, 2\\pi]$. The minimum value of the cosine function is $-1$.\n$$\n\\min_{\\xi \\in [0,2\\pi]} u_0'(\\xi) = \\min_{\\xi \\in [0,2\\pi]} (\\cos \\xi) = -1\n$$\nSince this minimum is less than $0$, a shock will form. The breaking time $t_b$ is:\n$$\nt_b = -\\frac{1}{-1} = 1\n$$\nThe shock first forms at time $t_b = 1$. To find the spatial location $x_s$ of this first shock, we must first identify the initial position $\\xi_s$ where the derivative $u_0'(\\xi)$ attains its minimum value. We found this minimum to be $-1$, which occurs when $\\cos \\xi = -1$. Within the domain $\\xi \\in [0, 2\\pi]$, this happens at:\n$$\n\\xi_s = \\pi\n$$\nThe corresponding Eulerian location $x_s$ at time $t_b=1$ is found by substituting $\\xi_s$ and $t_b$ into the characteristic mapping equation:\n$$\nx_s = x(\\xi_s, t_b) = \\xi_s + u_0(\\xi_s)t_b\n$$\nWith $\\xi_s = \\pi$, $t_b=1$, and $u_0(\\xi_s) = \\sin(\\pi) = 0$, we have:\n$$\nx_s = \\pi + (0)(1) = \\pi\n$$\nThus, the shock first forms at time $t_b=1$ at the spatial location $x_s=\\pi$. The final answer is the pair $(t_b, x_s)$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1 & \\pi\n\\end{pmatrix}\n}\n$$", "id": "3376588"}, {"introduction": "We now shift our focus to a different, yet equally fundamental, scenario: the Riemann problem, where the initial data is discontinuous from the start. This exercise introduces the concept of weak solutions and the celebrated Rankine-Hugoniot jump condition, which is essential for determining the speed of a shock wave. Understanding how to analyze these initial discontinuities is a cornerstone for developing and interpreting modern shock-capturing numerical schemes in CFD.", "problem": "Consider the one-dimensional nonlinear scalar conservation law\n$$\nu_{t} + \\partial_{x} f(u) = 0,\n$$\nrepresenting an inviscid conservation of a scalar quantity in computational fluid dynamics, with flux function $$f(u) = \\frac{u^{3}}{3}$$. The initial condition is a Riemann datum\n$$\nu(x,0) = \\begin{cases}\nu_{L}, & x < 0, \\\\\nu_{R}, & x > 0,\n\\end{cases}\n$$\nwhere $$u_{L} = 2$$ and $$u_{R} = -1$$. Using the Method of Characteristics (MOC) and the weak solution framework derived from the integral form of conservation laws, determine whether the resulting self-similar solution is a shock or a rarefaction. If a shock forms, compute its speed using the appropriate conservation and admissibility principles.\n\nExpress the final answer as a single real number for the shock speed (dimensionless). Provide the exact value; do not round.", "solution": "The problem statement has been validated and is deemed sound, well-posed, and scientifically grounded. It presents a classic Riemann problem for a nonlinear scalar conservation law.\n\nThe governing one-dimensional nonlinear scalar conservation law is given by:\n$$\nu_{t} + \\partial_{x} f(u) = 0\n$$\nwhere $u(x,t)$ is the conserved quantity, and the flux function $f(u)$ is specified as:\n$$\nf(u) = \\frac{u^{3}}{3}\n$$\nThe problem is subject to a Riemann initial condition:\n$$\nu(x,0) = \\begin{cases}\nu_{L}, & x < 0 \\\\\nu_{R}, & x > 0\n\\end{cases}\n$$\nwith the constant states $u_{L} = 2$ and $u_{R} = -1$.\n\nTo analyze the evolution of the solution, we first write the partial differential equation in its quasi-linear form, $u_{t} + c(u) u_{x} = 0$, where $c(u)$ is the characteristic speed. The characteristic speed is given by the derivative of the flux function with respect to $u$:\n$$\nc(u) = f'(u) = \\frac{d}{du}\\left(\\frac{u^{3}}{3}\\right) = u^{2}\n$$\nThe Method of Characteristics states that the value of $u$ remains constant along characteristic curves defined by $\\frac{dx}{dt} = c(u)$.\n\nWe evaluate the characteristic speeds for the initial left and right states:\nThe characteristic speed for the left state $u_{L} = 2$ is:\n$$\nc(u_{L}) = c(2) = 2^{2} = 4\n$$\nThe characteristic speed for the right state $u_{R} = -1$ is:\n$$\nc(u_{R}) = c(-1) = (-1)^{2} = 1\n$$\nThe type of solution that emerges from the initial discontinuity depends on the relationship between $c(u_{L})$ and $c(u_{R})$.\n- If $c(u_{L}) < c(u_{R})$, the characteristics diverge, and a continuous solution known as a rarefaction wave forms.\n- If $c(u_{L}) > c(u_{R})$, the characteristics from the left overtake the characteristics from the right. They intersect, leading to a multi-valued solution, which is unphysical. Nature resolves this by forming a discontinuity, or a shock wave.\n\nIn this problem, we have $c(u_{L}) = 4$ and $c(u_{R}) = 1$. Since $c(u_{L}) > c(u_{R})$, the characteristics collide, and a shock wave must form.\n\nThe speed of this shock, denoted by $s$, is determined by the Rankine-Hugoniot jump condition. This condition is derived from the integral form of the conservation law applied across the discontinuity and ensures that the shock correctly conserves the quantity $u$. The condition is:\n$$\ns = \\frac{f(u_{R}) - f(u_{L})}{u_{R} - u_{L}}\n$$\nWe now compute the values of the flux function for the left and right states:\nFor $u_{L} = 2$, the flux is:\n$$\nf(u_{L}) = f(2) = \\frac{2^{3}}{3} = \\frac{8}{3}\n$$\nFor $u_{R} = -1$, the flux is:\n$$\nf(u_{R}) = f(-1) = \\frac{(-1)^{3}}{3} = -\\frac{1}{3}\n$$\nSubstituting these values into the Rankine-Hugoniot condition to find the shock speed $s$:\n$$\ns = \\frac{-\\frac{1}{3} - \\frac{8}{3}}{-1 - 2} = \\frac{-\\frac{9}{3}}{-3} = \\frac{-3}{-3} = 1\n$$\nFor this shock to be physically admissible, it must satisfy an entropy condition. The flux function $f(u) = u^3/3$ is non-convex, since its second derivative $f''(u) = 2u$ changes sign. Therefore, we must use the general Oleinik entropy condition. For a shock connecting $u_{L}$ to $u_{R}$ where $u_{L} > u_{R}$, the condition requires that the graph of $f(u)$ for $u \\in [u_{R}, u_{L}]$ lie below or on the line segment (the chord) connecting the points $(u_{R}, f(u_{R}))$ and $(u_{L}, f(u_{L}))$.\nMathematically, this translates to:\n$$\nf(u) \\le f(u_{R}) + s(u - u_{R}) \\quad \\text{for all } u \\in [u_{R}, u_{L}]\n$$\nPlugging in the known values, with $s=1$, $u_R=-1$, and $f(u_R)=-1/3$:\n$$\n\\frac{u^3}{3} \\le -\\frac{1}{3} + 1(u - (-1)) \\quad \\text{for all } u \\in [-1, 2]\n$$\n$$\n\\frac{u^3}{3} \\le u + 1 - \\frac{1}{3}\n$$\n$$\n\\frac{u^3}{3} \\le u + \\frac{2}{3}\n$$\nMultiplying by $3$ and rearranging gives:\n$$\nu^3 - 3u - 2 \\le 0\n$$\nLet's analyze the polynomial $p(u) = u^3 - 3u - 2$. By construction, its roots must include $u=u_L=2$ and $u=u_R=-1$. Indeed, $p(2) = 2^3 - 3(2) - 2 = 8 - 6 - 2 = 0$ and $p(-1) = (-1)^3 - 3(-1) - 2 = -1 + 3 - 2 = 0$. Since $u=-1$ is a root, $(u+1)$ is a factor. Since $p'(-1) = 3(-1)^2 - 3 = 0$, $u=-1$ is a double root. The polynomial factors as $p(u) = (u-2)(u+1)^2$.\nFor $u \\in [-1, 2]$, the term $(u+1)^2$ is non-negative, and the term $(u-2)$ is non-positive. Consequently, their product $(u-2)(u+1)^2$ is non-positive for all $u$ in the interval $[-1, 2]$. The Oleinik entropy condition is satisfied, confirming that the shock is admissible.\n\nThe resulting self-similar solution is a shock wave propagating with a constant speed $s = 1$.", "answer": "$$\n\\boxed{1}\n$$", "id": "3376556"}]}