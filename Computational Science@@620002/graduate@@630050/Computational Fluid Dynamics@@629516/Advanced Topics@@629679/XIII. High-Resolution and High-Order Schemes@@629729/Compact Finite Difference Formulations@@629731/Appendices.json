{"hands_on_practices": [{"introduction": "The construction of high-order finite difference schemes from first principles is a cornerstone of numerical methods. This exercise guides you through the process of deriving a fourth-order compact approximation for the second derivative, $u_{xx}$, using Taylor series analysis [@problem_id:3302438]. By matching coefficients of the Taylor expansion, you will determine the precise relationship between neighboring function and derivative values that yields superior accuracy, revealing why compact formulations are a powerful tool in CFD.", "problem": "Consider a smooth function $u(x)$ sampled on a uniform grid $x_i = x_0 + i \\,\\Delta x$ with spacing $\\Delta x > 0$. In the context of spatial discretization for Computational Fluid Dynamics (CFD), a compact finite difference formulation approximates derivatives by implicitly coupling neighboring derivative values. You are asked to derive a fourth-order accurate compact relation for the second derivative $u_{xx}$ at grid point $i$ of the form\n$$\n\\alpha \\, u''_{i-1} + u''_{i} + \\alpha \\, u''_{i+1}\n=\na \\,\\frac{u_{i+1} - 2 u_i + u_{i-1}}{\\Delta x^2}\n+\nb \\,\\frac{u_{i+2} - 2 u_i + u_{i-2}}{4\\,\\Delta x^2},\n$$\nwhere $u_i \\equiv u(x_i)$ and $u''_i \\equiv u_{xx}(x_i)$, and $\\alpha$, $a$, $b$ are real constants independent of $i$ and $\\Delta x$. Starting from Taylor series expansions about $x_i$ and the definition of consistency, determine the values of $\\alpha$, $a$, and $b$ such that the truncation error is $\\mathcal{O}(\\Delta x^4)$ as $\\Delta x \\to 0$. Among all coefficient triples $(\\alpha,a,b)$ satisfying fourth-order accuracy, impose the additional design choice that the right-hand-side stencil is as narrow as possible by taking $b=0$. Your final answer must be the ordered triple $(\\alpha, a, b)$ expressed exactly as rational numbers. No rounding is required and no units are needed.", "solution": "The problem requires the derivation of the coefficients $\\alpha$, $a$, and $b$ for a compact finite difference scheme for the second derivative $u_{xx}$, given by the relation:\n$$\n\\alpha \\, u''_{i-1} + u''_{i} + \\alpha \\, u''_{i+1}\n=\na \\,\\frac{u_{i+1} - 2 u_i + u_{i-1}}{\\Delta x^2}\n+\nb \\,\\frac{u_{i+2} - 2 u_i + u_{i-2}}{4\\,\\Delta x^2}\n$$\nThe scheme must have a truncation error of $\\mathcal{O}(\\Delta x^4)$, and we are to select the specific scheme for which $b=0$. The derivation proceeds by performing Taylor series expansions of each term about the grid point $x_i$. For convenience, we let $h = \\Delta x$ and use the notation $u^{(n)}$ to denote the $n$-th derivative of $u(x)$ evaluated at $x_i$.\n\nThe Taylor series expansions for the function values $u_{i \\pm k}$ are:\n$$ u_{i \\pm k} = u(x_i \\pm k h) = u_i \\pm (kh) u^{(1)} + \\frac{(kh)^2}{2!} u^{(2)} \\pm \\frac{(kh)^3}{3!} u^{(3)} + \\frac{(kh)^4}{4!} u^{(4)} \\pm \\frac{(kh)^5}{5!} u^{(5)} + \\frac{(kh)^6}{6!} u^{(6)} + \\mathcal{O}(h^7) $$\nThe Taylor series expansions for the second derivative values $u''_{i \\pm 1}$ are:\n$$ u''_{i \\pm 1} = u^{(2)}(x_i \\pm h) = u^{(2)} \\pm h u^{(3)} + \\frac{h^2}{2!} u^{(4)} \\pm \\frac{h^3}{3!} u^{(5)} + \\frac{h^4}{4!} u^{(6)} \\pm \\frac{h^5}{5!} u^{(7)} + \\mathcal{O}(h^6) $$\n\nFirst, we expand the left-hand side (LHS) of the given relation:\n$$ \\text{LHS} = \\alpha (u''_{i-1} + u''_{i+1}) + u''_i $$\nUsing the expansion for $u''_{i \\pm 1}$:\n$$ u''_{i-1} + u''_{i+1} = \\left(u^{(2)} - h u^{(3)} + \\frac{h^2}{2} u^{(4)} - \\frac{h^3}{6} u^{(5)} + \\frac{h^4}{24} u^{(6)}\\right) + \\left(u^{(2)} + h u^{(3)} + \\frac{h^2}{2} u^{(4)} + \\frac{h^3}{6} u^{(5)} + \\frac{h^4}{24} u^{(6)}\\right) + \\mathcal{O}(h^6) $$\n$$ u''_{i-1} + u''_{i+1} = 2u^{(2)} + h^2 u^{(4)} + \\frac{h^4}{12} u^{(6)} + \\mathcal{O}(h^6) $$\nSubstituting this back into the LHS expression:\n$$ \\text{LHS} = \\alpha \\left(2u^{(2)} + h^2 u^{(4)} + \\frac{h^4}{12} u^{(6)} \\right) + u^{(2)} + \\mathcal{O}(h^6) $$\n$$ \\text{LHS} = (1 + 2\\alpha) u^{(2)} + \\alpha h^2 u^{(4)} + \\frac{\\alpha h^4}{12} u^{(6)} + \\mathcal{O}(h^6) $$\n\nNext, we expand the right-hand side (RHS) of the relation. We analyze the two finite difference terms separately.\nFor the first term, involving points $i-1, i, i+1$:\n$$ u_{i+1} - 2u_i + u_{i-1} = \\left(u_i + h u^{(1)} + \\frac{h^2}{2} u^{(2)} + \\frac{h^3}{6} u^{(3)} + \\dots\\right) - 2u_i + \\left(u_i - h u^{(1)} + \\frac{h^2}{2} u^{(2)} - \\frac{h^3}{6} u^{(3)} + \\dots\\right) $$\nBy collecting terms with even powers of $h$, we get:\n$$ u_{i+1} - 2u_i + u_{i-1} = h^2 u^{(2)} + \\frac{h^4}{12} u^{(4)} + \\frac{h^6}{360} u^{(6)} + \\mathcal{O}(h^8) $$\nSo the first term on the RHS is:\n$$ a \\frac{u_{i+1} - 2u_i + u_{i-1}}{h^2} = a \\left( u^{(2)} + \\frac{h^2}{12} u^{(4)} + \\frac{h^4}{360} u^{(6)} \\right) + \\mathcal{O}(h^6) $$\nFor the second term, involving points $i-2, i, i+2$, we replace $h$ with $2h$ in the above central difference formula:\n$$ u_{i+2} - 2u_i + u_{i-2} = (2h)^2 u^{(2)} + \\frac{(2h)^4}{12} u^{(4)} + \\frac{(2h)^6}{360} u^{(6)} + \\mathcal{O}(h^8) $$\n$$ u_{i+2} - 2u_i + u_{i-2} = 4h^2 u^{(2)} + \\frac{4h^4}{3} u^{(4)} + \\frac{8h^6}{45} u^{(6)} + \\mathcal{O}(h^8) $$\nSo the second term on the RHS is:\n$$ b \\frac{u_{i+2} - 2u_i + u_{i-2}}{4h^2} = b \\left( u^{(2)} + \\frac{h^2}{3} u^{(4)} + \\frac{2h^4}{45} u^{(6)} \\right) + \\mathcal{O}(h^6) $$\nCombining the two terms to form the full RHS:\n$$ \\text{RHS} = (a+b) u^{(2)} + \\left(\\frac{a}{12} + \\frac{b}{3}\\right) h^2 u^{(4)} + \\left(\\frac{a}{360} + \\frac{2b}{45}\\right) h^4 u^{(6)} + \\mathcal{O}(h^6) $$\n\nFor a fourth-order accurate scheme, the Taylor series expansions of the LHS and RHS must match for the terms up to and including $u^{(4)}$. This means the truncation error, defined as $\\text{LHS} - \\text{RHS}$, must be $\\mathcal{O}(h^4)$. By equating the coefficients of the corresponding derivative terms on the LHS and RHS, we obtain a system of linear equations for the coefficients $\\alpha$, $a$, and $b$.\n\nMatching the coefficient of $u^{(2)}$:\n$$ 1 + 2\\alpha = a + b \\quad (1) $$\nThis condition ensures the scheme is consistent for the second derivative.\n\nMatching the coefficient of $h^2 u^{(4)}$:\n$$ \\alpha = \\frac{a}{12} + \\frac{b}{3} \\quad (2) $$\nSatisfying this condition eliminates the $\\mathcal{O}(h^2)$ error term, elevating the scheme's accuracy to at least fourth order.\n\nThe problem imposes the design choice that the RHS stencil be as narrow as possible, which is achieved by setting $b=0$. Substituting $b=0$ into equations $(1)$ and $(2)$:\n$$ 1 + 2\\alpha = a \\quad (1') $$\n$$ \\alpha = \\frac{a}{12} \\quad (2') $$\nThis is a system of two equations for the two unknowns $\\alpha$ and $a$. We can solve this system by substituting the expression for $a$ from $(1')$ into $(2')$:\n$$ \\alpha = \\frac{1 + 2\\alpha}{12} $$\nMultiplying by $12$:\n$$ 12\\alpha = 1 + 2\\alpha $$\n$$ 10\\alpha = 1 $$\n$$ \\alpha = \\frac{1}{10} $$\nNow we find $a$ using equation $(1')$:\n$$ a = 1 + 2\\alpha = 1 + 2\\left(\\frac{1}{10}\\right) = 1 + \\frac{1}{5} = \\frac{6}{5} $$\nThus, the coefficients are $\\alpha = \\frac{1}{10}$, $a = \\frac{6}{5}$, and $b=0$.\n\nTo confirm the order of accuracy, we examine the leading error term, which is the coefficient of $h^4 u^{(6)}$ in the truncation error $\\text{LHS} - \\text{RHS}$:\n$$ C = \\left(\\frac{\\alpha}{12}\\right) - \\left(\\frac{a}{360} + \\frac{2b}{45}\\right) $$\nSubstituting the derived coefficient values:\n$$ C = \\frac{1/10}{12} - \\left(\\frac{6/5}{360} + 0\\right) = \\frac{1}{120} - \\frac{6}{1800} = \\frac{1}{120} - \\frac{1}{300} $$\n$$ C = \\frac{5}{600} - \\frac{2}{600} = \\frac{3}{600} = \\frac{1}{200} $$\nSince this coefficient is non-zero, the leading term of the truncation error is $\\frac{1}{200} u^{(6)} \\Delta x^4$, and the scheme is indeed fourth-order accurate, i.e., the truncation error is $\\mathcal{O}(\\Delta x^4)$.\n\nThe final ordered triple $(\\alpha, a, b)$ is $(\\frac{1}{10}, \\frac{6}{5}, 0)$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{1}{10} & \\frac{6}{5} & 0\n\\end{pmatrix}\n}\n$$", "id": "3302438"}, {"introduction": "While local accuracy is essential, the ability of a numerical scheme to preserve global conservation laws is paramount for the physical realism of a simulation. This problem delves into the conditions that ensure a compact finite difference operator is conservative when applied to a hyperbolic conservation law like $u_t + \\partial_x f(u) = 0$. You will analyze concepts like the Summation-By-Parts (SBP) property and flux-difference forms to identify the structural requirements that guarantee the discrete scheme respects the underlying conservation principle.", "problem": "Consider the scalar hyperbolic conservation law $u_{t} + \\partial_{x} f(u) = 0$ on a one-dimensional domain $[0,L]$. Let $\\{x_{i}\\}_{i=1}^{N}$ be a uniform grid with spacing $\\Delta x = L/N$, and let $u_{i}(t) \\approx u(x_{i},t)$. A compact finite difference approximation to the spatial derivative of the flux in flux form is constructed as follows: introduce a banded, invertible matrix $A \\in \\mathbb{R}^{N \\times N}$ and a banded matrix $B \\in \\mathbb{R}^{N \\times N}$, and define the semi-discrete scheme by\n$$\n\\frac{d\\mathbf{u}}{dt} + \\mathbf{g} = 0,\n$$\nwhere $\\mathbf{u}$ is the vector of nodal values $u_i$, and $\\mathbf{g}$ is obtained by solving the implicit linear system\n$$\nA \\mathbf{g} = \\frac{1}{\\Delta x} B \\mathbf{f}, \\quad \\text{with} \\quad f_{i} = f(u_{i}).\n$$\nEquivalently, the discrete derivative operator is $D = A^{-1} \\frac{1}{\\Delta x} B$, so that $\\mathbf{g} = D \\mathbf{f}$. Assume either periodic boundary conditions on $[0,L]$ or general inflow-outflow boundary conditions, and that $f(\\cdot)$ is sufficiently smooth for the semi-discrete analysis.\n\nFrom first principles of conservation, the exact integral balance over a subdomain $[x_{a},x_{b}] \\subseteq [0,L]$ is\n$$\n\\frac{d}{dt} \\int_{x_{a}}^{x_{b}} u(x,t) \\, dx = - \\big( f(u(x_{b},t)) - f(u(x_{a},t)) \\big).\n$$\nA discrete scheme is called conservative if there exists a positive definite diagonal quadrature matrix $H = \\mathrm{diag}(h_{1},\\dots,h_{N})$ such that the discrete balance reproduces the telescoping of interface fluxes so that, for periodic boundaries, the total discrete mass $\\sum_{i=1}^{N} h_{i} u_{i}$ is invariant, and for non-periodic boundaries, the rate of change of $\\sum_{i=1}^{N} h_{i} u_{i}$ equals the net boundary flux.\n\nWhich of the following conditions on the compact derivative operator and the flux discretization are sufficient for the above conservative property to hold when the operator is applied in flux form $\\mathbf{g} = D \\mathbf{f}$? Select all that apply and justify your choice based on derivations from the integral form of the conservation law.\n\nA. There exists a symmetric positive definite diagonal matrix $H$ and a matrix $Q$ such that $D = H^{-1} Q$ and the Summation By Parts (SBP) property holds, namely $Q + Q^{T} = B_{H}$, where $B_{H}$ is a boundary operator that extracts fluxes at the boundary in the $H$-weighted inner product. The nodal flux approximation is consistent in the sense that if $u_{i} \\equiv c$, then $f_{i} \\equiv f(c)$.\n\nB. The column sums of $D$ vanish, i.e., $D^{T} \\mathbf{1} = \\mathbf{0}$, where $\\mathbf{1} \\in \\mathbb{R}^{N}$ is the vector of ones, together with the consistency condition that if $u_{i} \\equiv c$ then $f_{i} \\equiv f(c)$.\n\nC. On a periodic grid with $H = \\Delta x \\, I$, the column sums of $D$ vanish, i.e., $\\mathbf{1}^{T} D = \\mathbf{0}^{T}$, together with the consistency condition that if $u_{i} \\equiv c$ then $f_{i} \\equiv f(c)$.\n\nD. The derivative matrix $D$ is symmetric, $D = D^{T}$, and it exactly differentiates constants, $D \\mathbf{1} = \\mathbf{0}$.\n\nE. The derivative matrix $D$ is exact for polynomials up to degree $p$ for some $p \\ge 1$ on a uniform grid (polynomial exactness), regardless of boundary treatment.\n\nF. There exist matrices $C \\in \\mathbb{R}^{N \\times (N+1)}$ and $R \\in \\mathbb{R}^{(N+1) \\times N}$ such that $H D = C R$, where $C$ is the signed incidence (difference) operator mapping interface fluxes $\\{\\widehat{f}_{i+\\frac{1}{2}}\\}_{i=0}^{N}$ to cell balances via $(C \\widehat{f})_{i} = \\widehat{f}_{i+\\frac{1}{2}} - \\widehat{f}_{i-\\frac{1}{2}}$, and $R$ maps nodal fluxes to interface fluxes with a partition-of-unity property ensuring consistency, together with a consistent two-point numerical flux $\\widehat{f}(u_{i},u_{i+1})$ used in $R f$. For periodic boundaries, $C$ is circulant so that $\\mathbf{1}^{T} C = \\mathbf{0}^{T}$.\n\nProvide your choice(s).", "solution": "The fundamental principle of discrete conservation, as stated, concerns the time evolution of the total discrete mass, $M(t) = \\sum_{i=1}^{N} h_{i} u_{i}(t)$. Using vector notation, where $\\mathbf{1}$ is the column vector of all ones, the mass is $M(t) = \\mathbf{1}^{T} H \\mathbf{u}(t)$.\n\nThe rate of change of the total discrete mass is given by:\n$$\n\\frac{dM}{dt} = \\frac{d}{dt} (\\mathbf{1}^{T} H \\mathbf{u}) = \\mathbf{1}^{T} H \\frac{d\\mathbf{u}}{dt}\n$$\nSubstituting the semi-discrete scheme, $\\frac{d\\mathbf{u}}{dt} = -D\\mathbf{f}$:\n$$\n\\frac{dM}{dt} = - \\mathbf{1}^{T} H D \\mathbf{f}\n$$\nFor a scheme to be conservative:\n1.  For periodic boundaries, we must have $\\frac{dM}{dt} = 0$.\n2.  For non-periodic boundaries, $-\\mathbf{1}^{T} H D \\mathbf{f}$ must represent the net flux at the boundaries of the domain, i.e., $f_{in} - f_{out}$.\n\nWe will now evaluate each option against this requirement.\n\n**A. There exists a symmetric positive definite diagonal matrix $H$ and a matrix $Q$ such that $D = H^{-1} Q$ and the Summation By Parts (SBP) property holds, namely $Q + Q^{T} = B_{H}$, where $B_{H}$ is a boundary operator that extracts fluxes at the boundary in the $H$-weighted inner product. The nodal flux approximation is consistent in the sense that if $u_{i} \\equiv c$, then $f_{i} \\equiv f(c)$.**\n\nThis option posits that the operator $D$ is an SBP operator. Let's substitute $D = H^{-1}Q$ into our conservation equation:\n$$\n\\frac{dM}{dt} = - \\mathbf{1}^{T} H (H^{-1} Q) \\mathbf{f} = - \\mathbf{1}^{T} Q \\mathbf{f}\n$$\nThe SBP property provides a discrete analogue of integration by parts. For any vectors $\\mathbf{v}, \\mathbf{w}$, we have $\\mathbf{v}^{T}Q\\mathbf{w} + \\mathbf{w}^{T}Q\\mathbf{v} = \\mathbf{v}^{T}(Q+Q^{T})\\mathbf{w} = \\mathbf{v}^{T}B_{H}\\mathbf{w}$. Let us set $\\mathbf{v} = \\mathbf{1}$ and $\\mathbf{w} = \\mathbf{f}$:\n$$\n\\mathbf{1}^{T} Q \\mathbf{f} + \\mathbf{f}^{T} Q \\mathbf{1} = \\mathbf{1}^{T} B_{H} \\mathbf{f}\n$$\nA consistent derivative operator must annihilate constants, i.e., $D\\mathbf{1} = \\mathbf{0}$. This implies $H^{-1}Q\\mathbf{1} = \\mathbf{0}$, and since $H$ is invertible, $Q\\mathbf{1} = \\mathbf{0}$. Substituting this into the SBP identity gives:\n$$\n\\mathbf{1}^{T} Q \\mathbf{f} + \\mathbf{f}^{T} (\\mathbf{0}) = \\mathbf{1}^{T} B_{H} \\mathbf{f} \\implies \\mathbf{1}^{T} Q \\mathbf{f} = \\mathbf{1}^{T} B_{H} \\mathbf{f}\n$$\nThus, the rate of change of mass becomes:\n$$\n\\frac{dM}{dt} = - \\mathbf{1}^{T} B_{H} \\mathbf{f}\n$$\nThis result shows that the rate of change of the total discrete mass is equal to the negative of the boundary fluxes, as extracted by the boundary operator $B_{H}$. In the case of periodic boundary conditions, SBP operators are constructed such that they are skew-symmetric, i.e., $Q+Q^{T}=0$, which means $B_{H}=0$. In this case, $\\frac{dM}{dt}=0$, satisfying the invariance requirement. Therefore, the SBP property is a sufficient condition for the scheme to be conservative in the general sense defined.\n\n**Verdict: Correct**\n\n**B. The column sums of $D$ vanish, i.e., $D^{T} \\mathbf{1} = \\mathbf{0}$, where $\\mathbf{1} \\in \\mathbb{R}^{N}$ is the vector of ones, together with the consistency condition that if $u_{i} \\equiv c$ then $f_{i} \\equiv f(c)$.**\n\nThere is a terminological inconsistency in this option. \"Row sums of D vanish\" corresponds to the condition $D\\mathbf{1}=\\mathbf{0}$. The provided equation, $D^{T}\\mathbf{1}=\\mathbf{0}$, which is equivalent to $\\mathbf{1}^T D = \\mathbf{0}^T$, means that the column sums of $D$ vanish. Assuming the equation is what is intended, let's analyze the condition $\\mathbf{1}^{T} D = \\mathbf{0}^{T}$.\nThe rate of change of mass is $\\frac{dM}{dt} = - \\mathbf{1}^{T} H D \\mathbf{f}$. If we assume a uniform quadrature, $H = h I$ for some scalar $h>0$, then:\n$$\n\\frac{dM}{dt} = - h \\, \\mathbf{1}^{T} D \\mathbf{f}\n$$\nUsing the condition $\\mathbf{1}^{T} D = \\mathbf{0}^{T}$, we get:\n$$\n\\frac{dM}{dt} = - h \\, (\\mathbf{0}^{T} \\mathbf{f}) = 0\n$$\nThis implies that the total mass is conserved for *any* flux vector $\\mathbf{f}$ and any boundary conditions. This correctly represents conservation for a periodic domain. However, for a non-periodic domain, conservation requires the rate of change to equal the net boundary flux, which is generally non-zero. This condition forces the rate of change to be zero always, failing to capture the boundary effects. Therefore, this condition is not sufficient for the general definition of conservation provided.\n\n**Verdict: Incorrect**\n\n**C. On a periodic grid with $H = \\Delta x \\, I$, the column sums of $D$ vanish, i.e., $\\mathbf{1}^{T} D = \\mathbf{0}^{T}$, together with the consistency condition that if $u_{i} \\equiv c$ then $f_{i} \\equiv f(c)$.**\n\nThis option restricts the context to a periodic grid and a specific quadrature matrix, $H = \\Delta x I$. For a periodic grid, the conservation property requires that the total discrete mass $M = \\sum_{i=1}^{N} \\Delta x \\, u_i$ is invariant, i.e., $\\frac{dM}{dt} = 0$.\nLet's evaluate the rate of mass change under the given conditions:\n$$\n\\frac{dM}{dt} = - \\mathbf{1}^{T} H D \\mathbf{f} = - \\mathbf{1}^{T} (\\Delta x I) D \\mathbf{f} = - \\Delta x (\\mathbf{1}^{T} D) \\mathbf{f}\n$$\nGiven the condition that the column sums of $D$ vanish, $\\mathbf{1}^{T} D = \\mathbf{0}^{T}$, the expression becomes:\n$$\n\\frac{dM}{dt} = - \\Delta x (\\mathbf{0}^{T}) \\mathbf{f} = 0\n$$\nThis precisely matches the requirement for conservation on a periodic domain. Since the option explicitly states the conditions under which it applies (periodic grid), and the conclusion holds under these conditions, it is a valid sufficient condition for that case.\n\n**Verdict: Correct**\n\n**D. The derivative matrix $D$ is symmetric, $D = D^{T}$, and it exactly differentiates constants, $D \\mathbf{1} = \\mathbf{0}$.**\n\nThe condition $D\\mathbf{1}=\\mathbf{0}$ means the operator is consistent for constant functions. This implies $(D\\mathbf{1})^{T} = \\mathbf{1}^{T}D^{T} = \\mathbf{0}^{T}$. Since we are also given that $D=D^{T}$, this leads to $\\mathbf{1}^{T}D = \\mathbf{0}^{T}$. As analyzed in option B, this condition ensures $\\frac{dM}{dt}=0$ (for $H=hI$), which is not generally correct for non-periodic boundaries. More fundamentally, a first-derivative operator on a grid is typically modeled by a skew-symmetric-like matrix (e.g., for periodic boundary conditions, $D = -D^T$). A symmetric matrix is characteristic of a second-derivative operator. A non-zero first-derivative operator cannot be both symmetric and skew-symmetric. This condition is physically and numerically questionable for a first derivative approximation and, in any case, insufficient for the general non-periodic problem.\n\n**Verdict: Incorrect**\n\n**E. The derivative matrix $D$ is exact for polynomials up to degree $p$ for some $p \\ge 1$ on a uniform grid (polynomial exactness), regardless of boundary treatment.**\n\nThis condition relates to the order of accuracy of the numerical scheme. Conservation is a structural property of the discretization, not a direct consequence of its order of accuracy. A scheme can be of high order but non-conservative if it is not formulated in a \"flux form\" that guarantees a telescoping sum upon summation over the grid. For example, discretizing the non-conservative form $u_t + f'(u) u_x = 0$ can lead to a high-order accurate method that does not conserve mass. Conversely, a first-order upwind scheme is conservative. Therefore, polynomial exactness (accuracy) is neither necessary nor sufficient for conservation.\n\n**Verdict: Incorrect**\n\n**F. There exist matrices $C \\in \\mathbb{R}^{N \\times (N+1)}$ and $R \\in \\mathbb{R}^{(N+1) \\times N}$ such that $H D = C R$, where $C$ is the signed incidence (difference) operator mapping interface fluxes $\\{\\widehat{f}_{i+\\frac{1}{2}}\\}_{i=0}^{N}$ to cell balances via $(C \\widehat{f})_{i} = \\widehat{f}_{i+\\frac{1}{2}} - \\widehat{f}_{i-\\frac{1}{2}}$, and $R$ maps nodal fluxes to interface fluxes... For periodic boundaries, $C$ is circulant so that $\\mathbf{1}^{T} C = \\mathbf{0}^{T}$.**\n\nThis option describes the structure of a finite volume or flux-difference scheme. The scheme $\\frac{d\\mathbf{u}}{dt} + D\\mathbf{f} = 0$ is multiplied by $H$ to get $H \\frac{d\\mathbf{u}}{dt} + HD\\mathbf{f} = 0$. With the decomposition $HD=CR$, this becomes $H \\frac{d\\mathbf{u}}{dt} + CR\\mathbf{f} = 0$. Let $\\widehat{\\mathbf{f}} = R\\mathbf{f}$ be the vector of numerical fluxes at the cell interfaces. Then for each node $i$, the scheme is $h_i \\frac{du_i}{dt} + (CR\\mathbf{f})_i = 0$, which from the definition of $C$ is:\n$$\nh_i \\frac{du_i}{dt} + (\\widehat{f}_{i+\\frac{1}{2}} - \\widehat{f}_{i-\\frac{1}{2}}) = 0\n$$\nThis is the archetypal conservative form. Summing over all nodes $i=1, \\dots, N$ gives the total rate of mass change:\n$$\n\\frac{dM}{dt} = \\sum_{i=1}^N h_i \\frac{du_i}{dt} = - \\sum_{i=1}^N (\\widehat{f}_{i+\\frac{1}{2}} - \\widehat{f}_{i-\\frac{1}{2}})\n$$\nThis sum is a telescoping series:\n$$\n\\sum_{i=1}^N (\\widehat{f}_{i+\\frac{1}{2}} - \\widehat{f}_{i-\\frac{1}{2}}) = (\\widehat{f}_{3/2} - \\widehat{f}_{1/2}) + (\\widehat{f}_{5/2} - \\widehat{f}_{3/2}) + \\dots + (\\widehat{f}_{N+\\frac{1}{2}} - \\widehat{f}_{N-\\frac{1}{2}}) = \\widehat{f}_{N+\\frac{1}{2}} - \\widehat{f}_{1/2}\n$$\nSo, $\\frac{dM}{dt} = -(\\widehat{f}_{N+\\frac{1}{2}} - \\widehat{f}_{1/2}) = \\widehat{f}_{1/2} - \\widehat{f}_{N+\\frac{1}{2}}$. This is precisely the net flux into the domain. For the periodic case, the condition $\\mathbf{1}^T C = \\mathbf{0}^T$ is given. The rate of change is $\\frac{dM}{dt} = -\\mathbf{1}^T H D \\mathbf{f} = -\\mathbf{1}^T C R \\mathbf{f} = -(\\mathbf{1}^T C) R \\mathbf{f} = 0$. This condition ensures conservation in both non-periodic and periodic settings.\n\n**Verdict: Correct**", "answer": "$$\\boxed{ACF}$$", "id": "3302494"}, {"introduction": "A successful CFD simulation requires a stable coupling between spatial and temporal discretization schemes. This practical exercise guides you through a von Neumann stability analysis for a system combining a high-order compact spatial derivative with the widely used fourth-order Runge–Kutta (RK4) method for time integration [@problem_id:3302440]. By calculating the scheme's modified wavenumber and using the stability region of the time integrator, you will determine the maximum allowable Courant–Friedrichs–Lewy (CFL) number, $\\nu$, a fundamental task in setting up stable and efficient time-marching simulations.", "problem": "Consider the one-dimensional linear advection equation $u_t + a u_x = 0$ on a uniform periodic grid with spacing $\\Delta x$ and $N$ points, where $a$ is a constant advection speed. The semi-discrete spatial derivative $u_x$ is approximated by a sixth-order tridiagonal compact finite difference (Padé) formulation. Define the Courant–Friedrichs–Lewy (CFL) number as $\\nu = a \\Delta t / \\Delta x$, where $\\Delta t$ is the time step, and the time integration uses the classical Runge–Kutta fourth-order method (RK4). Use von Neumann analysis to estimate the maximum stable CFL number $\\nu_{\\max}$ such that the fully discrete scheme remains linearly stable for all resolvable Fourier modes on the grid.\n\nStart from the linear advection equation and, for the compact scheme, assume the following implicit relation for the first derivative on a periodic grid:\n$$\n\\alpha f'_{j-1} + f'_j + \\alpha f'_{j+1} = \\frac{c_1}{2 \\Delta x}\\left(f_{j+1}-f_{j-1}\\right) + \\frac{c_2}{4 \\Delta x}\\left(f_{j+2}-f_{j-2}\\right),\n$$\nwith coefficients $\\alpha = 1/3$, $c_1 = 14/9$, and $c_2 = 1/9$. Under a Fourier mode ansatz $f_j = \\exp(i j \\theta)$, where $\\theta \\in [0,\\pi]$ is the discrete angular wavenumber in radians, the compact scheme implies a modified wavenumber $\\kappa(\\theta)$ defined by\n$$\n\\kappa(\\theta) = \\frac{c_1 \\sin(\\theta) + \\frac{c_2}{2} \\sin(2\\theta)}{1 + 2 \\alpha \\cos(\\theta)}.\n$$\nThe semi-discrete operator for the linear advection equation has eigenvalues $\\lambda(\\theta) = -i a \\kappa(\\theta)/\\Delta x$. The classical Runge–Kutta fourth-order method has the stability function\n$$\nR(z) = 1 + z + \\frac{z^2}{2} + \\frac{z^3}{6} + \\frac{z^4}{24}.\n$$\nFor a given Fourier mode with $\\theta$, stability requires $| R(\\lambda(\\theta) \\Delta t) | \\le 1$. Therefore the largest stable CFL number is the maximum $\\nu$ such that $| R(-i \\nu \\kappa(\\theta)) | \\le 1$ for all resolvable wavenumbers $\\theta$ on the grid.\n\nYour task is to implement a program that:\n- Computes $s_{\\max} = \\sup\\left\\{ s \\ge 0 \\; \\middle| \\; \\lvert R(i s) \\rvert \\le 1 \\right\\}$ numerically for the RK4 stability function restricted to the imaginary axis.\n- For each specified grid size $N$, computes the set of resolvable discrete wavenumbers $\\theta_m = 2\\pi m/N$ for integers $m \\in \\{1,2,\\dots,\\lfloor N/2 \\rfloor\\}$ in radians, and then evaluates $\\kappa(\\theta_m)$ using the formula above.\n- Determines $\\kappa_{\\max}(N) = \\max_{m} \\lvert \\kappa(\\theta_m) \\rvert$.\n- Returns $\\nu_{\\max}(N) = s_{\\max} / \\kappa_{\\max}(N)$.\n\nDesign your algorithm from the base principles described and do not use any pre-tabulated stability bounds. You must express all angles in radians.\n\nTest suite:\n- Case $1$: $N = 8$.\n- Case $2$: $N = 16$.\n- Case $3$: $N = 64$.\n- Case $4$: $N = 512$.\n\nFor each case, produce the float value of $\\nu_{\\max}(N)$ rounded to ten decimal places.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of the test suite cases. For example, the output should be of the form $[\\text{result}_1,\\text{result}_2,\\text{result}_3,\\text{result}_4]$, where each $\\text{result}_k$ is a float rounded to ten decimal places.", "solution": "The problem requires the determination of the maximum stable Courant–Friedrichs–Lewy (CFL) number, denoted $\\nu_{\\max}$, for a fully discrete numerical scheme applied to the one-dimensional linear advection equation, $u_t + a u_x = 0$. The scheme combines a sixth-order compact finite difference method for spatial discretization and the classical fourth-order Runge-Kutta (RK4) method for time integration. The analysis will be performed using the von Neumann stability method.\n\nThe process involves three main steps:\n1.  Determining the stability region of the RK4 method on the imaginary axis.\n2.  Analyzing the spectral properties of the spatial discretization operator, specifically its modified wavenumber.\n3.  Combining these results to find the stability limit for the fully discrete scheme as a function of the grid size $N$.\n\nFirst, we analyze the temporal integration scheme. The stability of an explicit time-stepping method applied to the semi-discretized equation $\\frac{d\\hat{u}}{dt} = \\lambda \\hat{u}$ is governed by the stability function $R(z)$, where $z = \\lambda \\Delta t$. For the scheme to be stable, the amplification factor $G = R(z)$ must satisfy $|G| \\le 1$.\n\nThe spatial discretization using the specified sixth-order compact scheme on a periodic grid leads to a semi-discrete Fourier-space representation $\\frac{d\\hat{u}(\\theta)}{dt} = -i \\frac{a}{\\Delta x} \\kappa(\\theta) \\hat{u}(\\theta)$, where $\\hat{u}(\\theta)$ is the Fourier coefficient of the solution at wavenumber $\\theta$. Thus, the eigenvalues of the semi-discrete operator are purely imaginary: $\\lambda(\\theta) = -i \\frac{a \\kappa(\\theta)}{\\Delta x}$. The modified wavenumber $\\kappa(\\theta)$ is a real-valued function for real $\\theta$, given by:\n$$\n\\kappa(\\theta) = \\frac{c_1 \\sin(\\theta) + \\frac{c_2}{2} \\sin(2\\theta)}{1 + 2 \\alpha \\cos(\\theta)}\n$$\nwith the provided coefficients $\\alpha = 1/3$, $c_1 = 14/9$, and $c_2 = 1/9$.\n\nThe argument to the stability function is $z = \\lambda(\\theta) \\Delta t = -i \\frac{a \\kappa(\\theta)}{\\Delta x} \\Delta t$. Defining the CFL number as $\\nu = \\frac{a \\Delta t}{\\Delta x}$, this becomes $z = -i \\nu \\kappa(\\theta)$. The stability condition for each Fourier mode is $|R(-i \\nu \\kappa(\\theta))| \\le 1$.\n\nThe stability function for the RK4 method is given as:\n$$\nR(z) = 1 + z + \\frac{z^2}{2!} + \\frac{z^3}{3!} + \\frac{z^4}{4!}\n$$\nWe need to find the stability limit for purely imaginary arguments, $z = is$, where $s$ is a real number. Due to the property $R(\\bar{z}) = \\overline{R(z)}$ for a polynomial with real coefficients, $|R(-is)| = |R(is)|$, so we can analyze for $s \\ge 0$ without loss of generality.\nSubstituting $z=is$ into $R(z)$:\n$$\nR(is) = 1 + (is) + \\frac{(is)^2}{2} + \\frac{(is)^3}{6} + \\frac{(is)^4}{24} = 1 + is - \\frac{s^2}{2} - i\\frac{s^3}{6} + \\frac{s^4}{24}\n$$\nGrouping real and imaginary parts:\n$$\nR(is) = \\left(1 - \\frac{s^2}{2} + \\frac{s^4}{24}\\right) + i\\left(s - \\frac{s^3}{6}\\right)\n$$\nThe stability condition is $|R(is)|^2 \\le 1$:\n$$\n|R(is)|^2 = \\left(1 - \\frac{s^2}{2} + \\frac{s^4}{24}\\right)^2 + \\left(s - \\frac{s^3}{6}\\right)^2 \\le 1\n$$\nExpanding the terms:\n$$\n|R(is)|^2 = \\left(1 - s^2 + \\frac{s^4}{3} - \\frac{s^6}{24} + \\frac{s^8}{576}\\right) + \\left(s^2 - \\frac{s^4}{3} + \\frac{s^6}{36}\\right)\n$$\n$$\n|R(is)|^2 = 1 + \\left(-\\frac{1}{24} + \\frac{1}{36}\\right)s^6 + \\frac{s^8}{576} = 1 - \\frac{s^6}{72} + \\frac{s^8}{576}\n$$\nThe stability inequality becomes:\n$$\n1 - \\frac{s^6}{72} + \\frac{s^8}{576} \\le 1 \\implies \\frac{s^8}{576} - \\frac{s^6}{72} \\le 0\n$$\nFor $s > 0$, we can divide by $s^6$:\n$$\n\\frac{s^2}{576} - \\frac{1}{72} \\le 0 \\implies s^2 \\le \\frac{576}{72} = 8\n$$\nThis gives $s \\le \\sqrt{8} = 2\\sqrt{2}$. The supremum of $s \\ge 0$ for which the RK4 scheme is stable on the imaginary axis is therefore $s_{\\max} = 2\\sqrt{2}$.\n\nThe argument to the stability function is $z = -i\\nu\\kappa(\\theta)$. Its magnitude is $|z| = |\\nu\\kappa(\\theta)|$. For stability, this magnitude must be less than or equal to $s_{\\max}$ for all active Fourier modes on the grid.\n$$\n|\\nu \\kappa(\\theta_m)| \\le s_{\\max} \\quad \\text{for all } m\n$$\nwhere $\\theta_m = \\frac{2\\pi m}{N}$ for $m \\in \\{1, 2, \\dots, \\lfloor N/2 \\rfloor\\}$.\nSince $\\nu$ is a positive constant, this condition is equivalent to:\n$$\n\\nu \\cdot |\\kappa(\\theta_m)| \\le s_{\\max} \\implies \\nu \\le \\frac{s_{\\max}}{|\\kappa(\\theta_m)|}\n$$\nTo ensure stability for all modes simultaneously, $\\nu$ must be less than or equal to the minimum of these upper bounds over all $m$. This is determined by the mode that maximizes $|\\kappa(\\theta_m)|$:\n$$\n\\nu_{\\max}(N) = \\frac{s_{\\max}}{\\max_{m} |\\kappa(\\theta_m)|} = \\frac{s_{\\max}}{\\kappa_{\\max}(N)}\n$$\nwhere $\\kappa_{\\max}(N) = \\max_{m \\in \\{1, \\dots, \\lfloor N/2 \\rfloor\\}} |\\kappa(\\theta_m)|$.\n\nThe algorithm to solve the problem is as follows:\n1.  Calculate the RK4 imaginary stability boundary, $s_{\\max} = 2\\sqrt{2}$.\n2.  Define the function for the modified wavenumber $\\kappa(\\theta)$ using the given coefficients $\\alpha$, $c_1$, and $c_2$.\n3.  For each grid size $N$ provided in the test suite:\n    a. Generate the discrete set of wavenumbers $\\theta_m = \\frac{2\\pi m}{N}$ for $m$ from $1$ to $\\lfloor N/2 \\rfloor$.\n    b. Evaluate $\\kappa(\\theta_m)$ for all these wavenumbers.\n    c. Find the maximum absolute value in this set, $\\kappa_{\\max}(N)$.\n    d. Compute the maximum stable CFL number $\\nu_{\\max}(N) = \\frac{s_{\\max}}{\\kappa_{\\max}(N)}$.\n    e. Round the result to ten decimal places.\n4.  Collect the results and format them as a comma-separated list.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the maximum stable CFL number for a sixth-order compact finite\n    difference scheme with RK4 time integration for the 1D linear advection\n    equation on various grid sizes.\n    \"\"\"\n    \n    # Define the test cases for grid size N\n    test_cases = [8, 16, 64, 512]\n    \n    # Coefficients for the sixth-order compact finite difference scheme\n    alpha = 1.0 / 3.0\n    c1 = 14.0 / 9.0\n    c2 = 1.0 / 9.0\n    \n    # Maximum extent of the stability region of RK4 on the imaginary axis\n    s_max = 2.0 * np.sqrt(2.0)\n    \n    def kappa(theta):\n        \"\"\"\n        Calculates the modified wavenumber for the compact scheme.\n        \n        Args:\n            theta: The discrete angular wavenumber in radians.\n        \n        Returns:\n            The modified wavenumber.\n        \"\"\"\n        numerator = c1 * np.sin(theta) + (c2 / 2.0) * np.sin(2.0 * theta)\n        denominator = 1.0 + 2.0 * alpha * np.cos(theta)\n        return numerator / denominator\n\n    results = []\n    for N in test_cases:\n        # Generate the discrete wavenumbers theta_m for m = 1, 2, ..., floor(N/2)\n        # m must be integers, so we use arange.\n        m_values = np.arange(1, np.floor(N / 2) + 1)\n        theta_values = 2.0 * np.pi * m_values / N\n        \n        # Calculate the modified wavenumbers for all theta values\n        kappa_values = kappa(theta_values)\n        \n        # Find the maximum absolute modified wavenumber\n        kappa_max_N = np.max(np.abs(kappa_values))\n        \n        # Calculate the maximum stable CFL number\n        nu_max_N = s_max / kappa_max_N\n        \n        # Round the result to 10 decimal places and append\n        results.append(nu_max_N)\n        \n    # Format the results for output as specified: \"[res1,res2,res3,res4]\"\n    # using an f-string to handle rounding to 10 decimal places correctly.\n    formatted_results = [f\"{r:.10f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n\n```", "id": "3302440"}]}