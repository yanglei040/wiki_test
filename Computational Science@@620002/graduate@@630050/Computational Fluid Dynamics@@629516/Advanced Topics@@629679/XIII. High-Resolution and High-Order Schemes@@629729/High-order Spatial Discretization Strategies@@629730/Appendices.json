{"hands_on_practices": [{"introduction": "High-order accuracy in the Finite Volume Method (FVM) hinges on moving beyond simple constant states within each cell. This practice guides you through the foundational process of polynomial reconstruction, a technique where we use data from neighboring cells to build a more detailed, accurate representation of the solution within a target cell. By deriving a third-order accurate reconstruction from first principles, you will gain a core competency required for developing advanced schemes capable of capturing complex flow features with high fidelity [@problem_id:3328997].", "problem": "Consider a smooth scalar conserved quantity $u(x)$ governed by a one-dimensional conservation law and discretized with the Finite Volume Method (FVM). Let the computational domain be partitioned into a uniform grid with spacing $\\Delta x$, cell centers $x_i$, and interfaces $x_{i\\pm \\frac{1}{2}} = x_i \\pm \\frac{\\Delta x}{2}$. The cell average in cell $i$ is defined by $\\bar{u}_i = \\frac{1}{\\Delta x} \\int_{x_{i-\\frac{1}{2}}}^{x_{i+\\frac{1}{2}}} u(x) \\, dx$. Assume $u(x)$ is sufficiently smooth that a polynomial reconstruction is appropriate, and ignore any nonlinear limiting.\n\nYour task is to derive a third-order accurate spatial reconstruction for a target cell $i$ by fitting a polynomial of degree $2$, denoted $p_i(x)$, of the form $p_i(x) = a_i + b_i (x - x_i) + c_i (x - x_i)^2$, such that the cell averages of $p_i(x)$ over the three cells $i-1$, $i$, and $i+1$ match the given values $\\bar{u}_{i-1}$, $\\bar{u}_i$, and $\\bar{u}_{i+1}$. Starting from the cell-average definition and fundamental integral identities, derive expressions for the coefficients $a_i$, $b_i$, and $c_i$ in terms of $\\bar{u}_{i-1}$, $\\bar{u}_i$, $\\bar{u}_{i+1}$, and $\\Delta x$, and then compute the left and right interface values $p_i^{-} = p_i(x_{i-\\frac{1}{2}})$ and $p_i^{+} = p_i(x_{i+\\frac{1}{2}})$.\n\nExpress your final answer for the pair $\\left(p_i^{-},\\, p_i^{+}\\right)$ as closed-form algebraic expressions in terms of $\\bar{u}_{i-1}$, $\\bar{u}_i$, $\\bar{u}_{i+1}$, and $\\Delta x$. No rounding is required.", "solution": "The problem is valid. It is a standard, well-posed problem in the field of numerical methods for conservation laws, specifically concerning high-order spatial reconstruction for the Finite Volume Method (FVM).\n\nLet the quadratic reconstruction polynomial for cell $i$ be given by\n$$p_i(x) = a_i + b_i (x - x_i) + c_i (x - x_i)^2$$\nwhere $x_i$ is the center of cell $i$. The coefficients $a_i$, $b_i$, and $c_i$ are determined by enforcing that the cell average of $p_i(x)$ over cells $i-1$, $i$, and $i+1$ matches the known cell averages $\\bar{u}_{i-1}$, $\\bar{u}_i$, and $\\bar{u}_{i+1}$, respectively. This leads to a system of three equations.\n\nThe cell average of $p_i(x)$ over a generic cell $j$ with a uniform grid spacing $\\Delta x$ is\n$$ \\frac{1}{\\Delta x} \\int_{x_j - \\frac{\\Delta x}{2}}^{x_j + \\frac{\\Delta x}{2}} p_i(x) \\, dx = \\bar{u}_j $$\nTo simplify the integration, we introduce a local, non-dimensional coordinate $\\xi = \\frac{x-x_i}{\\Delta x}$, so $x = x_i + \\xi \\Delta x$ and $dx = \\Delta x \\, d\\xi$. The polynomial becomes\n$$p_i(x(\\xi)) = a_i + b_i (\\Delta x \\xi) + c_i (\\Delta x \\xi)^2$$\nThe integration over cell $j$ is performed over the interval $\\xi \\in [\\frac{x_j-x_i}{\\Delta x} - \\frac{1}{2}, \\frac{x_j-x_i}{\\Delta x} + \\frac{1}{2}]$.\n\nWe now apply this to the three cells in the stencil: $j=i$, $j=i-1$, and $j=i+1$.\n\nFor cell $i$ ($j=i$):\nThe integration is over $x \\in [x_i - \\frac{\\Delta x}{2}, x_i + \\frac{\\Delta x}{2}]$, which corresponds to $\\xi \\in [-\\frac{1}{2}, \\frac{1}{2}]$.\n$$ \\bar{u}_i = \\frac{1}{\\Delta x} \\int_{x_i - \\frac{\\Delta x}{2}}^{x_i + \\frac{\\Delta x}{2}} p_i(x) \\, dx = \\int_{-\\frac{1}{2}}^{\\frac{1}{2}} \\left[ a_i + b_i \\Delta x \\xi + c_i (\\Delta x)^2 \\xi^2 \\right] d\\xi $$\n$$ \\bar{u}_i = \\left[ a_i \\xi + \\frac{1}{2} b_i \\Delta x \\xi^2 + \\frac{1}{3} c_i (\\Delta x)^2 \\xi^3 \\right]_{-\\frac{1}{2}}^{\\frac{1}{2}} $$\n$$ \\bar{u}_i = a_i(1) + \\frac{1}{2} b_i \\Delta x (0) + \\frac{1}{3} c_i (\\Delta x)^2 \\left( \\left(\\frac{1}{2}\\right)^3 - \\left(-\\frac{1}{2}\\right)^3 \\right) = a_i + \\frac{c_i (\\Delta x)^2}{12} \\quad (1)$$\n\nFor cell $i-1$ ($j=i-1$):\nThe integration is over $x \\in [x_{i-1} - \\frac{\\Delta x}{2}, x_{i-1} + \\frac{\\Delta x}{2}] = [x_i - \\frac{3\\Delta x}{2}, x_i - \\frac{\\Delta x}{2}]$, which corresponds to $\\xi \\in [-\\frac{3}{2}, -\\frac{1}{2}]$.\n$$ \\bar{u}_{i-1} = \\int_{-\\frac{3}{2}}^{-\\frac{1}{2}} \\left[ a_i + b_i \\Delta x \\xi + c_i (\\Delta x)^2 \\xi^2 \\right] d\\xi $$\n$$ \\bar{u}_{i-1} = \\left[ a_i \\xi + \\frac{1}{2} b_i \\Delta x \\xi^2 + \\frac{1}{3} c_i (\\Delta x)^2 \\xi^3 \\right]_{-\\frac{3}{2}}^{-\\frac{1}{2}} $$\n$$ \\bar{u}_{i-1} = a_i(1) + \\frac{1}{2} b_i \\Delta x \\left( \\left(-\\frac{1}{2}\\right)^2 - \\left(-\\frac{3}{2}\\right)^2 \\right) + \\frac{1}{3} c_i (\\Delta x)^2 \\left( \\left(-\\frac{1}{2}\\right)^3 - \\left(-\\frac{3}{2}\\right)^3 \\right) $$\n$$ \\bar{u}_{i-1} = a_i - b_i \\Delta x + \\frac{13}{12} c_i (\\Delta x)^2 \\quad (2)$$\n\nFor cell $i+1$ ($j=i+1$):\nThe integration is over $x \\in [x_{i+1} - \\frac{\\Delta x}{2}, x_{i+1} + \\frac{\\Delta x}{2}] = [x_i + \\frac{\\Delta x}{2}, x_i + \\frac{3\\Delta x}{2}]$, which corresponds to $\\xi \\in [\\frac{1}{2}, \\frac{3}{2}]$.\n$$ \\bar{u}_{i+1} = \\int_{\\frac{1}{2}}^{\\frac{3}{2}} \\left[ a_i + b_i \\Delta x \\xi + c_i (\\Delta x)^2 \\xi^2 \\right] d\\xi $$\n$$ \\bar{u}_{i+1} = a_i + b_i \\Delta x + \\frac{13}{12} c_i (\\Delta x)^2 \\quad (3)$$\n\nWe now have a system of three linear equations for $a_i, b_i, c_i$:\n(1) $a_i + \\frac{1}{12} c_i (\\Delta x)^2 = \\bar{u}_i$\n(2) $a_i - b_i \\Delta x + \\frac{13}{12} c_i (\\Delta x)^2 = \\bar{u}_{i-1}$\n(3) $a_i + b_i \\Delta x + \\frac{13}{12} c_i (\\Delta x)^2 = \\bar{u}_{i+1}$\n\nSubtracting equation (2) from (3):\n$$ (\\bar{u}_{i+1} - \\bar{u}_{i-1}) = 2 b_i \\Delta x $$\n$$ b_i = \\frac{\\bar{u}_{i+1} - \\bar{u}_{i-1}}{2 \\Delta x} $$\n\nAdding equations (2) and (3):\n$$ \\bar{u}_{i+1} + \\bar{u}_{i-1} = 2a_i + \\frac{13}{6} c_i (\\Delta x)^2 $$\nFrom equation (1), we have $a_i = \\bar{u}_i - \\frac{1}{12} c_i (\\Delta x)^2$. Substituting this into the summed equation:\n$$ \\bar{u}_{i+1} + \\bar{u}_{i-1} = 2\\left(\\bar{u}_i - \\frac{1}{12} c_i (\\Delta x)^2\\right) + \\frac{13}{6} c_i (\\Delta x)^2 $$\n$$ \\bar{u}_{i+1} + \\bar{u}_{i-1} = 2\\bar{u}_i - \\frac{1}{6} c_i (\\Delta x)^2 + \\frac{13}{6} c_i (\\Delta x)^2 $$\n$$ \\bar{u}_{i+1} + \\bar{u}_{i-1} = 2\\bar{u}_i + \\frac{12}{6} c_i (\\Delta x)^2 = 2\\bar{u}_i + 2 c_i (\\Delta x)^2 $$\nSolving for $c_i$:\n$$ 2 c_i (\\Delta x)^2 = \\bar{u}_{i+1} - 2\\bar{u}_i + \\bar{u}_{i-1} $$\n$$ c_i = \\frac{\\bar{u}_{i+1} - 2\\bar{u}_i + \\bar{u}_{i-1}}{2 (\\Delta x)^2} $$\n\nFinally, we find $a_i$ using equation (1) and the expression for $c_i$:\n$$ a_i = \\bar{u}_i - \\frac{1}{12} c_i (\\Delta x)^2 = \\bar{u}_i - \\frac{1}{12} \\left( \\frac{\\bar{u}_{i+1} - 2\\bar{u}_i + \\bar{u}_{i-1}}{2 (\\Delta x)^2} \\right) (\\Delta x)^2 $$\n$$ a_i = \\bar{u}_i - \\frac{\\bar{u}_{i+1} - 2\\bar{u}_i + \\bar{u}_{i-1}}{24} = \\frac{24\\bar{u}_i - \\bar{u}_{i+1} + 2\\bar{u}_i - \\bar{u}_{i-1}}{24} $$\n$$ a_i = \\frac{-\\bar{u}_{i-1} + 26\\bar{u}_i - \\bar{u}_{i+1}}{24} $$\n\nWith the coefficients determined, we can find the interface values.\nThe left interface value is $p_i^{-} = p_i(x_{i-\\frac{1}{2}})$. At $x = x_{i-\\frac{1}{2}} = x_i - \\frac{\\Delta x}{2}$:\n$$ p_i^{-} = a_i - b_i \\frac{\\Delta x}{2} + c_i \\left( \\frac{\\Delta x}{2} \\right)^2 = a_i - \\frac{b_i \\Delta x}{2} + \\frac{c_i (\\Delta x)^2}{4} $$\nThe right interface value is $p_i^{+} = p_i(x_{i+\\frac{1}{2}})$. At $x = x_{i+\\frac{1}{2}} = x_i + \\frac{\\Delta x}{2}$:\n$$ p_i^{+} = a_i + b_i \\frac{\\Delta x}{2} + c_i \\left( \\frac{\\Delta x}{2} \\right)^2 = a_i + \\frac{b_i \\Delta x}{2} + \\frac{c_i (\\Delta x)^2}{4} $$\n\nLet's compute the terms involving $b_i$ and $c_i$:\n$$ \\frac{b_i \\Delta x}{2} = \\frac{1}{2} \\left( \\frac{\\bar{u}_{i+1} - \\bar{u}_{i-1}}{2 \\Delta x} \\right) \\Delta x = \\frac{\\bar{u}_{i+1} - \\bar{u}_{i-1}}{4} $$\n$$ \\frac{c_i (\\Delta x)^2}{4} = \\frac{1}{4} \\left( \\frac{\\bar{u}_{i+1} - 2\\bar{u}_i + \\bar{u}_{i-1}}{2 (\\Delta x)^2} \\right) (\\Delta x)^2 = \\frac{\\bar{u}_{i+1} - 2\\bar{u}_i + \\bar{u}_{i-1}}{8} $$\n\nSubstitute these and $a_i$ into the expression for $p_i^{-}$:\n$$ p_i^{-} = \\frac{-\\bar{u}_{i-1} + 26\\bar{u}_i - \\bar{u}_{i+1}}{24} - \\frac{\\bar{u}_{i+1} - \\bar{u}_{i-1}}{4} + \\frac{\\bar{u}_{i+1} - 2\\bar{u}_i + \\bar{u}_{i-1}}{8} $$\nFinding a common denominator of $24$:\n$$ p_i^{-} = \\frac{1}{24} \\left[ (-\\bar{u}_{i-1} + 26\\bar{u}_i - \\bar{u}_{i+1}) - 6(\\bar{u}_{i+1} - \\bar{u}_{i-1}) + 3(\\bar{u}_{i+1} - 2\\bar{u}_i + \\bar{u}_{i-1}) \\right] $$\n$$ p_i^{-} = \\frac{1}{24} \\left[ (-1+6+3)\\bar{u}_{i-1} + (26-6)\\bar{u}_i + (-1-6+3)\\bar{u}_{i+1} \\right] $$\n$$ p_i^{-} = \\frac{1}{24} \\left[ 8\\bar{u}_{i-1} + 20\\bar{u}_i - 4\\bar{u}_{i+1} \\right] = \\frac{2\\bar{u}_{i-1} + 5\\bar{u}_i - \\bar{u}_{i+1}}{6} $$\n\nSimilarly for $p_i^{+}$:\n$$ p_i^{+} = \\frac{-\\bar{u}_{i-1} + 26\\bar{u}_i - \\bar{u}_{i+1}}{24} + \\frac{\\bar{u}_{i+1} - \\bar{u}_{i-1}}{4} + \\frac{\\bar{u}_{i+1} - 2\\bar{u}_i + \\bar{u}_{i-1}}{8} $$\n$$ p_i^{+} = \\frac{1}{24} \\left[ (-\\bar{u}_{i-1} + 26\\bar{u}_i - \\bar{u}_{i+1}) + 6(\\bar{u}_{i+1} - \\bar{u}_{i-1}) + 3(\\bar{u}_{i+1} - 2\\bar{u}_i + \\bar{u}_{i-1}) \\right] $$\n$$ p_i^{+} = \\frac{1}{24} \\left[ (-1-6+3)\\bar{u}_{i-1} + (26-6)\\bar{u}_i + (-1+6+3)\\bar{u}_{i+1} \\right] $$\n$$ p_i^{+} = \\frac{1}{24} \\left[ -4\\bar{u}_{i-1} + 20\\bar{u}_i + 8\\bar{u}_{i+1} \\right] = \\frac{-\\bar{u}_{i-1} + 5\\bar{u}_i + 2\\bar{u}_{i+1}}{6} $$\nThe final expressions for the left and right interface values of the reconstruction are:\n$$ p_i^{-} = \\frac{1}{6}(2\\bar{u}_{i-1} + 5\\bar{u}_i - \\bar{u}_{i+1}) $$\n$$ p_i^{+} = \\frac{1}{6}(-\\bar{u}_{i-1} + 5\\bar{u}_i + 2\\bar{u}_{i+1}) $$", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{2\\bar{u}_{i-1} + 5\\bar{u}_i - \\bar{u}_{i+1}}{6} & \\frac{-\\bar{u}_{i-1} + 5\\bar{u}_i + 2\\bar{u}_{i+1}}{6}\n\\end{pmatrix}\n}\n$$", "id": "3328997"}, {"introduction": "Constructing a high-order scheme is only half the battle; understanding its behavior is equally crucial for reliable simulations. This exercise delves into the analysis of a fourth-order central difference scheme by deriving its local truncation error, which reveals the subtle errors the scheme introduces. By distinguishing between dispersive and dissipative error terms, you will learn to characterize how a numerical method can distort wave propagation, a critical insight for selecting appropriate schemes in computational fluid dynamics [@problem_id:3329059].", "problem": "Consider the linear advection partial differential equation (PDE) in one dimension (1D), given by $u_{t} + a\\,u_{x} = 0$ with constant advection speed $a$ and a sufficiently smooth solution $u(x,t)$, discretized on a uniform grid $x_{i} = x_{0} + i h$ with spacing $h$. In Computational Fluid Dynamics (CFD), a common high-order spatial discretization for the first derivative $u_{x}$ is the fourth-order central difference operator defined at a grid point $x_{i}$ by\n$$D^{(1)}_{4} u_{i} = \\frac{-u_{i+2} + 8\\,u_{i+1} - 8\\,u_{i-1} + u_{i-2}}{12\\,h}.$$\nStarting from the PDE and the definition of local truncation error (LTE) as the residual obtained by substituting the exact solution into the semi-discrete scheme, derive the leading-order expression for the LTE of the semi-discrete scheme $u_{t} + a\\,D^{(1)}_{4} u = 0$ in terms of spatial derivatives of $u$ at $x_{i}$. Then, using a principled characterization of numerical dispersion and dissipation based on the modified equation or Fourier symbol analysis, identify and express the leading dispersive and dissipative error terms associated with this spatial discretization. Your final answer should report three items, in the following order: the LTE through order $h^{4}$, the leading dispersive error term, and the leading dissipative error term, each as a single closed-form analytic expression involving $a$, $h$, and derivatives of $u$ with respect to $x$. No numerical rounding is required, and no physical units should be included in your final expressions.", "solution": "The problem is subjected to validation and is determined to be valid. It is a well-posed, scientifically grounded problem in the field of computational fluid dynamics, asking for a standard analysis of a numerical scheme.\n\nThe analysis proceeds in three parts as requested by the problem statement: first, the derivation of the Local Truncation Error (LTE); second, the derivation of the leading dispersive error term; and third, the identification of the leading dissipative error term.\n\n1.  **Local Truncation Error (LTE)**\n\nThe semi-discrete scheme is given by $\\frac{\\partial u}{\\partial t} + a\\,D^{(1)}_{4} u = 0$. The Local Truncation Error, $\\tau_i$, at a grid point $x_i$ is the residual obtained by substituting the exact solution $u(x,t)$ of the continuous PDE, $u_t + a\\,u_x = 0$, into the semi-discrete scheme.\n$$ \\tau_i = \\left(\\frac{\\partial u}{\\partial t}\\right)_i + a\\,D^{(1)}_{4} u_i $$\nFor the exact solution $u(x,t)$, we have $\\left(\\frac{\\partial u}{\\partial t}\\right)_i = -a\\,\\left(\\frac{\\partial u}{\\partial x}\\right)_i$. Substituting this into the expression for the LTE yields:\n$$ \\tau_i = -a\\,\\left(\\frac{\\partial u}{\\partial x}\\right)_i + a\\,D^{(1)}_{4} u_i = a \\left( D^{(1)}_{4} u_i - \\left(\\frac{\\partial u}{\\partial x}\\right)_i \\right) $$\nThe LTE of the semi-discrete scheme is therefore the advection speed $a$ multiplied by the truncation error of the spatial finite difference operator $D^{(1)}_{4}$. To find this truncation error, we employ Taylor series expansions for the terms $u_{i \\pm 1}$ and $u_{i \\pm 2}$ around the point $x_i$. We expand up to the term involving the fifth derivative, as we expect a fourth-order scheme. Let $u^{(n)} \\equiv \\frac{\\partial^n u}{\\partial x^n}\\big|_{x_i}$.\n$$ u_{i+k} = u(x_i+kh) = u_i + (kh)u^{(1)} + \\frac{(kh)^2}{2!}u^{(2)} + \\frac{(kh)^3}{3!}u^{(3)} + \\frac{(kh)^4}{4!}u^{(4)} + \\frac{(kh)^5}{5!}u^{(5)} + O(h^6) $$\nWe expand the four necessary terms:\n$$ u_{i+1} = u_i + h u^{(1)} + \\frac{h^2}{2} u^{(2)} + \\frac{h^3}{6} u^{(3)} + \\frac{h^4}{24} u^{(4)} + \\frac{h^5}{120} u^{(5)} + O(h^6) $$\n$$ u_{i-1} = u_i - h u^{(1)} + \\frac{h^2}{2} u^{(2)} - \\frac{h^3}{6} u^{(3)} + \\frac{h^4}{24} u^{(4)} - \\frac{h^5}{120} u^{(5)} + O(h^6) $$\n$$ u_{i+2} = u_i + 2h u^{(1)} + \\frac{4h^2}{2} u^{(2)} + \\frac{8h^3}{6} u^{(3)} + \\frac{16h^4}{24} u^{(4)} + \\frac{32h^5}{120} u^{(5)} + O(h^6) $$\n$$ u_{i-2} = u_i - 2h u^{(1)} + \\frac{4h^2}{2} u^{(2)} - \\frac{8h^3}{6} u^{(3)} + \\frac{16h^4}{24} u^{(4)} - \\frac{32h^5}{120} u^{(5)} + O(h^6) $$\nNow, we substitute these expansions into the definition of the operator $D^{(1)}_{4} u_{i}$:\n$$ D^{(1)}_{4} u_{i} = \\frac{-u_{i+2} + 8\\,u_{i+1} - 8\\,u_{i-1} + u_{i-2}}{12\\,h} $$\nWe group the terms in the numerator by the order of the derivative of $u$:\n-   $u^{(0)}$ term: $(-1 + 8 - 8 + 1)u_i = 0$.\n-   $u^{(1)}$ term: $(-2h + 8(h) - 8(-h) + (-2h))u^{(1)} = ( -2 + 8 + 8 - 2 )h u^{(1)} = 12h u^{(1)}$.\n-   $u^{(2)}$ term: $(-\\frac{4h^2}{2} + 8\\frac{h^2}{2} - 8\\frac{h^2}{2} + \\frac{4h^2}{2})u^{(2)} = ( -2 + 4 - 4 + 2 )h^2 u^{(2)} = 0$.\n-   $u^{(3)}$ term: $(-\\frac{8h^3}{6} + 8\\frac{h^3}{6} - 8(-\\frac{h^3}{6}) - \\frac{8h^3}{6})u^{(3)} = ( -8 + 8 + 8 - 8 )\\frac{h^3}{6} u^{(3)} = 0$.\n-   $u^{(4)}$ term: $(-\\frac{16h^4}{24} + 8\\frac{h^4}{24} - 8\\frac{h^4}{24} + \\frac{16h^4}{24})u^{(4)} = ( -16 + 8 - 8 + 16 )\\frac{h^4}{24} u^{(4)} = 0$.\n-   $u^{(5)}$ term: $(-\\frac{32h^5}{120} + 8\\frac{h^5}{120} - 8(-\\frac{h^5}{120}) - \\frac{32h^5}{120})u^{(5)} = ( -32 + 8 + 8 - 32 )\\frac{h^5}{120} u^{(5)} = -48 \\frac{h^5}{120} u^{(5)} = -\\frac{2}{5} h^5 u^{(5)}$.\n\nSubstituting these results back into the expression for $D^{(1)}_{4} u_{i}$:\n$$ D^{(1)}_{4} u_{i} = \\frac{1}{12h} \\left( 12h u^{(1)} - \\frac{2}{5} h^5 u^{(5)} + O(h^7) \\right) = u^{(1)} - \\frac{2}{5 \\cdot 12} h^4 u^{(5)} + O(h^6) $$\n$$ D^{(1)}_{4} u_{i} = \\frac{\\partial u}{\\partial x} - \\frac{1}{30} h^4 \\frac{\\partial^5 u}{\\partial x^5} + O(h^6) $$\nThe truncation error of the spatial operator is the difference $D^{(1)}_{4} u_{i} - (\\frac{\\partial u}{\\partial x})_i$, which is $-\\frac{1}{30} h^4 \\frac{\\partial^5 u}{\\partial x^5} + O(h^6)$.\nThe LTE of the semi-discrete scheme is therefore:\n$$ \\tau_i = a \\left( -\\frac{1}{30} h^4 \\frac{\\partial^5 u}{\\partial x^5} + O(h^6) \\right) = -\\frac{a h^4}{30} \\frac{\\partial^5 u}{\\partial x^5} + O(h^6) $$\nThe leading-order term of the LTE is $-\\frac{a h^4}{30} \\frac{\\partial^5 u}{\\partial x^5}$.\n\n2.  **Dispersive and Dissipative Error Terms**\n\nTo identify the dispersive and dissipative error terms, we derive the modified equation. The modified equation is a PDE that is more accurately solved by the numerical scheme than the original PDE. It is obtained by substituting the Taylor expansion of the discrete operator into the numerical scheme.\n$$ \\frac{\\partial u}{\\partial t} + a D^{(1)}_{4} u = 0 \\implies \\frac{\\partial u}{\\partial t} + a \\left( \\frac{\\partial u}{\\partial x} - \\frac{1}{30} h^4 \\frac{\\partial^5 u}{\\partial x^5} + O(h^6) \\right) = 0 $$\nRearranging this equation to match the form of the original PDE on the left-hand side gives:\n$$ \\frac{\\partial u}{\\partial t} + a \\frac{\\partial u}{\\partial x} = \\frac{a h^4}{30} \\frac{\\partial^5 u}{\\partial x^5} + O(h^6) $$\nThe terms on the right-hand side represent the error of the numerical scheme. Error terms with odd-order spatial derivatives are dispersive, while terms with even-order spatial derivatives are dissipative (or anti-dissipative).\n\nThe leading error term is $\\frac{a h^4}{30} \\frac{\\partial^5 u}{\\partial x^5}$. Since the spatial derivative is of order $5$ (an odd number), this is a **dispersive error term**.\n\nTo find the leading dissipative error term, we look for the lowest-order even-derivative term in the error expansion. The operator $D^{(1)}_{4}$ is a symmetric central difference stencil. A property of such stencils for approximating a first derivative is that all even-order derivative terms in their Taylor series expansion cancel out. As shown in our derivation, the coefficients for $u^{(2)}$ and $u^{(4)}$ are zero. This pattern continues for all higher even-order derivatives ($u^{(6)}, u^{(8)}, \\ldots$). Consequently, the truncation error of $D^{(1)}_{4}$ contains only odd-order derivative terms:\n$$ D^{(1)}_{4} u - u_x = C_5 h^4 u^{(5)} + C_7 h^6 u^{(7)} + C_9 h^8 u^{(9)} + \\dots $$\nThe modified equation will therefore only contain odd-order spatial derivatives on its right-hand side. There are no even-order derivative terms. Because dissipative errors are associated with even-order derivatives, this scheme has no inherent numerical dissipation.\n\nTherefore, the leading dispersive error term is $\\frac{a h^4}{30} \\frac{\\partial^5 u}{\\partial x^5}$, and the leading dissipative error term is $0$.\n\nThe three requested expressions are:\n1.  LTE: $-\\frac{a h^4}{30} \\frac{\\partial^5 u}{\\partial x^5}$\n2.  Leading dispersive error term: $\\frac{a h^4}{30} \\frac{\\partial^5 u}{\\partial x^5}$\n3.  Leading dissipative error term: $0$", "answer": "$$ \\boxed{ \\begin{pmatrix} -\\frac{a h^4}{30} \\frac{\\partial^5 u}{\\partial x^5} & \\frac{a h^4}{30} \\frac{\\partial^5 u}{\\partial x^5} & 0 \\end{pmatrix} } $$", "id": "3329059"}, {"introduction": "While high-order methods excel in smooth flow regions, they notoriously produce spurious oscillations near discontinuities like shock waves. This practice introduces a sophisticated solution from the Discontinuous Galerkin (DG) framework: a modal smoothness sensor that acts as a \"shock detector\". You will derive this sensor by analyzing the energy distribution across polynomial modes and learn how it provides a targeted, automatic way to apply stabilization, thereby enabling robust and accurate simulations of complex, multi-scale flows [@problem_id:3329004].", "problem": "Consider a one-dimensional scalar conservation law discretized by the Discontinuous Galerkin (DG) method on the reference element $\\left[-1,1\\right]$ using a polynomial space of degree $p$. Let the DG approximation be expanded in an $L^2$-orthonormal modal basis $\\{\\phi_{k}(x)\\}_{k=0}^{p}$ (for example, orthonormalized Legendre polynomials), so that\n$$\nu_{h}(x) \\;=\\; \\sum_{k=0}^{p} a_{k} \\,\\phi_{k}(x),\n$$\nwith modal coefficients $\\{a_{k}\\}_{k=0}^{p}$. Starting from the definition of the element-wise $L^2$ energy $E \\equiv \\int_{-1}^{1} u_{h}(x)^{2}\\,dx$ and the orthonormality of the basis, derive a modal smoothness sensor that compares the energy contained in the highest polynomial mode (i.e., $k=p$) to the total energy. Your derivation must introduce a dimensionless smoothness indicator $s$ that is expressed using a base-$10$ logarithm of an appropriate energy ratio and that remains well-defined even if the highest modal coefficient vanishes.\n\nNext, using only the assumption that the modal amplitudes of a sufficiently smooth function decay asymptotically like $a_{k} \\sim C\\,k^{-q}$ as $k \\to \\infty$ for some $q>0$, derive a polynomial-degree-dependent threshold $s_{\\mathrm{th}}(p)$ that activates artificial viscosity when $s > s_{\\mathrm{th}}(p)$. Specify a practical ramping strategy that transitions the viscosity from zero to a maximum value $\\nu_{\\max}$ between two degree-dependent thresholds $s_{0}(p)$ and $s_{1}(p)$ with $s_{0}(p) < s_{1}(p)$.\n\nFinally, for a specific element with polynomial degree $p = 5$ and modal coefficients\n$$\na_{0} = 1.2,\\quad a_{1} = 0.3,\\quad a_{2} = 0.08,\\quad a_{3} = 0.02,\\quad a_{4} = 0.004,\\quad a_{5} = 0.001,\n$$\nevaluate your sensor $s$ on this element. Round your answer to $4$ significant figures. The sensor is dimensionless; report only the number.", "solution": "The problem requires the derivation of a modal smoothness sensor for the Discontinuous Galerkin (DG) method, an associated threshold for activating artificial viscosity, and a numerical evaluation of the sensor for a specific case. We shall proceed by first validating the problem statement and then providing a rigorous, step-by-step solution.\n\nThe problem is found to be valid. It is scientifically grounded in the established theory of numerical methods for conservation laws, specifically high-order DG methods and shock capturing. The premises, including the use of an orthonormal modal basis and the asymptotic decay of modal coefficients for smooth functions, are standard in this field. The problem is self-contained, well-posed, and objective, with no apparent contradictions or ambiguities.\n\nWe now proceed with the solution.\n\nFirst, we derive the expression for the element-wise $L^2$ energy, $E$, in terms of the modal coefficients. The DG approximation is given by $u_{h}(x) = \\sum_{k=0}^{p} a_{k} \\phi_{k}(x)$. The energy $E$ on the reference element $[-1, 1]$ is defined as:\n$$\nE \\equiv \\int_{-1}^{1} u_{h}(x)^{2}\\,dx\n$$\nSubstituting the modal expansion for $u_h(x)$:\n$$\nE = \\int_{-1}^{1} \\left( \\sum_{j=0}^{p} a_{j} \\phi_{j}(x) \\right) \\left( \\sum_{k=0}^{p} a_{k} \\phi_{k}(x) \\right) \\,dx\n$$\nBy linearity, we can interchange the order of summation and integration:\n$$\nE = \\sum_{j=0}^{p} \\sum_{k=0}^{p} a_{j} a_{k} \\int_{-1}^{1} \\phi_{j}(x) \\phi_{k}(x) \\,dx\n$$\nThe basis functions $\\{\\phi_k(x)\\}$ are stipulated to be $L^2$-orthonormal, which means their inner product satisfies $\\int_{-1}^{1} \\phi_{j}(x) \\phi_{k}(x) \\,dx = \\delta_{jk}$, where $\\delta_{jk}$ is the Kronecker delta. Applying this property simplifies the expression for energy:\n$$\nE = \\sum_{j=0}^{p} \\sum_{k=0}^{p} a_{j} a_{k} \\delta_{jk} = \\sum_{k=0}^{p} a_{k}^{2}\n$$\nThis result is the finite-dimensional version of Parseval's theorem. The total energy $E_{\\mathrm{total}}$ is the sum of the squares of the modal coefficients. The energy contained in a single mode $k$ is simply $E_k = a_k^2$.\n\nNext, we derive the modal smoothness sensor, $s$. The sensor is required to compare the energy in the highest mode ($k=p$), $E_p=a_p^2$, to the total energy, $E_{\\mathrm{total}} = \\sum_{k=0}^{p} a_{k}^{2}$. Let's define the ratio $\\mathcal{R}$ as:\n$$\n\\mathcal{R} = \\frac{E_p}{E_{\\mathrm{total}}} = \\frac{a_p^2}{\\sum_{k=0}^{p} a_{k}^{2}}\n$$\nWe assume the numerical solution is not identically zero, so that $\\sum_{k=0}^{p} a_{k}^{2} > 0$. The smoothness indicator $s$ is defined using the base-$10$ logarithm of this ratio:\n$$\ns = \\log_{10}(\\mathcal{R}) = \\log_{10} \\left( \\frac{a_p^2}{\\sum_{k=0}^{p} a_{k}^{2}} \\right)\n$$\nThis indicator is dimensionless, as required. For a solution with a discontinuity (a shock), a significant portion of the energy is scattered into the high-frequency modes, making $a_p$ relatively large. In the limit of a function composed entirely of the highest mode (e.g., $u_h \\propto \\phi_p$), we have $\\mathcal{R}=1$ and $s=0$. For a very smooth solution, the modal coefficients decay rapidly, making $a_p$ very small, which results in a large negative value for $s$. The problem requires the sensor to be well-defined even if $a_p=0$. In this case, $\\mathcal{R}=0$. The limit of $\\log_{10}(x)$ as $x \\to 0^+$ is $-\\infty$. This limiting value is mathematically well-defined and correctly signifies a solution that is perfectly smooth with respect to the polynomial basis of degree $p$ (i.e., it is a polynomial of degree at most $p-1$). Thus, this formulation satisfies the stated requirements.\n\nSecond, we derive the polynomial-degree-dependent threshold $s_{\\mathrm{th}}(p)$. We are to use the assumption that for a sufficiently smooth function, the modal coefficients decay as $a_k \\sim C k^{-q}$ for some constants $C$ and $q>0$ as $k \\to \\infty$. This asymptotic behavior will be used to characterize the sensor value for a well-resolved numerical solution. Using this relation for $k \\in \\{1, \\dots, p\\}$, we can approximate the coefficients. The coefficient $a_0$ represents the mean of the solution and generally does not follow this decay law. The energy in the highest mode is $a_p^2 \\approx C^2 p^{-2q}$. The total energy is $\\sum_{k=0}^{p} a_k^2 = a_0^2 + \\sum_{k=1}^{p} a_k^2$. For a rapidly convergent series (large $q$), the total energy is dominated by the first few terms, so $E_{\\mathrm{total}} \\approx a_0^2 + C^2\\sum_{k=1}^{p} k^{-2q}$.\nThe ratio $\\mathcal{R}$ for a smooth function is thus:\n$$\n\\mathcal{R}_{\\mathrm{smooth}}(p) \\approx \\frac{C^2 p^{-2q}}{a_0^2 + C^2\\sum_{k=1}^{p} k^{-2q}}\n$$\nAssuming the solution is well-resolved, the energy is dominated by the constant mode $a_0$, so $a_0^2 \\gg C^2\\sum_{k=1}^{p} k^{-2q}$. This simplifies the ratio to:\n$$\n\\mathcal{R}_{\\mathrm{smooth}}(p) \\approx \\frac{C^2}{a_0^2} p^{-2q}\n$$\nThe threshold $s_{\\mathrm{th}}(p)$ is the value of the sensor for such a smooth function:\n$$\ns_{\\mathrm{th}}(p) = \\log_{10}(\\mathcal{R}_{\\mathrm{smooth}}(p)) \\approx \\log_{10}\\left(\\frac{C^2}{a_0^2} p^{-2q}\\right) = \\log_{10}\\left(\\frac{C^2}{a_0^2}\\right) - 2q \\log_{10}(p)\n$$\nThis derivation yields a threshold of the form $s_{\\mathrm{th}}(p) = K_1 - K_2 \\log_{10}(p)$, where $K_1 = \\log_{10}((C/a_0)^2)$ and $K_2 = 2q$ are constants that depend on the specific function being resolved and its smoothness. The functional dependence on the polynomial degree $p$ has been established as required. Artificial viscosity is activated when the measured sensor value $s$ exceeds this threshold, i.e., when $s > s_{\\mathrm{th}}(p)$, indicating that the solution is less smooth than expected for a well-resolved flow.\n\nThird, we specify a practical ramping strategy for the artificial viscosity $\\nu$. The viscosity should smoothly transition from $\\nu=0$ to a maximum value $\\nu_{\\max}$ as the sensor $s$ increases through a range defined by two thresholds, $s_0(p)$ and $s_1(p)$, with $s_0(p) < s_1(p)$. Following the problem, viscosity is activated for $s > s_{\\mathrm{th}}(p)$, so we set the lower threshold $s_0(p) = s_{\\mathrm{th}}(p)$. The upper threshold $s_1(p)$ is typically set based on practical considerations, for example $s_1(p) = s_0(p) + \\Delta s$ for some range $\\Delta s > 0$, or $s_1(p)$ may be set to a constant value like $0$. A general ramping strategy can be formulated as follows:\n$$\n\\nu =\n\\begin{cases}\n    0 & \\text{if } s \\leq s_{0}(p) \\\\\n    \\nu_{\\max} \\cdot f\\left(\\frac{s - s_{0}(p)}{s_{1}(p) - s_{0}(p)}\\right) & \\text{if } s_{0}(p) < s < s_{1}(p) \\\\\n    \\nu_{\\max} & \\text{if } s \\geq s_{1}(p)\n\\end{cases}\n$$\nwhere $f(\\xi)$ is a monotonic function with $f(0)=0$ and $f(1)=1$. A simple and practical choice for $f(\\xi)$ is a linear ramp, $f(\\xi) = \\xi$. A smoother ramp (providing $C^1$ continuity for $\\nu$) can be achieved with a function like $f(\\xi) = \\frac{1}{2}(1 - \\cos(\\pi\\xi))$.\n\nFinally, we evaluate the sensor $s$ for the specific case where the polynomial degree is $p=5$ and the modal coefficients are given as:\n$a_{0} = 1.2$, $a_{1} = 0.3$, $a_{2} = 0.08$, $a_{3} = 0.02$, $a_{4} = 0.004$, and $a_{5} = 0.001$.\n\nThe highest mode is $p=5$, so we need to calculate $a_5^2$:\n$$\na_5^2 = (0.001)^2 = (1 \\times 10^{-3})^2 = 1 \\times 10^{-6}\n$$\nNext, we calculate the total energy, $\\sum_{k=0}^{5} a_k^2$:\n\\begin{align*}\n\\sum_{k=0}^{5} a_k^2 &= (1.2)^2 + (0.3)^2 + (0.08)^2 + (0.02)^2 + (0.004)^2 + (0.001)^2 \\\\\n&= 1.44 + 0.09 + 0.0064 + 0.0004 + 0.000016 + 0.000001 \\\\\n&= 1.536817\n\\end{align*}\nNow we can compute the ratio $\\mathcal{R}$:\n$$\n\\mathcal{R} = \\frac{a_5^2}{\\sum_{k=0}^{5} a_k^2} = \\frac{1 \\times 10^{-6}}{1.536817} \\approx 6.506935 \\times 10^{-7}\n$$\nThe value of the sensor $s$ is the base-$10$ logarithm of this ratio:\n$$\ns = \\log_{10}(6.506935 \\times 10^{-7}) \\approx -6.18663\n$$\nRounding to $4$ significant figures, we get $s = -6.187$.", "answer": "$$\\boxed{-6.187}$$", "id": "3329004"}]}