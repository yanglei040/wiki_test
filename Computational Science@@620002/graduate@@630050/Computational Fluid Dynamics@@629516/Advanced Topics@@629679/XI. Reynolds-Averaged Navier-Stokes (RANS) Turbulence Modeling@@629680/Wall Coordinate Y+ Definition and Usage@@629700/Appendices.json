{"hands_on_practices": [{"introduction": "A crucial first step in analyzing any wall-bounded turbulent flow is to translate physical, dimensional quantities into the universal language of wall units. This exercise provides a foundational practice in this conversion, starting from a known skin-friction coefficient—a quantity often obtained from experiments or empirical correlations—to compute the friction velocity $u_{\\tau}$ and subsequently the dimensionless wall coordinate $y^{+}$. Mastering this fundamental calculation is essential for correctly interpreting simulation results and setting up appropriate near-wall mesh resolutions [@problem_id:3390309].", "problem": "A zero-pressure-gradient turbulent boundary layer develops over a smooth flat plate in air. At a given streamwise station, the local external velocity is measured as $U_{e} = 25 \\ \\mathrm{m/s}$. The air has density $\\rho = 1.2 \\ \\mathrm{kg/m^{3}}$ and dynamic viscosity $\\mu = 1.8 \\times 10^{-5} \\ \\mathrm{Pa \\cdot s}$. The local skin-friction coefficient is measured as $C_{f} = 3.2 \\times 10^{-3}$, defined by the relation $C_{f} = \\tau_{w} / \\left( 0.5 \\, \\rho \\, U_{e}^{2} \\right)$, where $\\tau_{w}$ is the wall shear stress. \n\nA measurement point is located at a wall-normal distance $y = 0.20 \\ \\mathrm{mm}$ from the wall. Starting from the fundamental definitions of wall shear stress and friction velocity, first derive the expression for the friction velocity $u_{\\tau}$ in terms of $U_{e}$ and $C_{f}$. Then, using the canonical wall coordinate based on the viscous length scale, compute the non-dimensional wall coordinate $y^{+}$ at the measurement location. \n\nExpress $y^{+}$ as a pure number (dimensionless) and round your final answer to four significant figures.", "solution": "The problem requires the derivation of an expression for the friction velocity, $u_{\\tau}$, and the subsequent calculation of the non-dimensional wall coordinate, $y^{+}$, for a turbulent boundary layer.\n\nThe given parameters for the flow are:\nExternal velocity: $U_{e} = 25 \\ \\mathrm{m/s}$\nFluid density: $\\rho = 1.2 \\ \\mathrm{kg/m^{3}}$\nFluid dynamic viscosity: $\\mu = 1.8 \\times 10^{-5} \\ \\mathrm{Pa \\cdot s}$\nLocal skin-friction coefficient: $C_{f} = 3.2 \\times 10^{-3}$\nWall-normal distance of the measurement point: $y = 0.20 \\ \\mathrm{mm}$\n\nThe skin-friction coefficient is defined as:\n$$C_{f} = \\frac{\\tau_{w}}{\\frac{1}{2} \\rho U_{e}^{2}}$$\nwhere $\\tau_{w}$ is the wall shear stress.\n\nFirst, we will derive the expression for the friction velocity $u_{\\tau}$ in terms of $U_{e}$ and $C_{f}$.\nThe friction velocity $u_{\\tau}$ is fundamentally defined by the wall shear stress $\\tau_w$ and the fluid density $\\rho$ as:\n$$u_{\\tau} = \\sqrt{\\frac{\\tau_{w}}{\\rho}}$$\nFrom the definition of $C_{f}$, we can express the wall shear stress $\\tau_{w}$ as:\n$$\\tau_{w} = C_{f} \\left( \\frac{1}{2} \\rho U_{e}^{2} \\right)$$\nSubstituting this expression for $\\tau_{w}$ into the definition of $u_{\\tau}$ yields:\n$$u_{\\tau} = \\sqrt{\\frac{C_{f} \\left( \\frac{1}{2} \\rho U_{e}^{2} \\right)}{\\rho}}$$\nThe density $\\rho$ cancels from the numerator and the denominator:\n$$u_{\\tau} = \\sqrt{\\frac{1}{2} C_{f} U_{e}^{2}}$$\nThis simplifies to the desired relationship between $u_{\\tau}$, $U_{e}$, and $C_{f}$:\n$$u_{\\tau} = U_{e} \\sqrt{\\frac{C_{f}}{2}}$$\n\nNext, we will compute the non-dimensional wall coordinate $y^{+}$.\nThe canonical wall coordinate $y^{+}$ is defined as the wall-normal distance $y$ non-dimensionalized by the viscous length scale, $\\delta_{\\nu} = \\nu / u_{\\tau}$, where $\\nu$ is the kinematic viscosity.\n$$y^{+} = \\frac{y}{\\delta_{\\nu}} = \\frac{y u_{\\tau}}{\\nu}$$\nThe kinematic viscosity $\\nu$ is related to the dynamic viscosity $\\mu$ and density $\\rho$ by $\\nu = \\mu/\\rho$. Substituting this into the expression for $y^{+}$ gives a more convenient form for calculation using the provided parameters:\n$$y^{+} = \\frac{y u_{\\tau}}{\\mu / \\rho} = \\frac{y \\rho u_{\\tau}}{\\mu}$$\nTo calculate $y^{+}$, we first need the numerical value of $u_{\\tau}$. Using the derived expression and the given values for $U_e$ and $C_f$:\n$$u_{\\tau} = (25 \\ \\mathrm{m/s}) \\sqrt{\\frac{3.2 \\times 10^{-3}}{2}} = (25 \\ \\mathrm{m/s}) \\sqrt{1.6 \\times 10^{-3}}$$\nCalculating the square root:\n$$\\sqrt{1.6 \\times 10^{-3}} = \\sqrt{16 \\times 10^{-4}} = 4 \\times 10^{-2} = 0.04$$\nThus, the friction velocity is:\n$$u_{\\tau} = 25 \\times 0.04 \\ \\mathrm{m/s} = 1.0 \\ \\mathrm{m/s}$$\nNow we can compute $y^{+}$. The physical distance from the wall must be converted to base SI units: $y = 0.20 \\ \\mathrm{mm} = 0.20 \\times 10^{-3} \\ \\mathrm{m}$.\nSubstituting all numerical values into the expression for $y^{+}$:\n$$y^{+} = \\frac{(0.20 \\times 10^{-3} \\ \\mathrm{m}) \\cdot (1.2 \\ \\mathrm{kg/m^{3}}) \\cdot (1.0 \\ \\mathrm{m/s})}{1.8 \\times 10^{-5} \\ \\mathrm{Pa \\cdot s}}$$\nNoting that $1 \\ \\mathrm{Pa \\cdot s} = 1 \\ \\mathrm{kg/(m \\cdot s)}$, the units cancel out, confirming that $y^{+}$ is dimensionless.\n$$y^{+} = \\frac{0.20 \\times 1.2 \\times 1.0 \\times 10^{-3}}{1.8 \\times 10^{-5}} = \\frac{0.24 \\times 10^{-3}}{1.8 \\times 10^{-5}}$$\n$$y^{+} = \\frac{2.4 \\times 10^{-4}}{1.8 \\times 10^{-5}} = \\frac{2.4}{1.8} \\times 10^{(-4 - (-5))} = \\frac{4}{3} \\times 10^{1}$$\n$$y^{+} = \\frac{40}{3} \\approx 13.3333...$$\nThe problem asks for the result to be rounded to four significant figures.\n$$y^{+} = 13.33$$", "answer": "$$\\boxed{13.33}$$", "id": "3390309"}, {"introduction": "Now that we can calculate $y^{+}$, we must ask why this specific coordinate is so critical for computational meshing. This practice guides you through a theoretical derivation that reveals the fundamental reason: the dramatic change in the velocity gradient, $\\mathrm{d}U^{+}/\\mathrm{d}y^{+}$, as one moves away from the wall. By comparing the steep gradient in the viscous sublayer to the much gentler slope in the logarithmic region, you will uncover the physical basis for the stringent grid spacing requirements in wall-resolved simulations [@problem_id:3390346].", "problem": "Consider a statistically steady, fully developed, incompressible turbulent plane channel flow of a Newtonian fluid with density $\\rho$, dynamic viscosity $\\mu$, and kinematic viscosity $\\nu = \\mu/\\rho$. Let the mean streamwise velocity be $U(y)$ and the wall shear stress be $\\tau_{w}$. Define the friction velocity $u_{\\tau} = \\sqrt{\\tau_{w}/\\rho}$, the wall coordinate $y^{+} = y u_{\\tau}/\\nu$, and the dimensionless mean velocity $U^{+} = U/u_{\\tau}$. Near the wall, the viscous sublayer is characterized by dominance of viscous shear, and farther from the wall in the equilibrium turbulent region, the mean profile is governed by similarity arguments consistent with Prandtl’s mixing-length hypothesis using $\\ell_{m} = \\kappa y$, where $\\kappa$ is the von Kármán constant and $B$ is an additive intercept determining the mean velocity but not its gradient in that region.\n\nStarting from these definitions and the Newtonian constitutive relation, and invoking the conventional equilibrium assumption that the total shear stress is approximately constant and equal to $\\rho u_{\\tau}^{2}$ across the near-wall region, derive expressions for the wall-normal gradient of the dimensionless mean velocity, $\\mathrm{d}U^{+}/\\mathrm{d}y^{+}$, in both the viscous sublayer and the logarithmic layer of the turbulent boundary layer.\n\nThen, using the obtained expressions, briefly interpret how the magnitude and $y^{+}$-dependence of $\\mathrm{d}U^{+}/\\mathrm{d}y^{+}$ should inform the choice of wall-normal grid spacing $\\Delta y$ in numerical simulations aiming for wall resolution in Large Eddy Simulation (LES) and near-wall modeling in Reynolds-Averaged Navier–Stokes (RANS). Your interpretation should be qualitative but explicitly reference the scaling of $\\Delta U^{+} \\approx (\\mathrm{d}U^{+}/\\mathrm{d}y^{+}) \\Delta y^{+}$ with $y^{+}$.\n\nProvide the final answer as a two-entry row vector containing, in order, the viscous-sublayer gradient and the logarithmic-layer gradient, expressed purely in terms of $y^{+}$ and the constant $\\kappa$. No numerical values of $\\kappa$ or $B$ should be substituted. No units are required. The final answer must be an exact analytical expression.", "solution": "### Derivation of Velocity Gradients\n\nThe total shear stress, $\\tau_{total}$, in a turbulent boundary layer is the sum of the mean viscous stress, $\\tau_{visc}$, and the Reynolds shear stress, $\\tau_{turb}$. For a plane channel flow, this is expressed as:\n$$\n\\tau_{total}(y) = \\mu \\frac{\\mathrm{d}U}{\\mathrm{d}y} - \\rho \\overline{u'v'}\n$$\nwhere $u'$ and $v'$ are the fluctuating velocity components in the streamwise and wall-normal directions, respectively, and the overbar denotes a time average.\n\nThe problem states the equilibrium assumption, common for the near-wall region, that the total shear stress is approximately constant and equal to the wall shear stress, $\\tau_{w}$.\n$$\n\\tau_{w} \\approx \\mu \\frac{\\mathrm{d}U}{\\mathrm{d}y} - \\rho \\overline{u'v'}\n$$\nBy definition, $\\tau_{w} = \\rho u_{\\tau}^{2}$. Substituting this and dividing the entire equation by the density $\\rho$ yields:\n$$\nu_{\\tau}^{2} \\approx \\frac{\\mu}{\\rho} \\frac{\\mathrm{d}U}{\\mathrm{d}y} - \\overline{u'v'} = \\nu \\frac{\\mathrm{d}U}{\\mathrm{d}y} - \\overline{u'v'}\n$$\nTo express this equation in dimensionless wall units, we introduce the dimensionless variables $U^{+} = U/u_{\\tau}$ and $y^{+} = y u_{\\tau}/\\nu$. The gradient of the mean velocity can be transformed as follows using the chain rule:\n$$\n\\frac{\\mathrm{d}U}{\\mathrm{d}y} = \\frac{\\mathrm{d}(U^{+} u_{\\tau})}{\\mathrm{d}(y^{+} \\nu / u_{\\tau})} = \\frac{u_{\\tau}}{(\\nu/u_{\\tau})} \\frac{\\mathrm{d}U^{+}}{\\mathrm{d}y^{+}} = \\frac{u_{\\tau}^{2}}{\\nu} \\frac{\\mathrm{d}U^{+}}{\\mathrm{d}y^{+}}\n$$\nSubstituting this into the stress balance equation:\n$$\nu_{\\tau}^{2} \\approx \\nu \\left( \\frac{u_{\\tau}^{2}}{\\nu} \\frac{\\mathrm{d}U^{+}}{\\mathrm{d}y^{+}} \\right) - \\overline{u'v'}\n$$\n$$\nu_{\\tau}^{2} \\approx u_{\\tau}^{2} \\frac{\\mathrm{d}U^{+}}{\\mathrm{d}y^{+}} - \\overline{u'v'}\n$$\nDividing by $u_{\\tau}^{2}$ gives the dimensionless form of the near-wall stress balance:\n$$\n1 \\approx \\frac{\\mathrm{d}U^{+}}{\\mathrm{d}y^{+}} - \\frac{\\overline{u'v'}}{u_{\\tau}^{2}}\n$$\nThis fundamental relation describes the partitioning of total stress between viscous and turbulent contributions. We now analyze its behavior in the two specified regions.\n\n**1. Viscous Sublayer**\nIn the viscous sublayer (the region immediately adjacent to the wall, typically for $y^{+} \\lesssim 5$), molecular viscosity effects dominate, and turbulent fluctuations are strongly damped. Consequently, the Reynolds shear stress term is negligible compared to the viscous stress term:\n$$\n- \\frac{\\overline{u'v'}}{u_{\\tau}^{2}} \\to 0\n$$\nThe dimensionless stress balance simplifies to:\n$$\n1 \\approx \\frac{\\mathrm{d}U^{+}}{\\mathrm{d}y^{+}}\n$$\nTherefore, in the viscous sublayer, the gradient of the dimensionless mean velocity is constant.\n$$\n\\frac{\\mathrm{d}U^{+}}{\\mathrm{d}y^{+}} = 1\n$$\n\n**2. Logarithmic Layer**\nIn the logarithmic layer (farther from the wall, typically for $y^{+} \\gtrsim 30$, but still in the inner region), the flow is fully turbulent, and the direct effects of molecular viscosity on the mean flow profile are negligible. In this case, the viscous stress term $\\mathrm{d}U^{+}/\\mathrm{d}y^{+}$ is considered small compared to the turbulent stress term, which must balance the total stress. The stress balance $1 \\approx \\mathrm{d}U^{+}/\\mathrm{d}y^{+} - \\overline{u'v'}/u_{\\tau}^{2}$ thus implies that the turbulent stress dominates, i.e., $- \\overline{u'v'}/u_{\\tau}^{2} \\approx 1$.\n\nTo find the velocity gradient, we invoke Prandtl's mixing-length hypothesis. The Reynolds shear stress is modeled as:\n$$\n- \\rho \\overline{u'v'} = \\rho \\ell_{m}^{2} \\left| \\frac{\\mathrm{d}U}{\\mathrm{d}y} \\right| \\frac{\\mathrm{d}U}{\\mathrm{d}y}\n$$\nGiven that $\\mathrm{d}U/\\mathrm{d}y  0$ for this shear flow, this simplifies to:\n$$\n- \\rho \\overline{u'v'} = \\rho \\ell_{m}^{2} \\left( \\frac{\\mathrm{d}U}{\\mathrm{d}y} \\right)^{2}\n$$\nThe problem specifies that in this region, $\\ell_{m} = \\kappa y$. The total stress is carried by the turbulent component, so $\\tau_{w} \\approx -\\rho \\overline{u'v'}$.\n$$\n\\tau_{w} \\approx \\rho (\\kappa y)^{2} \\left( \\frac{\\mathrm{d}U}{\\mathrm{d}y} \\right)^{2}\n$$\nDividing by $\\rho$ and recalling $\\tau_{w}/\\rho = u_{\\tau}^{2}$:\n$$\nu_{\\tau}^{2} \\approx (\\kappa y)^{2} \\left( \\frac{\\mathrm{d}U}{\\mathrm{d}y} \\right)^{2}\n$$\nTaking the square root of both sides (all quantities are positive):\n$$\nu_{\\tau} \\approx \\kappa y \\frac{\\mathrm{d}U}{\\mathrm{d}y}\n$$\nWe want to find $\\mathrm{d}U^{+}/\\mathrm{d}y^{+}$. We can first solve for $\\mathrm{d}U/\\mathrm{d}y$:\n$$\n\\frac{\\mathrm{d}U}{\\mathrm{d}y} \\approx \\frac{u_{\\tau}}{\\kappa y}\n$$\nNow, we relate this back to the dimensionless gradient using the identity derived earlier: $\\mathrm{d}U/\\mathrm{d}y = (u_{\\tau}^{2}/\\nu) \\mathrm{d}U^{+}/\\mathrm{d}y^{+}$.\n$$\n\\frac{u_{\\tau}^{2}}{\\nu} \\frac{\\mathrm{d}U^{+}}{\\mathrm{d}y^{+}} = \\frac{u_{\\tau}}{\\kappa y}\n$$\nSolving for $\\mathrm{d}U^{+}/\\mathrm{d}y^{+}$:\n$$\n\\frac{\\mathrm{d}U^{+}}{\\mathrm{d}y^{+}} = \\frac{\\nu}{u_{\\tau}^{2}} \\frac{u_{\\tau}}{\\kappa y} = \\frac{\\nu}{\\kappa y u_{\\tau}}\n$$\nFinally, we substitute the definition of the wall coordinate $y^{+} = y u_{\\tau}/\\nu$ into the expression. This is equivalent to substituting $y u_{\\tau}/\\nu$ with $y^{+}$. The expression becomes:\n$$\n\\frac{\\mathrm{d}U^{+}}{\\mathrm{d}y^{+}} = \\frac{1}{\\kappa (y u_{\\tau}/\\nu)} = \\frac{1}{\\kappa y^{+}}\n$$\nThis is the desired expression for the gradient in the logarithmic layer.\n\n### Interpretation for Numerical Grid Spacing\n\nThe derived velocity gradients inform the necessary grid resolution for numerical simulations. The change in dimensionless velocity across one wall-normal grid cell, $\\Delta U^{+}$, can be approximated by $\\Delta U^{+} \\approx (\\mathrm{d}U^{+}/\\mathrm{d}y^{+}) \\Delta y^{+}$.\n\n- In the viscous sublayer, $\\mathrm{d}U^{+}/\\mathrm{d}y^{+} = 1$. The gradient is of order unity and is the largest found in the entire near-wall region. To accurately capture the velocity profile (i.e., to keep $\\Delta U^{+}$ small), the grid spacing in wall units, $\\Delta y^{+}$, must be very small. This is why wall-resolved simulations like LES require the first grid point to be at $y^{+} \\approx 1$ or less, and need several grid points within the region $y^{+}  10$. The steepness of the profile demands this high resolution.\n\n- In the logarithmic layer, $\\mathrm{d}U^{+}/\\mathrm{d}y^{+} = 1/(\\kappa y^{+})$. Since $\\kappa \\approx 0.4$, this gradient is approximately $2.5/y^{+}$. As $y^{+}$ increases, the gradient decreases significantly. For instance, at $y^{+} = 30$, the gradient is $\\approx 0.083$, and at $y^{+} = 100$, it is $0.025$. This much gentler slope means that a significantly larger grid spacing $\\Delta y^{+}$ can be used while still maintaining a reasonably small $\\Delta U^{+}$ across the cell. This property is exploited in RANS simulations that use wall functions. By placing the first grid cell in the logarithmic region (e.g., $30  y^{+}  100$), one can avoid the prohibitively high cost of resolving the steep gradients in the viscous sublayer.\n\nIn summary, the steep velocity gradient in the viscous sublayer ($\\mathrm{d}U^{+}/\\mathrm{d}y^{+} = 1$) necessitates a very fine grid for wall-resolved methods, while the much gentler, decaying gradient in the log-layer ($\\mathrm{d}U^{+}/\\mathrm{d}y^{+} = 1/(\\kappa y^{+})$) permits the use of coarser grids in conjunction with wall models that bypass this high-resolution requirement.", "answer": "$$\n\\boxed{\\begin{pmatrix} 1  \\frac{1}{\\kappa y^{+}} \\end{pmatrix}}\n$$", "id": "3390346"}, {"introduction": "Bridging the gap between theory and application, this final practice challenges you to implement your understanding in a practical, algorithmic context. You will design a method for generating a geometrically stretched wall-normal mesh that intelligently adapts its first-cell height to maintain a target $y^{+}$ value, even as flow conditions change. This task mirrors the real-world work of a CFD engineer, solidifying your ability to construct high-quality meshes that are crucial for accurate and efficient turbulence simulations [@problem_id:3390342].", "problem": "In Computational Fluid Dynamics (CFD), near-wall resolution is controlled by the dimensionless wall coordinate $y^+$, defined by the relation $y^+ = y u_\\tau/\\nu$, where $y$ is the wall-normal distance in meters, $u_\\tau$ is the friction velocity in meters per second, and $\\nu$ is the kinematic viscosity in square meters per second. A mesh with $N$ wall-normal layers is to be designed at multiple streamwise stations with varying $u_\\tau$, such that the wall-normal layer thicknesses follow a geometric progression with a common ratio $r$, and the first-layer spacing satisfies a specified target first-cell wall coordinate $\\Delta y^+ = T$ at each station. The mesh is then evaluated by computing the resulting $y^+$ distribution and checking the physical mesh-top height against the local boundary-layer thickness.\n\nStarting from the fundamental definitions of $y^+$ and geometric progression, design an algorithm that, for each streamwise station, selects the first-layer thickness $\\Delta y_1(x_i)$ so that the first-cell wall coordinate equals the specified target $T$ and constructs the layer thicknesses $\\Delta y_j(x_i)$ for $j=1,\\dots,N$ using the geometric growth ratio $r$. Then, from these layer thicknesses, compute the cumulative wall coordinates $y^+_j$ of the mesh interfaces (i.e., the $y^+$ at the top of each layer), and evaluate the physical top-of-mesh height against the local boundary-layer thickness $\\delta(x_i)$.\n\nYour program must, for each provided test case, compute and return the following quantities:\n- The top-of-mesh wall coordinate $y^+_{\\text{top}}$ (dimensionless).\n- The maximum physical top-of-mesh height across all streamwise stations, in meters.\n- A boolean indicating whether, at every streamwise station, the physical top-of-mesh height is less than or equal to the local boundary-layer thickness $\\delta(x_i)$.\n- The list containing the first three cumulative interface coordinates in $y^+$ (i.e., $[y^+_1,y^+_2,y^+_3]$), or fewer if $N3$.\n\nPhysical units must be expressed as follows: heights must be in meters, velocities in meters per second, and kinematic viscosity in square meters per second. Angles do not appear in this problem. All outputs must be numeric floats or booleans, with the list of the first three $y^+$ values reported as pure numbers without units. The final program output must be a single line containing the results for all test cases as a comma-separated list enclosed in square brackets (e.g., $[result_1,result_2,result_3]$), where each $result_k$ is itself a list of the form $[y^+_{\\text{top}},\\ \\text{max\\_physical\\_top\\_height\\_in\\_m},\\ \\text{fits\\_boolean},\\ [y^+_1,y^+_2,y^+_3]]$.\n\nUse the following test suite, which spans typical and edge-case conditions:\n- Test Case $1$ (happy path, air at standard conditions):\n  - Kinematic viscosity $\\nu = 1.5\\times 10^{-5}\\ \\mathrm{m^2/s}$.\n  - Number of layers $N = 40$.\n  - Geometric growth ratio $r = 1.2$.\n  - Target first-cell wall coordinate $T = 0.8$.\n  - Streamwise positions $x = [0,\\ 2,\\ 4,\\ 6,\\ 8]$ meters (positions are informative but not directly used).\n  - Friction velocities $u_\\tau = [0.35,\\ 0.32,\\ 0.29,\\ 0.31,\\ 0.33]\\ \\mathrm{m/s}$.\n  - Boundary-layer thicknesses $\\delta = [0.025,\\ 0.028,\\ 0.030,\\ 0.029,\\ 0.027]\\ \\mathrm{m}$.\n- Test Case $2$ (boundary condition, uniform spacing, water):\n  - Kinematic viscosity $\\nu = 1.0\\times 10^{-6}\\ \\mathrm{m^2/s}$.\n  - Number of layers $N = 10$.\n  - Geometric growth ratio $r = 1.0$.\n  - Target first-cell wall coordinate $T = 1.5$.\n  - Streamwise positions $x = [0.0,\\ 0.5,\\ 1.0]$ meters.\n  - Friction velocities $u_\\tau = [0.05,\\ 0.05,\\ 0.05]\\ \\mathrm{m/s}$.\n  - Boundary-layer thicknesses $\\delta = [0.008,\\ 0.008,\\ 0.008]\\ \\mathrm{m}$.\n- Test Case $3$ (edge case, mild growth but many layers, air):\n  - Kinematic viscosity $\\nu = 1.5\\times 10^{-5}\\ \\mathrm{m^2/s}$.\n  - Number of layers $N = 100$.\n  - Geometric growth ratio $r = 1.05$.\n  - Target first-cell wall coordinate $T = 1.0$.\n  - Streamwise positions $x = [0,\\ 1,\\ 3,\\ 5]$ meters.\n  - Friction velocities $u_\\tau = [0.10,\\ 0.08,\\ 0.05,\\ 0.03]\\ \\mathrm{m/s}$.\n  - Boundary-layer thicknesses $\\delta = [0.015,\\ 0.013,\\ 0.010,\\ 0.008]\\ \\mathrm{m}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case result is a list $[y^+_{\\text{top}},\\ \\text{max\\_physical\\_top\\_height\\_in\\_m},\\ \\text{fits\\_boolean},\\ [y^+_1,y^+_2,y^+_3]]$.", "solution": "### Solution Derivation\n\nThe algorithm is designed by systematically deriving the required quantities from the fundamental principles provided.\n\nThe wall coordinate $y^+$ is defined as:\n$$y^+ = \\frac{y u_\\tau}{\\nu}$$\nwhere $y$ is the physical distance from the wall, $u_\\tau$ is the friction velocity, and $\\nu$ is the kinematic viscosity.\n\n**1. First-Layer Thickness $\\Delta y_1$**\n\nAt each streamwise station $x_i$, the first layer of the mesh has a physical thickness $\\Delta y_1(x_i)$. The dimensionless thickness of this first layer is required to be a constant target value $T$:\n$$\\Delta y_1^+(x_i) = \\frac{\\Delta y_1(x_i) u_\\tau(x_i)}{\\nu} = T$$\nSolving for the physical thickness $\\Delta y_1(x_i)$ gives a station-dependent value that ensures a constant first-cell $y^+$:\n$$\\Delta y_1(x_i) = \\frac{T \\nu}{u_\\tau(x_i)}$$\nThis shows that where $u_\\tau(x_i)$ is high, the first cell must be thinner, and where $u_\\tau(x_i)$ is low, it must be thicker to maintain the target $T$.\n\n**2. Layer Thicknesses and Cumulative Physical Height**\n\nThe thickness of any layer $j$, denoted $\\Delta y_j(x_i)$, follows a geometric progression with common ratio $r$:\n$$\\Delta y_j(x_i) = \\Delta y_1(x_i) \\cdot r^{j-1}$$\nThe cumulative physical distance from the wall to the top of the $j$-th layer, $y_j(x_i)$, is the sum of the thicknesses of the first $j$ layers:\n$$y_j(x_i) = \\sum_{k=1}^{j} \\Delta y_k(x_i) = \\Delta y_1(x_i) \\sum_{k=1}^{j} r^{k-1}$$\nThis is the sum of a finite geometric series. The solution depends on whether $r=1$.\n\nCase $r \\neq 1$:\n$$y_j(x_i) = \\Delta y_1(x_i) \\left( \\frac{r^j - 1}{r - 1} \\right)$$\nCase $r = 1$ (uniform mesh):\n$$y_j(x_i) = \\Delta y_1(x_i) \\sum_{k=1}^{j} 1 = j \\cdot \\Delta y_1(x_i)$$\nThe total physical height of the mesh at station $x_i$, $y_{\\text{top}}(x_i)$, is simply $y_N(x_i)$.\n\n**3. Cumulative Wall Coordinates $y_j^+$**\n\nThe cumulative wall coordinate at the top of layer $j$, $y_j^+$, is found by non-dimensionalizing the cumulative physical height $y_j(x_i)$ using the local friction velocity $u_\\tau(x_i)$:\n$$y_j^+(x_i) = \\frac{y_j(x_i) u_\\tau(x_i)}{\\nu}$$\nBy substituting the expression for $y_j(x_i)$ and the definition of $\\Delta y_1(x_i)$, we find a crucial result.\n\nFor $r \\neq 1$:\n$$y_j^+(x_i) = \\frac{u_\\tau(x_i)}{\\nu} \\left[ \\Delta y_1(x_i) \\left( \\frac{r^j - 1}{r - 1} \\right) \\right] = \\frac{u_\\tau(x_i)}{\\nu} \\left[ \\left( \\frac{T \\nu}{u_\\tau(x_i)} \\right) \\left( \\frac{r^j - 1}{r - 1} \\right) \\right] = T \\left( \\frac{r^j - 1}{r - 1} \\right)$$\nFor $r = 1$:\n$$y_j^+(x_i) = \\frac{u_\\tau(x_i)}{\\nu} \\left[ j \\cdot \\Delta y_1(x_i) \\right] = \\frac{u_\\tau(x_i)}{\\nu} \\left[ j \\cdot \\left( \\frac{T \\nu}{u_\\tau(x_i)} \\right) \\right] = j \\cdot T$$\nRemarkably, the resulting dimensionless interface coordinates $y_j^+$ are independent of the local station properties ($u_\\tau(x_i)$ and $\\nu$). They are determined solely by the mesh design parameters $T$, $r$, and the layer index $j$.\n\n**4. Final Output Computations**\n\nBased on these derivations, we can formulate the algorithm for the required outputs.\n\n- **Top-of-mesh wall coordinate $y^+_{\\text{top}}$**: This is $y_N^+$, which is constant across all stations.\n$$y^+_{\\text{top}} = y_N^+ = \\begin{cases} T \\frac{r^N - 1}{r - 1}  \\text{if } r \\neq 1 \\\\ N \\cdot T  \\text{if } r = 1 \\end{cases}$$\n\n- **Maximum physical top-of-mesh height**: The physical height at each station is $y_N(x_i) = y_{\\text{top}}(x_i) = y_N^+ \\nu / u_\\tau(x_i)$. This height is maximized when the denominator, $u_\\tau(x_i)$, is minimized.\n$$\\text{max\\_physical\\_top\\_height} = \\frac{y_N^+ \\nu}{\\min_i\\{u_\\tau(x_i)\\}}$$\n\n- **Boolean `fits_boolean`**: For the mesh to \"fit\" within the boundary layer at every station, the condition $y_N(x_i) \\le \\delta(x_i)$ must hold for all stations $i$. This is equivalent to checking if $y_N^+ \\nu / u_\\tau(x_i) \\le \\delta(x_i)$ for all $i$.\n\n- **List of first three $y^+$ coordinates**: This is a direct application of the derived formula for $y_j^+$. The list is $[y_1^+, y_2^+, y_3^+]$, provided $N \\ge 3$. If $N  3$, the list is truncated accordingly. For example, for $j=1,2,3$:\n  - $y_1^+ = T$\n  - $y_2^+ = T(r+1)$ (if $r \\neq 1$) or $2T$ (if $r=1$)\n  - $y_3^+ = T(r^2+r+1)$ (if $r \\neq 1$) or $3T$ (if $r=1$)", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the CFD near-wall mesh design problem for a suite of test cases.\n    \"\"\"\n    # Test cases as defined in the problem statement.\n    test_cases = [\n        {\n            \"nu\": 1.5e-5,\n            \"N\": 40,\n            \"r\": 1.2,\n            \"T\": 0.8,\n            \"u_tau\": [0.35, 0.32, 0.29, 0.31, 0.33],\n            \"delta\": [0.025, 0.028, 0.030, 0.029, 0.027],\n        },\n        {\n            \"nu\": 1.0e-6,\n            \"N\": 10,\n            \"r\": 1.0,\n            \"T\": 1.5,\n            \"u_tau\": [0.05, 0.05, 0.05],\n            \"delta\": [0.008, 0.008, 0.008],\n        },\n        {\n            \"nu\": 1.5e-5,\n            \"N\": 100,\n            \"r\": 1.05,\n            \"T\": 1.0,\n            \"u_tau\": [0.10, 0.08, 0.05, 0.03],\n            \"delta\": [0.015, 0.013, 0.010, 0.008],\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        nu = case[\"nu\"]\n        N = case[\"N\"]\n        r = case[\"r\"]\n        T = case[\"T\"]\n        u_tau_array = np.array(case[\"u_tau\"])\n        delta_array = np.array(case[\"delta\"])\n\n        # 1. Compute the top-of-mesh wall coordinate, y_plus_top.\n        # This value is independent of the local station properties.\n        if r == 1.0:\n            y_plus_top = N * T\n        else:\n            y_plus_top = T * (r**N - 1) / (r - 1)\n\n        # 2. Compute the physical top-of-mesh height at each station.\n        # This height is y_N(x_i) = (y_plus_top * nu) / u_tau(x_i).\n        physical_top_heights = y_plus_top * nu / u_tau_array\n        \n        # Find the maximum physical top-of-mesh height across all stations.\n        max_physical_top_height_in_m = np.max(physical_top_heights)\n\n        # 3. Check if the physical top-of-mesh height is within the local\n        # boundary-layer thickness at every station.\n        fits_boolean = bool(np.all(physical_top_heights = delta_array))\n\n        # 4. Compute the first three cumulative interface coordinates in y+.\n        # These are also independent of local station properties.\n        # The list size is min(N, 3).\n        y_plus_interfaces = []\n        for j in range(1, min(N, 3) + 1):\n            if r == 1.0:\n                y_plus_j = j * T\n            else:\n                y_plus_j = T * (r**j - 1) / (r - 1)\n            y_plus_interfaces.append(y_plus_j)\n\n        # Assemble the final result for the current test case.\n        result_k = [\n            y_plus_top,\n            max_physical_top_height_in_m,\n            fits_boolean,\n            y_plus_interfaces,\n        ]\n        results.append(result_k)\n\n    # Format the final output string as specified.\n    # The str() function on a list correctly formats it as '[...]'\n    # which is then joined by commas.\n    output_str = f\"[{','.join(map(str, results))}]\"\n    print(output_str)\n\nsolve()\n```", "id": "3390342"}]}