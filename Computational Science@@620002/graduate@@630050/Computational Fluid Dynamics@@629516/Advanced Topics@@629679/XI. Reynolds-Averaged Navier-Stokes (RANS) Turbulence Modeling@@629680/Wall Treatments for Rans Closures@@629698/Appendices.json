{"hands_on_practices": [{"introduction": "The foundation of high-Reynolds-number wall treatments lies in bridging the unresolved near-wall region with an algebraic model. This first practice guides you through the essential implementation of an equilibrium wall function, where you will numerically solve the classic law-of-the-wall equation to determine the friction velocity $u_{\\tau}$. From this crucial parameter, you will then compute the wall shear stress and the boundary conditions for the turbulent kinetic energy and its dissipation rate, a core task in many RANS solvers. [@problem_id:3391064]", "problem": "You are asked to implement an equilibrium wall-function evaluator for Reynolds-Averaged Navier–Stokes (RANS) closures at the first off-wall point in a fully turbulent boundary layer. The model base must consist only of well-tested relationships used in Computational Fluid Dynamics (CFD) wall treatments. Use the following definitions and empirical relations as the foundational base:\n\n- Reynolds-Averaged Navier–Stokes (RANS): A turbulence modeling approach in which the instantaneous flow variables are decomposed into mean and fluctuating parts, and the time-averaged equations are closed with a turbulence model.\n- Friction velocity $u_{\\tau}$ is defined by $u_{\\tau} = \\sqrt{\\tau_w/\\rho}$, where $\\tau_w$ is the wall shear stress and $\\rho$ is the fluid density.\n- The law-of-the-wall for the mean velocity in the equilibrium logarithmic region is given by\n  $$U^+ = \\frac{1}{\\kappa}\\ln\\left(y^+\\right) + B,$$\n  where $U^+ = U_P/u_{\\tau}$, $y^+ = u_{\\tau} y_P/\\nu$, $\\kappa$ is the von Kármán constant, $B$ is the additive constant, $U_P$ is the mean velocity at the wall-adjacent point $P$, $y_P$ is the normal distance of point $P$ from the wall, and $\\nu$ is the kinematic viscosity. Use the natural logarithm.\n- In the high-Reynolds-number equilibrium wall-function framework for the $k$–$\\varepsilon$ model, impose the near-wall values at the first off-wall cell center as\n  $$k_P = \\frac{u_{\\tau}^2}{\\sqrt{C_{\\mu}}},\\qquad \\epsilon_P = \\frac{u_{\\tau}^3}{\\kappa\\, y_P},$$\n  where $k_P$ is the turbulent kinetic energy at point $P$, $\\epsilon_P$ is the rate of dissipation of turbulent kinetic energy, and $C_{\\mu}$ is a model constant.\n\nYour task is to, for each test case, numerically invert the logarithmic law to compute the unique positive $u_{\\tau}$ that satisfies\n$$\\frac{U_P}{u_{\\tau}} = \\frac{1}{\\kappa}\\ln\\left(\\frac{u_{\\tau}\\, y_P}{\\nu}\\right) + B,$$\nand then evaluate wall shear stress $\\tau_w = \\rho\\, u_{\\tau}^2$, as well as $k_P$ and $\\epsilon_P$ using the relations above.\n\nAssumptions and constants:\n- Use $\\kappa = 0.41$ and $B = 5.2$.\n- Use $C_{\\mu} = 0.09$.\n- Use only physically meaningful inputs: $U_P > 0$, $y_P > 0$, $\\nu > 0$, $\\rho > 0$.\n- Use the natural logarithm base $e$.\n\nNumerical requirements:\n- Solve for $u_{\\tau}$ by root-finding a well-posed scalar equation that is strictly monotone in $u_{\\tau} > 0$. Use a robust bracketing method to ensure convergence for all test cases. The solution must be computed to a tight tolerance such that the final reported values are accurate to at least six decimal places.\n\nUnits and output:\n- All inputs are in the International System of Units (SI). The required outputs are:\n  - $u_{\\tau}$ in $\\mathrm{m/s}$,\n  - $\\tau_w$ in $\\mathrm{Pa}$,\n  - $k_P$ in $\\mathrm{m^2/s^2}$,\n  - $\\epsilon_P$ in $\\mathrm{m^2/s^3}$.\n- Express each output value as a decimal rounded to exactly six digits after the decimal point.\n\nTest suite:\n- Use $\\kappa = 0.41$, $B = 5.2$, and $C_{\\mu} = 0.09$ for all cases.\n- Case $1$: $U_P = 5\\,\\mathrm{m/s}$, $y_P = 0.5\\times 10^{-3}\\,\\mathrm{m}$, $\\nu = 1.0\\times 10^{-5}\\,\\mathrm{m^2/s}$, $\\rho = 1.225\\,\\mathrm{kg/m^3}$.\n- Case $2$: $U_P = 10\\,\\mathrm{m/s}$, $y_P = 1.0\\times 10^{-3}\\,\\mathrm{m}$, $\\nu = 1.5\\times 10^{-5}\\,\\mathrm{m^2/s}$, $\\rho = 1.225\\,\\mathrm{kg/m^3}$.\n- Case $3$: $U_P = 2\\,\\mathrm{m/s}$, $y_P = 2.0\\times 10^{-4}\\,\\mathrm{m}$, $\\nu = 1.0\\times 10^{-6}\\,\\mathrm{m^2/s}$, $\\rho = 1000.0\\,\\mathrm{kg/m^3}$.\n- Case $4$: $U_P = 50\\,\\mathrm{m/s}$, $y_P = 2.0\\times 10^{-3}\\,\\mathrm{m}$, $\\nu = 1.5\\times 10^{-5}\\,\\mathrm{m^2/s}$, $\\rho = 1.225\\,\\mathrm{kg/m^3}$.\n\nProgram specification:\n- Your program must compute, for each case, the quadruple $[\\,u_{\\tau}, \\tau_w, k_P, \\epsilon_P\\,]$ in the order shown, with the units specified above and each value rounded to exactly six digits after the decimal point.\n- Your program should produce a single line of output containing the results as a comma-separated list of case results, each case result being its own bracketed comma-separated list, with no spaces. For example: $\\texttt{[[a\\_1,b\\_1,c\\_1,d\\_1],[a\\_2,b\\_2,c\\_2,d\\_2],\\ldots]}$.", "solution": "The problem requires the implementation of an equilibrium wall-function evaluator for Reynolds-Averaged Navier–Stokes (RANS) computational fluid dynamics (CFD). The core of the task is to determine the friction velocity, $u_{\\tau}$, by numerically solving the law-of-the-wall equation, and subsequently using this value to compute the wall shear stress, $\\tau_w$, and the near-wall values of turbulent kinetic energy, $k_P$, and its dissipation rate, $\\epsilon_P$.\n\nThe fundamental relationship to be solved is the logarithmic law of the wall, an algebraic equation relating the mean velocity $U_P$ at a distance $y_P$ from the wall to the friction velocity $u_{\\tau}$:\n$$ \\frac{U_P}{u_{\\tau}} = \\frac{1}{\\kappa}\\ln\\left(\\frac{u_{\\tau}\\, y_P}{\\nu}\\right) + B $$\nHere, $\\kappa$ is the von Kármán constant, $B$ is the log-layer additive constant, and $\\nu$ is the kinematic viscosity of the fluid. This is a transcendental equation for the unknown $u_{\\tau}$.\n\nTo solve this equation numerically, we define a function $f(u_{\\tau})$ whose root corresponds to the solution. The function is formulated by rearranging the equation:\n$$ f(u_{\\tau}) = \\frac{U_P}{u_{\\tau}} - \\frac{1}{\\kappa}\\ln\\left(\\frac{u_{\\tau}\\, y_P}{\\nu}\\right) - B $$\nWe seek the value of $u_{\\tau} > 0$ such that $f(u_{\\tau}) = 0$. The physical constraints are $U_P > 0$, $y_P > 0$, $\\nu > 0$, $\\kappa > 0$, and the desired solution $u_{\\tau}$ must also be positive.\n\nTo ensure that a unique solution exists and to inform the choice of a numerical solver, we analyze the properties of $f(u_{\\tau})$ on its domain $u_{\\tau} \\in (0, \\infty)$. We first compute the derivative of $f(u_{\\tau})$ with respect to $u_{\\tau}$:\n$$ f'(u_{\\tau}) = \\frac{d}{du_{\\tau}}\\left( U_P u_{\\tau}^{-1} - \\frac{1}{\\kappa}\\ln(u_{\\tau}) - \\frac{1}{\\kappa}\\ln\\left(\\frac{y_P}{\\nu}\\right) - B \\right) $$\n$$ f'(u_{\\tau}) = -U_P u_{\\tau}^{-2} - \\frac{1}{\\kappa u_{\\tau}} $$\nSince $U_P$, $\\kappa$, and $u_{\\tau}$ are all positive, both terms in the derivative are negative. Thus, $f'(u_{\\tau})  0$ for all $u_{\\tau} > 0$. This proves that $f(u_{\\tau})$ is a strictly monotonically decreasing function over its entire domain.\n\nNext, we examine the behavior of $f(u_{\\tau})$ at the limits of its domain:\n- As $u_{\\tau} \\to 0^+$, the term $U_P/u_{\\tau} \\to +\\infty$ and the term $-\\frac{1}{\\kappa}\\ln(u_{\\tau}) \\to +\\infty$. Therefore, $\\lim_{u_{\\tau} \\to 0^+} f(u_{\\tau}) = +\\infty$.\n- As $u_{\\tau} \\to \\infty$, the term $U_P/u_{\\tau} \\to 0$ and the term $-\\frac{1}{\\kappa}\\ln(u_{\\tau}) \\to -\\infty$. Therefore, $\\lim_{u_{\\tau} \\to \\infty} f(u_{\\tau}) = -\\infty$.\n\nBecause $f(u_{\\tau})$ is continuous and strictly decreases from $+\\infty$ to $-\\infty$ over the interval $(0, \\infty)$, the Intermediate Value Theorem guarantees that there is one and only one positive root $u_{\\tau}$ that satisfies $f(u_{\\tau}) = 0$.\n\nThis well-posed nature of the problem allows the use of a robust root-finding algorithm, such as a bracketing method (e.g., bisection or Brent's method). Such a method requires an initial interval $[a, b]$ where $f(a)$ and $f(b)$ have opposite signs. Based on our analysis:\n- We can choose a very small positive number for the lower bound, $a$, (e.g., $a=10^{-9}$), which ensures $f(a) > 0$.\n- For the upper bound, $b$, a value of $b=U_P$ is a reasonable choice, as $u_{\\tau}$ is physically expected to be smaller than the local velocity $U_P$. For this choice, $f(U_P) = 1 - B - \\frac{1}{\\kappa}\\ln\\left(\\frac{U_P y_P}{\\nu}\\right)$. With the given constants ($B=5.2$), this value is negative for all provided test cases.\nThus, the interval $[10^{-9}, U_P]$ provides a reliable bracket for the solver. The implementation will use the `scipy.optimize.brentq` function, which is an efficient and robust implementation of a bracketing root-finding algorithm.\n\nOnce the solver finds the unique value of $u_{\\tau}$ for a given test case, the remaining quantities are calculated using the provided formulae:\n- The wall shear stress, $\\tau_w$, is computed from the definition of friction velocity, $u_{\\tau} = \\sqrt{\\tau_w/\\rho}$:\n$$ \\tau_w = \\rho\\, u_{\\tau}^2 $$\n- The turbulent kinetic energy, $k_P$, is determined by the standard equilibrium relation:\n$$ k_P = \\frac{u_{\\tau}^2}{\\sqrt{C_{\\mu}}} $$\n- The turbulent kinetic energy dissipation rate, $\\epsilon_P$, is found using its corresponding equilibrium relation:\n$$ \\epsilon_P = \\frac{u_{\\tau}^3}{\\kappa\\, y_P} $$\n\nThis procedure is systematically applied to each test case, using the specified constants $\\kappa = 0.41$, $B = 5.2$, and $C_{\\mu} = 0.09$. All calculations are performed in SI units, and the final results are rounded to exactly six decimal places as required.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Computes wall-function derived quantities for a series of test cases.\n    For each case, it numerically solves for the friction velocity u_tau and then\n    calculates wall shear stress (tau_w), turbulent kinetic energy (k_p),\n    and turbulent dissipation rate (epsilon_p).\n    \"\"\"\n\n    # Define the constants from the problem statement.\n    KAPPA = 0.41  # von Kármán constant\n    B = 5.2       # Log-law additive constant\n    C_MU = 0.09   # k-epsilon model constant\n\n    # Define the test cases from the problem statement as a list of tuples.\n    # Each tuple contains: (U_P, y_P, nu, rho)\n    test_cases = [\n        (5.0, 0.5e-3, 1.0e-5, 1.225),   # Case 1\n        (10.0, 1.0e-3, 1.5e-5, 1.225),  # Case 2\n        (2.0, 2.0e-4, 1.0e-6, 1000.0),  # Case 3\n        (50.0, 2.0e-3, 1.5e-5, 1.225),  # Case 4\n    ]\n\n    all_results_formatted = []\n    TOLERANCE = 1e-14 # High precision for the root-finder\n\n    for case in test_cases:\n        Up, yp, nu, rho = case\n\n        # Define the function for root-finding. We seek the root u_tau of f(u_tau) = 0.\n        # The equation is: U_P/u_tau = (1/kappa)*ln(u_tau*y_P/nu) + B\n        # Rearranged for root-finding: f(u_tau) = U_P/u_tau - ((1/kappa)*ln(u_tau*y_P/nu) + B)\n        def root_func(u_tau):\n            # The argument to the logarithm, y_plus, must be positive.\n            # Since y_P > 0 and nu > 0, this requires u_tau > 0.\n            if u_tau = 0:\n                # Return a large number to guide the solver away from non-physical values.\n                return np.inf\n            y_plus = u_tau * yp / nu\n            return Up / u_tau - ((1.0 / KAPPA) * np.log(y_plus) + B)\n\n        # A robust bracket for the root-finding algorithm.\n        # The function is strictly decreasing for u_tau > 0.\n        # As u_tau -> 0+, f(u_tau) -> +inf.\n        # As u_tau -> inf, f(u_tau) -> -inf.\n        # Lower bound `a` can be a small positive number.\n        # Upper bound `b` can be U_P, for which f(b) is negative for these cases.\n        a = 1e-9\n        b = Up\n        \n        # Solve for u_tau using Brent's method for robustness and efficiency.\n        u_tau_sol = brentq(root_func, a, b, xtol=TOLERANCE, rtol=TOLERANCE)\n\n        # Calculate the derived quantities using the solved u_tau.\n        # 1. Wall shear stress\n        tau_w_sol = rho * u_tau_sol**2\n        \n        # 2. Turbulent kinetic energy at point P\n        k_p_sol = u_tau_sol**2 / np.sqrt(C_MU)\n        \n        # 3. Turbulent dissipation rate at point P\n        epsilon_p_sol = u_tau_sol**3 / (KAPPA * yp)\n        \n        # Collect the results for the current case.\n        case_results = [u_tau_sol, tau_w_sol, k_p_sol, epsilon_p_sol]\n\n        # Format each value to exactly six decimal places.\n        formatted_quad = [f\"{val:.6f}\" for val in case_results]\n        all_results_formatted.append(f\"[{','.join(formatted_quad)}]\")\n    \n    # Final print statement in the exact required format.\n    # The output is a single line: [[...],[...],...]\n    print(f\"[{','.join(all_results_formatted)}]\")\n\nsolve()\n```", "id": "3391064"}, {"introduction": "A model is only as good as the assumptions it rests upon, and wall functions are no exception. This exercise is a critical thought experiment designed to demonstrate the limitations of the standard logarithmic wall function by probing its behavior outside its intended range of applicability. By synthetically creating data in the viscous sublayer and then processing it with the log-law, you will quantify the error introduced and gain a deeper appreciation for the critical role of the dimensionless wall distance $y^+$ in mesh design. [@problem_id:3391066]", "problem": "Consider a one-dimensional wall-normal discretization for a statistically steady, fully developed turbulent flow near a solid wall, modeled with Reynolds-Averaged Navier-Stokes (RANS) closures. The first cell center is located at a distance $y_1$ from the wall, with uniform cell thickness $\\Delta y$, so that $y_1 = \\Delta y/2$. Let the fluid be Newtonian with constant density $\\rho$ and kinematic viscosity $\\nu$, and let the friction velocity be $u_\\tau = \\sqrt{\\tau_w/\\rho}$, where $\\tau_w$ is the wall shear stress. Define the inner scaling variables $y^+ = y u_\\tau/\\nu$ and $U^+ = U/u_\\tau$, where $U$ is the mean streamwise velocity.\n\nAs a well-tested physical fact, in the viscous sublayer the mean velocity satisfies $U^+ \\approx y^+$, and in the logarithmic layer it satisfies $U^+ \\approx \\frac{1}{\\kappa} \\ln(y^+) + B$, where $\\kappa$ is the von Kármán constant and $B$ is an empirical intercept. Standard wall functions in many RANS closures impose the logarithmic relationship at the first off-wall point to infer the wall shear stress.\n\nYour task is to demonstrate, using a purely mathematical and algorithmic construction based on the above definitions and facts, the inconsistency introduced by placing the first node at $y^+ \\approx 5$ when a standard wall function (logarithmic law of the wall) is used, and to estimate the resulting error in $\\tau_w$. Proceed as follows for each test case:\n\n1. Take $(\\rho,\\nu,u_\\tau)$ as given constants. For a prescribed target $y_1^+$, construct a grid with $\\Delta y$ such that $y_1 = \\Delta y/2$ and $y_1^+ = y_1 u_\\tau/\\nu$ equals the target. This implies $\\Delta y = 2 y_1$ and $y_1 = \\dfrac{y_1^+ \\, \\nu}{u_\\tau}$.\n2. Generate a synthetic \"true\" mean velocity $U$ at $y_1$ consistent with the following reference near-wall behavior:\n   - If $y_1^+ \\leq 5$, use the viscous sublayer relation $U^+ = y^+$ to set $U = u_\\tau \\, y_1^+$.\n   - If $y_1^+ \\geq 30$, use the logarithmic relation $U^+ = \\dfrac{1}{\\kappa} \\ln(y_1^+) + B$ to set $U = u_\\tau \\left(\\dfrac{1}{\\kappa} \\ln(y_1^+) + B\\right)$.\n   - The transitional regime between $5  y^+  30$ is not used in the test suite, so no additional modeling is required.\n3. Emulate a standard wall-function inference of the wall shear stress by inverting the logarithmic relation at $y_1$ to estimate an \"inferred\" friction velocity $\\hat{u}_\\tau$ from $U$, namely solve for $\\hat{u}_\\tau$ in the nonlinear equation\n   $$ \\frac{U}{\\hat{u}_\\tau} = \\frac{1}{\\kappa} \\ln\\left(\\frac{y_1 \\hat{u}_\\tau}{\\nu}\\right) + B. $$\n   Then compute the inferred wall shear stress $\\hat{\\tau}_w = \\rho \\, \\hat{u}_\\tau^2$.\n4. Compute the true wall shear stress $\\tau_w = \\rho \\, u_\\tau^2$ and the relative error\n   $$ e = \\frac{\\hat{\\tau}_w - \\tau_w}{\\tau_w}. $$\n   Report $e$ as a decimal number.\n\nUse the constants $\\rho = 1000$ (in $\\mathrm{kg/m^3}$), $\\nu = 10^{-6}$ (in $\\mathrm{m^2/s}$), $u_\\tau = 0.2$ (in $\\mathrm{m/s}$), $\\kappa = 0.41$, and $B = 5.2$. Construct the following four test cases by prescribing $y_1^+$ targets:\n- Case A (deep viscous sublayer): $y_1^+ = 0.5$.\n- Case B (near the viscous-log transition): $y_1^+ = 5$.\n- Case C (entry to the logarithmic layer): $y_1^+ = 30$.\n- Case D (well within the logarithmic layer): $y_1^+ = 100$.\n\nFor each case, perform the steps above and compute the relative error $e$ (dimensionless). Your program should produce a single line of output containing the four relative errors as a comma-separated list enclosed in square brackets, with each value rounded to six decimal places, for example \"$[e_A,e_B,e_C,e_D]$\". No other text or formatting should be printed. All intermediate quantities using physical units should be kept internally consistent with the specified units, and the wall shear stress $\\tau_w$ is in $\\mathrm{Pa}$; the reported relative error $e$ is dimensionless and must be expressed as a decimal number.", "solution": "The objective is to quantify the inconsistency introduced when the first near-wall node is located at $y^+ \\approx 5$ yet a standard wall function based on the logarithmic law is imposed to infer the wall shear stress. We begin from fundamental definitions and well-tested facts for near-wall turbulent flows.\n\nFirst, define the friction velocity $u_\\tau$ from the wall shear stress $\\tau_w$ as $u_\\tau = \\sqrt{\\tau_w/\\rho}$. Introduce wall units via the inner scaling $y^+ = y \\, u_\\tau/\\nu$ and $U^+ = U/u_\\tau$. In a statistically steady, fully developed turbulent flow near a wall, the mean momentum equation simplifies in the immediate vicinity of the wall because the Reynolds shear stress is negligible compared to the viscous stress. Therefore, the total stress is approximately viscous, with $\\tau \\approx \\mu \\, \\dfrac{dU}{dy}$, where $\\mu = \\rho \\nu$ is the dynamic viscosity. Integrating this near-wall behavior yields the well-tested viscous sublayer relation $U^+ \\approx y^+$ for $y^+ \\lesssim 5$.\n\nAway from the wall, empirical and theoretical arguments using mixing-length closures (a widely accepted basis in Reynolds-Averaged Navier-Stokes modeling) lead to the logarithmic law of the wall in the equilibrium region of the boundary layer, $U^+ \\approx \\dfrac{1}{\\kappa}\\ln(y^+) + B$ for $y^+ \\gtrsim 30$, where $\\kappa$ is the von Kármán constant and $B$ is an empirical intercept. These two well-tested facts form the foundation for many computational fluid dynamics wall treatments.\n\nA typical \"standard wall function\" imposes the logarithmic relation at the first off-wall point to infer $u_\\tau$ (and hence $\\tau_w$) from the computed mean velocity $U$ at distance $y_1$ from the wall. The friction velocity $u_\\tau$ controls the inner scaling $y^+$ itself, which implies a nonlinearity when solving for $u_\\tau$ given $U$ and $y_1$. If the first node lies in the viscous sublayer, replacing the linear relation with the logarithmic one produces an inconsistency. We quantify it by comparing the \"true\" wall shear stress, computed from a consistent near-wall relation, with the \"inferred\" wall shear stress obtained by inverting the logarithmic law.\n\nAlgorithmic steps grounded in these principles:\n\n1. Fix physical constants $\\rho$, $\\nu$, $\\kappa$, $B$, and a \"true\" friction velocity $u_\\tau$ that characterizes the target flow. The true wall shear stress is $\\tau_w = \\rho \\, u_\\tau^2$.\n2. For each target $y_1^+$, compute the grid spacing so that the first cell center is at $y_1 = \\dfrac{y_1^+ \\, \\nu}{u_\\tau}$ and $\\Delta y = 2 y_1$ as per a one-dimensional wall-normal discretization with uniform cells.\n3. Generate a synthetic \"true\" mean velocity $U$ at $y_1$ by selecting the appropriate near-wall relation consistent with the known $u_\\tau$:\n   - If $y_1^+ \\leq 5$, use the viscous sublayer: $U^+ = y_1^+ \\Rightarrow U = u_\\tau \\, y_1^+$.\n   - If $y_1^+ \\geq 30$, use the logarithmic law: $U^+ = \\dfrac{1}{\\kappa}\\ln(y_1^+) + B \\Rightarrow U = u_\\tau\\left(\\dfrac{1}{\\kappa}\\ln(y_1^+) + B\\right)$.\n4. Emulate the standard wall function by solving for an inferred friction velocity $\\hat{u}_\\tau$ from the logarithmic relation imposed at $y_1$. The equation to solve is\n   $$ g(\\hat{u}_\\tau) = \\frac{U}{\\hat{u}_\\tau} - \\left[\\frac{1}{\\kappa} \\ln\\left(\\frac{y_1 \\hat{u}_\\tau}{\\nu}\\right) + B\\right] = 0, $$\n   which is well-posed for $\\hat{u}_\\tau > 0$ since the first term decreases with increasing $\\hat{u}_\\tau$ and the second term increases logarithmically, ensuring a unique root. A robust numerical method such as the Brent bracketing method can be used to find the root in a wide interval (for instance, between a small positive lower bound and a large upper bound) because $g$ exhibits a sign change over such a range for physically plausible inputs.\n5. Compute the inferred wall shear stress $\\hat{\\tau}_w = \\rho \\, \\hat{u}_\\tau^2$ and the relative error\n   $$ e = \\frac{\\hat{\\tau}_w - \\tau_w}{\\tau_w}. $$\n   This error is dimensionless and directly quantifies the inconsistency introduced by using the log-law at the first node.\n6. Apply this procedure to the four test cases designed to probe distinct regions:\n   - $y_1^+ = 0.5$ (deep viscous sublayer, expected large inconsistency),\n   - $y_1^+ = 5$ (near the transition, the case of interest),\n   - $y_1^+ = 30$ (entry to the logarithmic region, consistency expected),\n   - $y_1^+ = 100$ (well within the logarithmic region, consistency expected).\n7. Report the errors $e$ as a list of four decimal numbers rounded to six decimal places, in the specified single-line format.\n\nScientific interpretation: For $y_1^+ \\leq 5$, the true $U^+$ grows linearly with $y^+$, while the logarithmic law grows only as the logarithm. When one inverts the logarithmic relation using a velocity that is actually consistent with the linear law at the same location, the inferred $\\hat{u}_\\tau$ decreases relative to the true $u_\\tau$ to reconcile the larger observed $U/u_\\tau$ with the logarithmic expression, resulting in a substantial underprediction of $\\hat{\\tau}_w$. Conversely, for $y_1^+ \\geq 30$, if $U$ is consistent with the logarithmic law, inverting the same law reproduces the correct $u_\\tau$ and thus yields negligible error in $\\tau_w$. This demonstrates the inconsistency of placing the first node too close to the wall when standard wall functions are used.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    # Physical and model constants (units: rho [kg/m^3], nu [m^2/s], u_tau [m/s])\n    rho = 1000.0\n    nu = 1e-6\n    u_tau_true = 0.2\n    kappa = 0.41\n    B = 5.2\n\n    # Test cases specified by target y1^+ values\n    yplus_targets = [0.5, 5.0, 30.0, 100.0]\n\n    def U_true_at_y1(yplus):\n        \"\"\"\n        Compute synthetic 'true' mean velocity U at y1 for a given yplus = y1^+,\n        using viscous sublayer for yplus = 5, and log-law for yplus = 30.\n        \"\"\"\n        if yplus = 5.0:\n            # Viscous sublayer: U+ = y+\n            return u_tau_true * yplus\n        else:\n            # Log-law: U+ = (1/kappa) ln(y+) + B\n            return u_tau_true * ((1.0 / kappa) * np.log(yplus) + B)\n\n    def infer_u_tau_from_log(U, y1):\n        \"\"\"\n        Infer friction velocity u_tau by inverting the log-law at y1:\n            U/u = (1/kappa) ln(y1 * u / nu) + B\n        Solve g(u) = 0 with a robust bracket.\n        \"\"\"\n        def g(u):\n            return U / u - ((1.0 / kappa) * np.log(y1 * u / nu) + B)\n\n        # Use a wide bracket to ensure a sign change for physically plausible U, y1\n        lower = 1e-8\n        upper = 1e4\n        # Ensure the function is defined in the bracket\n        return brentq(g, lower, upper, maxiter=200, xtol=1e-12)\n\n    results = []\n    for yplus_target in yplus_targets:\n        # Construct grid: y1 = yplus_target * nu / u_tau_true\n        y1 = yplus_target * nu / u_tau_true\n        # Synthetic \"true\" velocity at y1\n        U = U_true_at_y1(yplus_target)\n        # Inferred friction velocity from standard wall function (log-law)\n        u_tau_inferred = infer_u_tau_from_log(U, y1)\n        # Compute wall shear stresses\n        tau_w_true = rho * (u_tau_true ** 2)\n        tau_w_inferred = rho * (u_tau_inferred ** 2)\n        # Relative error as a decimal number\n        error = (tau_w_inferred - tau_w_true) / tau_w_true\n        results.append(error)\n\n    # Final print statement in the exact required format, rounded to six decimals.\n    print(f\"[{','.join(f'{e:.6f}' for e in results)}]\")\n\nsolve()\n```", "id": "3391066"}, {"introduction": "Beyond implementation, a deeper understanding of any model involves analyzing its sensitivity to input parameters and errors. This final practice moves from numerical computation to analytical derivation, tasking you with performing a first-order perturbation analysis on the equilibrium wall function framework. You will determine how a small error in the friction velocity $u_{\\tau}$ propagates to key engineering quantities like skin-friction and, by extension, to the analogous scalar wall functions for heat and mass transfer. [@problem_id:3391087]", "problem": "Consider a steady, fully turbulent boundary layer in the local equilibrium log layer modeled by Reynolds-Averaged Navier–Stokes (RANS) closures with standard equilibrium wall functions for both momentum and scalar transport. Let the friction velocity be $u_{\\tau}$ and suppose the solver employs a friction velocity that is perturbed by a small amount $\\delta u_{\\tau}$, with $|\\delta u_{\\tau}| \\ll u_{\\tau}$. Assume the following:\n\n- The skin-friction coefficient is defined by $C_{f} \\equiv 2 \\left( \\frac{u_{\\tau}}{U_{\\mathrm{ref}}} \\right)^{2}$, where $U_{\\mathrm{ref}}$ is a fixed reference speed.\n- The fluid properties $\\rho$, $\\mu$, and $c_{p}$ are constant, and the sampling point for the wall function is located at a fixed wall-normal distance $y_{p}$ within the logarithmic region.\n- The dimensionless wall distance is $y_{p}^{+} \\equiv \\frac{\\rho\\,u_{\\tau}\\,y_{p}}{\\mu}$.\n- The equilibrium scalar wall functions for temperature and concentration are\n  - Temperature: $T^{+} \\equiv \\frac{T_{w}-T}{T_{\\tau}} = \\frac{1}{\\kappa_{t}} \\ln(y_{p}^{+}) + B_{t}$, with $T_{\\tau} \\equiv \\frac{q_{w}}{\\rho\\,c_{p}\\,u_{\\tau}}$ and $q_{w} = h\\,(T_{w}-T_{p})$.\n  - Concentration: $C^{+} \\equiv \\frac{Y_{w}-Y}{C_{\\tau}} = \\frac{1}{\\kappa_{c}} \\ln(y_{p}^{+}) + B_{c}$, with $C_{\\tau} \\equiv \\frac{j_{w}}{\\rho\\,u_{\\tau}}$ and $j_{w} = k_{m}\\,(Y_{w}-Y_{p})$.\n- The constants $\\kappa_{t}$, $B_{t}$ and $\\kappa_{c}$, $B_{c}$ are model parameters for the scalar wall functions and are independent of $u_{\\tau}$ at the operating condition considered.\n- The quantities $U_{\\mathrm{ref}}$, $T_{w}-T_{p}$, $Y_{w}-Y_{p}$, $y_{p}$, $\\rho$, $\\mu$, and $c_{p}$ are held fixed when assessing the effect of the perturbation $\\delta u_{\\tau}$.\n\nStarting from the above definitions and the log-layer wall-function framework, propagate the perturbation $\\delta u_{\\tau}$ to first order and derive the resulting first-order relative errors in the skin-friction coefficient $C_{f}$, the heat transfer coefficient $h$, and the mass transfer coefficient $k_{m}$. Express your final results in terms of $u_{\\tau}$, $\\delta u_{\\tau}$, $\\rho$, $\\mu$, $y_{p}$, $\\kappa_{t}$, $B_{t}$, $\\kappa_{c}$, and $B_{c}$ only. Give your answer as a single row matrix in the order $\\left[\\frac{\\delta C_{f}}{C_{f}},\\ \\frac{\\delta h}{h},\\ \\frac{\\delta k_{m}}{k_{m}}\\right]$. No numerical evaluation is required. Do not include units in your final answer.", "solution": "The problem requires the derivation of the first-order relative errors in the skin-friction coefficient $C_{f}$, the heat transfer coefficient $h$, and the mass transfer coefficient $k_{m}$ resulting from a small perturbation $\\delta u_{\\tau}$ in the friction velocity $u_{\\tau}$. The analysis is based on the principle of first-order Taylor expansion. For a quantity $Q$ that is a function of $u_{\\tau}$, $Q = Q(u_{\\tau})$, a small perturbation $\\delta u_{\\tau}$ leads to a perturbation $\\delta Q$ in $Q$ given by:\n$$ \\delta Q \\approx \\frac{dQ}{du_{\\tau}} \\delta u_{\\tau} $$\nThe relative error is then:\n$$ \\frac{\\delta Q}{Q} \\approx \\frac{1}{Q} \\frac{dQ}{du_{\\tau}} \\delta u_{\\tau} $$\nA convenient method to calculate this is logarithmic differentiation, where the relative error is given by:\n$$ \\frac{\\delta Q}{Q} \\approx \\left( \\frac{d(\\ln Q)}{du_{\\tau}} \\right) \\delta u_{\\tau} $$\nWe will apply this procedure to $C_{f}$, $h$, and $k_{m}$ sequentially.\n\nFirst, we analyze the skin-friction coefficient, $C_{f}$.\nThe definition of $C_{f}$ is given as:\n$$ C_{f} = 2 \\left( \\frac{u_{\\tau}}{U_{\\mathrm{ref}}} \\right)^{2} $$\nSince $U_{\\mathrm{ref}}$ is a fixed reference speed, $C_{f}$ is a function of $u_{\\tau}$ only. We compute the derivative of $C_{f}$ with respect to $u_{\\tau}$:\n$$ \\frac{dC_{f}}{du_{\\tau}} = \\frac{d}{du_{\\tau}} \\left( \\frac{2}{U_{\\mathrm{ref}}^{2}} u_{\\tau}^{2} \\right) = \\frac{2}{U_{\\mathrm{ref}}^{2}} (2 u_{\\tau}) = \\frac{4 u_{\\tau}}{U_{\\mathrm{ref}}^{2}} $$\nThe first-order perturbation $\\delta C_{f}$ is:\n$$ \\delta C_{f} = \\frac{dC_{f}}{du_{\\tau}} \\delta u_{\\tau} = \\frac{4 u_{\\tau}}{U_{\\mathrm{ref}}^{2}} \\delta u_{\\tau} $$\nThe relative error in $C_{f}$ is therefore:\n$$ \\frac{\\delta C_{f}}{C_{f}} = \\frac{\\frac{4 u_{\\tau}}{U_{\\mathrm{ref}}^{2}} \\delta u_{\\tau}}{2 \\left( \\frac{u_{\\tau}}{U_{\\mathrm{ref}}} \\right)^{2}} = \\frac{4 u_{\\tau} \\delta u_{\\tau}}{U_{\\mathrm{ref}}^{2}} \\frac{U_{\\mathrm{ref}}^{2}}{2 u_{\\tau}^{2}} = 2 \\frac{\\delta u_{\\tau}}{u_{\\tau}} $$\n\nNext, we analyze the heat transfer coefficient, $h$.\nWe first need to derive an expression for $h$ in terms of $u_{\\tau}$ and other fixed parameters. The provided relations are:\n$q_{w} = h (T_{w}-T_{p})$\n$T^{+} = \\frac{T_{w}-T_{p}}{T_{\\tau}}$ evaluated at the point $y_{p}$\n$T_{\\tau} = \\frac{q_{w}}{\\rho c_{p} u_{\\tau}}$\n$T^{+} = \\frac{1}{\\kappa_{t}} \\ln(y_{p}^{+}) + B_{t}$\n$y_{p}^{+} = \\frac{\\rho u_{\\tau} y_{p}}{\\mu}$\n\nFrom the definition of $h$, we have $h = \\frac{q_{w}}{T_{w}-T_{p}}$.\nFrom the definition of $T^{+}$, we have $T_{w}-T_{p} = T^{+} T_{\\tau}$. Substituting the expression for $T_{\\tau}$, we get:\n$$ T_{w}-T_{p} = T^{+} \\left( \\frac{q_{w}}{\\rho c_{p} u_{\\tau}} \\right) $$\nSubstituting this into the expression for $h$:\n$$ h = \\frac{q_{w}}{T^{+} \\left( \\frac{q_{w}}{\\rho c_{p} u_{\\tau}} \\right)} = \\frac{\\rho c_{p} u_{\\tau}}{T^{+}} $$\nNow, we substitute the wall-function expression for $T^{+}$ at $y_p$:\n$$ h = \\frac{\\rho c_{p} u_{\\tau}}{\\frac{1}{\\kappa_{t}} \\ln(y_{p}^{+}) + B_{t}} $$\nFinally, substituting the definition of $y_{p}^{+}$:\n$$ h(u_{\\tau}) = \\frac{\\rho c_{p} u_{\\tau}}{\\frac{1}{\\kappa_{t}} \\ln\\left(\\frac{\\rho u_{\\tau} y_{p}}{\\mu}\\right) + B_{t}} $$\nTo find the relative error, we use logarithmic differentiation. The natural logarithm of $h$ is:\n$$ \\ln(h) = \\ln(\\rho c_{p}) + \\ln(u_{\\tau}) - \\ln\\left(\\frac{1}{\\kappa_{t}} \\ln\\left(\\frac{\\rho u_{\\tau} y_{p}}{\\mu}\\right) + B_{t}\\right) $$\nDifferentiating with respect to $u_{\\tau}$ (noting that $\\rho, c_p, \\kappa_t, B_t, y_p, \\mu$ are constants):\n$$ \\frac{d(\\ln h)}{du_{\\tau}} = \\frac{1}{u_{\\tau}} - \\frac{1}{\\frac{1}{\\kappa_{t}} \\ln\\left(\\frac{\\rho u_{\\tau} y_{p}}{\\mu}\\right) + B_{t}} \\cdot \\frac{d}{du_{\\tau}}\\left(\\frac{1}{\\kappa_{t}} \\ln\\left(\\frac{\\rho u_{\\tau} y_{p}}{\\mu}\\right)\\right) $$\nThe derivative of the logarithmic term is:\n$$ \\frac{d}{du_{\\tau}}\\left(\\frac{1}{\\kappa_{t}} \\ln\\left(\\frac{\\rho u_{\\tau} y_{p}}{\\mu}\\right)\\right) = \\frac{1}{\\kappa_{t}} \\frac{1}{\\frac{\\rho u_{\\tau} y_{p}}{\\mu}} \\frac{\\rho y_{p}}{\\mu} = \\frac{1}{\\kappa_{t} u_{\\tau}} $$\nSubstituting this back:\n$$ \\frac{d(\\ln h)}{du_{\\tau}} = \\frac{1}{u_{\\tau}} - \\frac{1}{\\frac{1}{\\kappa_{t}} \\ln\\left(\\frac{\\rho u_{\\tau} y_{p}}{\\mu}\\right) + B_{t}} \\cdot \\frac{1}{\\kappa_{t} u_{\\tau}} = \\frac{1}{u_{\\tau}} \\left[ 1 - \\frac{1}{\\kappa_{t} \\left(\\frac{1}{\\kappa_{t}} \\ln\\left(\\frac{\\rho u_{\\tau} y_{p}}{\\mu}\\right) + B_{t}\\right)} \\right] $$\n$$ \\frac{d(\\ln h)}{du_{\\tau}} = \\frac{1}{u_{\\tau}} \\left[ 1 - \\frac{1}{\\ln\\left(\\frac{\\rho u_{\\tau} y_{p}}{\\mu}\\right) + \\kappa_{t} B_{t}} \\right] $$\nThe relative error $\\frac{\\delta h}{h}$ is then:\n$$ \\frac{\\delta h}{h} = \\left( \\frac{d(\\ln h)}{du_{\\tau}} \\right) \\delta u_{\\tau} = \\left( 1 - \\frac{1}{\\ln\\left(\\frac{\\rho u_{\\tau} y_{p}}{\\mu}\\right) + \\kappa_{t} B_{t}} \\right) \\frac{\\delta u_{\\tau}}{u_{\\tau}} $$\n\nFinally, we analyze the mass transfer coefficient, $k_{m}$.\nThe governing equations for mass transfer are structurally analogous to those for heat transfer:\n$j_{w} = k_{m} (Y_{w}-Y_{p})$\n$C^{+} = \\frac{Y_{w}-Y_{p}}{C_{\\tau}}$\n$C_{\\tau} = \\frac{j_{w}}{\\rho u_{\\tau}}$\n$C^{+} = \\frac{1}{\\kappa_{c}} \\ln(y_{p}^{+}) + B_{c}$\n\nFollowing the same derivation path as for $h$:\n$k_{m} = \\frac{j_{w}}{Y_{w}-Y_{p}} = \\frac{j_{w}}{C^{+} C_{\\tau}} = \\frac{j_{w}}{C^{+} \\left(\\frac{j_{w}}{\\rho u_{\\tau}}\\right)} = \\frac{\\rho u_{\\tau}}{C^{+}}$\nSubstituting the wall function for $C^{+}$:\n$$ k_{m}(u_{\\tau}) = \\frac{\\rho u_{\\tau}}{\\frac{1}{\\kappa_{c}} \\ln(y_{p}^{+}) + B_{c}} = \\frac{\\rho u_{\\tau}}{\\frac{1}{\\kappa_{c}} \\ln\\left(\\frac{\\rho u_{\\tau} y_{p}}{\\mu}\\right) + B_{c}} $$\nThis expression for $k_{m}$ is identical in form to the expression for $h$, with $c_{p}$ effectively being $1$ and the model constants $(\\kappa_t, B_t)$ replaced by $(\\kappa_c, B_c)$. The logarithmic differentiation for $\\ln(k_m)$ will yield a result of the same form.\n$$ \\ln(k_m) = \\ln(\\rho) + \\ln(u_{\\tau}) - \\ln\\left(\\frac{1}{\\kappa_{c}} \\ln\\left(\\frac{\\rho u_{\\tau} y_{p}}{\\mu}\\right) + B_{c}\\right) $$\nThe derivation is identical to that for $h$, leading to:\n$$ \\frac{d(\\ln k_m)}{du_{\\tau}} = \\frac{1}{u_{\\tau}} \\left[ 1 - \\frac{1}{\\ln\\left(\\frac{\\rho u_{\\tau} y_{p}}{\\mu}\\right) + \\kappa_{c} B_{c}} \\right] $$\nThe relative error $\\frac{\\delta k_{m}}{k_{m}}$ is:\n$$ \\frac{\\delta k_{m}}{k_{m}} = \\left( \\frac{d(\\ln k_m)}{du_{\\tau}} \\right) \\delta u_{\\tau} = \\left( 1 - \\frac{1}{\\ln\\left(\\frac{\\rho u_{\\tau} y_{p}}{\\mu}\\right) + \\kappa_{c} B_{c}} \\right) \\frac{\\delta u_{\\tau}}{u_{\\tau}} $$\n\nCombining the three results into a single row matrix as requested:\n$\\left[ \\frac{\\delta C_{f}}{C_{f}},\\ \\frac{\\delta h}{h},\\ \\frac{\\delta k_{m}}{k_{m}} \\right]$.", "answer": "$$ \\boxed{ \\begin{pmatrix} 2 \\frac{\\delta u_{\\tau}}{u_{\\tau}}  \\left( 1 - \\frac{1}{\\ln\\left(\\frac{\\rho u_{\\tau} y_{p}}{\\mu}\\right) + \\kappa_{t} B_{t}} \\right) \\frac{\\delta u_{\\tau}}{u_{\\tau}}  \\left( 1 - \\frac{1}{\\ln\\left(\\frac{\\rho u_{\\tau} y_{p}}{\\mu}\\right) + \\kappa_{c} B_{c}} \\right) \\frac{\\delta u_{\\tau}}{u_{\\tau}} \\end{pmatrix} } $$", "id": "3391087"}]}