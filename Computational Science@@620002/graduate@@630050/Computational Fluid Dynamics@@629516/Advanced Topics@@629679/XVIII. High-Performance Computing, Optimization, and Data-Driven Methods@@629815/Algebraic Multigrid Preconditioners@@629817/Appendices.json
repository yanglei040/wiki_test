{"hands_on_practices": [{"introduction": "To build a solid foundation in algebraic multigrid, we must first understand the core principle of representing a problem on a coarser grid. This exercise demystifies the construction of the coarse-grid operator, $A_c$, using the fundamental Galerkin projection, $A_c = R A P$. By working through a simple one-dimensional problem, you will explicitly construct the prolongation ($P$) and restriction ($R$) operators and see how they form a coarse-level system that preserves essential properties of the original fine-grid operator [@problem_id:3290960]. Verifying the eigenvalue interlacing property provides direct insight into why this coarse-grid representation is effective for correcting low-frequency error components.", "problem": "Consider the one-dimensional pressure Poisson equation in Computational Fluid Dynamics (CFD) given by $- \\frac{d^2 p}{dx^2} = f$ on a unit interval with homogeneous Dirichlet boundary conditions at both ends. Discretize this equation on a uniform fine grid with $3$ interior unknowns and nondimensional spacing $h = 1$ using the second-order central difference approximation. This yields a symmetric positive definite (SPD) fine-grid operator $A \\in \\mathbb{R}^{3 \\times 3}$ that is the canonical tridiagonal discrete Laplacian. In the context of Algebraic Multigrid (AMG), define a coarse grid consisting of $2$ coarse points aligned with fine points $1$ and $3$, and construct a prolongation operator $P \\in \\mathbb{R}^{3 \\times 2}$ by linear interpolation that maps coarse-grid unknowns $\\begin{pmatrix} u_{C}^{1} \\\\ u_{C}^{2} \\end{pmatrix}$ to fine-grid unknowns $\\begin{pmatrix} u_{f}^{1} \\\\ u_{f}^{2} \\\\ u_{f}^{3} \\end{pmatrix}$ via $u_{f}^{1} = u_{C}^{1}$, $u_{f}^{2} = \\frac{1}{2} u_{C}^{1} + \\frac{1}{2} u_{C}^{2}$, and $u_{f}^{3} = u_{C}^{2}$. Use the symmetric Galerkin choice of restriction $R = P^{\\top}$. Starting from the finite-difference discretization and the SPD property of the discrete Laplacian, explicitly construct $R$ and $P$, compute the coarse-grid operator $A_{c} = R A P$, and determine the spectra (sets of eigenvalues) of both $A$ and $A_{c}$. Then verify, using first principles for Ritz values of SPD matrices, that the coarse-grid eigenvalues interlace the fine-grid eigenvalues. For your final reported result, provide the two coarse-grid eigenvalues of $A_{c}$ as exact values. No rounding is needed; the answer is dimensionless because $h = 1$.", "solution": "The problem statement has been validated and is deemed self-contained, scientifically grounded, and well-posed. Although the phrasing \"first principles for Ritz values\" is technically imprecise in this context, the core task is mathematically sound and the requested verification holds true for this specific problem. We may now proceed with the solution.\n\nThe one-dimensional pressure Poisson equation is given by $- \\frac{d^2 p}{dx^2} = f$ with homogeneous Dirichlet boundary conditions. Discretizing this equation on a uniform grid with $N=3$ interior points and a nondimensional grid spacing $h=1$ using a second-order central difference scheme, $\\frac{-p_{i-1} + 2p_i - p_{i+1}}{h^2}$, results in a linear system $A\\mathbf{p} = \\mathbf{f}$. The matrix $A$ is the $3 \\times 3$ discrete Laplacian. Given $p_0=0$ and $p_4=0$, the fine-grid operator $A$ is:\n$$\nA = \\begin{pmatrix} 2 & -1 & 0 \\\\ -1 & 2 & -1 \\\\ 0 & -1 & 2 \\end{pmatrix}\n$$\nThis matrix is symmetric and, as we will see from its eigenvalues, positive definite.\n\nThe problem defines a prolongation (interpolation) operator $P \\in \\mathbb{R}^{3 \\times 2}$ that maps a coarse-grid vector of $2$ unknowns, $u_C = \\begin{pmatrix} u_C^1 \\\\ u_C^2 \\end{pmatrix}$, to a fine-grid vector of $3$ unknowns, $u_f = \\begin{pmatrix} u_f^1 \\\\ u_f^2 \\\\ u_f^3 \\end{pmatrix}$. The mapping is defined as:\n$u_f^1 = u_C^1$\n$u_f^2 = \\frac{1}{2} u_C^1 + \\frac{1}{2} u_C^2$\n$u_f^3 = u_C^2$\nIn matrix form, $u_f = P u_C$, the prolongation operator is:\n$$\nP = \\begin{pmatrix} 1 & 0 \\\\ \\frac{1}{2} & \\frac{1}{2} \\\\ 0 & 1 \\end{pmatrix}\n$$\nThe restriction operator $R$ is constructed using the symmetric Galerkin choice, $R = P^{\\top}$. Therefore, $R \\in \\mathbb{R}^{2 \\times 3}$ is:\n$$\nR = \\begin{pmatrix} 1 & \\frac{1}{2} & 0 \\\\ 0 & \\frac{1}{2} & 1 \\end{pmatrix}\n$$\nThe coarse-grid operator $A_c$ is formed by the Galerkin projection $A_c = R A P = P^{\\top} A P$. We compute this product in two steps. First, we compute $A P$:\n$$\nA P = \\begin{pmatrix} 2 & -1 & 0 \\\\ -1 & 2 & -1 \\\\ 0 & -1 & 2 \\end{pmatrix} \\begin{pmatrix} 1 & 0 \\\\ \\frac{1}{2} & \\frac{1}{2} \\\\ 0 & 1 \\end{pmatrix} = \\begin{pmatrix} 2(1) - 1(\\frac{1}{2}) & 2(0) - 1(\\frac{1}{2}) \\\\ -1(1) + 2(\\frac{1}{2}) & -1(0) + 2(\\frac{1}{2}) - 1(1) \\\\ -1(\\frac{1}{2}) & -1(\\frac{1}{2}) + 2(1) \\end{pmatrix} = \\begin{pmatrix} \\frac{3}{2} & -\\frac{1}{2} \\\\ 0 & 0 \\\\ -\\frac{1}{2} & \\frac{3}{2} \\end{pmatrix}\n$$\nNext, we pre-multiply by $R$ to find $A_c$:\n$$\nA_c = R (A P) = \\begin{pmatrix} 1 & \\frac{1}{2} & 0 \\\\ 0 & \\frac{1}{2} & 1 \\end{pmatrix} \\begin{pmatrix} \\frac{3}{2} & -\\frac{1}{2} \\\\ 0 & 0 \\\\ -\\frac{1}{2} & \\frac{3}{2} \\end{pmatrix} = \\begin{pmatrix} \\frac{3}{2} & -\\frac{1}{2} \\\\ -\\frac{1}{2} & \\frac{3}{2} \\end{pmatrix}\n$$\nNow, we determine the spectra of $A$ and $A_c$.\nThe eigenvalues of the fine-grid operator $A$, denoted $\\lambda_A$, are the roots of the characteristic equation $\\det(A - \\lambda_A I) = 0$:\n$$\n\\det \\begin{pmatrix} 2-\\lambda_A & -1 & 0 \\\\ -1 & 2-\\lambda_A & -1 \\\\ 0 & -1 & 2-\\lambda_A \\end{pmatrix} = (2-\\lambda_A)((2-\\lambda_A)^2 - 1) - (-1)(-(2-\\lambda_A)) = (2-\\lambda_A)((2-\\lambda_A)^2 - 2) = 0\n$$\nThis gives one eigenvalue $\\lambda_A = 2$, and two others from $(2-\\lambda_A)^2 = 2$, which means $2-\\lambda_A = \\pm\\sqrt{2}$, or $\\lambda_A = 2 \\mp \\sqrt{2}$. The sorted eigenvalues of $A$ are:\n$\\lambda_1(A) = 2 - \\sqrt{2}$\n$\\lambda_2(A) = 2$\n$\\lambda_3(A) = 2 + \\sqrt{2}$\nAll eigenvalues are positive, confirming that $A$ is positive definite.\n\nThe eigenvalues of the coarse-grid operator $A_c$, denoted $\\lambda_c$, are the roots of $\\det(A_c - \\lambda_c I) = 0$:\n$$\n\\det \\begin{pmatrix} \\frac{3}{2}-\\lambda_c & -\\frac{1}{2} \\\\ -\\frac{1}{2} & \\frac{3}{2}-\\lambda_c \\end{pmatrix} = \\left(\\frac{3}{2}-\\lambda_c\\right)^2 - \\left(-\\frac{1}{2}\\right)^2 = \\left(\\frac{3}{2}-\\lambda_c\\right)^2 - \\frac{1}{4} = 0\n$$\nThis implies $\\left(\\frac{3}{2}-\\lambda_c\\right)^2 = \\frac{1}{4}$, so $\\frac{3}{2}-\\lambda_c = \\pm\\frac{1}{2}$. This yields the eigenvalues $\\lambda_c = \\frac{3}{2} \\mp \\frac{1}{2}$. The sorted eigenvalues of $A_c$ are:\n$\\lambda_1(A_c) = \\frac{3}{2} - \\frac{1}{2} = 1$\n$\\lambda_2(A_c) = \\frac{3}{2} + \\frac{1}{2} = 2$\n\nFinally, we verify the eigenvalue interlacing property. The Courant-Fischer min-max principle for SPD matrices establishes that the eigenvalues of a Galerkin-projected system interlace the eigenvalues of the original system. For an $n \\times n$ SPD matrix $A$ and an $n \\times m$ full-rank prolongation matrix $P$ ($m < n$), the eigenvalues $\\mu_k$ of the generalized eigenvalue problem $P^{\\top}AP y = \\mu (P^{\\top}P) y$ interlace the eigenvalues $\\lambda_k$ of $A$. That is, $\\lambda_k(A) \\le \\mu_k \\le \\lambda_{k+n-m}(A)$ for $k=1, \\dots, m$. These $\\mu_k$ are the true Ritz values. The problem asks to verify this property for the standard eigenvalues $\\lambda_k(A_c)$. We check this directly.\nHere, $n=3$, $m=2$. We must verify that $\\lambda_k(A) \\le \\lambda_k(A_c) \\le \\lambda_{k+1}(A)$ for $k=1, 2$.\nFor $k=1$:\n$$\n\\lambda_1(A) \\le \\lambda_1(A_c) \\le \\lambda_2(A) \\implies 2 - \\sqrt{2} \\le 1 \\le 2\n$$\nSince $1 < \\sqrt{2} < 2$, we have $0 < 2-\\sqrt{2} < 1$. Thus, $2 - \\sqrt{2} \\le 1$ holds. Also, $1 \\le 2$ holds. The first interlacing condition is satisfied.\nFor $k=2$:\n$$\n\\lambda_2(A) \\le \\lambda_2(A_c) \\le \\lambda_3(A) \\implies 2 \\le 2 \\le 2 + \\sqrt{2}\n$$\nThis condition is also satisfied. Thus, the interlacing property holds for the standard eigenvalues of $A_c$ for this specific problem.\n\nThe two coarse-grid eigenvalues of $A_c$ are $1$ and $2$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1 & 2\n\\end{pmatrix}\n}\n$$", "id": "3290960"}, {"introduction": "A key innovation of algebraic multigrid is its ability to automatically adapt to problem physics, such as anisotropy, without relying on geometric information. This is achieved through the concept of \"strength-of-connection,\" which analyzes the matrix coefficients to identify the most significant couplings between unknowns. This practice explores how the classical Ruge–Stüben strength criterion, controlled by a threshold $\\theta$, determines the structure of the coarse grid for an anisotropic diffusion problem [@problem_id:3290884]. By deriving the critical threshold, you will gain a practical understanding of how AMG tailors its coarsening strategy to the underlying operator, a crucial feature for robust performance in complex CFD applications.", "problem": "In classical Algebraic Multigrid (AMG) preconditioning for Computational Fluid Dynamics (CFD), consider the discrete anisotropic diffusion operator arising from the constant-coefficient partial differential equation $-\\nabla \\cdot \\left(K \\nabla u\\right) = f$ on a uniform Cartesian mesh with spacing $h$ in both directions, where $K = \\mathrm{diag}(a_{x}, a_{y})$ and the anisotropy ratio is defined as $\\alpha = a_{x}/a_{y} \\geq 1$. Using a standard $5$-point finite-difference stencil, the interior-node matrix row has a positive diagonal and negative off-diagonal couplings to the $4$ immediate neighbors. In the classical Ruge–Stüben strength-of-connection definition for Algebraic Multigrid (AMG), a neighbor $j$ is a strong neighbor of node $i$ if $-a_{ij} \\geq \\theta \\max_{k \\neq i} \\left(-a_{ik}\\right)$ for a threshold $\\theta \\in (0,1)$.\n\nStarting from these definitions and the uniform-grid $5$-point discretization of the anisotropic diffusion operator, construct the strength graph at a generic interior node by identifying which of its four neighbors are strong as a function of $\\theta$ and $\\alpha$. Then, analyze qualitatively how the Coarse/Fine (CF) splitting (coarse points versus fine points) and the induced coarsening orientation depend on whether only horizontal couplings are strong or both horizontal and vertical couplings are strong.\n\nProvide, as your final answer, the analytically simplified expression for the critical threshold $\\theta_{c}(\\alpha)$ at which the strength graph changes from having four strong neighbors to having only the two horizontal neighbors marked strong. No numerical evaluation is required, and no rounding is needed. The final answer must be a single closed-form expression.", "solution": "We begin with the uniform-grid, constant-coefficient anisotropic diffusion operator\n$$\n-\\frac{\\partial}{\\partial x}\\left(a_{x}\\frac{\\partial u}{\\partial x}\\right) \\;-\\; \\frac{\\partial}{\\partial y}\\left(a_{y}\\frac{\\partial u}{\\partial y}\\right) \\;=\\; f,\n$$\nwhere $a_{x} > 0$, $a_{y} > 0$, and the anisotropy ratio is $\\alpha = a_{x}/a_{y} \\geq 1$. On a uniform mesh with spacing $h$ in both directions, the standard $5$-point finite-difference discretization gives, at an interior node $i$, the following $4$ off-diagonal coefficients associated with the nearest neighbors:\n- left and right (horizontal) neighbors: $a_{i,i\\pm \\hat{x}} = -\\frac{a_{x}}{h^{2}}$,\n- bottom and top (vertical) neighbors: $a_{i,i\\pm \\hat{y}} = -\\frac{a_{y}}{h^{2}}$,\nand a positive diagonal $a_{ii} = \\frac{2(a_{x} + a_{y})}{h^{2}}$.\n\nBy the Ruge–Stüben strength-of-connection definition, a neighbor $j$ is strong for node $i$ if\n$$\n-a_{ij} \\;\\geq\\; \\theta \\max_{k \\neq i} \\left(-a_{ik}\\right), \\qquad \\theta \\in (0,1).\n$$\nBecause the matrix comes from an $M$-matrix discretization with negative off-diagonals, $-a_{ij}$ is the magnitude of the coupling from $i$ to $j$. For the $5$-point stencil, the set of magnitudes for the off-diagonals at node $i$ is\n$$\n\\left\\{ \\frac{a_{x}}{h^{2}}, \\frac{a_{x}}{h^{2}}, \\frac{a_{y}}{h^{2}}, \\frac{a_{y}}{h^{2}} \\right\\}.\n$$\nSince $\\alpha = a_{x}/a_{y} \\geq 1$, we have $a_{x} \\geq a_{y}$, hence\n$$\n\\max_{k \\neq i} \\left(-a_{ik}\\right) \\;=\\; \\frac{a_{x}}{h^{2}}.\n$$\n\nWe now test the strength condition for each neighbor type.\n\nHorizontal neighbors: for $j = i \\pm \\hat{x}$,\n$$\n-a_{ij} \\;=\\; \\frac{a_{x}}{h^{2}} \\;\\geq\\; \\theta \\cdot \\frac{a_{x}}{h^{2}} \\quad \\Longleftrightarrow \\quad 1 \\;\\geq\\; \\theta.\n$$\nBecause $\\theta \\in (0,1)$, this inequality is always satisfied. Therefore, both horizontal neighbors are always marked strong for any admissible $\\theta$.\n\nVertical neighbors: for $j = i \\pm \\hat{y}$,\n$$\n-a_{ij} \\;=\\; \\frac{a_{y}}{h^{2}} \\;\\geq\\; \\theta \\cdot \\frac{a_{x}}{h^{2}} \\quad \\Longleftrightarrow \\quad \\theta \\;\\leq\\; \\frac{a_{y}}{a_{x}} \\;=\\; \\frac{1}{\\alpha}.\n$$\nThus, the vertical neighbors are marked strong if and only if $\\theta \\leq 1/\\alpha$.\n\nFrom these two cases, the strength graph at a generic interior node has the following dependence on $\\theta$:\n- If $\\theta \\leq \\frac{1}{\\alpha}$, then all four neighbors (left, right, bottom, top) are strong.\n- If $\\theta > \\frac{1}{\\alpha}$, then only the two horizontal neighbors (left and right) are strong.\n\nTherefore, the critical threshold separating these two regimes is\n$$\n\\theta_{c}(\\alpha) \\;=\\; \\frac{1}{\\alpha}.\n$$\n\nImplications for Coarse/Fine (CF) splitting and coarsening orientation follow from the structure of the strength graph. The CF splitting, in classical AMG, must ensure that every fine (F) point has sufficient coarse (C) neighbors among its strong connections to support accurate interpolation. When $\\theta > 1/\\alpha$, only horizontal couplings are strong, so the strength graph decomposes into nearly independent horizontal chains. The CF splitting is then determined linewise along the $x$-direction, and coarsening proceeds predominantly along those horizontal chains, effectively producing grids that are coarser in the $x$-direction while remaining relatively fine in the $y$-direction. In contrast, when $\\theta \\leq 1/\\alpha$, all four couplings are strong, yielding a more isotropic strength graph; the CF splitting can then distribute C points in both directions, and the induced coarsening is closer to isotropic.\n\nSince the problem requests the closed-form expression for the critical threshold, we report\n$$\n\\theta_{c}(\\alpha) \\;=\\; \\frac{1}{\\alpha}.\n$$", "answer": "$$\\boxed{\\frac{1}{\\alpha}}$$", "id": "3290884"}, {"introduction": "While powerful, standard AMG methods are not a panacea and can falter when the nature of the \"algebraically smooth\" error deviates from simple low-frequency modes. This advanced exercise confronts such a scenario, common in convection-dominated flows, where boundary-layer errors are poorly represented by standard polynomial interpolation. By quantifying the failure of a standard two-grid method for a convection-diffusion problem, you will see firsthand why the coarse space must sometimes be enriched with problem-specific functions [@problem_id:3290921]. This practice illuminates a frontier of AMG development, highlighting the need for sophisticated interpolation strategies to create truly robust solvers for challenging transport phenomena.", "problem": "Consider the steady one-dimensional convection–diffusion boundary value problem from Computational Fluid Dynamics (CFD),\n$$-\\epsilon \\frac{d^{2}u}{dx^{2}} + \\beta \\frac{du}{dx} = f(x), \\quad x \\in (0,1),$$\nwith homogeneous Dirichlet boundary conditions $u(0)=0$ and $u(1)=0$. Discretize the differential operator by a standard second-order centered difference for diffusion and first-order upwind for convection on a uniform grid with $N=3$ interior points and mesh size $h = \\frac{1}{4}$. Take $\\epsilon = 10^{-3}$ and $\\beta = 1$, so that the problem is convection-dominated in the sense that the local cell Peclet number $\\mathrm{Pe} = \\frac{\\beta h}{2 \\epsilon}$ is large. The resulting linear system is $A u = b$ with a tridiagonal nonsymmetric matrix $A \\in \\mathbb{R}^{3 \\times 3}$ whose interior stencil is determined by the discretization.\n\nAlgebraic Multigrid (AMG) relies on the principle that relaxation (smoothing) efficiently damps the high-frequency components of the error while the coarse space captures the remaining algebraically smooth error modes. For convection-dominated operators, the low-energy error can align with boundary-layer modes of the form $e^{\\alpha x}$ with $\\alpha \\approx \\beta / \\epsilon$, which are not well represented by purely polynomial (e.g., linear) coarse spaces.\n\nConstruct the following two-grid AMG process without presmoothing or postsmoothing to isolate the coarse-space effect. Use a standard linear interpolation as the prolongation,\n$$P_{\\mathrm{std}} = \\begin{pmatrix} 1 & 0 \\\\ \\frac{1}{2} & \\frac{1}{2} \\\\ 0 & 1 \\end{pmatrix},$$\nwith the coarse nodes located at the first and third fine-grid points so that the second fine-grid point linearly interpolates from its neighbors. Take the restriction $R = P_{\\mathrm{std}}^{\\top}$ and define the coarse operator by the Galerkin formula $A_{c} = R A P_{\\mathrm{std}}$. The two-grid coarse correction operator is\n$$C_{\\mathrm{std}} = I - P_{\\mathrm{std}} A_{c}^{-1} R A.$$\n\nTo model a convection-layer error, consider the fine-grid error vector\n$$v = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix},$$\nwhich concentrates error near the inflow boundary and is poorly captured by the standard coarse space $\\mathrm{range}(P_{\\mathrm{std}}) = \\{(y_{1},\\frac{y_{1}+y_{2}}{2}, y_{2})^{\\top} : y_{1},y_{2} \\in \\mathbb{R}\\}$. Validate the coarse-space deficiency by computing the energy-norm reduction factor of the two-grid correction applied to $v$ using the symmetrized operator\n$$H = \\frac{1}{2}(A + A^{\\top}),$$\nwhich defines a physically meaningful inner product for this nonsymmetric system. Specifically, compute\n$$\\rho_{\\mathrm{red}} = \\frac{\\|C_{\\mathrm{std}} v\\|_{H}}{\\|v\\|_{H}}, \\quad \\|w\\|_{H} = \\sqrt{w^{\\top} H w}.$$\n\nNext, derive theoretically the necessary coarse space enrichment to recover two-grid effectiveness for convection-dominated layers. Show that augmenting the coarse space so that it contains a discrete boundary-layer mode consistent with $e^{\\alpha x}$ (with $\\alpha \\approx \\beta/\\epsilon$) allows the coarse correction to eliminate that component of the error exactly. Conclude that if the enriched prolongation $P_{\\mathrm{enr}}$ satisfies $v \\in \\mathrm{range}(P_{\\mathrm{enr}})$, then the corresponding coarse correction $C_{\\mathrm{enr}} = I - P_{\\mathrm{enr}} (R_{\\mathrm{enr}} A P_{\\mathrm{enr}})^{-1} R_{\\mathrm{enr}} A$ yields $C_{\\mathrm{enr}} v = 0$ for that mode, thereby recovering convergence with respect to the boundary-layer error.\n\nAnswer the following, using the stated discretization and operators:\n- Compute the numerical value of $\\rho_{\\mathrm{red}}$ for the standard coarse space $P_{\\mathrm{std}}$ described above. Round your answer to four significant figures. Express the answer as a dimensionless quantity (no units).", "solution": "The user wants to compute the energy-norm reduction factor for a two-grid coarse correction applied to a specific error vector.\n\n### Step 1: Problem Validation\n\nThe problem statement provides a clear, self-contained, and scientifically grounded task within the field of numerical analysis for partial differential equations.\n-   **Givens Extracted:**\n    -   Differential Equation: $-\\epsilon \\frac{d^{2}u}{dx^{2}} + \\beta \\frac{du}{dx} = f(x)$ on $x \\in (0,1)$ with $u(0)=u(1)=0$.\n    -   Parameters: $\\epsilon = 10^{-3}$, $\\beta = 1$.\n    -   Discretization: Second-order centered difference for diffusion, first-order upwind for convection on a uniform grid with $N=3$ interior points.\n    -   Mesh size: $h = \\frac{1}{N+1} = \\frac{1}{4}$.\n    -   Linear System: $A u = b$, with $A \\in \\mathbb{R}^{3 \\times 3}$.\n    -   Prolongation Operator: $P_{\\mathrm{std}} = \\begin{pmatrix} 1 & 0 \\\\ \\frac{1}{2} & \\frac{1}{2} \\\\ 0 & 1 \\end{pmatrix}$.\n    -   Restriction Operator: $R = P_{\\mathrm{std}}^{\\top}$.\n    -   Coarse Operator: $A_{c} = R A P_{\\mathrm{std}}$.\n    -   Coarse Correction Operator: $C_{\\mathrm{std}} = I - P_{\\mathrm{std}} A_{c}^{-1} R A$.\n    -   Error Vector: $v = \\begin{pmatrix} 1 & 0 & 0 \\end{pmatrix}^{\\top}$.\n    -   Energy Norm Matrix: $H = \\frac{1}{2}(A + A^{\\top})$.\n    -   Energy Norm: $\\|w\\|_{H} = \\sqrt{w^{\\top} H w}$.\n    -   Target Quantity: $\\rho_{\\mathrm{red}} = \\frac{\\|C_{\\mathrm{std}} v\\|_{H}}{\\|v\\|_{H}}$.\n\n-   **Validation Verdict:**\n    -   The problem is scientifically sound, modeling a standard convection-diffusion equation with well-established numerical methods (finite differences, AMG).\n    -   It is well-posed, with all necessary information provided for a unique numerical solution.\n    -   The language is objective and precise.\n    -   The setup is complete and internally consistent.\n    -   The parameters are chosen to investigate a specific, realistic numerical challenge (convection-dominated flow with a high cell Peclet number).\n\nThe problem is deemed **valid**. We may proceed with the solution.\n\n### Step 2: Derivation and Calculation\n\nThe solution proceeds by constructing the necessary matrices and vectors and then computing the required norms.\n\n#### a) Constructing the System Matrix $A$\n\nThe differential operator at grid point $x_i$ is discretized using a second-order centered difference for the diffusion term and a first-order upwind difference for the convection term (since $\\beta > 0$).\n$$ L(u_i) = -\\epsilon \\frac{u_{i+1} - 2u_i + u_{i-1}}{h^2} + \\beta \\frac{u_i - u_{i-1}}{h} $$\nGrouping terms by index:\n$$ (Au)_i = \\left(-\\frac{\\epsilon}{h^2} - \\frac{\\beta}{h}\\right) u_{i-1} + \\left(\\frac{2\\epsilon}{h^2} + \\frac{\\beta}{h}\\right) u_i + \\left(-\\frac{\\epsilon}{h^2}\\right) u_{i+1} $$\nWe are given $h = \\frac{1}{4}$, $\\epsilon = \\frac{1}{1000}$, and $\\beta = 1$. The coefficients are:\n-   $\\frac{\\epsilon}{h^2} = \\frac{1/1000}{(1/4)^2} = \\frac{1/1000}{1/16} = \\frac{16}{1000} = \\frac{2}{125}$.\n-   $\\frac{\\beta}{h} = \\frac{1}{1/4} = 4 = \\frac{500}{125}$.\n\nThe stencil coefficients are:\n-   Sub-diagonal ($u_{i-1}$): $-\\frac{2}{125} - \\frac{500}{125} = -\\frac{502}{125}$.\n-   Diagonal ($u_i$): $\\frac{4}{125} + \\frac{500}{125} = \\frac{504}{125}$.\n-   Super-diagonal ($u_{i+1}$): $-\\frac{2}{125}$.\n\nFor $N=3$ interior points and homogeneous Dirichlet boundary conditions, the $3 \\times 3$ matrix $A$ is:\n$$ A = \\frac{1}{125} \\begin{pmatrix}\n504 & -2 & 0 \\\\\n-502 & 504 & -2 \\\\\n0 & -502 & 504\n\\end{pmatrix} $$\n\n#### b) Constructing the Coarse-Grid Operator $A_c$\n\n$A_c$ is defined by the Galerkin product $A_c = R A P_{\\mathrm{std}}$.\n$$ A_c = \\begin{pmatrix} 1 & \\frac{1}{2} & 0 \\\\ 0 & \\frac{1}{2} & 1 \\end{pmatrix} \\left( \\frac{1}{125} \\begin{pmatrix}\n504 & -2 & 0 \\\\\n-502 & 504 & -2 \\\\\n0 & -502 & 504\n\\end{pmatrix} \\right) \\begin{pmatrix} 1 & 0 \\\\ \\frac{1}{2} & \\frac{1}{2} \\\\ 0 & 1 \\end{pmatrix} $$\nFollowing the matrix multiplications, we find:\n$$ A_c = \\frac{1}{125} \\begin{pmatrix} 378 & 124 \\\\ -376 & 378 \\end{pmatrix} $$\n\n#### c) Computing the Corrected Error $w = C_{\\mathrm{std}} v$\n\nWe need to compute $w = v - P_{\\mathrm{std}} A_c^{-1} R A v$.\n1.  Compute $Av = \\frac{1}{125} \\begin{pmatrix} 504 \\\\ -502 \\\\ 0 \\end{pmatrix}$.\n2.  Compute $R(Av) = \\frac{1}{125} \\begin{pmatrix} 253 \\\\ -251 \\end{pmatrix}$.\n3.  Invert $A_c$: $\\det(A_c) = \\frac{189508}{15625}$.\n    $$ A_c^{-1} = \\frac{125}{189508} \\begin{pmatrix} 378 & -124 \\\\ 376 & 378 \\end{pmatrix} $$\n4.  Compute $A_c^{-1}(RAv) = \\frac{1}{189508} \\begin{pmatrix} 126758 \\\\ 250 \\end{pmatrix}$.\n5.  Compute $P_{\\mathrm{std}}(A_c^{-1}RAv) = \\frac{1}{189508} \\begin{pmatrix} 126758 \\\\ 63504 \\\\ 250 \\end{pmatrix}$.\n6.  Finally, compute $w = v - P_{\\mathrm{std}}(\\dots)$:\n    $$ w = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix} - \\frac{1}{189508} \\begin{pmatrix} 126758 \\\\ 63504 \\\\ 250 \\end{pmatrix} = \\frac{1}{189508} \\begin{pmatrix} 62750 \\\\ -63504 \\\\ -250 \\end{pmatrix} $$\n\n#### d) Computing the Reduction Factor $\\rho_{\\mathrm{red}}$\n\nFirst, we find the matrix $H = \\frac{1}{2}(A + A^{\\top})$:\n$$ H = \\frac{1}{2} \\cdot \\frac{1}{125} \\begin{pmatrix} 1008 & -504 & 0 \\\\ -504 & 1008 & -504 \\\\ 0 & -504 & 1008 \\end{pmatrix} = \\frac{252}{125} \\begin{pmatrix} 2 & -1 & 0 \\\\ -1 & 2 & -1 \\\\ 0 & -1 & 2 \\end{pmatrix} $$\nLet $K = \\begin{pmatrix} 2 & -1 & 0 \\\\ -1 & 2 & -1 \\\\ 0 & -1 & 2 \\end{pmatrix}$. Then $H = \\frac{252}{125} K$.\n\nNow, we compute the norms.\n-   $\\|v\\|_H^2 = v^{\\top} Hv = \\begin{pmatrix} 1 & 0 & 0 \\end{pmatrix} H \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix} = H_{11} = \\frac{252}{125} \\cdot 2 = \\frac{504}{125}$.\n-   $\\|w\\|_H^2 = w^{\\top} H w$. Let $\\tilde{w} = 189508 \\cdot w = (62750, -63504, -250)^{\\top}$.\n    $$ \\|w\\|_H^2 = \\frac{1}{(189508)^2} \\tilde{w}^{\\top} H \\tilde{w} = \\frac{1}{(189508)^2} \\frac{252}{125} (\\tilde{w}^{\\top} K \\tilde{w}) $$\n    The quadratic form $\\tilde{w}^{\\top} K \\tilde{w}$ is $2\\tilde{w}_1^2 + 2\\tilde{w}_2^2 + 2\\tilde{w}_3^2 - 2\\tilde{w}_1\\tilde{w}_2 - 2\\tilde{w}_2\\tilde{w}_3$.\n    $$ \\tilde{w}^{\\top} K \\tilde{w} = 2(62750)^2 + 2(-63504)^2 + 2(-250)^2 - 2(62750)(-63504) - 2(-63504)(-250) $$\n    $$ = 7875125000 + 8065519104 + 125000 + 7969202400 - 31752000 = 23878219504 $$\n    So, $\\|w\\|_H^2 = \\frac{252}{125 \\cdot (189508)^2} (23878219504)$.\n\nThe reduction factor squared is:\n$$ \\rho_{\\mathrm{red}}^2 = \\frac{\\|w\\|_H^2}{\\|v\\|_H^2} = \\frac{\\frac{252}{125 \\cdot (189508)^2} (23878219504)}{\\frac{504}{125}} = \\frac{252}{504} \\frac{23878219504}{(189508)^2} $$\n$$ \\rho_{\\mathrm{red}}^2 = \\frac{1}{2} \\frac{23878219504}{35913286064} \\approx \\frac{1}{2} (0.6648704) \\approx 0.3324352 $$\nThe reduction factor is the square root:\n$$ \\rho_{\\mathrm{red}} = \\sqrt{0.3324352\\dots} \\approx 0.5765719\\dots $$\nRounding to four significant figures gives $0.5766$.", "answer": "$$\\boxed{0.5766}$$", "id": "3290921"}]}