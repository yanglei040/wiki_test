{"hands_on_practices": [{"introduction": "The first step in any high-fidelity simulation of wall-bounded flows is designing a mesh that resolves the steep gradients and key turbulent structures within the boundary layer. This practice connects the physical scales of near-wall turbulence, such as streaks and the viscous sublayer, to concrete meshing guidelines in non-dimensional wall units like $y^+$, $\\Delta x^+$, and $\\Delta z^+$. By working through this exercise [@problem_id:3354487], you will gain a practical understanding of how to translate turbulence phenomenology into a robust inflation layer design for a wall-resolved Large Eddy Simulation (LES).", "problem": "Consider a zero-pressure-gradient turbulent boundary layer over a smooth flat plate at a streamwise station located a distance $x$ from the leading edge. The free-stream speed is $U_{\\infty}$ and the kinematic viscosity is $\\nu$. A wall-resolved Large Eddy Simulation (LES) will be performed using prismatic inflation layers adjacent to the wall, transitioning to a hexahedral core mesh away from the wall. The mesh must be specified in wall units based on the friction velocity $u_{\\tau} \\equiv \\sqrt{\\tau_{w}/\\rho}$, where $\\tau_{w}$ is the wall shear stress and $\\rho$ is the fluid density, with the usual definition of wall units $y^{+} \\equiv y u_{\\tau}/\\nu$, $\\Delta x^{+} \\equiv \\Delta x\\, u_{\\tau}/\\nu$, and $\\Delta z^{+} \\equiv \\Delta z\\, u_{\\tau}/\\nu$. \n\n1) Starting from the following well-tested facts about near-wall wall-bounded turbulence and subgrid-scale modeling:\n- The near-wall cycle exhibits dominant energy-containing streaks with spanwise spacing $\\lambda_{z,\\mathrm{peak}}^{+} \\approx 100$ and streamwise elongated structures with dominant wavelength $\\lambda_{x,\\mathrm{peak}}^{+} \\approx 1000$ at $y^{+} = \\mathcal{O}(10)$, as supported by pre-multiplied spectra of wall shear stress and streamwise velocity fluctuations.\n- The subgrid filter width in wall-resolved LES should remain smaller than the local shear length scale $L_{s} \\sim \\kappa y$ in the logarithmic region (with $\\kappa \\approx 0.41$) to avoid excessive subgrid-modeling of energy-containing eddies.\n- The viscous sublayer thickness is $y^{+} \\lesssim 5$ and the buffer layer extends to $y^{+} \\approx 30$.\nUsing only these facts and the definitions of wall units, derive target constraints on the wall-parallel grid spacings and first off-wall point such that the resolved grid captures the energy-containing near-wall structures with a reasonable number of points per dominant wavelength and ensures that the subgrid cutoff is not above the shear length near the wall. Show that these lead to ranges consistent with $\\Delta x^{+} \\approx 50$–$150$, $\\Delta z^{+} \\approx 15$–$40$, and a first off-wall point at $y^{+} \\approx 1$ for wall-resolved LES.\n\n2) For a specific flat-plate case with $U_{\\infty} = 30\\ \\mathrm{m/s}$, $\\nu = 1.5 \\times 10^{-5}\\ \\mathrm{m^{2}/s}$, and $x = 1.0\\ \\mathrm{m}$, estimate the local wall friction velocity $u_{\\tau}$ using the one-seventh power-law correlation for the local skin-friction coefficient $C_{f,x}$ at station $x$,\n$$\nC_{f,x} \\equiv \\frac{2 \\tau_{w}}{\\rho U_{\\infty}^{2}} \\approx 0.026\\, \\mathrm{Re}_{x}^{-1/7}, \\quad \\mathrm{Re}_{x} \\equiv \\frac{U_{\\infty} x}{\\nu},\n$$\nand compute the first-layer height $\\Delta y_{1}$ required to achieve $y_{1}^{+} \\equiv \\Delta y_{1} u_{\\tau}/\\nu = 1$. Next, estimate the local boundary-layer thickness using the well-tested turbulent flat-plate relation\n$$\n\\delta(x) \\approx 0.37\\, x\\, \\mathrm{Re}_{x}^{-1/5}.\n$$\nAssume the near-wall prismatic inflation layer stack has a geometric growth factor $r = 1.20$ in the wall-normal direction, starting at $\\Delta y_{1}$ and growing as $\\Delta y_{k} = \\Delta y_{1}\\, r^{k-1}$ for layer index $k=1,2,\\dots$. Determine the minimal integer number $N$ of prismatic layers such that the cumulative inflation thickness\n$$\n\\sum_{k=1}^{N} \\Delta y_{k} \\ge \\delta(x).\n$$\nExpress your final answer as the minimal integer $N$ (no units). Do not report any other quantities. If any intermediate numerical step requires approximation, carry sufficient precision to produce an unambiguous integer $N$ at the end.", "solution": "The problem is divided into two parts. The first part requires a derivation of common meshing guidelines for wall-resolved Large Eddy Simulation (LES) from fundamental principles of near-wall turbulence. The second part is a numerical application of related empirical formulas to determine the number of inflation layers required to span a turbulent boundary layer.\n\nThe problem is scientifically grounded, well-posed, and objective. It presents a standard problem in computational fluid dynamics (CFD) that combines theoretical understanding with practical application. All provided information, including physical constants, empirical correlations, and turbulence phenomenology, is standard and accepted in the field. The problem is therefore valid.\n\n**Part 1: Derivation of Meshing Constraints for Wall-Resolved LES**\n\nThe goal is to derive target constraints for the grid spacing ($\\Delta x^{+}$, $\\Delta z^{+}$) and the first off-wall grid point position ($y_1^{+}$) for a wall-resolved LES. The derivation will be based on the provided facts about near-wall turbulent structures and subgrid-scale modeling principles.\n\n1.  **First Off-Wall Point ($y_1^{+}$):** The problem states that the viscous sublayer, where viscosity dominates and velocity profiles are steep, occupies the region $y^{+} \\lesssim 5$. To accurately capture the physics within this layer, particularly the wall shear stress $\\tau_w$ which is fundamental to the entire scaling, the computational grid must resolve this region. This means that the first grid point off the wall, $y_1$, must be placed well within the viscous sublayer. A typical and often stringent requirement is to place the first cell center at $y_1^{+} = y_1 u_{\\tau}/\\nu \\approx 1$. This ensures that there is at least one computational point deep within the sublayer, satisfying the condition $y_1^{+} \\lesssim 5$. Hence, the guideline $y_1^{+} \\approx 1$ is a direct consequence of the need to resolve the near-wall viscous-dominated region.\n\n2.  **Spanwise Grid Spacing ($\\Delta z^{+}$):** The problem provides a key fact that near-wall turbulence is characterized by dominant energy-containing structures, often called low-speed streaks, which have a characteristic spanwise spacing of $\\lambda_{z,\\mathrm{peak}}^{+} \\approx 100$. For an LES to be \"wall-resolved,\" it must resolve these energy-containing eddies, rather than modeling them. To resolve a structure of a certain wavelength, the grid spacing must be a fraction of that wavelength. Let $N_z$ be the number of grid points used to resolve the spanwise wavelength $\\lambda_{z,\\mathrm{peak}}^{+}$. The grid spacing is then $\\Delta z^{+} = \\lambda_{z,\\mathrm{peak}}^{+} / N_z$. To adequately capture the shape and dynamics of these streaks, $N_z$ must be greater than the Nyquist criterion of $2$. A typical range for reasonable resolution is $N_z \\in [2.5, 7]$.\n    -   For a minimal resolution of $N_z=2.5$ points per streak, the spanwise spacing would be $\\Delta z^{+} = 100 / 2.5 = 40$.\n    -   For a finer resolution of $N_z \\approx 7$ points, the spacing would be $\\Delta z^{+} = 100 / 7 \\approx 14.3$.\n    These bounds lead directly to the commonly cited range $\\Delta z^{+} \\approx 15$–$40$.\n\n3.  **Streamwise Grid Spacing ($\\Delta x^{+}$):** A similar argument applies to the streamwise direction. The near-wall structures are noted to be highly elongated, with a dominant streamwise wavelength of $\\lambda_{x,\\mathrm{peak}}^{+} \\approx 1000$. Let $N_x$ be the number of grid points used to resolve this length. The required streamwise grid spacing is $\\Delta x^{+} = \\lambda_{x,\\mathrm{peak}}^{+} / N_x$. While these structures are long, resolving their temporal evolution and spatial coherence is important. A typical range for $N_x$ might be $N_x \\in [7, 20]$.\n    -   For $N_x = 7$ points, the streamwise spacing would be $\\Delta x^{+} = 1000 / 7 \\approx 143$.\n    -   For $N_x = 20$ points, the spacing would be $\\Delta x^{+} = 1000 / 20 = 50$.\n    This line of reasoning leads to the recommended range of $\\Delta x^{+} \\approx 50$–$150$.\n\n4.  **Consistency with the Shear Length Scale Criterion:** The problem states that the subgrid filter width, $\\Delta_{LES}$, should remain smaller than the local shear length scale, $L_s \\sim \\kappa y$, in the logarithmic region (where $y^{+} \\gtrsim 30$ and $\\kappa \\approx 0.41$). In wall units, this is $\\Delta_{LES}^{+} < \\kappa y^{+}$. The filter width $\\Delta_{LES}$ is typically a function of the local cell dimensions, e.g., $\\Delta_{LES} = (\\Delta x \\Delta y \\Delta z)^{1/3}$. The derived resolutions for $\\Delta x^{+}$ and $\\Delta z^{+}$ are primarily driven by the need to resolve the large, energy-containing eddies in the buffer layer ($y^+ \\approx 5-30$), not necessarily by the shear-length-scale argument in the log layer. In practice, the resolution requirements for $\\Delta x^{+}$ and $\\Delta z^{+}$ can conflict with the $L_s$ criterion, especially at the lower edge of the log-layer where $L_s$ is small. For instance, at $y^+=30$, $L_s^+ \\approx 0.41 \\times 30 = 12.3$. A spanwise resolution of $\\Delta z^+ = 30$ would violate $\\Delta z^+ < L_s^+$. This reflects a known compromise in wall-resolved LES, where resolving the dominant near-wall structures is prioritized, and some modeling of smaller-scale shear-generated eddies in the log-layer is accepted as a consequence of finite computational resources. The derived ranges are therefore understood to be *consistent* with the overall goals of wall-resolved LES, even if not every criterion is strictly satisfied at every point in the flow.\n\n**Part 2: Calculation of Inflation Layer Count**\n\nThis part requires a numerical calculation for a specific flow case. The given parameters are $U_{\\infty} = 30\\ \\mathrm{m/s}$, $\\nu = 1.5 \\times 10^{-5}\\ \\mathrm{m^{2}/s}$, and $x = 1.0\\ \\mathrm{m}$. The inflation layer growth rate is $r = 1.20$.\n\n1.  **Calculate the Reynolds number at station $x$:**\n    $$ \\mathrm{Re}_{x} = \\frac{U_{\\infty} x}{\\nu} = \\frac{(30\\ \\mathrm{m/s})(1.0\\ \\mathrm{m})}{1.5 \\times 10^{-5}\\ \\mathrm{m^{2}/s}} = 2.0 \\times 10^6 $$\n\n2.  **Calculate the local skin-friction coefficient $C_{f,x}$:**\n    $$ C_{f,x} \\approx 0.026\\, \\mathrm{Re}_{x}^{-1/7} = 0.026 \\times (2.0 \\times 10^6)^{-1/7} $$\n    $$ C_{f,x} \\approx 0.026 \\times (7.9455)^{-1} \\approx 0.003272 $$\n\n3.  **Calculate the friction velocity $u_{\\tau}$:**\n    The definition of $C_{f,x}$ is $C_{f,x} \\equiv \\frac{2 \\tau_{w}}{\\rho U_{\\infty}^{2}}$. The friction velocity is $u_{\\tau} \\equiv \\sqrt{\\tau_{w}/\\rho}$.\n    $$ u_{\\tau} = \\sqrt{\\frac{\\tau_w}{\\rho}} = \\sqrt{\\frac{C_{f,x} \\rho U_{\\infty}^{2}}{2\\rho}} = U_{\\infty} \\sqrt{\\frac{C_{f,x}}{2}} $$\n    $$ u_{\\tau} \\approx 30\\ \\mathrm{m/s} \\times \\sqrt{\\frac{0.003272}{2}} = 30 \\times \\sqrt{0.001636} \\approx 30 \\times 0.040448 \\approx 1.2134\\ \\mathrm{m/s} $$\n\n4.  **Calculate the first-layer height $\\Delta y_1$:**\n    The requirement is for the first cell center to be at $y_1^{+} = 1$. For a wall-adjacent cell, we approximate $y_1 \\approx \\Delta y_1 / 2$, but it is common practice in this context to set the first cell height $\\Delta y_1$ such that its center $y_1$ is at the target $y^+$ location, or simply, to satisfy $y_1^+ = \\Delta y_1 u_\\tau / \\nu = 1$. The problem statement uses the notation $y_{1}^{+} \\equiv \\Delta y_{1} u_{\\tau}/\\nu = 1$.\n    $$ \\Delta y_{1} = \\frac{1 \\cdot \\nu}{u_{\\tau}} \\approx \\frac{1.5 \\times 10^{-5}\\ \\mathrm{m^2/s}}{1.2134\\ \\mathrm{m/s}} \\approx 1.236 \\times 10^{-5}\\ \\mathrm{m} $$\n\n5.  **Calculate the boundary-layer thickness $\\delta(x)$:**\n    $$ \\delta(x) \\approx 0.37\\, x\\, \\mathrm{Re}_{x}^{-1/5} = 0.37 \\times (1.0\\ \\mathrm{m}) \\times (2.0 \\times 10^6)^{-1/5} $$\n    $$ (2.0 \\times 10^6)^{1/5} \\approx 18.2056 $$\n    $$ \\delta(x) \\approx 0.37 \\times (18.2056)^{-1} \\approx 0.020323\\ \\mathrm{m} $$\n\n6.  **Determine the minimal number of layers $N$:**\n    The cumulative thickness of $N$ prismatic layers with initial height $\\Delta y_1$ and growth factor $r$ is given by the sum of a geometric series:\n    $$ S_N = \\sum_{k=1}^{N} \\Delta y_k = \\sum_{k=1}^{N} \\Delta y_1 r^{k-1} = \\Delta y_1 \\frac{r^N - 1}{r - 1} $$\n    We need to find the minimal integer $N$ such that $S_N \\ge \\delta(x)$.\n    $$ \\Delta y_1 \\frac{r^N - 1}{r - 1} \\ge \\delta(x) $$\n    Substituting the known values ($r=1.20$):\n    $$ (1.236 \\times 10^{-5}\\ \\mathrm{m}) \\times \\frac{1.20^N - 1}{1.20 - 1} \\ge 0.020323\\ \\mathrm{m} $$\n    $$ (1.236 \\times 10^{-5}) \\times \\frac{1.20^N - 1}{0.20} \\ge 0.020323 $$\n    $$ 6.18 \\times 10^{-5} \\times (1.20^N - 1) \\ge 0.020323 $$\n    $$ 1.20^N - 1 \\ge \\frac{0.020323}{6.18 \\times 10^{-5}} \\approx 328.85 $$\n    $$ 1.20^N \\ge 329.85 $$\n    To solve for $N$, we take the natural logarithm of both sides:\n    $$ N \\ln(1.20) \\ge \\ln(329.85) $$\n    $$ N \\ge \\frac{\\ln(329.85)}{\\ln(1.20)} \\approx \\frac{5.7986}{0.1823} \\approx 31.808 $$\n    Since $N$ must be an integer, the minimal number of layers required is the next integer greater than or equal to this value.\n    $$ N = 32 $$\n    Performing the calculation with higher precision confirms this result:\n    $u_{\\tau} \\approx 1.2134555\\ \\mathrm{m/s}$, $\\Delta y_1 \\approx 1.23611 \\times 10^{-5}\\ \\mathrm{m}$, $\\delta(x) \\approx 0.0203232\\ \\mathrm{m}$.\n    $N \\ge \\frac{\\ln\\left(1 + \\frac{\\delta(x)(r-1)}{\\Delta y_1}\\right)}{\\ln(r)} = \\frac{\\ln\\left(1 + \\frac{0.0203232 \\times 0.2}{1.23611 \\times 10^{-5}}\\right)}{\\ln(1.2)} = \\frac{\\ln(1+328.825)}{\\ln(1.2)} = \\frac{\\ln(329.825)}{\\ln(1.2)} \\approx 31.804$.\n    The minimal integer is $N=32$.", "answer": "$$\\boxed{32}$$", "id": "3354487"}, {"introduction": "While inflation layers are essential for resolving boundary layers efficiently, their high aspect ratio and potential non-orthogonality can introduce significant numerical errors. This exercise [@problem_id:3354533] delves into the analysis of truncation error, a fundamental concept in numerical methods, to quantify how the geometry of prismatic cells affects the accuracy of discretizing the Laplacian operator. By deriving the error dependence on aspect ratio $AR$ and skewness angle $\\theta$, you will develop a deeper appreciation for the trade-offs between meshing efficiency and discretization accuracy.", "problem": "Consider a steady, fully developed, laminar channel flow between parallel plates at $y=\\pm H$ with the classical plane Poiseuille base profile augmented by a small manufactured perturbation to enable rigorous truncation error quantification for verification. Let the streamwise velocity be\n$$\nu(x,y) \\;=\\; U_{\\max}\\!\\left(1 - \\frac{y^{2}}{H^{2}}\\right) \\;+\\; \\varepsilon\\,\\cos(k x)\\,\\left(\\frac{y}{H}\\right)^{4},\n$$\nwhere $\\varepsilon$ is a small, dimensionless amplitude and $k$ is a real wavenumber. You will analyze the truncation error of a second-order, cell-centered, finite-volume discretization of the Laplacian operator appearing in the viscous term of the streamwise momentum balance, using a locally uniform, structured mesh.\n\nModel two locally uniform meshes:\n- An orthogonal, isotropic hexahedral mesh with spacings $\\Delta x=\\Delta y=\\Delta$ aligned with the $(x,y)$ axes.\n- A stretched prismatic inflation mesh with spacings $\\Delta s$ (tangential to the wall) and $\\Delta t$ (wall-normal), with aspect ratio $AR=\\Delta s/\\Delta t$, whose local mesh lines are rotated by a non-orthogonality angle $\\theta$ relative to $(x,y)$, so that the tangential coordinate is $s = x \\cos\\theta + y \\sin\\theta$ and the wall-normal coordinate is $t = -x \\sin\\theta + y \\cos\\theta$. Assume the prismatic layer resolves the same wall-normal spacing as the isotropic mesh, i.e., $\\Delta t = \\Delta$, and $\\Delta s = AR\\,\\Delta$.\n\nAdopt the second-order central finite-volume approximation of the Laplacian based on Gauss’ divergence theorem on a uniform grid, which reduces (direction-wise) to the central second-difference approximation of the second derivative in each coordinate direction. Work to leading non-vanishing order in $\\Delta$, and to leading order in $\\theta$ where needed, using Taylor expansions about a cell center. Use the chain rule to relate derivatives in $(s,t)$ to those in $(x,y)$.\n\nDefine the local truncation error at a cell center as the difference between the discrete Laplacian and the continuous Laplacian applied to $u(x,y)$. Denote by $TE_{\\mathrm{hex}}$ the leading-order truncation error on the isotropic hexahedral mesh, and by $TE_{\\mathrm{pris}}$ the leading-order truncation error on the stretched, rotated prismatic mesh. Evaluate both at the channel centerline $y=0$.\n\nDerive, from first principles, the closed-form analytic expression for the dimensionless ratio\n$$\nR(AR,\\theta) \\;=\\; \\frac{|TE_{\\mathrm{pris}}(y=0)|}{|TE_{\\mathrm{hex}}(y=0)|}\n$$\nas a function of $AR$ and $\\theta$, eliminating all problem parameters other than $AR$ and $\\theta$.\n\nYour final answer must be the simplified analytic expression for $R(AR,\\theta)$, with no units. Do not compute any numerical approximation. Provide the final answer as a single closed-form expression.", "solution": "The problem requires the derivation of the ratio of leading-order truncation errors for a finite-volume discretization of the Laplacian operator on two different mesh types. Let the given streamwise velocity be $u(x,y) = U_{\\max}(1 - \\frac{y^{2}}{H^{2}}) + \\varepsilon\\,\\cos(k x)\\,(\\frac{y}{H})^{4}$. The truncation error, $TE$, is defined as the difference between the discrete Laplacian, $(\\nabla^2)_{\\text{discrete}}$, and the continuous Laplacian, $\\nabla^2 u = \\frac{\\partial^2 u}{\\partial x^2} + \\frac{\\partial^2 u}{\\partial y^2}$. We are asked to evaluate the leading-order part of this error at the channel centerline, $y=0$.\n\nFirst, we analyze the isotropic hexahedral mesh. The mesh is orthogonal and aligned with the $(x,y)$ axes, with uniform spacing $\\Delta x = \\Delta y = \\Delta$. The problem states that the second-order, cell-centered finite-volume approximation for the Laplacian reduces to the sum of central second-difference operators in each coordinate direction. At a cell center $(x,y)$, this is:\n$$\n(\\nabla^2_{\\mathrm{hex}} u)(x,y) = \\frac{u(x+\\Delta, y) - 2u(x,y) + u(x-\\Delta, y)}{\\Delta^2} + \\frac{u(x, y+\\Delta) - 2u(x,y) + u(x, y-\\Delta)}{\\Delta^2}\n$$\nTo find the truncation error, we use Taylor series expansions for each term around the point $(x,y)$.\n$$\nu(x\\pm\\Delta, y) = u \\pm \\Delta \\frac{\\partial u}{\\partial x} + \\frac{\\Delta^2}{2!} \\frac{\\partial^2 u}{\\partial x^2} \\pm \\frac{\\Delta^3}{3!} \\frac{\\partial^3 u}{\\partial x^3} + \\frac{\\Delta^4}{4!} \\frac{\\partial^4 u}{\\partial x^4} + O(\\Delta^6)\n$$\n$$\nu(x, y\\pm\\Delta) = u \\pm \\Delta \\frac{\\partial u}{\\partial y} + \\frac{\\Delta^2}{2!} \\frac{\\partial^2 u}{\\partial y^2} \\pm \\frac{\\Delta^3}{3!} \\frac{\\partial^3 u}{\\partial y^3} + \\frac{\\Delta^4}{4!} \\frac{\\partial^4 u}{\\partial y^4} + O(\\Delta^6)\n$$\nSubstituting these into the expression for $(\\nabla^2_{\\mathrm{hex}} u)$:\n$$\n(\\nabla^2_{\\mathrm{hex}} u) = \\frac{1}{\\Delta^2}\\left(2\\frac{\\Delta^2}{2!} \\frac{\\partial^2 u}{\\partial x^2} + 2\\frac{\\Delta^4}{4!} \\frac{\\partial^4 u}{\\partial x^4} + \\dots \\right) + \\frac{1}{\\Delta^2}\\left(2\\frac{\\Delta^2}{2!} \\frac{\\partial^2 u}{\\partial y^2} + 2\\frac{\\Delta^4}{4!} \\frac{\\partial^4 u}{\\partial y^4} + \\dots \\right)\n$$\n$$\n(\\nabla^2_{\\mathrm{hex}} u) = \\left(\\frac{\\partial^2 u}{\\partial x^2} + \\frac{\\partial^2 u}{\\partial y^2}\\right) + \\frac{\\Delta^2}{12}\\left(\\frac{\\partial^4 u}{\\partial x^4} + \\frac{\\partial^4 u}{\\partial y^4}\\right) + O(\\Delta^4)\n$$\nThe leading-order truncation error, $TE_{\\mathrm{hex}}$, is the first non-vanishing term after the continuous Laplacian:\n$$\nTE_{\\mathrm{hex}} = (\\nabla^2_{\\mathrm{hex}} u) - \\nabla^2 u = \\frac{\\Delta^2}{12}\\left(\\frac{\\partial^4 u}{\\partial x^4} + \\frac{\\partial^4 u}{\\partial y^4}\\right)\n$$\nTo evaluate this at $y=0$, we need the fourth derivatives of $u(x,y)$.\n$$\n\\frac{\\partial^4 u}{\\partial x^4} = \\frac{\\partial^4}{\\partial x^4} \\left[ U_{\\max}\\!\\left(1 - \\frac{y^{2}}{H^{2}}\\right) \\;+\\; \\varepsilon\\,\\cos(k x)\\,\\left(\\frac{y}{H}\\right)^{4} \\right] = \\varepsilon k^4 \\cos(kx) \\left(\\frac{y}{H}\\right)^4\n$$\n$$\n\\frac{\\partial^4 u}{\\partial y^4} = \\frac{\\partial^4}{\\partial y^4} \\left[ U_{\\max}\\!\\left(1 - \\frac{y^{2}}{H^{2}}\\right) \\;+\\; \\varepsilon\\,\\cos(k x)\\,\\left(\\frac{y}{H}\\right)^{4} \\right] = 0 + \\frac{\\varepsilon}{H^4} \\cos(kx) \\frac{d^4}{dy^4}(y^4) = \\frac{24 \\varepsilon}{H^4} \\cos(kx)\n$$\nEvaluating these derivatives at $y=0$:\n$$\n\\left.\\frac{\\partial^4 u}{\\partial x^4}\\right|_{y=0} = 0, \\quad \\left.\\frac{\\partial^4 u}{\\partial y^4}\\right|_{y=0} = \\frac{24 \\varepsilon}{H^4} \\cos(kx)\n$$\nThus, the truncation error on the hexahedral mesh at the centerline is:\n$$\nTE_{\\mathrm{hex}}(y=0) = \\frac{\\Delta^2}{12}\\left(0 + \\frac{24 \\varepsilon}{H^4} \\cos(kx)\\right) = \\frac{2 \\varepsilon \\Delta^2}{H^4} \\cos(kx)\n$$\n\nNext, we analyze the stretched, rotated prismatic mesh. The local mesh coordinates are $(s,t)$ with spacings $\\Delta s$ and $\\Delta t$, rotated by an angle $\\theta$ relative to $(x,y)$. The coordinate transformation is $s = x \\cos\\theta + y \\sin\\theta$ and $t = -x \\sin\\theta + y \\cos\\theta$. The discrete Laplacian is applied along these mesh lines:\n$$\n(\\nabla^2_{\\mathrm{pris}} u)(s,t) = \\frac{u(s+\\Delta s, t) - 2u(s,t) + u(s-\\Delta s, t)}{(\\Delta s)^2} + \\frac{u(s, t+\\Delta t) - 2u(s,t) + u(s, t-\\Delta t)}{(\\Delta t)^2}\n$$\nBy analogy with the previous case, the discrete operator can be expressed via Taylor series in $(s,t)$ coordinates:\n$$\n(\\nabla^2_{\\mathrm{pris}} u) = \\left(\\frac{\\partial^2 u}{\\partial s^2} + \\frac{\\partial^2 u}{\\partial t^2}\\right) + \\frac{(\\Delta s)^2}{12}\\frac{\\partial^4 u}{\\partial s^4} + \\frac{(\\Delta t)^2}{12}\\frac{\\partial^4 u}{\\partial t^4} + \\dots\n$$\nThe Laplacian operator is invariant under rotation, so $\\frac{\\partial^2 u}{\\partial s^2} + \\frac{\\partial^2 u}{\\partial t^2} = \\frac{\\partial^2 u}{\\partial x^2} + \\frac{\\partial^2 u}{\\partial y^2} = \\nabla^2 u$. Therefore, the leading-order truncation error for the prismatic mesh is:\n$$\nTE_{\\mathrm{pris}} = (\\nabla^2_{\\mathrm{pris}} u) - \\nabla^2 u = \\frac{(\\Delta s)^2}{12}\\frac{\\partial^4 u}{\\partial s^4} + \\frac{(\\Delta t)^2}{12}\\frac{\\partial^4 u}{\\partial t^4}\n$$\nWe need to express the derivatives with respect to $s$ and $t$ in terms of derivatives in $x$ and $y$. The inverse transformation gives the chain rule operators:\n$$\n\\frac{\\partial}{\\partial s} = \\cos\\theta \\frac{\\partial}{\\partial x} + \\sin\\theta \\frac{\\partial}{\\partial y}, \\qquad \\frac{\\partial}{\\partial t} = -\\sin\\theta \\frac{\\partial}{\\partial x} + \\cos\\theta \\frac{\\partial}{\\partial y}\n$$\nWe must evaluate $\\frac{\\partial^4 u}{\\partial s^4}$ and $\\frac{\\partial^4 u}{\\partial t^4}$ at $y=0$. At the centerline, any partial derivative of $u$ involving one or more derivatives with respect to $x$ is zero. This is because the $U_{\\max}$ term is independent of $x$, and the perturbation term contains a factor of $y^4$. Also, odd-order derivatives with respect to $y$ are zero at $y=0$.\nSpecifically, at $y=0$, $\\frac{\\partial^{m+n}u}{\\partial x^m \\partial y^n}=0$ if $m>0$ or if $n$ is odd. The only non-vanishing derivatives of 4th order at $y=0$ are terms of the form $\\frac{\\partial^4 u}{\\partial y^4}$.\nApplying the operator $\\frac{\\partial^4}{\\partial s^4} = (\\cos\\theta \\frac{\\partial}{\\partial x} + \\sin\\theta \\frac{\\partial}{\\partial y})^4$ to $u$ and evaluating at $y=0$, all terms from the binomial expansion which contain a $\\frac{\\partial}{\\partial x}$ operator will vanish. Only the term $(\\sin\\theta \\frac{\\partial}{\\partial y})^4$ survives:\n$$\n\\left.\\frac{\\partial^4 u}{\\partial s^4}\\right|_{y=0} = \\sin^4\\theta \\left.\\frac{\\partial^4 u}{\\partial y^4}\\right|_{y=0} = \\sin^4\\theta \\left(\\frac{24 \\varepsilon}{H^4} \\cos(kx)\\right)\n$$\nSimilarly, for $\\frac{\\partial^4}{\\partial t^4} = (-\\sin\\theta \\frac{\\partial}{\\partial x} + \\cos\\theta \\frac{\\partial}{\\partial y})^4$:\n$$\n\\left.\\frac{\\partial^4 u}{\\partial t^4}\\right|_{y=0} = \\cos^4\\theta \\left.\\frac{\\partial^4 u}{\\partial y^4}\\right|_{y=0} = \\cos^4\\theta \\left(\\frac{24 \\varepsilon}{H^4} \\cos(kx)\\right)\n$$\nNow we assemble $TE_{\\mathrm{pris}}(y=0)$ using the given mesh constraints $\\Delta t = \\Delta$ and $\\Delta s = AR \\cdot \\Delta$.\n$$\nTE_{\\mathrm{pris}}(y=0) = \\frac{(AR \\cdot \\Delta)^2}{12} \\left(\\sin^4\\theta \\frac{24 \\varepsilon}{H^4} \\cos(kx)\\right) + \\frac{\\Delta^2}{12} \\left(\\cos^4\\theta \\frac{24 \\varepsilon}{H^4} \\cos(kx)\\right)\n$$\n$$\nTE_{\\mathrm{pris}}(y=0) = \\frac{2 \\varepsilon \\Delta^2}{H^4} \\cos(kx) \\left(AR^2 \\sin^4\\theta + \\cos^4\\theta\\right)\n$$\n\nFinally, we compute the required ratio $R(AR,\\theta)$.\n$$\nR(AR,\\theta) = \\frac{|TE_{\\mathrm{pris}}(y=0)|}{|TE_{\\mathrm{hex}}(y=0)|} = \\frac{\\left|\\frac{2 \\varepsilon \\Delta^2}{H^4} \\cos(kx) \\left(AR^2 \\sin^4\\theta + \\cos^4\\theta\\right)\\right|}{\\left|\\frac{2 \\varepsilon \\Delta^2}{H^4} \\cos(kx)\\right|}\n$$\nThe expression $AR^2 \\sin^4\\theta + \\cos^4\\theta$ is always non-negative since $AR \\ge 0$ and the trigonometric terms are raised to an even power. Therefore, the absolute value is simply the expression itself.\n$$\nR(AR,\\theta) = AR^2 \\sin^4\\theta + \\cos^4\\theta\n$$\nAll problem parameters other than the aspect ratio $AR$ and the non-orthogonality angle $\\theta$ have been eliminated, as requested.", "answer": "$$\\boxed{AR^{2} \\sin^{4}\\theta + \\cos^{4}\\theta}$$", "id": "3354533"}, {"introduction": "Modern CFD solvers must accurately compute fluxes on non-orthogonal meshes, which are common when using prismatic layers near curved or complex surfaces. This practice [@problem_id:3354535] explores the finite volume discretization of diffusive fluxes, demonstrating how to decompose the flux into an orthogonal part and a non-orthogonal correction term. Implementing this correction is a crucial skill, as it directly addresses a primary source of error in many industrial CFD applications, ensuring that the numerical scheme remains accurate even on highly skewed grids.", "problem": "A prismatic or hexahedral inflation layer near a curved wall is commonly used in Computational Fluid Dynamics (CFD) to resolve wall-normal gradients with stretched cells while keeping high aspect ratios. In a cell-centered Finite Volume Method (FVM) discretization of steady diffusion for a scalar field, consider two adjacent control volumes with centroids connected by a vector $\\boldsymbol{d}$ of magnitude $d$, sharing a planar face with area vector $\\boldsymbol{S}$ of magnitude $A$ and outward unit normal $\\boldsymbol{n}$. Let the angle $\\theta$ be defined between $\\boldsymbol{S}$ and $\\boldsymbol{d}$ so that $\\cos \\theta = \\dfrac{\\boldsymbol{S}\\cdot\\boldsymbol{d}}{A\\,d}$. Assume a locally linear scalar field with diffusion coefficient $\\Gamma$ (in $\\text{m}^2/\\text{s}$), and denote the directional derivatives at the face by $g_d = \\nabla \\phi \\cdot \\boldsymbol{e}_d$ and $g_t = \\nabla \\phi \\cdot \\boldsymbol{e}_t$, where $\\boldsymbol{e}_d = \\boldsymbol{d}/d$ and $\\boldsymbol{e}_t$ is the unit vector orthogonal to $\\boldsymbol{e}_d$ in the plane spanned by $\\boldsymbol{S}$ and $\\boldsymbol{d}$ (so that $\\boldsymbol{S}$ decomposes into a component parallel to $\\boldsymbol{e}_d$ and a component parallel to $\\boldsymbol{e}_t$). Let the cell-centered values satisfy the linearity relation $\\phi_N - \\phi_P = g_d\\, d$. The continuous face-integrated diffusive flux (leaving the owner cell) is given by Fick's law base: $J_f = -\\Gamma \\int_{S} \\nabla \\phi \\cdot \\boldsymbol{n}\\, \\mathrm{d}S = -\\Gamma\\, \\boldsymbol{S}\\cdot \\nabla \\phi_f$, where $\\nabla \\phi_f$ is the face gradient under the linearity assumption.\n\nYour tasks are:\n- Starting from the above fundamental base only, derive the exact face-integrated diffusive flux in terms of $A$, $\\theta$, $g_d$, $g_t$, and $\\Gamma$, by decomposing $\\boldsymbol{S}$ into its component along $\\boldsymbol{e}_d$ and the residual in the span of $\\boldsymbol{e}_t$.\n- Derive the orthogonal finite volume approximation that uses only the projection of $\\boldsymbol{S}$ along $\\boldsymbol{e}_d$ and the linearity relation between $\\phi_P$, $\\phi_N$, and $g_d$, then express the non-orthogonal correction term that recovers the exact flux when added.\n- Formulate a deferred non-orthogonal correction with weight $\\omega \\in [0,1]$ applied explicitly to the non-orthogonal term, and derive closed-form expressions for the absolute error of the orthogonal approximation and the absolute error after applying the weighted deferred correction. Use the sign convention where a positive flux is leaving the owner cell.\n- Implement these expressions to compute, for each test case below, two quantities: the absolute error of the orthogonal approximation and the absolute error after the weighted deferred non-orthogonal correction. Express both errors in $\\text{m}^3/\\text{s}$.\n\nAngle unit requirement:\n- Use degrees for the input $\\theta$ in the test suite, and convert to radians within your program for any trigonometric evaluations.\n\nTest suite and parameters:\n- Case $1$ (orthogonality baseline): $\\Gamma = 1.5\\times 10^{-5}\\ \\text{m}^2/\\text{s}$, $A = 1.0\\times 10^{-4}\\ \\text{m}^2$, $d = 1.0\\times 10^{-4}\\ \\text{m}$, $\\theta = 0\\ \\text{deg}$, $g_d = 1.0\\times 10^{4}\\ \\text{m}^{-1}$, $g_t = 3.0\\times 10^{3}\\ \\text{m}^{-1}$, $\\omega = 1.0$.\n- Case $2$ (moderate non-orthogonality, full correction): $\\Gamma = 1.5\\times 10^{-5}\\ \\text{m}^2/\\text{s}$, $A = 1.0\\times 10^{-4}\\ \\text{m}^2$, $d = 2.0\\times 10^{-4}\\ \\text{m}$, $\\theta = 30\\ \\text{deg}$, $g_d = 8.0\\times 10^{3}\\ \\text{m}^{-1}$, $g_t = 5.0\\times 10^{3}\\ \\text{m}^{-1}$, $\\omega = 1.0$.\n- Case $3$ (high non-orthogonality, partial correction): $\\Gamma = 1.5\\times 10^{-5}\\ \\text{m}^2/\\text{s}$, $A = 1.0\\times 10^{-4}\\ \\text{m}^2$, $d = 1.0\\times 10^{-4}\\ \\text{m}$, $\\theta = 75\\ \\text{deg}$, $g_d = 1.2\\times 10^{4}\\ \\text{m}^{-1}$, $g_t = -4.0\\times 10^{3}\\ \\text{m}^{-1}$, $\\omega = 0.7$.\n- Case $4$ (near-degenerate angle, full correction): $\\Gamma = 1.5\\times 10^{-5}\\ \\text{m}^2/\\text{s}$, $A = 1.0\\times 10^{-4}\\ \\text{m}^2$, $d = 8.0\\times 10^{-5}\\ \\text{m}$, $\\theta = 89\\ \\text{deg}$, $g_d = 5.0\\times 10^{3}\\ \\text{m}^{-1}$, $g_t = 1.0\\times 10^{4}\\ \\text{m}^{-1}$, $\\omega = 1.0$.\n\nFinal output specification:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, ordered as $[E^{(1)}_{\\text{orth}},E^{(1)}_{\\text{corr}},E^{(2)}_{\\text{orth}},E^{(2)}_{\\text{corr}},E^{(3)}_{\\text{orth}},E^{(3)}_{\\text{corr}},E^{(4)}_{\\text{orth}},E^{(4)}_{\\text{corr}}]$, where $E^{(k)}_{\\text{orth}}$ is the absolute error of the orthogonal approximation for case $k$, and $E^{(k)}_{\\text{corr}}$ is the absolute error after the deferred non-orthogonal correction for case $k$. All numbers represent $\\text{m}^3/\\text{s}$, and no unit symbols should appear in the output.", "solution": "The problem requires the derivation and calculation of errors associated with the non-orthogonal discretization of a diffusive flux in a cell-centered Finite Volume Method (FVM). We will first derive the exact analytical expression for the flux, then the expression for the common orthogonal approximation and the corresponding non-orthogonal correction term. Finally, we will derive the expressions for the absolute errors of the orthogonal approximation and the weighted deferred correction scheme.\n\nLet the set of orthonormal basis vectors in the plane defined by $\\boldsymbol{S}$ and $\\boldsymbol{d}$ be $\\{\\boldsymbol{e}_d, \\boldsymbol{e}_t\\}$. The vector $\\boldsymbol{e}_d$ is the unit vector along the line connecting the cell centroids, $\\boldsymbol{e}_d = \\boldsymbol{d}/d$. The vector $\\boldsymbol{e}_t$ is a unit vector orthogonal to $\\boldsymbol{e}_d$ within the same plane, i.e., $\\boldsymbol{e}_t \\cdot \\boldsymbol{e}_d = 0$.\n\nThe gradient of the scalar field, $\\nabla \\phi$, can be expressed in this basis. As its component perpendicular to the $\\{\\boldsymbol{S}, \\boldsymbol{d}\\}$ plane does not contribute to the flux calculation (since $\\boldsymbol{S}$ lies in this plane), we only need to consider its projection onto this plane. Given the directional derivatives $g_d = \\nabla \\phi \\cdot \\boldsymbol{e}_d$ and $g_t = \\nabla \\phi \\cdot \\boldsymbol{e}_t$, the gradient vector in this plane is:\n$$\n\\nabla \\phi = g_d \\boldsymbol{e}_d + g_t \\boldsymbol{e}_t\n$$\nThe face area vector $\\boldsymbol{S}$ has magnitude $A$ and is directed along the outward unit normal $\\boldsymbol{n}$, so $\\boldsymbol{S} = A\\boldsymbol{n}$. The angle between $\\boldsymbol{S}$ and $\\boldsymbol{d}$ is $\\theta$, which is also the angle between their respective unit vectors $\\boldsymbol{n}$ and $\\boldsymbol{e}_d$. We can decompose $\\boldsymbol{n}$ (and thus $\\boldsymbol{S}$) in the $\\{\\boldsymbol{e}_d, \\boldsymbol{e}_t\\}$ basis. By construction, the angle between $\\boldsymbol{n}$ and $\\boldsymbol{e}_d$ is $\\theta$, and the angle between $\\boldsymbol{n}$ and $\\boldsymbol{e}_t$ is $\\pi/2 - \\theta$. Therefore:\n$$\n\\boldsymbol{n} = (\\boldsymbol{n} \\cdot \\boldsymbol{e}_d) \\boldsymbol{e}_d + (\\boldsymbol{n} \\cdot \\boldsymbol{e}_t) \\boldsymbol{e}_t = \\cos\\theta \\, \\boldsymbol{e}_d + \\sin\\theta \\, \\boldsymbol{e}_t\n$$\nAnd the area vector is:\n$$\n\\boldsymbol{S} = A(\\cos\\theta \\, \\boldsymbol{e}_d + \\sin\\theta \\, \\boldsymbol{e}_t)\n$$\n\nThe exact face-integrated diffusive flux, $J_{f,exact}$, leaving the owner cell is given by Fick's law as stated in the problem:\n$$\nJ_{f,exact} = -\\Gamma\\, \\boldsymbol{S}\\cdot \\nabla \\phi\n$$\nSubstituting the decomposed expressions for $\\boldsymbol{S}$ and $\\nabla \\phi$:\n$$\nJ_{f,exact} = -\\Gamma \\left[ A(\\cos\\theta \\, \\boldsymbol{e}_d + \\sin\\theta \\, \\boldsymbol{e}_t) \\right] \\cdot \\left[ g_d \\boldsymbol{e}_d + g_t \\boldsymbol{e}_t \\right]\n$$\nUsing the orthonormality of the basis vectors ($\\boldsymbol{e}_d \\cdot \\boldsymbol{e}_d = 1$, $\\boldsymbol{e}_t \\cdot \\boldsymbol{e}_t = 1$, $\\boldsymbol{e}_d \\cdot \\boldsymbol{e}_t = 0$):\n$$\nJ_{f,exact} = -\\Gamma A(g_d \\cos\\theta + g_t \\sin\\theta)\n$$\nThis is the exact expression for the diffusive flux under the assumption of a locally linear scalar field.\n\nNext, we derive the orthogonal approximation of the flux, $J_{f,orth}$. This approximation only considers the component of the gradient along the line connecting cell centers, implicitly assuming the flux is driven solely by the gradient in this direction. The approximated gradient is $\\nabla \\phi_{orth} = g_d \\boldsymbol{e}_d$. The corresponding flux is:\n$$\nJ_{f,orth} = -\\Gamma\\, \\boldsymbol{S} \\cdot \\nabla \\phi_{orth} = -\\Gamma \\left[ A(\\cos\\theta \\, \\boldsymbol{e}_d + \\sin\\theta \\, \\boldsymbol{e}_t) \\right] \\cdot \\left[ g_d \\boldsymbol{e}_d \\right]\n$$\n$$\nJ_{f,orth} = -\\Gamma A g_d \\cos\\theta\n$$\nThis term is often called the \"orthogonal\" or \"primary\" part of the flux, as it is proportional to $\\cos\\theta$ and vanishes for $\\theta = \\pi/2$ ($90^\\circ$). It represents the flux through the projected area $A \\cos\\theta$ driven by the cell-center-aligned gradient component $g_d = (\\phi_N - \\phi_P)/d$.\n\nThe non-orthogonal correction term, $J_ {f,noc}$, is the difference between the exact flux and the orthogonal approximation:\n$$\nJ_{f,noc} = J_{f,exact} - J_{f,orth} = \\left[ -\\Gamma A(g_d \\cos\\theta + g_t \\sin\\theta) \\right] - \\left[ -\\Gamma A g_d \\cos\\theta \\right]\n$$\n$$\nJ_{f,noc} = -\\Gamma A g_t \\sin\\theta\n$$\nThis term accounts for the flux driven by the gradient component $g_t$ (transverse to the cell-center line) passing through the face. It is proportional to $\\sin\\theta$, capturing the \"non-orthogonality\" of the grid.\n\nIn a deferred correction approach, the non-orthogonal term is often treated explicitly, using values from a previous iteration or solution state, and can be under-relaxed using a weight $\\omega \\in [0, 1]$. The approximated flux used in the solver is:\n$$\nJ_{f,approx} = J_{f,orth} + \\omega J_{f,noc} = -\\Gamma A g_d \\cos\\theta - \\omega \\Gamma A g_t \\sin\\theta\n$$\n\nWe are tasked with finding two error quantities. The first is the absolute error of the orthogonal-only approximation, $E_{orth}$. This is the magnitude of the flux component that is neglected by this approximation:\n$$\nE_{orth} = |J_{f,exact} - J_{f,orth}| = |J_{f,noc}| = |-\\Gamma A g_t \\sin\\theta| = |\\Gamma A g_t \\sin\\theta|\n$$\nThe second is the absolute error after applying the weighted deferred non-orthogonal correction, $E_{corr}$:\n$$\nE_{corr} = |J_{f,exact} - J_{f,approx}| = |(J_{f,orth} + J_{f,noc}) - (J_{f,orth} + \\omega J_{f,noc})|\n$$\n$$\nE_{corr} = |(1-\\omega) J_{f,noc}| = |(1-\\omega)(-\\Gamma A g_t \\sin\\theta)| = |(1-\\omega)\\Gamma A g_t \\sin\\theta|\n$$\nNoticeably, the distance between cell centers, $d$, does not appear in the final error expressions, as the required gradient components $g_d$ and $g_t$ are provided directly.\n\nThe calculation for each test case will apply these two final formulas:\n1.  Absolute error of the orthogonal approximation: $E_{orth} = |\\Gamma A g_t \\sin\\theta|$\n2.  Absolute error after weighted deferred non-orthogonal correction: $E_{corr} = |(1-\\omega)\\Gamma A g_t \\sin\\theta|$\n\nThe angle $\\theta$ given in degrees must be converted to radians for use in the trigonometric function $\\sin\\theta$. The units of the error will be $(\\text{m}^2/\\text{s}) \\cdot (\\text{m}^2) \\cdot (\\text{m}^{-1}) = \\text{m}^3/\\text{s}$, as required.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the CFD non-orthogonal diffusion error problem based on the provided test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (Gamma, A, d, theta_deg, g_d, g_t, omega)\n    test_cases = [\n        # Case 1: Orthogonality baseline\n        (1.5e-5, 1.0e-4, 1.0e-4, 0, 1.0e4, 3.0e3, 1.0),\n        # Case 2: Moderate non-orthogonality, full correction\n        (1.5e-5, 1.0e-4, 2.0e-4, 30, 8.0e3, 5.0e3, 1.0),\n        # Case 3: High non-orthogonality, partial correction\n        (1.5e-5, 1.0e-4, 1.0e-4, 75, 1.2e4, -4.0e3, 0.7),\n        # Case 4: Near-degenerate angle, full correction\n        (1.5e-5, 1.0e-4, 8.0e-5, 89, 5.0e3, 1.0e4, 1.0),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        Gamma, A, d, theta_deg, g_d, g_t, omega = case\n\n        # Convert angle from degrees to radians for trigonometric functions\n        theta_rad = np.deg2rad(theta_deg)\n\n        # The core component of the non-orthogonal correction flux\n        # J_f,noc = -Gamma * A * g_t * sin(theta)\n        # The error of the orthogonal approximation is the absolute value of this term.\n        non_ortho_flux_component = Gamma * A * g_t * np.sin(theta_rad)\n\n        # E_orth = |J_f,noc| = |Gamma * A * g_t * sin(theta)|\n        e_orth = np.abs(non_ortho_flux_component)\n        \n        # The error after weighted correction is the absolute value of the un-applied portion\n        # of the non-orthogonal correction flux.\n        # Error = |(1-omega) * J_f,noc|\n        e_corr = np.abs((1.0 - omega) * non_ortho_flux_component)\n\n        results.append(e_orth)\n        results.append(e_corr)\n\n    # Format the final output as a comma-separated list in square brackets.\n    # This format matches: [E^(1)_orth, E^(1)_corr, E^(2)_orth, E^(2)_corr, ...]\n    # The default float-to-string conversion in Python should be sufficient.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3354535"}]}