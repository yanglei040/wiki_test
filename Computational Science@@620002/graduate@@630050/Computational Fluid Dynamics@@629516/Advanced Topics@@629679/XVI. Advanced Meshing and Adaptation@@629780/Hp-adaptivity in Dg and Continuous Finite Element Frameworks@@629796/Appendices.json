{"hands_on_practices": [{"introduction": "To effectively implement p-adaptivity, where the polynomial degree $p$ is varied locally, it is advantageous to use basis functions that create nested approximation spaces. This exercise explores the construction of such hierarchical modal bases, which form the foundation of efficient p-refinement and coarsening. By deriving the prolongation and restriction operators, you will gain insight into how numerical information is transferred between different polynomial orders while preserving fundamental physical quantities like cell averages [@problem_id:3330533].", "problem": "Consider the Discontinuous Galerkin (DG) method for a scalar conservation law on a single quadrilateral reference element. Let the reference element be the square domain $\\Omega_{\\mathrm{ref}} = [-1,1] \\times [-1,1]$. Define hierarchical modal shape functions on $\\Omega_{\\mathrm{ref}}$ using tensor products of one-dimensional Legendre polynomials. In one dimension, let $P_{n}(x)$ denote the $n$th Legendre polynomial on $[-1,1]$, and define the orthonormalized family $\\hat{P}_{n}(x) = \\sqrt{\\frac{2n+1}{2}}\\,P_{n}(x)$, which satisfies $\\int_{-1}^{1} \\hat{P}_{n}(x)\\,\\hat{P}_{m}(x)\\,\\mathrm{d}x = \\delta_{nm}$, where $\\delta_{nm}$ is the Kronecker delta. On $\\Omega_{\\mathrm{ref}}$, define the hierarchical tensor-product basis functions by $\\phi_{i,j}(x,y) = \\hat{P}_{i}(x)\\,\\hat{P}_{j}(y)$ for nonnegative integers $i$ and $j$. For a fixed polynomial order $p \\in \\mathbb{N}$, define the DG local approximation space $V_{p} = \\mathrm{span}\\{\\phi_{i,j} : 0 \\le i \\le p,\\, 0 \\le j \\le p\\}$.\n\nTask 1: Starting from the definitions above, derive the hierarchical and nested structure of the spaces $V_{p}$ and $V_{p+1}$, and explain why the inclusion $V_{p} \\subset V_{p+1}$ holds. Based on this nested structure, derive a prolongation operator $\\mathcal{P}_{p \\rightarrow p+1}: V_{p} \\rightarrow V_{p+1}$ that preserves the polynomial represented on $V_{p}$ when embedded in $V_{p+1}$, and argue that this prolongation preserves the DG cell average (i.e., conservation) on $\\Omega_{\\mathrm{ref}}$ for any $u \\in V_{p}$.\n\nTask 2: Derive a restriction operator $\\mathcal{R}_{p \\rightarrow p-1}: V_{p} \\rightarrow V_{p-1}$ defined by the $L^{2}$ projection onto $V_{p-1}$ with respect to the standard inner product $\\langle u, v \\rangle = \\int_{\\Omega_{\\mathrm{ref}}} u\\,v\\,\\mathrm{d}\\Omega$. Show from first principles that this restriction preserves the DG cell average on $\\Omega_{\\mathrm{ref}}$ for any $u \\in V_{p}$, and explain the role of orthonormality in ensuring that the constant mode is preserved under $L^{2}$ projection. In your derivation, clearly connect the conservation of the DG cell average to the integral of the solution over $\\Omega_{\\mathrm{ref}}$.\n\nTask 3 (calculation): Consider the exact polynomial field $u(x,y) = x^{2} + y^{2}$ represented in $V_{2}$. Apply your restriction operator $\\mathcal{R}_{2 \\rightarrow 0}$ to obtain the conservative $p$-coarsening to $V_{0}$, which contains only the constant mode. Compute the resulting constant value by evaluating the DG cell average of $u$ over $\\Omega_{\\mathrm{ref}}$. Express your final answer as a pure number. No units are required. If you use any approximations, round your result to $4$ significant figures; otherwise provide the exact value.", "solution": "We begin by recalling fundamental definitions of hierarchical modal bases and $L^{2}$ projection and by using the standard properties of Legendre polynomials and inner-product spaces.\n\nFor Task $1$, we construct hierarchical shape functions as follows. In one dimension, the Legendre polynomials $P_{n}(x)$ on $[-1,1]$ form a family of mutually orthogonal polynomials with respect to the weight $1$. The orthonormalized polynomials $\\hat{P}_{n}(x) = \\sqrt{\\frac{2n+1}{2}}\\,P_{n}(x)$ satisfy\n$$\n\\int_{-1}^{1} \\hat{P}_{n}(x)\\,\\hat{P}_{m}(x)\\,\\mathrm{d}x = \\delta_{nm}.\n$$\nOn the reference square $\\Omega_{\\mathrm{ref}} = [-1,1]\\times[-1,1]$, the tensor-product modal basis functions are\n$$\n\\phi_{i,j}(x,y) = \\hat{P}_{i}(x)\\,\\hat{P}_{j}(y),\n$$\nand they are orthonormal in $L^{2}(\\Omega_{\\mathrm{ref}})$ since\n$$\n\\int_{-1}^{1}\\int_{-1}^{1} \\phi_{i,j}(x,y)\\,\\phi_{m,n}(x,y)\\,\\mathrm{d}y\\,\\mathrm{d}x\n= \\left(\\int_{-1}^{1} \\hat{P}_{i}(x)\\,\\hat{P}_{m}(x)\\,\\mathrm{d}x\\right)\\left(\\int_{-1}^{1} \\hat{P}_{j}(y)\\,\\hat{P}_{n}(y)\\,\\mathrm{d}y\\right)\n= \\delta_{i m}\\,\\delta_{j n}.\n$$\nDefine the hierarchical polynomial space at order $p$ by\n$$\nV_{p} = \\mathrm{span}\\{\\phi_{i,j} : 0 \\le i \\le p,\\, 0 \\le j \\le p\\}.\n$$\nIt is immediate that $V_{p} \\subset V_{p+1}$ because all basis functions $\\phi_{i,j}$ with $0 \\le i \\le p$ and $0 \\le j \\le p$ are also contained among those with $0 \\le i \\le p+1$ and $0 \\le j \\le p+1$. This nestedness is the hallmark of hierarchical shape functions: the lower-order basis functions are retained when increasing the order, and new higher-order functions are appended, guaranteeing nested polynomial subspaces.\n\nGiven $u \\in V_{p}$, its modal expansion reads\n$$\nu(x,y) = \\sum_{i=0}^{p} \\sum_{j=0}^{p} a_{i,j}\\,\\phi_{i,j}(x,y),\n$$\nfor some modal coefficients $\\{a_{i,j}\\}$. The prolongation operator $\\mathcal{P}_{p \\rightarrow p+1}: V_{p} \\rightarrow V_{p+1}$ that preserves the represented polynomial is defined by coefficient injection:\n$$\n\\mathcal{P}_{p \\rightarrow p+1}(u) = \\sum_{i=0}^{p} \\sum_{j=0}^{p} a_{i,j}\\,\\phi_{i,j}(x,y) + \\sum_{\\text{new modes }(i,j)\\in S_{p+1}\\setminus S_{p}} 0 \\cdot \\phi_{i,j}(x,y),\n$$\nwhere $S_{p} = \\{(i,j) : 0 \\le i \\le p,\\, 0 \\le j \\le p\\}$. This prolongation is exact since $u$ is already representable in $V_{p+1}$ by the same coefficients, with zeros for the additional higher-order modes. It preserves the DG cell average because the constant mode $\\phi_{0,0}(x,y) = \\hat{P}_{0}(x)\\,\\hat{P}_{0}(y)$ is included in every $V_{p}$ and its coefficient $a_{0,0}$ is unchanged by the injection. The DG cell average for any $u$ on $\\Omega_{\\mathrm{ref}}$ is\n$$\n\\bar{u} = \\frac{1}{|\\Omega_{\\mathrm{ref}}|}\\int_{\\Omega_{\\mathrm{ref}}} u(x,y)\\,\\mathrm{d}\\Omega,\n$$\nwith $|\\Omega_{\\mathrm{ref}}| = 4$. Since $\\phi_{0,0}$ is constant up to a normalization, the coefficient $a_{0,0}$ controls the mean. More explicitly, orthonormality implies\n$$\na_{0,0} = \\int_{\\Omega_{\\mathrm{ref}}} u(x,y)\\,\\phi_{0,0}(x,y)\\,\\mathrm{d}\\Omega,\n$$\nand therefore preserving $a_{0,0}$ preserves $\\bar{u}$ because the average is the $L^{2}$ projection of $u$ onto the constant subspace.\n\nFor Task $2$, the restriction operator $\\mathcal{R}_{p \\rightarrow p-1}: V_{p} \\rightarrow V_{p-1}$ defined by $L^{2}$ projection is formulated via orthogonality conditions. Define $\\tilde{u} = \\mathcal{R}_{p \\rightarrow p-1}(u) \\in V_{p-1}$ such that\n$$\n\\int_{\\Omega_{\\mathrm{ref}}} (u - \\tilde{u})\\,v\\,\\mathrm{d}\\Omega = 0 \\quad \\text{for all } v \\in V_{p-1}.\n$$\nExpanding $u$ and $\\tilde{u}$ in their respective modal bases,\n$$\nu(x,y) = \\sum_{i=0}^{p} \\sum_{j=0}^{p} a_{i,j}\\,\\phi_{i,j}(x,y), \\quad \\tilde{u}(x,y) = \\sum_{i=0}^{p-1} \\sum_{j=0}^{p-1} \\tilde{a}_{i,j}\\,\\phi_{i,j}(x,y),\n$$\nand using the orthonormality of $\\{\\phi_{i,j}\\}$, the orthogonality conditions reduce to\n$$\n\\tilde{a}_{i,j} = a_{i,j} \\quad \\text{for all } 0 \\le i \\le p-1,\\ 0 \\le j \\le p-1,\n$$\nand all higher-order coefficients are discarded. In particular, the constant mode coefficient satisfies $\\tilde{a}_{0,0} = a_{0,0}$. Since the DG cell average $\\bar{u}$ over $\\Omega_{\\mathrm{ref}}$ is governed by the constant component of $u$ and orthonormal higher-order modes integrate to zero, we have\n$$\n\\bar{u} = \\frac{1}{|\\Omega_{\\mathrm{ref}}|}\\int_{\\Omega_{\\mathrm{ref}}} u\\,\\mathrm{d}\\Omega = \\frac{1}{|\\Omega_{\\mathrm{ref}}|}\\int_{\\Omega_{\\mathrm{ref}}} \\tilde{u}\\,\\mathrm{d}\\Omega,\n$$\nwhich proves that $\\mathcal{R}_{p \\rightarrow p-1}$ preserves the DG cell average (i.e., conservation). The key point is that $L^{2}$ projection onto a subspace containing constants will always preserve the constant mode when expressed in an orthonormal basis, and all non-constant orthonormal modes have zero integral over $\\Omega_{\\mathrm{ref}}$.\n\nWe remark that for Continuous Finite Element Method (FEM) spaces, analogous hierarchical constructions exist on quadrilaterals and triangles, often leveraging tensor-product bases on quadrilaterals and Dubiner-type bases on triangles. The prolongation and restriction operators differ in how they map degrees of freedom across shared entities (vertices, edges), but when considered element-wise, the preservation of the constant mode and thus the element-average is governed by the same orthogonality and projection principles.\n\nFor Task $3$, we compute the DG cell average of $u(x,y) = x^{2} + y^{2}$ over $\\Omega_{\\mathrm{ref}}$. The average is\n$$\n\\bar{u} = \\frac{1}{|\\Omega_{\\mathrm{ref}}|}\\int_{-1}^{1}\\int_{-1}^{1} \\big(x^{2} + y^{2}\\big)\\,\\mathrm{d}y\\,\\mathrm{d}x.\n$$\nCompute each integral:\n$$\n\\int_{-1}^{1} x^{2}\\,\\mathrm{d}x = \\left[ \\frac{x^{3}}{3} \\right]_{-1}^{1} = \\frac{1}{3} - \\left(-\\frac{1}{3}\\right) = \\frac{2}{3}, \\quad \\int_{-1}^{1} 1\\,\\mathrm{d}y = 2,\n$$\nso\n$$\n\\int_{-1}^{1}\\int_{-1}^{1} x^{2}\\,\\mathrm{d}y\\,\\mathrm{d}x = \\left(\\int_{-1}^{1} x^{2}\\,\\mathrm{d}x\\right)\\left(\\int_{-1}^{1} \\mathrm{d}y\\right) = \\frac{2}{3} \\cdot 2 = \\frac{4}{3}.\n$$\nSimilarly,\n$$\n\\int_{-1}^{1} y^{2}\\,\\mathrm{d}y = \\frac{2}{3}, \\quad \\int_{-1}^{1} 1\\,\\mathrm{d}x = 2,\n$$\nhence\n$$\n\\int_{-1}^{1}\\int_{-1}^{1} y^{2}\\,\\mathrm{d}x\\,\\mathrm{d}y = \\frac{2}{3} \\cdot 2 = \\frac{4}{3}.\n$$\nTherefore,\n$$\n\\int_{-1}^{1}\\int_{-1}^{1} \\big(x^{2} + y^{2}\\big)\\,\\mathrm{d}y\\,\\mathrm{d}x = \\frac{4}{3} + \\frac{4}{3} = \\frac{8}{3}.\n$$\nThe area of the reference square is $|\\Omega_{\\mathrm{ref}}| = 4$, so the average is\n$$\n\\bar{u} = \\frac{1}{4} \\cdot \\frac{8}{3} = \\frac{2}{3}.\n$$\nUnder $\\mathcal{R}_{2 \\rightarrow 0}$, the restricted constant value in $V_{0}$ is this DG cell average, namely $\\frac{2}{3}$. No rounding is needed since this value is exact.", "answer": "$$\\boxed{\\frac{2}{3}}$$", "id": "3330533"}, {"introduction": "A posteriori error estimators are the engines that drive adaptive algorithms, providing local indicators of where the numerical error is largest. This practice provides a concrete, hands-on calculation of a residual-based error indicator for a Discontinuous Galerkin (DG) discretization. By working through the contributions from the element's interior and its boundary jumps, you will develop a practical understanding of how these indicators quantify the local failure of the numerical solution to satisfy the governing partial differential equation [@problem_id:3330576].", "problem": "Consider the stationary linear advection–diffusion model problem posed on a bounded domain with a polygonal mesh. On each mesh element, an approximation is represented by a polynomial. In a Discontinuous Galerkin (DG) framework, the elementwise strong residual and edge jumps are combined with scaling that is robust with respect to the polynomial degree, often referred to as $p$-robust scaling. In a conforming continuous finite element framework (Finite Element (FE)), interior edge jumps of the solution vanish, but boundary misfit may be measured analogously. Start from the governing equation for a scalar field $u$: \n$$-\\,\\nu\\,\\Delta u + \\boldsymbol{\\beta}\\cdot\\nabla u = f,$$\nwith prescribed Dirichlet boundary data $g$.\n\nFocus on a single triangular element $K$ with vertices at $(0,0)$, $(1,0)$, and $(0,1)$. Let the approximate numerical solution on $K$ be the polynomial \n$u_h(x,y) = 1 + x - y,$\nof degree $p_K = 1$. Take the diffusion coefficient $\\nu = 1$, the advection field $\\boldsymbol{\\beta} = (1,2)$, and the source term \n$f(x,y) = x - y.$\nAssume homogeneous Dirichlet boundary data $g \\equiv 0$ on $\\partial K$. Define the $p$-robust element indicator by\n$$\\eta_K^2 \\;=\\; \\frac{h_K^2}{p_K^2}\\,\\big\\|\\,f + \\nu\\,\\Delta u_h - \\boldsymbol{\\beta}\\cdot\\nabla u_h\\,\\big\\|_{L^2(K)}^2 \\;+\\; \\sum_{e\\subset\\partial K}\\frac{p_e^2}{h_e}\\,\\big\\|\\,\\llbracket u_h \\rrbracket\\,\\big\\|_{L^2(e)}^2,$$\nwhere $h_K$ is the element diameter (the maximum distance between the triangle’s vertices), $h_e$ is the length of edge $e$, and $\\llbracket u_h \\rrbracket$ denotes the jump of $u_h$ across $e$, which on $\\partial K$ with Dirichlet data is taken as $u_h - g = u_h$. Use $p_e = p_K$ on each edge of $K$. \n\nCompute the exact value of $\\eta_K^2$ as a single real number. No rounding is required, and no units are to be reported. Express your final answer exactly.", "solution": "The problem is valid as it is scientifically grounded in the field of numerical analysis for partial differential equations, is well-posed with all necessary data provided, and is expressed objectively. We proceed with the computation of the element indicator $\\eta_K^2$.\n\nThe formula for the element indicator is given by:\n$$\n\\eta_K^2 = \\frac{h_K^2}{p_K^2}\\,\\big\\|\\,f + \\nu\\,\\Delta u_h - \\boldsymbol{\\beta}\\cdot\\nabla u_h\\,\\big\\|_{L^2(K)}^2 \\;+\\; \\sum_{e\\subset\\partial K}\\frac{p_e^2}{h_e}\\,\\big\\|\\,\\llbracket u_h \\rrbracket\\,\\big\\|_{L^2(e)}^2\n$$\nWe will compute the two terms on the right-hand side separately.\n\n**Part 1: Element Residual Term**\n\nThe first term is the contribution from the element interior residual:\n$$\n\\text{Term 1} = \\frac{h_K^2}{p_K^2}\\,\\big\\|\\,f + \\nu\\,\\Delta u_h - \\boldsymbol{\\beta}\\cdot\\nabla u_h\\,\\big\\|_{L^2(K)}^2\n$$\n\nFirst, we compute the necessary derivatives of the approximate solution $u_h(x,y) = 1 + x - y$.\nThe gradient is:\n$$\n\\nabla u_h = \\left(\\frac{\\partial u_h}{\\partial x}, \\frac{\\partial u_h}{\\partial y}\\right) = (1, -1)\n$$\nThe Laplacian is:\n$$\n\\Delta u_h = \\frac{\\partial^2 u_h}{\\partial x^2} + \\frac{\\partial^2 u_h}{\\partial y^2} = 0 + 0 = 0\n$$\n\nNext, we assemble the strong residual, $R(x,y) = f + \\nu\\,\\Delta u_h - \\boldsymbol{\\beta}\\cdot\\nabla u_h$.\nUsing the given values $\\nu=1$, $\\boldsymbol{\\beta}=(1,2)$, and $f(x,y) = x - y$, we have:\n$$\nR(x,y) = (x - y) + (1)(0) - (1,2)\\cdot(1,-1) = x - y - (1\\cdot 1 + 2\\cdot(-1)) = x - y - (1-2) = x - y + 1\n$$\n\nNow, we compute the squared $L^2$-norm of the residual over the triangular element $K$. The vertices of $K$ are $(0,0)$, $(1,0)$, and $(0,1)$. The domain of integration is described by $0 \\le x \\le 1$ and $0 \\le y \\le 1-x$.\n$$\n\\big\\| R \\big\\|_{L^2(K)}^2 = \\int_K (x - y + 1)^2 \\,dA = \\int_0^1 \\int_0^{1-x} (x - y + 1)^2 \\,dy\\,dx\n$$\nWe evaluate the inner integral with respect to $y$:\n$$\n\\int_0^{1-x} (x + 1 - y)^2 \\,dy = \\left[-\\frac{(x+1-y)^3}{3}\\right]_0^{1-x} = -\\frac{(x+1-(1-x))^3}{3} - \\left(-\\frac{(x+1-0)^3}{3}\\right) = \\frac{(x+1)^3 - (2x)^3}{3}\n$$\nExpanding the polynomials:\n$$\n\\frac{(x^3 + 3x^2 + 3x + 1) - 8x^3}{3} = \\frac{-7x^3 + 3x^2 + 3x + 1}{3}\n$$\nNow we evaluate the outer integral with respect to $x$:\n$$\n\\big\\| R \\big\\|_{L^2(K)}^2 = \\int_0^1 \\frac{-7x^3 + 3x^2 + 3x + 1}{3} \\,dx = \\frac{1}{3}\\left[-\\frac{7x^4}{4} + x^3 + \\frac{3x^2}{2} + x\\right]_0^1 = \\frac{1}{3}\\left(-\\frac{7}{4} + 1 + \\frac{3}{2} + 1\\right) = \\frac{1}{3}\\left(-\\frac{7}{4} + \\frac{4}{4} + \\frac{6}{4} + \\frac{4}{4}\\right) = \\frac{1}{3}\\left(\\frac{7}{4}\\right) = \\frac{7}{12}\n$$\n\nFinally, we determine the pre-factor $\\frac{h_K^2}{p_K^2}$. The polynomial degree is $p_K=1$. The element diameter $h_K$ is the length of the longest side of the triangle. The side lengths are:\n- $e_1$ (from $(0,0)$ to $(1,0)$): length $1$.\n- $e_2$ (from $(0,0)$ to $(0,1)$): length $1$.\n- $e_3$ (from $(1,0)$ to $(0,1)$): length $\\sqrt{(1-0)^2 + (0-1)^2} = \\sqrt{2}$.\nSo, $h_K = \\sqrt{2}$, and $h_K^2 = 2$.\nThe pre-factor is $\\frac{h_K^2}{p_K^2} = \\frac{2}{1^2} = 2$.\nTherefore, the first term is:\n$$\n\\text{Term 1} = 2 \\cdot \\frac{7}{12} = \\frac{7}{6}\n$$\n\n**Part 2: Boundary Jump Term**\n\nThe second term is the sum of contributions from the jumps on the element boundary $\\partial K$.\n$$\n\\text{Term 2} = \\sum_{e\\subset\\partial K}\\frac{p_e^2}{h_e}\\,\\big\\|\\,\\llbracket u_h \\rrbracket\\,\\big\\|_{L^2(e)}^2\n$$\nOn the boundary $\\partial K$, the jump is defined as $\\llbracket u_h \\rrbracket = u_h - g$. With homogeneous Dirichlet data $g=0$, this simplifies to $\\llbracket u_h \\rrbracket = u_h$. We are also given $p_e=p_K=1$ for all edges $e$.\n\nWe calculate the contribution for each of the three edges:\n\n- **Edge $e_1$:** Segment from $(0,0)$ to $(1,0)$.\nHere, $y=0$ and $x \\in [0,1]$. The edge length is $h_{e_1} = 1$.\nThe solution restricted to this edge is $u_h(x,0) = 1 + x - 0 = 1+x$.\nThe squared $L^2$-norm is:\n$$\n\\big\\| u_h \\big\\|_{L^2(e_1)}^2 = \\int_0^1 (1+x)^2 \\,dx = \\left[\\frac{(1+x)^3}{3}\\right]_0^1 = \\frac{2^3}{3} - \\frac{1^3}{3} = \\frac{7}{3}\n$$\nThe contribution from $e_1$ is $\\frac{p_{e_1}^2}{h_{e_1}}\\big\\| u_h \\big\\|_{L^2(e_1)}^2 = \\frac{1^2}{1} \\cdot \\frac{7}{3} = \\frac{7}{3}$.\n\n- **Edge $e_2$:** Segment from $(0,0)$ to $(0,1)$.\nHere, $x=0$ and $y \\in [0,1]$. The edge length is $h_{e_2} = 1$.\nThe solution restricted to this edge is $u_h(0,y) = 1 + 0 - y = 1-y$.\nThe squared $L^2$-norm is:\n$$\n\\big\\| u_h \\big\\|_{L^2(e_2)}^2 = \\int_0^1 (1-y)^2 \\,dy = \\left[-\\frac{(1-y)^3}{3}\\right]_0^1 = 0 - \\left(-\\frac{1^3}{3}\\right) = \\frac{1}{3}\n$$\nThe contribution from $e_2$ is $\\frac{p_{e_2}^2}{h_{e_2}}\\big\\| u_h \\big\\|_{L^2(e_2)}^2 = \\frac{1^2}{1} \\cdot \\frac{1}{3} = \\frac{1}{3}$.\n\n- **Edge $e_3$:** Segment from $(1,0)$ to $(0,1)$.\nThis edge is described by the line $y=1-x$ for $x \\in [0,1]$. The edge length is $h_{e_3} = \\sqrt{2}$. The line element is $ds = \\sqrt{1 + (y')^2}dx = \\sqrt{1 + (-1)^2}dx = \\sqrt{2}dx$.\nThe solution restricted to this edge is $u_h(x, 1-x) = 1 + x - (1-x) = 2x$.\nThe squared $L^2$-norm is a line integral:\n$$\n\\big\\| u_h \\big\\|_{L^2(e_3)}^2 = \\int_{e_3} (u_h)^2 \\,ds = \\int_0^1 (2x)^2 \\sqrt{2} \\,dx = 4\\sqrt{2}\\int_0^1 x^2 \\,dx = 4\\sqrt{2}\\left[\\frac{x^3}{3}\\right]_0^1 = \\frac{4\\sqrt{2}}{3}\n$$\nThe contribution from $e_3$ is $\\frac{p_{e_3}^2}{h_{e_3}}\\big\\| u_h \\big\\|_{L^2(e_3)}^2 = \\frac{1^2}{\\sqrt{2}} \\cdot \\frac{4\\sqrt{2}}{3} = \\frac{4}{3}$.\n\nSumming the contributions from all three edges gives the value of the second term:\n$$\n\\text{Term 2} = \\frac{7}{3} + \\frac{1}{3} + \\frac{4}{3} = \\frac{12}{3} = 4\n$$\n\n**Total Value of $\\eta_K^2$**\n\nFinally, we sum the two terms to find the total value of $\\eta_K^2$:\n$$\n\\eta_K^2 = \\text{Term 1} + \\text{Term 2} = \\frac{7}{6} + 4 = \\frac{7}{6} + \\frac{24}{6} = \\frac{31}{6}\n$$\nThe exact value is $\\frac{31}{6}$.", "answer": "$$\n\\boxed{\\frac{31}{6}}\n$$", "id": "3330576"}, {"introduction": "The power of hp-adaptivity lies in its ability to choose the most efficient refinement strategy: splitting elements (h-refinement) for sharp features or increasing polynomial degree (p-refinement) for smooth solutions. This exercise delves into the logic of this choice by modeling a decision rule based on the decay rate of solution coefficients, a common proxy for local solution smoothness. You will analyze the consequences of this decision by quantifying the trade-off between the expected error reduction and the increase in computational cost for both DG and Continuous Galerkin (CG) frameworks [@problem_id:3330577].", "problem": "Consider a one-dimensional element $K$ of length $h$ inside a mesh used to approximate a scalar field governed by a linear convection-diffusion model with sufficiently smooth coefficients. On $K$, the current polynomial approximation degree is $p \\ge 2$ and the elemental solution is represented in a Legendre polynomial basis. Define the smoothness proxy $r$ by the ratio of the last two modal coefficients $r = |a_{p}|/|a_{p-1}|$. A decision rule for $hp$-adaptivity is used: if $r < \\tau$ increase the local polynomial degree to $p+1$; otherwise split $K$ into two equal subelements at fixed degree $p$. Let the measured proxy be $r = 0.8$ and the threshold be $\\tau = 0.7$, so the rule selects splitting the element.\n\nUse the following widely accepted bases:\n- For functions of Sobolev regularity $s > 0$ on $K$, Legendre coefficients satisfy $|a_{k}| \\sim k^{-(s + 1/2)}$ for large $k$.\n- For best local $L^{2}$-approximation by degree-$p$ polynomials on an interval of length $h$, the error scales like $C\\,h^{s}$ when $s \\le p+1$, with constant $C$ independent of $h$.\n- In one dimension, the local degrees of freedom per element are $p+1$ for Discontinuous Galerkin (DG) methods, and the global degrees of freedom for Continuous Galerkin (CG) methods satisfy $N = \\sum_{K} p_{K} + 1$ for a $C^{0}$ Lagrange basis on a conforming mesh.\n\n(a) Using the proxy $r$ and the asymptotic coefficient decay model $|a_{k}| \\sim k^{-(s + 1/2)}$, estimate the local regularity $s$ in terms of $p$ and $r$, and hence write the expected error reduction factor $f_{h}$ (ratio of new to old local $L^{2}$-error on $K$) after splitting $K$ into two equal subelements at fixed degree $p$.\n\n(b) Quantify the local degree-of-freedom increase $\\Delta N_{\\mathrm{DG}}$ and $\\Delta N_{\\mathrm{CG}}$ produced by splitting $K$ into two equal subelements at fixed degree $p$ for Discontinuous Galerkin (DG) and Continuous Galerkin (CG) methods, respectively.\n\n(c) Define the efficiency metric $\\mathcal{E} = (E_{\\mathrm{old}} - E_{\\mathrm{new}})/\\Delta N$, where $E_{\\mathrm{old}}$ and $E_{\\mathrm{new}}$ are the local $L^{2}$-errors on $K$ before and after refinement, and $\\Delta N$ is the corresponding framework-dependent increase in degrees of freedom computed in part (b). Compute the ratio\n$$\n\\Xi = \\frac{\\mathcal{E}_{\\mathrm{DG}}}{\\mathcal{E}_{\\mathrm{CG}}}\n$$\nfor the decision taken above (splitting). Provide your final answer as a closed-form analytic expression in terms of $p$ only. No numerical rounding is required, and no units are involved.", "solution": "The problem statement is validated as scientifically grounded, well-posed, objective, and self-contained. It is based on established principles and standard models used in the analysis of finite element methods, specifically concerning $hp$-adaptivity, error estimation, and degrees of freedom for Discontinuous Galerkin (DG) and Continuous Galerkin (CG) frameworks. All provided data and definitions are consistent and sufficient to derive a unique solution. The inquiry is formal and computationally relevant. I will now proceed with a complete solution.\n\nThe solution is presented in three parts, corresponding to the questions asked.\n\n(a) Estimation of local regularity $s$ and error reduction factor $f_{h}$.\n\nFirst, we estimate the local Sobolev regularity $s$ of the solution on the element $K$. The problem provides the asymptotic decay model for the Legendre expansion coefficients $a_k$:\n$$|a_{k}| \\sim k^{-(s + 1/2)}$$\nThis model implies that for large, adjacent values of $k$, the constant of proportionality is approximately the same. We can thus write:\n$$|a_{p}| \\approx C p^{-(s + 1/2)}$$\n$$|a_{p-1}| \\approx C (p-1)^{-(s + 1/2)}$$\nThe smoothness proxy $r$ is defined as the ratio $r = |a_{p}|/|a_{p-1}|$. Taking the ratio of the two expressions above gives:\n$$r = \\frac{|a_{p}|}{|a_{p-1}|} \\approx \\frac{p^{-(s + 1/2)}}{(p-1)^{-(s + 1/2)}} = \\left(\\frac{p-1}{p}\\right)^{s + 1/2} = \\left(1 - \\frac{1}{p}\\right)^{s + 1/2}$$\nTo solve for $s$, we take the natural logarithm of both sides:\n$$\\ln(r) \\approx \\left(s + \\frac{1}{2}\\right) \\ln\\left(1 - \\frac{1}{p}\\right)$$\nThis gives an expression for $s + 1/2$:\n$$s + \\frac{1}{2} \\approx \\frac{\\ln(r)}{\\ln(1 - 1/p)}$$\nIsolating $s$, we obtain the estimate for the local regularity:\n$$s \\approx \\frac{\\ln(r)}{\\ln(1 - 1/p)} - \\frac{1}{2}$$\nNext, we determine the expected error reduction factor $f_{h}$. The problem states that for a solution with regularity $s$, the local $L^2$-error on an element of length $H$ scales as $E \\propto H^s$. Let the old error on element $K$ of length $h$ be $E_{\\mathrm{old}}$. Based on the scaling law:\n$$E_{\\mathrm{old}} \\propto h^s$$\nWhen the element $K$ is split into two equal subelements, $K_1$ and $K_2$, each new element has length $h/2$. The approximation is performed on each subelement with the same polynomial degree $p$. The local $L^2$-error on each subelement, $E_1$ and $E_2$, will be:\n$$E_1 \\propto \\left(\\frac{h}{2}\\right)^s \\quad \\text{and} \\quad E_2 \\propto \\left(\\frac{h}{2}\\right)^s$$\nThe new total $L^2$-error on the domain of the original element $K$ is given by the square root of the sum of the squared errors on the subdomains:\n$$E_{\\mathrm{new}} = \\sqrt{E_1^2 + E_2^2}$$\nAssuming the constant of proportionality is the same for the parent and sub-elements, we can write $E_1 = C(h/2)^s$ and $E_2 = C(h/2)^s$, while $E_{\\mathrm{old}} = C h^s$.\n$$E_{\\mathrm{new}}^2 = \\left(C \\left(\\frac{h}{2}\\right)^s\\right)^2 + \\left(C \\left(\\frac{h}{2}\\right)^s\\right)^2 = 2 C^2 \\left(\\frac{h}{2}\\right)^{2s} = 2 C^2 h^{2s} 2^{-2s} = 2^{1-2s} (C h^s)^2 = 2^{1-2s} E_{\\mathrm{old}}^2$$\nTaking the square root, we find the relation between the new and old error:\n$$E_{\\mathrm{new}} = \\sqrt{2^{1-2s}} E_{\\mathrm{old}} = 2^{(1-2s)/2} E_{\\mathrm{old}} = 2^{1/2 - s} E_{\\mathrm{old}}$$\nThe error reduction factor $f_{h}$ is the ratio $E_{\\mathrm{new}}/E_{\\mathrm{old}}$:\n$$f_{h} = 2^{1/2 - s}$$\nWhile we could substitute the expression for $s$ in terms of $r$ and $p$, it is not required for the final answer in part (c), and part (a) only requests the expected factor. The question is phrased to suggest writing $f_h$ in terms of $s$, which is $f_h=2^{1/2-s}$. However, to be fully explicit as requested (\"write the expected error reduction factor\"), we can substitute $s$:\n$$f_h = 2^{1/2 - \\left(\\frac{\\ln(r)}{\\ln(1 - 1/p)} - \\frac{1}{2}\\right)} = 2^{1 - \\frac{\\ln(r)}{\\ln(1 - 1/p)}}$$\n\n(b) Quantification of the increase in degrees of freedom ($\\Delta N$).\n\nWe compute the increase in degrees of freedom ($\\Delta N$) for both DG and CG methods when one element of degree $p$ is split into two elements of degree $p$.\n\nFor the Discontinuous Galerkin (DG) method, the degrees of freedom (DOFs) are local to each element. The problem states that there are $p+1$ DOFs per element.\nBefore splitting, we have one element $K$, contributing $N_{\\mathrm{DG, old}} = p+1$ DOFs.\nAfter splitting, we have two elements, $K_1$ and $K_2$. Each contributes $p+1$ DOFs. The total number of DOFs on the original domain is $N_{\\mathrm{DG, new}} = (p+1) + (p+1) = 2(p+1)$.\nThe increase in the number of DOFs is:\n$$\\Delta N_{\\mathrm{DG}} = N_{\\mathrm{DG, new}} - N_{\\mathrm{DG, old}} = 2(p+1) - (p+1) = p+1$$\n\nFor the Continuous Galerkin (CG) method with a $C^0$ Lagrange basis, the DOFs are shared at vertices. The problem provides the formula for the total number of global DOFs in a 1D mesh: $N = \\sum_{K} p_{K} + 1$, where the sum is over all elements in the mesh and $p_K$ is the polynomial degree on element $K$.\nLet the initial mesh have a set of elements $\\mathcal{T}_{\\mathrm{old}}$. The total number of DOFs is $N_{\\mathrm{CG, old}} = \\left(\\sum_{K_i \\in \\mathcal{T}_{\\mathrm{old}}} p_{K_i}\\right) + 1$.\nWhen we split one element $K$ of degree $p$ into two elements $K_1$ and $K_2$, both of degree $p$, the new set of elements is $\\mathcal{T}_{\\mathrm{new}} = (\\mathcal{T}_{\\mathrm{old}} \\setminus \\{K\\}) \\cup \\{K_1, K_2\\}$.\nThe sum of polynomial degrees over the new mesh is:\n$$\\sum_{K_j \\in \\mathcal{T}_{\\mathrm{new}}} p_{K_j} = \\left(\\sum_{K_i \\in \\mathcal{T}_{\\mathrm{old}} \\setminus \\{K\\}} p_{K_i}\\right) + p_{K_1} + p_{K_2} = \\left(\\sum_{K_i \\in \\mathcal{T}_{\\mathrm{old}} \\setminus \\{K\\}} p_{K_i}\\right) + p + p$$\nThe sum of degrees over the old mesh was:\n$$\\sum_{K_i \\in \\mathcal{T}_{\\mathrm{old}}} p_{K_i} = \\left(\\sum_{K_i \\in \\mathcal{T}_{\\mathrm{old}} \\setminus \\{K\\}} p_{K_i}\\right) + p$$\nThe change in the sum is $(p+p)-p=p$.\nThe new total number of DOFs is $N_{\\mathrm{CG, new}} = \\left(\\sum_{K_j \\in \\mathcal{T}_{\\mathrm{new}}} p_{K_j}\\right) + 1$.\nThe increase in the number of DOFs is:\n$$\\Delta N_{\\mathrm{CG}} = N_{\\mathrm{CG, new}} - N_{\\mathrm{CG, old}} = \\left( \\left(\\sum_{K_j \\in \\mathcal{T}_{\\mathrm{new}}} p_{K_j}\\right) + 1 \\right) - \\left( \\left(\\sum_{K_i \\in \\mathcal{T}_{\\mathrm{old}}} p_{K_i}\\right) + 1 \\right) = \\left(\\sum_{K_j \\in \\mathcal{T}_{\\mathrm{new}}} p_{K_j}\\right) - \\left(\\sum_{K_i \\in \\mathcal{T}_{\\mathrm{old}}} p_{K_i}\\right) = p$$\n\n(c) Computation of the efficiency ratio $\\Xi$.\n\nThe efficiency metric is defined as $\\mathcal{E} = (E_{\\mathrm{old}} - E_{\\mathrm{new}})/\\Delta N$. This metric quantifies the error reduction achieved per added degree of freedom. We are asked to compute the ratio $\\Xi = \\mathcal{E}_{\\mathrm{DG}} / \\mathcal{E}_{\\mathrm{CG}}$.\n\nThe efficiency for the DG method is:\n$$\\mathcal{E}_{\\mathrm{DG}} = \\frac{E_{\\mathrm{old}} - E_{\\mathrm{new}}}{\\Delta N_{\\mathrm{DG}}}$$\nThe efficiency for the CG method is:\n$$\\mathcal{E}_{\\mathrm{CG}} = \\frac{E_{\\mathrm{old}} - E_{\\mathrm{new}}}{\\Delta N_{\\mathrm{CG}}}$$\nThe numerator, $E_{\\mathrm{old}} - E_{\\mathrm{new}}$, represents the total reduction in local $L^2$-error. This reduction is a property of the local approximation space and is independent of whether the DG or CG formulation is used to couple the elements globally. Therefore, this term is identical for both $\\mathcal{E}_{\\mathrm{DG}}$ and $\\mathcal{E}_{\\mathrm{CG}}$.\n\nThe ratio $\\Xi$ is then:\n$$\\Xi = \\frac{\\mathcal{E}_{\\mathrm{DG}}}{\\mathcal{E}_{\\mathrm{CG}}} = \\frac{(E_{\\mathrm{old}} - E_{\\mathrm{new}})/\\Delta N_{\\mathrm{DG}}}{(E_{\\mathrm{old}} - E_{\\mathrm{new}})/\\Delta N_{\\mathrm{CG}}}$$\nSince $E_{\\mathrm{old}} \\neq E_{\\mathrm{new}}$ (as $s$ is finite), the error reduction term is non-zero and cancels out:\n$$\\Xi = \\frac{\\Delta N_{\\mathrm{CG}}}{\\Delta N_{\\mathrm{DG}}}$$\nSubstituting the results from part (b), where we found $\\Delta N_{\\mathrm{DG}} = p+1$ and $\\Delta N_{\\mathrm{CG}} = p$:\n$$\\Xi = \\frac{p}{p+1}$$\nThis is the final closed-form analytic expression in terms of $p$ only. The specific values of the smoothness proxy $r=0.8$ and the threshold $\\tau=0.7$ were only relevant to identify that the chosen refinement strategy was splitting the element ($h$-refinement), but their numerical values do not appear in the final expression for the efficiency ratio $\\Xi$.", "answer": "$$\n\\boxed{\\frac{p}{p+1}}\n$$", "id": "3330577"}]}