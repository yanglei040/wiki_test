{"hands_on_practices": [{"introduction": "This practice explores the fundamental stability challenge in fictitious domain methods when using a simple, explicit time-stepping algorithm. By modeling the penalized interface as an effective mass-spring system, you will analyze how a time lag in applying the constraint force can lead to numerical instability [@problem_id:3317734]. Deriving the stability limit for this system provides a foundational understanding of the critical relationship between the time step size, the penalty stiffness $\\gamma$, and the interface added mass $M_{a}$.", "problem": "Consider a one-dimensional linearized model of fluid–structure interaction treated by a fictitious domain approach, where the fluid occupies a channel and a rigid structure imposes an interface displacement $u_{s}(t)$ at the boundary. The fictitious domain method enforces the interface kinematic constraint by a penalty force of the form $f_{\\Gamma} = \\gamma \\left(u_{s}(t) - u_{f}(t)\\right)$, with $\\gamma  0$ the penalty parameter and $u_{f}(t)$ the fluid-side interface displacement. Assume that the fluid discretization and spatial elimination of bulk degrees of freedom lead to an effective interface inertia described by an interface added mass $M_{a}  0$, so that the interface dynamics are governed by Newton’s second law,\n$$\nM_{a}\\,\\ddot{u}_{f}(t) = f_{\\Gamma}(t) .\n$$\nIn a partitioned time-stepping algorithm, the constraint is lagged by one step: the fluid solver at time $t^{n+1}$ uses the structure’s interface displacement $u_{s}^{n}$ from the previous time level $t^{n}$ to compute the penalty force. The fluid-side interface displacement $u_{f}(t)$ is advanced in time using the explicit central-difference scheme with a uniform time step $\\Delta t  0$.\n\nAssume small perturbations about a steady state with $u_{s}(t)$ constant, and analyze the linear homogeneous dynamics relevant for stability. Starting from Newton’s second law and the explicit central-difference time discretization, derive a discrete amplification relation and use it to obtain a rigorous upper bound on the time step $\\Delta t$ that ensures linear stability of the lagged, partitioned coupling in terms of the interface added mass $M_{a}$ and the penalty parameter $\\gamma$. Your final answer must be a single closed-form analytic expression for the largest admissible time step, and you must express it in seconds. No rounding is required; provide the exact expression.", "solution": "The problem requires the derivation of the stability limit for a partitioned, lagged numerical scheme used to solve a one-dimensional fluid-structure interaction problem modeled via a fictitious domain approach.\n\nThe governing equation for the fluid-side interface displacement, $u_f(t)$, is given by Newton's second law with an interface added mass $M_a$:\n$$\nM_{a}\\,\\ddot{u}_{f}(t) = f_{\\Gamma}(t)\n$$\nThe penalty force $f_{\\Gamma}(t)$ enforces the kinematic constraint at the interface and is defined as:\n$$\nf_{\\Gamma}(t) = \\gamma \\left(u_{s}(t) - u_{f}(t)\\right)\n$$\nwhere $u_s(t)$ is the structural displacement, and $\\gamma  0$ is the penalty parameter.\n\nFor the purpose of linear stability analysis, we consider small perturbations about a steady state where $u_s(t)$ is constant. Let the steady-state displacements be $U_s$ and $U_f$. In a steady state, $\\ddot{u}_f(t) = 0$, which implies $f_{\\Gamma} = 0$, so $U_s = U_f$. We analyze the dynamics of a small perturbation $\\delta u_f(t)$ around this steady state, so $u_f(t) = U_f + \\delta u_f(t)$. The structural displacement is held constant, so $u_s(t) = U_s$. Substituting these into the governing equation yields:\n$$\nM_{a}\\,\\frac{d^2}{dt^2}(U_f + \\delta u_f(t)) = \\gamma \\left(U_s - (U_f + \\delta u_f(t))\\right)\n$$\nSince $U_f$ and $U_s$ are constants and $U_s = U_f$, the equation for the perturbation $\\delta u_f(t)$ simplifies to the homogeneous form. For notational simplicity, we will denote the perturbation $\\delta u_f(t)$ as $u_f(t)$:\n$$\nM_{a}\\,\\ddot{u}_{f}(t) = -\\gamma u_{f}(t)\n$$\nThis is the equation of a simple harmonic oscillator with angular frequency $\\omega = \\sqrt{\\gamma / M_a}$.\n\nThe problem specifies that this equation is discretized in time using the explicit central-difference scheme with a uniform time step $\\Delta t$. The second time derivative at time $t^n = n \\Delta t$ is approximated as:\n$$\n\\ddot{u}_{f}(t^n) \\approx \\frac{u_f^{n+1} - 2u_f^n + u_f^{n-1}}{(\\Delta t)^2}\n$$\nwhere $u_f^n$ denotes the value of $u_f$ at time step $n$. The problem states that the coupling is lagged such that the force term is evaluated at time $t^n$ to compute the state at $t^{n+1}$. For the homogeneous equation, the discrete system is:\n$$\nM_a \\left(\\frac{u_f^{n+1} - 2u_f^n + u_f^{n-1}}{(\\Delta t)^2}\\right) = -\\gamma u_f^n\n$$\nThis is a linear, constant-coefficient difference equation. To analyze its stability, we seek a solution of the form $u_f^n = G^n$, where $G$ is the complex amplification factor. Substituting this ansatz into the difference equation gives:\n$$\nM_a \\left(\\frac{G^{n+1} - 2G^n + G^{n-1}}{(\\Delta t)^2}\\right) = -\\gamma G^n\n$$\nDividing by $G^{n-1}$ (for non-trivial solutions where $G \\neq 0$):\n$$\nM_a \\left(\\frac{G^2 - 2G + 1}{(\\Delta t)^2}\\right) = -\\gamma G\n$$\nThis equation is the discrete amplification relation. We rearrange it into a quadratic characteristic equation for the amplification factor $G$:\n$$\nM_a (G^2 - 2G + 1) = -\\gamma (\\Delta t)^2 G\n$$\n$$\nM_a G^2 - 2M_a G + M_a = -\\gamma (\\Delta t)^2 G\n$$\n$$\nM_a G^2 + \\left(\\gamma (\\Delta t)^2 - 2M_a\\right) G + M_a = 0\n$$\nFor the numerical scheme to be stable, the magnitudes of the roots $G$ of this quadratic equation must not exceed $1$. That is, we require $|G| \\le 1$. Let us solve for $G$:\n$$\nG = \\frac{-\\left(\\gamma (\\Delta t)^2 - 2M_a\\right) \\pm \\sqrt{\\left(\\gamma (\\Delta t)^2 - 2M_a\\right)^2 - 4(M_a)(M_a)}}{2M_a}\n$$\n$$\nG = \\frac{2M_a - \\gamma (\\Delta t)^2 \\pm \\sqrt{\\left(\\gamma (\\Delta t)^2\\right)^2 - 4M_a \\gamma (\\Delta t)^2 + 4M_a^2 - 4M_a^2}}{2M_a}\n$$\n$$\nG = \\frac{2M_a - \\gamma (\\Delta t)^2 \\pm \\sqrt{\\left(\\gamma (\\Delta t)^2\\right)^2 - 4M_a \\gamma (\\Delta t)^2}}{2M_a}\n$$\n$$\nG = \\frac{2M_a - \\gamma (\\Delta t)^2 \\pm \\sqrt{\\gamma (\\Delta t)^2 \\left(\\gamma (\\Delta t)^2 - 4M_a\\right)}}{2M_a}\n$$\nThe nature of the roots depends on the sign of the discriminant, $\\Delta_d = \\gamma (\\Delta t)^2 (\\gamma (\\Delta t)^2 - 4M_a)$. Since $\\gamma  0$, $(\\Delta t)^2  0$, the sign is determined by the term $(\\gamma (\\Delta t)^2 - 4M_a)$.\n\nCase 1: $\\gamma (\\Delta t)^2 - 4M_a  0$.\nIn this case, $\\Delta_d  0$, and the roots $G_1, G_2$ are real and distinct. From the characteristic polynomial $M_a G^2 + \\dots + M_a = 0$, the product of the roots is $G_1 G_2 = M_a / M_a = 1$. If the roots are real and their product is $1$, one root must have a magnitude greater than $1$ (unless both are $1$ or both are $-1$, which is not the case here as they are distinct). Therefore, the scheme is unstable. This case corresponds to $(\\Delta t)^2  4M_a / \\gamma$.\n\nCase 2: $\\gamma (\\Delta t)^2 - 4M_a = 0$.\nIn this case, $\\Delta_d = 0$, and there is a repeated real root. This corresponds to the stability boundary.\n$$\n\\gamma (\\Delta t)^2 = 4M_a\n$$\nThe root is $G = \\frac{2M_a - \\gamma (\\Delta t)^2}{2M_a} = \\frac{2M_a - 4M_a}{2M_a} = \\frac{-2M_a}{2M_a} = -1$.\nSince $|G|=1$, the scheme is on the boundary of stability.\n\nCase 3: $\\gamma (\\Delta t)^2 - 4M_a  0$.\nIn this case, $\\Delta_d  0$, and the roots are a complex conjugate pair.\n$$\nG = \\frac{2M_a - \\gamma (\\Delta t)^2 \\pm i \\sqrt{\\gamma (\\Delta t)^2 \\left(4M_a - \\gamma (\\Delta t)^2\\right)}}{2M_a}\n$$\nThe magnitude of the complex roots is given by $|G|^2 = (\\text{Re}(G))^2 + (\\text{Im}(G))^2$.\n$$\n|G|^2 = \\left(\\frac{2M_a - \\gamma (\\Delta t)^2}{2M_a}\\right)^2 + \\frac{\\gamma (\\Delta t)^2 \\left(4M_a - \\gamma (\\Delta t)^2\\right)}{(2M_a)^2}\n$$\n$$\n|G|^2 = \\frac{4M_a^2 - 4M_a\\gamma(\\Delta t)^2 + (\\gamma(\\Delta t)^2)^2 + 4M_a\\gamma(\\Delta t)^2 - (\\gamma(\\Delta t)^2)^2}{4M_a^2}\n$$\n$$\n|G|^2 = \\frac{4M_a^2}{4M_a^2} = 1\n$$\nIn this case, $|G|=1$, which means the numerical solution has a constant amplitude, representing a neutrally stable behavior. This is acceptable for a non-dissipative scheme. This case corresponds to $(\\Delta t)^2  4M_a / \\gamma$.\n\nCombining the cases, the condition for linear stability ($|G| \\le 1$) is satisfied if $\\gamma (\\Delta t)^2 - 4M_a \\le 0$.\n$$\n\\gamma (\\Delta t)^2 \\le 4M_a\n$$\nSince $\\Delta t  0$, we can solve for the time step:\n$$\n(\\Delta t)^2 \\le \\frac{4M_a}{\\gamma}\n$$\n$$\n\\Delta t \\le \\sqrt{\\frac{4M_a}{\\gamma}}\n$$\n$$\n\\Delta t \\le 2\\sqrt{\\frac{M_a}{\\gamma}}\n$$\nThe largest admissible time step, or the critical time step for stability, is the upper bound of this inequality. The units of $\\sqrt{M_a/\\gamma}$ are $\\sqrt{\\text{kg} / (\\text{N}/\\text{m})} = \\sqrt{\\text{kg} / (\\text{kg}\\cdot\\text{s}^{-2})} = \\sqrt{\\text{s}^2} = \\text{s}$, which is seconds, as requested.\nThe result is $\\Delta t_{\\text{max}} = 2\\sqrt{\\frac{M_a}{\\gamma}}$.", "answer": "$$\\boxed{2\\sqrt{\\frac{M_a}{\\gamma}}}$$", "id": "3317734"}, {"introduction": "Building on the analysis of simple explicit schemes, we now examine a more practical and robust partitioned approach: operator splitting combined with structural subcycling. This technique allows for a larger fluid time step by resolving the stiff structural dynamics on a finer time scale, but its stability is not guaranteed [@problem_id:3317711]. This exercise guides you through the stability analysis of a subcycled Brinkman penalization scheme, revealing the conditions that ensure a stable and accurate simulation and highlighting the trade-offs between computational cost and stability.", "problem": "Consider a fluid–structure interaction in the fictitious domain framework in Computational Fluid Dynamics (CFD), where the fluid velocity field $u$ is coupled to a structure velocity field $v$ through a Brinkman penalization term. In the solid subdomain (characteristic function $\\chi=1$) and for the highest-wavenumber mode that dominates stability, neglect advection and diffusion and model the coupling by the linear momentum exchange\n$$\n\\rho_{f} \\frac{d u}{d t} \\;=\\; -\\alpha \\left(u - v\\right), \\qquad \\rho_{s} \\frac{d v}{d t} \\;=\\; \\alpha \\left(u - v\\right),\n$$\nwhere $\\rho_{f}0$ is the fluid density, $\\rho_{s}0$ is the solid density, and $\\alpha0$ is the Brinkman penalization coefficient imposing near no-slip $u\\approx v$ in the solid region.\n\nYou are to incorporate structural subcycling into a first-order operator-split time integrator over one fluid time step $ \\Delta t  0 $ as follows:\n- The structure is advanced over $m \\in \\mathbb{N}$ substeps of size $\\Delta t_{s} = \\Delta t/m$ using explicit Euler with the fluid velocity held fixed at its known value at the beginning of the fluid step, $u^{n}$.\n- After completing the $m$ structural substeps to obtain $v^{n+1}$, the fluid velocity is advanced over $\\Delta t$ using backward Euler for the penalization term, with $v^{n+1}$ treated as known.\n\nStarting from these definitions and the fundamental balance laws above, derive the one-step amplification factor for the velocity mismatch $w := u - v$ and use it to establish conditions on $\\alpha$, $\\Delta t$, and $m$ that guarantee linear stability and first-order accuracy of the coupled update. Then, determine the largest fluid time step $\\Delta t_{\\max}$ such that the coupled update is linearly stable for any initial mismatch $w^{n}$.\n\nProvide your final answer as the closed-form expression for $\\Delta t_{\\max}$ in terms of $\\alpha$, $\\rho_{s}$, and $m$. Express $\\Delta t_{\\max}$ in seconds. No numerical substitution is required, and no rounding is needed. The derivation must proceed from the stated laws and the specified subcycling scheme without invoking unstated formulas.", "solution": "We begin from the linear momentum exchange model in the solid region,\n$$\n\\rho_{f} \\frac{d u}{d t} \\;=\\; -\\alpha \\left(u - v\\right), \\qquad \\rho_{s} \\frac{d v}{d t} \\;=\\; \\alpha \\left(u - v\\right),\n$$\nwhich expresses the Brinkman penalization force $-\\alpha (u - v)$ on the fluid and the equal and opposite force $+\\alpha (u - v)$ on the structure. For stability analysis, it is sufficient to consider the evolution of the velocity mismatch\n$$\nw(t) \\;:=\\; u(t) - v(t).\n$$\nDifferentiating and using the governing equations, the continuous-time mismatch dynamics is\n$$\n\\frac{d w}{d t} \\;=\\; \\frac{d u}{d t} - \\frac{d v}{d t} \\;=\\; -\\frac{\\alpha}{\\rho_{f}} \\left(u - v\\right) - \\frac{\\alpha}{\\rho_{s}} \\left(u - v\\right) \\;=\\; -\\alpha \\left(\\frac{1}{\\rho_{f}} + \\frac{1}{\\rho_{s}}\\right) w.\n$$\nThus, the exact continuous-time decay over one fluid time step $\\Delta t$ is\n$$\nw(t^{n} + \\Delta t) \\;=\\; \\exp\\!\\left[-\\alpha \\left(\\frac{1}{\\rho_{f}} + \\frac{1}{\\rho_{s}}\\right) \\Delta t \\right] w(t^{n}).\n$$\nWe now incorporate the specified structural subcycling and fluid update.\n\nStructural subcycling over $m$ explicit Euler substeps with the fluid velocity held fixed at $u^{n}$ uses the discrete update\n$$\nv^{n,(k+1)} \\;=\\; v^{n,(k)} + \\Delta t_{s} \\,\\frac{\\alpha}{\\rho_{s}} \\left(u^{n} - v^{n,(k)}\\right), \\qquad k=0,1,\\dots,m-1,\n$$\nwhere $v^{n,(0)} = v^{n}$ is the initial structure velocity at the beginning of the fluid step, and $v^{n,(m)} = v^{n+1}$ is the structure velocity at the end of subcycling. This can be rewritten as\n$$\nv^{n,(k+1)} - u^{n} \\;=\\; \\left(1 - \\beta\\right) \\left(v^{n,(k)} - u^{n}\\right), \\qquad \\beta \\;:=\\; \\frac{\\alpha}{\\rho_{s}} \\Delta t_{s} \\;=\\; \\frac{\\alpha}{\\rho_{s}} \\frac{\\Delta t}{m}.\n$$\nIterating $m$ times gives\n$$\nv^{n+1} \\;=\\; u^{n} + \\left(v^{n} - u^{n}\\right) s, \\qquad s \\;:=\\; \\left(1 - \\beta\\right)^{m}.\n$$\nNext, the fluid is advanced over $\\Delta t$ using backward Euler for the penalization, with $v^{n+1}$ treated as known:\n$$\n\\rho_{f} \\frac{u^{n+1} - u^{n}}{\\Delta t} \\;=\\; -\\alpha \\left(u^{n+1} - v^{n+1}\\right).\n$$\nSolving for $u^{n+1}$ yields\n$$\nu^{n+1} \\;=\\; \\frac{\\rho_{f}}{\\rho_{f} + \\alpha \\Delta t} \\, u^{n} + \\frac{\\alpha \\Delta t}{\\rho_{f} + \\alpha \\Delta t} \\, v^{n+1}.\n$$\nDefine the fluid implicit factor\n$$\n\\gamma \\;:=\\; \\frac{\\rho_{f}}{\\rho_{f} + \\alpha \\Delta t}, \\qquad \\delta \\;:=\\; \\frac{\\alpha \\Delta t}{\\rho_{f} + \\alpha \\Delta t} \\;=\\; 1 - \\gamma.\n$$\nThe one-step mismatch update can now be derived:\n\n$$\n\\begin{aligned}\nw^{n+1} \\;=\\; u^{n+1} - v^{n+1} \\;=\\; \\gamma u^{n} + \\delta v^{n+1} - v^{n+1} \\\\\n=\\; \\gamma u^{n} - (1 - \\delta) v^{n+1} \\;=\\; \\gamma \\left(u^{n} - v^{n+1}\\right) \\\\\n=\\; \\gamma \\left(u^{n} - \\left[s v^{n} + (1 - s) u^{n}\\right]\\right) \\\\\n=\\; \\gamma \\left(s u^{n} - s v^{n}\\right) \\;=\\; \\gamma s \\left(u^{n} - v^{n}\\right) \\;=\\; \\lambda_{w} \\, w^{n},\n\\end{aligned}\n$$\n\nwith the mismatch amplification factor\n$$\n\\lambda_{w} \\;=\\; \\gamma s \\;=\\; \\frac{\\rho_{f}}{\\rho_{f} + \\alpha \\Delta t} \\left(1 - \\frac{\\alpha \\Delta t}{\\rho_{s} m}\\right)^{m}.\n$$\n\nStability condition. Linear stability of the mismatch dynamics requires $|\\lambda_{w}| \\leq 1$ for any initial $w^{n}$. Since $\\gamma \\in (0,1)$ for $\\alpha0$ and $\\Delta t0$, stability is controlled by the explicit structural factor $s$. The explicit Euler substep for the linear relaxation $dv/dt = (\\alpha/\\rho_{s})(u^{n} - v)$ is stable if and only if\n$$\n\\left|1 - \\beta\\right| \\;\\leq\\; 1 \\quad \\Longleftrightarrow \\quad 0 \\;\\leq\\; \\beta \\;\\leq\\; 2,\n$$\nwhich ensures $|s| = |1 - \\beta|^{m} \\leq 1$ and hence $|\\lambda_{w}| \\leq 1$. In terms of the original parameters,\n$$\n0 \\;\\leq\\; \\frac{\\alpha}{\\rho_{s}} \\frac{\\Delta t}{m} \\;\\leq\\; 2 \\quad \\Longleftrightarrow \\quad \\Delta t \\;\\leq\\; \\frac{2 \\rho_{s} m}{\\alpha}.\n$$\nTherefore, the largest fluid time step that preserves linear stability of the coupled update is\n$$\n\\Delta t_{\\max} \\;=\\; \\frac{2 \\rho_{s} m}{\\alpha}.\n$$\n\nAccuracy condition. The exact continuous-time mismatch decay over $\\Delta t$ is\n$$\nw^{n+1,\\mathrm{exact}} \\;=\\; \\exp\\!\\left[-\\alpha \\left(\\frac{1}{\\rho_{f}} + \\frac{1}{\\rho_{s}}\\right) \\Delta t \\right] w^{n}.\n$$\nThe discrete mismatch factor is $\\lambda_{w} = \\gamma s$. For small $\\Delta t$,\n\n$$\n\\gamma \\;=\\; \\frac{1}{1 + \\frac{\\alpha \\Delta t}{\\rho_{f}}} \\;=\\; 1 - \\frac{\\alpha \\Delta t}{\\rho_{f}} + \\mathcal{O}(\\Delta t^{2}),\n$$\n\nand, using $s = \\left(1 - \\frac{\\alpha \\Delta t}{\\rho_{s} m}\\right)^{m}$,\n\n$$\ns \\;=\\; 1 - \\frac{\\alpha \\Delta t}{\\rho_{s}} + \\mathcal{O}(\\Delta t^{2}).\n$$\n\nThus,\n\n$$\n\\lambda_{w} \\;=\\; \\left(1 - \\frac{\\alpha \\Delta t}{\\rho_{f}} + \\mathcal{O}(\\Delta t^{2})\\right) \\left(1 - \\frac{\\alpha \\Delta t}{\\rho_{s}} + \\mathcal{O}(\\Delta t^{2})\\right) \\;=\\; 1 - \\alpha \\left(\\frac{1}{\\rho_{f}} + \\frac{1}{\\rho_{s}}\\right) \\Delta t + \\mathcal{O}(\\Delta t^{2}).\n$$\n\nThis matches the first-order term of the exact exponential decay, establishing first-order accuracy in time for any $m \\in \\mathbb{N}$. To reduce the leading $\\mathcal{O}(\\Delta t^{2})$ error in $s$ from structural subcycling, increasing $m$ decreases the discrepancy of $s$ from the exact $\\exp\\!\\left[-\\frac{\\alpha}{\\rho_{s}} \\Delta t\\right]$, because\n\n$$\ns \\;=\\; \\exp\\!\\left[-\\frac{\\alpha}{\\rho_{s}} \\Delta t - \\frac{1}{2 m} \\left(\\frac{\\alpha}{\\rho_{s}} \\Delta t\\right)^{2} + \\mathcal{O}\\!\\left(\\frac{\\Delta t^{3}}{m^{2}}\\right)\\right].\n$$\n\nIn summary:\n- Stability requires $0 \\leq \\frac{\\alpha \\Delta t}{\\rho_{s} m} \\leq 2$, hence $\\Delta t \\leq \\frac{2 \\rho_{s} m}{\\alpha}$.\n- Accuracy to first order is satisfied for any $m$, with reduced second-order error for larger $m$.\n\nTherefore, the largest fluid time step ensuring linear stability of the subcycled Brinkman penalization update is\n$$\n\\Delta t_{\\max} \\;=\\; \\frac{2 \\rho_{s} m}{\\alpha}.\n$$", "answer": "$$\\boxed{\\frac{2 \\rho_{s} m}{\\alpha}}$$", "id": "3317711"}, {"introduction": "While stable time-stepping is crucial, achieving robust fluid-structure interaction often requires strong coupling, where the fluid and structure equations are solved implicitly within each time step. This typically involves a partitioned iterative solver whose convergence properties are critical for efficiency and success. This final practice [@problem_id:3317727] delves into the convergence analysis of a fixed-point iteration for a strongly coupled system, demonstrating how to derive an optimal coupling parameter based on the physical properties of the interface, represented by impedances $Z_{f}$ and $Z_{s}$.", "problem": "Consider a fictitious domain formulation for Fluid–Structure Interaction (FSI), where enforcement of kinematic continuity at a flat interface is achieved through a penalization of the velocity jump. In a time-discrete linearized setting about a known state, model the interface by a single scalar velocity on each side: the fluid-side velocity $u_{f}$ and the structure-side velocity $u_{s}$, with corresponding interface tractions $t_{f}$ and $t_{s}$. Assume Newton’s third law at the interface and linear time-discrete impedance relations for the homogeneous error system:\n- traction continuity: $t_{f} + t_{s} = 0$,\n- fluid impedance: $t_{f} = Z_{f}\\,u_{f}$,\n- structure impedance: $t_{s} = -Z_{s}\\,u_{s}$,\nwhere $Z_{f}  0$ and $Z_{s}  0$ are the real-valued fluid and structure interface impedances induced by the chosen time discretization and linearization.\n\nYou are to design a strongly coupled fixed-point iteration that uses a symmetric penalization parameter $\\gamma  0$ to form impedance-weighted (Robin-type) transmission conditions. At interface iteration index $k$, let the fluid subproblem be solved with the incoming Robin quantity $t + \\gamma u$ supplied from the structure iterate, and let the structure subproblem be solved with the complementary incoming Robin quantity $t - \\gamma u$ supplied from the fluid iterate, enforcing traction continuity at each exchange.\n\nStarting from the fundamental laws and definitions above, and performing a homogeneous error analysis (i.e., set any external sources to zero so that only the error propagation is analyzed), carry out the following:\n- derive the one-step error propagation factor $q(\\gamma; Z_{f}, Z_{s})$ for the composed fluid–structure iteration, expressed solely in terms of the impedances $Z_{f}$, $Z_{s}$, and the penalization strength $\\gamma$,\n- state the convergence criterion in terms of $|q(\\gamma; Z_{f}, Z_{s})|$ and identify the qualitative dependence on $\\gamma$,\n- determine the value of the penalization strength $\\gamma^{\\star}$ that minimizes the spectral radius $|q(\\gamma; Z_{f}, Z_{s})|$.\n\nYour final answer must be the closed-form expression for $\\gamma^{\\star}$ in terms of $Z_{f}$ and $Z_{s}$. No numerical evaluation is required, and no units are needed for the final result. Express your final answer as a single analytic expression.", "solution": "The problem asks for the derivation of an optimal penalization parameter, $\\gamma^{\\star}$, for a specific strongly coupled fixed-point iteration used in a fictitious domain method for fluid–structure interaction (FSI). The analysis will be performed on the homogeneous error system.\n\nFirst, we formalize the iterative scheme based on the problem description. The system involves fluid-side quantities (velocity $u_f$, traction $t_f$) and structure-side quantities ($u_s$, $t_s$). These are governed by the time-discrete, linearized impedance relations for the error components:\n1.  Fluid impedance: $t_f = Z_f u_f$\n2.  Structure impedance: $t_s = -Z_s u_s$\n\nThe problem specifies constants $Z_f  0$ and $Z_s  0$. The condition for traction continuity at the converged state is $t_f + t_s = 0$, which, using the impedance relations, implies $Z_f u_f - Z_s u_s = 0$. The iteration aims to satisfy this condition as well as the kinematic continuity condition $u_f = u_s$.\n\nThe iteration is described as a partitioned scheme involving the exchange of Robin-type boundary conditions. A composed fluid-structure iteration can be interpreted as a Gauss-Seidel sequence. We assume an ordering where the fluid subproblem is solved first, followed by the structure subproblem. Let $k$ be the iteration index.\n\n**Step 1: Fluid Subproblem Update**\nAt iteration $k+1$, the fluid subproblem is solved using information from the structure at iteration $k$. The transmission condition is given as an equality of Robin quantities:\n$$t_f^{(k+1)} + \\gamma u_f^{(k+1)} = t_s^{(k)} + \\gamma u_s^{(k)}$$\nWe substitute the impedance relations $t_f^{(k+1)} = Z_f u_f^{(k+1)}$ and $t_s^{(k)} = -Z_s u_s^{(k)}$ into this equation:\n$$Z_f u_f^{(k+1)} + \\gamma u_f^{(k+1)} = -Z_s u_s^{(k)} + \\gamma u_s^{(k)}$$\n$$(Z_f + \\gamma) u_f^{(k+1)} = (\\gamma - Z_s) u_s^{(k)}$$\nThis gives the updated fluid velocity error in terms of the previous structure velocity error:\n$$u_f^{(k+1)} = \\frac{\\gamma - Z_s}{\\gamma + Z_f} u_s^{(k)}$$\n\n**Step 2: Structure Subproblem Update**\nIn a Gauss-Seidel fashion, the structure subproblem at iteration $k+1$ is solved using the newly computed fluid state from the same iteration, $(u_f^{(k+1)}, t_f^{(k+1)})$. The transmission condition for the structure is given by the complementary Robin quantity:\n$$t_s^{(k+1)} - \\gamma u_s^{(k+1)} = t_f^{(k+1)} - \\gamma u_f^{(k+1)}$$\nSubstituting the impedance relations $t_s^{(k+1)} = -Z_s u_s^{(k+1)}$ and $t_f^{(k+1)} = Z_f u_f^{(k+1)}$:\n$$-Z_s u_s^{(k+1)} - \\gamma u_s^{(k+1)} = Z_f u_f^{(k+1)} - \\gamma u_f^{(k+1)}$$\n$$-(Z_s + \\gamma) u_s^{(k+1)} = (Z_f - \\gamma) u_f^{(k+1)}$$\nThis yields the updated structure velocity error:\n$$u_s^{(k+1)} = -\\frac{Z_f - \\gamma}{Z_s + \\gamma} u_f^{(k+1)} = \\frac{\\gamma - Z_f}{\\gamma + Z_s} u_f^{(k+1)}$$\n\n**Step 3: Derivation of the One-Step Error Propagation Factor**\nBy composing the two steps, we substitute the expression for $u_f^{(k+1)}$ from the fluid update into the structure update equation:\n$$u_s^{(k+1)} = \\left(\\frac{\\gamma - Z_f}{\\gamma + Z_s}\\right) \\left(\\frac{\\gamma - Z_s}{\\gamma + Z_f}\\right) u_s^{(k)}$$\nThis equation is of the form $u_s^{(k+1)} = q \\, u_s^{(k)}$, where $q$ is the one-step error propagation factor. A similar analysis for $u_f$ gives the same factor. The factor $q$ is given by:\n$$q(\\gamma; Z_f, Z_s) = \\frac{(\\gamma - Z_f)(\\gamma - Z_s)}{(\\gamma + Z_f)(\\gamma + Z_s)}$$\n\n**Step 4: Convergence Criterion and Optimization**\nThe fixed-point iteration converges if the magnitude of the propagation factor, i.e., the spectral radius of the iteration, is less than 1.\n$$|q(\\gamma; Z_f, Z_s)|  1$$\nWe are tasked with finding the value of $\\gamma^{\\star}  0$ that minimizes this spectral radius $|q(\\gamma)|$. Let's analyze the function:\n$$|q(\\gamma)| = \\left| \\frac{(\\gamma - Z_f)(\\gamma - Z_s)}{(\\gamma + Z_f)(\\gamma + Z_s)} \\right| = \\frac{|(\\gamma - Z_f)(\\gamma - Z_s)|}{(\\gamma + Z_f)(\\gamma + Z_s)}$$\nThe denominator is strictly positive for $\\gamma  0$. The numerator becomes zero if $\\gamma = Z_f$ or $\\gamma = Z_s$. Therefore, the absolute minimum value of $|q(\\gamma)|$ is $0$, which is achieved at $\\gamma = Z_f$ or $\\gamma = Z_s$.\n\nHowever, the problem asks for a single value $\\gamma^{\\star}$, which suggests a unique solution that should be a symmetric function of $Z_f$ and $Z_s$. The choices $\\gamma=Z_f$ or $\\gamma=Z_s$ are not unique if $Z_f \\neq Z_s$ and do not exhibit this symmetry. This implies that the problem asks for a robust optimum, a standard concept in the design of iterative methods. The goal is to find the parameter $\\gamma$ that minimizes the worst-case (maximum) convergence factor over the most challenging parameter range.\n\nLet's examine the behavior of $|q(\\gamma)|$ for $\\gamma \\in (0, \\infty)$, assuming without loss of generality that $0  Z_s  Z_f$.\n-   For $0  \\gamma  Z_s$, $q(\\gamma)$ is positive and decreases from $q(0)=1$ to $q(Z_s)=0$.\n-   For $Z_s  \\gamma  Z_f$, $q(\\gamma)$ is negative. $|q(\\gamma)|$ increases from $0$ to a local maximum and then decreases back to $0$ at $\\gamma=Z_f$.\n-   For $\\gamma  Z_f$, $q(\\gamma)$ is positive and increases from $q(Z_f)=0$, approaching $1$ as $\\gamma \\to \\infty$.\n\nThe most robust choice for $\\gamma$ is the one that minimizes the local maximum of $|q(\\gamma)|$ in the interval $\\gamma \\in (Z_s, Z_f)$. This is a minimax approach: $\\min_{\\gamma} \\max_{z \\in [Z_s, Z_f]} |q(\\gamma, z)|$. The value of $\\gamma$ that achieves this provides the best guaranteed convergence rate in the challenging region between the two known roots.\n\nWe find the extremum of $|q(\\gamma)|$ in the interval $(Z_s, Z_f)$, where $|q(\\gamma)| = -q(\\gamma)$. Let this function be $g(\\gamma)$:\n$$g(\\gamma) = -\\frac{(\\gamma - Z_f)(\\gamma - Z_s)}{(\\gamma + Z_f)(\\gamma + Z_s)} = \\frac{(Z_f - \\gamma)(\\gamma - Z_s)}{(\\gamma + Z_f)(\\gamma + Z_s)}$$\nTo find the maximum, we set its derivative to zero. It is easier to work with the logarithmic derivative, $(\\ln g(\\gamma))' = 0$:\n$$\\frac{d}{d\\gamma} \\left( \\ln(Z_f - \\gamma) + \\ln(\\gamma - Z_s) - \\ln(\\gamma + Z_f) - \\ln(\\gamma + Z_s) \\right) = 0$$\n$$\\frac{-1}{Z_f - \\gamma} + \\frac{1}{\\gamma - Z_s} - \\frac{1}{\\gamma + Z_f} - \\frac{1}{\\gamma + Z_s} = 0$$\nRearranging terms to group by impedance:\n$$\\left( \\frac{1}{\\gamma - Z_f} - \\frac{1}{\\gamma + Z_f} \\right) + \\left( \\frac{1}{\\gamma - Z_s} - \\frac{1}{\\gamma + Z_s} \\right) = 0$$\n$$\\frac{(\\gamma + Z_f) - (\\gamma - Z_f)}{(\\gamma - Z_f)(\\gamma + Z_f)} + \\frac{(\\gamma + Z_s) - (\\gamma - Z_s)}{(\\gamma - Z_s)(\\gamma + Z_s)} = 0$$\n$$\\frac{2Z_f}{\\gamma^2 - Z_f^2} + \\frac{2Z_s}{\\gamma^2 - Z_s^2} = 0$$\nSince $\\gamma$ is in $(Z_s, Z_f)$, $\\gamma^2 - Z_s^2  0$ and $\\gamma^2 - Z_f^2  0$.\n$$\\frac{Z_f}{Z_f^2 - \\gamma^2} = \\frac{Z_s}{\\gamma^2 - Z_s^2}$$\n$$Z_f(\\gamma^2 - Z_s^2) = Z_s(Z_f^2 - \\gamma^2)$$\n$$Z_f \\gamma^2 - Z_f Z_s^2 = Z_s Z_f^2 - Z_s \\gamma^2$$\n$$\\gamma^2 (Z_f + Z_s) = Z_s Z_f^2 + Z_f Z_s^2 = Z_f Z_s (Z_f + Z_s)$$\nSince $Z_f + Z_s  0$, we can divide by this term:\n$$\\gamma^2 = Z_f Z_s$$\nThe optimal penalization strength $\\gamma^{\\star}$ is the positive square root:\n$$\\gamma^{\\star} = \\sqrt{Z_f Z_s}$$\nThis value, the geometric mean of the impedances, is guaranteed to lie between $Z_f$ and $Z_s$ and provides the most robust convergence behavior in the minimax sense. It is the unique, symmetric solution expected for this problem.", "answer": "$$\\boxed{\\sqrt{Z_f Z_s}}$$", "id": "3317727"}]}