{"hands_on_practices": [{"introduction": "The fundamental link between the Eulerian and Lagrangian descriptions is the differential equation that governs a particle's motion. This exercise [@problem_id:3338625] provides a foundational practice in deriving the Lagrangian flow map, $\\boldsymbol{\\chi}(\\boldsymbol{X},t)$, directly from a given Eulerian velocity field, $\\boldsymbol{v}(\\boldsymbol{x},t)$. By considering a general linear velocity field, you will see how the problem reduces to a system of linear ordinary differential equations, whose solution is elegantly expressed using the matrix exponential, a powerful tool in the study of dynamical systems.", "problem": "Consider a continuum of fluid parcels in $\\mathbb{R}^{n}$ labeled by their initial positions $\\boldsymbol{X} \\in \\mathbb{R}^{n}$ at time $t=0$. The Eulerian velocity field is given by $\\boldsymbol{v}(\\boldsymbol{x},t)=\\boldsymbol{A}\\boldsymbol{x}$, where $\\boldsymbol{A} \\in \\mathbb{R}^{n \\times n}$ is a constant matrix independent of $\\boldsymbol{x}$ and $t$. The Lagrangian flow map $\\boldsymbol{\\chi}(\\boldsymbol{X},t)$ is defined as the position at time $t$ of the parcel initially at $\\boldsymbol{X}$, and by definition satisfies the initial-value problem\n$$\n\\frac{d}{dt}\\,\\boldsymbol{\\chi}(\\boldsymbol{X},t) = \\boldsymbol{v}\\big(\\boldsymbol{\\chi}(\\boldsymbol{X},t),t\\big), \\qquad \\boldsymbol{\\chi}(\\boldsymbol{X},0)=\\boldsymbol{X}.\n$$\nStarting from the fundamental definition of the flow map and the given Eulerian field, derive a closed-form analytic expression for $\\boldsymbol{\\chi}(\\boldsymbol{X},t)$ in terms of $\\boldsymbol{A}$, $\\boldsymbol{X}$, and $t$. Your final answer must be a single closed-form expression. No numerical evaluation is required, and no units are to be reported in the final answer.", "solution": "The problem is deemed valid as it is scientifically grounded in the principles of continuum mechanics, mathematically well-posed, and objectively stated. It presents a standard initial-value problem for determining a particle's trajectory (the Lagrangian flow map) from a given velocity field (the Eulerian description). All necessary data and definitions are provided, and there are no internal contradictions or ambiguities.\n\nThe starting point for this derivation is the definition of the Lagrangian flow map, $\\boldsymbol{\\chi}(\\boldsymbol{X},t)$, which describes the position at time $t$ of a fluid parcel that was at position $\\boldsymbol{X}$ at time $t=0$. The evolution of this position is governed by the ordinary differential equation (ODE) that relates the particle's velocity to the Eulerian velocity field evaluated at the particle's current position. This is given as:\n$$\n\\frac{d}{dt}\\,\\boldsymbol{\\chi}(\\boldsymbol{X},t) = \\boldsymbol{v}\\big(\\boldsymbol{\\chi}(\\boldsymbol{X},t),t\\big)\n$$\nThe problem specifies the Eulerian velocity field as $\\boldsymbol{v}(\\boldsymbol{x},t) = \\boldsymbol{A}\\boldsymbol{x}$, where $\\boldsymbol{A}$ is a constant $n \\times n$ matrix. Substituting the particle's position $\\boldsymbol{\\chi}(\\boldsymbol{X},t)$ for the generic position variable $\\boldsymbol{x}$, we obtain the specific form of the ODE for this flow:\n$$\n\\frac{d}{dt}\\,\\boldsymbol{\\chi}(\\boldsymbol{X},t) = \\boldsymbol{A}\\,\\boldsymbol{\\chi}(\\boldsymbol{X},t)\n$$\nThis is a system of $n$ linear, first-order, homogeneous ordinary differential equations with constant coefficients. The variable being solved for is the vector $\\boldsymbol{\\chi}(\\boldsymbol{X},t)$, where $\\boldsymbol{X}$ is treated as a parameter that labels the specific fluid parcel. The initial condition, which specifies the starting position of the parcel at $t=0$, is given as:\n$$\n\\boldsymbol{\\chi}(\\boldsymbol{X},0) = \\boldsymbol{X}\n$$\nThe general solution to a system of ODEs of the form $\\frac{d\\boldsymbol{y}}{dt} = \\boldsymbol{A}\\boldsymbol{y}$ is given by $\\boldsymbol{y}(t) = \\exp(\\boldsymbol{A}t)\\boldsymbol{C}$, where $\\boldsymbol{C}$ is a constant vector of integration and $\\exp(\\boldsymbol{A}t)$ is the matrix exponential. The matrix exponential is defined by its Taylor series expansion:\n$$\n\\exp(\\boldsymbol{A}t) = \\sum_{k=0}^{\\infty} \\frac{(\\boldsymbol{A}t)^k}{k!} = \\boldsymbol{I} + \\boldsymbol{A}t + \\frac{1}{2!}(\\boldsymbol{A}t)^2 + \\frac{1}{3!}(\\boldsymbol{A}t)^3 + \\dots\n$$\nwhere $\\boldsymbol{I}$ is the $n \\times n$ identity matrix.\n\nApplying this general form to our problem, the solution for the flow map is:\n$$\n\\boldsymbol{\\chi}(\\boldsymbol{X},t) = \\exp(\\boldsymbol{A}t)\\boldsymbol{C}\n$$\nThe constant vector $\\boldsymbol{C}$ is determined by applying the initial condition. At $t=0$, we have:\n$$\n\\boldsymbol{\\chi}(\\boldsymbol{X},0) = \\exp(\\boldsymbol{A}\\cdot 0)\\boldsymbol{C} = \\exp(\\boldsymbol{0})\\boldsymbol{C}\n$$\nThe exponential of the zero matrix is the identity matrix, $\\exp(\\boldsymbol{0}) = \\boldsymbol{I}$. Therefore:\n$$\n\\boldsymbol{\\chi}(\\boldsymbol{X},0) = \\boldsymbol{I}\\boldsymbol{C} = \\boldsymbol{C}\n$$\nFrom the given initial condition, we know $\\boldsymbol{\\chi}(\\boldsymbol{X},0) = \\boldsymbol{X}$. Equating these two expressions for the initial state gives:\n$$\n\\boldsymbol{C} = \\boldsymbol{X}\n$$\nThus, the constant vector of integration is simply the initial position vector of the fluid parcel.\n\nSubstituting this result back into the general solution yields the final closed-form analytic expression for the Lagrangian flow map:\n$$\n\\boldsymbol{\\chi}(\\boldsymbol{X},t) = \\exp(\\boldsymbol{A}t)\\boldsymbol{X}\n$$\nThis expression gives the position at time $t$ for any fluid parcel, uniquely identified by its initial position $\\boldsymbol{X}$, under the influence of the specified linear Eulerian velocity field.", "answer": "$$\\boxed{\\exp(\\boldsymbol{A}t)\\boldsymbol{X}}$$", "id": "3338625"}, {"introduction": "While formal mathematical solutions are powerful, physical intuition is built upon concrete examples. This practice [@problem_id:3338684] takes the abstract concept of the flow map and applies it to a physically intuitive scenario: a two-dimensional solid-body rotation. By solving for the explicit particle trajectories, you will directly visualize how a simple, steady Eulerian velocity field generates coherent circular motion in the Lagrangian frame and connect this motion to a measurable physical property, the period of revolution.", "problem": "Consider a two-dimensional incompressible solid-body rotational flow field specified in the Eulerian description by the velocity field $\\boldsymbol{v}(x,y) = \\omega(-y, x)$, where $\\omega$ is a constant angular velocity. Let the Lagrangian particle trajectory $\\boldsymbol{x}(t) = (x(t), y(t))$ be defined as the solution of the kinematic relation $\\mathrm{d}\\boldsymbol{x}/\\mathrm{d}t = \\boldsymbol{v}(\\boldsymbol{x})$ subject to the initial condition $\\boldsymbol{x}(0) = (x_{0}, y_{0})$, with $(x_{0}, y_{0}) \\neq (0,0)$. Starting only from the fundamental kinematic relation connecting the Eulerian velocity field to the Lagrangian trajectory and standard properties of linear ordinary differential equations, derive the exact Lagrangian trajectory and use it to determine the minimal positive period of revolution $T(\\omega)$ for which $\\boldsymbol{x}(t + T) = \\boldsymbol{x}(t)$ for all $t$.\n\nYour final reported answer must be the single closed-form analytic expression for $T(\\omega)$, expressed in seconds. The angular velocity $\\omega$ is measured in radians per second. Do not report the trajectory in the final answer; it should appear only in your derivation. No numerical approximation is required.", "solution": "The problem provides the Eulerian velocity field for a two-dimensional solid-body rotational flow, $\\boldsymbol{v}(x,y) = \\omega(-y, x)$, where $\\omega$ is a constant angular velocity. The Lagrangian particle trajectory, denoted by $\\boldsymbol{x}(t) = (x(t), y(t))$, is determined by the fundamental kinematic relation:\n$$\n\\frac{\\mathrm{d}\\boldsymbol{x}}{\\mathrm{d}t} = \\boldsymbol{v}(\\boldsymbol{x})\n$$\nThis vector equation is subject to the initial condition $\\boldsymbol{x}(0) = (x_0, y_0)$, where $(x_0, y_0) \\neq (0,0)$.\n\nDecomposing the vector equation into its components gives a system of two coupled first-order linear ordinary differential equations (ODEs):\n$$\n\\frac{\\mathrm{d}x}{\\mathrm{d}t} = -\\omega y \\quad (1)\n$$\n$$\n\\frac{\\mathrm{d}y}{\\mathrm{d}t} = \\omega x \\quad (2)\n$$\nTo solve this system, we differentiate equation $(1)$ with respect to time $t$:\n$$\n\\frac{\\mathrm{d}^2 x}{\\mathrm{d}t^2} = -\\omega \\frac{\\mathrm{d}y}{\\mathrm{d}t}\n$$\nSubstituting equation $(2)$ into the right side of this new equation allows us to eliminate the variable $y$:\n$$\n\\frac{\\mathrm{d}^2 x}{\\mathrm{d}t^2} = -\\omega (\\omega x) = -\\omega^2 x\n$$\nThis results in a second-order linear homogeneous ODE for $x(t)$:\n$$\n\\frac{\\mathrm{d}^2 x}{\\mathrm{d}t^2} + \\omega^2 x = 0\n$$\nThis is the standard equation for a simple harmonic oscillator. Its general solution is given by:\n$$\nx(t) = A \\cos(\\omega t) + B \\sin(\\omega t)\n$$\nwhere $A$ and $B$ are constants of integration determined by the initial conditions.\n\nFirst, we apply the initial condition for the position, $x(0) = x_0$:\n$$\nx(0) = A \\cos(0) + B \\sin(0) = A \\cdot 1 + B \\cdot 0 = A\n$$\nThus, we find that the constant $A$ is equal to the initial position $x_0$. The expression for $x(t)$ becomes:\n$$\nx(t) = x_0 \\cos(\\omega t) + B \\sin(\\omega t)\n$$\nTo find the expression for $y(t)$, we can use equation $(1)$, which states $y = -\\frac{1}{\\omega} \\frac{\\mathrm{d}x}{\\mathrm{d}t}$. This is valid for $\\omega \\neq 0$. The case $\\omega=0$ corresponds to a stationary fluid ($\\boldsymbol{v}=\\boldsymbol{0}$), for which the concept of a period is not meaningful. We first compute the derivative of $x(t)$:\n$$\n\\frac{\\mathrm{d}x}{\\mathrm{d}t} = -x_0 \\omega \\sin(\\omega t) + B \\omega \\cos(\\omega t)\n$$\nSubstituting this into the expression for $y(t)$:\n$$\ny(t) = -\\frac{1}{\\omega} \\left(-x_0 \\omega \\sin(\\omega t) + B \\omega \\cos(\\omega t)\\right) = x_0 \\sin(\\omega t) - B \\cos(\\omega t)\n$$\nNext, we apply the initial condition $y(0) = y_0$:\n$$\ny(0) = x_0 \\sin(0) - B \\cos(0) = x_0 \\cdot 0 - B \\cdot 1 = -B\n$$\nThis gives $-B = y_0$, or $B = -y_0$.\n\nSubstituting the values of the constants $A = x_0$ and $B = -y_0$ into the expressions for $x(t)$ and $y(t)$, we obtain the complete Lagrangian trajectory:\n$$\nx(t) = x_0 \\cos(\\omega t) - y_0 \\sin(\\omega t)\n$$\n$$\ny(t) = x_0 \\sin(\\omega t) + y_0 \\cos(\\omega t)\n$$\nThe problem requires us to find the minimal positive period of revolution, $T$. By definition, the period $T$ must satisfy the condition $\\boldsymbol{x}(t + T) = \\boldsymbol{x}(t)$ for all time $t$. This implies that each component of the position vector must be periodic with period $T$:\n$$\nx(t+T) = x(t) \\quad \\text{and} \\quad y(t+T) = y(t)\n$$\nLet us analyze the condition for $x(t)$:\n$$\nx_0 \\cos(\\omega(t+T)) - y_0 \\sin(\\omega(t+T)) = x_0 \\cos(\\omega t) - y_0 \\sin(\\omega t)\n$$\nUsing the trigonometric angle-sum identities, $\\cos(\\alpha+\\beta) = \\cos(\\alpha)\\cos(\\beta) - \\sin(\\alpha)\\sin(\\beta)$ and $\\sin(\\alpha+\\beta) = \\sin(\\alpha)\\cos(\\beta) + \\cos(\\alpha)\\sin(\\beta)$, we expand the left side of the equation:\n$$\nx_0[\\cos(\\omega t)\\cos(\\omega T) - \\sin(\\omega t)\\sin(\\omega T)] - y_0[\\sin(\\omega t)\\cos(\\omega T) + \\cos(\\omega t)\\sin(\\omega T)] = x_0 \\cos(\\omega t) - y_0 \\sin(\\omega t)\n$$\nWe collect terms multiplying $\\cos(\\omega t)$ and $\\sin(\\omega t)$:\n$$\n\\cos(\\omega t)[x_0 \\cos(\\omega T) - y_0 \\sin(\\omega T)] - \\sin(\\omega t)[x_0 \\sin(\\omega T) + y_0 \\cos(\\omega T)] = \\cos(\\omega t)x_0 - \\sin(\\omega t)y_0\n$$\nThis equality must hold for all values of $t$. Since the functions $\\cos(\\omega t)$ and $\\sin(\\omega t)$ are linearly independent, their respective coefficients on both sides of the equation must be equal. This yields a system of two linear equations for the quantities $\\cos(\\omega T)$ and $\\sin(\\omega T)$:\n$$\nx_0 \\cos(\\omega T) - y_0 \\sin(\\omega T) = x_0 \\quad (3)\n$$\n$$\nx_0 \\sin(\\omega T) + y_0 \\cos(\\omega T) = y_0 \\quad (4)\n$$\nSince the initial condition is specified as $(x_0, y_0) \\neq (0,0)$, this system has a unique solution. We can see by inspection that the solution is:\n$$\n\\cos(\\omega T) = 1\n$$\n$$\n\\sin(\\omega T) = 0\n$$\nSubstituting this proposed solution back into equations $(3)$ and $(4)$ verifies its correctness: $x_0(1) - y_0(0) = x_0$ and $x_0(0) + y_0(1) = y_0$. The conditions are satisfied. An identical system of equations would result from analyzing the periodicity of $y(t)$.\n\nThe two simultaneous conditions $\\cos(\\omega T) = 1$ and $\\sin(\\omega T) = 0$ imply that the angle $\\omega T$ must be an integer multiple of $2\\pi$:\n$$\n\\omega T = 2\\pi k, \\quad \\text{for } k \\in \\mathbb{Z}\n$$\nThe period $T$ is, by definition, a positive quantity ($T  0$). Therefore, $k$ must be a non-zero integer. Solving for $T$ gives:\n$$\nT = \\frac{2\\pi k}{\\omega}\n$$\nTo find the minimal positive period, we must select the integer $k$ which provides the smallest positive value for $T$.\n- If $\\omega  0$, we must choose the smallest positive integer, $k=1$. This gives $T = \\frac{2\\pi}{\\omega}$.\n- If $\\omega  0$, we must choose the negative integer with the smallest magnitude, $k=-1$, to ensure $T$ is positive. This gives $T = \\frac{2\\pi(-1)}{\\omega} = -\\frac{2\\pi}{\\omega}$.\nBoth cases are encapsulated by a single expression using the absolute value:\n$$\nT(\\omega) = \\frac{2\\pi}{|\\omega|}\n$$\nThe units of $\\omega$ are radians per second $(\\text{rad} \\cdot \\text{s}^{-1})$ and $2\\pi$ is an angle in radians. The units of $T$ are therefore seconds, as expected for a period.", "answer": "$$\\boxed{\\frac{2\\pi}{|\\omega|}}$$", "id": "3338684"}, {"introduction": "This final practice [@problem_id:3338691] transitions from analytical derivations to the realm of computational fluid dynamics, where these concepts are put into practice. You are tasked with writing a program to numerically integrate the equations of motion for fluid parcels and their local deformation. By computing the Jacobian determinant of the deformation gradient, $J = \\det(\\boldsymbol{F})$, you will computationally verify the principle of volume preservation for an incompressible flow and quantify its change in a compressible one, providing a tangible link between the Eulerian divergence, $\\nabla \\cdot \\boldsymbol{v}$, and Lagrangian volume change.", "problem": "A developer is given an Eulerian velocity field $\\boldsymbol{v}(\\boldsymbol{x},t)$ obtained from Direct Numerical Simulation (DNS) data. The goal is to reconstruct the Lagrangian flow map $\\boldsymbol{\\chi}(\\boldsymbol{X},t)$ and quantify volume (area in two dimensions) change via the Jacobian determinant of the deformation gradient. Work in two spatial dimensions. Let $\\boldsymbol{x}(t;\\boldsymbol{X})$ denote the trajectory that starts from the material coordinate $\\boldsymbol{X}$ at time $t=0$, and define the deformation gradient $\\boldsymbol{F}(\\boldsymbol{X},t)=\\partial \\boldsymbol{x} / \\partial \\boldsymbol{X}$ and its determinant $J(\\boldsymbol{X},t)=\\det \\boldsymbol{F}(\\boldsymbol{X},t)$. The fundamental relations are the kinematic ordinary differential equation $d\\boldsymbol{x}/dt=\\boldsymbol{v}(\\boldsymbol{x},t)$ with $\\boldsymbol{x}(0;\\boldsymbol{X})=\\boldsymbol{X}$ and the variational equation $d\\boldsymbol{F}/dt=\\nabla \\boldsymbol{v}(\\boldsymbol{x}(t),t)\\,\\boldsymbol{F}$ with $\\boldsymbol{F}(\\boldsymbol{X},0)=\\boldsymbol{I}$, where $\\nabla \\boldsymbol{v}$ is the velocity gradient and $\\boldsymbol{I}$ is the identity matrix.\n\nImplement a program that:\n- Reconstructs $\\boldsymbol{\\chi}(\\boldsymbol{X},t)$ by numerically integrating $d\\boldsymbol{x}/dt=\\boldsymbol{v}(\\boldsymbol{x},t)$ from $t=0$ to $t=t_{\\text{final}}$, and simultaneously integrates $d\\boldsymbol{F}/dt=\\nabla \\boldsymbol{v}\\,\\boldsymbol{F}$ with $\\boldsymbol{F}(\\boldsymbol{X},0)=\\boldsymbol{I}$.\n- Computes $J(\\boldsymbol{X},t_{\\text{final}})=\\det \\boldsymbol{F}(\\boldsymbol{X},t_{\\text{final}})$ for a set of initial positions $\\{\\boldsymbol{X}_i\\}$.\n- Tests volume (area) preservation for an incompressible case versus a compressible case and relates observed errors to time-integration choices.\n\nUse two specific, scientifically consistent fields:\n1) Incompressible field (divergence-free) defined by a streamfunction $\\psi(\\boldsymbol{x},t)$ on a periodic square domain of side length $L$. Let $L=1\\,\\text{m}$, $T=1\\,\\text{s}$, and $\\psi(x,y,t)=A \\sin\\left(2\\pi x/L\\right)\\sin\\left(2\\pi y/L\\right)\\cos\\left(2\\pi t/T\\right)$ with $A=0.1\\,\\text{m}^2/\\text{s}$. The velocity is $\\boldsymbol{v}=(\\partial \\psi/\\partial y,\\,-\\partial \\psi/\\partial x)$, and its gradient $\\nabla \\boldsymbol{v}$ must be obtained analytically. Periodic boundary conditions in space must be enforced by wrapping positions modulo $L$. In this case, incompressibility implies volume preservation, so the expected $J$ is $1$.\n2) Compressible uniform isotropic expansion/contraction with $\\boldsymbol{v}(\\boldsymbol{x},t)=c\\,\\boldsymbol{x}$, where $c$ is a constant with units $\\text{s}^{-1}$. In two dimensions, $\\nabla \\boldsymbol{v}=c\\,\\boldsymbol{I}$, and the exact solution for the deformation gradient is $\\boldsymbol{F}(t)=\\exp(c t)\\,\\boldsymbol{I}$, which implies $J(t)=\\exp(2 c t)$. Use $c=0.2\\,\\text{s}^{-1}$ for the main compressible tests and $c=0\\,\\text{s}^{-1}$ as a boundary case.\n\nIntegrate the coupled system $(\\boldsymbol{x},\\boldsymbol{F})$ using two time-integration schemes: explicit forward Euler and classical fourth-order Runge–Kutta. For each test, compute the maximum absolute error in $J$ across the set of initial positions relative to the expected value ($1$ for the incompressible case and $\\exp(2 c t_{\\text{final}})$ for the compressible case). All computed errors must be reported as dimensionless floats.\n\nUse the following test suite with initial positions in meters:\n- Initial positions $\\{\\boldsymbol{X}_i\\}$: $\\{(0.1,0.1),(0.9,0.1),(0.1,0.9),(0.9,0.9),(0.5,0.5)\\}\\,\\text{m}$.\n- Final time $t_{\\text{final}}=1\\,\\text{s}$.\n\nTest cases (each test case is one program run internally, all aggregated into a single output):\n- Case $1$: Incompressible field, explicit Euler, time step $\\Delta t=0.05\\,\\text{s}$.\n- Case $2$: Incompressible field, classical fourth-order Runge–Kutta, time step $\\Delta t=0.005\\,\\text{s}$.\n- Case $3$: Compressible field with $c=0.2\\,\\text{s}^{-1}$, explicit Euler, time step $\\Delta t=0.05\\,\\text{s}$.\n- Case $4$: Compressible field with $c=0.2\\,\\text{s}^{-1}$, classical fourth-order Runge–Kutta, time step $\\Delta t=0.005\\,\\text{s}$.\n- Case $5$: Compressible boundary case with $c=0\\,\\text{s}^{-1}$, explicit Euler, time step $\\Delta t=0.05\\,\\text{s}$.\n\nAngle arguments in trigonometric functions must be treated in radians. Physical units for input parameters are meters ($\\text{m}$) and seconds ($\\text{s}$); the Jacobian determinant is dimensionless. Express the final errors as dimensionless floats.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, ordered as $\\left[\\text{Case }1,\\text{Case }2,\\text{Case }3,\\text{Case }4,\\text{Case }5\\right]$. For example, the output must be of the form $\\left[\\text{float}_1,\\text{float}_2,\\text{float}_3,\\text{float}_4,\\text{float}_5\\right]$.", "solution": "The distinction between Eulerian and Lagrangian descriptions is foundational in fluid dynamics. The Eulerian description specifies the velocity field $\\boldsymbol{v}(\\boldsymbol{x},t)$ at fixed spatial locations, while the Lagrangian description follows material points and builds the flow map $\\boldsymbol{\\chi}(\\boldsymbol{X},t)$ that sends the initial material position $\\boldsymbol{X}$ to its current position $\\boldsymbol{x}(t;\\boldsymbol{X})$.\n\nStarting from the fundamental kinematic law, a material trajectory satisfies $d\\boldsymbol{x}/dt=\\boldsymbol{v}(\\boldsymbol{x},t)$ with $\\boldsymbol{x}(0;\\boldsymbol{X})=\\boldsymbol{X}$. The deformation gradient $\\boldsymbol{F}(\\boldsymbol{X},t)=\\partial \\boldsymbol{x}/\\partial \\boldsymbol{X}$ evolves according to the variational equation $d\\boldsymbol{F}/dt=\\nabla \\boldsymbol{v}(\\boldsymbol{x}(t),t)\\,\\boldsymbol{F}$ with $\\boldsymbol{F}(\\boldsymbol{X},0)=\\boldsymbol{I}$. This equation arises by differentiating the kinematic relation with respect to $\\boldsymbol{X}$ and applying the chain rule: $\\partial_t(\\partial \\boldsymbol{x}/\\partial \\boldsymbol{X})=\\left(\\partial \\boldsymbol{v}/\\partial \\boldsymbol{x}\\right)\\left(\\partial \\boldsymbol{x}/\\partial \\boldsymbol{X}\\right)=\\nabla \\boldsymbol{v}\\,\\boldsymbol{F}$.\n\nThe Jacobian determinant $J(\\boldsymbol{X},t)=\\det \\boldsymbol{F}(\\boldsymbol{X},t)$ represents the local volume change from the reference to the current configuration. Its evolution can be derived using Jacobi’s formula for determinants: for an invertible matrix $\\boldsymbol{F}(t)$, $d(\\det \\boldsymbol{F})/dt=\\det \\boldsymbol{F}\\,\\mathrm{tr}\\left(\\boldsymbol{F}^{-1}\\frac{d\\boldsymbol{F}}{dt}\\right)$. Substituting $\\frac{d\\boldsymbol{F}}{dt}=\\nabla \\boldsymbol{v}\\,\\boldsymbol{F}$ yields $dJ/dt=J\\,\\mathrm{tr}(\\nabla \\boldsymbol{v})=J\\,\\nabla\\cdot \\boldsymbol{v}$. Therefore,\n- If the flow is incompressible, $\\nabla\\cdot \\boldsymbol{v}=0$, so $dJ/dt=0$ and $J(t)=J(0)=1$ for all time; volume (area in two dimensions) is preserved exactly in the continuum model.\n- If the flow is compressible with spatially uniform $\\nabla \\boldsymbol{v}=c\\,\\boldsymbol{I}$ in two dimensions, then $d\\boldsymbol{F}/dt=c\\,\\boldsymbol{F}$ and $\\boldsymbol{F}(t)=e^{ct}\\boldsymbol{I}$, leading to $J(t)=\\det \\boldsymbol{F}(t)=e^{ct}\\cdot e^{ct}=e^{2ct}$. This result agrees with $dJ/dt=J\\,\\mathrm{tr}(\\nabla \\boldsymbol{v})=J\\cdot 2c$.\n\nAlgorithmic design follows these principles:\n1) Specify the Eulerian fields.\n   - Incompressible case: define a streamfunction $\\psi(x,y,t)=A \\sin(k x)\\sin(k y)\\cos(\\omega t)$ with $k=2\\pi/L$ and $\\omega=2\\pi/T$. The velocity is $\\boldsymbol{v}=(\\partial \\psi/\\partial y,\\,-\\partial \\psi/\\partial x)$, and its gradient $\\nabla \\boldsymbol{v}$ is computed analytically:\n   $$\n   v_x=A k \\cos(k y)\\sin(k x)\\cos(\\omega t),\\quad\n   v_y=-A k \\cos(k x)\\sin(k y)\\cos(\\omega t),\n   $$\n   $$\n   \\frac{\\partial v_x}{\\partial x}=A k^2 \\cos(k y)\\cos(k x)\\cos(\\omega t),\\quad\n   \\frac{\\partial v_x}{\\partial y}=-A k^2 \\sin(k y)\\sin(k x)\\cos(\\omega t),\n   $$\n   $$\n   \\frac{\\partial v_y}{\\partial x}=A k^2 \\sin(k x)\\sin(k y)\\cos(\\omega t),\\quad\n   \\frac{\\partial v_y}{\\partial y}=-A k^2 \\cos(k x)\\cos(k y)\\cos(\\omega t).\n   $$\n   The divergence $\\nabla\\cdot\\boldsymbol{v}=\\partial v_x/\\partial x+\\partial v_y/\\partial y$ is identically $0$, guaranteeing incompressibility.\n   - Compressible case: choose $\\boldsymbol{v}(\\boldsymbol{x},t)=c\\,\\boldsymbol{x}$ with constant $c$ so that $\\nabla \\boldsymbol{v}=c\\,\\boldsymbol{I}$ and $J(t)=e^{2ct}$.\n\n2) Integrate the coupled system $(\\boldsymbol{x},\\boldsymbol{F})$ from $t=0$ to $t=t_{\\text{final}}$ for each initial position $\\boldsymbol{X}_i$ using one of two time integrators:\n   - Explicit Euler (first-order): $\\boldsymbol{x}_{n+1}=\\boldsymbol{x}_n+\\Delta t\\,\\boldsymbol{v}(\\boldsymbol{x}_n,t_n)$ and $\\boldsymbol{F}_{n+1}=\\boldsymbol{F}_n+\\Delta t\\,\\nabla \\boldsymbol{v}(\\boldsymbol{x}_n,t_n)\\,\\boldsymbol{F}_n$.\n   - Classical fourth-order Runge–Kutta: apply the standard four-stage scheme to both $\\boldsymbol{x}$ and $\\boldsymbol{F}$ consistently:\n     $$\n     \\boldsymbol{k}_1=\\boldsymbol{v}(\\boldsymbol{x}_n,t_n),\\quad \\boldsymbol{K}_1=\\nabla \\boldsymbol{v}(\\boldsymbol{x}_n,t_n)\\,\\boldsymbol{F}_n,\n     $$\n     $$\n     \\boldsymbol{k}_2=\\boldsymbol{v}\\left(\\boldsymbol{x}_n+\\tfrac{\\Delta t}{2}\\boldsymbol{k}_1,t_n+\\tfrac{\\Delta t}{2}\\right),\\quad\n     \\boldsymbol{K}_2=\\nabla \\boldsymbol{v}\\left(\\boldsymbol{x}_n+\\tfrac{\\Delta t}{2}\\boldsymbol{k}_1,t_n+\\tfrac{\\Delta t}{2}\\right)\\left(\\boldsymbol{F}_n+\\tfrac{\\Delta t}{2}\\boldsymbol{K}_1\\right),\n     $$\n     $$\n     \\boldsymbol{k}_3=\\boldsymbol{v}\\left(\\boldsymbol{x}_n+\\tfrac{\\Delta t}{2}\\boldsymbol{k}_2,t_n+\\tfrac{\\Delta t}{2}\\right),\\quad\n     \\boldsymbol{K}_3=\\nabla \\boldsymbol{v}\\left(\\boldsymbol{x}_n+\\tfrac{\\Delta t}{2}\\boldsymbol{k}_2,t_n+\\tfrac{\\Delta t}{2}\\right)\\left(\\boldsymbol{F}_n+\\tfrac{\\Delta t}{2}\\boldsymbol{K}_2\\right),\n     $$\n     $$\n     \\boldsymbol{k}_4=\\boldsymbol{v}\\left(\\boldsymbol{x}_n+\\Delta t\\,\\boldsymbol{k}_3,t_n+\\Delta t\\right),\\quad\n     \\boldsymbol{K}_4=\\nabla \\boldsymbol{v}\\left(\\boldsymbol{x}_n+\\Delta t\\,\\boldsymbol{k}_3,t_n+\\Delta t\\right)\\left(\\boldsymbol{F}_n+\\Delta t\\,\\boldsymbol{K}_3\\right),\n     $$\n     $$\n     \\boldsymbol{x}_{n+1}=\\boldsymbol{x}_n+\\frac{\\Delta t}{6}\\left(\\boldsymbol{k}_1+2\\boldsymbol{k}_2+2\\boldsymbol{k}_3+\\boldsymbol{k}_4\\right),\\quad\n     \\boldsymbol{F}_{n+1}=\\boldsymbol{F}_n+\\frac{\\Delta t}{6}\\left(\\boldsymbol{K}_1+2\\boldsymbol{K}_2+2\\boldsymbol{K}_3+\\boldsymbol{K}_4\\right).\n     $$\n   For the incompressible periodic field, enforce spatial periodicity by mapping positions modulo $L$ after each step.\n\n3) Compute the Jacobians $J_i=\\det \\boldsymbol{F}(\\boldsymbol{X}_i,t_{\\text{final}})$ and the expected values for the test cases:\n   - Incompressible: expected $J_{\\text{exp}}=1$.\n   - Compressible with constant $c$: expected $J_{\\text{exp}}=e^{2 c t_{\\text{final}}}$.\n   Quantify the error per case as $\\max_i \\left|J_i-J_{\\text{exp}}\\right|$.\n\n4) Assemble results for the specified test suite. The explicit Euler method, being first-order, is expected to exhibit larger errors, particularly for coarser $\\Delta t$. The classical fourth-order Runge–Kutta method should produce markedly smaller errors due to its higher order of accuracy, even with moderate step sizes. In the incompressible case, any deviation of $J$ from $1$ arises purely from numerical integration error and discretization, providing a direct measure of the scheme’s fidelity to volume preservation. In the compressible case with spatially uniform $\\nabla \\boldsymbol{v}$, the exact $J$ is known, enabling direct error assessment against $e^{2ct}$; the boundary case $c=0$ reduces to a trivial identity flow with $J=1$.\n\nThe program implements these steps and outputs a single line containing a bracketed, comma-separated list of the five dimensionless floats for the tests ordered as specified.", "answer": "```python\n# Python 3.12\n# Libraries: numpy 1.23.5, scipy 1.11.4 (not used)\nimport numpy as np\n\ndef velocity_incompressible(x, t, params):\n    # params: dict with A, L, T\n    A = params['A']\n    L = params['L']\n    T = params['T']\n    k = 2.0 * np.pi / L\n    omega = 2.0 * np.pi / T\n    # u = (dpsi/dy, -dpsi/dx)\n    u_x = A * k * np.cos(k * x[1]) * np.sin(k * x[0]) * np.cos(omega * t)\n    u_y = -A * k * np.cos(k * x[0]) * np.sin(k * x[1]) * np.cos(omega * t)\n    return np.array([u_x, u_y])\n\ndef grad_incompressible(x, t, params):\n    A = params['A']\n    L = params['L']\n    T = params['T']\n    k = 2.0 * np.pi / L\n    omega = 2.0 * np.pi / T\n    cos_omega_t = np.cos(omega * t)\n    kx = k * x[0]\n    ky = k * x[1]\n    dux_dx = A * (k**2) * np.cos(ky) * np.cos(kx) * cos_omega_t\n    dux_dy = -A * (k**2) * np.sin(ky) * np.sin(kx) * cos_omega_t\n    duy_dx = A * (k**2) * np.sin(kx) * np.sin(ky) * cos_omega_t\n    duy_dy = -A * (k**2) * np.cos(kx) * np.cos(ky) * cos_omega_t\n    return np.array([[dux_dx, dux_dy],\n                     [duy_dx, duy_dy]])\n\ndef velocity_compressible(x, t, params):\n    c = params['c']\n    return c * x\n\ndef grad_compressible(x, t, params):\n    c = params['c']\n    return c * np.eye(2)\n\ndef integrate_particle(X0, t_final, dt, method, field_type, params):\n    x = np.array(X0, dtype=float)\n    F = np.eye(2)\n    t = 0.0\n    steps = int(round(t_final / dt))\n    if field_type == 'incompressible':\n        L = params['L']\n        vel = lambda xx, tt: velocity_incompressible(xx, tt, params)\n        grd = lambda xx, tt: grad_incompressible(xx, tt, params)\n    elif field_type == 'compressible':\n        vel = lambda xx, tt: velocity_compressible(xx, tt, params)\n        grd = lambda xx, tt: grad_compressible(xx, tt, params)\n    else:\n        raise ValueError(\"Unknown field_type\")\n\n    for _ in range(steps):\n        if method == 'euler':\n            u = vel(x, t)\n            G = grd(x, t)\n            x_new = x + dt * u\n            F_new = F + dt * (G @ F)\n        elif method == 'rk4':\n            k1x = vel(x, t)\n            k1F = grd(x, t) @ F\n\n            x2 = x + 0.5 * dt * k1x\n            F2 = F + 0.5 * dt * k1F\n            k2x = vel(x2, t + 0.5 * dt)\n            k2F = grd(x2, t + 0.5 * dt) @ F2\n\n            x3 = x + 0.5 * dt * k2x\n            F3 = F + 0.5 * dt * k2F\n            k3x = vel(x3, t + 0.5 * dt)\n            k3F = grd(x3, t + 0.5 * dt) @ F3\n\n            x4 = x + dt * k3x\n            F4 = F + dt * k3F\n            k4x = vel(x4, t + dt)\n            k4F = grd(x4, t + dt) @ F4\n\n            x_new = x + (dt / 6.0) * (k1x + 2 * k2x + 2 * k3x + k4x)\n            F_new = F + (dt / 6.0) * (k1F + 2 * k2F + 2 * k3F + k4F)\n        else:\n            raise ValueError(\"Unknown method\")\n\n        x = x_new\n        F = F_new\n        t += dt\n\n        if field_type == 'incompressible':\n            # Enforce periodicity on [0, L)\n            x = np.mod(x, L)\n\n    J = float(np.linalg.det(F))\n    return J\n\ndef run_case(field_type, method, dt, t_final, params, initial_positions):\n    # Compute Js for all initial positions\n    Js = []\n    for X0 in initial_positions:\n        J = integrate_particle(X0, t_final, dt, method, field_type, params)\n        Js.append(J)\n    Js = np.array(Js)\n    # Expected J\n    if field_type == 'incompressible':\n        J_exp = 1.0\n    elif field_type == 'compressible':\n        c = params['c']\n        J_exp = float(np.exp(2.0 * c * t_final))\n    else:\n        raise ValueError(\"Unknown field_type\")\n    # Error metric: maximum absolute error across particles\n    err = float(np.max(np.abs(Js - J_exp)))\n    return err\n\ndef solve():\n    # Initial positions in meters\n    initial_positions = [\n        (0.1, 0.1),\n        (0.9, 0.1),\n        (0.1, 0.9),\n        (0.9, 0.9),\n        (0.5, 0.5),\n    ]\n    t_final = 1.0  # seconds\n\n    # Test cases specification\n    test_cases = [\n        # Case 1: Incompressible, Euler, dt=0.05 s\n        (\"incompressible\", \"euler\", 0.05, t_final, {\"A\": 0.1, \"L\": 1.0, \"T\": 1.0}),\n        # Case 2: Incompressible, RK4, dt=0.005 s\n        (\"incompressible\", \"rk4\", 0.005, t_final, {\"A\": 0.1, \"L\": 1.0, \"T\": 1.0}),\n        # Case 3: Compressible c=0.2 s^-1, Euler, dt=0.05 s\n        (\"compressible\", \"euler\", 0.05, t_final, {\"c\": 0.2}),\n        # Case 4: Compressible c=0.2 s^-1, RK4, dt=0.005 s\n        (\"compressible\", \"rk4\", 0.005, t_final, {\"c\": 0.2}),\n        # Case 5: Compressible boundary c=0.0 s^-1, Euler, dt=0.05 s\n        (\"compressible\", \"euler\", 0.05, t_final, {\"c\": 0.0}),\n    ]\n\n    results = []\n    for field_type, method, dt, tf, params in test_cases:\n        err = run_case(field_type, method, dt, tf, params, initial_positions)\n        results.append(err)\n\n    # Print results as a single bracketed, comma-separated list\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "3338691"}]}