{"hands_on_practices": [{"introduction": "For any explicit time-stepping scheme applied to hyperbolic systems like the Euler equations, numerical stability is a primary concern. The Courant-Friedrichs-Lewy (CFL) condition dictates that the numerical domain of dependence must contain the physical domain of dependence, effectively placing a \"speed limit\" on the simulation. This foundational exercise provides hands-on practice in applying this principle, requiring you to first justify the CFL restriction based on the characteristic speeds of the system and then to perform a concrete calculation of the maximum stable time step for a given flow configuration [@problem_id:3373678]. Mastering this skill is the first step toward running any successful explicit simulation.", "problem": "Consider the one-dimensional Euler equations for an inviscid ideal gas with ratio of specific heats $\\gamma$,\n$$\n\\frac{\\partial \\boldsymbol{U}}{\\partial t} + \\frac{\\partial \\boldsymbol{F}(\\boldsymbol{U})}{\\partial x} = 0,\n$$\nwhere $\\boldsymbol{U} = \\begin{pmatrix} \\rho \\\\ \\rho u \\\\ E \\end{pmatrix}$ and $\\boldsymbol{F}(\\boldsymbol{U}) = \\begin{pmatrix} \\rho u \\\\ \\rho u^{2} + p \\\\ u\\left(E + p\\right) \\end{pmatrix}$, with pressure given by the ideal-gas equation of state $p = (\\gamma - 1)\\left(E - \\tfrac{1}{2}\\rho u^{2}\\right)$. An explicit finite-volume conservative scheme with forward-Euler time integration advances the cell averages by balancing numerical fluxes at interfaces. The Courant-Friedrichs-Lewy (CFL) requirement for stability in such schemes can be justified by linearizing the equations and bounding the time step using the spectral radius of the flux Jacobian.\n\nStarting from these principles, justify why the maximum admissible time step in each cell is governed by the largest characteristic speed of the linearized hyperbolic system, and show that, in one dimension, this leads to a cell-wise bound expressed in terms of the local flow speed $u$ and the local sound speed $c$, where $c = \\sqrt{\\gamma p / \\rho}$.\n\nThen, for a uniform Cartesian mesh segment comprising four cells with widths\n$$\n\\Delta x_{1} = 0.010,\\quad \\Delta x_{2} = 0.008,\\quad \\Delta x_{3} = 0.012,\\quad \\Delta x_{4} = 0.009,\n$$\nand cell-centered states\n$$\n(\\rho_{1}, u_{1}, p_{1}) = (1.0,\\ 50,\\ 1.0\\times 10^{5}),\\quad (\\rho_{2}, u_{2}, p_{2}) = (0.8,\\ -30,\\ 0.9\\times 10^{5}),\n$$\n$$\n(\\rho_{3}, u_{3}, p_{3}) = (1.2,\\ 80,\\ 1.1\\times 10^{5}),\\quad (\\rho_{4}, u_{4}, p_{4}) = (0.9,\\ 10,\\ 0.95\\times 10^{5}),\n$$\ntake $\\gamma = 1.4$ and a Courant-Friedrichs-Lewy number $\\mathrm{CFL} = 0.60$. Compute the largest globally admissible explicit time step $\\Delta t_{\\max}$ consistent with the derived stability restriction. Express the final time step in seconds, and round your answer to four significant figures.", "solution": "The problem presents a two-part task: first, a theoretical justification of the Courant-Friedrichs-Lewy (CFL) stability condition for an explicit finite-volume scheme applied to the one-dimensional Euler equations; second, a numerical application of this condition to determine the maximum globally admissible time step for a given flow configuration.\n\nThe problem statement has been validated and is deemed sound. It is scientifically grounded in the principles of fluid dynamics and numerical analysis, is well-posed with all necessary information provided, and is free of ambiguities or contradictions. We may therefore proceed with a formal solution.\n\nPart 1: Theoretical Justification of the CFL Condition\n\nThe one-dimensional Euler equations for an inviscid ideal gas form a system of nonlinear hyperbolic conservation laws:\n$$\n\\frac{\\partial \\boldsymbol{U}}{\\partial t} + \\frac{\\partial \\boldsymbol{F}(\\boldsymbol{U})}{\\partial x} = 0\n$$\nwhere $\\boldsymbol{U}$ is the vector of conserved variables and $\\boldsymbol{F}(\\boldsymbol{U})$ is the flux vector. To analyze the propagation of information described by this system, we consider its quasi-linear form:\n$$\n\\frac{\\partial \\boldsymbol{U}}{\\partial t} + \\boldsymbol{A}(\\boldsymbol{U}) \\frac{\\partial \\boldsymbol{U}}{\\partial x} = 0\n$$\nHere, $\\boldsymbol{A}(\\boldsymbol{U}) = \\frac{\\partial \\boldsymbol{F}}{\\partial \\boldsymbol{U}}$ is the flux Jacobian matrix. The system is hyperbolic because the matrix $\\boldsymbol{A}(\\boldsymbol{U})$ has real eigenvalues and a complete set of linearly independent eigenvectors for any physically valid state $\\boldsymbol{U}$.\n\nThe eigenvalues of $\\boldsymbol{A}(\\boldsymbol{U})$ represent the characteristic speeds at which information propagates through the medium. For the one-dimensional Euler equations, a rigorous derivation (involving the differentiation of the flux vector $\\boldsymbol{F}$ with respect to the state vector $\\boldsymbol{U}$ and solving the characteristic equation $\\det(\\boldsymbol{A} - \\lambda\\boldsymbol{I}) = 0$) yields the following three eigenvalues:\n$$\n\\lambda_1 = u - c, \\quad \\lambda_2 = u, \\quad \\lambda_3 = u + c\n$$\nwhere $u$ is the local fluid velocity and $c = \\sqrt{\\gamma p / \\rho}$ is the local speed of sound. These speeds correspond to acoustic waves traveling upstream ($u-c$) and downstream ($u+c$) relative to the flow, and an entropy/contact wave being advected with the flow ($u$).\n\nAn explicit finite-volume scheme updates the cell-averaged state $\\boldsymbol{U}_j^n$ in cell $j$ at time $t^n$ to a new state $\\boldsymbol{U}_j^{n+1}$ at time $t^{n+1} = t^n + \\Delta t$ based on the fluxes at the cell interfaces. Using forward Euler time integration, the update formula is:\n$$\n\\boldsymbol{U}_j^{n+1} = \\boldsymbol{U}_j^n - \\frac{\\Delta t}{\\Delta x_j} [\\boldsymbol{\\hat{F}}_{j+1/2} - \\boldsymbol{\\hat{F}}_{j-1/2}]\n$$\nwhere $\\boldsymbol{\\hat{F}}_{j\\pm1/2}$ are the numerical fluxes at the interfaces of cell $j$, which depend on the states in neighboring cells. This means that the new state $\\boldsymbol{U}_j^{n+1}$ depends on information from cells $j-1$, $j$, and $j+1$ at time $t^n$. The spatial extent of this information is the interval $[x_{j-1}, x_{j+1}]$, known as the numerical domain of dependence.\n\nThe Courant-Friedrichs-Lewy (CFL) condition is a necessary condition for the stability and convergence of such explicit schemes. It requires that the numerical domain of dependence must contain the physical domain of dependence. The physical domain of dependence of the solution at $(x_j, t^{n+1})$ is the region in space at time $t^n$ from which physical signals can influence the solution at that point. Signals travel at the characteristic speeds $\\lambda_k$. The fastest a signal can travel is given by the spectral radius of the Jacobian, $\\rho(\\boldsymbol{A}) = \\max_k |\\lambda_k|$.\n$$\n\\rho(\\boldsymbol{A}) = \\max(|u - c|, |u|, |u + c|)\n$$\nSince the speed of sound $c$ is non-negative, the maximum of these three values is always $|u| + c$. Let's verify this. If $u \\ge 0$, then $u+c  u$ and $u+c  |u-c|$. If $u  0$, let $u = -v$ with $v  0$. The speeds are $|-v-c|=v+c$, $|-v|=v$, and $|-v+c|=|c-v|$. The maximum is $v+c = |u|+c$. Thus, the maximum characteristic speed is $S = |u| + c$.\n\nThe physical domain of dependence at time $t^n$ for the point $(x_j, t^{n+1})$ is the interval $[x_j - S\\Delta t, x_j + S\\Delta t]$. For a scheme with a stencil involving adjacent cells on a uniform mesh of width $\\Delta x$, the numerical domain of dependence is $[x_j - \\Delta x, x_j + \\Delta x]$. The CFL condition requires this numerical domain to contain the physical one:\n$$\n[x_j - S\\Delta t, x_j + S\\Delta t] \\subseteq [x_j - \\Delta x, x_j + \\Delta x]\n$$\nThis containment implies $S\\Delta t \\le \\Delta x$. This justifies why the time step must be bounded by the largest characteristic speed. We can write this as:\n$$\n\\frac{(|u|+c)\\Delta t}{\\Delta x} \\le 1\n$$\nIn practice, a safety factor, known as the CFL number ($\\mathrm{CFL}  1$), is introduced. This leads to the stability criterion:\n$$\n\\Delta t \\le \\mathrm{CFL} \\frac{\\Delta x}{|u| + c}\n$$\nThis shows that the admissible time step in each cell is governed by the cell width $\\Delta x$ and inversely by the sum of the local flow speed magnitude $|u|$ and the local sound speed $c$. This completes the theoretical justification.\n\nPart 2: Numerical Calculation of the Global Time Step\n\nTo ensure stability throughout the entire computational domain, the time step $\\Delta t$ must be chosen such that the CFL condition is satisfied in every cell. For a non-uniform mesh, this means the global time step is limited by the cell that requires the smallest time step:\n$$\n\\Delta t_{\\max} = \\min_{i} \\left( \\mathrm{CFL} \\frac{\\Delta x_i}{|u_i| + c_i} \\right)\n$$\nwhere the index $i$ runs over all cells in the mesh. We are given $\\mathrm{CFL} = 0.60$ and $\\gamma=1.4$. We proceed to calculate the local time step limit $\\Delta t_i$ for each of the four cells.\n\nFirst, we compute the local speed of sound $c_i = \\sqrt{\\gamma p_i / \\rho_i}$ for each cell $i \\in \\{1, 2, 3, 4\\}$. All values are in SI units.\n\nCell 1: $(\\rho_1, u_1, p_1) = (1.0, 50, 1.0 \\times 10^5)$, $\\Delta x_1 = 0.010$.\n$$\nc_1 = \\sqrt{\\frac{1.4 \\times 1.0 \\times 10^{5}}{1.0}} = \\sqrt{140000} \\approx 374.1657 \\, \\mathrm{m/s}\n$$\n$$\n\\Delta t_1 = 0.60 \\times \\frac{0.010}{|50| + 374.1657} = \\frac{0.006}{424.1657} \\approx 1.41455 \\times 10^{-5} \\, \\mathrm{s}\n$$\n\nCell 2: $(\\rho_2, u_2, p_2) = (0.8, -30, 0.9 \\times 10^5)$, $\\Delta x_2 = 0.008$.\n$$\nc_2 = \\sqrt{\\frac{1.4 \\times 0.9 \\times 10^{5}}{0.8}} = \\sqrt{157500} \\approx 396.8627 \\, \\mathrm{m/s}\n$$\n$$\n\\Delta t_2 = 0.60 \\times \\frac{0.008}{|-30| + 396.8627} = \\frac{0.0048}{426.8627} \\approx 1.12448 \\times 10^{-5} \\, \\mathrm{s}\n$$\n\nCell 3: $(\\rho_3, u_3, p_3) = (1.2, 80, 1.1 \\times 10^5)$, $\\Delta x_3 = 0.012$.\n$$\nc_3 = \\sqrt{\\frac{1.4 \\times 1.1 \\times 10^{5}}{1.2}} = \\sqrt{\\frac{1.54 \\times 10^5}{1.2}} \\approx 358.2364 \\, \\mathrm{m/s}\n$$\n$$\n\\Delta t_3 = 0.60 \\times \\frac{0.012}{|80| + 358.2364} = \\frac{0.0072}{438.2364} \\approx 1.64299 \\times 10^{-5} \\, \\mathrm{s}\n$$\n\nCell 4: $(\\rho_4, u_4, p_4) = (0.9, 10, 0.95 \\times 10^5)$, $\\Delta x_4 = 0.009$.\n$$\nc_4 = \\sqrt{\\frac{1.4 \\times 0.95 \\times 10^{5}}{0.9}} = \\sqrt{\\frac{1.33 \\times 10^5}{0.9}} \\approx 384.4176 \\, \\mathrm{m/s}\n$$\n$$\n\\Delta t_4 = 0.60 \\times \\frac{0.009}{|10| + 384.4176} = \\frac{0.0054}{394.4176} \\approx 1.36911 \\times 10^{-5} \\, \\mathrm{s}\n$$\n\nThe largest globally admissible explicit time step is the minimum of these local time step limits:\n$$\n\\Delta t_{\\max} = \\min(\\Delta t_1, \\Delta t_2, \\Delta t_3, \\Delta t_4)\n$$\n$$\n\\Delta t_{\\max} = \\min(1.41455, 1.12448, 1.64299, 1.36911) \\times 10^{-5} \\, \\mathrm{s}\n$$\n$$\n\\Delta t_{\\max} = 1.12448 \\times 10^{-5} \\, \\mathrm{s}\n$$\nRounding this value to four significant figures as requested gives $1.124 \\times 10^{-5}$ seconds. The limiting cell is cell 2, which has a combination of small cell width, high flow speed magnitude, and high sound speed.", "answer": "$$\\boxed{1.124 \\times 10^{-5}}$$", "id": "3373678"}, {"introduction": "A numerical simulation is only as good as its treatment of boundaries, where the computational domain communicates with the outside world. For hyperbolic systems, the correct specification of boundary conditions is not arbitrary but is rigorously determined by the direction of information flow, carried by characteristic waves. This exercise challenges you to reason from first principles why supersonic inflow requires a full set of prescribed variables, while supersonic outflow allows no externally imposed conditions [@problem_id:3373668]. Understanding this connection between wave propagation and boundary data is crucial for developing well-posed and physically meaningful CFD models.", "problem": "Consider a one-dimensional ($1$-D) inviscid compressible flow of a perfect gas governed by the Euler equations on a finite domain $x \\in [0,L]$ with time $t \\ge 0$. Let the conservative variables be $\\mathbf{q}=(\\rho,\\rho u,E)^{\\top}$, where $\\rho$ is the density, $u$ is the velocity, and $E$ is the total energy per unit volume. The governing conservation laws are mass, momentum, and energy:\n$$\n\\frac{\\partial \\rho}{\\partial t} + \\frac{\\partial}{\\partial x}(\\rho u)=0,\\quad\n\\frac{\\partial (\\rho u)}{\\partial t} + \\frac{\\partial}{\\partial x}(\\rho u^2 + p)=0,\\quad\n\\frac{\\partial E}{\\partial t} + \\frac{\\partial}{\\partial x}\\big(u(E+p)\\big)=0,\n$$\nclosed with the perfect-gas relation $p=(\\gamma-1)\\left(E-\\tfrac{1}{2}\\rho u^2\\right)$ for a constant $\\gamma1$. Consider a uniform base state $(\\rho_0,u_0,p_0)$ about which small disturbances propagate, and define the sound speed $a_0=\\sqrt{\\gamma p_0/\\rho_0}$ and Mach number $M_0=|u_0|/a_0$.\n\nYou are tasked to reason, from first principles and the direction of propagation of small-amplitude waves obtained by linearizing the Euler equations about $(\\rho_0,u_0,p_0)$, which boundary data must be prescribed at the left boundary $x=0$ (where flow enters the domain when $u_00$) and at the right boundary $x=L$ (where flow exits the domain when $u_00$) in the supersonic regime $M_01$. Specifically, explain why supersonic inflow at $x=0$ requires prescribing all primitive variables $(\\rho,u,p)$ while supersonic outflow at $x=L$ requires none, and relate this choice to the count and direction of characteristic waves relative to the computational domain. Select the option that most accurately articulates this explanation and its basis in characteristic-wave directions for the one-dimensional Euler system.\n\nA. In the supersonic regime $M_01$ with $u_00$, all small-amplitude waves propagate into the domain at $x=0$ and out of the domain at $x=L$. Therefore, at $x=0$ all three primitive variables $(\\rho,u,p)$ must be prescribed to supply data for the incoming waves, while at $x=L$ no primitive variables are prescribed because no waves enter the domain from that boundary.\n\nB. Only the pressure $p$ should be prescribed at supersonic inflow because pressure disturbances are the fastest and determine the other variables, and at supersonic outflow one primitive variable (typically $p$) must still be prescribed because a pressure wave always enters the domain from any outflow boundary.\n\nC. The number of boundary conditions should always equal the number of equations, so three primitive variables must be prescribed both at inflow and outflow, regardless of Mach number, because the Euler system has three conservation laws.\n\nD. At supersonic inflow prescribe two primitive variables $(u,p)$ and compute $\\rho$ from the equation of state, while at supersonic outflow prescribe the Mach number $M$ because entropy is constant and this determines the remaining variables; the directions of waves do not affect boundary-condition specification in the inviscid Euler system.\n\nE. At supersonic inflow, only one primitive variable (the velocity $u$) needs to be prescribed because convective transport dominates; at supersonic outflow, two primitive variables $(\\rho,p)$ must be prescribed to prevent reflections due to compressibility, since one of the acoustic waves enters the domain from the outflow boundary even in supersonic flow.", "solution": "The user wants me to validate the problem statement according to a strict procedure, then solve the problem by deriving the answer from first principles and evaluating each option.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n\nThe problem provides the following information:\n-   A one-dimensional ($1$-D) inviscid compressible flow of a perfect gas.\n-   Governing equations are the Euler equations on a domain $x \\in [0,L]$ with time $t \\ge 0$.\n-   Conservative variables: $\\mathbf{q}=(\\rho,\\rho u,E)^{\\top}$, where $\\rho$ is density, $u$ is velocity, $E$ is total energy per unit volume.\n-   Mass conservation: $\\frac{\\partial \\rho}{\\partial t} + \\frac{\\partial}{\\partial x}(\\rho u)=0$.\n-   Momentum conservation: $\\frac{\\partial (\\rho u)}{\\partial t} + \\frac{\\partial}{\\partial x}(\\rho u^2 + p)=0$.\n-   Energy conservation: $\\frac{\\partial E}{\\partial t} + \\frac{\\partial}{\\partial x}\\big(u(E+p)\\big)=0$.\n-   Equation of state (perfect gas): $p=(\\gamma-1)\\left(E-\\tfrac{1}{2}\\rho u^2\\right)$ for a constant $\\gamma1$.\n-   Base state for linearization: uniform $(\\rho_0,u_0,p_0)$.\n-   Sound speed definition: $a_0=\\sqrt{\\gamma p_0/\\rho_0}$.\n-   Mach number definition: $M_0=|u_0|/a_0$.\n-   Flow regime: Supersonic, $M_01$.\n-   Flow direction: $u_0  0$, implying inflow at $x=0$ and outflow at $x=L$.\n-   Task: Explain from first principles why supersonic inflow at $x=0$ requires prescribing all three primitive variables $(\\rho, u, p)$, while supersonic outflow at $x=L$ requires none, based on the direction of propagation of small-amplitude waves (characteristics).\n\n**Step 2: Validate Using Extracted Givens**\n\nThe problem statement is evaluated against the validation criteria:\n\n-   **Scientifically Grounded**: The problem is based on the Euler equations, a fundamental model in fluid dynamics. The concept of linearizing these equations and analyzing their characteristic wave structure to determine appropriate boundary conditions is a standard and cornerstone topic in the theory of hyperbolic partial differential equations and computational fluid dynamics (CFD). The setup is scientifically rigorous and factually sound.\n-   **Well-Posed**: The question asks for a line of reasoning to explain a well-established principle in CFD. A unique and correct explanation exists based on the theory of characteristics.\n-   **Objective**: The language is precise, technical, and free of any subjectivity or ambiguity.\n\nThe problem does not exhibit any of the invalidity flaws:\n1.  **Scientific or Factual Unsoundness**: None. The physics and mathematics are standard.\n2.  **Non-Formalizable or Irrelevant**: None. The problem is a classic, formalizable topic in CFD.\n3.  **Incomplete or Contradictory Setup**: None. All necessary information (equations, regime, flow direction) is provided to perform the analysis.\n4.  **Unrealistic or Infeasible**: None. Supersonic flow is a physical reality.\n5.  **Ill-Posed or Poorly Structured**: None. The question leads to a definite physical and mathematical conclusion.\n6.  **Pseudo-Profound, Trivial, or Tautological**: None. The problem requires a solid understanding of hyperbolic systems and wave propagation.\n7.  **Outside Scientific Verifiability**: None. The analysis is mathematically verifiable.\n\n**Step 3: Verdict and Action**\n\nThe problem statement is **valid**. The solution process will now proceed.\n\n### Principle-Based Derivation\n\nThe specification of boundary conditions for hyperbolic systems of partial differential equations, such as the Euler equations, is governed by the theory of characteristics. The fundamental principle is that the number of boundary conditions that must be prescribed at a boundary is equal to the number of characteristic waves that are propagating *into* the computational domain at that boundary. Information carried by waves leaving the domain is determined by the solution within the domain and thus cannot be specified externally.\n\nThe $1$-dimensional Euler equations can be written in a quasi-linear form using primitive variables $\\mathbf{w} = (\\rho, u, p)^{\\top}$:\n$$\n\\frac{\\partial \\mathbf{w}}{\\partial t} + \\mathbf{A}(\\mathbf{w}) \\frac{\\partial \\mathbf{w}}{\\partial x} = 0\n$$\nwhere $\\mathbf{A}(\\mathbf{w})$ is the system's Jacobian matrix. For the primitive variable formulation, this matrix is:\n$$\n\\mathbf{A} = \\begin{pmatrix} u  \\rho  0 \\\\ 0  u  1/\\rho \\\\ 0  \\gamma p  u \\end{pmatrix}\n$$\nThe eigenvalues of $\\mathbf{A}$ represent the characteristic speeds, which are the velocities at which small disturbances (waves) propagate through the fluid. The eigenvalues $\\lambda$ are found by solving the characteristic equation $\\det(\\mathbf{A} - \\lambda \\mathbf{I}) = 0$:\n$$\n\\det \\begin{pmatrix} u-\\lambda  \\rho  0 \\\\ 0  u-\\lambda  1/\\rho \\\\ 0  \\gamma p  u-\\lambda \\end{pmatrix} = (u-\\lambda)\\left[(u-\\lambda)^2 - \\frac{\\gamma p}{\\rho}\\right] = 0\n$$\nDefining the local speed of sound as $a = \\sqrt{\\gamma p / \\rho}$, the eigenvalues are:\n$$\n\\lambda_1 = u - a, \\quad \\lambda_2 = u, \\quad \\lambda_3 = u + a\n$$\nThese three eigenvalues correspond to three distinct physical waves:\n-   $\\lambda_1 = u - a$: An acoustic wave propagating at speed $a$ relative to the flow, moving upstream.\n-   $\\lambda_2 = u$: An entropy or contact wave, which is a disturbance in density (or entropy) that is simply carried along with the flow.\n-   $\\lambda_3 = u + a$: An acoustic wave propagating at speed $a$ relative to the flow, moving downstream.\n\nThe problem specifies a uniform base state $(\\rho_0, u_0, p_0)$ with supersonic flow ($M_0  1$) in the positive $x$-direction ($u_0  0$). The Mach number condition $M_0 = u_0/a_0  1$ implies that the flow velocity $u_0$ is greater than the sound speed $a_0$.\n\nWe must now evaluate the signs of the characteristic speeds for this regime:\n1.  $\\lambda_3 = u_0 + a_0$: Since $u_0  0$ and $a_0  0$, it is clear that $\\lambda_3  0$.\n2.  $\\lambda_2 = u_0$: We are given $u_0  0$, so $\\lambda_2  0$.\n3.  $\\lambda_1 = u_0 - a_0$: Since $M_0 = u_0/a_0  1$, we have $u_0  a_0$. Therefore, $u_0 - a_0  0$, and so $\\lambda_1  0$.\n\nAll three characteristic speeds are positive. A positive characteristic speed $\\lambda  0$ indicates that the corresponding wave propagates in the positive $x$-direction (from left to right).\n\nNow, we apply this finding to the boundaries of the domain $x \\in [0,L]$:\n\n-   **At the inflow boundary, $x=0$**: A wave propagating in the positive $x$-direction is *entering* the domain. Since all three characteristic speeds ($\\lambda_1, \\lambda_2, \\lambda_3$) are positive, all three waves are entering the domain at $x=0$. According to the theory of characteristics, we must provide three boundary conditions at this boundary to specify the state of these incoming waves. This typically means prescribing all three primitive variables, $(\\rho, u, p)$, or an equivalent set of three independent quantities.\n\n-   **At the outflow boundary, $x=L$**: A wave propagating in the positive $x$-direction is *leaving* the domain. A wave would need a negative characteristic speed ($\\lambda  0$) to enter the domain from the right boundary. Since all three characteristic speeds are positive, no waves are entering the domain from $x=L$. All three waves are exiting the domain. Consequently, no boundary conditions can or should be prescribed at the supersonic outflow boundary. The values of the fluid variables at $x=L$ are entirely determined by the information propagating from within the domain. In a numerical simulation, this is typically handled by extrapolation from the interior cells.\n\nThis analysis confirms that for supersonic inflow, three variables must be prescribed, and for supersonic outflow, zero variables must be prescribed, due to the an\nd direction of the characteristic waves.\n\n### Option-by-Option Analysis\n\n-   **Option A**: This option states that in the supersonic regime with $u_00$, all small-amplitude waves propagate into the domain at $x=0$ and out of the domain at $x=L$. It correctly concludes that three variables must be prescribed at $x=0$ and none at $x=L$. This statement perfectly aligns with the derivation from first principles. The reasoning about wave directions and the resulting count of boundary conditions is entirely accurate.\n    -   Verdict: **Correct**.\n\n-   **Option B**: This option claims only pressure $p$ should be prescribed at supersonic inflow and one variable (e.g., $p$) at supersonic outflow. It further claims a pressure wave always enters from outflow. This is incorrect. Three conditions are needed at supersonic inflow. At supersonic outflow, zero conditions are needed, as no waves enter the domain. The claim that a pressure wave always enters from outflow is false; in supersonic flow ($ua$), the $u-a$ wave also travels downstream.\n    -   Verdict: **Incorrect**.\n\n-   **Option C**: This option suggests that the number of boundary conditions must equal the number of equations at every boundary, regardless of the flow regime. This is a fundamental misunderstanding of how boundary conditions are determined for hyperbolic systems. The number of conditions depends on the number of incoming characteristics, which varies with the flow regime (subsonic vs. supersonic) and boundary type (inflow vs. outflow).\n    -   Verdict: **Incorrect**.\n\n-   **Option D**: This option proposes prescribing two variables at inflow and one at outflow. This is numerically incorrect; three are needed at inflow and zero at outflow. Critically, it concludes with the statement \"the directions of waves do not affect boundary-condition specification in the inviscid Euler system.\" This is the exact opposite of the correct physical and mathematical principle.\n    -   Verdict: **Incorrect**.\n\n-   **Option E**: This option suggests one condition at inflow and two at outflow. This is numerically incorrect. The reasoning given is also flawed. The claim that an acoustic wave enters from the outflow boundary in supersonic flow is false, as demonstrated in the derivation ($u_0-a_0  0$).\n    -   Verdict: **Incorrect**.", "answer": "$$\\boxed{A}$$", "id": "3373668"}, {"introduction": "A robust numerical scheme must not only be stable and accurate but must also respect the fundamental physical symmetries of the equations it solves. One such symmetry is Galilean invariance: the laws of physics are the same in all inertial reference frames. This advanced practice guides you through the process of verifying this property in a CFD code by designing and implementing a numerical experiment [@problem_id:3373731]. By simulating a convecting vortex with different bulk velocities and measuring the numerical dissipation, you will test whether your discretization correctly distinguishes between physical phenomena and the observer's motion, a key skill in the validation of high-fidelity simulation tools.", "problem": "Construct a complete, runnable program that numerically demonstrates Galilean invariance for the compressible Euler equations by transporting a smooth isentropic vortex under different uniform bulk velocities and quantifying the invariance of discrete dissipation across these bulk velocities. Work in two spatial dimensions with periodic boundaries and use a finite-volume, central plus scalar-dissipation flux that is explicitly Galilean-invariant by measuring dissipation with respect to a locally averaged interface frame.\n\nThe governing equations are the two-dimensional compressible Euler equations for an ideal gas,\n$$\n\\frac{\\partial \\mathbf{U}}{\\partial t} + \\frac{\\partial \\mathbf{F}(\\mathbf{U})}{\\partial x} + \\frac{\\partial \\mathbf{G}(\\mathbf{U})}{\\partial y} = \\mathbf{0},\n$$\nwith conserved variables $\\mathbf{U} = [\\rho,\\ \\rho u,\\ \\rho v,\\ E]^{\\top}$, pressure $p = (\\gamma - 1)\\left(E - \\tfrac{1}{2}\\rho(u^2+v^2)\\right)$, and fluxes\n$$\n\\mathbf{F}(\\mathbf{U}) = \n\\begin{bmatrix}\n\\rho u\\\\\n\\rho u^2 + p\\\\\n\\rho u v\\\\\nu(E + p)\n\\end{bmatrix},\\qquad\n\\mathbf{G}(\\mathbf{U}) = \n\\begin{bmatrix}\n\\rho v\\\\\n\\rho u v\\\\\n\\rho v^2 + p\\\\\nv(E + p)\n\\end{bmatrix}.\n$$\n\nImplement a semi-discrete finite-volume method on a uniform Cartesian grid with periodic boundaries and a numerical flux at each face of the form\n$$\n\\widehat{\\mathbf{F}}_{i+\\frac{1}{2},j} = \\frac{1}{2}\\left(\\mathbf{F}(\\mathbf{U}_{L}) + \\mathbf{F}(\\mathbf{U}_{R})\\right) - \\frac{1}{2}\\, s^{(x)}_{\\max}\\,(\\mathbf{U}_{R} - \\mathbf{U}_{L}),\n$$\n$$\n\\widehat{\\mathbf{G}}_{i,j+\\frac{1}{2}} = \\frac{1}{2}\\left(\\mathbf{G}(\\mathbf{U}_{B}) + \\mathbf{G}(\\mathbf{U}_{T})\\right) - \\frac{1}{2}\\, s^{(y)}_{\\max}\\,(\\mathbf{U}_{T} - \\mathbf{U}_{B}),\n$$\nwhere $\\mathbf{U}_{L}$ and $\\mathbf{U}_{R}$ are the left and right cell states at an $x$-face, and $\\mathbf{U}_{B}$ and $\\mathbf{U}_{T}$ are the bottom and top cell states at a $y$-face. The scalar dissipations use interface-relative characteristic speeds to enforce Galilean invariance:\n$$\ns^{(x)}_{\\max} = \\max\\left(\\left|u_{L} - u_{\\mathrm{ref}}\\right| + a_{L},\\ \\left|u_{R} - u_{\\mathrm{ref}}\\right| + a_{R}\\right),\\quad u_{\\mathrm{ref}} = \\frac{u_{L} + u_{R}}{2},\n$$\n$$\ns^{(y)}_{\\max} = \\max\\left(\\left|v_{B} - v_{\\mathrm{ref}}\\right| + a_{B},\\ \\left|v_{T} - v_{\\mathrm{ref}}\\right| + a_{T}\\right),\\quad v_{\\mathrm{ref}} = \\frac{v_{B} + v_{T}}{2},\n$$\nwith $a = \\sqrt{\\gamma p/\\rho}$ the local speed of sound. Use piecewise constant reconstruction (first order) at faces to isolate the effect of Galilean-invariant dissipation. Advance in time using a Strong Stability Preserving Runge–Kutta scheme of order $3$.\n\nInitialize with the exact isentropic vortex solution convected by a uniform bulk flow $(U_0, 0)$, a standard smooth solution of the Euler equations. In nondimensional variables with ideal-gas constant equal to unity, set ambient state $\\rho_{\\infty} = 1$, $p_{\\infty} = 1$, $T_{\\infty} = 1$, and choose vortex strength $\\beta  0$. Let the domain be periodic on $[0,L] \\times [0,L]$, and the vortex center be $(x_0,y_0)$. Define $r^2 = (x-x_0)^2 + (y-y_0)^2$ and\n$$\nu(x,y) = U_0 - \\frac{\\beta}{2\\pi}\\exp\\!\\left(\\frac{1 - r^2}{2}\\right)(y - y_0),\\qquad\nv(x,y) = \\frac{\\beta}{2\\pi}\\exp\\!\\left(\\frac{1 - r^2}{2}\\right)(x - x_0),\n$$\n$$\nT(x,y) = 1 - \\frac{(\\gamma - 1)\\beta^2}{8\\gamma\\pi^2}\\exp\\!\\left(1 - r^2\\right),\\qquad\n\\rho(x,y) = T(x,y)^{\\frac{1}{\\gamma - 1}},\\qquad\np(x,y) = \\rho(x,y)^{\\gamma},\n$$\n$$\nE(x,y) = \\frac{p(x,y)}{\\gamma - 1} + \\frac{1}{2}\\rho(x,y)\\left(u(x,y)^2 + v(x,y)^2\\right).\n$$\nThis exact solution translates without distortion at speed $U_0$ in the $x$-direction.\n\nChoose parameters $\\gamma = 1.4$, $L = 10$, $(x_0,y_0) = (5,5)$, $\\beta = 5$, final time $T_{\\mathrm{final}} = 2$, and a uniform grid of $N_x = 64$, $N_y = 64$ cells. Use a Courant–Friedrichs–Lewy (CFL) number $\\mathrm{CFL} = 0.3$ to select the time step as\n$$\n\\Delta t = \\mathrm{CFL}\\cdot \\min\\!\\left(\\frac{\\Delta x}{\\max |u| + a},\\ \\frac{\\Delta y}{\\max |v| + a}\\right),\n$$\ncomputed conservatively from the worst-case initial condition among the test suite speeds so that $\\Delta t$ is identical across all runs; then choose an integer number of steps so the total time exactly equals $T_{\\mathrm{final}}$.\n\nDefine the perturbation kinetic energy (which excludes the uniform bulk flow) at time $t$ by\n$$\nK'(t;U_0) = \\iint \\frac{1}{2}\\,\\rho(x,y,t)\\left(\\left(u(x,y,t) - U_0\\right)^2 + v(x,y,t)^2\\right)\\,dx\\,dy.\n$$\nLet the fractional dissipation be\n$$\n\\alpha(U_0) = \\frac{K'(0;U_0) - K'(T_{\\mathrm{final}};U_0)}{K'(0;U_0)}.\n$$\nGalilean invariance of the discretization implies that $\\alpha(U_0)$ should be identical for different $U_0$ values, up to numerical time-integration and roundoff effects.\n\nImplement the program to:\n- Assemble the finite-volume update with the Galilean-invariant scalar dissipation as specified.\n- Initialize the isentropic vortex for each bulk speed and evolve to $T_{\\mathrm{final}}$ using the same $\\Delta t$ for all cases.\n- Compute $\\alpha(U_0)$ for each case using the trapezoidal rule equivalent to cell integration, i.e., multiply cell sums by $\\Delta x\\,\\Delta y$.\n\nTest suite:\n- Bulk speeds $U_0 \\in \\{\\,0.0,\\ 0.5,\\ -0.5,\\ 1.5\\,\\}$.\n\nRequired final output:\n- Your program should produce a single line of output containing a comma-separated Python-style list of floats in scientific notation with $6$ digits after the decimal point, enclosed in square brackets.\n- For each test case in the given order, output the absolute difference\n$$\nd(U_0) = \\big|\\alpha(U_0) - \\alpha(0.0)\\big|.\n$$\n- Thus, the output must be of the form $[d(0.0),d(0.5),d(-0.5),d(1.5)]$, each entry formatted with the string format specifier `%.6e`.\n\nUnits and angles:\n- All quantities are nondimensional. No angle unit is used.\n\nYour implementation must be self-contained, require no input, and adhere to the specified output format. The answer values are floats.", "solution": "The user has provided a scientifically sound and well-posed problem in computational fluid dynamics. The task is to numerically demonstrate the Galilean invariance of a specific finite-volume scheme for the two-dimensional compressible Euler equations. This will be accomplished by simulating the convection of an isentropic vortex under different bulk velocities and comparing the numerical dissipation.\n\n### 1. Governing Equations and Discretization\n\nThe problem is governed by the 2D compressible Euler equations in conservative form:\n$$\n\\frac{\\partial \\mathbf{U}}{\\partial t} + \\frac{\\partial \\mathbf{F}(\\mathbf{U})}{\\partial x} + \\frac{\\partial \\mathbf{G}(\\mathbf{U})}{\\partial y} = \\mathbf{0}\n$$\nwhere $\\mathbf{U} = [\\rho, \\rho u, \\rho v, E]^{\\top}$ is the vector of conserved variables (density, momentum components, and total energy density). The pressure $p$ is given by the ideal gas equation of state, $p = (\\gamma - 1)\\left(E - \\frac{1}{2}\\rho(u^2+v^2)\\right)$. The flux vectors $\\mathbf{F}(\\mathbf{U})$ and $\\mathbf{G}(\\mathbf{U})$ are functions of the state variables as specified in the problem statement.\n\nA semi-discrete finite-volume method is employed on a uniform Cartesian grid of size $N_x \\times N_y$ with cell dimensions $\\Delta x \\times \\Delta y$. The spatial derivatives are approximated by the divergence of numerical fluxes at the cell interfaces, leading to a system of ordinary differential equations for the cell-averaged state $\\mathbf{U}_{i,j}$:\n$$\n\\frac{d\\mathbf{U}_{i,j}}{dt} = -\\frac{1}{\\Delta x}\\left(\\widehat{\\mathbf{F}}_{i+\\frac{1}{2},j} - \\widehat{\\mathbf{F}}_{i-\\frac{1}{2},j}\\right) - \\frac{1}{\\Delta y}\\left(\\widehat{\\mathbf{G}}_{i,j+\\frac{1}{2}} - \\widehat{\\mathbf{G}}_{i,j-\\frac{1}{2}}\\right)\n$$\nPiecewise constant reconstruction (a first-order method) is used, meaning the state within each cell is assumed to be uniform, so the states at the left and right of an interface are simply the states of the adjacent cells, i.e., $\\mathbf{U}_L = \\mathbf{U}_{i,j}$ and $\\mathbf{U}_R = \\mathbf{U}_{i+1,j}$.\n\n### 2. Galilean-Invariant Numerical Flux\n\nA physical system's dynamics are independent of the constant velocity of the observer's inertial reference frame. This is the principle of Galilean invariance. A numerical scheme for such a system should ideally preserve this property; otherwise, a simple change in bulk velocity could alter the numerical solution's qualitative features, such as the amount of artificial dissipation.\n\nThe specified numerical flux is a central flux with an added scalar dissipation term, a form of an artificial viscosity or Lax-Friedrichs type flux. For the $x$-direction, it is:\n$$\n\\widehat{\\mathbf{F}}_{i+\\frac{1}{2},j} = \\frac{1}{2}\\left(\\mathbf{F}(\\mathbf{U}_{L}) + \\mathbf{F}(\\mathbf{U}_{R})\\right) - \\frac{1}{2} s^{(x)}_{\\max} (\\mathbf{U}_{R} - \\mathbf{U}_{L})\n$$\nThe key to achieving Galilean invariance lies in the definition of the dissipation coefficient, $s^{(x)}_{\\max}$. A standard Lax-Friedrichs scheme might use $s^{(x)}_{\\max} = \\max(|u_L|+a_L, |u_R|+a_R)$, which is not Galilean invariant because the absolute velocities $u_L$ and $u_R$ change with the reference frame.\n\nThe problem specifies an invariant form:\n$$\ns^{(x)}_{\\max} = \\max\\left(\\left|u_{L} - u_{\\mathrm{ref}}\\right| + a_{L},\\ \\left|u_{R} - u_{\\mathrm{ref}}\\right| + a_{R}\\right), \\quad \\text{with } u_{\\mathrm{ref}} = \\frac{u_{L} + u_{R}}{2}\n$$\nThe local sound speed, $a = \\sqrt{\\gamma p/\\rho}$, is a thermodynamic property and is inherently Galilean invariant. The velocity terms $|u_L - u_{\\mathrm{ref}}|$ and $|u_R - u_{\\mathrm{ref}}|$ are also invariant. To see this, consider a boosted reference frame moving at constant velocity $U_0$. The velocity in the new frame is $u' = u - U_0$. The reference velocity becomes $u'_{\\mathrm{ref}} = (u'_L + u'_R)/2 = ((u_L-U_0) + (u_R-U_0))/2 = u_{\\mathrm{ref}} - U_0$. The difference is therefore unchanged: $u'_L - u'_{\\mathrm{ref}} = (u_L - U_0) - (u_{\\mathrm{ref}} - U_0) = u_L - u_{\\mathrm{ref}}$.\nA simple algebraic manipulation shows that $|u_L - u_{\\mathrm{ref}}| = |u_R - u_{\\mathrm{ref}}| = \\frac{1}{2}|u_R - u_L|$. Thus, the expression for the dissipation coefficient simplifies to:\n$$\ns^{(x)}_{\\max} = \\frac{1}{2}|u_R - u_L| + \\max(a_L, a_R)\n$$\nThis form explicitly depends only on the velocity difference across the interface and thermodynamic quantities, all of which are Galilean invariant. A symmetric argument applies to the $y$-direction flux.\n\n### 3. Initial Condition and Time Evolution\n\nThe initial condition is an isentropic vortex, an exact, smooth solution to the Euler equations that translates at a constant velocity without changing its shape or strength. This makes it an ideal test case, as any decay of the vortex in a numerical simulation is due to the scheme's dissipation. By superimposing different bulk velocities $(U_0, 0)$ and running the simulation for a fixed time $T_{\\mathrm{final}}$, we can measure how the dissipation changes with the reference frame.\n\nTemporal integration is performed using a third-order Strong Stability Preserving Runge-Kutta (SSP-RK3) scheme. To ensure a fair comparison between test cases, a single, fixed time step $\\Delta t$ is used for all simulations. This $\\Delta t$ is calculated based on a global CFL condition, considering the maximum characteristic wave speed $(\\max(|u|+a), \\max(|v|+a))$ over the entire domain and across all initial velocity configurations ($U_0 \\in \\{0.0, 0.5, -0.5, 1.5\\}$). The number of time steps is chosen so that the total simulation time is exactly $T_{\\mathrm{final}}$.\n\n### 4. Verification and Implementation Strategy\n\nTo quantify the numerical dissipation, we measure the decay of the perturbation kinetic energy, $K'(t; U_0)$, which excludes the kinetic energy of the bulk flow. The fractional dissipation over the simulation time is\n$$\n\\alpha(U_0) = \\frac{K'(0;U_0) - K'(T_{\\mathrm{final}};U_0)}{K'(0;U_0)}\n$$\nIf the scheme is perfectly Galilean invariant, $\\alpha(U_0)$ should be identical for all $U_0$. We measure the deviation from this ideal by computing $d(U_0) = |\\alpha(U_0) - \\alpha(0.0)|$. Small values of $d(U_0)$ will confirm the near-invariance of the implemented method.\n\nThe implementation will be structured as follows:\n1.  Define all physical and numerical parameters. Set up the computational grid.\n2.  Calculate the globally conservative time step $\\Delta t$ and the required number of steps.\n3.  Loop through each bulk velocity $U_0$ in the test suite.\n4.  For each $U_0$:\n    a. Generate the initial state array $\\mathbf{U}(t=0)$.\n    b. Calculate and store the initial perturbation kinetic energy, $K'(0; U_0)$.\n    c. Evolve the system to $T_{\\mathrm{final}}$ using the SSP-RK3 integrator. The core of the integrator is a function computing the right-hand-side (spatial residual), which involves vectorized calculation of the Galilean-invariant numerical fluxes. Periodic boundary conditions are handled efficiently using `numpy.roll`.\n    d. Calculate the final perturbation kinetic energy, $K'(T_{\\mathrm{final}}; U_0)$.\n    e. Compute the fractional dissipation $\\alpha(U_0)$.\n5.  After the loop, compute the final metric $d(U_0)$ for each case and print the results in the specified format.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nimport math\n\ndef solve():\n    \"\"\"\n    Main function to set up and run the Galilean invariance test for the Euler equations.\n    \"\"\"\n    # --- Problem Parameters ---\n    GAMMA = 1.4\n    L = 10.0\n    X0, Y0 = 5.0, 5.0\n    BETA = 5.0\n    T_FINAL = 2.0\n    NX, NY = 64, 64\n    CFL = 0.3\n    U0_CASES = [0.0, 0.5, -0.5, 1.5]\n\n    # --- Derived Parameters and Grid Setup ---\n    DX = L / NX\n    DY = L / NY\n    X = np.linspace(0 + DX/2, L - DX/2, NX)\n    Y = np.linspace(0 + DY/2, L - DY/2, NY)\n    GRID_X, GRID_Y = np.meshgrid(X, Y)\n\n    # --- Helper Functions ---\n    def get_primitives(U):\n        \"\"\"\n        Decode primitive variables [rho, u, v, p, a] from the conservative state vector U.\n        \"\"\"\n        rho = U[..., 0]\n        u = U[..., 1] / rho\n        v = U[..., 2] / rho\n        E = U[..., 3]\n        p = (GAMMA - 1.0) * (E - 0.5 * rho * (u**2 + v**2))\n        a = np.sqrt(GAMMA * p / rho)\n        return rho, u, v, p, a\n\n    def get_fluxes(U, primitives):\n        \"\"\"\n        Calculate the Euler fluxes F(U) and G(U).\n        \"\"\"\n        rho, u, v, p, _ = primitives\n        E = U[..., 3]\n        \n        F = np.zeros_like(U)\n        F[..., 0] = rho * u\n        F[..., 1] = rho * u**2 + p\n        F[..., 2] = rho * u * v\n        F[..., 3] = u * (E + p)\n        \n        G = np.zeros_like(U)\n        G[..., 0] = rho * v\n        G[..., 1] = rho * u * v\n        G[..., 2] = rho * v**2 + p\n        G[..., 3] = v * (E + p)\n        \n        return F, G\n\n    def get_initial_state(U0):\n        \"\"\"\n        Initialize the isentropic vortex with a given bulk velocity U0.\n        \"\"\"\n        r_sq = (GRID_X - X0)**2 + (GRID_Y - Y0)**2\n        \n        exp_factor = np.exp((1.0 - r_sq) / 2.0)\n        u_prime = - (BETA / (2.0 * math.pi)) * exp_factor * (GRID_Y - Y0)\n        v_prime = (BETA / (2.0 * math.pi)) * exp_factor * (GRID_X - X0)\n        \n        u = U0 + u_prime\n        v = v_prime\n        \n        T = 1.0 - ((GAMMA - 1.0) * BETA**2) / (8.0 * GAMMA * math.pi**2) * np.exp(1.0 - r_sq)\n        rho = T**(1.0 / (GAMMA - 1.0))\n        p = rho**GAMMA\n        \n        E = p / (GAMMA - 1.0) + 0.5 * rho * (u**2 + v**2)\n        \n        U_init = np.zeros((NY, NX, 4), dtype=np.float64)\n        U_init[..., 0] = rho\n        U_init[..., 1] = rho * u\n        U_init[..., 2] = rho * v\n        U_init[..., 3] = E\n        \n        return U_init\n\n    def get_rhs(U):\n        \"\"\"\n        Calculates the right-hand side of the semi-discrete finite-volume formulation.\n        This corresponds to the negative divergence of the numerical flux.\n        \"\"\"\n        primitives = get_primitives(U)\n        F_flux, G_flux = get_fluxes(U, primitives)\n\n        # --- X-direction fluxes ---\n        U_R = np.roll(U, -1, axis=1)\n        _, u_L, _, _, a_L = primitives\n        _, u_R, _, _, a_R = get_primitives(U_R)\n        F_L = F_flux\n        F_R = np.roll(F_flux, -1, axis=1)\n        \n        # Galilean-invariant dissipation coefficient\n        u_ref = 0.5 * (u_L + u_R)\n        s_max_x = np.maximum(np.abs(u_L - u_ref) + a_L, np.abs(u_R - u_ref) + a_R)\n        s_max_x = s_max_x[..., np.newaxis]\n        F_hat = 0.5 * (F_L + F_R) - 0.5 * s_max_x * (U_R - U)\n        \n        # --- Y-direction fluxes ---\n        U_T = np.roll(U, -1, axis=0)\n        _, _, v_B, _, a_B = primitives\n        _, _, v_T, _, a_T = get_primitives(U_T)\n        G_B = G_flux\n        G_T = np.roll(G_flux, -1, axis=0)\n        \n        # Galilean-invariant dissipation coefficient\n        v_ref = 0.5 * (v_B + v_T)\n        s_max_y = np.maximum(np.abs(v_B - v_ref) + a_B, np.abs(v_T - v_ref) + a_T)\n        s_max_y = s_max_y[..., np.newaxis]\n        G_hat = 0.5 * (G_B + G_T) - 0.5 * s_max_y * (U_T - U)\n\n        # --- Divergence of fluxes ---\n        F_hat_imh = np.roll(F_hat, 1, axis=1)\n        G_hat_jmh = np.roll(G_hat, 1, axis=0)\n        \n        rhs = - (F_hat - F_hat_imh) / DX - (G_hat - G_hat_jmh) / DY\n        return rhs\n\n    def compute_perturbation_kinetic_energy(U, U0):\n        \"\"\"\n        Calculates the total perturbation kinetic energy over the domain.\n        \"\"\"\n        rho, u, v, _, _ = get_primitives(U)\n        integrand = 0.5 * rho * ((u - U0)**2 + v**2)\n        return np.sum(integrand) * DX * DY\n\n    # 1. Determine the global time step from the worst-case scenario\n    max_wave_speed = 0.0\n    for u0 in U0_CASES:\n        U_init = get_initial_state(u0)\n        _, u, v, _, a = get_primitives(U_init)\n        max_wave_speed = max(max_wave_speed, np.max(np.abs(u) + a) / DX, np.max(np.abs(v) + a) / DY)\n\n    dt_cfl = CFL / max_wave_speed\n    num_steps = int(np.ceil(T_FINAL / dt_cfl))\n    dt = T_FINAL / num_steps\n    \n    alpha_results = {}\n\n    # 2. Run simulation for each case\n    for u0 in U0_CASES:\n        U = get_initial_state(u0)\n        K_initial = compute_perturbation_kinetic_energy(U, u0)\n        \n        # SSP-RK3 Time Integration\n        for _ in range(num_steps):\n            rhs1 = get_rhs(U)\n            U1 = U + dt * rhs1\n            \n            rhs2 = get_rhs(U1)\n            U2 = 0.75 * U + 0.25 * (U1 + dt * rhs2)\n            \n            rhs3 = get_rhs(U2)\n            U = (1.0/3.0) * U + (2.0/3.0) * (U2 + dt * rhs3)\n            \n        K_final = compute_perturbation_kinetic_energy(U, u0)\n        \n        alpha = (K_initial - K_final) / K_initial\n        alpha_results[u0] = alpha\n        \n    # 3. Compute the final metric and format output\n    alpha_0 = alpha_results[0.0]\n    d_values = [abs(alpha_results[u0] - alpha_0) for u0 in U0_CASES]\n    \n    formatted_results = [f\"{val:.6e}\" for val in d_values]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "3373731"}]}