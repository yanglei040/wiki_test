{"hands_on_practices": [{"introduction": "The most effective way to understand the limitations of a model is to compare its predictions against a more fundamental description of reality. This first exercise provides a direct, quantitative look at the breakdown of the continuum hypothesis. You will compare the classic no-slip Navier-Stokes solution for channel flow against benchmark data from a Direct Simulation Monte Carlo (DSMC) method, which models the behavior of individual gas particles. By computing the deviation between these two models under different conditions, you will see firsthand how the error of the continuum assumption grows with the Knudsen number [@problem_id:3371932].", "problem": "You are asked to quantify, from first principles and with explicit algorithmic steps, how and why the continuum hypothesis breaks down in rarefied gas flows by comparing predictions from the classical continuum model to benchmark data representative of a particle-based method. The comparison should be framed around the Navier–Stokes equations and the Direct Simulation Monte Carlo (DSMC) paradigm, with the discrepancy attributed to the violation of the continuum hypothesis as the Knudsen number grows. Your program must implement the following, strictly in mathematical and logical terms, and produce quantitative outputs for a specified test suite.\n\nAssumptions and foundational bases:\n- The continuum hypothesis asserts that macroscopic fields vary smoothly and that molecular mean free paths are negligible relative to characteristic flow length scales. This hypothesis is expected to fail as the Knudsen number, defined as the ratio of molecular mean free path to a characteristic length, becomes non-negligible.\n- Use the ideal gas relation and kinetic theory to connect dynamic viscosity, pressure, and temperature to the molecular mean free path; start from first principles that relate microscopic and macroscopic quantities without presupposing the final target result.\n- Use the planar, steady, fully developed, isothermal, pressure-driven channel flow between parallel plates as the continuum baseline. In the continuum regime, the Navier–Stokes model for such a flow yields a parabolic velocity profile under the no-slip boundary condition.\n\nComputations to perform for each test case:\n1. Compute the molecular mean free path $\\,\\lambda\\,$ from the given dynamic viscosity $\\,\\mu\\,$, pressure $\\,p\\,$, and temperature $\\,T\\,$ using a kinetic-theory-based relation that connects $\\,\\mu\\,$, $\\,p\\,$, and $\\,T\\,$ via the ideal-gas framework and molecular-velocity statistics. Then compute the Knudsen number $\\,\\mathrm{Kn} = \\lambda / H\\,$ where $\\,H\\,$ is the channel height.\n2. Compute the baseline continuum prediction for planar Poiseuille flow, that is, the steady, fully developed velocity profile $\\,u_{\\mathrm{NS}}(y)\\,$ implied by the Navier–Stokes equations with zero wall velocity and a constant pressure gradient $\\,\\mathrm{d}p/\\mathrm{d}x\\,$, evaluated at the given wall-normal sample locations $\\,y_i\\,$.\n3. Using the provided DSMC benchmark velocities $\\,u_{\\mathrm{DSMC}}(y_i)\\,$ at the same locations, compute the normalized Euclidean deviation defined as the Euclidean norm of $\\,u_{\\mathrm{NS}} - u_{\\mathrm{DSMC}}\\,$ divided by the Euclidean norm of $\\,u_{\\mathrm{DSMC}}\\,$. Both norms are taken over the discrete set of provided sample points.\n4. Attribute the discrepancy to the breakdown of the continuum hypothesis by returning a boolean flag that is true if and only if $\\,\\mathrm{Kn} \\geq 0.01\\,$. This threshold demarcates the continuum regime ($\\,\\mathrm{Kn} \\ll 1\\,$) from regimes where first-order slip or transition effects become significant; use it deterministically as the attribution criterion.\n\nUnits and formatting:\n- Channel height $\\,H\\,$ is in $\\,\\mathrm{m}\\,$, pressure $\\,p\\,$ is in $\\,\\mathrm{Pa}\\,$, dynamic viscosity $\\,\\mu\\,$ is in $\\,\\mathrm{Pa}\\cdot\\mathrm{s}\\,$, temperature $\\,T\\,$ is in $\\,\\mathrm{K}\\,$, pressure gradient $\\,\\mathrm{d}p/\\mathrm{d}x\\,$ is in $\\,\\mathrm{Pa/m}\\,$, and velocities are in $\\,\\mathrm{m/s}\\,$. The Knudsen number and the normalized deviation are dimensionless. No angles are used.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case result is a list of the form $[\\mathrm{Kn}, \\Delta, \\mathrm{breakdown}]$ with $\\,\\mathrm{Kn}\\,$ a float, $\\,\\Delta\\,$ a float, and $\\,\\mathrm{breakdown}\\,$ a boolean. For example: $[ [0.001,0.02,False],[0.1,0.2,True] ]$.\n\nTest suite:\nFor all cases, take the specific gas constant of air as $\\,R = 287\\,\\mathrm{J/(kg\\cdot K)}\\,$. The wall-normal sample locations are the evenly spaced set $\\,y_i = (i/10) H\\,$ for $\\,i \\in \\{0,1,\\dots,10\\}\\,$.\n\n- Case A (high rarefaction, microchannel):\n  - Channel height $\\,H = 5\\times 10^{-6}\\,\\mathrm{m}\\,$.\n  - Dynamic viscosity $\\,\\mu = 1.8\\times 10^{-5}\\,\\mathrm{Pa}\\cdot\\mathrm{s}\\,$.\n  - Pressure $\\,p = 100\\,\\mathrm{Pa}\\,$.\n  - Temperature $\\,T = 300\\,\\mathrm{K}\\,$.\n  - Pressure gradient $\\,\\mathrm{d}p/\\mathrm{d}x = -5000\\,\\mathrm{Pa/m}\\,$.\n  - DSMC benchmark velocities $\\,u_{\\mathrm{DSMC}}(y_i)\\,$ in $\\,\\mathrm{m/s}\\,$ at the prescribed sample locations:\n    - $[\\,0.0460000,\\,0.0463125,\\,0.0465556,\\,0.0467292,\\,0.0468333,\\,0.0468681,\\,0.0468333,\\,0.0467292,\\,0.0465556,\\,0.0463125,\\,0.0460000\\,]$.\n\n- Case B (near-continuum, millimeter channel):\n  - Channel height $\\,H = 1\\times 10^{-3}\\,\\mathrm{m}\\,$.\n  - Dynamic viscosity $\\,\\mu = 1.8\\times 10^{-5}\\,\\mathrm{Pa}\\cdot\\mathrm{s}\\,$.\n  - Pressure $\\,p = 101325\\,\\mathrm{Pa}\\,$.\n  - Temperature $\\,T = 300\\,\\mathrm{K}\\,$.\n  - Pressure gradient $\\,\\mathrm{d}p/\\mathrm{d}x = -100\\,\\mathrm{Pa/m}\\,$.\n  - DSMC benchmark velocities $\\,u_{\\mathrm{DSMC}}(y_i)\\,$ in $\\,\\mathrm{m/s}\\,$:\n    - $[\\,0.0001833,\\,0.2501833,\\,0.4446277,\\,0.5835166,\\,0.6668500,\\,0.6946277,\\,0.6668500,\\,0.5835166,\\,0.4446277,\\,0.2501833,\\,0.0001833\\,]$.\n\n- Case C (transition regime, microchannel):\n  - Channel height $\\,H = 1\\times 10^{-5}\\,\\mathrm{m}\\,$.\n  - Dynamic viscosity $\\,\\mu = 1.8\\times 10^{-5}\\,\\mathrm{Pa}\\cdot\\mathrm{s}\\,$.\n  - Pressure $\\,p = 1000\\,\\mathrm{Pa}\\,$.\n  - Temperature $\\,T = 300\\,\\mathrm{K}\\,$.\n  - Pressure gradient $\\,\\mathrm{d}p/\\mathrm{d}x = -2000\\,\\mathrm{Pa/m}\\,$.\n  - DSMC benchmark velocities $\\,u_{\\mathrm{DSMC}}(y_i)\\,$ in $\\,\\mathrm{m/s}\\,$:\n    - $[\\,0.0036667,\\,0.0041667,\\,0.0041111,\\,0.0040556,\\,0.0040000,\\,0.0039444,\\,0.0038889,\\,0.0038334,\\,0.0037778,\\,0.0037222,\\,0.0036667\\,]$.\n\nComputational output specification:\n- For each case, compute $\\,\\mathrm{Kn} = \\lambda/H\\,$, compute the normalized Euclidean deviation $\\,\\Delta\\,$ between $\\,u_{\\mathrm{NS}}(y_i)\\,$ and $\\,u_{\\mathrm{DSMC}}(y_i)\\,$, and set the boolean $\\,\\mathrm{breakdown} = (\\mathrm{Kn} \\geq 0.01)\\,$.\n- Your program should produce a single line of output containing the results for the three cases as a comma-separated list enclosed in square brackets, where each element is the list $[\\,\\mathrm{Kn},\\,\\Delta,\\,\\mathrm{breakdown}\\,]$ in the order A, B, C. The output is dimensionless for $\\,\\mathrm{Kn}\\,$ and $\\,\\Delta\\,$ and a boolean for $\\,\\mathrm{breakdown}\\,$.", "solution": "The problem is valid as it is scientifically grounded, well-posed, objective, and contains all necessary information for a unique solution. We will proceed by implementing the specified computational steps. The overall goal is to quantify the discrepancy between the continuum-based Navier-Stokes model and a particle-based Direct Simulation Monte Carlo (DSMC) model for pressure-driven channel flow, attributing the difference to the breakdown of the continuum hypothesis as measured by the Knudsen number, $\\mathrm{Kn}$.\n\nThe solution algorithm is structured into four main parts for each test case:\n1.  Calculation of the molecular mean free path, $\\lambda$, and the Knudsen number, $\\mathrm{Kn}$.\n2.  Calculation of the continuum velocity profile, $u_{\\mathrm{NS}}(y)$, from the Navier-Stokes equations.\n3.  Computation of the normalized deviation, $\\Delta$, between the continuum and DSMC velocity profiles.\n4.  Application of the criterion for continuum breakdown.\n\n**Part 1: Molecular Mean Free Path and Knudsen Number**\n\nThe problem requires deriving a relationship for the mean free path, $\\lambda$, from first principles using kinetic theory. From elementary kinetic theory, the dynamic viscosity, $\\mu$, of a gas can be related to its microscopic properties by considering the transport of momentum by molecules. A commonly used approximation is:\n$$ \\mu \\approx \\frac{1}{2}\\rho \\bar{v} \\lambda $$\nwhere $\\rho$ is the gas density and $\\bar{v}$ is the mean thermal speed of the molecules.\n\nThe density, $\\rho$, can be expressed using the ideal gas law:\n$$ p = \\rho R T \\implies \\rho = \\frac{p}{RT} $$\nwhere $p$ is the pressure, $T$ is the temperature, and $R$ is the specific gas constant.\n\nThe mean thermal speed, $\\bar{v}$, is derived from the Maxwell-Boltzmann distribution and is given by:\n$$ \\bar{v} = \\sqrt{\\frac{8 k_B T}{\\pi m}} = \\sqrt{\\frac{8 R T}{\\pi}} $$\nwhere $k_B$ is the Boltzmann constant and $m$ is the molecular mass, with $R=k_B/m$.\n\nSubstituting the expressions for $\\rho$ and $\\bar{v}$ into the viscosity equation gives:\n$$ \\mu = \\frac{1}{2} \\left( \\frac{p}{RT} \\right) \\left( \\sqrt{\\frac{8 R T}{\\pi}} \\right) \\lambda $$\nSolving this equation for the mean free path $\\lambda$ yields:\n$$ \\lambda = \\frac{2 \\mu R T}{p \\sqrt{\\frac{8 R T}{\\pi}}} = \\frac{2 \\mu}{p} \\sqrt{\\frac{(\\pi R^2 T^2)}{8 R T}} = \\frac{2 \\mu}{p} \\sqrt{\\frac{\\pi R T}{8}} = \\frac{\\mu}{p} \\sqrt{\\frac{\\pi R T}{2}} $$\nThis expression allows the calculation of $\\lambda$ from the given macroscopic properties $\\mu$, $p$, and $T$.\n\nThe Knudsen number, $\\mathrm{Kn}$, is a dimensionless parameter defined as the ratio of the molecular mean free path to a characteristic length scale of the flow, which is the channel height $H$ in this problem:\n$$ \\mathrm{Kn} = \\frac{\\lambda}{H} $$\n\n**Part 2: Continuum Velocity Profile (Navier-Stokes)**\n\nThe baseline continuum model is the planar Poiseuille flow, which describes a steady, fully developed, pressure-driven flow between two stationary parallel plates. For such a flow, the Navier-Stokes equations simplify to a one-dimensional second-order ordinary differential equation for the velocity $u(y)$:\n$$ \\frac{\\mathrm{d}^2 u}{\\mathrm{d} y^2} = \\frac{1}{\\mu} \\frac{\\mathrm{d}p}{\\mathrm{d}x} $$\nwhere $y$ is the coordinate normal to the plates and $\\mathrm{d}p/\\mathrm{d}x$ is the constant pressure gradient driving the flow.\n\nThe continuum hypothesis is embodied in the no-slip boundary conditions, which state that the fluid velocity at the solid walls is zero. For walls located at $y=0$ and $y=H$:\n$$ u(0) = 0 $$\n$$ u(H) = 0 $$\nIntegrating the governing equation twice and applying these boundary conditions yields the classic parabolic velocity profile for Poiseuille flow:\n$$ u_{\\mathrm{NS}}(y) = \\frac{1}{2\\mu} \\frac{\\mathrm{d}p}{\\mathrm{d}x} (y^2 - Hy) $$\nThis equation will be used to calculate the predicted continuum velocity, $u_{\\mathrm{NS}}(y_i)$, at the specified sample locations $y_i = (i/10)H$ for $i \\in \\{0, 1, \\dots, 10\\}$.\n\n**Part 3: Normalized Euclidean Deviation ($\\Delta$)**\n\nTo quantify the discrepancy between the continuum model prediction and the particle simulation benchmark, we compute the normalized Euclidean deviation, $\\Delta$. This metric is defined as the Euclidean norm of the difference between the two velocity vectors, normalized by the norm of the benchmark vector. Let $\\mathbf{u}_{\\mathrm{NS}}$ be the vector of velocities $[u_{\\mathrm{NS}}(y_0), \\dots, u_{\\mathrm{NS}}(y_{10})]$ and $\\mathbf{u}_{\\mathrm{DSMC}}$ be the vector of provided benchmark velocities $[u_{\\mathrm{DSMC}}(y_0), \\dots, u_{\\mathrm{DSMC}}(y_{10})]$. The deviation $\\Delta$ is:\n$$ \\Delta = \\frac{\\Vert \\mathbf{u}_{\\mathrm{NS}} - \\mathbf{u}_{\\mathrm{DSMC}} \\Vert_2}{\\Vert \\mathbf{u}_{\\mathrm{DSMC}} \\Vert_2} = \\frac{\\sqrt{\\sum_{i=0}^{10} (u_{\\mathrm{NS}}(y_i) - u_{\\mathrm{DSMC}}(y_i))^2}}{\\sqrt{\\sum_{i=0}^{10} (u_{\\mathrm{DSMC}}(y_i))^2}} $$\nA large value of $\\Delta$ indicates a significant failure of the continuum model to reproduce the DSMC data.\n\n**Part 4: Continuum Breakdown Criterion**\n\nThe breakdown of the continuum hypothesis is attributed deterministically based on the Knudsen number. The criterion given is that breakdown occurs when rarefaction effects become significant, which is conventionally marked by the threshold $\\mathrm{Kn} \\geq 0.01$. The boolean flag $\\mathrm{breakdown}$ is thus computed as:\n$$ \\mathrm{breakdown} = (\\mathrm{Kn} \\geq 0.01) $$\nThis process will be applied to each of the three test cases provided.", "answer": "```python\nimport numpy as np\nimport math\n\ndef solve():\n    \"\"\"\n    Solves the fluid dynamics problem for three test cases, quantifying the\n    breakdown of the continuum hypothesis.\n    \"\"\"\n\n    # Specific gas constant for air in J/(kg.K)\n    R = 287.0\n\n    test_cases = [\n        # Case A: High rarefaction, microchannel\n        {\n            \"H\": 5e-6, \"mu\": 1.8e-5, \"p\": 100.0, \"T\": 300.0,\n            \"dp_dx\": -5000.0,\n            \"u_dsmc\": np.array([0.0460000, 0.0463125, 0.0465556, 0.0467292, 0.0468333,\n                               0.0468681, 0.0468333, 0.0467292, 0.0465556, 0.0463125,\n                               0.0460000])\n        },\n        # Case B: Near-continuum, millimeter channel\n        {\n            \"H\": 1e-3, \"mu\": 1.8e-5, \"p\": 101325.0, \"T\": 300.0,\n            \"dp_dx\": -100.0,\n            \"u_dsmc\": np.array([0.0001833, 0.2501833, 0.4446277, 0.5835166, 0.6668500,\n                               0.6946277, 0.6668500, 0.5835166, 0.4446277, 0.2501833,\n                               0.0001833])\n        },\n        # Case C: Transition regime, microchannel\n        {\n            \"H\": 1e-5, \"mu\": 1.8e-5, \"p\": 1000.0, \"T\": 300.0,\n            \"dp_dx\": -2000.0,\n            \"u_dsmc\": np.array([0.0036667, 0.0041667, 0.0041111, 0.0040556, 0.0040000,\n                               0.0039444, 0.0038889, 0.0038334, 0.0037778, 0.0037222,\n                               0.0036667])\n        }\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        H = case[\"H\"]\n        mu = case[\"mu\"]\n        p = case[\"p\"]\n        T = case[\"T\"]\n        dp_dx = case[\"dp_dx\"]\n        u_dsmc = case[\"u_dsmc\"]\n\n        # 1. Compute mean free path (lambda) and Knudsen number (Kn)\n        # lambda = (mu/p) * sqrt(pi*R*T/2)\n        lambda_val = (mu / p) * math.sqrt((math.pi * R * T) / 2.0)\n        kn = lambda_val / H\n\n        # 2. Compute continuum Navier-Stokes velocity profile\n        # Sample points y_i = (i/10) * H for i in {0, ..., 10}\n        y = np.linspace(0, H, 11)\n        # u_NS(y) = (1/(2*mu)) * (dp/dx) * (y^2 - H*y)\n        u_ns = (1.0 / (2.0 * mu)) * dp_dx * (y**2 - H * y)\n\n        # 3. Compute normalized Euclidean deviation (Delta)\n        # Delta = ||u_ns - u_dsmc|| / ||u_dsmc||\n        norm_u_dsmc = np.linalg.norm(u_dsmc)\n        if norm_u_dsmc == 0:\n            # Avoid division by zero, though not expected for given data.\n            # If benchmark is zero, any non-zero prediction is infinitely deviant.\n            # If both are zero, deviation is 0.\n            delta = 0.0 if np.linalg.norm(u_ns) == 0 else float('inf')\n        else:\n            delta = np.linalg.norm(u_ns - u_dsmc) / norm_u_dsmc\n\n        # 4. Attribute breakdown based on Kn\n        breakdown = kn >= 0.01\n\n        results.append([kn, delta, breakdown])\n\n    # Format the final output string as specified\n    inner_strings = []\n    for res in results:\n        # Format: [Kn,Delta,breakdown]\n        inner_strings.append(f\"[{res[0]},{res[1]},{res[2]}]\")\n    \n    final_output = f\"[{','.join(inner_strings)}]\"\n    print(final_output)\n\nsolve()\n```", "id": "3371932"}, {"introduction": "Having established that the continuum model can fail in rarefied conditions, we now explore how to improve it. One of the first and most critical assumptions to break down is the no-slip boundary condition at solid walls, which is a cornerstone of classical fluid dynamics. This practice guides you through the analytical derivation of a velocity profile that incorporates a finite velocity slip at the wall, a common phenomenon in micro- and nanofluidics. By working through this problem, you will quantify the significant error introduced by incorrectly assuming a no-slip condition in regimes where rarefaction is important [@problem_id:3372026].", "problem": "Consider pressure-driven laminar flow of a Newtonian gas through a long slit microchannel analyzed within Computational Fluid Dynamics (CFD). The microchannel comprises two parallel plates separated by a gap of height $H$ and of width $W$ with $W \\gg H$, and has length $L$. A constant pressure drop $\\Delta p$ is imposed along the streamwise direction $x$ so that the pressure gradient is uniform, steady, and equal to $\\partial p / \\partial x = -\\Delta p / L$. The gas has dynamic viscosity $\\mu$, and the continuum hypothesis is adopted for the bulk while allowing for finite tangential slip at the solid boundaries via the Navier slip boundary condition with slip length $b$. Assume fully developed flow, negligible body forces, incompressibility in the sense of negligible density variation due to the imposed $\\Delta p$, and negligible entrance and exit effects.\n\nStarting from the streamwise momentum equation for steady, fully developed flow between parallel plates and enforcing the appropriate boundary conditions at $z=0$ and $z=H$, perform the following:\n\n1. Derive the streamwise velocity profile $u(z)$ that satisfies the continuum momentum balance and the boundary condition set for two cases: (i) strict no-slip ($b=0$) and (ii) finite slip with Navier slip length $b>0$ applied at both plates.\n2. Compute the volumetric flow rates $Q_{\\text{no-slip}}$ and $Q_{\\text{slip}}$ by integrating the respective velocity profiles across the gap and multiplying by the width $W$. Express intermediate volumetric flow rates in $\\mathrm{m^3/s}$.\n3. Quantify the error induced by assuming strict continuum no-slip when the true physics exhibits finite slip by defining the dimensionless relative error\n$$\n\\varepsilon \\equiv \\frac{Q_{\\text{slip}} - Q_{\\text{no-slip}}}{Q_{\\text{slip}}}.\n$$\n\nUse the following physically realistic parameters:\n- Channel height $H = 1.2 \\times 10^{-6}\\,\\mathrm{m}$,\n- Channel width $W = 2.00 \\times 10^{-4}\\,\\mathrm{m}$,\n- Channel length $L = 8.00 \\times 10^{-3}\\,\\mathrm{m}$,\n- Pressure drop $\\Delta p = 1.500 \\times 10^{3}\\,\\mathrm{Pa}$,\n- Dynamic viscosity $\\mu = 1.85 \\times 10^{-5}\\,\\mathrm{Pa \\cdot s}$,\n- Slip length $b = 6.00 \\times 10^{-8}\\,\\mathrm{m}$.\n\nRound your final reported value of $\\varepsilon$ to four significant figures. Express $\\varepsilon$ as a decimal fraction and do not include a percentage sign.", "solution": "The problem statement has been critically evaluated and is determined to be valid. It is scientifically grounded, well-posed, objective, and internally consistent. It presents a canonical problem in microfluidics—plane Poiseuille flow with a slip boundary condition—with a complete set of physically realistic parameters. The analysis proceeds as requested.\n\nThe governing equation for steady, fully developed, pressure-driven laminar flow of an incompressible Newtonian fluid between two infinite parallel plates, with negligible body forces, is a simplified form of the Navier-Stokes momentum equation. With the streamwise direction as $x$ and the transverse direction as $z$, the velocity vector is $\\mathbf{v} = (u(z), 0, 0)$. The momentum equation in the $x$-direction reduces to:\n$$\n\\frac{d^2 u}{d z^2} = \\frac{1}{\\mu} \\frac{\\partial p}{\\partial x}\n$$\nGiven the uniform pressure gradient $\\frac{\\partial p}{\\partial x} = -\\frac{\\Delta p}{L}$, the governing ordinary differential equation is:\n$$\n\\frac{d^2 u}{d z^2} = -\\frac{\\Delta p}{\\mu L}\n$$\nIntegrating twice with respect to $z$ yields the general solution for the velocity profile:\n$$\n\\frac{du}{dz} = -\\frac{\\Delta p}{\\mu L} z + C_1\n$$\n$$\nu(z) = -\\frac{\\Delta p}{2\\mu L} z^2 + C_1 z + C_2\n$$\nwhere $C_1$ and $C_2$ are integration constants determined by the boundary conditions. The channel plates are located at $z=0$ and $z=H$. The Navier slip boundary condition relates the fluid velocity at the wall to the local shear stress. At the lower wall ($z=0$) and upper wall ($z=H$), the conditions are:\n$$\nu(0) = b \\left. \\frac{du}{dz} \\right|_{z=0} \\quad \\text{and} \\quad u(H) = -b \\left. \\frac{du}{dz} \\right|_{z=H}\n$$\n\n**1. Derivation of the Velocity Profile $u(z)$**\n\n**Case (i): Strict No-Slip Condition ($b=0$)**\nFor the no-slip case, the slip length $b=0$. The boundary conditions simplify to $u(0)=0$ and $u(H)=0$.\nApplying $u(0)=0$ to the general solution:\n$$\nu(0) = -\\frac{\\Delta p}{2\\mu L}(0)^2 + C_1(0) + C_2 = 0 \\implies C_2 = 0\n$$\nApplying $u(H)=0$:\n$$\nu(H) = -\\frac{\\Delta p}{2\\mu L} H^2 + C_1 H = 0 \\implies C_1 = \\frac{\\Delta p H}{2\\mu L}\n$$\nSubstituting these constants, the no-slip velocity profile is:\n$$\nu_{\\text{no-slip}}(z) = -\\frac{\\Delta p}{2\\mu L} z^2 + \\frac{\\Delta p H}{2\\mu L} z = \\frac{\\Delta p}{2\\mu L}(Hz - z^2)\n$$\n\n**Case (ii): Finite Slip Condition ($b>0$)**\nFor a symmetric channel and boundary conditions, the flow profile must be symmetric about the centerline $z=H/2$. This implies that the velocity gradient (and thus shear stress) must be zero at the centerline.\n$$\n\\left. \\frac{du}{dz} \\right|_{z=H/2} = -\\frac{\\Delta p}{\\mu L} \\left(\\frac{H}{2}\\right) + C_1 = 0 \\implies C_1 = \\frac{\\Delta p H}{2\\mu L}\n$$\nThis determines $C_1$ from physical reasoning. Now we use the slip boundary condition at $z=0$ to find $C_2$:\n$$\nu(0) = C_2\n$$\n$$\nb \\left. \\frac{du}{dz} \\right|_{z=0} = b \\left( -\\frac{\\Delta p}{\\mu L}(0) + C_1 \\right) = b C_1\n$$\nEquating these gives $C_2 = b C_1 = b \\frac{\\Delta p H}{2\\mu L}$.\nSubstituting $C_1$ and $C_2$ into the general solution, the velocity profile with slip is:\n$$\nu_{\\text{slip}}(z) = -\\frac{\\Delta p}{2\\mu L} z^2 + \\frac{\\Delta p H}{2\\mu L} z + \\frac{b \\Delta p H}{2\\mu L}\n$$\n$$\nu_{\\text{slip}}(z) = \\frac{\\Delta p}{2\\mu L}(Hz - z^2 + bH)\n$$\nThis profile satisfies both slip boundary conditions.\n\n**2. Computation of Volumetric Flow Rates**\n\nThe volumetric flow rate $Q$ is obtained by integrating the velocity profile over the channel's cross-sectional area, $A = W \\times H$. Assuming $W \\gg H$, the flow is approximately two-dimensional, and we can write:\n$$\nQ = W \\int_{0}^{H} u(z) dz\n$$\n\n**No-slip flow rate, $Q_{\\text{no-slip}}$:**\n$$\nQ_{\\text{no-slip}} = W \\int_{0}^{H} \\frac{\\Delta p}{2\\mu L}(Hz - z^2) dz = \\frac{W \\Delta p}{2\\mu L} \\left[ \\frac{Hz^2}{2} - \\frac{z^3}{3} \\right]_0^H\n$$\n$$\nQ_{\\text{no-slip}} = \\frac{W \\Delta p}{2\\mu L} \\left( \\frac{H^3}{2} - \\frac{H^3}{3} \\right) = \\frac{W \\Delta p}{2\\mu L} \\left( \\frac{H^3}{6} \\right) = \\frac{W \\Delta p H^3}{12\\mu L}\n$$\nSubstituting the given numerical values:\n$$\nQ_{\\text{no-slip}} = \\frac{(2.00 \\times 10^{-4}\\,\\mathrm{m})(1.500 \\times 10^{3}\\,\\mathrm{Pa})(1.2 \\times 10^{-6}\\,\\mathrm{m})^3}{12(1.85 \\times 10^{-5}\\,\\mathrm{Pa \\cdot s})(8.00 \\times 10^{-3}\\,\\mathrm{m})} \\approx 2.919 \\times 10^{-13}\\,\\mathrm{m^3/s}\n$$\n\n**Slip flow rate, $Q_{\\text{slip}}$:**\n$$\nQ_{\\text{slip}} = W \\int_{0}^{H} \\frac{\\Delta p}{2\\mu L}(Hz - z^2 + bH) dz = W \\int_{0}^{H} u_{\\text{no-slip}}(z) dz + W \\int_{0}^{H} \\frac{\\Delta p bH}{2\\mu L} dz\n$$\n$$\nQ_{\\text{slip}} = Q_{\\text{no-slip}} + \\frac{W \\Delta p bH}{2\\mu L} [z]_0^H = Q_{\\text{no-slip}} + \\frac{W \\Delta p bH^2}{2\\mu L}\n$$\nSubstituting the expression for $Q_{\\text{no-slip}}$:\n$$\nQ_{\\text{slip}} = \\frac{W \\Delta p H^3}{12\\mu L} + \\frac{6W \\Delta p bH^2}{12\\mu L} = \\frac{W \\Delta p H^3}{12\\mu L} \\left( 1 + \\frac{6b}{H} \\right)\n$$\nSubstituting the numerical values:\n$$\n1 + \\frac{6b}{H} = 1 + \\frac{6(6.00 \\times 10^{-8}\\,\\mathrm{m})}{1.2 \\times 10^{-6}\\,\\mathrm{m}} = 1 + \\frac{3.6 \\times 10^{-7}}{1.2 \\times 10^{-6}} = 1 + 0.3 = 1.3\n$$\n$$\nQ_{\\text{slip}} = Q_{\\text{no-slip}} \\times 1.3 \\approx (2.919 \\times 10^{-13}\\,\\mathrm{m^3/s}) \\times 1.3 \\approx 3.795 \\times 10^{-13}\\,\\mathrm{m^3/s}\n$$\n\n**3. Quantification of Relative Error $\\varepsilon$**\n\nThe dimensionless relative error $\\varepsilon$ is defined as:\n$$\n\\varepsilon = \\frac{Q_{\\text{slip}} - Q_{\\text{no-slip}}}{Q_{\\text{slip}}}\n$$\nFrom our derivation for $Q_{\\text{slip}}$, we have $Q_{\\text{slip}} - Q_{\\text{no-slip}} = \\frac{W \\Delta p bH^2}{2\\mu L}$.\nSubstituting the expressions for the numerator and denominator:\n$$\n\\varepsilon = \\frac{\\frac{W \\Delta p bH^2}{2\\mu L}}{\\frac{W \\Delta p H^3}{12\\mu L} \\left( 1 + \\frac{6b}{H} \\right)} = \\frac{\\frac{bH^2}{2}}{\\frac{H^3}{12} \\left( \\frac{H+6b}{H} \\right)}\n$$\n$$\n\\varepsilon = \\frac{6bH^2}{H^2(H+6b)} = \\frac{6b}{H+6b}\n$$\nThis elegant symbolic result shows the error depends only on the ratio of the slip length to the channel height. Now, we substitute the given values for $H$ and $b$:\n$$\nH = 1.2 \\times 10^{-6}\\,\\mathrm{m}\n$$\n$$\nb = 6.00 \\times 10^{-8}\\,\\mathrm{m}\n$$\n$$\n\\varepsilon = \\frac{6(6.00 \\times 10^{-8}\\,\\mathrm{m})}{1.2 \\times 10^{-6}\\,\\mathrm{m} + 6(6.00 \\times 10^{-8}\\,\\mathrm{m})} = \\frac{3.6 \\times 10^{-7}}{1.2 \\times 10^{-6} + 3.6 \\times 10^{-7}}\n$$\n$$\n\\varepsilon = \\frac{3.6 \\times 10^{-7}}{1.2 \\times 10^{-6} + 0.36 \\times 10^{-6}} = \\frac{3.6 \\times 10^{-7}}{1.56 \\times 10^{-6}} = \\frac{3.6}{15.6} = \\frac{36}{156} = \\frac{3}{13}\n$$\nAs a decimal fraction, $\\varepsilon = \\frac{3}{13} \\approx 0.23076923...$\nRounding to four significant figures as requested:\n$$\n\\varepsilon \\approx 0.2308\n$$", "answer": "$$\n\\boxed{0.2308}\n$$", "id": "3372026"}, {"introduction": "This final practice moves from identifying continuum breakdown and acknowledging slip to actively modeling and calibrating it, a task central to modern multiscale simulation. Here, you will bridge the gap between the continuum and molecular worlds by implementing a physically-based slip boundary condition whose behavior is governed by the Tangential Momentum Accommodation Coefficient (TMAC, $\\sigma$). This exercise simulates a real-world research scenario where you use high-fidelity data, here represented by a Molecular Dynamics (MD) simulation, to calibrate this crucial parameter for a more accurate, extended continuum model [@problem_id:3372008]. This process demonstrates how continuum methods can be intelligently adapted to remain useful even at the edge of their traditional validity.", "problem": "Consider plane Poiseuille flow of a dilute gas between two parallel plates separated by a channel height $H$ under a constant streamwise pressure gradient $\\frac{\\partial p}{\\partial x}$. The Computational Fluid Dynamics (CFD) model solves the steady-state, laminar, fully developed flow using the continuum hypothesis and the compressible Navier–Stokes equations specialized to constant properties in the low Mach number limit. At a solid wall, when the gas is rarefied, tangential momentum transfer is not perfectly accommodating; kinetic theory expresses this using the Tangential Momentum Accommodation Coefficient (TMAC), denoted by $\\sigma$, where $0  \\sigma \\le 1$. Molecular Dynamics (MD) can provide reference slip velocities at the wall for nano-scale channels.\n\nStarting from first principles, use only fundamental laws and core definitions:\n- Newton’s law of viscosity, relating shear stress $\\tau$ and strain rate, $\\tau = \\mu \\frac{\\partial u}{\\partial y}$, where $\\mu$ is the dynamic viscosity, $u$ is the streamwise velocity, and $y$ is the wall-normal coordinate.\n- The fully developed plane Poiseuille momentum balance, $\\frac{\\partial \\tau}{\\partial y} = \\frac{\\partial p}{\\partial x}$, with no streamwise acceleration.\n- Kinetic theory for rarefied gas-wall interactions with TMAC $\\sigma$, which implies a linear slip relation proportional to mean free path $\\lambda$ and the wall-normal velocity gradient evaluated at the wall.\n\nTasks:\n1. Derive, from the above base, a rarefied-wall slip boundary condition that relates the wall slip velocity $u_\\mathrm{slip}$ to the wall shear stress $\\tau_w$, the mean free path $\\lambda$, the dynamic viscosity $\\mu$, and the TMAC $\\sigma$. Your derivation must show how $u_\\mathrm{slip}$ depends on $\\lambda$, $\\mu$, and $\\tau_w$, and must identify the appropriate multiplicative factor involving $\\sigma$ implied by kinetic theory.\n2. Using the continuum momentum balance, derive the relation for the wall shear stress in plane Poiseuille flow in terms of the pressure gradient and the channel height $H$.\n3. Solve the steady momentum equation with the slip boundary condition to obtain the volumetric flow rate per unit spanwise width, $Q$, as a function of $H$, $\\mu$, $\\frac{\\partial p}{\\partial x}$, and a slip length $L_s$ that you must identify from your derivation.\n\nAlgorithm and implementation requirements:\n- You must implement a program that, given MD-referenced slip velocities $u_\\mathrm{MD}$ at several values of $\\frac{\\partial p}{\\partial x}$, calibrates $\\sigma$ by least squares. Let $A_i$ denote the product of mean free path to viscosity ratio and wall shear stress for case $i$, that is $A_i = (\\lambda / \\mu)\\,\\tau_{w,i}$, and $u_i$ denote the MD slip velocity for case $i$. Assuming a linear relation between $u_i$ and $A_i$ implied by step (1), perform a linear regression through the origin to estimate a slope parameter, then recover $\\sigma$ from that slope.\n- Assess continuum consistency by comparing the continuum-predicted volumetric flow rate with slip to the MD-referenced volumetric flow rate. Define the mean relative error as the average, over all nonzero-flow experiments in a scenario, of the absolute difference between continuum-predicted and MD-referenced $Q$ divided by the absolute MD-referenced $Q$, expressed as a decimal.\n- Report, for each scenario, the estimated $\\sigma$, the coefficient of determination $R^2$ of the linear fit for $u_\\mathrm{MD}$ versus $A$, the mean relative error in $Q$, and a boolean indicating continuum consistency under the criterion: continuum-consistent is true if and only if the Knudsen number $\\mathrm{Kn} = \\lambda/H$ satisfies $\\mathrm{Kn} \\le 0.1$, the estimated $\\sigma$ lies in $(0,1]$, the linear fit has $R^2 \\ge 0.98$, and the mean relative error in $Q$ is $\\le 0.05$.\n\nUnits and numerical specifications:\n- Use the International System of Units (SI). Dynamic viscosity $\\mu$ in $\\mathrm{Pa\\cdot s}$, mean free path $\\lambda$ in $\\mathrm{m}$, pressure gradient $\\frac{\\partial p}{\\partial x}$ in $\\mathrm{Pa/m}$, channel height $H$ in $\\mathrm{m}$, velocity in $\\mathrm{m/s}$, and volumetric flow per unit spanwise width $Q$ in $\\mathrm{m^2/s}$.\n- Express all angles, if any, in radians. No angles are used in this problem.\n- All error quantities must be decimals, not percentages.\n\nTest suite:\nImplement the following three scenarios. For reproducibility, the MD-referenced slip velocities and volumetric flow rates are to be generated deterministically using the kinetic wall-slip relation implied by task (1) with a scenario-specific ground-truth TMAC, and the volumetric flow relation from task (3). In Scenario $2$, apply an additional multiplicative factor to the MD-referenced volumetric flow to emulate non-continuum effects at moderate rarefaction.\n\n- Scenario $1$ (low rarefaction, happy path):\n  - $\\mu = 1.81 \\times 10^{-5}\\ \\mathrm{Pa\\cdot s}$,\n  - $\\lambda = 6.8 \\times 10^{-8}\\ \\mathrm{m}$,\n  - $H = 1.36 \\times 10^{-6}\\ \\mathrm{m}$,\n  - $\\frac{\\partial p}{\\partial x} \\in \\{-2.0 \\times 10^{6},\\,-1.0 \\times 10^{6},\\,-5.0 \\times 10^{5}\\}\\ \\mathrm{Pa/m}$,\n  - Ground-truth $\\sigma_\\mathrm{MD} = 0.85$,\n  - MD volumetric flow correction factor $g = 1.0$ (no correction).\n- Scenario $2$ (moderate rarefaction, includes a boundary case):\n  - $\\mu = 1.81 \\times 10^{-5}\\ \\mathrm{Pa\\cdot s}$,\n  - $\\lambda = 6.8 \\times 10^{-8}\\ \\mathrm{m}$,\n  - $H = 1.36 \\times 10^{-7}\\ \\mathrm{m}$,\n  - $\\frac{\\partial p}{\\partial x} \\in \\{-2.0 \\times 10^{6},\\,-1.0 \\times 10^{6},\\,0\\}\\ \\mathrm{Pa/m}$,\n  - Ground-truth $\\sigma_\\mathrm{MD} = 0.85$,\n  - MD volumetric flow correction factor $g = 1.10$ (emulates non-continuum deviation).\n- Scenario $3$ (very low slip, edge case with a single data point):\n  - $\\mu = 1.81 \\times 10^{-5}\\ \\mathrm{Pa\\cdot s}$,\n  - $\\lambda = 5.0 \\times 10^{-9}\\ \\mathrm{m}$,\n  - $H = 2.0 \\times 10^{-6}\\ \\mathrm{m}$,\n  - $\\frac{\\partial p}{\\partial x} \\in \\{-1.5 \\times 10^{6}\\}\\ \\mathrm{Pa/m}$,\n  - Ground-truth $\\sigma_\\mathrm{MD} = 0.95$,\n  - MD volumetric flow correction factor $g = 1.0$.\n\nComputational details:\n- For each scenario, compute the wall shear stress using the fully developed plane Poiseuille balance, $\\tau_w = -\\frac{H}{2}\\frac{\\partial p}{\\partial x}$, then construct $A_i = (\\lambda/\\mu)\\,\\tau_{w,i}$ for each pressure gradient case $i$, and compute MD slip velocities $u_{\\mathrm{MD},i}$ using the kinetic, TMAC-dependent slip relation from task (1) with $\\sigma_\\mathrm{MD}$. Compute the MD volumetric flow rates $Q_{\\mathrm{MD},i}$ using the expression from task (3) with the slip length derived in task (1), multiplied by the correction factor $g$ for that scenario.\n- Using the MD slip velocities and the $A_i$, calibrate $\\sigma$ by least squares and compute the coefficient of determination $R^2$ for the regression through the origin.\n- Using the calibrated $\\sigma$, compute the predicted continuum volumetric flow rates $Q_{\\mathrm{pred},i}$, then compute the mean relative error over all cases with $|Q_{\\mathrm{MD},i}| > 0$.\n\nFinal output format:\nYour program should produce a single line of output containing a list of scenario results, where each scenario result is a list of four entries in the order $[\\sigma_\\mathrm{est}, R^2, \\text{mean\\_relative\\_error}, \\text{continuum\\_consistent}]$. The entire output must be a single, comma-separated list enclosed in square brackets, for example, $[[s_1,R^2_1,e_1,b_1],[s_2,R^2_2,e_2,b_2],[s_3,R^2_3,e_3,b_3]]$.", "solution": "The problem statement is assessed to be valid. It is scientifically grounded in the principles of continuum fluid mechanics (Navier-Stokes equations) and kinetic theory of gases (slip boundary conditions). The problem is well-posed, with a clear set of derivations and computational tasks, unambiguous definitions, and a complete set of parameters for the test scenarios. The language used is objective and formal. Therefore, a complete solution is provided below.\n\n### Preamble: Coordinate System and Definitions\nWe analyze plane Poiseuille flow between two parallel plates. We establish a Cartesian coordinate system where $x$ is the streamwise direction and $y$ is the wall-normal direction. The two plates are located at $y = \\pm H/2$, making the channel height $H$. The flow is driven by a constant pressure gradient $\\frac{\\partial p}{\\partial x}$. Due to symmetry, the flow profile $u(y)$ is an even function of $y$, and the shear stress $\\tau(y)$ is an odd function, with $\\tau(y=0)=0$.\n\n### Task 1: Derivation of the Slip Boundary Condition\nThe problem requires deriving a relationship between the slip velocity at the wall, $u_\\mathrm{slip}$, and the wall shear stress, $\\tau_w$, based on kinetic theory principles.\n\n1.  **Kinetic Theory Slip Model**: For a rarefied gas at a solid surface, the slip velocity $u_\\mathrm{slip}$ (the velocity of the gas relative to the wall) is proportional to the mean free path $\\lambda$ and the velocity gradient at the wall $(\\partial u / \\partial y)_w$. The first-order Maxwell-Smoluchowski slip boundary condition is given by:\n    $$u_\\mathrm{slip} = C_s \\lambda \\left| \\left( \\frac{\\partial u}{\\partial y} \\right)_w \\right|$$\n    The slip coefficient, $C_s$, depends on the Tangential Momentum Accommodation Coefficient (TMAC), $\\sigma$. A commonly used model derived from kinetic theory gives this relationship as:\n    $$C_s = \\frac{2-\\sigma}{\\sigma}$$\n    where $0  \\sigma \\le 1$. $\\sigma=1$ corresponds to fully diffuse reflection (perfect accommodation, no slip in the continuum limit), and $\\sigma \\to 0$ corresponds to fully specular reflection (maximum slip).\n\n2.  **Introducing Shear Stress**: Newton's law of viscosity states that the shear stress $\\tau$ is related to the strain rate $\\frac{\\partial u}{\\partial y}$ by:\n    $$\\tau = \\mu \\frac{\\partial u}{\\partial y}$$\n    where $\\mu$ is the dynamic viscosity. At the wall ($w$), the wall shear stress is $\\tau_w = \\mu (\\partial u / \\partial y)_w$. We consider the magnitude, $|\\tau_w| = \\mu |(\\partial u / \\partial y)_w|$, which allows us to express the velocity gradient in terms of shear stress:\n    $$\\left| \\left( \\frac{\\partial u}{\\partial y} \\right)_w \\right| = \\frac{|\\tau_w|}{\\mu}$$\n\n3.  **Final Slip Relation**: Substituting the expressions for $C_s$ and the velocity gradient into the slip velocity equation yields:\n    $$u_\\mathrm{slip} = \\left(\\frac{2-\\sigma}{\\sigma}\\right) \\lambda \\frac{|\\tau_w|}{\\mu} = \\left(\\frac{2-\\sigma}{\\sigma}\\right) \\frac{\\lambda}{\\mu} |\\tau_w|$$\n    This is the required relationship. The slip velocity $u_\\mathrm{slip}$ is linearly proportional to the wall shear stress magnitude $|\\tau_w|$ and the ratio of mean free path to viscosity, $\\lambda/\\mu$. The multiplicative factor involving $\\sigma$ is $(2-\\sigma)/\\sigma$. This equation forms the basis for the linear regression specified in the problem, where $u_i = (\\frac{2-\\sigma}{\\sigma}) A_i$ with $A_i = (\\lambda/\\mu)|\\tau_{w,i}|$.\n\n### Task 2: Wall Shear Stress in Plane Poiseuille Flow\nThe momentum equation for steady, fully developed, laminar flow in the $x$-direction simplifies to a balance between pressure forces and viscous forces:\n$$\\frac{\\partial p}{\\partial x} = \\frac{\\partial \\tau}{\\partial y}$$\nSince $\\frac{\\partial p}{\\partial x}$ is a constant, we can integrate with respect to $y$:\n$$\\tau(y) = y \\frac{\\partial p}{\\partial x} + C_1$$\nDue to the symmetry of the flow profile about the channel centerline ($y=0$), the velocity gradient must be zero at the centerline, which implies the shear stress is also zero: $\\tau(0)=0$. Applying this condition gives $C_1=0$. Thus, the shear stress profile is linear:\n$$\\tau(y) = y \\frac{\\partial p}{\\partial x}$$\nThe wall shear stress, $\\tau_w$, is the stress at either wall, e.g., at $y = -H/2$ or $y = H/2$. The magnitude of the wall shear stress is:\n$$|\\tau_w| = |\\tau(\\pm H/2)| = \\left| \\pm \\frac{H}{2} \\frac{\\partial p}{\\partial x} \\right| = \\frac{H}{2} \\left| \\frac{\\partial p}{\\partial x} \\right|$$\nFor flow in the positive $x$-direction, $\\frac{\\partial p}{\\partial x}  0$, so we can write $|\\tau_w| = -\\frac{H}{2} \\frac{\\partial p}{\\partial x}$, which matches the expression provided in the problem statement.\n\n### Task 3: Volumetric Flow Rate with Slip\nTo find the volumetric flow rate $Q$, we must first determine the velocity profile $u(y)$.\n\n1.  **Velocity Profile**: We start from the shear stress profile $\\tau(y) = y \\frac{\\partial p}{\\partial x}$ and use Newton's law of viscosity $\\tau = \\mu \\frac{\\partial u}{\\partial y}$:\n    $$\\mu \\frac{\\partial u}{\\partial y} = y \\frac{\\partial p}{\\partial x}$$\n    Integrating with respect to $y$ gives:\n    $$u(y) = \\frac{1}{2\\mu} \\frac{\\partial p}{\\partial x} y^2 + C_2$$\n    We apply the slip boundary condition at the wall, say at $y=H/2$, where the velocity is $u(H/2) = u_\\mathrm{slip}$.\n    $$u_\\mathrm{slip} = \\frac{1}{2\\mu} \\frac{\\partial p}{\\partial x} \\left(\\frac{H}{2}\\right)^2 + C_2$$\n    Solving for the integration constant $C_2$:\n    $$C_2 = u_\\mathrm{slip} - \\frac{H^2}{8\\mu} \\frac{\\partial p}{\\partial x}$$\n    Substituting $C_2$ back into the velocity profile equation:\n    $$u(y) = \\frac{1}{2\\mu} \\frac{\\partial p}{\\partial x} y^2 + u_\\mathrm{slip} - \\frac{1}{8\\mu} \\frac{\\partial p}{\\partial x} H^2 = \\frac{1}{2\\mu} \\frac{\\partial p}{\\partial x} \\left( y^2 - \\left(\\frac{H}{2}\\right)^2 \\right) + u_\\mathrm{slip}$$\n\n2.  ** Slip Length Identification**: The problem defines a slip length, $L_s$. The general definition is $u_\\mathrm{slip} = L_s |(\\partial u / \\partial y)_w|$. The velocity gradient at the wall $y=H/2$ is:\n    $$\\left(\\frac{\\partial u}{\\partial y}\\right)_{y=H/2} = \\left(\\frac{1}{\\mu} \\frac{\\partial p}{\\partial x} y\\right)_{y=H/2} = \\frac{H}{2\\mu} \\frac{\\partial p}{\\partial x}$$\n    From Task 1, we have $u_\\mathrm{slip} = (\\frac{2-\\sigma}{\\sigma}) \\lambda \\frac{|\\tau_w|}{\\mu}$. And from Task 2, $|\\tau_w| = \\frac{H}{2} |\\frac{\\partial p}{\\partial x}|$.\n    And $|(\\partial u / \\partial y)_w| = \\frac{|\\tau_w|}{\\mu}$. So,\n    $$u_\\mathrm{slip} = \\left(\\frac{2-\\sigma}{\\sigma}\\right) \\lambda \\left| \\left(\\frac{\\partial u}{\\partial y}\\right)_w \\right|$$\n    Comparing this with $u_\\mathrm{slip} = L_s |(\\partial u / \\partial y)_w|$, we identify the slip length as:\n    $$L_s = \\lambda \\left(\\frac{2-\\sigma}{\\sigma}\\right)$$\n\n3.  **Volumetric Flow Rate**: The volumetric flow rate per unit spanwise width, $Q$, is the integral of the velocity profile across the channel height:\n    $$Q = \\int_{-H/2}^{H/2} u(y) \\,dy = \\int_{-H/2}^{H/2} \\left[ \\frac{1}{2\\mu} \\frac{\\partial p}{\\partial x} \\left( y^2 - \\frac{H^2}{4} \\right) + u_\\mathrm{slip} \\right] dy$$\n    The integral is composed of two parts:\n    $$Q = \\frac{1}{2\\mu} \\frac{\\partial p}{\\partial x} \\int_{-H/2}^{H/2} \\left( y^2 - \\frac{H^2}{4} \\right) dy + \\int_{-H/2}^{H/2} u_\\mathrm{slip} \\,dy$$\n    The first integral evaluates to:\n    $$\\left[ \\frac{y^3}{3} - \\frac{H^2}{4}y \\right]_{-H/2}^{H/2} = \\left(\\frac{H^3}{24} - \\frac{H^3}{8}\\right) - \\left(-\\frac{H^3}{24} + \\frac{H^3}{8}\\right) = 2\\left(-\\frac{2H^3}{24}\\right) = -\\frac{H^3}{6}$$\n    The second integral gives $u_\\mathrm{slip} \\cdot H$. So, the flow rate is:\n    $$Q = \\frac{1}{2\\mu} \\frac{\\partial p}{\\partial x} \\left(-\\frac{H^3}{6}\\right) + u_\\mathrm{slip} H = -\\frac{H^3}{12\\mu} \\frac{\\partial p}{\\partial x} + u_\\mathrm{slip} H$$\n    The first term is the classical Poiseuille flow rate (no-slip). The second term is the contribution from slip. We can express $u_\\mathrm{slip}$ in terms of the pressure gradient:\n    $$u_\\mathrm{slip} = L_s \\left| \\left(\\frac{\\partial u}{\\partial y}\\right)_w \\right| = L_s \\frac{H}{2\\mu} \\left|\\frac{\\partial p}{\\partial x}\\right| = -L_s \\frac{H}{2\\mu} \\frac{\\partial p}{\\partial x}$$\n    Substituting this into the expression for $Q$:\n    $$Q = -\\frac{H^3}{12\\mu} \\frac{\\partial p}{\\partial x} + \\left(-L_s \\frac{H}{2\\mu} \\frac{\\partial p}{\\partial x}\\right) H = -\\frac{H^3}{12\\mu} \\frac{\\partial p}{\\partial x} - \\frac{L_s H^2}{2\\mu} \\frac{\\partial p}{\\partial x}$$\n    Factoring out the no-slip term gives the final expression:\n    $$Q = -\\frac{H^3}{12\\mu} \\frac{\\partial p}{\\partial x} \\left( 1 + \\frac{6L_s}{H} \\right)$$\n    This is the volumetric flow rate as a function of $H$, $\\mu$, $\\frac{\\partial p}{\\partial x}$, and the slip length $L_s$.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the fluid dynamics problem for three scenarios, calibrating TMAC,\n    and assessing continuum model consistency.\n    \"\"\"\n\n    scenarios = [\n        {\n            \"mu\": 1.81e-5, \"lambda\": 6.8e-8, \"H\": 1.36e-6,\n            \"dpdx_values\": np.array([-2.0e6, -1.0e6, -5.0e5]),\n            \"sigma_md\": 0.85, \"g\": 1.0\n        },\n        {\n            \"mu\": 1.81e-5, \"lambda\": 6.8e-8, \"H\": 1.36e-7,\n            \"dpdx_values\": np.array([-2.0e6, -1.0e6, 0.0]),\n            \"sigma_md\": 0.85, \"g\": 1.10\n        },\n        {\n            \"mu\": 1.81e-5, \"lambda\": 5.0e-9, \"H\": 2.0e-6,\n            \"dpdx_values\": np.array([-1.5e6]),\n            \"sigma_md\": 0.95, \"g\": 1.0\n        }\n    ]\n\n    all_results = []\n\n    for scenario in scenarios:\n        mu = scenario[\"mu\"]\n        lambda_ = scenario[\"lambda\"]\n        H = scenario[\"H\"]\n        dpdx_values = scenario[\"dpdx_values\"]\n        sigma_md = scenario[\"sigma_md\"]\n        g = scenario[\"g\"]\n\n        # Generate MD-referenced data\n        tau_w_values = - (H / 2.0) * dpdx_values\n        A_values = (lambda_ / mu) * tau_w_values\n        \n        # From Task 1: u_slip = ((2-sigma)/sigma) * (lambda/mu) * tau_w\n        slip_coeff_md = (2.0 - sigma_md) / sigma_md\n        u_md_values = slip_coeff_md * A_values\n\n        # From Task 3: Q = -H^3/(12*mu) * dpdx * (1 + 6*Ls/H)\n        # where Ls = lambda * (2-sigma)/sigma\n        Ls_md = lambda_ * slip_coeff_md\n        Q_cont_md = - (H**3 / (12.0 * mu)) * dpdx_values * (1.0 + 6.0 * Ls_md / H)\n        Q_md_values = g * Q_cont_md\n\n        # --- Calibration ---\n        # Model u = C * A, where C = (2-sigma)/sigma\n        # Least squares for regression through the origin: C_est = sum(A*u) / sum(A^2)\n        sum_A_sq = np.sum(A_values**2)\n        if sum_A_sq  1e-30: # Avoid division by zero if all dpdx are zero\n            # This case means no flow, sigma is indeterminate.\n            # As per problem constraints, at least one point is non-zero.\n            # If all are zero, C_est is ill-defined. We could set to 0.\n            # Based on the test cases, this path won't be taken.\n            C_est = 0.0 \n        else:\n            C_est = np.sum(A_values * u_md_values) / sum_A_sq\n        \n        # Recover sigma from C_est\n        # C = 2/sigma - 1  => sigma = 2 / (C + 1)\n        if C_est  -1.0: # Avoid division by zero or negative sigma\n            sigma_est = np.nan\n        else:\n            sigma_est = 2.0 / (C_est + 1.0) if C_est + 1.0 > 1e-9 else np.inf\n\n        # --- Coefficient of Determination R^2 ---\n        # For regression through the origin, R^2 = 1 - SS_res / SS_tot\n        # where SS_tot is often sum(y_i^2)\n        u_pred_values = C_est * A_values\n        ss_res = np.sum((u_md_values - u_pred_values)**2)\n        ss_tot = np.sum(u_md_values**2)\n        \n        if ss_tot  1e-30:\n            # If all u_md are zero, fit is perfect if ss_res is also zero.\n            r_squared = 1.0 if ss_res  1e-30 else 0.0\n        else:\n            r_squared = 1.0 - ss_res / ss_tot\n\n        # --- Continuum Consistency Assessment ---\n        # 1. Knudsen number\n        Kn = lambda_ / H\n        \n        # 2. Predicted Q from continuum model with calibrated sigma\n        slip_coeff_est = (2.0 - sigma_est) / sigma_est\n        Ls_est = lambda_ * slip_coeff_est\n        Q_pred_values = - (H**3 / (12.0 * mu)) * dpdx_values * (1.0 + 6.0 * Ls_est / H)\n\n        # 3. Mean relative error in Q\n        # Exclude cases where MD flow is zero\n        nonzero_q_mask = np.abs(Q_md_values) > 1e-15\n        if np.any(nonzero_q_mask):\n            rel_errors = np.abs(Q_pred_values[nonzero_q_mask] - Q_md_values[nonzero_q_mask]) / np.abs(Q_md_values[nonzero_q_mask])\n            mean_rel_error = np.mean(rel_errors)\n        else:\n            mean_rel_error = 0.0\n\n        # 4. Consistency check\n        is_consistent = (\n            Kn = 0.1 and\n            0  sigma_est = 1 and\n            r_squared >= 0.98 and\n            mean_rel_error = 0.05\n        )\n\n        all_results.append([sigma_est, r_squared, mean_rel_error, bool(is_consistent)])\n    \n    # Format the final output string\n    formatted_results = []\n    for res in all_results:\n        # Format: [sigma, r2, error, is_consistent]\n        # str(bool) produces 'True' or 'False' which is fine\n        formatted_results.append(f\"[{res[0]},{res[1]},{res[2]},{res[3]}]\")\n    \n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "3372008"}]}