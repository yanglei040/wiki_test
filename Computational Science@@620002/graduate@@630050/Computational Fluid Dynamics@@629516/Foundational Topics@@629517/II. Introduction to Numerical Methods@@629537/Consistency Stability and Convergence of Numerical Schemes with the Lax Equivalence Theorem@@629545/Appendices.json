{"hands_on_practices": [{"introduction": "This practice explores the fundamental interplay between a scheme's formulation and its stability. You will analyze the simple forward-time, centered-space (FTCS) scheme for advection, which is notoriously unstable, and use the modified equation to understand this instability as a form of negative, or anti-, diffusion. This exercise provides a concrete example of how adding a carefully calibrated artificial viscosity term can not only stabilize the scheme but also recover a higher order of accuracy, demonstrating a core technique in the design of robust numerical methods [@problem_id:3304527].", "problem": "Consider the one-dimensional linear advection equation $u_{t} + a\\,u_{x} = 0$ for a constant advection speed $a \\in \\mathbb{R}$, posed on a periodic domain. A grid with spacing $\\Delta x$ and a time step $\\Delta t$ is used. The numerical scheme advances $u$ via a forward-Euler time discretization, a second-order central difference for the advective derivative, and a standard second-order central difference for an added artificial viscosity term:\n$$\nu_{j}^{n+1}\n=\nu_{j}^{n}\n-\n\\frac{a\\,\\Delta t}{2\\,\\Delta x}\\left(u_{j+1}^{n}-u_{j-1}^{n}\\right)\n+\n\\frac{\\nu\\,\\Delta t}{\\Delta x^{2}}\\left(u_{j+1}^{n}-2\\,u_{j}^{n}+u_{j-1}^{n}\\right),\n$$\nwhere $\\nu \\ge 0$ is the (constant) artificial viscosity coefficient. Let the Courant–Friedrichs–Lewy (CFL) number be $c = a\\,\\Delta t/\\Delta x$, and assume $|c| \\le 1$.\n\nUsing the modified equation viewpoint grounded in Taylor expansion and the original partial differential equation, explain mechanistically why the unmodified central scheme (with $\\nu=0$) is nominally unstable and how adding artificial viscosity can counteract that instability while preserving consistency. Then, perform a Fourier (von Neumann) stability analysis of the above discrete scheme to obtain the amplification factor $G(k)$ for a Fourier mode of wavenumber $k$, and impose the requirement $|G(k)| \\le 1$ for all wavenumbers.\n\nDetermine, in closed form, the smallest value of the artificial viscosity coefficient $\\nu_{\\text{min}}$ as a function of $a$, $\\Delta t$, and $\\Delta x$ that ensures $|G(k)| \\le 1$ for all wavenumbers when $|c| \\le 1$. Express your final answer as an analytic expression. No rounding is required, and no units should be included in the final expression.", "solution": "The problem posed is a standard exercise in the analysis of finite difference schemes for hyperbolic partial differential equations. The validation process confirms that the problem is scientifically grounded, well-posed, and objective. All necessary parameters and definitions are provided, and no contradictions are present. The problem is a formal and solvable question within computational fluid dynamics. Therefore, we proceed with a full solution.\n\nThe analysis is structured into two main parts as requested. First, we use the modified equation approach to provide a mechanistic explanation for the instability of the unmodified central difference scheme and the stabilizing effect of artificial viscosity. Second, we perform a formal Fourier (von Neumann) stability analysis to derive the precise condition on the artificial viscosity coefficient.\n\n### Part 1: Modified Equation Analysis and Consistency\n\nThe numerical scheme is given by:\n$$\nu_{j}^{n+1}\n=\nu_{j}^{n}\n-\n\\frac{a\\,\\Delta t}{2\\,\\Delta x}\\left(u_{j+1}^{n}-u_{j-1}^{n}\\right)\n+\n\\frac{\\nu\\,\\Delta t}{\\Delta x^{2}}\\left(u_{j+1}^{n}-2\\,u_{j}^{n}+u_{j-1}^{n}\\right)\n$$\nTo derive the modified partial differential equation that this scheme actually solves, we perform a Taylor series expansion of each term around the point $(x_j, t_n)$, where $x_j=j\\Delta x$ and $t_n=n\\Delta t$. We denote the exact solution at this point as $u$.\n\\begin{align*} u_{j}^{n+1} &= u + \\Delta t u_t + \\frac{(\\Delta t)^2}{2} u_{tt} + O((\\Delta t)^3) \\\\ u_{j\\pm 1}^{n} &= u \\pm \\Delta x u_x + \\frac{(\\Delta x)^2}{2} u_{xx} \\pm \\frac{(\\Delta x)^3}{6} u_{xxx} + O((\\Delta x)^4) \\end{align*}\nSubstituting these into the scheme, which can be rearranged as:\n$$\n\\frac{u_{j}^{n+1} - u_{j}^{n}}{\\Delta t}\n=\n-a \\frac{u_{j+1}^{n}-u_{j-1}^{n}}{2\\,\\Delta x}\n+\n\\nu \\frac{u_{j+1}^{n}-2\\,u_{j}^{n}+u_{j-1}^{n}}{\\Delta x^{2}}\n$$\nWe obtain:\n$$\nu_t + \\frac{\\Delta t}{2} u_{tt} + \\dots = -a \\left( u_x + \\frac{(\\Delta x)^2}{6} u_{xxx} + \\dots \\right) + \\nu \\left( u_{xx} + \\frac{(\\Delta x)^2}{12} u_{xxxx} + \\dots \\right)\n$$\nRearranging to match the form of the original PDE, $u_t + a u_x = 0$, gives the truncated PDE:\n$$\nu_t + a u_x = \\nu u_{xx} - \\frac{\\Delta t}{2} u_{tt} - a \\frac{(\\Delta x)^2}{6} u_{xxx} + \\dots\n$$\nTo obtain the modified equation, we must express time derivatives on the right-hand side in terms of spatial derivatives. To the lowest order, the scheme approximates $u_t \\approx -a u_x$. Differentiating with respect to time gives $u_{tt} \\approx -a u_{xt} = -a \\frac{\\partial}{\\partial x}(u_t) \\approx -a \\frac{\\partial}{\\partial x}(-a u_x) = a^2 u_{xx}$. Substituting this back into the equation yields:\n$$\nu_t + a u_x = \\nu u_{xx} - \\frac{\\Delta t}{2} (a^2 u_{xx}) - a \\frac{(\\Delta x)^2}{6} u_{xxx} + \\dots\n$$\n$$\nu_t + a u_x = \\left( \\nu - \\frac{a^2 \\Delta t}{2} \\right) u_{xx} - a \\frac{(\\Delta x)^2}{6} u_{xxx} + \\dots\n$$\nThis is the modified equation. The leading-order error term is a second-derivative (diffusion) term with an effective diffusion coefficient $\\nu_{\\text{eff}} = \\nu - \\frac{a^2 \\Delta t}{2}$.\n\n**Instability of the Unmodified Scheme ($\\nu = 0$):**\nWhen $\\nu=0$, the modified equation is $u_t + a u_x = -\\frac{a^2 \\Delta t}{2} u_{xx} + \\dots$. This is an advection-diffusion equation with a negative diffusion coefficient. A negative diffusion coefficient causes high-frequency components of the solution to be amplified exponentially, making the numerical scheme unconditionally unstable. This is analogous to solving the heat equation backwards in time.\n\n**Stabilization with Artificial Viscosity ($\\nu > 0$):**\nThe addition of the artificial viscosity term, with coefficient $\\nu$, introduces a positive diffusion term $\\nu u_{xx}$ into the modified equation. This term counteracts the negative numerical diffusion inherent in the central difference scheme. For the scheme to be stable, the effective diffusion coefficient must be non-negative, $\\nu_{\\text{eff}} \\ge 0$. This requires $\\nu - \\frac{a^2 \\Delta t}{2} \\ge 0$, or $\\nu \\ge \\frac{a^2 \\Delta t}{2}$.\n\n**Preservation of Consistency:**\nA scheme is consistent with a PDE if its truncation error vanishes as $\\Delta t \\to 0$ and $\\Delta x \\to 0$. The truncation error includes the term $\\nu u_{xx}$. If $\\nu$ were a fixed constant, the scheme would be consistent with the advection-diffusion equation $u_t + a u_x = \\nu u_{xx}$, not the original advection equation. However, the artificial viscosity $\\nu$ is typically chosen as a function of the grid parameters. As we will show, the minimal viscosity for stability is $\\nu_{min} = \\frac{a^2 \\Delta t}{2}$. With this choice, the coefficient of the added term in the scheme, $\\frac{\\nu \\Delta t}{(\\Delta x)^2}$, becomes $\\frac{(a^2 \\Delta t/2) \\Delta t}{(\\Delta x)^2} = \\frac{1}{2} (\\frac{a \\Delta t}{\\Delta x})^2 = \\frac{c^2}{2}$. This term does not necessarily vanish in the limit where $c$ is held constant. However, with this choice of $\\nu$, the leading error term $(\\nu - \\frac{a^2 \\Delta t}{2}) u_{xx}$ in the modified equation vanishes exactly. The scheme becomes the Lax-Wendroff scheme, which is known to be consistent with the original PDE $u_t + a u_x = 0$ and is second-order accurate. Thus, adding the precisely correct amount of artificial viscosity not only stabilizes the scheme but also improves its accuracy and preserves consistency with the target PDE.\n\n### Part 2: Fourier (von Neumann) Stability Analysis\n\nWe analyze the stability of the scheme by considering a single Fourier mode of the solution:\n$$\nu_j^n = G^n(k) e^{i k x_j}\n$$\nwhere $k$ is the wavenumber, $x_j = j\\Delta x$, $i = \\sqrt{-1}$, and $G(k)$ is the amplification factor per time step. Substituting this ansatz into the numerical scheme gives:\n$$\nG(k) e^{i k j \\Delta x} = e^{i k j \\Delta x} - \\frac{a \\Delta t}{2 \\Delta x} (e^{i k (j+1) \\Delta x} - e^{i k (j-1) \\Delta x}) + \\frac{\\nu \\Delta t}{(\\Delta x)^2} (e^{i k (j+1) \\Delta x} - 2e^{i k j \\Delta x} + e^{i k (j-1) \\Delta x})\n$$\nDividing by $e^{i k j \\Delta x}$ and simplifying:\n$$\nG(k) = 1 - \\frac{a \\Delta t}{2 \\Delta x} (e^{i k \\Delta x} - e^{-i k \\Delta x}) + \\frac{\\nu \\Delta t}{(\\Delta x)^2} (e^{i k \\Delta x} - 2 + e^{-i k \\Delta x})\n$$\nLet $\\theta = k \\Delta x$ be the phase shift per grid cell. Using the identities $e^{i\\theta} - e^{-i\\theta} = 2i\\sin(\\theta)$ and $e^{i\\theta} + e^{-i\\theta} - 2 = 2\\cos(\\theta) - 2 = -4\\sin^2(\\theta/2)$, and defining the CFL number $c = \\frac{a \\Delta t}{\\Delta x}$ and the diffusion number $d = \\frac{\\nu \\Delta t}{(\\Delta x)^2}$, we obtain the amplification factor:\n$$\nG(\\theta) = 1 - \\frac{c}{2}(2i \\sin\\theta) + d(-4\\sin^2(\\theta/2)) = \\left(1 - 4d \\sin^2(\\frac{\\theta}{2})\\right) - i c \\sin\\theta\n$$\nFor the scheme to be stable, the magnitude of the amplification factor must be no greater than $1$ for all possible wavenumbers, i.e., for all $\\theta \\in [-\\pi, \\pi]$.\n$$\n|G(\\theta)|^2 \\le 1^2\n$$\n$$\n\\left(1 - 4d \\sin^2(\\frac{\\theta}{2})\\right)^2 + (-c \\sin\\theta)^2 \\le 1\n$$\nUsing the identity $\\sin\\theta = 2\\sin(\\theta/2)\\cos(\\theta/2)$, this becomes:\n$$\n1 - 8d \\sin^2(\\frac{\\theta}{2}) + 16d^2 \\sin^4(\\frac{\\theta}{2}) + 4c^2 \\sin^2(\\frac{\\theta}{2})\\cos^2(\\frac{\\theta}{2}) \\le 1\n$$\nLet $S = \\sin^2(\\theta/2)$. For $\\theta \\in [-\\pi, \\pi]$, we have $S \\in [0, 1]$. Using $\\cos^2(\\theta/2) = 1-S$, the inequality simplifies to:\n$$\n-8d S + 16d^2 S^2 + 4c^2 S (1 - S) \\le 0\n$$\nFor $S > 0$, we can divide by $S$:\n$$\n-8d + 16d^2 S + 4c^2(1-S) \\le 0\n$$\n$$\nS(16d^2 - 4c^2) + (4c^2 - 8d) \\le 0\n$$\nThis inequality is linear in $S$ and must hold for all $S \\in [0, 1]$. This is guaranteed if the inequality holds at the endpoints of the interval, $S=0$ and $S=1$.\nAt $S=0$:\n$$ 4c^2 - 8d \\le 0 \\implies d \\ge \\frac{c^2}{2} $$\nAt $S=1$:\n$$ (16d^2 - 4c^2) + (4c^2 - 8d) \\le 0 \\implies 16d^2 - 8d \\le 0 \\implies 8d(2d-1) \\le 0 $$\nSince $d = \\frac{\\nu \\Delta t}{(\\Delta x)^2} \\ge 0$, this simplifies to $2d-1 \\le 0$, which means $d \\le \\frac{1}{2}$.\n\nCombining these two conditions, the stability requirement is $\\frac{c^2}{2} \\le d \\le \\frac{1}{2}$. The problem specifies that $|c| \\le 1$, which ensures that $\\frac{c^2}{2} \\le \\frac{1}{2}$, so a value of $d$ satisfying both conditions exists.\n\n### Part 3: Determination of the Minimum Artificial Viscosity\n\nWe seek the smallest value of the artificial viscosity coefficient, $\\nu_{\\text{min}}$, that ensures stability. This corresponds to the smallest possible value for the diffusion number, $d$. From the stability condition $d \\ge \\frac{c^2}{2}$, the minimum required value is:\n$$\nd_{\\text{min}} = \\frac{c^2}{2}\n$$\nSubstituting back the definitions of $d$ and $c$:\n$$\n\\frac{\\nu_{\\text{min}} \\Delta t}{(\\Delta x)^2} = \\frac{1}{2} \\left( \\frac{a \\Delta t}{\\Delta x} \\right)^2 = \\frac{a^2 (\\Delta t)^2}{2 (\\Delta x)^2}\n$$\nSolving for $\\nu_{\\text{min}}$ by multiplying by $\\frac{(\\Delta x)^2}{\\Delta t}$ (assuming $\\Delta t > 0$):\n$$\n\\nu_{\\text{min}} = \\frac{a^2 \\Delta t}{2}\n$$\nThis is the minimum artificial viscosity coefficient required to ensure stability for all wavenumbers, given the constraint $|c| \\le 1$. This result from the rigorous von Neumann analysis precisely matches the value inferred from the modified equation analysis needed to cancel the negative numerical diffusion.", "answer": "$$\n\\boxed{\\frac{a^{2} \\Delta t}{2}}\n$$", "id": "3304527"}, {"introduction": "Moving beyond two-level schemes, this problem examines the popular three-level leapfrog method, known for its second-order accuracy and non-dissipative nature. The von Neumann analysis reveals a crucial feature of multi-level schemes: the existence of multiple amplification factors, leading to both a physical mode and a parasitic computational mode. By characterizing these modes, you will understand how a scheme can be formally stable yet still produce spurious oscillations, highlighting the need for careful initialization and potential filtering in practical applications [@problem_id:3304581].", "problem": "Consider the linear advection Partial Differential Equation (PDE) $u_{t} + a\\,u_{x} = 0$ with constant wave speed $a \\in \\mathbb{R}$ on a uniform spatial grid of spacing $\\Delta x$ and a uniform time step $\\Delta t$. Let $u_{j}^{n}$ denote the grid function at spatial node $x_{j} = j\\,\\Delta x$ and time level $t_{n} = n\\,\\Delta t$. The leapfrog finite-difference scheme is defined by\n$$\nu_{j}^{n+1} = u_{j}^{n-1} - \\nu \\left(u_{j+1}^{n} - u_{j-1}^{n}\\right),\n$$\nwhere the Courant–Friedrichs–Lewy (CFL) number is $\\nu = \\dfrac{a\\,\\Delta t}{\\Delta x}$. Assume periodic boundary conditions and sufficiently smooth initial data so that a Fourier-mode analysis is admissible.\n\nUsing the method of Fourier (Von Neumann) stability analysis, postulate a single Fourier mode $u_{j}^{n} = \\hat{u}^{n}\\,\\exp\\!\\left(i\\,k\\,x_{j}\\right)$, where $k \\in \\mathbb{R}$ is the spatial wave number and $i$ is the imaginary unit. Derive the amplification factor(s) $G(k)$ defined by $\\hat{u}^{n+1} = G(k)\\,\\hat{u}^{n}$ for the leapfrog scheme. Identify and characterize any parasitic computational mode(s), and determine their impact on stability in the sense of boundedness of $\\hat{u}^{n}$ for all $n \\in \\mathbb{Z}$ and on convergence by invoking the Lax equivalence theorem. In your reasoning, start from the PDE and the scheme definitions, and proceed by logically deriving the amplification factor(s) and their magnitude.\n\nExpress your final answer as the closed-form pair of amplification factors $G_{\\pm}(k)$ in terms of $k$, $\\nu$, and $\\Delta x$. Use radians for all trigonometric functions. No numerical rounding is required, and no physical units should appear in the final expression.", "solution": "The problem as stated is scientifically sound, self-contained, and well-posed. It presents a standard task in the analysis of numerical methods for partial differential equations (PDEs), specifically the application of Fourier (Von Neumann) stability analysis to the leapfrog scheme for the linear advection equation. All terms are clearly defined, and the objectives are unambiguous. Therefore, a solution can be derived.\n\nThe governing linear advection PDE is given by:\n$$\nu_{t} + a\\,u_{x} = 0\n$$\nwhere $u(x,t)$ is the transported quantity, $a \\in \\mathbb{R}$ is the constant wave speed, and the subscripts denote partial differentiation. The leapfrog finite-difference scheme discretizes this PDE on a uniform grid with spacing $\\Delta x$ and time step $\\Delta t$:\n$$\n\\frac{u_{j}^{n+1} - u_{j}^{n-1}}{2\\Delta t} + a \\frac{u_{j+1}^{n} - u_{j-1}^{n}}{2\\Delta x} = 0\n$$\nRearranging this gives the computational stencil provided in the problem statement:\n$$\nu_{j}^{n+1} = u_{j}^{n-1} - \\frac{a\\,\\Delta t}{\\Delta x} \\left(u_{j+1}^{n} - u_{j-1}^{n}\\right)\n$$\nIntroducing the Courant–Friedrichs–Lewy (CFL) number $\\nu = \\frac{a\\,\\Delta t}{\\Delta x}$, the scheme is:\n$$\nu_{j}^{n+1} = u_{j}^{n-1} - \\nu \\left(u_{j+1}^{n} - u_{j-1}^{n}\\right)\n$$\nTo perform the Von Neumann stability analysis, we substitute a single Fourier mode, $u_{j}^{n} = \\hat{u}^{n}\\,\\exp\\!\\left(i\\,k\\,x_{j}\\right)$, into the scheme. Here, $k$ is the wave number, $i = \\sqrt{-1}$, and $x_{j} = j\\,\\Delta x$. The spatial dependence of the neighboring points can be expressed relative to the central point $j$ as:\n$$\nu_{j+1}^{n} = \\hat{u}^{n}\\,\\exp\\!\\left(i\\,k\\,(j+1)\\Delta x\\right) = \\hat{u}^{n}\\,\\exp\\!\\left(i\\,k\\,j\\Delta x\\right)\\exp\\!\\left(i\\,k\\,\\Delta x\\right)\n$$\n$$\nu_{j-1}^{n} = \\hat{u}^{n}\\,\\exp\\!\\left(i\\,k\\,(j-1)\\Delta x\\right) = \\hat{u}^{n}\\,\\exp\\!\\left(i\\,k\\,j\\Delta x\\right)\\exp\\!\\left(-i\\,k\\,\\Delta x\\right)\n$$\nSubstituting these expressions and $u_{j}^{n+1}$ and $u_{j}^{n-1}$ into the leapfrog scheme equation yields:\n$$\n\\hat{u}^{n+1}\\,\\exp\\!\\left(i\\,k\\,j\\Delta x\\right) = \\hat{u}^{n-1}\\,\\exp\\!\\left(i\\,k\\,j\\Delta x\\right) - \\nu \\left(\\hat{u}^{n}\\,\\exp\\!\\left(i\\,k\\,j\\Delta x\\right)\\exp\\!\\left(i\\,k\\,\\Delta x\\right) - \\hat{u}^{n}\\,\\exp\\!\\left(i\\,k\\,j\\Delta x\\right)\\exp\\!\\left(-i\\,k\\,\\Delta x\\right)\\right)\n$$\nDividing by the common factor $\\exp(i\\,k\\,j\\Delta x)$, we obtain a linear, homogeneous, second-order difference equation for the amplitude $\\hat{u}^{n}$:\n$$\n\\hat{u}^{n+1} = \\hat{u}^{n-1} - \\nu \\hat{u}^{n} \\left(\\exp\\!\\left(i\\,k\\,\\Delta x\\right) - \\exp\\!\\left(-i\\,k\\,\\Delta x\\right)\\right)\n$$\nUsing Euler's identity, $\\exp(i\\theta) - \\exp(-i\\theta) = 2i\\sin(\\theta)$, the term in the parenthesis becomes $2i\\sin(k\\,\\Delta x)$. The equation for the amplitude is now:\n$$\n\\hat{u}^{n+1} = \\hat{u}^{n-1} - 2i\\nu\\sin(k\\,\\Delta x)\\,\\hat{u}^{n}\n$$\n$$\n\\hat{u}^{n+1} + 2i\\nu\\sin(k\\,\\Delta x)\\,\\hat{u}^{n} - \\hat{u}^{n-1} = 0\n$$\nThe problem defines the amplification factor $G(k)$ by the relation $\\hat{u}^{n+1} = G(k)\\,\\hat{u}^{n}$, which implies $\\hat{u}^{n} = G(k)\\,\\hat{u}^{n-1}$, and thus $\\hat{u}^{n} = (G(k))^{n}\\hat{u}^{0}$. Substituting this geometric progression form into the difference equation gives the characteristic equation for $G \\equiv G(k)$:\n$$\nG^{n+1} + 2i\\nu\\sin(k\\,\\Delta x)\\,G^{n} - G^{n-1} = 0\n$$\nDividing by $G^{n-1}$ (assuming $G \\neq 0$), we arrive at a quadratic equation for the amplification factor $G$:\n$$\nG^{2} + \\left(2i\\nu\\sin(k\\,\\Delta x)\\right)G - 1 = 0\n$$\nWe solve for $G$ using the quadratic formula, $G = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$, with coefficients $a=1$, $b=2i\\nu\\sin(k\\,\\Delta x)$, and $c=-1$.\n$$\nG_{\\pm} = \\frac{-2i\\nu\\sin(k\\,\\Delta x) \\pm \\sqrt{\\left(2i\\nu\\sin(k\\,\\Delta x)\\right)^{2} - 4(1)(-1)}}{2}\n$$\n$$\nG_{\\pm} = \\frac{-2i\\nu\\sin(k\\,\\Delta x) \\pm \\sqrt{-4\\nu^{2}\\sin^{2}(k\\,\\Delta x) + 4}}{2}\n$$\n$$\nG_{\\pm}(k) = -i\\nu\\sin(k\\,\\Delta x) \\pm \\sqrt{1 - \\nu^{2}\\sin^{2}(k\\,\\Delta x)}\n$$\nThese are the two amplification factors for the leapfrog scheme. The existence of two factors is a direct consequence of the scheme being a three-level (or two-step) method in time.\n\nThe general solution for the amplitude is a linear combination of the two modes: $\\hat{u}^{n} = c_{1}(G_{+})^{n} + c_{2}(G_{-})^{n}$. For the scheme to be stable, the Von Neumann criterion requires that $|G(k)| \\leq 1$ for all wave numbers $k$. We examine the magnitudes of $G_{\\pm}$.\n\nCase 1: Stable Regime, $|\\nu| \\le 1$.\nIf the CFL condition $|\\nu| \\le 1$ is satisfied, then since $|\\sin(k\\,\\Delta x)| \\le 1$, we have $|\\nu\\sin(k\\,\\Delta x)| \\le 1$. This implies $\\nu^{2}\\sin^{2}(k\\,\\Delta x) \\le 1$, so the term under the square root, $1 - \\nu^{2}\\sin^{2}(k\\,\\Delta x)$, is real and non-negative. Let $\\beta = \\sqrt{1 - \\nu^{2}\\sin^{2}(k\\,\\Delta x)}$. The amplification factors are $G_{\\pm} = \\pm\\beta - i\\nu\\sin(k\\,\\Delta x)$. The squared magnitude of these complex numbers is:\n$$\n|G_{\\pm}|^{2} = (\\pm\\beta)^{2} + (-\\nu\\sin(k\\,\\Delta x))^{2} = \\beta^{2} + \\nu^{2}\\sin^{2}(k\\,\\Delta x)\n$$\n$$\n|G_{\\pm}|^{2} = \\left(1 - \\nu^{2}\\sin^{2}(k\\,\\Delta x)\\right) + \\nu^{2}\\sin^{2}(k\\,\\Delta x) = 1\n$$\nThus, for $|\\nu| \\le 1$, both amplification factors have a magnitude of exactly $1$. The scheme is neutrally stable; it neither amplifies nor damps any Fourier mode.\n\nCase 2: Unstable Regime, $|\\nu| > 1$.\nIf $|\\nu| > 1$, there exist wave numbers $k$ (e.g., where $|\\sin(k\\Delta x)| > 1/|\\nu|$) for which $1 - \\nu^{2}\\sin^{2}(k\\,\\Delta x) < 0$. The square root becomes purely imaginary: $\\sqrt{1 - \\nu^{2}\\sin^{2}(k\\,\\Delta x)} = \\pm i \\sqrt{\\nu^{2}\\sin^{2}(k\\,\\Delta x) - 1}$.\nThe factors are $G_{\\pm} = -i\\nu\\sin(k\\,\\Delta x) \\pm i\\sqrt{\\nu^{2}\\sin^{2}(k\\,\\Delta x) - 1}$. These are purely imaginary. Let's consider the magnitude of one of them:\n$$\n|G_{-}| = \\left|-i\\left(\\nu\\sin(k\\,\\Delta x) + \\sqrt{\\nu^{2}\\sin^{2}(k\\,\\Delta x) - 1}\\right)\\right| = |\\nu\\sin(k\\,\\Delta x)| + \\sqrt{\\nu^{2}\\sin^{2}(k\\,\\Delta x) - 1}\n$$\nFor a wave number $k$ such that $|\\sin(k\\Delta x)|=1$, we get $|G_{-}| = |\\nu| + \\sqrt{\\nu^{2} - 1}$. Since $|\\nu|>1$, it is clear that $|G_{-}| > 1$. The amplitude of this mode grows exponentially, rendering the scheme unstable.\n\nCharacterization of the modes for stable computations ($|\\nu| \\le 1$):\nThe physical mode, $G_{+}$, must approximate the analytical amplification factor $G_{\\text{exact}} = \\exp(-iak\\Delta t) = \\exp(-i\\nu k\\Delta x)$. For small $k\\Delta x$, we expand $G_{+}$:\n$$\nG_{+}(k) = \\sqrt{1 - \\nu^{2}\\sin^{2}(k\\,\\Delta x)} - i\\nu\\sin(k\\,\\Delta x)\n$$\nUsing $\\sin(z) \\approx z - z^3/6$ and $\\sqrt{1-y} \\approx 1-y/2$, for small $z=k\\Delta x$:\n$$\nG_{+}(k) \\approx \\left(1 - \\frac{1}{2}\\nu^2(k\\Delta x)^2\\right) - i\\nu(k\\Delta x)\n$$\nThe expansion of the exact factor is $G_{\\text{exact}} \\approx 1 - i\\nu(k\\Delta x) - \\frac{1}{2}\\nu^2(k\\Delta x)^2$. The two expansions match up to the second-order terms. This confirms that $G_{+}$ is the physical mode and that the scheme is second-order accurate.\n\nThe parasitic mode is $G_{-}$. For small $k\\Delta x$, its expansion is:\n$$\nG_{-}(k) = -\\sqrt{1 - \\nu^{2}\\sin^{2}(k\\,\\Delta x)} - i\\nu\\sin(k\\,\\Delta x)\n$$\n$$\nG_{-}(k) \\approx -\\left(1 - \\frac{1}{2}\\nu^2(k\\Delta x)^2\\right) - i\\nu(k\\Delta x) \\approx -1 - i\\nu(k\\Delta x)\n$$\nAs $k\\Delta x \\to 0$ (long wavelength limit), $G_{+}(k) \\to 1$ and $G_{-}(k) \\to -1$. The term $(G_{-})^{n} \\approx (-1)^{n}$ introduces oscillations with a period of $2\\Delta t$. This high-frequency oscillation is an artifact of the central differencing in time and has no physical basis in the PDE. This is the parasitic computational mode. Since $|G_{-}|=1$, this mode is not damped and can persist, potentially corrupting the physical solution.\n\nImpact on convergence: The Lax equivalence theorem states that for a consistent, linear finite-difference scheme, stability is the necessary and sufficient condition for convergence.\n1.  **Consistency:** The leapfrog scheme is a consistent discretization of the advection equation with a truncation error of $O(\\Delta t^2, \\Delta x^2)$.\n2.  **Stability:** As shown, the scheme is stable (neutrally stable) if and only if the CFL condition $|\\nu| \\le 1$ is met.\n\nTherefore, according to the Lax equivalence theorem, the leapfrog scheme converges to the true solution as $\\Delta t, \\Delta x \\to 0$ (provided $|\\nu| \\text{ is constant} \\le 1$). However, the presence of the undamped parasitic mode is a significant practical issue. Although the numerical solution converges in the limit, for any finite grid resolution, the solution can be contaminated by spurious $2\\Delta t$ oscillations, whose initial amplitude depends on the method used to start the three-level scheme.", "answer": "$$\n\\boxed{\\begin{pmatrix} -i\\nu \\sin(k\\Delta x) + \\sqrt{1 - \\nu^2 \\sin^2(k\\Delta x)} & -i\\nu \\sin(k\\Delta x) - \\sqrt{1 - \\nu^2 \\sin^2(k\\Delta x)} \\end{pmatrix}}\n$$", "id": "3304581"}, {"introduction": "This final practice challenges the limits of linear stability theory and the Lax Equivalence Theorem when dealing with discontinuous solutions, a common scenario in fluid dynamics. By comparing the second-order Lax-Wendroff scheme with the first-order upwind method, you will numerically demonstrate that linear stability does not prevent the formation of unphysical oscillations near sharp gradients. This exercise introduces the critical concept of nonlinear stability, particularly the Total Variation Diminishing (TVD) property, and explains why high-order linear schemes inherently struggle with discontinuities, motivating the development of modern nonlinear methods [@problem_id:3304576].", "problem": "Consider the one-dimensional linear advection initial-value problem on a periodic domain,\n$$\n\\frac{\\partial u}{\\partial t} + a \\frac{\\partial u}{\\partial x} = 0,\\quad x \\in [0,1),\\ t \\ge 0,\n$$\nwith constant advection speed $a > 0$. Use the following fundamental basis:\n- The definition of consistency for a finite difference scheme is that its local truncation error tends to zero as the grid spacing $\\Delta x \\to 0$ and the time step $\\Delta t \\to 0$ with a fixed Courant number $C = a \\Delta t/\\Delta x$.\n- Linear (von Neumann) stability for a linear constant-coefficient scheme is assessed by the amplification factor $G(\\theta)$ for Fourier mode $e^{i j \\theta}$, and stability requires $\\max_{\\theta \\in [0,\\pi]} |G(\\theta)| \\le 1$.\n- The Lax equivalence theorem states: for a linear initial-value problem with a consistent finite difference scheme, linear stability is equivalent to convergence in the norm associated with the stability estimate.\n- Total Variation Diminishing (TVD) is a nonlinear stability property requiring that the discrete total variation $TV(u^n) = \\sum_j |u^n_{j+1} - u^n_j|$ does not increase with time.\n\nYou will construct a numerical example that demonstrates Gibbs-like oscillations near a discontinuity for a consistent but non-TVD second-order scheme and quantify why the Lax equivalence theorem does not guarantee nonlinear stability. Implement two explicit schemes with periodic boundary conditions:\n1. A second-order Lax–Wendroff scheme:\n$$\nu^{n+1}_j = u^n_j - \\frac{C}{2} \\left(u^n_{j+1} - u^n_{j-1}\\right) + \\frac{C^2}{2} \\left(u^n_{j+1} - 2 u^n_j + u^n_{j-1}\\right),\n$$\nwhere $C = a \\Delta t/\\Delta x$.\n2. A first-order upwind (donor-cell) scheme for $a > 0$:\n$$\nu^{n+1}_j = u^n_j - C \\left(u^n_j - u^n_{j-1}\\right).\n$$\n\nDefine the initial data for two cases:\n- Discontinuous step:\n$$\nu_0(x) = \\begin{cases}\n1,& 0 \\le x < 0.5,\\\\\n0,& 0.5 \\le x < 1,\n\\end{cases}\n$$\nwhich has bounds $u \\in [0,1]$ at $t=0$.\n- Smooth wave:\n$$\nu_0(x) = \\sin(2\\pi x),\n$$\nwhose exact solution is $u(x,t) = \\sin\\left(2\\pi(x - a t)\\right)$.\n\nUse the following test suite. In every test, take $a = 1$ and the periodic domain $[0,1)$ discretized with $N$ points at positions $x_j = j \\Delta x$, where $\\Delta x = 1/N$, $j = 0,1,\\dots,N-1$. Evolve to the specified final time $T$ using a time step $\\Delta t = C \\Delta x / a$, performing whole steps of size $\\Delta t$ and one final step of size $T - n \\Delta t$ if needed so that the total evolution time is exactly $T$.\n\n- Test 1 (Happy path): Lax–Wendroff, discontinuous step initial data, $N = 400$, $C = 0.5$, $T = 0.25$. Compute the overshoot amplitude\n$$\n\\mathrm{OS} = \\max\\left(\\max_j u^n_j - 1,\\ 0,\\ -\\min_j u^n_j\\right),\n$$\nwhich measures the violation of the physical bounds $[0,1]$.\n- Test 2 (Boundary Courant number): Lax–Wendroff, discontinuous step initial data, $N = 400$, $C = 1.0$, $T = 0.25$. Compute $\\mathrm{OS}$.\n- Test 3 (Monotone scheme comparison): Upwind, discontinuous step initial data, $N = 400$, $C = 0.5$, $T = 0.25$. Compute $\\mathrm{OS}$.\n- Test 4 (Linear stability check): For Lax–Wendroff, compute the amplification factor for Fourier mode angle $\\theta \\in [0,\\pi]$,\n$$\nG(\\theta; C) = 1 - i C \\sin\\theta - C^2 (1 - \\cos\\theta),\n$$\nand return a boolean indicating whether $\\max_{\\theta \\in [0,\\pi]} |G(\\theta; 0.5)| \\le 1$.\n- Test 5 (Linear stability near boundary): Return a boolean indicating whether $\\max_{\\theta \\in [0,\\pi]} |G(\\theta; 1.0)| \\le 1$.\n- Test 6 (Convergence order on smooth data): Lax–Wendroff, smooth initial data $u_0(x) = \\sin(2\\pi x)$, $T = 0.25$, with $N_1 = 200$ and $N_2 = 400$, both at $C = 0.5$. Compute the discrete $\\ell^2$ error $E_N = \\left(\\Delta x \\sum_j \\left(u^{N}(x_j,T) - u_{\\text{exact}}(x_j,T)\\right)^2\\right)^{1/2}$ for each $N$, and report the observed order\n$$\np = \\log_2\\left(\\frac{E_{N_1}}{E_{N_2}}\\right).\n$$\n- Test 7 (Total variation growth on discontinuity): Lax–Wendroff, discontinuous step initial data, $N = 400$, $C = 0.5$, $T = 0.25$. Compute the total variation ratio\n$$\nR_{\\mathrm{TV}} = \\frac{TV(u(\\cdot,T))}{TV(u(\\cdot,0))},\\quad TV(u) = \\sum_{j=0}^{N-1} \\left|u_{j+1} - u_j\\right|,\n$$\nwith periodic indexing $u_N \\equiv u_0$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,result3,...]\"). The outputs, in order, must be:\n1. Test 1 overshoot amplitude $\\mathrm{OS}$ as a float.\n2. Test 2 overshoot amplitude $\\mathrm{OS}$ as a float.\n3. Test 3 overshoot amplitude $\\mathrm{OS}$ as a float.\n4. Test 4 linear stability boolean.\n5. Test 5 linear stability boolean.\n6. Test 6 observed order $p$ as a float.\n7. Test 7 total variation ratio $R_{\\mathrm{TV}}$ as a float.\n\nNo physical units are needed. Angles used for $\\theta$ in the amplification factor must be treated in radians. Express every numeric output directly as a float or a boolean in the list, without percentage signs or units.", "solution": "The problem presented is a well-posed and standard exercise in the field of computational fluid dynamics, specifically concerning the numerical solution of the one-dimensional linear advection equation. It requires the implementation and analysis of two finite difference schemes to demonstrate fundamental concepts of consistency, stability, and convergence, as encapsulated by the Lax Equivalence Theorem, and to highlight the theorem's limitations with respect to nonlinear stability phenomena such as Gibbs oscillations. The problem is scientifically grounded, internally consistent, and provides all necessary data for a unique solution.\n\nWe are tasked with solving the one-dimensional linear advection equation on a periodic domain:\n$$\n\\frac{\\partial u}{\\partial t} + a \\frac{\\partial u}{\\partial x} = 0, \\quad x \\in [0,1), \\ t \\ge 0\n$$\nwhere $a > 0$ is a constant advection speed. The solution $u(x,t)$ represents a quantity that is transported (advected) with speed $a$ without changing its shape. The exact solution is given by $u(x,t) = u_0(x-at)$, where $u_0(x)$ is the initial condition. We will discretize the spatial domain $[0,1)$ into $N$ points $x_j = j \\Delta x$ for $j = 0, 1, \\dots, N-1$, where $\\Delta x = 1/N$. The time domain is discretized with a time step $\\Delta t$. The relationship between these is given by the Courant-Friedrichs-Lewy (CFL) number, $C = a \\Delta t / \\Delta x$.\n\nThe problem requires a comparative analysis of two numerical schemes:\n\n$1$. The second-order Lax-Wendroff (LW) scheme:\n$$\nu^{n+1}_j = u^n_j - \\frac{C}{2} \\left(u^n_{j+1} - u^n_{j-1}\\right) + \\frac{C^2}{2} \\left(u^n_{j+1} - 2 u^n_j + u^n_{j-1}\\right)\n$$\nThis scheme is derived from a Taylor series expansion of $u(x, t+\\Delta t)$ in time, using the governing PDE to replace temporal derivatives with spatial derivatives. It is second-order accurate in both space and time, denoted as $\\mathcal{O}(\\Delta x^2, \\Delta t^2)$.\n\n$2$. The first-order upwind (FOU) or donor-cell scheme (for $a>0$):\n$$\nu^{n+1}_j = u^n_j - C \\left(u^n_j - u^n_{j-1}\\right)\n$$\nThis scheme is derived from a backward difference for the spatial derivative, respecting the direction of wave propagation (the \"upwind\" direction). It is only first-order accurate, $\\mathcal{O}(\\Delta x, \\Delta t)$, and is known to introduce significant numerical diffusion, which smears sharp features of the solution.\n\nA central theme of this problem is the relationship between three key properties of a numerical scheme:\n-   **Consistency**: A scheme is consistent if its local truncation error—the error made by applying the discrete operator to the exact solution—vanishes as $\\Delta x \\to 0$ and $\\Delta t \\to 0$. Both the LW and FOU schemes are consistent with the advection equation.\n-   **Stability**: A scheme is stable if it does not amplify errors as the computation proceeds. For linear, constant-coefficient problems, this is assessed using von Neumann stability analysis. We seek the amplification factor $G(\\theta)$ for a single Fourier mode $u^n_j \\propto G^n e^{i j \\theta}$. Stability requires $|G(\\theta)| \\le 1$ for all Fourier wavenumbers $\\theta$. For the Lax-Wendroff scheme, the amplification factor is $G(\\theta; C) = 1 - i C \\sin\\theta - C^2 (1 - \\cos\\theta)$. The squared magnitude is $|G(\\theta;C)|^2 = 1 - 4C^2(1-C^2)\\sin^4(\\theta/2)$. For this to be less than or equal to $1$, we require $C^2(1-C^2) \\ge 0$. Since $C^2 \\ge 0$, the condition simplifies to $1-C^2 \\ge 0$, or $|C| \\le 1$. Thus, the Lax-Wendroff scheme is linearly stable for Courant numbers up to $1$.\n-   **Convergence**: A scheme is convergent if the numerical solution approaches the true solution as the grid is refined. The **Lax Equivalence Theorem** provides the cornerstone connection: for a consistent scheme applied to a well-posed linear initial-value problem, stability is the necessary and sufficient condition for convergence.\n\nHowever, the Lax Equivalence Theorem guarantees convergence in a specific norm (e.g., the $\\ell^2$ norm). It does not guarantee pointwise convergence or the preservation of qualitative features of the solution. This is where the concept of **nonlinear stability** becomes crucial, especially for problems with sharp gradients or discontinuities. A key property is being **Total Variation Diminishing (TVD)**, which means the total variation of the discrete solution, $TV(u^n) = \\sum_j |u^n_{j+1} - u^n_j|$, does not increase in time. TVD schemes do not generate new oscillations. **Godunov's Theorem** states that any linear TVD scheme is at most first-order accurate. This profound result implies that a high-order linear scheme like Lax-Wendroff *cannot* be TVD. Consequently, while it is linearly stable and convergent for smooth problems, it is expected to produce unphysical oscillations (Gibbs phenomenon) near discontinuities. The first-order upwind scheme, on the other hand, is TVD for $C \\in [0,1]$ and will not produce such oscillations, at the cost of being overly diffusive.\n\nThe series of tests in this problem are designed to numerically demonstrate these theoretical points.\n\n-   **Test 1 and 2**: Apply the LW scheme to a discontinuous step profile. For $C=0.5$, the scheme is within its stability limit but is not TVD, so we anticipate non-physical overshoots and undershoots, resulting in $\\mathrm{OS} > 0$. For the special case $C=1.0$, the LW scheme reduces to $u^{n+1}_j = u^n_{j-1}$, which is an exact shift of the data by one grid cell per time step. For this specific Courant number, the scheme is non-dissipative and non-dispersive, perfectly translating the step function. Thus, we expect $\\mathrm{OS} = 0$.\n\n-   **Test 3**: Apply the first-order upwind scheme to the same step profile with $C=0.5$. Since this scheme is TVD for $C \\in [0,1]$, it will not create new extrema. The solution will remain bounded by its initial minimum and maximum, $[0,1]$. Therefore, the overshoot $\\mathrm{OS}$ must be $0$.\n\n-   **Test 4 and 5**: These tests directly verify the linear stability analysis of the LW scheme. Based on the derivation that stability requires $|C| \\le 1$, we expect to find that the stability condition $\\max_\\theta |G(\\theta; C)| \\le 1$ holds for both $C=0.5$ and $C=1.0$.\n\n-   **Test 6**: This test evaluates the convergence rate of the LW scheme on a smooth sine wave. The Lax Equivalence Theorem guarantees convergence. As LW is a second-order scheme, its error should decrease quadratically with the grid spacing $\\Delta x$. By halving $\\Delta x$ (from $N_1=200$ to $N_2=400$), the $\\ell^2$ error $E_N$ should decrease by a factor of $2^2=4$. The observed order of convergence, $p = \\log_2(E_{N_1}/E_{N_2})$, should therefore be approximately $2$.\n\n-   **Test 7**: This test quantifies the non-TVD nature of the LW scheme when applied to a discontinuous profile. The initial total variation $TV(u^0)$ for a step from $1$ to $0$ on a periodic domain is $TV(u^0) = |0-1| + |1-0| = 2$. The oscillations generated by the scheme will increase the sum of absolute differences between adjacent grid points, leading to a final total variation $TV(u(\\cdot,T)) > TV(u^0)$. The ratio $R_{\\mathrm{TV}}$ will therefore be greater than $1$.\n\nThe following calculations implement these tests to provide quantitative evidence for the theoretical discussion. The implementation will use periodic boundary conditions, which are efficiently handled by circular shifts of the solution array. All simulations evolve to a time $T$ that is an integer multiple of the timestep $\\Delta t$, simplifying the time-marching loop.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the numerical analysis problem by running seven distinct tests on finite difference schemes\n    for the 1D linear advection equation.\n    \"\"\"\n\n    # --- Helper Functions for Schemes and Simulation ---\n\n    def lw_step(u, C):\n        \"\"\"Performs one time step of the Lax-Wendroff scheme.\"\"\"\n        u_jp1 = np.roll(u, -1)\n        u_jm1 = np.roll(u, 1)\n        u_new = u - (C / 2.0) * (u_jp1 - u_jm1) + \\\n                (C**2 / 2.0) * (u_jp1 - 2.0 * u + u_jm1)\n        return u_new\n\n    def fou_step(u, C):\n        \"\"\"Performs one time step of the first-order upwind scheme (a>0).\"\"\"\n        u_jm1 = np.roll(u, 1)\n        u_new = u - C * (u - u_jm1)\n        return u_new\n\n    def run_simulation(scheme_func, u0, N, C, T, a):\n        \"\"\"\n        Runs a simulation from t=0 to t=T.\n        Note: The problem statement specifies a final smaller timestep if T is not a\n        multiple of dt. However, for all given test cases, T is an exact\n        multiple of dt, so this logic is not triggered.\n        \"\"\"\n        dx = 1.0 / N\n        dt = C * dx / a\n        \n        # In all test cases, T/dt is an integer, so we can use round().\n        num_steps = int(round(T / dt))\n        \n        u = np.copy(u0)\n        for _ in range(num_steps):\n            u = scheme_func(u, C)\n        return u\n\n    # --- Test Case Implementations ---\n\n    def test1():\n        \"\"\"Lax–Wendroff, discontinuous step, C=0.5. Compute overshoot.\"\"\"\n        N, C, T, a = 400, 0.5, 0.25, 1.0\n        u0 = np.zeros(N)\n        u0[0:N//2] = 1.0\n        u_final = run_simulation(lw_step, u0, N, C, T, a)\n        os = np.max([np.max(u_final) - 1.0, 0.0, -np.min(u_final)])\n        return os\n\n    def test2():\n        \"\"\"Lax–Wendroff, discontinuous step, C=1.0. Compute overshoot.\"\"\"\n        N, C, T, a = 400, 1.0, 0.25, 1.0\n        u0 = np.zeros(N)\n        u0[0:N//2] = 1.0\n        u_final = run_simulation(lw_step, u0, N, C, T, a)\n        os = np.max([np.max(u_final) - 1.0, 0.0, -np.min(u_final)])\n        return os\n\n    def test3():\n        \"\"\"Upwind, discontinuous step, C=0.5. Compute overshoot.\"\"\"\n        N, C, T, a = 400, 0.5, 0.25, 1.0\n        u0 = np.zeros(N)\n        u0[0:N//2] = 1.0\n        u_final = run_simulation(fou_step, u0, N, C, T, a)\n        os = np.max([np.max(u_final) - 1.0, 0.0, -np.min(u_final)])\n        return os\n\n    def test4():\n        \"\"\"Lax–Wendroff, linear stability check for C=0.5.\"\"\"\n        C = 0.5\n        theta = np.linspace(0, np.pi, 2001)  # A fine grid for theta\n        # Formula for amplification factor G\n        G = 1 - 1j * C * np.sin(theta) - C**2 * (1 - np.cos(theta))\n        max_G_abs = np.max(np.abs(G))\n        # Use a small tolerance for floating point comparisons\n        return max_G_abs <= 1.0 + 1e-9\n\n    def test5():\n        \"\"\"Lax–Wendroff, linear stability check for C=1.0.\"\"\"\n        C = 1.0\n        theta = np.linspace(0, np.pi, 2001)\n        G = 1 - 1j * C * np.sin(theta) - C**2 * (1 - np.cos(theta))\n        max_G_abs = np.max(np.abs(G))\n        return max_G_abs <= 1.0 + 1e-9\n\n    def test6():\n        \"\"\"Lax-Wendroff, convergence order on smooth data.\"\"\"\n        T, C, a = 0.25, 0.5, 1.0\n        \n        # Coarse grid (N1)\n        N1 = 200\n        x1 = np.linspace(0, 1, N1, endpoint=False)\n        dx1 = 1.0 / N1\n        u0_1 = np.sin(2 * np.pi * x1)\n        u_final_1 = run_simulation(lw_step, u0_1, N1, C, T, a)\n        u_exact_1 = np.sin(2 * np.pi * (x1 - a * T))\n        error1 = np.sqrt(dx1 * np.sum((u_final_1 - u_exact_1)**2))\n        \n        # Fine grid (N2)\n        N2 = 400\n        x2 = np.linspace(0, 1, N2, endpoint=False)\n        dx2 = 1.0 / N2\n        u0_2 = np.sin(2 * np.pi * x2)\n        u_final_2 = run_simulation(lw_step, u0_2, N2, C, T, a)\n        u_exact_2 = np.sin(2 * np.pi * (x2 - a * T))\n        error2 = np.sqrt(dx2 * np.sum((u_final_2 - u_exact_2)**2))\n        \n        # Compute observed order p\n        order = np.log2(error1 / error2)\n        return order\n\n    def test7():\n        \"\"\"Lax-Wendroff, Total Variation growth on discontinuity.\"\"\"\n        N, C, T, a = 400, 0.5, 0.25, 1.0\n        u0 = np.zeros(N)\n        u0[0:N//2] = 1.0\n        \n        # Initial Total Variation\n        tv0 = np.sum(np.abs(np.roll(u0, -1) - u0))\n        \n        # Final Total Variation\n        u_final = run_simulation(lw_step, u0, N, C, T, a)\n        tv_final = np.sum(np.abs(np.roll(u_final, -1) - u_final))\n        \n        return tv_final / tv0\n\n    # --- Execute Tests and Format Output ---\n\n    results = [\n        test1(),\n        test2(),\n        test3(),\n        test4(),\n        test5(),\n        test6(),\n        test7()\n    ]\n    \n    # Format boolean as lowercase 'true'/'false' as per standard Python str()\n    formatted_results = [str(r).lower() if isinstance(r, bool) else str(r) for r in results]\n    \n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n\n```", "id": "3304576"}]}