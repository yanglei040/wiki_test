{"hands_on_practices": [{"introduction": "The first step in mastering modified equation analysis is to apply it to a foundational numerical method. This exercise guides you through a detailed analysis of the classic MacCormack predictor-corrector scheme, which is equivalent to the Lax-Wendroff method for linear problems. By performing the Taylor series expansions and identifying the leading-order error terms, you will gain hands-on experience in quantifying the numerical dissipation and dispersion that are characteristic of second-order schemes and learn how these errors depend on the Courant number [@problem_id:3346245].", "problem": "Consider the constant-coefficient linear advection equation $u_t + a u_x = 0$ with $a \\in \\mathbb{R}$ on a uniform grid with spatial step $h$ and time step $\\tau$. Define the Courant–Friedrichs–Lewy (CFL) number $\\lambda = \\frac{a \\tau}{h}$. Apply the MacCormack predictor–corrector method in its standard one-dimensional form, where the predictor uses the forward difference and the corrector uses the backward difference:\n$$\nu_i^{(p)} = u_i^n - \\lambda \\left(u_{i+1}^n - u_i^n\\right), \\quad\nu_i^{n+1} = \\frac{1}{2}\\left(u_i^n + u_i^{(p)} - \\lambda \\left(u_i^{(p)} - u_{i-1}^{(p)}\\right)\\right).\n$$\nStarting from this discretization and the base partial differential equation, perform a modified equation analysis that consistently retains and combines cross terms introduced by the predictor and the corrector. Use a Fourier mode ansatz $u_i^n = \\exp\\!\\left(i\\left(k x_i - \\omega t_n\\right)\\right)$ to connect the discrete amplification factor to a continuous modified equation and determine the leading-order dispersive and dissipative corrections. Derive a closed-form modified equation of the form\n$$\nu_t + a u_x = \\chi(\\lambda,a)\\, h^2\\, u_{xxx} - \\delta(\\lambda,a)\\, h^3\\, u_{xxxx} + O\\!\\left(h^4\\right),\n$$\nwith explicit analytical expressions for $\\chi(\\lambda,a)$ and $\\delta(\\lambda,a)$ that arise from matching the series expansion of the scheme’s amplification factor to the exponential of the modified dispersion relation. Based on these expressions, identify the CFL value $\\lambda_\\star$ that cancels the leading $O(h^3)$ dispersive error, and state the symbolic form of the leading dissipative coefficient $\\delta(\\lambda,a)$ in the above representation.\n\nIn your derivation, explain the roles of numerical dispersion and numerical dissipation, and discuss how aliasing errors may manifest at high wavenumbers in the discrete symbol and how the presence or absence of dissipation influences their control. Your final reported quantities must be:\n- The single CFL value $\\lambda_\\star$ that cancels the $O(h^3)$ dispersive term.\n- The closed-form expression of $\\delta(\\lambda,a)$.\n\nExpress your final answer as a single analytical expression or as a single row vector using LaTeX’s $pmatrix$. No rounding is required.", "solution": "The subject of this analysis is the one-dimensional, constant-coefficient linear advection equation, given by:\n$$\nu_t + a u_x = 0\n$$\nwhere $a \\in \\mathbb{R}$ is the constant advection speed. We analyze the MacCormack predictor-corrector scheme on a uniform grid with spatial step $h$ and time step $\\tau$. The Courant–Friedrichs–Lewy (CFL) number is defined as $\\lambda = \\frac{a \\tau}{h}$.\n\nThe scheme is defined by two steps:\n1.  **Predictor step (forward difference):**\n    $$\n    u_i^{(p)} = u_i^n - \\lambda \\left(u_{i+1}^n - u_i^n\\right)\n    $$\n2.  **Corrector step (backward difference on predicted values):**\n    $$\n    u_i^{n+1} = \\frac{1}{2}\\left(u_i^n + u_i^{(p)} - \\lambda \\left(u_i^{(p)} - u_{i-1}^{(p)}\\right)\\right)\n    $$\n\nOur first task is to combine these two steps into a single explicit formula for $u_i^{n+1}$ in terms of values at the time level $n$. We substitute the predictor expression into the corrector expression.\nFirst, we write the predictor for indices $i$ and $i-1$:\n$$\nu_i^{(p)} = (1+\\lambda)u_i^n - \\lambda u_{i+1}^n\n$$\n$$\nu_{i-1}^{(p)} = (1+\\lambda)u_{i-1}^n - \\lambda u_{i}^n\n$$\nNow, substitute these into the corrector equation:\n$$\nu_i^{n+1} = \\frac{1}{2}\\left[ u_i^n + \\left((1+\\lambda)u_i^n - \\lambda u_{i+1}^n\\right) - \\lambda \\left( \\left((1+\\lambda)u_i^n - \\lambda u_{i+1}^n\\right) - \\left((1+\\lambda)u_{i-1}^n - \\lambda u_{i}^n\\right) \\right) \\right]\n$$\nSimplifying the term inside the large parentheses:\n$$\nu_i^{n+1} = \\frac{1}{2}\\left[ (2+\\lambda)u_i^n - \\lambda u_{i+1}^n - \\lambda \\left( (1+2\\lambda)u_i^n - \\lambda u_{i+1}^n - (1+\\lambda)u_{i-1}^n \\right) \\right]\n$$\nDistributing the inner $-\\lambda$:\n$$\nu_i^{n+1} = \\frac{1}{2}\\left[ (2+\\lambda)u_i^n - \\lambda u_{i+1}^n - \\lambda(1+2\\lambda)u_i^n + \\lambda^2 u_{i+1}^n + \\lambda(1+\\lambda)u_{i-1}^n \\right]\n$$\nCollecting terms based on their spatial index:\n$$\nu_i^{n+1} = \\frac{1}{2}\\left[ \\left(2+\\lambda - \\lambda - 2\\lambda^2\\right)u_i^n + \\left(\\lambda^2 - \\lambda\\right)u_{i+1}^n + \\left(\\lambda^2 + \\lambda\\right)u_{i-1}^n \\right]\n$$\n$$\nu_i^{n+1} = \\frac{1}{2}\\left[ (2 - 2\\lambda^2)u_i^n + \\lambda(\\lambda-1)u_{i+1}^n + \\lambda(\\lambda+1)u_{i-1}^n \\right]\n$$\nThis simplifies to the well-known Lax-Wendroff scheme stencil:\n$$\nu_i^{n+1} = (1 - \\lambda^2)u_i^n + \\frac{\\lambda(\\lambda-1)}{2}u_{i+1}^n + \\frac{\\lambda(\\lambda+1)}{2}u_{i-1}^n\n$$\n\nTo perform the modified equation analysis, we introduce a Fourier mode ansatz $u_j^n = G^n(k) \\exp(i k x_j)$, where $x_j=jh$, $k$ is the wavenumber, and $G(k)$ is the amplification factor. Substituting this into the single-step scheme gives:\n$$\nG \\exp(ikx_i) = (1 - \\lambda^2)\\exp(ikx_i) + \\frac{\\lambda(\\lambda-1)}{2}\\exp(ikx_{i+1}) + \\frac{\\lambda(\\lambda+1)}{2}\\exp(ikx_{i-1})\n$$\nDividing by $\\exp(ikx_i)$:\n$$\nG = (1 - \\lambda^2) + \\frac{\\lambda(\\lambda-1)}{2}\\exp(ikh) + \\frac{\\lambda(\\lambda+1)}{2}\\exp(-ikh)\n$$\nUsing the dimensionless wavenumber $\\theta = kh$ and Euler's formula $\\exp(\\pm i\\theta) = \\cos(\\theta) \\pm i\\sin(\\theta)$, we find:\n$$\nG(\\theta) = 1 - \\lambda^2 + \\left(\\frac{\\lambda(\\lambda-1)}{2} + \\frac{\\lambda(\\lambda+1)}{2}\\right)\\cos(\\theta) + i\\left(\\frac{\\lambda(\\lambda-1)}{2} - \\frac{\\lambda(\\lambda+1)}{2}\\right)\\sin(\\theta)\n$$\n$$\nG(\\theta) = 1 - \\lambda^2 + \\lambda^2\\cos(\\theta) - i\\lambda\\sin(\\theta) = 1 - \\lambda^2(1-\\cos(\\theta)) - i\\lambda\\sin(\\theta)\n$$\nThe modified equation is of the form $u_t + a u_x = \\mathcal{L}_{err}(u)$, where $\\mathcal{L}_{err}$ represents the error terms. The amplification factor of the modified equation over one time step $\\tau$ is $G_{mod} = \\exp(-i\\omega_{mod}\\tau)$, where $\\omega_{mod}(k)$ is the modified dispersion relation. We find $\\omega_{mod}$ by substituting $u(x,t) = \\exp(i(kx-\\omega_{mod}t))$ into the target modified equation:\n$u_t + a u_x = \\chi h^2 u_{xxx} - \\delta h^3 u_{xxxx}$\n$$\n-i\\omega_{mod} + a(ik) = \\chi h^2 (ik)^3 - \\delta h^3 (ik)^4\n$$\n$$\n-i\\omega_{mod} = -iak - i\\chi k^3 h^2 - \\delta k^4 h^3\n$$\nMultiplying by $\\tau$ and using $\\lambda = a\\tau/h$, $\\theta=kh$:\n$$\n-i\\omega_{mod}\\tau = -iak\\tau - i\\chi k^3 h^2 \\tau - \\delta k^4 h^3 \\tau = -i\\lambda\\theta - i\\chi(k^3 h^3)\\frac{\\tau}{h} - \\delta(k^4 h^4)\\frac{\\tau}{h}\n$$\n$$\n\\ln(G_{mod}) = -i\\lambda\\theta - i\\frac{\\chi\\lambda}{a}\\theta^3 - \\frac{\\delta\\lambda}{a}\\theta^4 + O(\\theta^5)\n$$\nWe must match this to the Taylor series expansion of $\\ln(G(\\theta))$ for the numerical scheme. First, we expand $G(\\theta)$ for small $\\theta$:\n$$\nG(\\theta) = 1 - \\lambda^2\\left(\\frac{\\theta^2}{2} - \\frac{\\theta^4}{24} + \\dots\\right) - i\\lambda\\left(\\theta - \\frac{\\theta^3}{6} + \\dots\\right)\n$$\n$$\nG(\\theta) = 1 - i\\lambda\\theta - \\frac{\\lambda^2\\theta^2}{2} + i\\frac{\\lambda\\theta^3}{6} + \\frac{\\lambda^2\\theta^4}{24} + O(\\theta^5)\n$$\nUsing the series expansion $\\ln(1+z) = z - z^2/2 + z^3/3 - \\dots$ with $z = G(\\theta)-1$, and collecting terms by powers of $\\theta$, we find:\n$$\n\\ln(G(\\theta)) = -i\\lambda\\theta + i\\frac{\\lambda(1-\\lambda^2)}{6}\\theta^3 - \\frac{\\lambda^2(1-\\lambda^2)}{8}\\theta^4 + O(\\theta^5)\n$$\nComparing this with $\\ln(G_{mod})$:\n$$\n-i\\lambda\\theta - i\\frac{\\chi\\lambda}{a}\\theta^3 - \\frac{\\delta\\lambda}{a}\\theta^4 = -i\\lambda\\theta + i\\frac{\\lambda(1-\\lambda^2)}{6}\\theta^3 - \\frac{\\lambda^2(1-\\lambda^2)}{8}\\theta^4\n$$\nMatching the imaginary $\\theta^3$ terms (dispersive error):\n$$\n-i\\frac{\\chi\\lambda}{a} = i\\frac{\\lambda(1-\\lambda^2)}{6} \\implies \\chi(\\lambda,a) = -\\frac{a(1-\\lambda^2)}{6} = \\frac{a(\\lambda^2-1)}{6}\n$$\nThis is the coefficient of the leading-order dispersive error term $h^2 u_{xxx}$. Numerical dispersion arises from odd-derivative error terms, which cause different Fourier components of the solution to propagate at incorrect, wavenumber-dependent phase velocities, distorting the solution profile.\n\nMatching the real $\\theta^4$ terms (dissipative error):\n$$\n-\\frac{\\delta\\lambda}{a} = -\\frac{\\lambda^2(1-\\lambda^2)}{8} \\implies \\delta(\\lambda,a) = \\frac{a\\lambda(1-\\lambda^2)}{8}\n$$\nThis is the coefficient for the leading-order dissipative error term, which is written as $-\\delta h^3 u_{xxxx}$ in the modified equation. Numerical dissipation arises from even-derivative error terms, which cause the amplitudes of Fourier components to decay. This effect is generally stronger for higher wavenumbers (shorter wavelengths) and can be beneficial for damping spurious, high-frequency oscillations. Such oscillations can be generated by aliasing, where wavenumbers higher than the grid's Nyquist frequency ($k_{Nyquist} = \\pi/h$) are misrepresented as lower wavenumbers. This misrepresentation can lead to non-physical behavior, such as components propagating in the wrong direction. The dissipative term, whose coefficient is positive for the stable range $|\\lambda|1$, systematically removes energy from the system, particularly at high wavenumbers, thus controlling the growth of aliasing-induced instabilities.\n\nTo cancel the leading $O(h^2)$ dispersive error, we set its coefficient $\\chi(\\lambda, a)$ to zero:\n$$\n\\frac{a(\\lambda^2-1)}{6} = 0\n$$\nAssuming $a \\neq 0$, this requires $\\lambda^2 - 1 = 0$, which yields $\\lambda = \\pm 1$. In either case, $|\\lambda|=1$. For a specific case with $a0$, the corresponding CFL number is $\\lambda=1$. Thus, we identify the specific value $\\lambda_\\star=1$ as the condition for vanishing third-order dispersion. For $\\lambda_\\star = \\pm 1$, the scheme becomes exact, $u_i^{n+1}=u_{i\\mp1}^n$, and all error terms, including the dissipative ones, vanish.\n\nThe required quantities are the CFL value $\\lambda_\\star$ and the expression for $\\delta(\\lambda,a)$.\n1.  The single CFL value that cancels the leading dispersive term (which is of order $O(h^2)$) is $\\lambda_\\star=1$ (or, more generally, $|\\lambda_\\star|=1$). We will report the principal positive value.\n2.  The leading dissipative coefficient is $\\delta(\\lambda,a) = \\frac{a\\lambda(1-\\lambda^2)}{8}$.", "answer": "$$\n\\boxed{\\begin{pmatrix} 1  \\frac{a\\lambda(1-\\lambda^2)}{8} \\end{pmatrix}}\n$$", "id": "3346245"}, {"introduction": "Moving from pure analysis to practical application, this problem explores how modified equation analysis can be used to design and tune a numerical scheme. You will investigate an artificial viscosity method, a common technique for capturing shocks and sharp gradients, which is controlled by a shock sensor. This practice demonstrates how to derive an equivalent continuous viscosity field from a discrete, nonlinear sensor and use this insight to calibrate the scheme, ensuring stability without excessively damping important physical features of the solution [@problem_id:3346187].", "problem": "Consider the one-dimensional linear advection equation $u_{t} + a\\,u_{x} = 0$ for a passive scalar $u(x,t)$ with constant advection speed $a$. A uniform grid with spacing $h$ is used, and a forward Euler time discretization with time step $\\Delta t$ advances the solution. To add shock capturing while minimizing spurious damping in smooth regions, an artificial viscosity term is included in semi-discrete form as a second-difference, scaled by a shock sensor. The fully discrete update at grid index $i$ and time level $n$ is\n$$\nu_{i}^{n+1} = u_{i}^{n} - \\frac{a\\,\\Delta t}{2h}\\left(u_{i+1}^{n} - u_{i-1}^{n}\\right) + \\Delta t\\,\\frac{\\nu_{i}^{n}}{h^{2}}\\left(u_{i+1}^{n} - 2u_{i}^{n} + u_{i-1}^{n}\\right),\n$$\nwhere the artificial viscosity coefficient is defined pointwise as\n$$\n\\nu_{i}^{n} = C_{\\text{vis}}\\;a\\,h\\,S_{i}^{n},\n$$\nwith a dimensionless scaling parameter $C_{\\text{vis}}  0$ and a shock sensor\n$$\nS_{i}^{n} = \\left|\\frac{u_{i+1}^{n} - 2u_{i}^{n} + u_{i-1}^{n}}{u_{i+1}^{n} - u_{i-1}^{n}}\\right|.\n$$\nYou may assume that $S_{i}^{n}$ is evaluated without any additional limiting in smooth regions. A modified equation analysis should be used to connect the discrete scheme to a continuous equation, revealing the leading-order dissipative and dispersive corrections and quantifying the action of the sensor in the presence of a traveling wave. In particular, consider a smooth traveling wave $u(x,t) = A \\sin\\!\\big(k(x - a t)\\big)$, with amplitude $A$ and wavenumber $k$ in radians per unit length. Focus on the dimensionless wavenumber $\\theta = k h$ content and suppose that a single Fourier mode with $\\theta \\approx 0.5$ dominates the local spectrum.\n\nTasks:\n1. Starting from the discrete update and the definition of the shock sensor, derive the leading-order modified equation for $u(x,t)$, identifying the equivalent continuous viscosity field $\\nu_{\\text{num}}(x)$ induced by the artificial viscosity term in terms of $C_{\\text{vis}}$, $a$, $h$, and the local value of the sensor for the traveling wave.\n2. For a single Fourier mode with dimensionless wavenumber $\\theta = k h$, use the discrete sensor definition to deduce a closed-form expression for the sensor magnitude as a function of $\\theta$. From this, express the equivalent viscosity $\\nu_{\\text{num}}$ near the smooth traveling wave explicitly as a function of $\\theta$.\n3. Using the result of the modified equation and the discrete symbol of the second-difference operator, obtain the per-step amplitude reduction factor caused by the artificial viscosity for a Fourier mode with wavenumber $k$ and grid spacing $h$, in terms of $C_{\\text{vis}}$, $a$, $\\Delta t$, $h$, and $\\theta$.\n4. Let the advection speed be $a = 1.2$ (in meters per second), the grid spacing be $h = 1.0 \\times 10^{-2}$ (in meters), and the time step satisfy a Courant–Friedrichs–Lewy (CFL) number $\\lambda = a\\,\\Delta t / h = 0.7$. Impose the requirement that the amplitude reduction per time step for the Fourier content with $\\theta = 0.5$ be at most $0.01$ in decimal form. Under this requirement, determine the maximum allowable value of the dimensionless viscosity scaling parameter $C_{\\text{vis}}$ that avoids overdamping of the $\\theta \\approx 0.5$ content.\nRound your final answer to four significant figures. Express the final answer as a dimensionless number.", "solution": "We analyze a numerical scheme for the one-dimensional linear advection equation, $u_{t} + a\\,u_{x} = 0$. The scheme is given by\n$$\nu_{i}^{n+1} = u_{i}^{n} - \\frac{a\\,\\Delta t}{2h}\\left(u_{i+1}^{n} - u_{i-1}^{n}\\right) + \\Delta t\\,\\frac{\\nu_{i}^{n}}{h^{2}}\\left(u_{i+1}^{n} - 2u_{i}^{n} + u_{i-1}^{n}\\right),\n$$\nwith the artificial viscosity coefficient $\\nu_{i}^{n} = C_{\\text{vis}}\\;a\\,h\\,S_{i}^{n}$ and the shock sensor $S_{i}^{n} = \\left|\\frac{u_{i+1}^{n} - 2u_{i}^{n} + u_{i-1}^{n}}{u_{i+1}^{n} - u_{i-1}^{n}}\\right|$.\n\n**1. Modified Equation and Equivalent Viscosity**\n\nTo derive the modified equation, we perform Taylor series expansions of the terms in the finite difference scheme around the point $(x_i, t_n)$. Let $u = u(x_i, t_n)$.\nThe time derivative term on the left-hand side is approximated by\n$$\n\\frac{u_i^{n+1} - u_i^n}{\\Delta t} = \\frac{(u + \\Delta t u_t + \\frac{\\Delta t^2}{2} u_{tt} + \\dots) - u}{\\Delta t} = u_t + \\frac{\\Delta t}{2} u_{tt} + O(\\Delta t^2).\n$$\nThe spatial differences on the right-hand side are expanded as:\nThe central difference for the first derivative:\n$$\n\\frac{u_{i+1}^n - u_{i-1}^n}{2h} = u_x + \\frac{h^2}{6}u_{xxx} + O(h^4).\n$$\nThe central difference for the second derivative:\n$$\n\\frac{u_{i+1}^n - 2u_i^n + u_{i-1}^n}{h^2} = u_{xx} + \\frac{h^2}{12}u_{xxxx} + O(h^4).\n$$\nSubstituting these expansions into the scheme gives:\n$$\nu_t + \\frac{\\Delta t}{2} u_{tt} + \\dots = -a\\left(u_x + \\frac{h^2}{6}u_{xxx}\\right) + \\nu_i^n \\left(u_{xx} + \\frac{h^2}{12}u_{xxxx}\\right) + \\dots\n$$\nTo eliminate the $u_{tt}$ term, we differentiate the original PDE, $u_t = -a u_x$, with respect to time: $u_{tt} = -a u_{xt} = -a(u_t)_x = -a(-a u_x)_x = a^2 u_{xx}$.\nSubstituting this back into the expanded scheme:\n$$\nu_t + \\frac{a^2 \\Delta t}{2} u_{xx} + \\dots = -a u_x - \\frac{ah^2}{6}u_{xxx} + \\nu_i^n u_{xx} + \\dots\n$$\nRearranging to match the form of a modified PDE, we get:\n$$\nu_t + a u_x = (\\nu_i^n - \\frac{a^2 \\Delta t}{2}) u_{xx} - \\frac{ah^2}{6}u_{xxx} + O(\\Delta t^2, h^4, \\Delta t h^2).\n$$\nThis is the leading-order modified equation. The term $(\\nu_i^n - \\frac{a^2 \\Delta t}{2}) u_{xx}$ is the total leading-order dissipation, comprising the added artificial viscosity and the numerical viscosity from the Forward-Euler-in-time, central-in-space discretization of the advection term. The term $-\\frac{ah^2}{6}u_{xxx}$ is the leading-order numerical dispersion.\n\nThe equivalent continuous viscosity field $\\nu_{\\text{num}}(x,t)$ induced by the artificial viscosity term corresponds to the continuous analogue of the coefficient $\\nu_i^n$ that multiplies the second derivative $u_{xx}$. Thus, the equivalent viscosity is:\n$$\n\\nu_{\\text{num}}(x,t) = C_{\\text{vis}}\\,a\\,h\\,S(x,t)\n$$\nwhere $S(x,t)$ is the continuous analogue of the sensor $S_i^n$.\n\n**2. Sensor Magnitude and Equivalent Viscosity as a function of $\\theta$**\n\nWe analyze the sensor for a single Fourier mode, $u_j = \\exp(i k x_j)$, where the analysis is performed at a fixed time level $n$. The dimensionless wavenumber is $\\theta = k h$.\n$u_j = \\exp(i k (jh))$.\nThe numerator of the sensor ratio involves the second difference operator $\\delta^2$:\n$$\nu_{i+1} - 2u_i + u_{i-1} = u_i(\\exp(i\\theta) - 2 + \\exp(-i\\theta)) = u_i(2\\cos(\\theta) - 2) = -4u_i\\sin^2(\\frac{\\theta}{2}).\n$$\nThe denominator involves the central first difference operator over $2h$:\n$$\nu_{i+1} - u_{i-1} = u_i(\\exp(i\\theta) - \\exp(-i\\theta)) = u_i(2i\\sin(\\theta)).\n$$\nThe ratio for this complex mode is:\n$$\n\\frac{u_{i+1} - 2u_i + u_{i-1}}{u_{i+1} - u_{i-1}} = \\frac{-4u_i\\sin^2(\\frac{\\theta}{2})}{2iu_i\\sin(\\theta)} = \\frac{-4\\sin^2(\\frac{\\theta}{2})}{2i(2\\sin(\\frac{\\theta}{2})\\cos(\\frac{\\theta}{2}))} = \\frac{-\\sin(\\frac{\\theta}{2})}{i\\cos(\\frac{\\theta}{2})} = i\\tan(\\frac{\\theta}{2}).\n$$\nThe sensor $S_i^n$ is the magnitude of this complex number. Since the problem focuses on a single mode, we evaluate the sensor for this mode.\n$$\nS(\\theta) = \\left|i\\tan(\\frac{\\theta}{2})\\right| = \\left|\\tan(\\frac{\\theta}{2})\\right|.\n$$\nFor physical waves represented on a grid, we consider $\\theta = k h \\in [0, \\pi]$, for which $\\tan(\\theta/2) \\ge 0$. Therefore,\n$$\nS(\\theta) = \\tan(\\frac{\\theta}{2}).\n$$\nThe equivalent viscosity for this mode is then a function of $\\theta$:\n$$\n\\nu_{\\text{num}}(\\theta) = C_{\\text{vis}}\\,a\\,h\\,S(\\theta) = C_{\\text{vis}}\\,a\\,h\\,\\tan(\\frac{\\theta}{2}).\n$$\n\n**3. Per-step Amplitude Reduction Factor**\n\nThe amplitude evolution of a Fourier mode $u_i^n = \\hat{u}^n e^{i k x_i}$ is described by the amplification factor $G = \\hat{u}^{n+1}/\\hat{u}^n$. Substituting the mode into the discrete scheme:\n$$\nG u_i^n = u_i^n - \\frac{a\\Delta t}{2h}(u_{i+1}^n - u_{i-1}^n) + \\frac{\\Delta t \\nu_{\\text{num}}(\\theta)}{h^2}(u_{i+1}^n - 2u_i^n + u_{i-1}^n).\n$$\nDividing by $u_i^n$ and substituting the discrete operator symbols found in part 2:\n$$\nG = 1 - \\frac{a\\Delta t}{2h}(2i\\sin\\theta) + \\frac{\\Delta t \\nu_{\\text{num}}(\\theta)}{h^2}(-4\\sin^2(\\frac{\\theta}{2})).\n$$\nUsing the CFL number $\\lambda = a\\Delta t/h$:\n$$\nG = 1 - i\\lambda\\sin\\theta - \\frac{4\\Delta t \\nu_{\\text{num}}(\\theta)}{h^2}\\sin^2(\\frac{\\theta}{2}).\n$$\nThe \"amplitude reduction factor caused by the artificial viscosity\" refers to the term that damps the amplitude. The real part of $G$ controls the amplitude change. The per-step fractional amplitude reduction, let's call it $\\mathcal{R}$, is the positive quantity subtracted from $1$ in $\\text{Re}(G)$:\n$$\n\\mathcal{R} = \\frac{4\\Delta t \\nu_{\\text{num}}(\\theta)}{h^2}\\sin^2(\\frac{\\theta}{2}).\n$$\nSubstituting the expression for $\\nu_{\\text{num}}(\\theta)$ from part 2:\n$$\n\\mathcal{R} = \\frac{4\\Delta t}{h^2} \\left(C_{\\text{vis}}\\,a\\,h\\,\\tan(\\frac{\\theta}{2})\\right) \\sin^2(\\frac{\\theta}{2}) = 4 \\left(\\frac{a\\Delta t}{h}\\right) C_{\\text{vis}} \\tan(\\frac{\\theta}{2})\\sin^2(\\frac{\\theta}{2}).\n$$\nThus, the per-step amplitude reduction is:\n$$\n\\mathcal{R} = 4 \\lambda C_{\\text{vis}} \\tan(\\frac{\\theta}{2})\\sin^2(\\frac{\\theta}{2}).\n$$\n\n**4. Maximum Allowable Value of $C_{\\text{vis}}$**\n\nWe are given the constraint that the amplitude reduction per time step for $\\theta = 0.5$ is at most $0.01$. This means $\\mathcal{R} \\le 0.01$.\n$$\n4 \\lambda C_{\\text{vis}} \\tan(\\frac{\\theta}{2})\\sin^2(\\frac{\\theta}{2}) \\le 0.01.\n$$\nWe need to find the maximum allowable value of $C_{\\text{vis}}$, which occurs at the equality:\n$$\nC_{\\text{vis, max}} = \\frac{0.01}{4 \\lambda \\tan(\\frac{\\theta}{2})\\sin^2(\\frac{\\theta}{2})}.\n$$\nThe given parameters are:\n- $\\lambda = 0.7$\n- $\\theta = 0.5$ (radians)\n\nTherefore, $\\theta/2 = 0.25$ radians. We compute the trigonometric functions:\n$$\n\\tan(0.25) \\approx 0.255340758\n$$\n$$\n\\sin(0.25) \\approx 0.247403959\n$$\n$$\n\\sin^2(0.25) \\approx 0.061208611\n$$\nNow, substitute these values into the expression for $C_{\\text{vis, max}}$:\n$$\nC_{\\text{vis, max}} = \\frac{0.01}{4 \\times 0.7 \\times \\tan(0.25) \\times \\sin^2(0.25)}\n$$\n$$\nC_{\\text{vis, max}} = \\frac{0.01}{2.8 \\times 0.255340758 \\times 0.061208611}\n$$\n$$\nC_{\\text{vis, max}} = \\frac{0.01}{0.04375404} \\approx 0.2285461\n$$\nRounding to four significant figures, we get:\n$$\nC_{\\text{vis, max}} \\approx 0.2285.\n$$", "answer": "$$\n\\boxed{0.2285}\n$$", "id": "3346187"}, {"introduction": "This final practice elevates your skills from analyzing existing schemes to designing new ones from first principles. You are tasked with constructing a high-order, upwind-biased finite-difference stencil by imposing specific constraints on its truncation error, derived directly from the goals of the modified equation. Solving this design problem will demonstrate how the principles of modified equation analysis serve as a powerful tool for creating custom numerical methods tailored to have specific, desirable error characteristics, such as suppressed dispersion at higher wavenumbers [@problem_id:3346253].", "problem": "Consider the scalar linear advection equation $u_{t} + a\\,u_{x} = 0$ with constant velocity $a  0$ on a uniform grid with spacing $\\Delta x$. In a one-dimensional upwind-biased finite-difference approximation for $u_{x}$ at node $i$, use a $5$-point backward stencil,\n$$\n\\left(Du\\right)_{i} \\equiv \\frac{1}{\\Delta x}\\sum_{m=0}^{4} a_{m}\\,u_{i-m},\n$$\nwhere the coefficients $a_{m}$ are real constants independent of $i$.\n\nYour task is to design the coefficients $a_{0},a_{1},a_{2},a_{3},a_{4}$ so that:\n- The derivative approximation is consistent and achieves at least third-order accuracy in $\\Delta x$ for smooth $u(x)$.\n- In the Fourier modified-wavenumber expansion of the symbol of $D$, the coefficient of the $(k\\Delta x)^{5}$ term is identically zero, which is equivalent to suppressing the $u_{xxxxx}$ term in the modified equation of the semi-discrete advection operator $u_{t} + a\\,D u = 0$.\n\nProceed from first principles by:\n- Expanding $u_{i-m} = u(x_{i} - m\\Delta x)$ in a Taylor series about $x_{i}$ and imposing the moment conditions required for consistency through third order.\n- Using the requirement on the $(k\\Delta x)^{5}$ term in the modified-wavenumber expansion to set the corresponding moment to zero.\n- Solving for the unique set of coefficients that satisfies these conditions.\n- Verifying, via the modified equation for $u_{t} + a\\,D u = 0$, that the $u_{xxxxx}$ contribution is absent while identifying the leading nonzero higher-derivative term.\n\nExpress your final coefficient vector as a single row matrix $\\big(a_{0},a_{1},a_{2},a_{3},a_{4}\\big)$ with exact rational entries. No rounding is required. The final answer must be given without units.", "solution": "The problem is to determine the coefficients $a_0, a_1, a_2, a_3, a_4$ of a $5$-point one-sided finite-difference operator $D$ that approximates the first derivative $u_x$. The operator is given by\n$$\n(Du)_i = \\frac{1}{\\Delta x}\\sum_{m=0}^{4} a_m u_{i-m}\n$$\nThe coefficients must be chosen such that the approximation is consistent, at least third-order accurate, and a specific higher-order error term is eliminated.\n\nTo determine the conditions on the coefficients $a_m$, we perform a Taylor series expansion of each term $u_{i-m} = u(x_i - m\\Delta x)$ around the point $x=x_i$.\n$$\nu(x_i - m\\Delta x) = u(x_i) - (m\\Delta x) u_x(x_i) + \\frac{(m\\Delta x)^2}{2!} u_{xx}(x_i) - \\frac{(m\\Delta x)^3}{3!} u_{xxx}(x_i) + \\frac{(m\\Delta x)^4}{4!} u_{xxxx}(x_i) - \\frac{(m\\Delta x)^5}{5!} u_{xxxxx}(x_i) + O(\\Delta x^6)\n$$\nSubstituting this into the definition of $(Du)_i$ and collecting terms by the order of the derivative of $u$ at $x_i$ gives:\n\\begin{align*}\n(Du)_i = \\frac{1}{\\Delta x} \\sum_{m=0}^{4} a_m \\left( u_i - m\\Delta x u_{x,i} + \\frac{m^2\\Delta x^2}{2} u_{xx,i} - \\frac{m^3\\Delta x^3}{6} u_{xxx,i} + \\frac{m^4\\Delta x^4}{24} u_{xxxx,i} - \\frac{m^5\\Delta x^5}{120} u_{xxxxx,i} + \\dots \\right) \\\\\n= \\frac{u_i}{\\Delta x} \\left(\\sum_{m=0}^{4} a_m\\right) + u_{x,i} \\left(-\\sum_{m=0}^{4} m a_m\\right) + u_{xx,i} \\frac{\\Delta x}{2} \\left(\\sum_{m=0}^{4} m^2 a_m\\right) \\\\\n\\quad - u_{xxx,i} \\frac{\\Delta x^2}{6} \\left(\\sum_{m=0}^{4} m^3 a_m\\right) + u_{xxxx,i} \\frac{\\Delta x^3}{24} \\left(\\sum_{m=0}^{4} m^4 a_m\\right) - u_{xxxxx,i} \\frac{\\Delta x^4}{120} \\left(\\sum_{m=0}^{4} m^5 a_m\\right) + O(\\Delta x^5)\n\\end{align*}\nFor $(Du)_i$ to be a consistent approximation of $u_{x,i}$, the zeroth-order term in $u$ must vanish and the coefficient of $u_{x,i}$ must be $1$. This yields the first two conditions:\n1. Coefficient of $u_i/(\\Delta x)$: $\\sum_{m=0}^{4} a_m = 0$\n2. Coefficient of $u_{x,i}$: $-\\sum_{m=0}^{4} m a_m = 1 \\implies \\sum_{m=0}^{4} m a_m = -1$\n\nFor the scheme to be at least third-order accurate, the truncation error must be $O(\\Delta x^3)$. This requires the coefficients of the $\\Delta x u_{xx,i}$ and $\\Delta x^2 u_{xxx,i}$ terms to be zero.\n3. Coefficient of $u_{xx,i}$: $\\sum_{m=0}^{4} m^2 a_m = 0$\n4. Coefficient of $u_{xxx,i}$: $\\sum_{m=0}^{4} m^3 a_m = 0$\n\nThe final condition relates to the modified wavenumber. The symbol of the operator $D$, which we will call $S(k)$, is obtained by applying $D$ to a Fourier mode $u(x) = \\exp(ikx)$.\n$$\nS(k) = \\frac{1}{\\Delta x} \\sum_{m=0}^{4} a_m \\exp(-imk\\Delta x)\n$$\nThe problem requires that the coefficient of the $(k\\Delta x)^5$ term in the expansion of $S(k)$ is zero. Let $\\theta = k\\Delta x$.\n$$\n\\Delta x S(k) = \\sum_{m=0}^{4} a_m \\exp(-im\\theta) = \\sum_{m=0}^{4} a_m \\sum_{j=0}^{\\infty} \\frac{(-im\\theta)^j}{j!} = \\sum_{j=0}^{\\infty} \\frac{(-i\\theta)^j}{j!} \\sum_{m=0}^{4} m^j a_m\n$$\nThe coefficient of $\\theta^5 = (k\\Delta x)^5$ in the expansion of $\\Delta x S(k)$ is $\\frac{(-i)^5}{5!} \\sum_{m=0}^{4} m^5 a_m$. Setting this to zero implies the fifth condition:\n5. $\\sum_{m=0}^{4} m^5 a_m = 0$\n\nThis condition is equivalent to suppressing the $u_{xxxxx}$ term in the modified equation, as the coefficient of this term in the truncation error is proportional to $\\sum m^5 a_m$.\n\nWe now have a system of $5$ linear equations for the $5$ coefficients $a_0, a_1, a_2, a_3, a_4$:\n\\begin{enumerate}\n    \\item $a_0 + a_1 + a_2 + a_3 + a_4 = 0$\n    \\item $0a_0 + 1a_1 + 2a_2 + 3a_3 + 4a_4 = -1$\n    \\item $0a_0 + 1a_1 + 4a_2 + 9a_3 + 16a_4 = 0$\n    \\item $0a_0 + 1a_1 + 8a_2 + 27a_3 + 64a_4 = 0$\n    \\item $0a_0 + 1a_1 + 32a_2 + 243a_3 + 1024a_4 = 0$\n\\end{enumerate}\nThe last four equations form a $4 \\times 4$ system for $a_1, a_2, a_3, a_4$. Solving this system yields:\n$a_1 = -\\frac{18}{5}$, $a_2 = \\frac{12}{5}$, $a_3 = -\\frac{14}{15}$, $a_4 = \\frac{3}{20}$.\nUsing the first condition $\\sum a_m = 0$:\n$a_0 = -(a_1 + a_2 + a_3 + a_4) = -(-\\frac{18}{5} + \\frac{12}{5} - \\frac{14}{15} + \\frac{3}{20})$.\nUsing a common denominator of $60$:\n$a_0 = -(\\frac{-216 + 144 - 56 + 9}{60}) = -(\\frac{-119}{60}) = \\frac{119}{60}$.\n\nThe coefficients are: $a_0 = \\frac{119}{60}$, $a_1 = -\\frac{18}{5}$, $a_2 = \\frac{12}{5}$, $a_3 = -\\frac{14}{15}$, $a_4 = \\frac{3}{20}$.\n\nWe verify the order of accuracy for the semi-discrete scheme $u_t + aDu = 0$. The truncation error of the spatial discretization is $T_x = (Du)_i - u_{x,i}$.\n$$\nT_x = u_{xxxx,i} \\frac{\\Delta x^3}{24} \\left(\\sum_{m=0}^{4} m^4 a_m\\right) - u_{xxxxx,i} \\frac{\\Delta x^4}{120} \\left(\\sum_{m=0}^{4} m^5 a_m\\right) + O(\\Delta x^5)\n$$\nBy construction, $\\sum m^5 a_m = 0$, so the $u_{xxxxx}$ term is absent. The modified equation is $u_t + au_x = -a T_x$.\nWe compute the coefficient of the leading error term:\n\\begin{align*}\n\\sum_{m=0}^{4} m^4 a_m = (1)^4 a_1 + (2)^4 a_2 + (3)^4 a_3 + (4)^4 a_4 \\\\\n= 1(-\\frac{18}{5}) + 16(\\frac{12}{5}) + 81(-\\frac{14}{15}) + 256(\\frac{3}{20}) \\\\\n= -\\frac{18}{5} + \\frac{192}{5} - \\frac{378}{5} + \\frac{192}{5} \\\\\n= \\frac{-18 + 192 - 378 + 192}{5} = \\frac{-12}{5}\n\\end{align*}\nThe leading truncation error term is proportional to $\\sum m^4 a_m$, which is non-zero. Since the terms for $u_{xx}$ and $u_{xxx}$ were designed to be zero, this confirms the scheme is fourth-order accurate, satisfying the \"at least third-order\" requirement. The leading term in the truncation error is:\n$$\nT_x = \\frac{\\Delta x^3}{24} \\left(-\\frac{12}{5}\\right) u_{xxxx} = -\\frac{\\Delta x^3}{10} u_{xxxx}\n$$\nThe modified equation is $u_t + au_x = a \\frac{\\Delta x^4}{10} u_{xxxx} + O(\\Delta x^5)$. The leading nonzero higher-derivative term is indeed $u_{xxxx}$, and the contribution from $u_{xxxxx}$ is zero as required.\n\nThe final coefficient vector $(a_0, a_1, a_2, a_3, a_4)$ is composed of the calculated exact rational numbers.\n$$\n\\left(\\frac{119}{60}, -\\frac{18}{5}, \\frac{12}{5}, -\\frac{14}{15}, \\frac{3}{20}\\right)\n$$", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{119}{60}  -\\frac{18}{5}  \\frac{12}{5}  -\\frac{14}{15}  \\frac{3}{20} \\end{pmatrix}}\n$$", "id": "3346253"}]}