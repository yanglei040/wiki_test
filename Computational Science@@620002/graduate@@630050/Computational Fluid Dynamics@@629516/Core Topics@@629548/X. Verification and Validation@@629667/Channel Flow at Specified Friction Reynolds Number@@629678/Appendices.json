{"hands_on_practices": [{"introduction": "This first practice addresses a cornerstone of simulating wall-bounded turbulence: computational grid generation. Because the steepest gradients in a turbulent channel flow occur near the wall, accurately capturing the physics requires a grid that is highly refined in this region. This hands-on coding exercise guides you through designing and implementing a hyperbolic stretching law to achieve a precise near-wall resolution in viscous units, a fundamental and highly practical skill for setting up accurate CFD simulations [@problem_id:3299893].", "problem": "You are tasked with designing a wall-normal grid for incompressible plane channel flow at a specified friction Reynolds number. The objective is to enforce a desired near-wall viscous-unit spacing and compute the resulting viscous-unit spacing distribution up to the channel centerline. The final result must be produced by a complete, runnable program.\n\nFundamental base and definitions to use:\n- Computational Fluid Dynamics (CFD) simulations of a plane channel commonly use the friction Reynolds number (denoted as $Re_\\tau$), defined as $Re_\\tau = \\dfrac{u_\\tau h}{\\nu}$, where $u_\\tau$ is the friction velocity, $h$ is the channel half-height, and $\\nu$ is the kinematic viscosity.\n- The viscous-unit wall-normal spacing (denoted as $\\Delta y^+$) is defined by $\\Delta y^+ = \\dfrac{u_\\tau \\Delta y}{\\nu}$.\n- Using $Re_\\tau = \\dfrac{u_\\tau h}{\\nu}$, the relation $\\Delta y^+ = Re_\\tau \\dfrac{\\Delta y}{h}$ follows from nondimensionalization of the wall-normal spacing by the viscous length scale.\n\nDesign requirement:\n- Construct a one-parameter, strictly monotone, wall-normal grid mapping on the half-channel $y \\in [0,h]$ using the hyperbolic-sine stretching law\n$$\ny(\\eta;\\beta) = h\\,\\frac{\\sinh(\\beta\\,\\eta)}{\\sinh(\\beta)} \\quad \\text{for} \\quad \\eta \\in [0,1], \\ \\beta \\ge 0,\n$$\nwhere $\\eta$ is a computational coordinate on $[0,1]$ and $\\beta$ is the stretching parameter to be determined to meet the desired near-wall spacing constraint. This mapping is uniform when $\\beta \\to 0$ and becomes increasingly wall-clustered as $\\beta$ increases. Let the half-channel be discretized into $N_y$ uniform intervals in $\\eta$, i.e., $\\eta_j = \\dfrac{j}{N_y}$ for $j = 0,1,\\dots,N_y$. Define physical positions $y_j = y(\\eta_j;\\beta)$ and set spacings $\\Delta y_j = y_j - y_{j-1}$ for $j = 1,2,\\dots,N_y$. The viscous-unit spacing is then\n$$\n\\Delta y_j^+ = Re_\\tau\\,\\frac{\\Delta y_j}{h}.\n$$\n\nConstraint to satisfy:\n- Given a maximum interval count $N_y$ and a desired first-cell viscous-unit spacing $\\Delta y_1^+$, choose the stretching parameter $\\beta$ that satisfies\n$$\nRe_\\tau\\,\\frac{y\\left(\\tfrac{1}{N_y};\\beta\\right) - y(0;\\beta)}{h} = \\Delta y_1^+,\n$$\nwhich simplifies to the scalar equation\n$$\nRe_\\tau\\,\\frac{\\sinh\\!\\left(\\tfrac{\\beta}{N_y}\\right)}{\\sinh(\\beta)} = \\Delta y_1^+.\n$$\nFeasibility is governed by the monotone behavior of the ratio $\\dfrac{\\sinh(\\beta/N_y)}{\\sinh(\\beta)}$: as $\\beta \\to 0$, this ratio approaches $\\dfrac{1}{N_y}$; as $\\beta \\to \\infty$, it approaches $0$. Therefore, the target is feasible if and only if $0  \\Delta y_1^+ \\le \\dfrac{Re_\\tau}{N_y}$. The uniform grid boundary case $\\Delta y_1^+ = \\dfrac{Re_\\tau}{N_y}$ corresponds to $\\beta = 0$ and yields $\\Delta y_j^+ \\equiv \\dfrac{Re_\\tau}{N_y}$ for all $j$.\n\nTasks:\n1. Implement the hyperbolic-sine stretching law on the half-channel with $N_y$ intervals and determine the parameter $\\beta \\ge 0$ that enforces the desired first-cell viscous spacing $\\Delta y_1^+$ if it is feasible.\n2. Compute the full distribution $\\left[\\Delta y_1^+,\\Delta y_2^+,\\dots,\\Delta y_{N_y}^+\\right]$ from the wall to the centerline.\n3. If the desired $\\Delta y_1^+$ is infeasible, output a boolean indicating infeasibility for that test case.\n\nScientific realism requirements:\n- Treat $\\Delta y^+$ as dimensionless; no physical units are required in the output.\n- The algorithm must robustly handle the uniform-grid boundary case (i.e., $\\beta = 0$) and detect infeasible targets.\n\nTest suite:\n- Use the following test cases, each expressed as a tuple ($Re_\\tau, N_y, \\Delta y_1^+$):\n    - Case A (happy path): $(180, 64, 0.5)$.\n    - Case B (uniform-grid boundary): $\\left(180, 64, \\dfrac{180}{64}\\right)$.\n    - Case C (infeasible target): $(180, 64, 3.0)$.\n    - Case D (moderately high friction Reynolds number): $(550, 192, 0.2)$.\n    - Case E (strong wall clustering): $(1000, 256, 0.05)$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results for all test cases as a comma-separated list enclosed in square brackets.\n- For a feasible case, output the full viscous-unit spacing distribution $\\left[\\Delta y_1^+,\\Delta y_2^+,\\dots,\\Delta y_{N_y}^+\\right]$ rounded to six decimal places.\n- For an infeasible case, output the boolean $False$ in place of the distribution.\n- Example structure: $[\\text{result\\_A},\\text{result\\_B},\\text{result\\_C},\\text{result\\_D},\\text{result\\_E}]$, where each $\\text{result\\_X}$ is either a rounded list of floats or $False$.", "solution": "The problem requires the design of a one-dimensional, wall-normal grid for a plane channel flow simulation. The design must adhere to a specific hyperbolic sine stretching law and satisfy a constraint on the viscous-unit spacing of the first grid cell adjacent to the wall. We will first validate the problem's formulation and then develop a computational algorithm to solve it for the provided test cases.\n\nThe problem is scientifically well-grounded, falling within the standard practices of Computational Fluid Dynamics (CFD) for turbulent wall-bounded flows. The definitions provided, such as the friction Reynolds number, $Re_\\tau = \\dfrac{u_\\tau h}{\\nu}$, and the viscous-unit spacing, $\\Delta y^+ = \\dfrac{u_\\tau \\Delta y}{\\nu}$, are fundamental concepts in this field. The use of a hyperbolic stretching function, $y(\\eta;\\beta)$, is a common technique for clustering grid points near solid boundaries where velocity gradients are steep. The problem is mathematically well-posed, providing a clear objective, all necessary equations, and a well-defined feasibility condition. There are no contradictions, ambiguities, or factual errors. Therefore, the problem is deemed valid and a solution will be constructed.\n\nThe solution process is divided into three main steps:\n1.  Verifying the feasibility of the requested near-wall spacing.\n2.  Determining the stretching parameter, $\\beta$, by solving a nonlinear scalar equation.\n3.  Computing the full viscous-unit spacing distribution, $[\\Delta y_1^+, \\Delta y_2^+, \\dots, \\Delta y_{N_y}^+]$, using the determined $\\beta$.\n\n**1. Feasibility Analysis**\n\nThe relationship between the first cell's viscous spacing, $\\Delta y_1^+$, and the stretching parameter, $\\beta$, is given by the equation:\n$$\nRe_\\tau\\,\\frac{\\sinh\\!\\left(\\frac{\\beta}{N_y}\\right)}{\\sinh(\\beta)} = \\Delta y_1^+\n$$\nLet's analyze the function $f(\\beta) = \\dfrac{\\sinh(\\beta/N_y)}{\\sinh(\\beta)}$ for $\\beta \\ge 0$.\nUsing the Taylor series expansion $\\sinh(x) \\approx x$ for small $x$, the limit as $\\beta \\to 0$ is:\n$$\n\\lim_{\\beta \\to 0} f(\\beta) = \\lim_{\\beta \\to 0} \\frac{\\beta/N_y}{\\beta} = \\frac{1}{N_y}\n$$\nThis corresponds to a uniform grid, where each of the $N_y$ cells has a thickness of $\\Delta y = h/N_y$, resulting in a constant viscous spacing of $\\Delta y^+ = Re_\\tau (h/N_y)/h = Re_\\tau/N_y$.\nFor large $\\beta$, using the asymptotic behavior $\\sinh(x) \\approx \\frac{1}{2}e^x$ for $x > 0$:\n$$\n\\lim_{\\beta \\to \\infty} f(\\beta) = \\lim_{\\beta \\to \\infty} \\frac{\\frac{1}{2}e^{\\beta/N_y}}{\\frac{1}{2}e^{\\beta}} = \\lim_{\\beta \\to \\infty} e^{\\beta(1/N_y - 1)} = 0 \\quad (\\text{since } N_y \\ge 1)\n$$\nThe function $f(\\beta)$ is monotonically decreasing for $\\beta>0$. Consequently, for the equation to have a solution for $\\beta \\ge 0$, the target value for the ratio, $\\Delta y_1^+ / Re_\\tau$, must lie in the range $(0, 1/N_y]$. This gives the feasibility condition stated in the problem:\n$$\n0  \\Delta y_1^+ \\le \\frac{Re_\\tau}{N_y}\n$$\nIf a given target $\\Delta y_1^+$ violates this condition, no real $\\beta \\ge 0$ exists, and the grid specification is infeasible.\n\n**2. Determination of the Stretching Parameter $\\beta$**\n\nFor a feasible target $\\Delta y_1^+$, we must solve for $\\beta$.\n- If $\\Delta y_1^+ = Re_\\tau/N_y$, the grid is uniform, which corresponds to the boundary case $\\beta=0$.\n- If $0  \\Delta y_1^+  Re_\\tau/N_y$, we must find the unique positive root $\\beta > 0$ of the nonlinear transcendental equation:\n$$\ng(\\beta) = \\frac{\\sinh(\\beta/N_y)}{\\sinh(\\beta)} - \\frac{\\Delta y_1^+}{Re_\\tau} = 0\n$$\nThis is a root-finding problem. Given that the function $g(\\beta)$ is monotonic on $\\beta \\in (0, \\infty)$ and that $g(\\beta \\to 0^+) > 0$ and $g(\\beta \\to \\infty)  0$, a unique root is guaranteed to exist. This root can be found efficiently using a numerical algorithm such as Brent's method, which is available in scientific computing libraries like `SciPy`. We will bracket the search for $\\beta$ in a suitable interval, such as $[10^{-9}, 200]$, to ensure the solver finds the positive root.\n\n**3. Computation of the Spacing Distribution**\n\nOnce $\\beta$ is determined, we can compute the entire distribution of viscous-unit spacings, $\\Delta y_j^+$, for $j=1, \\dots, N_y$. The physical position of the $j$-th grid point is $y_j = y(\\eta_j;\\beta)$ where $\\eta_j = j/N_y$. It is more convenient to work with the non-dimensional coordinate $\\tilde{y} = y/h$.\n$$\n\\tilde{y}_j = \\frac{y_j}{h} = \\frac{\\sinh(\\beta\\eta_j)}{\\sinh(\\beta)} = \\frac{\\sinh(\\beta j / N_y)}{\\sinh(\\beta)}\n$$\nThe non-dimensional spacing of the $j$-th cell is $\\Delta\\tilde{y}_j = \\tilde{y}_j - \\tilde{y}_{j-1}$. The viscous-unit spacing is then $\\Delta y_j^+ = Re_\\tau \\Delta\\tilde{y}_j$.\n$$\n\\Delta y_j^+ = Re_\\tau \\left( \\frac{\\sinh(\\beta j / N_y) - \\sinh(\\beta (j-1) / N_y)}{\\sinh(\\beta)} \\right)\n$$\nFor the case $\\beta=0$, this simplifies to the uniform spacing $\\Delta y_j^+ = Re_\\tau/N_y$ for all $j$.\n\nFor numerical robustness, especially when $\\beta$ is large, the computation of $\\tilde{y}_j$ can be rewritten to avoid overflow in the $\\sinh$ function. The identity $\\sinh(x) = (e^x - e^{-x})/2$ leads to:\n$$\n\\frac{\\sinh(A)}{\\sinh(B)} = \\frac{e^A - e^{-A}}{e^B - e^{-B}} = e^{A-B} \\frac{1 - e^{-2A}}{1 - e^{-2B}}\n$$\nApplying this with $A = \\beta j/N_y$ and $B = \\beta$, we get a form that is numerically stable for all $\\beta > 0$:\n$$\n\\tilde{y}_j = e^{\\beta(j/N_y - 1)} \\frac{1 - e^{-2\\beta j/N_y}}{1 - e^{-2\\beta}}\n$$\nThe algorithm proceeds by first generating an array of physical positions $\\tilde{y}_j$ for $j=0, \\dots, N_y$ using this robust formula (or $\\tilde{y}_j = j/N_y$ if $\\beta=0$). Then, the spacings are computed by taking the difference of adjacent positions, $\\Delta\\tilde{y}_j = \\tilde{y}_j - \\tilde{y}_{j-1}$. Finally, these are scaled by $Re_\\tau$ to obtain the desired distribution $\\Delta y_j^+$. The results for each test case are collected, with infeasible cases represented by the boolean `False`.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import root_scalar\n\ndef solve():\n    \"\"\"\n    Computes a wall-normal grid spacing distribution for channel flow.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A (happy path)\n        (180, 64, 0.5),\n        # Case B (uniform-grid boundary)\n        (180, 64, 180.0/64.0),\n        # Case C (infeasible target)\n        (180, 64, 3.0),\n        # Case D (moderately high friction Reynolds number)\n        (550, 192, 0.2),\n        # Case E (strong wall clustering)\n        (1000, 256, 0.05),\n    ]\n\n    results = []\n    \n    # Machine precision for small number comparisons\n    TOL = np.finfo(float).eps * 100\n\n    for case in test_cases:\n        Re_tau, Ny, dy1_plus_target = case\n        Ny = int(Ny) # Ensure Ny is an integer\n\n        # Step 1: Feasibility Check\n        uniform_limit = Re_tau / Ny\n        if not (0  dy1_plus_target = uniform_limit + TOL):\n            results.append(False)\n            continue\n\n        # Step 2: Determine stretching parameter beta\n        beta = 0.0\n        # Check for the uniform grid case with a tolerance\n        if np.isclose(dy1_plus_target, uniform_limit):\n            beta = 0.0\n        else:\n            target_ratio = dy1_plus_target / Re_tau\n            \n            def objective_func(b):\n                # This form can cause overflow for large b, but root_scalar is robust,\n                # and expected beta values are within float64's sinh range.\n                if b  TOL:\n                    # Taylor expansion for small b: (b/Ny) / b = 1/Ny\n                    return 1.0/Ny - target_ratio\n                return np.sinh(b / Ny) / np.sinh(b) - target_ratio\n            \n            # Use a robust bracketing solver. The root is guaranteed to be in (0, inf).\n            # The bracket [TOL, 300] is sufficient for practical cases.\n            try:\n                sol = root_scalar(objective_func, bracket=[TOL, 300], method='brentq')\n                if sol.converged:\n                    beta = sol.root\n                else:\n                    # Should not be reached with valid inputs\n                    results.append(False) \n                    continue\n            except ValueError:\n                # Occurs if signs at bracket endpoints are the same, implies no root in bracket\n                results.append(False)\n                continue\n\n        # Step 3: Compute the spacing distribution\n        eta = np.arange(Ny + 1) / Ny\n        y_norm = np.zeros(Ny + 1)\n\n        if beta  TOL:\n            # Uniform grid case\n            y_norm = eta\n        else:\n            # Numerically stable formula for y_norm for beta  0\n            # y_norm = sinh(beta*eta) / sinh(beta)\n            # which is y_norm = exp(beta*(eta-1)) * (1-exp(-2*beta*eta))/(1-exp(-2*beta))\n            # The calculation is done for eta  0. y_norm[0] is always 0.\n            # eta[0] is 0, so the expression correctly evaluates to 0 for the first point.\n            # To prevent divide-by-zero if somehow beta is large enough for the denominator to be 0\n            # (1-exp(-2*beta)) is only zero for beta=0, which is handled.\n            numerator = 1.0 - np.exp(-2.0 * beta * eta)\n            denominator = 1.0 - np.exp(-2.0 * beta)\n            prefactor = np.exp(beta * (eta - 1.0))\n            y_norm = prefactor * numerator / denominator\n\n        dy_norm = np.diff(y_norm)\n        dy_plus_dist = Re_tau * dy_norm\n        \n        # Round the final distribution\n        rounded_dist = [round(val, 6) for val in dy_plus_dist]\n        results.append(rounded_dist)\n\n    # Format the final output string as specified\n    string_results = []\n    for r in results:\n        if isinstance(r, bool):\n            string_results.append(str(r))\n        else:\n            # Format list of floats to \"[f1,f2,...,fN]\"\n            s = f\"[{','.join([f'{val:.6f}' for val in r])}]\"\n            string_results.append(s)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(string_results)}]\")\n\nsolve()\n```", "id": "3299893"}, {"introduction": "Once a computational grid is designed, the next logical step is to determine a stable time step for the simulation, especially when using an explicit time-integration scheme. This practice demonstrates the power and utility of wall-unit scaling, tasking you with transforming the fundamental advection (CFL) and diffusion stability constraints into a dimensionless form. This exercise reveals how stability criteria can be understood universally in terms of wall units, independent of the specific physical dimensions or fluid properties of the channel flow specified by $Re_{\\tau}$ [@problem_id:3299790].", "problem": "Consider an incompressible plane channel flow of a Newtonian fluid with half-channel height $\\delta$ and kinematic viscosity $\\nu$. The flow is simulated using an explicit time-integration scheme on a uniform Cartesian grid with spacings $\\Delta x$, $\\Delta y$, and $\\Delta z$, and time step $\\Delta t$. The friction Reynolds number is specified as $Re_{\\tau}$, defined by $Re_{\\tau} = u_{\\tau} \\delta / \\nu$, where $u_{\\tau}$ is the friction velocity. Let the stability limits for the explicit scheme be governed by two standard bounds: the Courant–Friedrichs–Lewy (CFL) advection constraint and the viscous diffusion constraint, expressed in physical units as an advection bound of the form\n$$\n\\max_{\\Omega}\\left(\\frac{|u|\\,\\Delta t}{\\Delta x} + \\frac{|v|\\,\\Delta t}{\\Delta y} + \\frac{|w|\\,\\Delta t}{\\Delta z}\\right) \\leq C_{\\mathrm{CFL}},\n$$\nand a viscous bound of the form\n$$\n\\nu \\Delta t \\left(\\frac{1}{\\Delta x^{2}} + \\frac{1}{\\Delta y^{2}} + \\frac{1}{\\Delta z^{2}}\\right) \\leq C_{\\nu},\n$$\nwhere $C_{\\mathrm{CFL}}$ and $C_{\\nu}$ are given scheme-dependent constants and $(u,v,w)$ are the velocity components.\n\nStarting from the fundamental definitions of friction velocity $u_{\\tau}$ and friction Reynolds number $Re_{\\tau}$, and the notion of wall units defined through $x^{+} = x u_{\\tau}/\\nu$ and $t^{+} = t u_{\\tau}^{2}/\\nu$, derive the advection and viscous stability constraints in wall units. Then, for the following scientifically realistic parameters,\n- $Re_{\\tau} = 395$,\n- $\\delta = 1.00 \\times 10^{-2}\\,\\mathrm{m}$,\n- $\\nu = 1.00 \\times 10^{-6}\\,\\mathrm{m^{2}/s}$,\n- $\\Delta x = 5.00 \\times 10^{-4}\\,\\mathrm{m}$, $\\Delta y = 1.00 \\times 10^{-4}\\,\\mathrm{m}$, $\\Delta z = 5.00 \\times 10^{-4}\\,\\mathrm{m}$,\n- $\\Delta t = 1.00 \\times 10^{-4}\\,\\mathrm{s}$,\n- $C_{\\mathrm{CFL}} = 0.5$, $C_{\\nu} = 0.2$,\n- instantaneous maxima over the domain at the current step: $\\max_{\\Omega}|u| = 0.70\\,\\mathrm{m/s}$, $\\max_{\\Omega}|v| = 0.10\\,\\mathrm{m/s}$, $\\max_{\\Omega}|w| = 0.30\\,\\mathrm{m/s}$,\ncompute the wall-unit spacings and time step $(\\Delta x^{+}, \\Delta y^{+}, \\Delta z^{+}, \\Delta t^{+})$. Express your final numerical answer as a row vector and round each entry to four significant figures. The entries are dimensionless and should be reported without units.", "solution": "The problem is valid as it is scientifically grounded in the principles of computational fluid dynamics, well-posed, and objective. It contains all necessary information for a unique solution and does not violate any physical laws or mathematical logic.\n\nThe problem requires a two-part solution: first, the derivation of the stability constraints in wall units, and second, the computation of specific grid and time-step parameters in wall units for a given set of physical parameters.\n\n**Part 1: Derivation of Stability Constraints in Wall Units**\n\nThe normalization in wall units is defined by the friction velocity, $u_{\\tau}$, and the kinematic viscosity, $\\nu$. Any length scale $L$, time scale $T$, and velocity scale $U$ in physical units are related to their wall-unit counterparts ($L^{+}$, $T^{+}$, $U^{+}$) by the following relations:\n$$L^{+} = \\frac{L u_{\\tau}}{\\nu}, \\quad T^{+} = \\frac{T u_{\\tau}^{2}}{\\nu}, \\quad U^{+} = \\frac{U}{u_{\\tau}}$$\nFrom these definitions, we can express the physical quantities in terms of the wall-unit quantities:\n$$L = \\frac{L^{+} \\nu}{u_{\\tau}}, \\quad T = \\frac{T^{+} \\nu}{u_{\\tau}^{2}}, \\quad U = U^{+} u_{\\tau}$$\nThese relations apply to both variables and differential/finite difference elements. Specifically for our grid spacings ($\\Delta x, \\Delta y, \\Delta z$), time step ($\\Delta t$), and velocity components ($u, v, w$), we have:\n$$\\Delta x = \\frac{\\Delta x^{+} \\nu}{u_{\\tau}}, \\quad \\Delta y = \\frac{\\Delta y^{+} \\nu}{u_{\\tau}}, \\quad \\Delta z = \\frac{\\Delta z^{+} \\nu}{u_{\\tau}}$$\n$$\\Delta t = \\frac{\\Delta t^{+} \\nu}{u_{\\tau}^{2}}$$\n$$u = u^{+} u_{\\tau}, \\quad v = v^{+} u_{\\tau}, \\quad w = w^{+} u_{\\tau}$$\n\nNow, we transform each stability constraint.\n\n**Advection (CFL) Constraint:**\nThe constraint in physical units is:\n$$ \\max_{\\Omega}\\left(\\frac{|u|\\,\\Delta t}{\\Delta x} + \\frac{|v|\\,\\Delta t}{\\Delta y} + \\frac{|w|\\,\\Delta t}{\\Delta z}\\right) \\leq C_{\\mathrm{CFL}} $$\nWe substitute the expressions for the physical quantities in terms of their wall-unit counterparts. For the first term inside the parenthesis:\n$$ \\frac{|u|\\,\\Delta t}{\\Delta x} = \\frac{|u^{+} u_{\\tau}| \\left(\\frac{\\Delta t^{+} \\nu}{u_{\\tau}^{2}}\\right)}{\\left(\\frac{\\Delta x^{+} \\nu}{u_{\\tau}}\\right)} = \\frac{|u^{+}| u_{\\tau} \\Delta t^{+} \\nu}{u_{\\tau}^{2}} \\cdot \\frac{u_{\\tau}}{\\Delta x^{+} \\nu} = \\frac{|u^{+}| \\Delta t^{+}}{\\Delta x^{+}} \\frac{u_{\\tau}^{2} \\nu}{u_{\\tau}^{2} \\nu} = \\frac{|u^{+}| \\Delta t^{+}}{\\Delta x^{+}} $$\nThe transformation for the other two terms is identical. Therefore, the advection constraint in wall units is:\n$$ \\max_{\\Omega}\\left(\\frac{|u^{+}|\\,\\Delta t^{+}}{\\Delta x^{+}} + \\frac{|v^{+}|\\,\\Delta t^{+}}{\\Delta y^{+}} + \\frac{|w^{+}|\\,\\Delta t^{+}}{\\Delta z^{+}}\\right) \\leq C_{\\mathrm{CFL}} $$\nThis can be written more compactly as:\n$$ \\Delta t^{+} \\max_{\\Omega}\\left(\\frac{|u^{+}|}{\\Delta x^{+}} + \\frac{|v^{+}|}{\\Delta y^{+}} + \\frac{|w^{+}|}{\\Delta z^{+}}\\right) \\leq C_{\\mathrm{CFL}} $$\n\n**Viscous Diffusion Constraint:**\nThe constraint in physical units is:\n$$ \\nu \\Delta t \\left(\\frac{1}{\\Delta x^{2}} + \\frac{1}{\\Delta y^{2}} + \\frac{1}{\\Delta z^{2}}\\right) \\leq C_{\\nu} $$\nSubstitute the expressions for $\\Delta t$, $\\Delta x$, $\\Delta y$, and $\\Delta z$:\n$$ \\nu \\left(\\frac{\\Delta t^{+} \\nu}{u_{\\tau}^{2}}\\right) \\left(\\frac{1}{\\left(\\frac{\\Delta x^{+} \\nu}{u_{\\tau}}\\right)^{2}} + \\frac{1}{\\left(\\frac{\\Delta y^{+} \\nu}{u_{\\tau}}\\right)^{2}} + \\frac{1}{\\left(\\frac{\\Delta z^{+} \\nu}{u_{\\tau}}\\right)^{2}}\\right) \\leq C_{\\nu} $$\n$$ \\frac{\\nu^2 \\Delta t^{+}}{u_{\\tau}^{2}} \\left(\\frac{u_{\\tau}^{2}}{(\\Delta x^{+})^{2} \\nu^2} + \\frac{u_{\\tau}^{2}}{(\\Delta y^{+})^{2} \\nu^2} + \\frac{u_{\\tau}^{2}}{(\\Delta z^{+})^{2} \\nu^2}\\right) \\leq C_{\\nu} $$\nFactor out the common term $\\frac{u_{\\tau}^{2}}{\\nu^2}$ from the parenthesis:\n$$ \\frac{\\nu^2 \\Delta t^{+}}{u_{\\tau}^{2}} \\frac{u_{\\tau}^{2}}{\\nu^2} \\left(\\frac{1}{(\\Delta x^{+})^{2}} + \\frac{1}{(\\Delta y^{+})^{2}} + \\frac{1}{(\\Delta z^{+})^{2}}\\right) \\leq C_{\\nu} $$\nAll physical parameters cancel out, yielding the viscous constraint in wall units:\n$$ \\Delta t^{+} \\left(\\frac{1}{(\\Delta x^{+})^{2}} + \\frac{1}{(\\Delta y^{+})^{2}} + \\frac{1}{(\\Delta z^{+})^{2}}\\right) \\leq C_{\\nu} $$\n\n**Part 2: Numerical Computation**\n\nThe second part of the problem is to compute the numerical values of the wall-unit spacings and time step $(\\Delta x^{+}, \\Delta y^{+}, \\Delta z^{+}, \\Delta t^{+})$.\nThe given parameters are:\n- $Re_{\\tau} = 395$\n- $\\delta = 1.00 \\times 10^{-2}\\,\\mathrm{m}$\n- $\\nu = 1.00 \\times 10^{-6}\\,\\mathrm{m^{2}/s}$\n- $\\Delta x = 5.00 \\times 10^{-4}\\,\\mathrm{m}$\n- $\\Delta y = 1.00 \\times 10^{-4}\\,\\mathrm{m}$\n- $\\Delta z = 5.00 \\times 10^{-4}\\,\\mathrm{m}$\n- $\\Delta t = 1.00 \\times 10^{-4}\\,\\mathrm{s}$\n\nFirst, we calculate the friction velocity $u_{\\tau}$ from the definition of the friction Reynolds number, $Re_{\\tau} = u_{\\tau} \\delta / \\nu$:\n$$ u_{\\tau} = \\frac{Re_{\\tau} \\nu}{\\delta} = \\frac{395 \\times (1.00 \\times 10^{-6}\\,\\mathrm{m^{2}/s})}{1.00 \\times 10^{-2}\\,\\mathrm{m}} = 3.95 \\times 10^{-2}\\,\\mathrm{m/s} $$\nNow we can compute the dimensionless quantities in wall units.\n\nThe wall-unit spacing $\\Delta x^{+}$ is:\n$$ \\Delta x^{+} = \\frac{\\Delta x u_{\\tau}}{\\nu} = \\frac{(5.00 \\times 10^{-4}\\,\\mathrm{m}) \\times (3.95 \\times 10^{-2}\\,\\mathrm{m/s})}{1.00 \\times 10^{-6}\\,\\mathrm{m^{2}/s}} = 19.75 $$\n\nThe wall-unit spacing $\\Delta y^{+}$ is:\n$$ \\Delta y^{+} = \\frac{\\Delta y u_{\\tau}}{\\nu} = \\frac{(1.00 \\times 10^{-4}\\,\\mathrm{m}) \\times (3.95 \\times 10^{-2}\\,\\mathrm{m/s})}{1.00 \\times 10^{-6}\\,\\mathrm{m^{2}/s}} = 3.95 $$\n\nThe wall-unit spacing $\\Delta z^{+}$ is:\n$$ \\Delta z^{+} = \\frac{\\Delta z u_{\\tau}}{\\nu} = \\frac{(5.00 \\times 10^{-4}\\,\\mathrm{m}) \\times (3.95 \\times 10^{-2}\\,\\mathrm{m/s})}{1.00 \\times 10^{-6}\\,\\mathrm{m^{2}/s}} = 19.75 $$\n\nThe wall-unit time step $\\Delta t^{+}$ is:\n$$ \\Delta t^{+} = \\frac{\\Delta t u_{\\tau}^{2}}{\\nu} = \\frac{(1.00 \\times 10^{-4}\\,\\mathrm{s}) \\times (3.95 \\times 10^{-2}\\,\\mathrm{m/s})^{2}}{1.00 \\times 10^{-6}\\,\\mathrm{m^{2}/s}} = \\frac{1.00 \\times 10^{-4} \\times 1.56025 \\times 10^{-3}}{1.00 \\times 10^{-6}} = 0.156025 $$\n\nThe problem requires rounding each value to four significant figures.\n- $\\Delta x^{+} = 19.75$\n- $\\Delta y^{+} = 3.950$\n- $\\Delta z^{+} = 19.75$\n- $\\Delta t^{+} = 0.1560$\n\nThe final answer is the row vector of these values.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n19.75  3.950  19.75  0.1560\n\\end{pmatrix}\n}\n$$", "id": "3299790"}, {"introduction": "After setting up and (hypothetically) running a simulation, a crucial part of the workflow is to verify that the results are physically consistent. This exercise provides a direct method for this verification by using the Reynolds-Averaged Navier-Stokes (RANS) equations as a tool for data analysis. You will test whether a given set of mean velocity and Reynolds stress profiles satisfies the fundamental momentum balance for a fully developed channel flow, reinforcing the deep connection between simulation data and the governing physical laws [@problem_id:3299836].", "problem": "Consider a statistically steady, incompressible, fully developed turbulent plane channel flow of a Newtonian fluid between two parallel plates separated by a distance of $2\\delta$, with the wall-normal coordinate $y \\in [0,\\delta]$ measured from the lower wall to the centerline. The half-channel height is $\\delta = 10\\ \\mathrm{mm}$, the kinematic viscosity is $\\nu = 1.0\\times 10^{-5}\\ \\mathrm{m^2/s}$, and the friction velocity is $u_{\\tau} = 0.18\\ \\mathrm{m/s}$. The friction Reynolds number is therefore $Re_{\\tau} = u_{\\tau}\\delta/\\nu$. The friction velocity is related to the wall shear stress by $u_{\\tau} = \\sqrt{\\tau_{w}/\\rho}$, where $\\rho$ is the fluid density, and the plane channel is driven by a constant pressure gradient so that the mean total shear stress varies linearly across the half-channel.\n\nYou are given synthetic but self-consistent raw mean and Reynolds-shear profiles as functions of the wall-normal coordinate $y$:\n- Let $\\xi = y/\\delta$ denote the outer coordinate on $[0,1]$.\n- The mean velocity profile is\n$$\nU(y) = u_{\\tau}\\,Re_{\\tau}\\,\\Big[\\xi - \\tfrac{1}{2}(1+a)\\,\\xi^{2} + \\tfrac{a}{3}\\,\\xi^{3}\\Big],\n$$\nwith a shape parameter $a = 0.2$.\n- The Reynolds shear stress profile is\n$$\nu'v'(y) = -\\,u_{\\tau}^{2}\\,a\\,\\xi\\,(1-\\xi).\n$$\n\nDefine the inner (viscous) scaling variables $y^{+} = y\\,u_{\\tau}/\\nu$, $U^{+}(y^{+}) = U/u_{\\tau}$, and the inner-scaled Reynolds shear stress $u'v'^{+}(y/\\delta) = -u'v'/u_{\\tau}^{2}$. Starting from the Reynolds-Averaged Navier–Stokes (RANS) streamwise momentum equation specialized to this configuration and the associated linear total-stress distribution across the half-channel, compute:\n1. The inner-scaled mean profile $U^{+}(y^{+})$ as an analytic function of $y^{+}$.\n2. The inner-scaled Reynolds shear stress $u'v'^{+}(y/\\delta)$ as an analytic function of $\\xi = y/\\delta$.\n3. A scalar inconsistency measure\n$$\nD \\equiv \\max_{0 \\le \\xi \\le 1}\\left|\\,\\frac{\\nu}{u_{\\tau}^{2}}\\frac{dU}{dy} + \\frac{-u'v'}{u_{\\tau}^{2}} - \\left(1-\\xi\\right)\\,\\right|,\n$$\nwhich quantifies the maximum absolute deviation of the normalized total shear stress from the expected linear distribution $1-\\xi$.\n\nReport the numerical value of $D$ and round your answer to four significant figures. Since $D$ is dimensionless, report it without units. Do not report intermediate results; only report the final $D$ value.", "solution": "The problem is first validated to ensure it is scientifically grounded, well-posed, and free of inconsistencies before a solution is attempted.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n-   **Flow Configuration**: Statistically steady, incompressible, fully developed turbulent plane channel flow of a Newtonian fluid.\n-   **Geometry**: Channel half-height $\\delta = 10\\ \\mathrm{mm}$.\n-   **Fluid Properties**: Kinematic viscosity $\\nu = 1.0\\times 10^{-5}\\ \\mathrm{m^2/s}$.\n-   **Flow Parameters**: Friction velocity $u_{\\tau} = 0.18\\ \\mathrm{m/s}$. Friction Reynolds number $Re_{\\tau} = u_{\\tau}\\delta/\\nu$.\n-   **Coordinate System**: Wall-normal coordinate $y \\in [0, \\delta]$. Outer coordinate $\\xi = y/\\delta \\in [0,1]$.\n-   **Mean Velocity Profile**: $U(y) = u_{\\tau}\\,Re_{\\tau}\\,\\Big[\\xi - \\tfrac{1}{2}(1+a)\\,\\xi^{2} + \\tfrac{a}{3}\\,\\xi^{3}\\Big]$, with shape parameter $a = 0.2$.\n-   **Reynolds Shear Stress Profile**: $u'v'(y) = -\\,u_{\\tau}^{2}\\,a\\,\\xi\\,(1-\\xi)$.\n-   **Governing Physics**: The mean total shear stress varies linearly across the half-channel.\n-   **Quantity to be Computed**: The inconsistency measure $D \\equiv \\max_{0 \\le \\xi \\le 1}\\left|\\,\\frac{\\nu}{u_{\\tau}^{2}}\\frac{dU}{dy} + \\frac{-u'v'}{u_{\\tau}^{2}} - \\left(1-\\xi\\right)\\,\\right|$.\n\n**Step 2: Validate Using Extracted Givens**\n-   **Scientific Grounding**: The problem is based on the standard Reynolds-Averaged Navier-Stokes (RANS) framework for turbulent channel flow, a canonical problem in fluid mechanics. All definitions and principles, including the linear total shear stress profile, are fundamental and correct.\n-   **Well-Posedness**: The problem is clearly stated with all necessary data and functional forms provided. The quantity to compute, $D$, is mathematically well-defined.\n-   **Consistency**: The givens are internally consistent. The velocity profile $U(y)$ satisfies the no-slip condition at the wall ($U(0)=0$) and the symmetry condition at the centerline ($\\frac{dU}{dy}|_{y=\\delta}=0$). The Reynolds stress profile $u'v'(y)$ is zero at the wall and centerline, as required. The numerical values are physically realistic for a laboratory-scale turbulent flow ($Re_{\\tau} = \\frac{0.18 \\times 0.01}{1.0 \\times 10^{-5}} = 180$, a common value in turbulence research). The phrase \"synthetic but self-consistent\" suggests the profiles are designed to be consistent with the RANS momentum balance, a hypothesis to be tested by the calculation of $D$.\n-   **No other flaws**: The problem is objective, formalizable, and verifiable. It is not trivial, as it requires the application of calculus and physical principles.\n\n**Verdict**: The problem is deemed valid.\n\n### Solution\n\nThe objective is to compute the inconsistency measure $D$. This measure quantifies the deviation of the given stress profiles from the exact linear total stress distribution required by the RANS equations for this flow. The theoretical total shear stress profile, normalized by the wall shear stress $\\tau_w = \\rho u_{\\tau}^2$, is given by $\\frac{\\tau_{total}}{\\tau_w} = 1 - \\frac{y}{\\delta} = 1-\\xi$.\n\nThe expression for $D$ involves two main components derived from the given profiles: the normalized viscous stress and the normalized Reynolds stress.\n\n**1. Normalized Viscous Stress**\nThe normalized viscous stress is given by the term $\\frac{\\nu}{u_{\\tau}^{2}}\\frac{dU}{dy}$. First, we compute the velocity gradient $\\frac{dU}{dy}$. Using the chain rule with $\\xi = y/\\delta$, we have $\\frac{dU}{dy} = \\frac{dU}{d\\xi} \\frac{d\\xi}{dy}$.\n\nThe derivative of the mean velocity profile $U(y) = u_{\\tau}\\,Re_{\\tau}\\,\\left[\\xi - \\frac{1+a}{2}\\,\\xi^{2} + \\frac{a}{3}\\,\\xi^{3}\\right]$ with respect to $\\xi$ is:\n$$ \\frac{dU}{d\\xi} = u_{\\tau}\\,Re_{\\tau}\\,\\left[1 - (1+a)\\,\\xi + a\\,\\xi^{2}\\right] $$\nSince $\\frac{d\\xi}{dy} = \\frac{1}{\\delta}$, the velocity gradient is:\n$$ \\frac{dU}{dy} = \\frac{u_{\\tau}\\,Re_{\\tau}}{\\delta} \\left[1 - (1+a)\\,\\xi + a\\,\\xi^{2}\\right] $$\nNow, we can compute the normalized viscous stress:\n$$ \\frac{\\nu}{u_{\\tau}^{2}}\\frac{dU}{dy} = \\frac{\\nu}{u_{\\tau}^{2}} \\left( \\frac{u_{\\tau}\\,Re_{\\tau}}{\\delta} \\right) \\left[1 - (1+a)\\,\\xi + a\\,\\xi^{2}\\right] $$\nSubstituting the definition of the friction Reynolds number, $Re_{\\tau} = \\frac{u_{\\tau}\\delta}{\\nu}$:\n$$ \\frac{\\nu}{u_{\\tau}^{2}}\\frac{dU}{dy} = \\frac{\\nu}{u_{\\tau}^{2}} \\frac{u_{\\tau}}{\\delta} \\left(\\frac{u_{\\tau}\\delta}{\\nu}\\right) \\left[1 - (1+a)\\,\\xi + a\\,\\xi^{2}\\right] $$\nThe terms involving flow parameters cancel out:\n$$ \\frac{\\nu}{u_{\\tau}^{2}}\\frac{dU}{dy} = \\left(\\frac{\\nu u_{\\tau}^2 \\delta}{\\nu u_{\\tau}^2 \\delta}\\right) \\left[1 - (1+a)\\,\\xi + a\\,\\xi^{2}\\right] = 1 - (1+a)\\,\\xi + a\\,\\xi^{2} $$\n\n**2. Normalized Reynolds Shear Stress**\nThe normalized Reynolds shear stress is given by the term $\\frac{-u'v'}{u_{\\tau}^{2}}$. We are given the profile $u'v'(y) = -u_{\\tau}^{2}\\,a\\,\\xi\\,(1-\\xi)$.\nSubstituting this into the expression:\n$$ \\frac{-u'v'}{u_{\\tau}^{2}} = \\frac{-\\left(-u_{\\tau}^{2}\\,a\\,\\xi\\,(1-\\xi)\\right)}{u_{\\tau}^{2}} = a\\,\\xi\\,(1-\\xi) = a\\xi - a\\xi^2 $$\n\n**3. Inconsistency Measure, D**\nThe quantity inside the absolute value in the definition of $D$ is the difference between the total stress calculated from the given profiles and the theoretical linear distribution. Let this difference be $f(\\xi)$:\n$$ f(\\xi) = \\left(\\frac{\\nu}{u_{\\tau}^{2}}\\frac{dU}{dy} + \\frac{-u'v'}{u_{\\tau}^{2}}\\right) - (1-\\xi) $$\nSubstituting the expressions derived above:\n$$ f(\\xi) = \\left(1 - (1+a)\\,\\xi + a\\,\\xi^{2}\\right) + \\left(a\\xi - a\\xi^2\\right) - (1-\\xi) $$\nNow, we simplify the expression by collecting terms with like powers of $\\xi$:\n$$ f(\\xi) = 1 - \\xi - a\\xi + a\\xi^2 + a\\xi - a\\xi^2 - 1 + \\xi $$\n$$ f(\\xi) = (1 - 1) + (-\\xi + \\xi) + (-a\\xi + a\\xi) + (a\\xi^2 - a\\xi^2) $$\n$$ f(\\xi) = 0 $$\nThe expression is identically zero for all values of $\\xi \\in [0, 1]$. This means the \"synthetic\" profiles provided are perfectly self-consistent and satisfy the RANS momentum balance exactly.\n\nThe inconsistency measure $D$ is the maximum of the absolute value of this expression over the domain:\n$$ D = \\max_{0 \\le \\xi \\le 1} |f(\\xi)| = \\max_{0 \\le \\xi \\le 1} |0| = 0 $$\nThe result is an exact analytical zero. The problem requires the answer to be rounded to four significant figures. For the number zero, this instruction is ambiguous. We represent the result as $0.0000$ to conform to the spirit of the specified precision.", "answer": "$$\\boxed{0.0000}$$", "id": "3299836"}]}