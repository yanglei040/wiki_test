{"hands_on_practices": [{"introduction": "A cornerstone of code verification is confirming that a numerical scheme achieves its theoretical order of accuracy. This practice establishes this fundamental skill using the classic case of plane Poiseuille flow, for which an exact analytical solution is readily available. By deriving the exact pressure gradient and constructing a quantitative error metric, you will learn to perform a systematic grid-refinement study to verify that discretization error decreases at the expected rate, a critical first step in building confidence in any CFD code [@problem_id:3295560].", "problem": "You are asked to formalize and implement a verification metric for fully developed laminar channel flow in the context of Computational Fluid Dynamics (CFD), and then to use that metric to infer the numerical order of accuracy from pressure residuals across a sequence of grid refinements. The flow is an incompressible, steady, Newtonian plane Poiseuille flow between two infinite parallel plates separated by a full height of $2h$, where $h$ is the half-height. The fundamental base for this problem is the conservation of mass and momentum embodied in the incompressible Navier–Stokes equations, no-slip boundary conditions at the walls, and the definition of fully developed flow. Your tasks are as follows:\n\n$1.$ From first principles, start with the incompressible Navier–Stokes equations and the fully developed assumptions to derive the exact relation between the constant pressure drop per unit length $dp/dx$ and the mean axial velocity $U_{\\text{mean}}$, given the dynamic viscosity $\\mu$ and the channel half-height $h$. You must express $dp/dx$ in $\\text{Pa}/\\text{m}$.\n\n$2.$ Define a dimensionless verification metric based on the linear pressure drop: construct\n$$\nR_h \\equiv \\frac{\\left| \\left(\\frac{dp}{dx}\\right)_{\\text{num},h} - \\left(\\frac{dp}{dx}\\right)_{\\text{exact}} \\right|}{\\left|\\left(\\frac{dp}{dx}\\right)_{\\text{exact}}\\right|},\n$$\nwhere $\\left(\\frac{dp}{dx}\\right)_{\\text{num},h}$ is the numerical estimate of the pressure gradient obtained from a discrete pressure field on a grid with spacing $\\Delta x_h$, and $\\left(\\frac{dp}{dx}\\right)_{\\text{exact}}$ is the exact analytical pressure gradient you derive in Task $1$.\n\n$3.$ Demonstrate how to infer the observed order of accuracy from the scaling of $R_h$ with grid spacing by fitting the model $R_h \\sim C \\, (\\Delta x_h)^p$ in the asymptotic regime, where $p$ is the order of accuracy and $C$ is a constant. Use a least-squares fit in logarithmic space to estimate $p$ from a sequence of grid refinements.\n\nTo make the task self-contained and testable, consider synthetic numerical pressure fields $p_{\\text{num}}(x)$ constructed by superimposing a grid-dependent linear bias on the exact linear pressure profile,\n$$\np_{\\text{num}}(x) = p_0 + \\left[\\left(\\frac{dp}{dx}\\right)_{\\text{exact}} + \\alpha \\, (\\Delta x_h)^{p^\\star} \\left|\\left(\\frac{dp}{dx}\\right)_{\\text{exact}}\\right| \\right] x,\n$$\nwhere $p_0$ is an inlet pressure, $\\alpha$ is a dimensionless amplitude parameter, $\\Delta x_h$ is the grid spacing for the given grid, and $p^\\star$ is the imposed (true) order used only to synthesize the numerical data so that $R_h = \\alpha \\, (\\Delta x_h)^{p^\\star}$ exactly. For estimating the numerical pressure gradient $\\left(\\frac{dp}{dx}\\right)_{\\text{num},h}$ from $p_{\\text{num}}(x)$ versus $x$, use a least-squares linear fit on each grid.\n\nYou must implement a program that performs the following for each test case in the suite below:\n$1.$ Compute $\\left(\\frac{dp}{dx}\\right)_{\\text{exact}}$ from $\\mu$, $h$, and $U_{\\text{mean}}$.\n$2.$ For each grid in the refinement set, generate $p_{\\text{num}}(x)$ using the synthetic model above on $N$ equally spaced points over the channel length $L$ (including both endpoints), estimate $\\left(\\frac{dp}{dx}\\right)_{\\text{num},h}$ by least squares, and compute $R_h$.\n$3.$ From the sequence $\\{(\\Delta x_h, R_h)\\}$, infer the observed order $p$ by least-squares regression of $\\log R_h$ versus $\\log \\Delta x_h$.\n$4.$ Return the inferred order $p$ for each test case as a float, rounded to $6$ decimal places.\n\nUse the following test suite. All physical input parameters must be interpreted in the stated units: dynamic viscosity in $\\text{Pa}\\cdot\\text{s}$, lengths in $\\text{m}$, velocities in $\\text{m}/\\text{s}$, pressure in $\\text{Pa}$, and pressure gradient in $\\text{Pa}/\\text{m}$. Angle units are not used in this problem.\n\nTest Case $1$ (happy path):\n- $\\mu = 1.0$,\n- $h = 0.05$,\n- $U_{\\text{mean}} = 0.5$,\n- $L = 2.0$,\n- $p_0 = 101325.0$,\n- $\\alpha = 0.5$,\n- $p^\\star = 2.0$,\n- Grid sizes $N \\in \\{50, 100, 200\\}$.\n\nTest Case $2$ (near first-order behavior):\n- $\\mu = 0.8$,\n- $h = 0.02$,\n- $U_{\\text{mean}} = 0.2$,\n- $L = 1.0$,\n- $p_0 = 101325.0$,\n- $\\alpha = 0.3$,\n- $p^\\star = 1.0$,\n- Grid sizes $N \\in \\{40, 80, 160\\}$.\n\nTest Case $3$ (third-order behavior with smaller amplitude):\n- $\\mu = 1.5$,\n- $h = 0.1$,\n- $U_{\\text{mean}} = 1.0$,\n- $L = 3.0$,\n- $p_0 = 101325.0$,\n- $\\alpha = 0.1$,\n- $p^\\star = 3.0$,\n- Grid sizes $N \\in \\{30, 60, 120\\}$.\n\nTest Case $4$ (coarser grids boundary case):\n- $\\mu = 0.6$,\n- $h = 0.05$,\n- $U_{\\text{mean}} = 0.1$,\n- $L = 2.0$,\n- $p_0 = 101325.0$,\n- $\\alpha = 0.7$,\n- $p^\\star = 2.0$,\n- Grid sizes $N \\in \\{10, 20, 40\\}$.\n\nYour program should produce a single line of output containing the inferred orders as a comma-separated list enclosed in square brackets and rounded to six decimal places (for example, \"[$2.000000$, $1.000000$, $3.000000$, $2.000000$]\" but without dollar signs; the actual output must be numeric strings without LaTeX).\n\nThe final outputs must be floats. No other text should be printed.", "solution": "The problem statement has been validated and is deemed valid. It is scientifically grounded in the principles of fluid mechanics (Navier-Stokes equations, Poiseuille flow), numerically sound in its approach to verification (order of accuracy, grid refinement), and formally well-posed with all necessary data and definitions provided. We may therefore proceed with a complete solution.\n\nThe solution is structured into three main parts as requested: derivation of the analytical pressure gradient, definition of the verification metric, and the methodology for inferring the numerical order of accuracy.\n\n### 1. Derivation of the Exact Pressure Gradient for Plane Poiseuille Flow\n\nWe begin with the steady-state, incompressible Navier-Stokes equations for a Newtonian fluid in a Cartesian coordinate system. Let the flow be in the $x$-direction, between two parallel plates located at $y = \\pm h$. The velocity vector is $\\mathbf{u} = (u, v, w)$.\n\nThe governing equations are:\nConservation of mass (Continuity):\n$$ \\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y} + \\frac{\\partial w}{\\partial z} = 0 $$\nConservation of momentum (Navier-Stokes):\n$$ \\rho \\left( \\frac{\\partial \\mathbf{u}}{\\partial t} + \\mathbf{u} \\cdot \\nabla \\mathbf{u} \\right) = -\\nabla p + \\mu \\nabla^2 \\mathbf{u} $$\n\nWe apply the following assumptions for plane Poiseuille flow:\n1.  **Steady flow**: All time derivatives are zero, $\\frac{\\partial}{\\partial t}(\\cdot) = 0$.\n2.  **Plane flow**: The flow is two-dimensional, so there is no velocity component in the $z$-direction ($w=0$) and no variation in quantities in the $z$-direction, $\\frac{\\partial}{\\partial z}(\\cdot) = 0$.\n3.  **Fully developed flow**: The velocity profile does not change in the streamwise ($x$) direction. This implies $\\frac{\\partial u}{\\partial x} = 0$.\n\nApplying these assumptions, the continuity equation simplifies to $\\frac{\\partial v}{\\partial y} = 0$. Given the no-slip/no-penetration boundary condition at the walls ($v=0$ at $y=\\pm h$), this implies that the wall-normal velocity component $v$ is zero everywhere.\n\nThe momentum equations in the $x$ and $y$ directions become:\n$x$-momentum:\n$$ \\rho \\left( u \\frac{\\partial u}{\\partial x} + v \\frac{\\partial u}{\\partial y} \\right) = -\\frac{\\partial p}{\\partial x} + \\mu \\left( \\frac{\\partial^2 u}{\\partial x^2} + \\frac{\\partial^2 u}{\\partial y^2} \\right) $$\n$y$-momentum:\n$$ \\rho \\left( u \\frac{\\partial v}{\\partial x} + v \\frac{\\partial v}{\\partial y} \\right) = -\\frac{\\partial p}{\\partial y} + \\mu \\left( \\frac{\\partial^2 v}{\\partial x^2} + \\frac{\\partial^2 v}{\\partial y^2} \\right) $$\n\nSubstituting the implications of our assumptions ($v=0$, $\\frac{\\partial u}{\\partial x}=0$):\n$x$-momentum:\n$$ 0 = -\\frac{\\partial p}{\\partial x} + \\mu \\frac{d^2 u}{dy^2} $$\n$y$-momentum:\n$$ 0 = -\\frac{\\partial p}{\\partial y} $$\n\nFrom the $y$-momentum equation, we see that the pressure $p$ does not vary with $y$, so $p = p(x)$. Consequently, the partial derivative $\\frac{\\partial p}{\\partial x}$ can be written as a total derivative $\\frac{dp}{dx}$. The $x$-momentum equation can be rearranged as:\n$$ \\frac{d^2 u}{dy^2} = \\frac{1}{\\mu} \\frac{dp}{dx} $$\nThe left side is a function of $y$ only, while the right side is a function of $x$ only. For this equality to hold, both sides must be equal to a constant. This confirms that the pressure gradient $\\frac{dp}{dx}$ is constant along the channel.\n\nWe integrate the equation twice with respect to $y$:\n$$ \\frac{du}{dy} = \\frac{1}{\\mu} \\frac{dp}{dx} y + C_1 $$\n$$ u(y) = \\frac{1}{2\\mu} \\frac{dp}{dx} y^2 + C_1 y + C_2 $$\nThe integration constants $C_1$ and $C_2$ are determined from the boundary conditions. We impose the no-slip condition, $u=0$, at the walls, $y=\\pm h$:\n1. At $y=h$: $0 = \\frac{1}{2\\mu} \\frac{dp}{dx} h^2 + C_1 h + C_2$\n2. At $y=-h$: $0 = \\frac{1}{2\\mu} \\frac{dp}{dx} h^2 - C_1 h + C_2$\n\nSubtracting the second equation from the first yields $2 C_1 h = 0$, which implies $C_1=0$. Substituting $C_1=0$ into the first equation gives $C_2 = -\\frac{h^2}{2\\mu} \\frac{dp}{dx}$. The velocity profile is thus the well-known parabolic profile:\n$$ u(y) = \\frac{1}{2\\mu} \\frac{dp}{dx} (y^2 - h^2) $$\nFor a positive flow velocity $U_{\\text{mean}} > 0$, the pressure must decrease along $x$, so $\\frac{dp}{dx}$ must be negative.\n\nThe mean axial velocity, $U_{\\text{mean}}$, is defined as the volumetric flow rate per unit area, averaged over the channel cross-section from $y=-h$ to $y=h$:\n$$ U_{\\text{mean}} = \\frac{1}{2h} \\int_{-h}^{h} u(y) \\, dy = \\frac{1}{2h} \\int_{-h}^{h} \\frac{1}{2\\mu} \\frac{dp}{dx} (y^2 - h^2) \\, dy $$\n$$ U_{\\text{mean}} = \\frac{1}{4h\\mu} \\frac{dp}{dx} \\left[ \\frac{y^3}{3} - h^2 y \\right]_{-h}^{h} $$\n$$ U_{\\text{mean}} = \\frac{1}{4h\\mu} \\frac{dp}{dx} \\left( \\left(\\frac{h^3}{3} - h^3\\right) - \\left(\\frac{-h^3}{3} - h^2(-h)\\right) \\right) $$\n$$ U_{\\text{mean}} = \\frac{1}{4h\\mu} \\frac{dp}{dx} \\left( -\\frac{2h^3}{3} - \\frac{2h^3}{3} \\right) = \\frac{1}{4h\\mu} \\frac{dp}{dx} \\left( -\\frac{4h^3}{3} \\right) $$\n$$ U_{\\text{mean}} = -\\frac{h^2}{3\\mu} \\frac{dp}{dx} $$\n\nFinally, we rearrange this expression to solve for the exact pressure gradient, which is the required result for Task $1$:\n$$ \\left(\\frac{dp}{dx}\\right)_{\\text{exact}} = -\\frac{3 \\mu U_{\\text{mean}}}{h^2} $$\n\n### 2. The Verification Metric for Linear Pressure Drop\n\nThe problem defines a dimensionless verification metric $R_h$ to quantify the relative error in the numerically computed pressure gradient:\n$$ R_h \\equiv \\frac{\\left| \\left(\\frac{dp}{dx}\\right)_{\\text{num},h} - \\left(\\frac{dp}{dx}\\right)_{\\text{exact}} \\right|}{\\left|\\left(\\frac{dp}{dx}\\right)_{\\text{exact}}\\right|} $$\nHere, $\\left(\\frac{dp}{dx}\\right)_{\\text{exact}}$ is the analytical value derived above. The term $\\left(\\frac{dp}{dx}\\right)_{\\text{num},h}$ represents the pressure gradient estimated from numerical simulation data on a grid with a characteristic spacing $\\Delta x_h$. In this problem, it is obtained via a least-squares linear fit to the discrete pressure data $p_{\\text{num}}(x)$ along the channel. This metric is fundamental in verification and validation, as it provides a quantitative measure of the discretization error for the pressure gradient.\n\n### 3. Inference of the Observed Order of Accuracy\n\nFor a numerical method that is $p$-th order accurate, the discretization error $E$ is expected to scale with the grid spacing $\\Delta x$ according to the relation $E \\approx C (\\Delta x)^p$ in the asymptotic regime (i.e., for sufficiently small $\\Delta x$), where $C$ is a constant. In our context, the error metric $R_h$ serves as our measure of error $E$, and the grid spacing is $\\Delta x_h$. Thus, we model the behavior of the error as:\n$$ R_h = C (\\Delta x_h)^p $$\nTo determine the observed order of accuracy $p$ from a set of numerical experiments on successively refined grids, we can linearize this power-law relationship by taking the natural logarithm of both sides:\n$$ \\ln(R_h) = \\ln(C) + p \\ln(\\Delta x_h) $$\nThis equation has the form of a straight line, $Y = b + mX$, where $Y = \\ln(R_h)$, $X = \\ln(\\Delta x_h)$, the slope is the order of accuracy $m=p$, and the intercept is $b = \\ln(C)$.\n\nGiven a sequence of grid refinements producing pairs of $(\\Delta x_i, R_i)$, we can compute the corresponding $(\\ln(\\Delta x_i), \\ln(R_i))$ pairs. A linear least-squares regression is then performed on this log-transformed data to find the best-fit slope, which is our estimate of the observed order of accuracy, $p$.\n\nThe implementation will perform these steps for each test case:\n1.  Calculate $\\left(\\frac{dp}{dx}\\right)_{\\text{exact}}$ using the derived formula.\n2.  For a series of grid sizes $N_i$, compute the grid spacing $\\Delta x_i = L / (N_i - 1)$.\n3.  Generate the synthetic numerical pressure data $p_{\\text{num}}(x)$ for each grid.\n4.  Estimate $\\left(\\frac{dp}{dx}\\right)_{\\text{num},h}$ by applying a linear least-squares fit to the $(x, p_{\\text{num}})$ data.\n5.  Compute the corresponding error metric $R_i$.\n6.  Perform a linear least-squares fit on the $(\\ln(\\Delta x_i), \\ln(R_i))$ data points to find the slope $p$.\n\nThe provided synthetic data model ensures that $R_h = \\alpha (\\Delta x_h)^{p^\\star}$ exactly. Consequently, the least-squares fit on the log-transformed data is expected to recover $p = p^\\star$ to within machine precision. This makes the problem a well-defined procedure for verifying the implementation of the order-of-accuracy calculation itself.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of inferring the order of accuracy for a synthetic\n    CFD verification test case based on plane Poiseuille flow.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"mu\": 1.0, \"h\": 0.05, \"U_mean\": 0.5, \"L\": 2.0, \"p0\": 101325.0,\n            \"alpha\": 0.5, \"p_star\": 2.0, \"N_list\": [50, 100, 200]\n        },\n        {\n            \"mu\": 0.8, \"h\": 0.02, \"U_mean\": 0.2, \"L\": 1.0, \"p0\": 101325.0,\n            \"alpha\": 0.3, \"p_star\": 1.0, \"N_list\": [40, 80, 160]\n        },\n        {\n            \"mu\": 1.5, \"h\": 0.1, \"U_mean\": 1.0, \"L\": 3.0, \"p0\": 101325.0,\n            \"alpha\": 0.1, \"p_star\": 3.0, \"N_list\": [30, 60, 120]\n        },\n        {\n            \"mu\": 0.6, \"h\": 0.05, \"U_mean\": 0.1, \"L\": 2.0, \"p0\": 101325.0,\n            \"alpha\": 0.7, \"p_star\": 2.0, \"N_list\": [10, 20, 40]\n        }\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        # Unpack parameters for the current test case\n        mu = case[\"mu\"]\n        h = case[\"h\"]\n        U_mean = case[\"U_mean\"]\n        L = case[\"L\"]\n        p0 = case[\"p0\"]\n        alpha = case[\"alpha\"]\n        p_star = case[\"p_star\"]\n        N_list = case[\"N_list\"]\n\n        # 1. Compute the exact pressure gradient\n        dpdx_exact = -3.0 * mu * U_mean / (h**2)\n\n        log_delta_x_vals = []\n        log_R_h_vals = []\n\n        # 2. Loop through grid refinements\n        for N in N_list:\n            # Grid spacing\n            delta_x = L / (N - 1)\n            \n            # Generate synthetic pressure data\n            # The slope for the synthetic data is constructed with a manufactured error term\n            dpdx_synth = dpdx_exact + alpha * (delta_x**p_star) * abs(dpdx_exact)\n            x_coords = np.linspace(0, L, N)\n            p_num = p0 + dpdx_synth * x_coords\n            \n            # Estimate the numerical pressure gradient by least-squares linear fit\n            # For perfectly linear data, polyfit recovers the slope exactly.\n            dpdx_num_h, _ = np.polyfit(x_coords, p_num, 1)\n\n            # Compute the verification metric R_h\n            if abs(dpdx_exact) == 0:\n                # Avoid division by zero, although not expected in these test cases\n                # If dpdx_exact is 0, U_mean must be 0, and the error is absolute\n                R_h = abs(dpdx_num_h - dpdx_exact)\n            else:\n                R_h = abs(dpdx_num_h - dpdx_exact) / abs(dpdx_exact)\n            \n            # Collect data for log-log regression\n            log_delta_x_vals.append(np.log(delta_x))\n            log_R_h_vals.append(np.log(R_h))\n\n        # 3. Infer the observed order of accuracy p\n        # Fit a line (polynomial of degree 1) to the log-log data.\n        # The slope of this line is the order of accuracy.\n        p, _ = np.polyfit(log_delta_x_vals, log_R_h_vals, 1)\n        \n        results.append(p)\n\n    # 4. Format and print the final output\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "3295560"}, {"introduction": "Effective verification goes beyond checking the final output; it involves interrogating the core algorithms of a solver. This exercise focuses on the projection method, a vital component of most modern incompressible flow solvers responsible for enforcing the divergence-free constraint on the velocity field. Using a manufactured solution on a staggered Marker-and-Cell (MAC) grid, you will verify that the discrete divergence, gradient, and Poisson solver operators work in concert to produce a numerically divergence-free velocity field, a property essential for the stability and accuracy of the simulation [@problem_id:3295581].", "problem": "Design and implement a self-contained program that verifies, on a two-dimensional uniform Marker-and-Cell (MAC) grid, that a staggered-grid projection method produces a numerically divergence-free velocity field by measuring the discrete $L_{2}$ norm of the divergence and studying its decay under grid refinement. Begin from the incompressibility constraint and finite-volume balance on a control volume, and use consistent second-order central differences. Constrain the test to a periodic square domain to isolate the effect of the discrete operators.\n\nThe fundamental base to use is:\n- The incompressibility constraint $ \\nabla \\cdot \\mathbf{u} = 0 $ for an incompressible fluid.\n- The projection method idea: given an intermediate face-centered velocity $ \\mathbf{u}^{\\star} $, obtain a corrected velocity $ \\mathbf{u} = \\mathbf{u}^{\\star} - \\nabla p $ such that $ \\nabla \\cdot \\mathbf{u} = 0 $ holds in a discrete sense, where $ p $ solves a Poisson equation induced by the discrete divergence and gradient operators.\n- Consistent second-order central-difference discretizations on a uniform grid.\n\nUse the following universal, mathematically specified setup:\n\n- Domain and units:\n  - Let the computational domain be $ \\Omega = [0, 2\\pi) \\times [0, 2\\pi) $ with periodic boundary conditions in both directions.\n  - All trigonometric arguments are in radians.\n- Staggered (MAC) placement:\n  - Pressure $ p_{i,j} $ is stored at cell centers $ (x_{c,i}, y_{c,j}) = \\big((i+\\frac{1}{2})\\Delta x, (j+\\frac{1}{2})\\Delta y\\big) $ for $ i = 0,\\dots,N_{x}-1 $, $ j = 0,\\dots,N_{y}-1 $, with $ \\Delta x = \\frac{2\\pi}{N_{x}} $, $ \\Delta y = \\frac{2\\pi}{N_{y}} $.\n  - The $ x $-velocity component $ u_{i,j} $ is stored at $ x $-faces $ (x_{u,i}, y_{u,j}) = (i\\Delta x, (j+\\frac{1}{2})\\Delta y) $.\n  - The $ y $-velocity component $ v_{i,j} $ is stored at $ y $-faces $ (x_{v,i}, y_{v,j}) = \\big((i+\\frac{1}{2})\\Delta x, j\\Delta y\\big) $.\n- Manufactured smooth divergence-free field:\n  - Define the analytic velocity field $ \\mathbf{u}_{\\text{exact}}(x,y) = \\big(u_{\\text{exact}}(x,y), v_{\\text{exact}}(x,y)\\big) $ by\n    $$\n    u_{\\text{exact}}(x,y) = -\\cos(x)\\sin(y), \\quad v_{\\text{exact}}(x,y) = \\sin(x)\\cos(y),\n    $$\n    which satisfies $ \\nabla \\cdot \\mathbf{u}_{\\text{exact}} = 0 $ for all $ (x,y) $.\n  - Sample $ \\mathbf{u}_{\\text{exact}} $ on faces to obtain $ \\mathbf{u}^{\\star} $ on the MAC grid.\n- Discrete operators (with periodic wrap-around):\n  - The discrete divergence at cell centers is\n    $$\n    (\\nabla_{h} \\cdot \\mathbf{u})_{i,j} = \\frac{u_{i+1,j} - u_{i,j}}{\\Delta x} + \\frac{v_{i,j+1} - v_{i,j}}{\\Delta y}.\n    $$\n  - The discrete gradient that maps cell-centered pressure to face-centered components is\n    $$\n    (\\nabla_{h} p)^{x}_{i,j} = \\frac{p_{i,j} - p_{i-1,j}}{\\Delta x}, \\quad (\\nabla_{h} p)^{y}_{i,j} = \\frac{p_{i,j} - p_{i,j-1}}{\\Delta y}.\n    $$\n  - The composition $ \\nabla_{h}\\cdot \\nabla_{h} p $ yields the standard five-point discrete Laplacian at cell centers.\n- Discrete projection:\n  - Form the right-hand side $ b = \\nabla_{h} \\cdot \\mathbf{u}^{\\star} $ at cell centers.\n  - Solve the discrete Poisson equation\n    $$\n    \\mathcal{L}_{h} p = b,\n    $$\n    where $ \\mathcal{L}_{h} $ is the five-point periodic Laplacian, enforcing zero-mean solvability by subtracting the mean of $ b $ over the grid. Two solvers are to be used:\n    1. A weighted Jacobi iteration with fixed iteration count $ K $ and relaxation parameter $ \\omega \\in (0,1) $. For the five-point Laplacian, the diagonal is $ a_{ii} = -2/\\Delta x^{2} - 2/\\Delta y^{2} $. One Jacobi sweep computes\n       $$\n       p^{\\text{new}}_{i,j} = (1-\\omega) p^{\\text{old}}_{i,j} + \\omega \\frac{b_{i,j} - \\frac{1}{\\Delta x^{2}}(p^{\\text{old}}_{i+1,j} + p^{\\text{old}}_{i-1,j}) - \\frac{1}{\\Delta y^{2}}(p^{\\text{old}}_{i,j+1} + p^{\\text{old}}_{i,j-1})}{-2/\\Delta x^{2} - 2/\\Delta y^{2}}.\n       $$\n       Maintain zero mean of $ p $ at each iteration.\n    2. A spectral solve using the Fast Fourier Transform (FFT), exploiting periodicity. The discrete Laplacian’s eigenvalues are\n       $$\n       \\lambda(k,\\ell) = -\\frac{4}{\\Delta x^{2}} \\sin^{2}\\left( \\frac{\\pi k}{N_{x}} \\right) - \\frac{4}{\\Delta y^{2}} \\sin^{2}\\left( \\frac{\\pi \\ell}{N_{y}} \\right),\n       $$\n       for $ k=0,\\dots,N_{x}-1 $, $ \\ell=0,\\dots,N_{y}-1 $, with the zero mode set to enforce zero-mean pressure.\n  - Correct the velocity by $ u \\leftarrow u^{\\star} - (\\nabla_{h} p)^{x} $, $ v \\leftarrow v^{\\star} - (\\nabla_{h} p)^{y} $.\n- Discrete $ L_{2} $ norm of divergence:\n  $$\n  \\| \\nabla_{h} \\cdot \\mathbf{u} \\|_{L_{2,h}} = \\left( \\sum_{i=0}^{N_{x}-1} \\sum_{j=0}^{N_{y}-1} \\big( (\\nabla_{h} \\cdot \\mathbf{u})_{i,j} \\big)^{2} \\, \\Delta x \\, \\Delta y \\right)^{1/2}.\n  $$\n\nImplement the following test suite and compute the requested outputs:\n\n- Case A (happy path refinement study with approximate projection):\n  - Use weighted Jacobi with $ \\omega = \\frac{2}{3} $ and $ K = 10 $ iterations.\n  - Grids: $ (N_{x}, N_{y}) \\in \\{(16,16), (32,32), (64,64), (128,128)\\} $.\n  - For each grid, perform the projection and compute the discrete $ L_{2} $ norm of the corrected velocity’s divergence. Then compute the observed refinement rates between successive grids as\n    $$\n    r_{i \\to i+1} = \\log_{2}\\left( \\frac{\\| \\nabla_{h} \\cdot \\mathbf{u} \\|_{L_{2,h}}^{(N_{i})}}{\\| \\nabla_{h} \\cdot \\mathbf{u} \\|_{L_{2,h}}^{(N_{i+1})}} \\right).\n    $$\n- Case B (exact projection consistency check via FFT):\n  - Use the spectral FFT solve on $ (N_{x}, N_{y}) = (64,64) $. Compute the discrete $ L_{2} $ norm of divergence after projection.\n- Case C (edge case anisotropy with approximate projection):\n  - Use weighted Jacobi with $ \\omega = \\frac{2}{3} $, $ K = 10 $, on $ (N_{x}, N_{y}) = (48,64) $. Compute the discrete $ L_{2} $ norm of divergence after projection.\n\nYour program must output a single line containing a comma-separated flat list enclosed in square brackets with the following entries in order:\n- The four discrete $ L_{2} $ norms from Case A on $ (16,16) $, $ (32,32) $, $ (64,64) $, $ (128,128) $.\n- The three observed refinement rates $ r_{16 \\to 32} $, $ r_{32 \\to 64} $, $ r_{64 \\to 128} $.\n- The discrete $ L_{2} $ norm from Case B on $ (64,64) $.\n- The discrete $ L_{2} $ norm from Case C on $ (48,64) $.\n- A boolean indicating whether all three observed refinement rates from Case A exceed $ 1.8 $.\n\nAll numerical values must be output as plain decimal numbers, and the boolean must be exactly either True or False. Angles must be in radians. No physical units are required in the output. The final output must look like\n- Example shape (not actual values): $ [n_{16}, n_{32}, n_{64}, n_{128}, r_{16\\to 32}, r_{32\\to 64}, r_{64\\to 128}, n_{\\text{FFT64}}, n_{\\text{aniso}}, \\text{boolean}] $.", "solution": "The problem is valid. It presents a well-posed and scientifically grounded task from the field of computational fluid dynamics, specifically concerning the verification of a numerical method. The provided parameters, equations, and test cases are complete, consistent, and unambiguous.\n\nThe objective is to verify that a staggered-grid projection method correctly enforces the incompressibility constraint, $\\nabla \\cdot \\mathbf{u} = 0$, for a fluid velocity field $\\mathbf{u}$. The verification is performed by discretizing a known divergence-free analytical velocity field on a Marker-and-Cell (MAC) grid, applying the projection method, and then measuring the discrete divergence of the resulting numerical velocity field. The core principle being tested is that the projection method, by solving a discrete Poisson equation for a pressure-like scalar, can correct an intermediate velocity field to produce a final field that is discretely divergence-free.\n\nHerein, we detail the theoretical and methodological steps to construct the required program.\n\nFirst, we establish the computational grid. The domain is a periodic square $\\Omega = [0, 2\\pi) \\times [0, 2\\pi)$. We discretize this domain into a uniform grid of $N_x \\times N_y$ cells, with grid spacings $\\Delta x = 2\\pi/N_x$ and $\\Delta y = 2\\pi/N_y$. The problem specifies a staggered MAC grid. On this grid, scalar quantities like pressure, $p_{i,j}$, are located at cell centers, $(x_{c,i}, y_{c,j}) = ((i+\\frac{1}{2})\\Delta x, (j+\\frac{1}{2})\\Delta y)$. Vector components, however, are staggered and located at the faces of the control volumes. The $x$-component of velocity, $u_{i,j}$, is at the center of the vertical faces at $(x_{u,i}, y_{u,j}) = (i\\Delta x, (j+\\frac{1}{2})\\Delta y)$, and the $y$-component, $v_{i,j}$, is at the center of the horizontal faces at $(x_{v,i}, y_{v,j}) = ((i+\\frac{1}{2})\\Delta x, j\\Delta y)$. This staggering is a crucial design choice in incompressible flow solvers as it naturally prevents the pressure odd-even decoupling instabilities that can arise on a collocated grid.\n\nThe verification process employs the method of manufactured solutions. We begin with a smooth, analytical velocity field, $\\mathbf{u}_{\\text{exact}}(x,y)$, that is designed to be exactly divergence-free. The specified field is:\n$$\nu_{\\text{exact}}(x,y) = -\\cos(x)\\sin(y), \\quad v_{\\text{exact}}(x,y) = \\sin(x)\\cos(y)\n$$\nThe divergence of this field is $\\nabla \\cdot \\mathbf{u}_{\\text{exact}} = \\frac{\\partial u_{\\text{exact}}}{\\partial x} + \\frac{\\partial v_{\\text{exact}}}{\\partial y} = \\sin(x)\\sin(y) - \\sin(x)\\sin(y) = 0$. This field is sampled at the corresponding face locations on the MAC grid to produce our initial, intermediate velocity field, denoted $\\mathbf{u}^{\\star} = (u^{\\star}, v^{\\star})$. Due to discretization error, the discrete divergence of $\\mathbf{u}^{\\star}$ will not be exactly zero.\n\nThe projection method's goal is to find a correction to $\\mathbf{u}^{\\star}$ to produce a new field $\\mathbf{u}$ that has zero discrete divergence. The procedure is based on the Hodge-Helmholtz decomposition, which states that any vector field can be decomposed into a divergence-free part and the gradient of a scalar potential. We postulate that the final velocity field $\\mathbf{u}$ is related to the intermediate field $\\mathbf{u}^{\\star}$ by subtracting the gradient of a scalar field $p$:\n$$\n\\mathbf{u} = \\mathbf{u}^{\\star} - \\nabla_{h} p\n$$\nHere, $\\nabla_{h}$ is the discrete gradient operator. To enforce the incompressibility constraint on the corrected field, $\\nabla_{h} \\cdot \\mathbf{u} = 0$, we substitute the expression for $\\mathbf{u}$:\n$$\n\\nabla_{h} \\cdot (\\mathbf{u}^{\\star} - \\nabla_{h} p) = 0 \\implies \\nabla_{h} \\cdot \\mathbf{u}^{\\star} - \\nabla_{h} \\cdot \\nabla_{h} p = 0\n$$\nThis yields a discrete Poisson equation for the pressure-like quantity $p$:\n$$\n\\mathcal{L}_{h} p = b\n$$\nwhere $\\mathcal{L}_{h} \\equiv \\nabla_{h} \\cdot \\nabla_{h}$ is the discrete Laplacian operator, and the right-hand side (RHS) is the discrete divergence of the intermediate field, $b \\equiv \\nabla_{h} \\cdot \\mathbf{u}^{\\star}$. The discrete operators are defined using second-order central differences, consistent with a finite-volume formulation. For a cell $(i,j)$:\n- Discrete divergence: $(\\nabla_{h} \\cdot \\mathbf{u})_{i,j} = \\frac{u_{i+1,j} - u_{i,j}}{\\Delta x} + \\frac{v_{i,j+1} - v_{i,j}}{\\Delta y}$\n- Discrete gradient: $(\\nabla_{h} p)^{x}_{i,j} = \\frac{p_{i,j} - p_{i-1,j}}{\\Delta x}$, $(\\nabla_{h} p)^{y}_{i,j} = \\frac{p_{i,j} - p_{i,j-1}}{\\Delta y}$\n\nCombining these gives the standard five-point stencil for the Laplacian at cell $(i,j)$:\n$$\n\\mathcal{L}_{h} p_{i,j} = \\frac{p_{i+1,j} - 2p_{i,j} + p_{i-1,j}}{\\Delta x^2} + \\frac{p_{i,j+1} - 2p_{i,j} + p_{i,j-1}}{\\Delta y^2}\n$$\n\nFor a periodic domain, the discrete Poisson equation has a solution only if the sum of the RHS over the domain is zero. Summing the discrete divergence $b_{i,j}$ over all cells results in a telescoping sum that is identically zero due to the periodic boundary conditions. However, in floating-point arithmetic, the sum may be a small non-zero value. To ensure solvability, we enforce this condition by subtracting the mean of $b$ from itself. The pressure $p$ is then determined up to an arbitrary constant. We enforce a unique solution by requiring $p$ to have a zero mean.\n\nTwo methods are specified for solving the Poisson equation:\n\n1.  **Weighted Jacobi Iteration**: This is an iterative, approximate solver. For a fixed number of iterations $K$, it does not solve the equation exactly. The update rule blends the previous iterate $p^{\\text{old}}$ with a new estimate derived from the Poisson equation. The error in the solution for $p$ translates directly into a non-zero divergence in the final velocity field $\\mathbf{u}$.\n\n2.  **Spectral (FFT) Solver**: This is a direct, 'exact' solver (to machine precision) that leverages the periodic domain. The discrete Fourier modes are eigenvectors of the discrete Laplacian operator. The solution procedure involves:\n    a. Taking the 2D Fast Fourier Transform (FFT) of the RHS, $\\hat{b} = \\text{FFT}(b)$.\n    b. Dividing each Fourier coefficient $\\hat{b}(k,\\ell)$ by the corresponding eigenvalue $\\lambda(k,\\ell)$ of the Laplacian, yielding $\\hat{p}(k,\\ell) = \\hat{b}(k,\\ell) / \\lambda(k,\\ell)$.\n    c. The zero-frequency mode $(k,\\ell)=(0,0)$ has an eigenvalue $\\lambda(0,0)=0$. The solvability condition ensures $\\hat{b}(0,0)=0$. We set $\\hat{p}(0,0)=0$ to enforce the zero-mean pressure constraint.\n    d. Taking the inverse 2D FFT of $\\hat{p}$ to obtain the solution $p$ in physical space.\n\nOnce $p$ is found, the velocity is corrected: $u_{i,j} = u^{\\star}_{i,j} - (\\nabla_h p)^x_{i,j}$ and $v_{i,j} = v^{\\star}_{i,j} - (\\nabla_h p)^y_{i,j}$.\n\nFinally, to quantify the success of the projection, we compute the discrete $L_2$ norm of the divergence of the final velocity field $\\mathbf{u}$:\n$$\n\\| \\nabla_{h} \\cdot \\mathbf{u} \\|_{L_{2,h}} = \\left( \\sum_{i,j} |(\\nabla_{h} \\cdot \\mathbf{u})_{i,j}|^2 \\Delta x \\Delta y \\right)^{1/2}\n$$\nFor the \"exact\" FFT solver, this norm should be close to machine precision. For the \"approximate\" Jacobi solver, it will be larger but should decrease as the grid is refined. The rate of refinement, $r$, quantifies this decay. The problem asks us to perform this analysis for the specified test cases.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.fft import fft2, ifft2\n\ndef run_projection_test(Nx, Ny, solver_type, K=None, omega=None):\n    \"\"\"\n    Performs a single projection method verification test on a MAC grid.\n\n    Args:\n        Nx (int): Number of grid cells in the x-direction.\n        Ny (int): Number of grid cells in the y-direction.\n        solver_type (str): Type of Poisson solver ('jacobi' or 'fft').\n        K (int, optional): Number of Jacobi iterations. Required for 'jacobi'.\n        omega (float, optional): Jacobi relaxation parameter. Required for 'jacobi'.\n\n    Returns:\n        float: The discrete L2 norm of the divergence of the corrected velocity field.\n    \"\"\"\n    # 1. Domain and Grid Setup\n    Lx, Ly = 2 * np.pi, 2 * np.pi\n    dx, dy = Lx / Nx, Ly / Ny\n\n    # Coordinates for u-velocity (x-faces)\n    xu = np.arange(Nx) * dx\n    yu = (np.arange(Ny) + 0.5) * dy\n    xu_grid, yu_grid = np.meshgrid(xu, yu, indexing='ij')\n\n    # Coordinates for v-velocity (y-faces)\n    xv = (np.arange(Nx) + 0.5) * dx\n    yv = np.arange(Ny) * dy\n    xv_grid, yv_grid = np.meshgrid(xv, yv, indexing='ij')\n\n    # 2. Initialize Intermediate Velocity Field u_star\n    # Sample the exact divergence-free field on the MAC grid faces.\n    u_star = -np.cos(xu_grid) * np.sin(yu_grid)\n    v_star = np.sin(xv_grid) * np.cos(yv_grid)\n\n    # 3. Compute RHS of Poisson Equation\n    # Discrete divergence of u_star. np.roll handles periodic boundaries.\n    # Transpose for consistency with meshgrid 'ij' vs 'xy' indexing.\n    # (u_{i+1,j} - u_{i,j}) / dx\n    div_u = (np.roll(u_star, -1, axis=0) - u_star) / dx\n    # (v_{i,j+1} - v_{i,j}) / dy\n    div_v = (np.roll(v_star, -1, axis=1) - v_star) / dy\n    \n    b = (div_u + div_v).T\n\n    # Enforce solvability condition: zero-mean RHS\n    b -= np.mean(b)\n    \n    # 4. Solve the Poisson Equation: L_h * p = b\n    p = np.zeros((Ny, Nx), dtype=float)\n    if solver_type == 'jacobi':\n        if K is None or omega is None:\n            raise ValueError(\"K and omega must be provided for Jacobi solver.\")\n        \n        diag_coeff = -2.0 / (dx*dx) - 2.0 / (dy*dy)\n        \n        for _ in range(K):\n            # Off-diagonal part of the Laplacian applied to p\n            off_diag_lap_p = (\n                (np.roll(p, -1, axis=1) + np.roll(p, 1, axis=1)) / (dx*dx) +\n                (np.roll(p, -1, axis=0) + np.roll(p, 1, axis=0)) / (dy*dy)\n            )\n            # Jacobi update for L_h * p = b\n            p_update = (b - off_diag_lap_p) / diag_coeff\n            \n            # Apply weighted relaxation\n            p = (1.0 - omega) * p + omega * p_update\n            \n            # Enforce zero-mean pressure at each iteration\n            p -= np.mean(p)\n\n    elif solver_type == 'fft':\n        # Create wavenumbers indices\n        k_indices = np.fft.fftfreq(Nx, d=dx/(2*np.pi))\n        l_indices = np.fft.fftfreq(Ny, d=dy/(2*np.pi))\n        K_grid, L_grid = np.meshgrid(k_indices, l_indices)\n\n        # Eigenvalues of the discrete Laplacian (second-order central difference)\n        lambda_kl = (2 * (np.cos(K_grid * dx) - 1) / (dx*dx) +\n                     2 * (np.cos(L_grid * dy) - 1) / (dy*dy))\n        \n        # FFT of the RHS\n        b_hat = fft2(b)\n        \n        # Solve for p_hat = b_hat / lambda_kl\n        p_hat = np.divide(b_hat, lambda_kl, out=np.zeros_like(b_hat), where=lambda_kl != 0)\n        \n        # Inverse FFT to get p in physical space\n        p = np.real(ifft2(p_hat))\n\n    else:\n        raise ValueError(f\"Unknown solver type: {solver_type}\")\n\n    # 5. Correct the Velocity Field\n    # Discrete gradient of p.\n    # (p_{i,j} - p_{i-1,j}) / dx\n    grad_p_x = (p.T - np.roll(p.T, 1, axis=0)) / dx\n    # (p_{i,j} - p_{i,j-1}) / dy\n    grad_p_y = (p.T - np.roll(p.T, 1, axis=1)) / dy\n    \n    u = u_star - grad_p_x\n    v = v_star - grad_p_y\n\n    # 6. Compute Divergence of the Final Field and its L2 norm\n    final_div_u = (np.roll(u, -1, axis=0) - u) / dx\n    final_div_v = (np.roll(v, -1, axis=1) - v) / dy\n    final_div = (final_div_u + final_div_v).T\n\n    norm_l2 = np.sqrt(np.sum(final_div**2 * dx * dy))\n    \n    return norm_l2\n\ndef solve():\n    \"\"\"\n    Runs the full test suite and prints the final results.\n    \"\"\"\n    # Case A: Jacobi refinement study\n    case_a_configs = [(16, 16), (32, 32), (64, 64), (128, 128)]\n    case_a_norms = [run_projection_test(Nx=n, Ny=n, solver_type='jacobi', K=10, omega=2/3) for n, _ in case_a_configs]\n\n    # Calculate refinement rates for Case A\n    rates = []\n    for i in range(len(case_a_norms) - 1):\n        # r = log2(error_coarse / error_fine)\n        rate = np.log2(case_a_norms[i] / case_a_norms[i+1])\n        rates.append(rate)\n\n    # Case B: FFT \"exact\" projection\n    norm_b = run_projection_test(Nx=64, Ny=64, solver_type='fft')\n\n    # Case C: Jacobi on anisotropic grid\n    norm_c = run_projection_test(Nx=48, Ny=64, solver_type='jacobi', K=10, omega=2/3)\n\n    # Final check: do all rates exceed 1.8?\n    rates_exceed_threshold = all(r > 1.8 for r in rates)\n\n    # Assemble final results list\n    all_results = case_a_norms + rates + [norm_b, norm_c, rates_exceed_threshold]\n\n    # Format and print the final output\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n```", "id": "3295581"}, {"introduction": "Verification techniques must also address the complexities of time-dependent flows. This practice utilizes the Taylor-Green vortex, a canonical benchmark for unsteady viscous dynamics, to explore the nuances of error analysis in a time-evolving system. You will first derive the analytical decay rate of the vortex in the low-Reynolds-number limit and then explore how different error norms, such as the maximum ($L_\\infty$) norm versus an integrated quantity like total kinetic energy, can be strategically employed to diagnose whether numerical inaccuracies originate from insufficient spatial resolution or errors in the temporal integration scheme [@problem_id:3295591].", "problem": "Consider a $2$-dimensional, incompressible, viscous fluid in a periodic square domain of side length $L$, with kinematic viscosity $\\nu > 0$. At time $t=0$, the velocity field is initialized to the Taylor–Green vortex,\n$$\nu(x,y,0) = U_{0}\\,\\sin(k x)\\cos(k y), \\quad v(x,y,0) = -\\,U_{0}\\,\\cos(k x)\\sin(k y),\n$$\nwith $k = 2\\pi/L$ and $U_{0} > 0$. Assume the Reynolds number ($Re$) based on velocity scale $U_{0}$ and length scale $1/k$ satisfies $Re \\ll 1$ so that inertial effects are negligible compared to viscous diffusion over the time scale of interest. Starting from the incompressible Navier–Stokes equations and the divergence-free constraint as the only permissible foundations, and enforcing periodic boundary conditions, derive the closed-form expression for the viscous decay rate $\\sigma$ of the velocity amplitude defined by\n$$\nU(t) = U_{0}\\,\\exp(-\\sigma\\, t),\n$$\nunder the low-$Re$ assumption above. Your derivation must justify any assumptions made about the pressure field and must show the separation of variables in space and time required to obtain the amplitude evolution. \n\nAdditionally, explain which error norms on this benchmark are best suited to reveal primarily spatial inaccuracies versus primarily temporal inaccuracies when verifying a computational fluid dynamics code, and justify your choices from first principles of how these norms weight errors.\n\nReport the decay rate $\\sigma$ as a single closed-form expression in terms of $\\nu$ and $k$ only. Express the decay rate in inverse seconds; round-off or numerical approximation is not required. Do not include units in your final boxed answer.", "solution": "The problem is assessed to be valid. It is a well-posed, scientifically grounded problem from computational fluid dynamics, specifically concerning the verification of numerical methods using a known analytical solution. The setup is self-contained and consistent, and all terms are well-defined.\n\nThe derivation begins with the $2$-dimensional, incompressible Navier–Stokes equations for a fluid with constant density $\\rho$ and kinematic viscosity $\\nu$. The velocity field is $\\mathbf{u} = (u,v)$ and the pressure is $p$.\nThe momentum equation is:\n$$\n\\frac{\\partial \\mathbf{u}}{\\partial t} + (\\mathbf{u} \\cdot \\nabla)\\mathbf{u} = -\\frac{1}{\\rho}\\nabla p + \\nu \\nabla^2 \\mathbf{u}\n$$\nThe incompressibility constraint is:\n$$\n\\nabla \\cdot \\mathbf{u} = 0\n$$\nThe problem states that the Reynolds number, $Re = \\frac{U_0 L_{char}}{\\nu}$, is very small, where the characteristic length scale is $L_{char} = 1/k$. The condition $Re = \\frac{U_0}{k \\nu} \\ll 1$ implies that the inertial term $(\\mathbf{u} \\cdot \\nabla)\\mathbf{u}$ is negligible compared to the viscous term $\\nu \\nabla^2 \\mathbf{u}$. This is because the ratio of their magnitudes scales with $Re$. Applying this low-Reynolds-number approximation simplifies the momentum equation to the unsteady Stokes equation:\n$$\n\\frac{\\partial \\mathbf{u}}{\\partial t} = -\\frac{1}{\\rho}\\nabla p + \\nu \\nabla^2 \\mathbf{u}\n$$\nTo justify the assumption about the pressure field, we take the divergence of the simplified momentum equation:\n$$\n\\nabla \\cdot \\left(\\frac{\\partial \\mathbf{u}}{\\partial t}\\right) = \\nabla \\cdot \\left(-\\frac{1}{\\rho}\\nabla p\\right) + \\nabla \\cdot (\\nu \\nabla^2 \\mathbf{u})\n$$\nAssuming sufficient smoothness, we can interchange the spatial and temporal derivatives:\n$$\n\\frac{\\partial}{\\partial t}(\\nabla \\cdot \\mathbf{u}) = -\\frac{1}{\\rho}\\nabla^2 p + \\nu \\nabla^2(\\nabla \\cdot \\mathbf{u})\n$$\nUsing the incompressibility constraint $\\nabla \\cdot \\mathbf{u} = 0$, the equation reduces to a Laplace equation for the pressure:\n$$\n\\nabla^2 p = 0\n$$\nThe problem specifies a periodic square domain. For a function satisfying Laplace's equation on a fully periodic domain, the only possible solution is a constant, i.e., $p(x,y,t) = C(t)$. A spatially constant pressure has a zero gradient, $\\nabla p = \\mathbf{0}$. Therefore, the pressure gradient term in the momentum equation vanishes.\n\nThe governing equations for the velocity components $u$ and $v$ become uncoupled heat equations:\n$$\n\\frac{\\partial u}{\\partial t} = \\nu \\nabla^2 u, \\quad \\frac{\\partial v}{\\partial t} = \\nu \\nabla^2 v\n$$\nThe problem seeks a solution where the velocity amplitude decays exponentially. This suggests a separation of variables approach, where the spatial structure of the initial condition is modulated by a time-dependent amplitude. We propose a solution of the form:\n$$\nu(x,y,t) = A(t) \\sin(kx)\\cos(ky)\n$$\n$$\nv(x,y,t) = -A(t) \\cos(kx)\\sin(ky)\n$$\nwhere $A(t)$ is the time-dependent amplitude. The initial condition at $t=0$ is $u(x,y,0) = U_0 \\sin(kx)\\cos(ky)$ and $v(x,y,0) = -U_0 \\cos(kx)\\sin(ky)$, which requires $A(0) = U_0$. This proposed form remains divergence-free for all time, as $\\frac{\\partial u}{\\partial x} = A(t)k\\cos(kx)\\cos(ky)$ and $\\frac{\\partial v}{\\partial y} = -A(t)\\cos(kx)(k\\cos(ky))$, so $\\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y} = 0$.\n\nNow, we substitute the proposed form for $u(x,y,t)$ into the heat equation $\\frac{\\partial u}{\\partial t} = \\nu \\nabla^2 u$.\nThe left-hand side is:\n$$\n\\frac{\\partial u}{\\partial t} = \\frac{dA}{dt} \\sin(kx)\\cos(ky)\n$$\nThe right-hand side requires computing the Laplacian of the spatial part:\n$$\n\\nabla^2 u = \\frac{\\partial^2 u}{\\partial x^2} + \\frac{\\partial^2 u}{\\partial y^2}\n$$\n$$\n\\frac{\\partial u}{\\partial x} = A(t) k \\cos(kx)\\cos(ky) \\implies \\frac{\\partial^2 u}{\\partial x^2} = -A(t) k^2 \\sin(kx)\\cos(ky)\n$$\n$$\n\\frac{\\partial u}{\\partial y} = -A(t) k \\sin(kx)\\sin(ky) \\implies \\frac{\\partial^2 u}{\\partial y^2} = -A(t) k^2 \\sin(kx)\\cos(ky)\n$$\nSumming these gives the Laplacian:\n$$\n\\nabla^2 u = (-A(t) k^2 - A(t) k^2) \\sin(kx)\\cos(ky) = -2k^2 A(t) \\sin(kx)\\cos(ky) = -2k^2 u\n$$\nSubstituting these expressions back into the heat equation for $u$:\n$$\n\\frac{dA}{dt} \\sin(kx)\\cos(ky) = \\nu \\left(-2k^2 A(t) \\sin(kx)\\cos(ky)\\right)\n$$\nSince $\\sin(kx)\\cos(ky)$ is not identically zero, we can divide it out to obtain an ordinary differential equation for the amplitude $A(t)$:\n$$\n\\frac{dA}{dt} = -2\\nu k^2 A(t)\n$$\nThis is a first-order linear ODE with the solution $A(t) = C \\exp(-2\\nu k^2 t)$. Using the initial condition $A(0) = U_0$, we find the constant $C=U_0$. Thus, the amplitude evolution is:\n$$\nA(t) = U_0 \\exp(-2\\nu k^2 t)\n$$\nThe problem defines the velocity amplitude evolution as $U(t) = U_0 \\exp(-\\sigma t)$. Comparing this with our derived expression for $A(t)$, we can identify the decay rate $\\sigma$:\n$$\n\\sigma = 2\\nu k^2\n$$\nA similar derivation for the $v$ component yields the same ODE for $A(t)$, confirming the consistency of the solution.\n\nRegarding the second part of the problem, concerning error norms for code verification:\nLet the exact solution be $\\mathbf{u}_{ex}$ and the numerical solution be $\\mathbf{u}_h$. The error is $\\mathbf{e} = \\mathbf{u}_h - \\mathbf{u}_{ex}$.\n\nTo primarily reveal spatial inaccuracies, one should use an error norm that emphasizes the spatial distribution of the error at a fixed point in time, typically the final time $T$. The $L_\\infty$ norm is particularly well-suited for this:\n$$\n||\\mathbf{e}(T)||_{L_\\infty} = \\sup_{(x,y) \\in \\Omega} |\\mathbf{e}(x,y,T)|\n$$\nHere, $\\Omega$ is the square domain. The $L_\\infty$ norm measures the maximum pointwise error in the domain. It is highly sensitive to local errors, such as numerical oscillations (Gibbs phenomena) or incorrect phase and group velocities of wave-like features, which are hallmarks of insufficient spatial resolution or low-order spatial discretization schemes. An error in the spatial structure of the vortex, even if localized, will be directly captured by this norm, whereas an integral norm like $L_2$ might average it out.\n\nTo primarily reveal temporal inaccuracies, one should measure the error in a global, time-integrated quantity that is sensitive to the cumulative effects of the time-stepping algorithm. The total kinetic energy of the flow, $E(t)$, is an excellent candidate.\n$$\nE(t) = \\frac{1}{2}\\int_{\\Omega} |\\mathbf{u}(x,y,t)|^2 \\,d\\Omega\n$$\nFor the exact solution, the energy decays exponentially: $E_{ex}(t) = E_0 \\exp(-2\\sigma t) = E_0 \\exp(-4\\nu k^2 t)$. A numerical simulation produces a discrete energy history $E_h(t)$. The error in the total energy at the final time, $|E_h(T) - E_{ex}(T)|$, is a powerful indicator of temporal accuracy. This is because the rate of energy dissipation is governed by the global balance that the time-integration scheme must preserve. Numerical dissipation (or lack thereof) in the time-stepper will cause $E_h(t)$ to decay at the wrong rate. Since kinetic energy is an integral quantity, it averages out the fine spatial details of the error field, thus isolating the effect of long-term temporal integration on the overall system dynamics.", "answer": "$$\\boxed{2\\nu k^{2}}$$", "id": "3295591"}]}