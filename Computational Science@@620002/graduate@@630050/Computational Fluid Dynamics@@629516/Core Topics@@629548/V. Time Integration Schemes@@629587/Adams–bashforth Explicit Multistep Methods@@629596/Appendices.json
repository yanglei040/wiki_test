{"hands_on_practices": [{"introduction": "In computational fluid dynamics, selecting an appropriate time integration scheme involves a critical trade-off between computational cost and numerical stability. This practice provides a quantitative framework for this decision by comparing a third-order Adams-Bashforth (AB3) method with a third-order Runge-Kutta (RK3) method. By analyzing the stability limits for the canonical linear advection problem, you will determine the most efficient scheme based on the number of required calculations per unit of simulated time, a crucial skill for optimizing large-scale simulations [@problem_id:3288534].", "problem": "Consider the one-dimensional linear advection equation $u_{t} + a\\,u_{x} = 0$ with constant advection speed $a  0$ on a periodic domain of length $L$ discretized by a uniform grid of $N$ points, grid spacing $h = L/N$. Use a first-order upwind finite difference for the spatial discretization to produce a semi-discrete system of ordinary differential equations. Starting from the discrete Fourier mode analysis of the backward difference operator, determine the eigenvalue set of the semi-discrete operator and identify the most restrictive eigenvalue for time stepping with explicit methods.\n\nYou will compare the third-order Adams–Bashforth explicit multistep method (AB3) with the classical three-stage third-order Runge–Kutta method (RK3). Using the linear absolute stability region of each time integrator and the worst-case semi-discrete eigenvalue you obtained, compute the maximum stable timestep $\\Delta t_{\\max}$ for each method. Then, using the fact that the number of Right-Hand Side (RHS) evaluations per timestep is $1$ for AB3 and $3$ for RK3, compute the ratio of computational cost per unit simulated time between AB3 and RK3, defined as\n$$\n\\mathcal{R} \\equiv \\frac{\\text{RHS evaluations per unit simulated time for AB3}}{\\text{RHS evaluations per unit simulated time for RK3}}.\n$$\nAssume that each RHS evaluation has equal computational cost and that startup costs for multistep methods are negligible in the long-time limit.\n\nReport the value of $\\mathcal{R}$ as a single number, rounded to four significant figures. No units are required for the final answer.", "solution": "The problem is valid as it is scientifically grounded in the principles of numerical analysis for partial differential equations, is well-posed, objective, and contains all necessary information to derive a unique solution.\n\nThe problem asks for a comparison of computational efficiency between the third-order Adams–Bashforth (AB3) method and the classical three-stage, third-order Runge–Kutta (RK3) method for the one-dimensional linear advection equation, $u_{t} + a\\,u_{x} = 0$, with a constant advection speed $a  0$. The analysis proceeds in steps: spatial discretization, eigenvalue analysis of the discrete operator, stability analysis of the time integrators, and finally, computation of the cost ratio.\n\n**Step 1: Semi-Discretization and Eigenvalue Analysis**\nThe spatial domain is discretized with a uniform grid of spacing $h$. For the advection equation $u_t = -a u_x$, with $a  0$, the first-order upwind finite difference scheme uses a first-order backward difference for the spatial derivative, $u_x$. At a grid point $x_j$, this is given by:\n$$\nu_x(x_j) \\approx \\frac{u_j - u_{j-1}}{h}\n$$\nwhere $u_j(t)$ is the numerical approximation to $u(x_j, t)$. Substituting this into the PDE yields a system of ordinary differential equations (ODEs), one for each grid point $j$:\n$$\n\\frac{d u_j}{dt} = -\\frac{a}{h} (u_j - u_{j-1})\n$$\nThis is the semi-discrete form of the equation, which can be written in vector form as $\\frac{d\\mathbf{u}}{dt} = \\mathbf{L}\\mathbf{u}$, where $\\mathbf{L}$ is the spatial discretization operator.\n\nTo find the eigenvalues of the operator $\\mathbf{L}$, we perform a discrete Fourier mode analysis. We consider a single Fourier mode as the solution:\n$$\nu_j(t) = \\hat{u}_k(t) \\exp(i k x_j) = \\hat{u}_k(t) \\exp(i k j h)\n$$\nwhere $k$ is the wavenumber and $\\hat{u}_k(t)$ is the time-dependent amplitude of the mode. Substituting this into the semi-discrete equation gives:\n$$\n\\frac{d}{dt} \\left( \\hat{u}_k(t) \\exp(i k j h) \\right) = -\\frac{a}{h} \\left( \\hat{u}_k(t) \\exp(i k j h) - \\hat{u}_k(t) \\exp(i k (j-1) h) \\right)\n$$\nDividing by the common factor $\\exp(i k j h)$ yields an ODE for the modal amplitude $\\hat{u}_k(t)$:\n$$\n\\frac{d \\hat{u}_k}{dt} = -\\frac{a}{h} \\left( 1 - \\exp(-i k h) \\right) \\hat{u}_k(t)\n$$\nThis has the form $\\frac{d\\hat{u}_k}{dt} = \\lambda_k \\hat{u}_k$, where $\\lambda_k$ are the eigenvalues of the operator $\\mathbf{L}$. Let $\\theta = kh$ be the dimensionless wavenumber, which ranges from $0$ to $2\\pi$ for a full representation of grid-resolvable waves. The eigenvalues are given by:\n$$\n\\lambda(\\theta) = -\\frac{a}{h} (1 - \\exp(-i\\theta)) = -\\frac{a}{h} (1 - \\cos\\theta + i\\sin\\theta)\n$$\nThese eigenvalues lie on a circle in the complex plane. To see this, let $\\lambda = \\lambda_x + i\\lambda_y$. Then $\\lambda_x = -\\frac{a}{h}(1-\\cos\\theta)$ and $\\lambda_y = -\\frac{a}{h}\\sin\\theta$. Rearranging, we get $\\lambda_x + \\frac{a}{h} = \\frac{a}{h}\\cos\\theta$ and $\\lambda_y = -\\frac{a}{h}\\sin\\theta$. Squaring and adding these two equations gives:\n$$\n\\left(\\lambda_x + \\frac{a}{h}\\right)^2 + \\lambda_y^2 = \\left(\\frac{a}{h}\\right)^2\n$$\nThis is the equation of a circle with center $(-\\frac{a}{h}, 0)$ and radius $\\frac{a}{h}$ in the complex plane. The eigenvalue spectrum is this circle, which passes through the origin (for $\\theta=0$) and extends to the point $(-2a/h, 0)$ on the negative real axis (for $\\theta=\\pi$).\n\nFor an explicit time integration method to be stable, the quantity $z_k = \\Delta t \\lambda_k$ must lie within the method's absolute stability region, $S$, for all eigenvalues $\\lambda_k$. The set of scaled eigenvalues $\\{z_k\\}$ also forms a circle, defined by $|z + \\nu| = \\nu$, where $\\nu = \\frac{a \\Delta t}{h}$ is the Courant number. For stability, this entire circle must be contained within $S$.\n\nThe most restrictive eigenvalue for time-stepping is the one that first leads to instability as $\\Delta t$ is increased. For stability regions like those of AB and RK methods, which are bounded on the negative real axis, this is typically determined by the eigenvalue furthest from the origin, which lies on the negative real axis. This corresponds to $\\theta = \\pi$:\n$$\n\\lambda_{\\text{worst}} = \\lambda(\\pi) = -\\frac{a}{h} (1 - \\exp(-i\\pi)) = -\\frac{a}{h} (1 - (-1)) = -\\frac{2a}{h}\n$$\n\n**Step 2: Stability Limits and Maximum Timestep**\nThe stability region of an explicit method typically intersects the negative real axis in an interval $[-\\beta, 0]$. The stability of the entire spectrum of scaled eigenvalues requires that the leftmost point of the circle $|z+\\nu|=\\nu$, which is $z = -2\\nu$, must be within this interval. This implies $|-2\\nu| \\le \\beta$, or:\n$$\n2\\nu \\le \\beta \\implies \\nu_{\\max} = \\frac{\\beta}{2}\n$$\nThe maximum stable timestep, $\\Delta t_{\\max}$, is therefore related to $\\beta$ by:\n$$\n\\frac{a \\Delta t_{\\max}}{h} = \\nu_{\\max} = \\frac{\\beta}{2} \\implies \\Delta t_{\\max} = \\frac{h \\beta}{2a}\n$$\nNow we need the stability intercepts $\\beta$ for the AB3 and RK3 methods.\n- For the third-order Adams-Bashforth (AB3) method, the stability boundary on the negative real axis is a standard result, $\\beta_{\\text{AB3}} = \\frac{6}{11}$.\n- For the classical three-stage, third-order Runge-Kutta (RK3) method, the stability function is $R(z) = 1 + z + \\frac{z^2}{2!} + \\frac{z^3}{3!}$. The stability boundary $\\beta_{\\text{RK3}}$ is the positive root of $|R(-x)|=1$, which leads to the equation $x^3 - 3x^2 + 6x - 12 = 0$. The numerical solution is $\\beta_{\\text{RK3}} \\approx 2.512745$.\n\nThe maximum stable timesteps are:\n$$\n\\Delta t_{\\max, \\text{AB3}} = \\frac{h \\beta_{\\text{AB3}}}{2a} = \\frac{h}{2a} \\frac{6}{11} = \\frac{3h}{11a}\n$$\n$$\n\\Delta t_{\\max, \\text{RK3}} = \\frac{h \\beta_{\\text{RK3}}}{2a} \\approx \\frac{h}{2a} (2.512745)\n$$\n\n**Step 3: Computational Cost Ratio**\nThe computational cost is measured by the number of Right-Hand Side (RHS) evaluations per unit of simulated time. For a given method, this is:\n$$\n\\text{Cost} = \\frac{\\text{Number of RHS evaluations per timestep}}{\\text{Simulated time per timestep}} = \\frac{N_{RHS}}{\\Delta t_{\\max}}\n$$\nWe are given $N_{RHS, \\text{AB3}} = 1$ and $N_{RHS, \\text{RK3}} = 3$. The ratio $\\mathcal{R}$ is defined as:\n$$\n\\mathcal{R} = \\frac{\\text{Cost}_{\\text{AB3}}}{\\text{Cost}_{\\text{RK3}}} = \\frac{N_{RHS, \\text{AB3}}/\\Delta t_{\\max, \\text{AB3}}}{N_{RHS, \\text{RK3}}/\\Delta t_{\\max, \\text{RK3}}} = \\frac{1/\\Delta t_{\\max, \\text{AB3}}}{3/\\Delta t_{\\max, \\text{RK3}}} = \\frac{1}{3} \\frac{\\Delta t_{\\max, \\text{RK3}}}{\\Delta t_{\\max, \\text{AB3}}}\n$$\nSubstituting the expressions for the maximum timesteps:\n$$\n\\mathcal{R} = \\frac{1}{3} \\frac{h \\beta_{\\text{RK3}} / (2a)}{h \\beta_{\\text{AB3}} / (2a)} = \\frac{1}{3} \\frac{\\beta_{\\text{RK3}}}{\\beta_{\\text{AB3}}}\n$$\nNow, we substitute the values for $\\beta_{\\text{AB3}}$ and $\\beta_{\\text{RK3}}$:\n$$\n\\mathcal{R} = \\frac{1}{3} \\frac{\\beta_{\\text{RK3}}}{6/11} = \\frac{11 \\beta_{\\text{RK3}}}{18}\n$$\nUsing the numerical value for $\\beta_{\\text{RK3}}$:\n$$\n\\mathcal{R} = \\frac{11 \\times 2.512745}{18} \\approx \\frac{27.640195}{18} \\approx 1.53556638...\n$$\nRounding to four significant figures, the ratio of computational cost is $1.536$. Since $\\mathcal{R} > 1$, the AB3 method is computationally more costly (requires more RHS evaluations per unit of simulated time) than the RK3 method for this specific problem.", "answer": "$$\\boxed{1.536}$$", "id": "3288534"}, {"introduction": "The formal order of accuracy of a numerical method provides a measure of its error but does not reveal the nature of that error. This exercise introduces the powerful technique of modified equation analysis to look deeper into the behavior of the second-order Adams-Bashforth (AB2) method. By deriving the continuous equation that the numerical scheme effectively solves, you will explicitly identify the leading-order numerical dissipation and dispersion terms, gaining a more profound understanding of how the scheme can artificially damp or distort propagating waves [@problem_id:3288552].", "problem": "In computational fluid dynamics (CFD), explicit multistep methods such as the Adams–Bashforth family are frequently analyzed on the linear test ordinary differential equation (ODE) $y'=\\lambda y$ to understand their stability and error propagation characteristics. Consider the second-order Adams–Bashforth method (AB$2$), applied to the test ODE:\n$$\ny_{n+1} \\;=\\; y_n \\;+\\; h\\left(\\tfrac{3}{2} f_n \\;-\\; \\tfrac{1}{2} f_{n-1}\\right), \\quad \\text{with} \\quad f_k \\;=\\; \\lambda\\, y_k,\n$$\nwhere $h$ is the constant timestep, $\\lambda \\in \\mathbb{C}$ is the eigenvalue of the spatially discretized operator, and $y_n \\approx y(t_n)$ with $t_n = n h$. Assume there exists a modified continuous-time ODE of the form\n$$\ny'(t) \\;=\\; \\Lambda(h,\\lambda)\\, y(t),\n$$\nwhose exact solution sampled at $t_n$ reproduces exactly the AB$2$ discrete solution for sufficiently small $h$. Starting from the definitions of the method and the fundamental relationship between the discrete amplification factor and the exact exponential solution of a linear ODE, derive $\\Lambda(h,\\lambda)$ by matching the discrete update with the exact exponential propagation over one timestep and expanding in powers of $z \\equiv h \\lambda$. Work systematically from first principles and do not assume any precomputed modified equation.\n\nThen, for the purely oscillatory case $\\lambda = \\mathrm{i}\\,\\omega$ with real $\\omega$, extract the leading-order dispersion and dissipation contributions by identifying the imaginary and real parts of $\\Lambda(h,\\lambda)$, respectively, in terms of powers of $h \\omega$. You must carry the expansion of $\\Lambda(h,\\lambda)$ through terms of order $h^3$.\n\nProvide your final answer as a single closed-form analytic expression for $\\Lambda(h,\\lambda)$, truncated through order $h^3$. No units are required, and no rounding is needed. Your final answer must be a single expression only.", "solution": "The problem requires the derivation of the operator $\\Lambda(h,\\lambda)$ for the modified continuous-time ordinary differential equation (ODE) $y'(t) = \\Lambda(h,\\lambda) y(t)$, whose exact solution corresponds to the discrete solution generated by the second-order Adams–Bashforth (AB$2$) method. The analysis is to be performed by expanding in powers of $z \\equiv h \\lambda$ up to order $h^3$ in the final expression for $\\Lambda$.\n\nThe second-order Adams–Bashforth method applied to the test ODE $y' = \\lambda y$ is given by:\n$$y_{n+1} = y_n + h\\left(\\frac{3}{2} f_n - \\frac{1}{2} f_{n-1}\\right)$$\nwhere $f_k = \\lambda y_k$. Substituting this into the scheme, we obtain a linear recurrence relation for the discrete solution values $y_k$:\n$$y_{n+1} = y_n + h\\left(\\frac{3}{2} \\lambda y_n - \\frac{1}{2} \\lambda y_{n-1}\\right)$$\n\nThe core assumption of the modified equation approach is that the numerical solution $\\{y_n\\}$ lies exactly on the trajectory of a continuous function $y(t)$ that is the solution to a modified ODE, $y'(t) = \\Lambda y(t)$. The operator $\\Lambda$ depends on the original operator $\\lambda$ and the step size $h$.\n\nThe exact solution to this modified ODE satisfies $y(t_2) = \\exp(\\Lambda(t_2-t_1)) y(t_1)$. Consequently, for a constant step size $h = t_{n+1} - t_n$, the discrete values are related by:\n$$y_{n+1} = y(t_n+h) = \\exp(h\\Lambda) y(t_n) = \\exp(h\\Lambda) y_n$$\n$$y_{n-1} = y(t_n-h) = \\exp(-h\\Lambda) y(t_n) = \\exp(-h\\Lambda) y_n$$\n\nWe substitute these relationships into the AB$2$ recurrence relation:\n$$\\exp(h\\Lambda) y_n = y_n + h\\lambda\\left(\\frac{3}{2} y_n - \\frac{1}{2} \\exp(-h\\Lambda) y_n\\right)$$\nAssuming $y_n \\neq 0$, we can divide by $y_n$ to obtain an implicit equation for $\\Lambda$:\n$$\\exp(h\\Lambda) = 1 + \\frac{3}{2} h\\lambda - \\frac{1}{2} h\\lambda \\exp(-h\\Lambda)$$\nTo solve for $\\Lambda$, we introduce the dimensionless variables $Z = h\\Lambda$ and $z = h\\lambda$. The equation becomes:\n$$\\exp(Z) = 1 + \\frac{3}{2} z - \\frac{1}{2} z \\exp(-Z)$$\nWe now expand the exponential functions in Taylor series.\n$$\\left(1 + Z + \\frac{Z^2}{2!} + \\frac{Z^3}{3!} + \\frac{Z^4}{4!} + \\dots\\right) = 1 + \\frac{3}{2} z - \\frac{1}{2} z \\left(1 - Z + \\frac{Z^2}{2!} - \\frac{Z^3}{3!} + \\dots\\right)$$\nSimplifying the right-hand side gives:\n$$Z + \\frac{Z^2}{2} + \\frac{Z^3}{6} + \\frac{Z^4}{24} + \\dots = z + \\frac{1}{2} zZ - \\frac{1}{4} zZ^2 + \\frac{1}{12} zZ^3 - \\dots$$\nTo find $\\Lambda$ in terms of $\\lambda$, we must find $Z$ as a power series in $z$. We assume the form:\n$$Z = c_1 z + c_2 z^2 + c_3 z^3 + c_4 z^4 + \\dots$$\nSubstituting this series into the equation and equating coefficients for each power of $z$:\n\nFor terms of order $z^1$:\nOn the left-hand side (LHS), the only term is $c_1 z$. On the right-hand side (RHS), the only term is $z$.\n$$c_1 = 1$$\nThis confirms that the method is consistent, as $\\Lambda \\to \\lambda$ when $h \\to 0$.\n\nFor terms of order $z^2$:\nLHS: $c_2 z^2 + \\frac{1}{2}(c_1 z)^2 = (c_2 + \\frac{1}{2}c_1^2)z^2$\nRHS: $\\frac{1}{2} z(c_1 z) = \\frac{1}{2}c_1 z^2$\nEquating coefficients: $c_2 + \\frac{1}{2}c_1^2 = \\frac{1}{2}c_1$. With $c_1=1$, we get $c_2+\\frac{1}{2}=\\frac{1}{2}$, which implies $c_2=0$.\n\nFor terms of order $z^3$:\nLHS: $c_3 z^3 + \\frac{1}{2}(2c_1c_2 z^3) + \\frac{1}{6}(c_1 z)^3 = (c_3 + c_1 c_2 + \\frac{1}{6}c_1^3)z^3$\nRHS: $\\frac{1}{2} z(c_2 z^2) - \\frac{1}{4} z(c_1 z)^2 = (\\frac{1}{2}c_2 - \\frac{1}{4}c_1^2)z^3$\nEquating coefficients: $c_3 + c_1 c_2 + \\frac{1}{6}c_1^3 = \\frac{1}{2}c_2 - \\frac{1}{4}c_1^2$. With $c_1=1$ and $c_2=0$:\n$c_3 + 0 + \\frac{1}{6} = 0 - \\frac{1}{4} \\implies c_3 = -\\frac{1}{4} - \\frac{1}{6} = -\\frac{3+2}{12} = -\\frac{5}{12}$.\n\nFor terms of order $z^4$:\nLHS: $c_4 z^4 + \\frac{1}{2}(c_2^2 + 2c_1c_3)z^4 + \\frac{1}{6}(3c_1^2c_2)z^4 + \\frac{1}{24}c_1^4 z^4 = (c_4 + c_1c_3 + \\frac{1}{2}c_2^2 + \\frac{1}{2}c_1^2c_2 + \\frac{1}{24}c_1^4)z^4$\nRHS: $\\frac{1}{2}z(c_3z^3) - \\frac{1}{4}z(2c_1c_2z^3) + \\frac{1}{12}z(c_1z)^3 = (\\frac{1}{2}c_3 - \\frac{1}{2}c_1c_2 + \\frac{1}{12}c_1^3)z^4$\nEquating coefficients and substituting $c_1=1$, $c_2=0$, $c_3=-5/12$:\nLHS: $c_4 + (1)(-\\frac{5}{12}) + 0 + 0 + \\frac{1}{24} = c_4 - \\frac{10}{24} + \\frac{1}{24} = c_4 - \\frac{9}{24}$\nRHS: $\\frac{1}{2}(-\\frac{5}{12}) - 0 + \\frac{1}{12} = -\\frac{5}{24} + \\frac{2}{24} = -\\frac{3}{24}$\nSo, $c_4 - \\frac{9}{24} = -\\frac{3}{24} \\implies c_4 = \\frac{6}{24} = \\frac{1}{4}$.\n\nCollecting the coefficients, the series for $Z$ is:\n$$Z = z - \\frac{5}{12}z^3 + \\frac{1}{4}z^4 + \\mathcal{O}(z^5)$$\nSubstituting back $Z=h\\Lambda$ and $z=h\\lambda$:\n$$h\\Lambda(h,\\lambda) = h\\lambda - \\frac{5}{12}(h\\lambda)^3 + \\frac{1}{4}(h\\lambda)^4 + \\mathcal{O}(h^5)$$\nDividing by $h$, we obtain the expression for $\\Lambda(h,\\lambda)$ truncated through order $h^3$:\n$$\\Lambda(h,\\lambda) = \\lambda - \\frac{5}{12}h^2\\lambda^3 + \\frac{1}{4}h^3\\lambda^4$$\nThe leading error term is $-\\frac{5}{12}h^2\\lambda^3$, which is consistent with the AB$2$ method being second-order accurate.\n\nFor the purely oscillatory case, we set $\\lambda = i\\omega$, where $\\omega$ is a real frequency and $i^2 = -1$.\n$$\\Lambda(h,i\\omega) = i\\omega - \\frac{5}{12}h^2(i\\omega)^3 + \\frac{1}{4}h^3(i\\omega)^4$$\nUsing the powers of $i$: $i^3 = -i$ and $i^4 = 1$.\n$$\\Lambda(h,i\\omega) = i\\omega - \\frac{5}{12}h^2(-i\\omega^3) + \\frac{1}{4}h^3(\\omega^4)$$\n$$\\Lambda(h,i\\omega) = \\frac{1}{4}h^3\\omega^4 + i\\left(\\omega + \\frac{5}{12}h^2\\omega^3\\right)$$\nThe real and imaginary parts of $\\Lambda$ dictate the behavior of the numerical solution.\nThe real part, $\\text{Re}(\\Lambda) = \\frac{1}{4}h^3\\omega^4$, represents numerical dissipation (or anti-dissipation). Since it is positive, the numerical scheme damps the amplitude of oscillations, with the effect being of order $h^3$. This is the leading-order dissipation contribution.\nThe imaginary part, $\\text{Im}(\\Lambda) = \\omega + \\frac{5}{12}h^2\\omega^3$, represents the modified frequency of oscillation. The term $\\frac{5}{12}h^2\\omega^3$ is the leading-order numerical dispersion error. Since it is positive, high-frequency components (larger $\\omega$) numerically propagate faster than their true speed, leading to a phase error.\n\nThe problem asks for the single closed-form expression for $\\Lambda(h,\\lambda)$ truncated through order $h^3$. This is the expression derived before the specific analysis of the oscillatory case.", "answer": "$$\\boxed{\\lambda - \\frac{5}{12}h^2\\lambda^3 + \\frac{1}{4}h^3\\lambda^4}$$", "id": "3288552"}, {"introduction": "While Adams-Bashforth methods are computationally efficient per step, their relatively small stability regions can be a significant limitation, especially for problems with diffusive terms. This practice explores a common and effective strategy to enhance stability: the predictor-corrector approach. You will construct a Predictor-Evaluate-Correct-Evaluate (PECE) scheme and analyze how it improves the stability limit compared to the original AB2 predictor, demonstrating a practical way to build more robust time-stepping methods for complex CFD problems [@problem_id:3288516].", "problem": "Consider the one-dimensional advection–diffusion initial value problem on a periodic domain,\n$$\n\\frac{\\partial u(x,t)}{\\partial t} + a\\,\\frac{\\partial u(x,t)}{\\partial x} = \\nu\\,\\frac{\\partial^2 u(x,t)}{\\partial x^2}, \\quad x \\in [0,L], \\quad t \\geq 0,\n$$\nwith uniform grid spacing $h$, constant advection speed $a  0$, and kinematic viscosity $\\nu  0$. Use a standard second-order centered finite-difference semi-discretization in space for both the first derivative and the second derivative, resulting in a linear system\n$$\n\\frac{d\\mathbf{u}(t)}{dt} = \\mathbf{A}\\,\\mathbf{u}(t),\n$$\nwhere $\\mathbf{A}$ is the semi-discrete advection–diffusion operator. The discrete Fourier analysis of this operator yields, for each Fourier mode with wavenumber $k$, the eigenvalue\n$$\n\\lambda(k) = -\\,i\\,a\\,\\frac{\\sin(k h)}{h}\\;-\\;4\\,\\nu\\,\\frac{\\sin^2\\!\\left(\\frac{k h}{2}\\right)}{h^2}.\n$$\n\nYou will construct a two-step predictor–evaluate–correct–evaluate (PECE) method using the Adams–Bashforth two-step predictor (AB2) and a trapezoidal (Crank–Nicolson) corrector applied explicitly using the predicted value. Specifically:\n- The predictor is\n$$\n\\mathbf{u}_{n+1}^{p} = \\mathbf{u}_{n} + \\frac{\\Delta t}{2}\\left(3\\,\\mathbf{A}\\,\\mathbf{u}_{n} - \\mathbf{A}\\,\\mathbf{u}_{n-1}\\right).\n$$\n- The corrector is\n$$\n\\mathbf{u}_{n+1} = \\mathbf{u}_{n} + \\frac{\\Delta t}{2}\\left(\\mathbf{A}\\,\\mathbf{u}_{n} + \\mathbf{A}\\,\\mathbf{u}_{n+1}^{p}\\right),\n$$\nwith a final evaluation $\\mathbf{A}\\,\\mathbf{u}_{n+1}^{p}$ used inside the corrector.\n\nStarting from the fundamental definitions of the Adams–Bashforth explicit multistep method and the trapezoidal rule, derive the scalar two-step recurrence for a single Fourier mode $y_n$ satisfying the linear test equation $y'(t) = \\lambda\\,y(t)$, where $\\lambda \\in \\mathbb{C}$ is an eigenvalue of $\\mathbf{A}$, and $y_n \\approx y(t_n)$ with $t_n = n\\,\\Delta t$. Then use linear von Neumann analysis to determine the intersection of the absolute stability boundary with the negative real axis for:\n1. The pure Adams–Bashforth two-step (AB2) method.\n2. The PECE method constructed above.\n\nDefine the nondimensional diffusive number\n$$\nr \\;=\\; \\frac{4\\,\\nu\\,\\Delta t}{h^2}.\n$$\nNoting that the most restrictive Fourier mode for diffusion occurs at $k h = \\pi$ (for which $\\sin^2(k h/2) = 1$ and $\\sin(k h) = 0$), conclude the maximum stable nondimensional diffusive number $r_{\\max}$ for each method from the negative-real-axis intersection $z = \\lambda\\,\\Delta t \\in \\mathbb{R}_{-}$, and compute the ratio\n$$\n\\frac{r_{\\max}^{\\text{PECE}}}{r_{\\max}^{\\text{AB2}}}.\n$$\n\nExpress the final answer as a dimensionless number. If you choose to provide a decimal, do not round; give the exact value. In your derivation, also comment on the formal order of accuracy of the PECE method compared to the pure AB2 method, based on local truncation error analysis for the linear test equation, without using any pre-memorized formulas.", "solution": "The user wants to analyze and compare the stability properties of the two-step Adams–Bashforth (AB2) method and a specific Predictor-Evaluate-Correct-Evaluate (PECE) method for the semi-discretized advection–diffusion equation.\n\n### Problem Validation\n**Step 1: Extract Givens**\n- **PDE:** $\\frac{\\partial u(x,t)}{\\partial t} + a\\,\\frac{\\partial u(x,t)}{\\partial x} = \\nu\\,\\frac{\\partial^2 u(x,t)}{\\partial x^2}$, with $x \\in [0,L]$ (periodic), $t \\geq 0$, $a  0$, $\\nu  0$.\n- **Semi-discretization:** Second-order centered finite differences in space on a uniform grid with spacing $h$, resulting in $\\frac{d\\mathbf{u}(t)}{dt} = \\mathbf{A}\\,\\mathbf{u}(t)$.\n- **Eigenvalue of A:** For a Fourier mode with wavenumber $k$, the eigenvalue is $\\lambda(k) = -\\,i\\,a\\,\\frac{\\sin(k h)}{h}\\;-\\;4\\,\\nu\\,\\frac{\\sin^2\\!\\left(\\frac{k h}{2}\\right)}{h^2}$.\n- **Predictor (AB2):** $\\mathbf{u}_{n+1}^{p} = \\mathbf{u}_{n} + \\frac{\\Delta t}{2}\\left(3\\,\\mathbf{A}\\,\\mathbf{u}_{n} - \\mathbf{A}\\,\\mathbf{u}_{n-1}\\right)$.\n- **Corrector (explicit Trapezoidal):** $\\mathbf{u}_{n+1} = \\mathbf{u}_{n} + \\frac{\\Delta t}{2}\\left(\\mathbf{A}\\,\\mathbf{u}_{n} + \\mathbf{A}\\,\\mathbf{u}_{n+1}^{p}\\right)$.\n- **Nondimensional number:** $r = \\frac{4\\,\\nu\\,\\Delta t}{h^2}$.\n- **Objective:** Determine the intersection of the absolute stability boundary with the negative real axis for the pure AB2 method and the PECE method. Use this to find the maximum stable nondimensional diffusive number, $r_{\\max}$, for each method, considering the most restrictive mode $k h = \\pi$. Finally, compute the ratio $\\frac{r_{\\max}^{\\text{PECE}}}{r_{\\max}^{\\text{AB2}}}$.\n- **Additional Task:** Comment on the formal order of accuracy of the PECE method compared to AB2.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically and mathematically sound. It deals with standard concepts in computational fluid dynamics and numerical analysis: the advection-diffusion equation, finite difference methods, semi-discretization, and von Neumann stability analysis of linear multistep methods. The specific predictor-corrector scheme is well-defined. All required data and definitions are provided, and there are no contradictions. The problem is well-posed, objective, and requires non-trivial mathematical derivations.\n\n**Step 3: Verdict and Action**\nThe problem is deemed **valid**. We proceed to the solution.\n\n### Solution Derivation\nThe stability of the numerical methods is analyzed by applying them to the linear test equation $y'(t) = \\lambda y(t)$, where $\\lambda \\in \\mathbb{C}$ is an eigenvalue of the spatial discretization operator $\\mathbf{A}$. The numerical solution at time $t_n = n \\Delta t$ is denoted by $y_n$. We define the non-dimensional parameter $z = \\lambda \\Delta t$.\n\n#### 1. Analysis of the Adams–Bashforth Two-Step (AB2) Method\n\nThe AB2 method applied to the test equation is:\n$$\ny_{n+1} = y_n + \\frac{\\Delta t}{2} (3 \\lambda y_n - \\lambda y_{n-1})\n$$\nSubstituting $z = \\lambda \\Delta t$, we obtain the scalar two-step recurrence relation:\n$$\ny_{n+1} = y_n + \\frac{z}{2} (3 y_n - y_{n-1})\n$$\n$$\ny_{n+1} - \\left(1 + \\frac{3}{2}z\\right) y_n + \\frac{z}{2} y_{n-1} = 0\n$$\nTo analyze stability, we seek a solution of the form $y_n = g^n$, where $g$ is the amplification factor. Substituting this into the recurrence gives the characteristic polynomial for $g$:\n$$\ng^2 - \\left(1 + \\frac{3}{2}z\\right) g + \\frac{z}{2} = 0\n$$\nThe method is absolutely stable if all roots $g$ of this polynomial satisfy $|g| \\leq 1$, with any roots of magnitude $1$ being simple. The stability boundary is the locus of points $z \\in \\mathbb{C}$ for which at least one root has magnitude $|g|=1$.\nWe are interested in the intersection of this boundary with the negative real axis, so we let $z \\in \\mathbb{R}_{-}$. The point where the stability boundary crosses this axis corresponds to a root $g=-1$. Substituting $g=-1$ into the characteristic polynomial:\n$$\n(-1)^2 - \\left(1 + \\frac{3}{2}z\\right)(-1) + \\frac{z}{2} = 0\n$$\n$$\n1 + \\left(1 + \\frac{3}{2}z\\right) + \\frac{z}{2} = 0\n$$\n$$\n2 + \\frac{3}{2}z + \\frac{1}{2}z = 0\n$$\n$$\n2 + 2z = 0 \\implies z = -1\n$$\nThus, for the pure AB2 method, the stability boundary intersects the negative real axis at $z_{\\text{stab}}^{\\text{AB2}} = -1$.\n\n#### 2. Analysis of the PECE Method\n\nThe PECE method consists of a predictor step followed by a corrector step.\n\n**Predictor (P):** The AB2 predictor applied to $y' = \\lambda y$ gives a predicted value $y_{n+1}^p$:\n$$\ny_{n+1}^p = y_n + \\frac{\\Delta t}{2} (3 \\lambda y_n - \\lambda y_{n-1}) = \\left(1 + \\frac{3}{2}z\\right) y_n - \\frac{z}{2} y_{n-1}\n$$\n\n**Corrector (C):** The explicit trapezoidal corrector uses the predicted value:\n$$\ny_{n+1} = y_n + \\frac{\\Delta t}{2} (\\lambda y_n + \\lambda y_{n+1}^p) = y_n + \\frac{z}{2} (y_n + y_{n+1}^p) = \\left(1 + \\frac{z}{2}\\right) y_n + \\frac{z}{2} y_{n+1}^p\n$$\nNow we substitute the expression for $y_{n+1}^p$ into the corrector equation to obtain a single recurrence for $y_{n+1}$:\n$$\ny_{n+1} = \\left(1 + \\frac{z}{2}\\right) y_n + \\frac{z}{2} \\left[ \\left(1 + \\frac{3}{2}z\\right) y_n - \\frac{z}{2} y_{n-1} \\right]\n$$\n$$\ny_{n+1} = \\left[ 1 + \\frac{z}{2} + \\frac{z}{2}\\left(1 + \\frac{3}{2}z\\right) \\right] y_n - \\frac{z^2}{4} y_{n-1}\n$$\n$$\ny_{n+1} = \\left( 1 + z + \\frac{3}{4}z^2 \\right) y_n - \\frac{z^2}{4} y_{n-1}\n$$\nThis is the scalar two-step recurrence relation for the PECE method. The characteristic polynomial is:\n$$\ng^2 - \\left(1 + z + \\frac{3}{4}z^2\\right) g + \\frac{z^2}{4} = 0\n$$\nTo find the intersection with the negative real axis, we could again test for roots with $|g|=1$. The points where the boundary crosses the axis typically correspond to $g=1$ or $g=-1$.\nLet's test $g=1$:\n$$\n1 - \\left(1 + z + \\frac{3}{4}z^2\\right) + \\frac{z^2}{4} = 0\n$$\n$$\n-z - \\frac{3}{4}z^2 + \\frac{1}{4}z^2 = 0\n$$\n$$\n-z - \\frac{1}{2}z^2 = 0 \\implies -z\\left(1 + \\frac{1}{2}z\\right) = 0\n$$\nThis gives two solutions: $z=0$ (the origin) and $z=-2$.\nLet's test $g=-1$:\n$$\n(-1)^2 - \\left(1 + z + \\frac{3}{4}z^2\\right)(-1) + \\frac{z^2}{4} = 0\n$$\n$$\n1 + 1 + z + \\frac{3}{4}z^2 + \\frac{z^2}{4} = 0\n$$\n$$\n2 + z + z^2 = 0\n$$\nThe roots are $z = \\frac{-1 \\pm \\sqrt{1-8}}{2} = \\frac{-1 \\pm i\\sqrt{7}}{2}$, which are not on the real axis.\nTherefore, the stability boundary for the PECE method intersects the negative real axis at $z_{\\text{stab}}^{\\text{PECE}} = -2$.\n\n#### 3. Formal Order of Accuracy\n\nThe order of a multistep method is determined by its local truncation error (LTE). The LTE is found by substituting the exact solution into the numerical scheme's recurrence relation.\nThe recurrence for the PECE method is $y_{n+1} - (1+z+\\frac{3}{4}z^2)y_n + \\frac{z^2}{4}y_{n-1} = 0$.\nWe substitute the exact solution values $y(t_n)$ and $y(t_{n\\pm1}) = y(t_n) \\exp(\\pm z)$, where $z=\\lambda \\Delta t$. The residual $L$ is:\n$$\nL = y(t_n)\\exp(z) - \\left(1+z+\\frac{3}{4}z^2\\right)y(t_n) + \\frac{z^2}{4}y(t_n)\\exp(-z)\n$$\nWe examine the Taylor series of $L/y(t_n)$ around $z=0$:\n$$\n\\frac{L}{y(t_n)} = \\left(1+z+\\frac{z^2}{2!}+\\frac{z^3}{3!}+\\dots\\right) - \\left(1+z+\\frac{3}{4}z^2\\right) + \\frac{z^2}{4}\\left(1-z+\\frac{z^2}{2!}-\\dots\\right)\n$$\nCollecting terms by powers of $z$:\n- $z^0$: $1 - 1 = 0$\n- $z^1$: $z - z = 0$\n- $z^2$: $\\frac{z^2}{2} - \\frac{3z^2}{4} + \\frac{z^2}{4} = \\left(\\frac{1}{2} - \\frac{3}{4} + \\frac{1}{4}\\right)z^2 = 0$\n- $z^3$: $\\frac{z^3}{6} - \\frac{z^3}{4} = \\left(\\frac{1}{6} - \\frac{1}{4}\\right)z^3 = -\\frac{1}{12}z^3$\nThe leading term of the residual is $L \\approx -\\frac{1}{12}z^3 y(t_n) = -\\frac{1}{12}(\\lambda \\Delta t)^3 y(t_n)$. Since the residual is $O(\\Delta t^3)$, the local truncation error is $O(\\Delta t^3)$, and the method is second-order accurate. The standard AB2 method is also known to be second-order accurate. Therefore, this specific PECE construction does not increase the formal order of accuracy over the predictor, but it does change the stability properties and the error constant.\n\n#### 4. Maximum Stable Diffusive Number and Ratio\n\nThe problem asks for stability with respect to the purely diffusive modes. From the given eigenvalue expression, $\\lambda(k) = -\\,i\\,a\\,\\frac{\\sin(k h)}{h}\\;-\\;4\\,\\nu\\,\\frac{\\sin^2(k h/2)}{h^2}$, the purely diffusive case occurs when the advective term is zero. This happens for the highest frequency mode representable on the grid, $k h = \\pi$. For this mode, $\\sin(k h) = \\sin(\\pi) = 0$ and $\\sin^2(k h/2) = \\sin^2(\\pi/2) = 1$.\nThe eigenvalue for this mode is purely real and negative:\n$$\n\\lambda(k=\\pi/h) = -\\frac{4\\nu}{h^2}\n$$\nThe corresponding value of $z = \\lambda \\Delta t$ is:\n$$\nz = -\\frac{4\\nu \\Delta t}{h^2}\n$$\nThe problem defines the nondimensional diffusive number as $r = \\frac{4\\nu \\Delta t}{h^2}$. Therefore, for this most restrictive mode, we have $z = -r$.\nThe stability limit requires that $z$ lies within the stability region. For diffusion, the critical constraint is on the negative real axis. Thus, we must have $|z| \\leq |z_{\\text{stab}}|$.\nThis gives the condition $r \\leq |z_{\\text{stab}}| = -z_{\\text{stab}}$. The maximum stable diffusive number is $r_{\\max} = -z_{\\text{stab}}$.\n\nFor the AB2 method:\n$$\nr_{\\max}^{\\text{AB2}} = -z_{\\text{stab}}^{\\text{AB2}} = -(-1) = 1\n$$\nFor the PECE method:\n$$\nr_{\\max}^{\\text{PECE}} = -z_{\\text{stab}}^{\\text{PECE}} = -(-2) = 2\n$$\nThe ratio of the maximum stable nondimensional diffusive numbers is:\n$$\n\\frac{r_{\\max}^{\\text{PECE}}}{r_{\\max}^{\\text{AB2}}} = \\frac{2}{1} = 2\n$$\nThe PECE scheme doubles the stable timestep for a purely diffusive problem compared to the AB2 scheme alone, while maintaining the same formal order of accuracy.", "answer": "$$\n\\boxed{2}\n$$", "id": "3288516"}]}