{"hands_on_practices": [{"introduction": "The first step toward mastering numerical time integration is understanding how methods behave on a fundamental test case. This practice grounds your understanding by deriving the stability functions for three cornerstone methods: Forward Euler, Backward Euler, and the Trapezoidal rule. By analyzing the behavior of each integrator on the simple linear ordinary differential equation $y'(t) = \\lambda y(t)$, you will develop the essential analytical tools to characterize stability regions and lay the groundwork for evaluating more complex schemes. [@problem_id:3287737]", "problem": "Consider the linear test problem that arises from the method-of-lines discretization of linearized partial differential equations in computational fluid dynamics (CFD): the ordinary differential equation (ODE) $y'(t) = \\lambda y(t)$, where $\\lambda \\in \\mathbb{C}$ represents an eigenvalue of the semi-discrete spatial operator, and $y(t) \\in \\mathbb{C}$. Let the one-step numerical update be written as $y_{n+1} = R(z)\\,y_n$ for time step $n$, with $z = \\lambda \\,\\Delta t \\in \\mathbb{C}$ and $\\Delta t > 0$ the time step. The function $R(z)$ is called the stability function. The absolute stability region is the set of all $z \\in \\mathbb{C}$ such that $|R(z)| \\leq 1$.\n\nStarting from the fundamental definitions of the following time integration methods applied to the ODE $y'(t) = \\lambda y(t)$:\n- the Forward Euler method (explicit first-order method),\n- the Backward Euler method (implicit first-order method),\n- the Trapezoidal rule (implicit second-order method, also known as the Crank–Nicolson method in the ODE context),\n\nderive, for each method, the corresponding stability function $R(z)$ and fully characterize its absolute stability region in the complex plane. Your characterization must include a precise inequality describing the region and a geometric description. State whether each method is $A$-stable (absolute stability region includes the half-plane $\\{z \\in \\mathbb{C} : \\operatorname{Re}(z) \\leq 0\\}$) and whether it is $L$-stable (in the sense that $\\lim_{z \\to -\\infty} R(z) = 0$ along the negative real axis).\n\nReport, as your final answer, the three stability functions $R(z)$ for the three methods, arranged in a single row matrix in the order: Forward Euler, Backward Euler, Trapezoidal rule. No numerical rounding is required. No units are required.", "solution": "The problem is valid as it is well-posed, scientifically grounded in the theory of numerical methods for ordinary differential equations, and contains all necessary information for a unique solution. We will proceed to derive the stability function and analyze the stability properties for each of the three specified methods.\n\nThe model problem is the linear ordinary differential equation (ODE) $y'(t) = \\lambda y(t)$, where $\\lambda \\in \\mathbb{C}$. A one-step numerical method applied to this ODE produces a recurrence relation of the form $y_{n+1} = R(z) y_n$, where $y_n$ is the numerical approximation to $y(t_n)$, $z = \\lambda \\Delta t$, and $R(z)$ is the stability function.\n\nThe three methods to be analyzed are the Forward Euler method, the Backward Euler method, and the Trapezoidal rule.\n\n**1. Forward Euler Method**\n\nThe Forward Euler method is an explicit first-order method defined by the update rule:\n$$y_{n+1} = y_n + \\Delta t \\, y'(t_n)$$\nApplying this to the test equation $y'(t) = \\lambda y(t)$, we substitute $y'(t_n) = \\lambda y(t_n) \\approx \\lambda y_n$:\n$$y_{n+1} = y_n + \\Delta t (\\lambda y_n) = (1 + \\lambda \\Delta t) y_n$$\nBy setting $z = \\lambda \\Delta t$, we can identify the stability function $R(z)$:\n$$R_{\\text{FE}}(z) = 1 + z$$\nThe absolute stability region is defined by $|R(z)| \\leq 1$. For the Forward Euler method, this is:\n$$|1 + z| \\leq 1$$\nLet $z = x + iy$, where $x, y \\in \\mathbb{R}$. The inequality becomes:\n$$|1 + x + iy| \\leq 1$$\nSquaring the modulus, we obtain:\n$$(1+x)^2 + y^2 \\leq 1^2$$\nThis inequality describes a closed disk of radius $1$ centered at the point $(-1, 0)$ in the complex plane.\n\nThis stability region does not contain the entire left half-plane $\\{z \\in \\mathbb{C} : \\operatorname{Re}(z) \\leq 0\\}$. For example, the point $z = -3$ satisfies $\\operatorname{Re}(z) \\leq 0$ but lies outside the disk. Therefore, the Forward Euler method is **not $A$-stable**.\n\nFor L-stability, we examine the limit of $R(z)$ as $z \\to -\\infty$ along the negative real axis:\n$$\\lim_{z \\to -\\infty} R_{\\text{FE}}(z) = \\lim_{z \\to -\\infty} (1+z) = -\\infty$$\nSince the limit is not $0$, the method is **not $L$-stable**.\n\n**2. Backward Euler Method**\n\nThe Backward Euler method is an implicit first-order method defined by:\n$$y_{n+1} = y_n + \\Delta t \\, y'(t_{n+1})$$\nApplying this to the test equation, we substitute $y'(t_{n+1}) = \\lambda y(t_{n+1}) \\approx \\lambda y_{n+1}$:\n$$y_{n+1} = y_n + \\Delta t (\\lambda y_{n+1})$$\nWe must solve for $y_{n+1}$:\n$$y_{n+1}(1 - \\lambda \\Delta t) = y_n$$\n$$y_{n+1} = \\frac{1}{1 - \\lambda \\Delta t} y_n$$\nWith $z = \\lambda \\Delta t$, the stability function is:\n$$R_{\\text{BE}}(z) = \\frac{1}{1 - z}$$\nThe absolute stability region is given by $|R(z)| \\leq 1$:\n$$\\left|\\frac{1}{1-z}\\right| \\leq 1 \\implies 1 \\leq |1-z|$$\nLet $z = x + iy$. The inequality becomes:\n$$1 \\leq |1 - (x + iy)| = |(1-x) - iy|$$\nSquaring both sides gives:\n$$1^2 \\leq (1-x)^2 + (-y)^2 \\implies 1 \\leq (x-1)^2 + y^2$$\nThis inequality describes the region exterior to the open disk of radius $1$ centered at the point $(1, 0)$ in the complex plane. The boundary of the disk is included in the stability region.\n\nTo check for $A$-stability, we must verify if this region contains the left half-plane $\\{z \\in \\mathbb{C} : \\operatorname{Re}(z) \\leq 0\\}$. For any $z=x+iy$ with $x \\leq 0$, we have $x-1 \\leq -1$, which implies $(x-1)^2 \\geq 1$. Since $y^2 \\geq 0$, the condition $(x-1)^2 + y^2 \\geq 1$ is always satisfied for any $z$ in the left half-plane. Thus, the Backward Euler method **is $A$-stable**.\n\nFor L-stability, we evaluate the limit:\n$$\\lim_{z \\to -\\infty} R_{\\text{BE}}(z) = \\lim_{z \\to -\\infty} \\frac{1}{1-z} = 0$$\nSince the limit is $0$, the method **is $L$-stable**.\n\n**3. Trapezoidal Rule (Crank–Nicolson Method)**\n\nThe Trapezoidal rule is an implicit second-order method defined by:\n$$y_{n+1} = y_n + \\frac{\\Delta t}{2} [y'(t_n) + y'(t_{n+1})]$$\nApplying this to the test equation yields:\n$$y_{n+1} = y_n + \\frac{\\Delta t}{2} [\\lambda y_n + \\lambda y_{n+1}]$$\nSolving for $y_{n+1}$:\n$$y_{n+1}\\left(1 - \\frac{\\lambda \\Delta t}{2}\\right) = y_n\\left(1 + \\frac{\\lambda \\Delta t}{2}\\right)$$\n$$y_{n+1} = \\frac{1 + \\lambda \\Delta t / 2}{1 - \\lambda \\Delta t / 2} y_n$$\nWith $z = \\lambda \\Delta t$, the stability function is:\n$$R_{\\text{TR}}(z) = \\frac{1 + z/2}{1 - z/2} = \\frac{2+z}{2-z}$$\nThe absolute stability region is given by $|R(z)| \\leq 1$:\n$$\\left|\\frac{1 + z/2}{1 - z/2}\\right| \\leq 1 \\implies |1 + z/2| \\leq |1 - z/2|$$\nLet $z = x + iy$. The inequality is:\n$$\\left|1 + \\frac{x+iy}{2}\\right| \\leq \\left|1 - \\frac{x+iy}{2}\\right|$$\n$$\\left|\\left(1+\\frac{x}{2}\\right) + i\\frac{y}{2}\\right| \\leq \\left|\\left(1-\\frac{x}{2}\\right) - i\\frac{y}{2}\\right|$$\nSquaring both sides:\n$$\\left(1+\\frac{x}{2}\\right)^2 + \\left(\\frac{y}{2}\\right)^2 \\leq \\left(1-\\frac{x}{2}\\right)^2 + \\left(-\\frac{y}{2}\\right)^2$$\n$$1 + x + \\frac{x^2}{4} + \\frac{y^2}{4} \\leq 1 - x + \\frac{x^2}{4} + \\frac{y^2}{4}$$\n$$2x \\leq 0 \\implies x \\leq 0$$\nThe stability region is exactly the closed left half of the complex plane, $\\operatorname{Re}(z) \\leq 0$.\n\nBy definition, a method is $A$-stable if its stability region includes the left half-plane. Since the stability region for the Trapezoidal rule is precisely the left half-plane, it **is $A$-stable**.\n\nFor L-stability, we evaluate the limit:\n$$\\lim_{z \\to -\\infty} R_{\\text{TR}}(z) = \\lim_{z \\to -\\infty} \\frac{2+z}{2-z} = \\lim_{z \\to -\\infty} \\frac{2/z+1}{2/z-1} = \\frac{1}{-1} = -1$$\nSince the limit is $-1$ and not $0$, the method is **not $L$-stable**. High-frequency components of a solution (corresponding to $z$ with large negative real part) are not damped but instead persist with an alternating sign.", "answer": "$$\\boxed{\\begin{pmatrix} 1+z  \\frac{1}{1-z}  \\frac{2+z}{2-z} \\end{pmatrix}}$$", "id": "3287737"}, {"introduction": "While unconditional stability, or A-stability, seems like a desirable \"solve-all\" property, it doesn't tell the whole story, especially for stiff systems common in CFD. This exercise builds upon the analysis of the A-stable Crank-Nicolson method to explore the crucial concept of numerical damping and L-stability. By examining the method's response to highly stiff modes, you will uncover why it can produce non-physical oscillations in diffusion problems and learn to appreciate the more subtle aspects of choosing an appropriate integrator. [@problem_id:3287820]", "problem": "Consider the linear test equation of Ordinary Differential Equations (ODE) $y'(t) = \\lambda y(t)$ with complex $\\lambda$ and a fixed time step $\\Delta t$. For any linear one-step time integrator, the step-to-step relation on this test equation can be written as $y^{n+1} = R(z)\\,y^{n}$, where $z = \\lambda\\,\\Delta t$ and $R(z)$ is the method’s stability function (amplification factor). Now consider the Crank–Nicolson method (also known as the trapezoidal rule), and analyze $R(z)$ on the negative real axis, i.e., $z \\in \\mathbb{R}$ with $z  0$. From first principles, derive the stability function $R(z)$ for Crank–Nicolson by applying the method to the test equation, and determine the limiting behavior of $R(z)$ as $z \\to -\\infty$. Using this analysis, explain the damping properties of the method on highly stiff modes (those with $|z| \\gg 1$), and discuss the implications for transient Computational Fluid Dynamics (CFD) simulations of diffusive problems, where semi-discrete spatial operators for diffusion produce eigenvalues $\\lambda_k \\le 0$ and the stiffest modes correspond to the most oscillatory spatial components.\n\nWhich option most accurately captures the correct conclusion of this analysis?\n\nA. For Crank–Nicolson applied to $y'(t) = \\lambda y(t)$ with $z = \\lambda\\,\\Delta t \\in \\mathbb{R}$ and $z \\ll -1$, the stability function satisfies $R(z) \\to -1$, so $|R(z)| \\approx 1$ and highly stiff modes are only very weakly damped while alternating in sign between steps. In semi-discrete diffusion, high-wavenumber modes (large negative eigenvalues) can persist with weak decay, causing nonphysical ringing and slow transient relaxation unless $\\Delta t$ is reduced or an $L$-stable integrator is used.\n\nB. Crank–Nicolson is $L$-stable on the negative real axis because $R(z) \\to 0$ as $z \\to -\\infty$, so it rapidly eliminates stiff diffusive modes and is therefore uniformly preferable to backward Euler in transient diffusion.\n\nC. Crank–Nicolson is unstable on the negative real axis because $|R(z)| > 1$ for $z \\ll -1$, so stiff diffusive modes blow up in time, making the method unusable for diffusion-dominated CFD.\n\nD. Crank–Nicolson is conditionally stable for diffusion; stability requires $\\Delta t \\le 2/|\\lambda|$, and when this holds the stiff modes are strongly damped. If the condition is violated, the method becomes unstable.\n\nE. The slow damping arises because $R(z) \\to 1$ as $z \\to -\\infty$, so stiff diffusive modes are perfectly preserved. This is advantageous in transient CFD for maintaining high-frequency accuracy without introducing numerical dissipation.", "solution": "The problem requires an analysis of the stability properties of the Crank-Nicolson method for stiff ordinary differential equations, specifically focusing on its behavior for large negative real values of $z = \\lambda \\Delta t$.\n\n### Step 1: Validation of the Problem Statement\nThe problem statement is critically reviewed for validity before proceeding to a solution.\n\n**1.1. Extracted Givens:**\n*   **Test Equation:** $y'(t) = \\lambda y(t)$, with $\\lambda \\in \\mathbb{C}$.\n*   **Time Step:** A fixed value, $\\Delta t$.\n*   **One-Step Integrator Form:** $y^{n+1} = R(z) y^{n}$.\n*   **Stability Variable:** $z = \\lambda \\Delta t$.\n*   **Stability Function:** $R(z)$, the amplification factor.\n*   **Method for Analysis:** Crank-Nicolson method (trapezoidal rule).\n*   **Domain of Analysis:** The negative real axis, $z \\in \\mathbb{R}$ with $z  0$.\n*   **Tasks:**\n    1.  Derive the stability function $R(z)$ for the Crank-Nicolson method from first principles.\n    2.  Determine the limit of $R(z)$ as $z \\to -\\infty$.\n    3.  Analyze the damping properties for stiff modes ($|z| \\gg 1$) and discuss the implications for transient CFD simulations of diffusive problems where eigenvalues are real and non-positive.\n\n**1.2. Validation Verdict:**\nThe problem is **valid**.\n*   **Scientifically Grounded:** The analysis is based on the standard von Neumann stability analysis using the Dahlquist test equation, a fundamental and universally accepted technique in the study of numerical methods for ODEs and PDEs. The concepts of stiffness, A-stability, L-stability, and their application to diffusion problems are core topics in computational science.\n*   **Well-Posed:** The problem is clearly defined, requesting the derivation of a specific function and the analysis of its properties under specific conditions. It has a unique, verifiable solution.\n*   **Objective:** The language is precise and uses standard terminology from numerical analysis, devoid of subjective or ambiguous statements. All premises are factually correct and the structure is logical.\n\n### Step 2: Derivation and Analysis\nThe problem, having been validated, will now be solved from first principles.\n\n**2.1. Derivation of the Stability Function $R(z)$**\nThe Crank-Nicolson method, also known as the trapezoidal rule, applied to a generic ODE $y'(t) = f(t, y(t))$ is given by:\n$$y^{n+1} = y^n + \\frac{\\Delta t}{2} \\left[ f(t^n, y^n) + f(t^{n+1}, y^{n+1}) \\right]$$\nWe apply this scheme to the linear test equation $y'(t) = \\lambda y(t)$, for which $f(t,y) = \\lambda y$. Substituting this into the scheme yields:\n$$y^{n+1} = y^n + \\frac{\\Delta t}{2} \\left[ \\lambda y^n + \\lambda y^{n+1} \\right]$$\nTo find the step-to-step relation $y^{n+1} = R(z) y^n$, we must solve for $y^{n+1}$ in terms of $y^n$. We rearrange the equation to group terms with $y^{n+1}$ on the left-hand side and terms with $y^n$ on the right-hand side:\n$$y^{n+1} - \\frac{\\lambda \\Delta t}{2} y^{n+1} = y^n + \\frac{\\lambda \\Delta t}{2} y^n$$\nFactoring out $y^{n+1}$ and $y^n$:\n$$y^{n+1} \\left(1 - \\frac{\\lambda \\Delta t}{2}\\right) = y^n \\left(1 + \\frac{\\lambda \\Delta t}{2}\\right)$$\nSubstituting the definition $z = \\lambda \\Delta t$:\n$$y^{n+1} \\left(1 - \\frac{z}{2}\\right) = y^n \\left(1 + \\frac{z}{2}\\right)$$\nIsolating $y^{n+1}$ gives the desired form:\n$$y^{n+1} = \\left( \\frac{1 + z/2}{1 - z/2} \\right) y^n$$\nBy comparing this to the general form $y^{n+1} = R(z) y^n$, we identify the stability function for the Crank-Nicolson method as:\n$$R(z) = \\frac{1 + z/2}{1 - z/2}$$\n\n**2.2. Limiting Behavior as $z \\to -\\infty$**\nThe problem requires us to analyze the behavior on the negative real axis for stiff modes, which corresponds to taking the limit as $z \\to -\\infty$.\n$$\\lim_{z \\to -\\infty} R(z) = \\lim_{z \\to -\\infty} \\frac{1 + z/2}{1 - z/2}$$\nTo evaluate this limit, we can divide both the numerator and the denominator by $z$:\n$$\\lim_{z \\to -\\infty} \\frac{1/z + 1/2}{1/z - 1/2}$$\nAs $z \\to -\\infty$, the term $1/z$ approaches $0$. Therefore, the limit is:\n$$\\lim_{z \\to -\\infty} R(z) = \\frac{0 + 1/2}{0 - 1/2} = \\frac{1/2}{-1/2} = -1$$\n\n**2.3. Implications for Stiff Diffusion Problems**\n1.  **Stability:** The magnitude of the stability function, $|R(z)|$, determines the amplification or damping of a mode. For the Crank-Nicolson method with $z$ on the negative real axis ($z  0$), the stability function is $R(z) = (1+z/2) / (1-z/2)$. Since $z/2  0$, the numerator $1+z/2$ is always less than $1$, and the denominator $1-z/2$ is always greater than $1$. Consequently, $|1+z/2|  |1-z/2|$, which implies $|R(z)|  1$ for all finite $z  0$. As $z \\to -\\infty$, $|R(z)| \\to |-1| = 1$. The method is unconditionally stable for all $z \\le 0$, a property known as A-stability.\n\n2.  **Damping:** The limit $\\lim_{z \\to -\\infty} R(z) = -1$ is critical. For highly stiff modes (where $|z| = |\\lambda \\Delta t| \\gg 1$), the amplification factor $R(z)$ is very close to $-1$.\n    *   Since $|R(z)| \\approx 1$, these stiff modes are very weakly damped. They persist in the numerical solution for many time steps instead of being rapidly eliminated as their physical counterparts would be.\n    *   Since $R(z) \\approx -1$, the amplitude of these persistent modes alternates in sign at each time step ($y^{n+1} \\approx -y^n$). This behavior manifests as non-physical, high-frequency oscillations in the solution, often called \"ringing\".\n\n3.  **L-Stability:** A method is called L-stable if it is A-stable and additionally satisfies $\\lim_{\\text{Re}(z) \\to -\\infty} |R(z)| = 0$. L-stability is a desirable property for stiff problems because it ensures that infinitely stiff components (the limit as $\\text{Re}(z) \\to -\\infty$) are damped out completely in one time step. Since for Crank-Nicolson $\\lim_{z \\to -\\infty} |R(z)| = 1 \\ne 0$, the method is **not** L-stable.\n\n4.  **CFD Application (Diffusion):** In transient CFD simulations of diffusion-dominated processes, the semi-discretized equations form a stiff system of ODEs. The eigenvalues $\\lambda_k$ of the spatial discretization operator are real and non-positive ($\\lambda_k \\le 0$). The stiffest components correspond to the largest-magnitude eigenvalues, which are associated with the highest-wavenumber (most oscillatory) spatial modes. These modes often represent initial condition errors or small-scale physical features that should decay very rapidly. Due to its lack of L-stability, Crank-Nicolson fails to damp these modes effectively, leading to persistent, spurious oscillations that can pollute the entire solution and prevent it from reaching the correct transient state in a reasonable time. To overcome this, one must either use a very small time step $\\Delta t$ (which defeats the purpose of an implicit method) or switch to an L-stable integrator like the Backward Euler method.\n\n### Step 3: Evaluation of Options\n\n*   **A: For Crank–Nicolson applied to $y'(t) = \\lambda y(t)$ with $z = \\lambda\\,\\Delta t \\in \\mathbb{R}$ and $z \\ll -1$, the stability function satisfies $R(z) \\to -1$, so $|R(z)| \\approx 1$ and highly stiff modes are only very weakly damped while alternating in sign between steps. In semi-discrete diffusion, high-wavenumber modes (large negative eigenvalues) can persist with weak decay, causing nonphysical ringing and slow transient relaxation unless $\\Delta t$ is reduced or an $L$-stable integrator is used.**\n    This statement is a perfect summary of our derivation. It correctly identifies the limit as $-1$, correctly interprets this as weak damping and sign alternation, and correctly describes the consequences for stiff diffusion problems and potential remedies. **Verdict: Correct.**\n\n*   **B: Crank–Nicolson is $L$-stable on the negative real axis because $R(z) \\to 0$ as $z \\to -\\infty$, so it rapidly eliminates stiff diffusive modes and is therefore uniformly preferable to backward Euler in transient diffusion.**\n    This statement is incorrect on multiple counts. The limit is $R(z) \\to -1$, not $0$. Consequently, Crank-Nicolson is not L-stable. It does not rapidly eliminate stiff modes. **Verdict: Incorrect.**\n\n*   **C: Crank–Nicolson is unstable on the negative real axis because $|R(z)|  1$ for $z \\ll -1$, so stiff diffusive modes blow up in time, making the method unusable for diffusion-dominated CFD.**\n    This statement is incorrect. As shown, for $z  0$, we have $|R(z)|  1$. The method is A-stable (unconditionally stable) on the negative real axis, not unstable. **Verdict: Incorrect.**\n\n*   **D: Crank–Nicolson is conditionally stable for diffusion; stability requires $\\Delta t \\le 2/|\\lambda|$, and when this holds the stiff modes are strongly damped. If the condition is violated, the method becomes unstable.**\n    This statement is incorrect. Crank-Nicolson is unconditionally stable, not conditionally stable. The condition $|\\lambda \\Delta t| \\le 2$ (or $|z| \\le 2$) is the stability limit for the explicit Forward Euler method. **Verdict: Incorrect.**\n\n*   **E: The slow damping arises because $R(z) \\to 1$ as $z \\to -\\infty$, so stiff diffusive modes are perfectly preserved. This is advantageous in transient CFD for maintaining high-frequency accuracy without introducing numerical dissipation.**\n    This statement is incorrect. The limit is $R(z) \\to -1$, not $1$. The resulting behavior is not advantageous; the persistent high-frequency components are typically numerical pollution, not physically accurate features. **Verdict: Incorrect.**", "answer": "$$\\boxed{A}$$", "id": "3287820"}, {"introduction": "Theoretical analysis provides insight, but seeing a method's behavior in action provides true understanding. This computational practice challenges you to implement and contrast two different second-order implicit methods applied to a stiff relaxation problem. By comparing the A-stable BDF2 method with an L-stable SDIRK method, you will directly observe the practical consequences of their differing stability properties, such as the overshoot phenomenon in BDF2 and the superior damping of the L-stable scheme, translating abstract stability theory into tangible numerical results. [@problem_id:3287801]", "problem": "Consider the scalar stiff relaxation Ordinary Differential Equation (ODE) $u_t = -\\lambda \\left(u - u^\\ast\\right)$ with $\\lambda \\gg 1$. Define the deviation variable $v(t) = u(t) - u^\\ast$, which satisfies $v_t = -\\lambda v$, with exact solution $v(t) = v(0)\\,\\exp\\left(-\\lambda t\\right)$. For a fixed time step $\\Delta t$, define the nondimensional stiffness parameter $r = \\lambda \\Delta t$. You will compare the accuracy and stability manifestations of a two-step Backward Differentiation Formula of order $2$ (Backward Differentiation Formula (BDF) method of order $2$, abbreviated as BDF$2$) and a second-order Singly Diagonally Implicit Runge–Kutta method (Singly Diagonally Implicit Runge–Kutta (SDIRK) method) that is $L$-stable.\n\nYour program must implement the following, using only the fundamental facts that (i) BDF$2$ uses the backward difference of order $2$ with the right-hand side evaluated at the new time, and (ii) the SDIRK method uses two implicit stages with the same diagonal coefficient:\n\n- Transform to $v(t) = u(t) - u^\\ast$, so the numerical task reduces to integrating $v_t = -\\lambda v$.\n- For BDF$2$, use one Backward Euler startup step at the first time level and then one BDF$2$ step at the second time level, both with the same step size $\\Delta t$. This produces $v^1$ from $v^0$ by a single Backward Euler step, followed by $v^2$ from $\\left(v^1,v^0\\right)$ by a single BDF$2$ step.\n- For SDIRK, use the standard two-stage, second-order SDIRK with diagonal parameter $\\gamma = 1 - 1/\\sqrt{2}$ applied for two steps with the same $\\Delta t$ starting from $v^0$ to obtain $v^2$.\n\nFor each method, you must:\n- Detect overshoot or undershoot relative to the steady state by checking whether the sign of $v$ changes at any step compared to the sign of $v^0$. Formally, define a boolean that is `True` if there exists any step index $n$ with $v^n \\cdot v^0  0$ and $|v^n| > 0$; otherwise `False`.\n- Quantify asymptotic damping after two steps by computing the ratio $\\rho = |v^2|/|v^0|$.\n\nImplement the two methods from first principles for the linear problem $v_t = -\\lambda v$ by deriving the algebraic updates implied by the method definitions. For the BDF$2$ step, derive and utilize the linear recurrence that relates $v^{n+1}$ to $\\left(v^n,v^{n-1}\\right)$ for the equation $v_t = -\\lambda v$. For the SDIRK step, derive and utilize the stage equations for the two-stage method with parameter $\\gamma$ when applied to $v_t = -\\lambda v$, and then form the time update using the stage values. Avoid any adaptive time-stepping or nonlinear iterations; for this scalar linear problem the stage and step equations can be solved in closed form.\n\nTest Suite:\nRun your program on the following parameter sets, each consisting of $\\left(\\lambda,\\Delta t,u_0,u^\\ast\\right)$, with exactly two uniform steps of size $\\Delta t$:\n- Case $1$: $\\left(50,\\,0.02,\\,2,\\,1\\right)$ so $r = 1$.\n- Case $2$: $\\left(1000,\\,0.1,\\,2,\\,1\\right)$ so $r = 100$.\n- Case $3$: $\\left(50,\\,0.001,\\,2,\\,1\\right)$ so $r = 0.05$.\n- Case $4$: $\\left(200,\\,0.05,\\,0,\\,1\\right)$ so $r = 10$ and the initial deviation is negative.\n- Case $5$: $\\left(10^6,\\,10^{-3},\\,3,\\,1\\right)$ so $r = 1000$.\n\nFor each case, compute and return the following $4$ quantities in order:\n- BDF$2$ overshoot boolean.\n- SDIRK overshoot boolean.\n- BDF$2$ two-step damping ratio $\\rho_{\\mathrm{BDF2}} = |v^2|/|v^0|$.\n- SDIRK two-step damping ratio $\\rho_{\\mathrm{SDIRK}} = |v^2|/|v^0|$.\n\nFinal Output Format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case contributes a sub-list of the form `[` `BDF2_overshoot` `, ` `SDIRK_overshoot` `, $\\rho_{\\mathrm{BDF2}}$, $\\rho_{\\mathrm{SDIRK}}$ `]`.\n- Booleans must appear as `True` or `False`.\n- Floats must be rounded to exactly $6$ decimal places using standard rounding to nearest.\n- There must be no extra whitespace characters anywhere inside the brackets.\n\nExample of the required shape (illustrative only): `[[False,False,0.123456,0.012345],[...]]`.", "solution": "The user has submitted a valid problem statement from the field of numerical analysis, specifically concerning the stability and accuracy of time integration schemes for stiff ordinary differential equations. The problem is scientifically grounded, well-posed, objective, and contains all necessary information for a unique solution. I will now proceed with a formal derivation and solution.\n\nThe problem requires a comparative analysis of two second-order time integration schemes applied to the scalar linear stiff relaxation equation:\n$$\n\\frac{du}{dt} = u_t = -\\lambda (u - u^\\ast)\n$$\nwhere $\\lambda \\gg 1$. By defining the deviation from equilibrium as $v(t) = u(t) - u^\\ast$, we obtain the simpler homogeneous linear ODE:\n$$\n\\frac{dv}{dt} = v_t = -\\lambda v\n$$\nThe numerical analysis will be performed on this equation. The dimensionless stiffness parameter is defined as $r = \\lambda \\Delta t$, where $\\Delta t$ is the fixed time step size. We will derive the expressions for overshoot and the two-step damping ratio $\\rho = |v^2|/|v^0|$ for both the BDF2 and SDIRK methods.\n\n### Backward Differentiation Formula of Order 2 (BDF2)\n\nThe specified procedure for the BDF2 method involves one start-up step using the first-order Backward Euler (BE) method, followed by one step of the second-order BDF2 method.\n\n**1. Backward Euler Start-up Step:**\nThe BE method applied to $v_t = -\\lambda v$ to find the approximation $v^1$ at time $t_1 = \\Delta t$ from $v^0$ at $t_0=0$ is given by:\n$$\n\\frac{v^1 - v^0}{\\Delta t} = -\\lambda v^1\n$$\nSolving for $v^1$ yields:\n$$\nv^1 - v^0 = -(\\lambda \\Delta t) v^1 = -r v^1\n$$\n$$\nv^1 (1 + r) = v^0 \\implies v^1 = \\frac{1}{1+r} v^0\n$$\n\n**2. BDF2 Step:**\nThe BDF2 method uses $v^0$ and $v^1$ to find $v^2$ at time $t_2 = 2\\Delta t$. The formula is derived from a second-order backward difference approximation of the derivative at $t_{n+1}$:\n$$\n\\frac{3v^{n+1} - 4v^n + v^{n-1}}{2\\Delta t} = f(t_{n+1}, v^{n+1}) = -\\lambda v^{n+1}\n$$\nFor our second step ($n=1$), this becomes:\n$$\n\\frac{3v^2 - 4v^1 + v^0}{2\\Delta t} = -\\lambda v^2\n$$\n$$\n3v^2 - 4v^1 + v^0 = -2(\\lambda \\Delta t) v^2 = -2r v^2\n$$\nSolving for $v^2$:\n$$\nv^2(3 + 2r) = 4v^1 - v^0\n$$\nSubstituting the expression for $v^1$ from the BE step:\n$$\nv^2(3 + 2r) = 4\\left(\\frac{1}{1+r} v^0\\right) - v^0 = \\left(\\frac{4}{1+r} - 1\\right) v^0 = \\frac{4 - (1+r)}{1+r} v^0 = \\frac{3-r}{1+r} v^0\n$$\nThus, the amplification factor for the two-step process is:\n$$\nG_{\\mathrm{BDF2}}(r) = \\frac{v^2}{v^0} = \\frac{3-r}{(1+r)(3+2r)}\n$$\n\n**3. Overshoot and Damping for BDF2:**\n- **Overshoot:** An overshoot (or undershoot, if $v^0  0$) occurs if any $v^n$ has a sign opposite to $v^0$.\n  - For the first step, $v^1/v^0 = 1/(1+r)$, which is always positive for $r  0$. No overshoot occurs at step 1.\n  - For the second step, the sign of $v^2/v^0$ is determined by the sign of $G_{\\mathrm{BDF2}}(r)$. Since the denominator $(1+r)(3+2r)$ is positive for $r0$, the sign is determined by the numerator, $3-r$. An overshoot occurs if $3-r  0$, which implies $r  3$.\n- **Damping Ratio:** The two-step damping ratio is $\\rho_{\\mathrm{BDF2}} = |v^2/v^0| = |G_{\\mathrm{BDF2}}(r)|$.\n$$\n\\rho_{\\mathrm{BDF2}} = \\left| \\frac{3-r}{(1+r)(3+2r)} \\right|\n$$\n\n### Singly Diagonally Implicit Runge-Kutta (SDIRK) Method\n\nThe problem specifies a two-stage, second-order, L-stable SDIRK method with the diagonal Butcher coefficient $\\gamma = 1 - 1/\\sqrt{2}$. For the linear ODE $v_t = -\\lambda v$, a single step of a Runge-Kutta method is equivalent to multiplication by its stability function, $v^{n+1} = R(-\\lambda \\Delta t) v^n = R(-r) v^n$. For this SDIRK method, the stability function is $R(-r) = \\frac{1 - r(1-2\\gamma)}{(1+r\\gamma)^2}$. Let's denote this single-step amplification factor as $S(r) = R(-r)$.\n\nThe two-step process involves applying this method twice with the same step size $\\Delta t$.\n$v^1 = S(r) v^0$\n$v^2 = S(r) v^1 = (S(r))^2 v^0$\n\n**1. SDIRK Amplification Factor:**\nWith $\\gamma = 1 - 1/\\sqrt{2}$, we can simplify some terms:\n$1 - 2\\gamma = 1 - 2(1 - 1/\\sqrt{2}) = 1 - 2 + \\sqrt{2} = \\sqrt{2} - 1$.\nThe single-step amplification factor is:\n$$\nS(r) = \\frac{1-r(\\sqrt{2}-1)}{(1+r(1-1/\\sqrt{2}))^2}\n$$\nThe two-step amplification factor is $G_{\\mathrm{SDIRK}}(r) = v^2/v^0 = (S(r))^2$.\n\n**2. Overshoot and Damping for SDIRK:**\n- **Overshoot:** An overshoot occurs if $v^1$ or $v^2$ has a sign opposite to $v^0$.\n  - For the second step, $v^2/v^0 = (S(r))^2 \\ge 0$. No overshoot can occur at step 2 relative to the initial state $v^0$.\n  - For the first step, an overshoot occurs if $v^1/v^0 = S(r)  0$. The denominator of $S(r)$ is a square, hence non-negative. The sign is determined by the numerator, $1 - r(\\sqrt{2}-1)$. The condition for overshoot is $1 - r(\\sqrt{2}-1)  0$, which implies $r  \\frac{1}{\\sqrt{2}-1} = \\sqrt{2}+1 \\approx 2.414$.\n- **Damping Ratio:** The two-step damping ratio is $\\rho_{\\mathrm{SDIRK}} = |v^2/v^0| = |(S(r))^2| = (S(r))^2$.\n$$\n\\rho_{\\mathrm{SDIRK}} = \\left( \\frac{1-r(\\sqrt{2}-1)}{(1+r(1-1/\\sqrt{2}))^2} \\right)^2\n$$\n\nBased on these derivations, a program can be implemented to compute the required quantities for the given test suite.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of comparing BDF2 and SDIRK methods for a stiff ODE.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (lambda, dt, u0, u_star)\n        (50.0, 0.02, 2.0, 1.0),    # r = 1\n        (1000.0, 0.1, 2.0, 1.0),   # r = 100\n        (50.0, 0.001, 2.0, 1.0),   # r = 0.05\n        (200.0, 0.05, 0.0, 1.0),   # r = 10\n        (10**6, 10**-3, 3.0, 1.0)  # r = 1000\n    ]\n\n    all_results = []\n    \n    # Constants for SDIRK method\n    sqrt2 = np.sqrt(2)\n    gamma = 1 - 1 / sqrt2\n    sdirk_overshoot_threshold = sqrt2 + 1\n    sqrt2_minus_1 = sqrt2 - 1\n    \n    # BDF2 overshoot threshold\n    bdf2_overshoot_threshold = 3.0\n\n    for case in test_cases:\n        lam, dt, u0, u_star = case\n        \n        # Calculate non-dimensional stiffness parameter\n        r = lam * dt\n        \n        # -------- BDF2 Method --------\n        # Check for overshoot\n        bdf2_overshoot = r > bdf2_overshoot_threshold\n        \n        # Calculate two-step damping ratio\n        rho_bdf2_val = abs((3 - r) / ((1 + r) * (3 + 2 * r)))\n\n        # -------- SDIRK Method --------\n        # Check for overshoot\n        sdirk_overshoot = r > sdirk_overshoot_threshold\n        \n        # Calculate single-step amplification factor\n        s_of_r = (1 - r * sqrt2_minus_1) / (1 + r * gamma)**2\n        \n        # Calculate two-step damping ratio\n        rho_sdirk_val = s_of_r**2\n        \n        # Assemble results for one case, formatted as strings\n        case_results = [\n            \"True\" if bdf2_overshoot else \"False\",\n            \"True\" if sdirk_overshoot else \"False\",\n            f\"{rho_bdf2_val:.6f}\",\n            f\"{rho_sdirk_val:.6f}\"\n        ]\n        all_results.append(case_results)\n\n    # Format the final output string exactly as specified\n    inner_strings = [f\"[{','.join(res)}]\" for res in all_results]\n    final_output = f\"[{','.join(inner_strings)}]\"\n    \n    # The final print statement must produce only the specified single-line format.\n    print(final_output)\n\nsolve()\n```", "id": "3287801"}]}