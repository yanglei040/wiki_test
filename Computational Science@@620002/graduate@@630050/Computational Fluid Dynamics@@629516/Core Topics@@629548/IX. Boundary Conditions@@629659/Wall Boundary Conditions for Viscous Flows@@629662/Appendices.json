{"hands_on_practices": [{"introduction": "In finite-volume methods, boundary conditions are commonly enforced by setting values in fictitious \"ghost cells\" located outside the computational domain. This exercise demonstrates the fundamental procedure for determining the ghost-cell velocity for a Dirichlet no-slip wall condition. By ensuring that linear interpolation between the ghost cell and the first interior cell yields the correct wall velocity, we can consistently implement the boundary condition and compute the corresponding wall shear stress. [@problem_id:3389957]", "problem": "A developer is implementing wall boundary conditions in a one-dimensional, planar, collocated finite-volume discretization for a Newtonian viscous fluid within Computational Fluid Dynamics (CFD). Consider an interior control volume with center at point $P$ and a ghost control volume with center at point $G$, where the plane separating $P$ and $G$ coincides with a physical wall face at point $f$. The coordinate $n$ is normal to the wall, pointing from $P$ towards $G$. The distances from the wall face to the centers are $d_P$ for $P$ and $d_G$ for $G$, each strictly positive. The scalar of interest is the tangential velocity component $u$, and the wall imposes a Dirichlet no-slip condition specifying a tangential wall velocity $U_w$ at the wall face. The dynamic viscosity is $\\mu$, and the mass density is $\\rho$.\n\nStarting only from the following foundational bases:\n- Linear interpolation for a scalar between neighboring points along the line connecting their centers.\n- Newton’s law of viscosity for a Newtonian fluid, which states that the wall shear stress is proportional to the wall-normal gradient of the tangential velocity component.\n- The definition of friction velocity as a scale derived from the wall shear and the density.\n\nDerive the expression for the ghost-cell tangential velocity value $u_G$ such that applying linear interpolation between $P$ and $G$ reproduces the wall value $u_f = U_w$ at the face. Then, using a consistent face-normal velocity gradient approximation at the wall, compute the wall shear stress $\\tau_w$ and the friction velocity $u_\\tau$.\n\nYour program must:\n- Implement the derived expression for $u_G$ that enforces the Dirichlet wall condition at the face by linear interpolation.\n- Use the resulting discretely consistent wall-normal velocity gradient at the face to compute the wall shear stress $\\tau_w$ via Newton’s law of viscosity.\n- Compute the friction velocity $u_\\tau$ based on $\\tau_w$ and $\\rho$.\n\nUnits and numerical requirements:\n- Distances $d_P$ and $d_G$ must be provided and used in $\\mathrm{m}$.\n- Velocities $u_P$ and $U_w$ must be provided and used in $\\mathrm{m/s}$.\n- Dynamic viscosity $\\mu$ must be provided and used in $\\mathrm{Pa \\cdot s}$.\n- Density $\\rho$ must be provided and used in $\\mathrm{kg/m^3}$.\n- Wall shear $\\tau_w$ must be reported in $\\mathrm{Pa}$.\n- Friction velocity $u_\\tau$ must be reported in $\\mathrm{m/s}$.\n- Round each numerical output to exactly $6$ decimal places.\n\nTest suite:\n- Case $1$: $d_P = 0.01 \\ \\mathrm{m}$, $d_G = 0.01 \\ \\mathrm{m}$, $u_P = 0.5 \\ \\mathrm{m/s}$, $U_w = 0.0 \\ \\mathrm{m/s}$, $\\mu = 0.001 \\ \\mathrm{Pa \\cdot s}$, $\\rho = 1000.0 \\ \\mathrm{kg/m^3}$.\n- Case $2$: $d_P = 0.01 \\ \\mathrm{m}$, $d_G = 0.01 \\ \\mathrm{m}$, $u_P = 0.0 \\ \\mathrm{m/s}$, $U_w = 1.0 \\ \\mathrm{m/s}$, $\\mu = 0.001 \\ \\mathrm{Pa \\cdot s}$, $\\rho = 1000.0 \\ \\mathrm{kg/m^3}$.\n- Case $3$: $d_P = 0.005 \\ \\mathrm{m}$, $d_G = 0.015 \\ \\mathrm{m}$, $u_P = 0.2 \\ \\mathrm{m/s}$, $U_w = 0.8 \\ \\mathrm{m/s}$, $\\mu = 1.8 \\times 10^{-5} \\ \\mathrm{Pa \\cdot s}$, $\\rho = 1.225 \\ \\mathrm{kg/m^3}$.\n- Case $4$: $d_P = 0.02 \\ \\mathrm{m}$, $d_G = 0.03 \\ \\mathrm{m}$, $u_P = 0.75 \\ \\mathrm{m/s}$, $U_w = 0.75 \\ \\mathrm{m/s}$, $\\mu = 0.002 \\ \\mathrm{Pa \\cdot s}$, $\\rho = 900.0 \\ \\mathrm{kg/m^3}$.\n- Case $5$: $d_P = 1.0 \\times 10^{-6} \\ \\mathrm{m}$, $d_G = 1.0 \\times 10^{-6} \\ \\mathrm{m}$, $u_P = 0.1 \\ \\mathrm{m/s}$, $U_w = 0.0 \\ \\mathrm{m/s}$, $\\mu = 1.0 \\ \\mathrm{Pa \\cdot s}$, $\\rho = 1.0 \\ \\mathrm{kg/m^3}$.\n\nFor each case, compute and output the triple $[u_G, \\tau_w, u_\\tau]$ using the derived expressions and the provided parameters. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each case is a sub-list in order. For example, the output format must be:\n\"[[u_G1,tau_w1,u_tau1],[u_G2,tau_w2,u_tau2],...]\" with every number rounded to $6$ decimal places.", "solution": "The problem requires the derivation of expressions for the ghost-cell tangential velocity $u_G$, the wall shear stress $\\tau_w$, and the friction velocity $u_\\tau$ for a Dirichlet no-slip wall boundary condition in a one-dimensional finite-volume framework. The derivation must proceed from the foundational principles specified.\n\nLet the wall face $f$ be located at the position $n=0$ along the wall-normal coordinate. The interior fluid cell center, $P$, is at $n_P = -d_P$, and the exterior ghost-cell center, $G$, is at $n_G = d_G$. The corresponding tangential velocities at these points are $u_P$ and $u_G$, respectively. The specified tangential velocity at the wall is $U_w$.\n\n**1. Derivation of the Ghost-Cell Velocity, $u_G$**\n\nThe first principle is the use of linear interpolation for the scalar velocity field $u$ between the neighboring cell centers $P$ and $G$. The velocity $u(n)$ at a position $n$ between $n_P = -d_P$ and $n_G = d_G$ is given by a weighted average of the values $u_P$ and $u_G$:\n$$u(n) = \\frac{(n_G - n)u_P + (n - n_P)u_G}{n_G - n_P}$$\nSubstituting the positions $n_P = -d_P$ and $n_G = d_G$:\n$$u(n) = \\frac{(d_G - n)u_P + (n - (-d_P))u_G}{d_G - (-d_P)} = \\frac{(d_G - n)u_P + (n + d_P)u_G}{d_G + d_P}$$\nWe enforce the Dirichlet boundary condition at the wall face $f$, where $n=0$ and the velocity is specified as $u_f = U_w$. Setting $n=0$ in the interpolation formula yields the velocity at the face:\n$$u_f = u(0) = \\frac{(d_G - 0)u_P + (0 + d_P)u_G}{d_G + d_P} = \\frac{d_G u_P + d_P u_G}{d_G + d_P}$$\nBy imposing the condition $u_f = U_w$, we can solve for the required ghost-cell value $u_G$:\n$$U_w = \\frac{d_G u_P + d_P u_G}{d_G + d_P}$$\n$$U_w (d_G + d_P) = d_G u_P + d_P u_G$$\n$$d_P u_G = U_w (d_G + d_P) - d_G u_P$$\n$$u_G = \\frac{U_w (d_G + d_P) - d_G u_P}{d_P}$$\nThis expression can be rewritten as:\n$$u_G = U_w \\left(1 + \\frac{d_G}{d_P}\\right) - u_P \\frac{d_G}{d_P}$$\nThis equation defines the value $u_G$ in the ghost cell such that linear interpolation between $P$ and $G$ correctly yields the specified velocity $U_w$ at the wall.\n\n**2. Derivation of the Wall Shear Stress, $\\tau_w$**\n\nThe second principle is Newton's law of viscosity, which relates the shear stress to the velocity gradient. For the tangential component, the wall shear stress $\\tau_w$ is given by:\n$$\\tau_w = \\mu \\left. \\frac{\\partial u}{\\partial n} \\right|_{n=0}$$\nwhere $\\mu$ is the dynamic viscosity and $\\left. \\frac{\\partial u}{\\partial n} \\right|_{n=0}$ is the velocity gradient normal to the wall, evaluated at the wall face.\n\nThe problem states that a consistent face-normal velocity gradient approximation must be used. Consistency requires that the gradient be calculated from the same linear velocity profile established in the previous step. The gradient of the linear function $u(n)$ is constant between $P$ and $G$:\n$$\\frac{du}{dn} = \\frac{d}{dn} \\left( \\frac{(d_G - n)u_P + (n + d_P)u_G}{d_G + d_P} \\right) = \\frac{-u_P + u_G}{d_G + d_P}$$\nThis central-difference approximation, centered at the midpoint between $P$ and $G$, is the gradient of the interpolant everywhere, including at the face $f$.\n$$\\left. \\frac{\\partial u}{\\partial n} \\right|_{n=0} = \\frac{u_G - u_P}{d_G + d_P}$$\nSubstituting this gradient into Newton's law of viscosity gives the expression for the wall shear stress:\n$$\\tau_w = \\mu \\left( \\frac{u_G - u_P}{d_G + d_P} \\right)$$\nThis expression correctly uses the ghost-cell value $u_G$ to compute the stress, ensuring consistency with the enforced Dirichlet condition.\n\n**3. Derivation of the Friction Velocity, $u_\\tau$**\n\nThe third principle is the definition of the friction velocity, $u_\\tau$. It is a velocity scale derived from the wall shear stress $\\tau_w$ and the fluid density $\\rho$. As a scale, it is a non-negative quantity, and its definition involves the magnitude of the wall shear stress:\n$$u_\\tau = \\sqrt{\\frac{|\\tau_w|}{\\rho}}$$\nSubstituting the derived expression for $\\tau_w$:\n$$u_\\tau = \\sqrt{\\frac{\\left| \\mu \\left( \\frac{u_G - u_P}{d_G + d_P} \\right) \\right|}{\\rho}}$$\n\n**Summary of Final Formulae**\n\nThe computational procedure for each test case is as follows:\n1.  Calculate the ghost-cell velocity $u_G$ using the given parameters:\n    $$u_G = U_w \\left(1 + \\frac{d_G}{d_P}\\right) - u_P \\frac{d_G}{d_P}$$\n2.  Calculate the wall shear stress $\\tau_w$ using the computed $u_G$:\n    $$\\tau_w = \\mu \\left( \\frac{u_G - u_P}{d_G + d_P} \\right)$$\n3.  Calculate the friction velocity $u_\\tau$ from the computed $\\tau_w$:\n    $$u_\\tau = \\sqrt{\\frac{|\\tau_w|}{\\rho}}$$\n\nThese expressions will be implemented to solve for the values in the provided test suite.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes ghost-cell velocity, wall shear stress, and friction velocity\n    for a series of test cases based on a 1D finite-volume wall boundary condition.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (d_P, d_G, u_P, U_w, mu, rho)\n    test_cases = [\n        (0.01, 0.01, 0.5, 0.0, 0.001, 1000.0),\n        (0.01, 0.01, 0.0, 1.0, 0.001, 1000.0),\n        (0.005, 0.015, 0.2, 0.8, 1.8e-5, 1.225),\n        (0.02, 0.03, 0.75, 0.75, 0.002, 900.0),\n        (1.0e-6, 1.0e-6, 0.1, 0.0, 1.0, 1.0),\n    ]\n\n    all_results = []\n    \n    for case in test_cases:\n        d_P, d_G, u_P, U_w, mu, rho = case\n\n        # 1. Derive the expression for the ghost-cell tangential velocity u_G\n        # u_G = U_w * (1 + d_G/d_P) - u_P * (d_G/d_P)\n        u_G = U_w * (1.0 + d_G / d_P) - u_P * (d_G / d_P)\n\n        # 2. Compute the wall shear stress tau_w\n        # tau_w = mu * (u_G - u_P) / (d_G + d_P)\n        # The velocity gradient is consistently determined from the linear profile\n        # between P and G.\n        grad_u_at_wall = (u_G - u_P) / (d_G + d_P)\n        tau_w = mu * grad_u_at_wall\n\n        # 3. Compute the friction velocity u_tau\n        # u_tau = sqrt(|tau_w| / rho)\n        if tau_w == 0.0:\n            u_tau = 0.0\n        else:\n            u_tau = np.sqrt(np.abs(tau_w) / rho)\n            \n        # Round each result to 6 decimal places.\n        # np.round is used as specified in execution environment.\n        # Python's format specifier with f-strings for '0-padding' and rounding.\n        # We process results into a list of correctly rounded numbers.\n        case_results = [\n            round(u_G, 6),\n            round(tau_w, 6),\n            round(u_tau, 6),\n        ]\n        all_results.append(case_results)\n\n    # Format the final output string as specified: \"[[r11,r12,r13],[r21,r22,r23],...]\"\n    # Using a list comprehension to build the string representation of each inner list.\n    inner_lists_str = [f\"[{','.join(map(str, res))}]\" for res in all_results]\n    # Joining the inner list strings with commas and enclosing in the outer brackets.\n    final_output = f\"[{','.join(inner_lists_str)}]\"\n    \n    print(final_output)\n\nsolve()\n```", "id": "3389957"}, {"introduction": "A crucial part of any flow simulation is the accurate calculation of engineering quantities from the discrete solution, with wall shear stress being paramount for determining skin friction drag. This practice addresses the challenge of computing a wall-normal gradient with high accuracy on the non-uniform grids typically used in CFD. You will derive and apply a second-order one-sided finite difference formula to obtain a reliable estimate of the wall shear stress from cell-centered data. [@problem_id:3389984]", "problem": "You are given a flat, impermeable wall aligned with a Cartesian axis, with the wall-normal direction denoted by $n$ and the tangential velocity component $u_t(n)$ defined along the wall. The fluid is Newtonian with constant dynamic viscosity $\\mu$ and constant density $\\rho$. The wall is either stationary (no-slip), moving tangentially at a prescribed wall speed $U_w$ (no-slip), or free-slip (zero tangential stress at the wall). The Newtonian tangential wall shear stress is defined by the fundamental constitutive relation\n$$\n\\tau_w = \\mu \\left.\\frac{\\partial u_t}{\\partial n}\\right|_{w}.\n$$\nYou are working with a cell-centered finite-volume discretization in the wall-normal direction on a locally nonuniform grid. The first near-wall cell has thickness $\\Delta y_1$ and the second has thickness $\\Delta y_2$. The centers of these cells are located at distances $y_1 = \\Delta y_1/2$ and $y_2 = \\Delta y_1 + \\Delta y_2/2$ from the wall. The only available tangential velocity data are the cell-centered values $u_1 = u_t(y_1)$ and $u_2 = u_t(y_2)$. No additional off-wall points are available.\n\nStarting from the fundamental definitions above and the appropriate wall boundary condition, derive from first principles a second-order accurate one-sided approximation to the wall-normal gradient $\\left.\\frac{\\partial u_t}{\\partial n}\\right|_{w}$ that uses only the two interior cell-centered values $u_1$ and $u_2$ and the wall value implied by the boundary condition, and that remains valid for nonuniform spacings $\\Delta y_1$ and $\\Delta y_2$. Use this gradient to compute the wall shear stress $\\tau_w$. Define the friction velocity by\n$$\nu_\\tau = \\sqrt{\\frac{|\\tau_w|}{\\rho}}.\n$$\nFor a free-slip wall, the boundary condition imposes zero tangential stress and thus zero wall-normal gradient of the tangential velocity; handle this case accordingly.\n\nYour task is to implement a program that, for each test case given below, computes $\\tau_w$ and $u_\\tau$. All inputs are specified in standard Système International d'Unités (SI units). You must produce outputs with the following requirements:\n- Express $\\tau_w$ in pascals (Pa) and $u_\\tau$ in meters per second (m/s).\n- Round each reported $\\tau_w$ and $u_\\tau$ to six decimal places.\n- Your program should produce a single line of output containing the results as a comma-separated list of per-case sublists, with no spaces, where each sublist is of the form $[\\tau_w,u_\\tau]$. For example: $[[\\tau_1,u_{\\tau,1}],[\\tau_2,u_{\\tau,2}],\\ldots]$.\n\nImplement the following test suite:\n- Case A (no-slip, stationary wall): $\\Delta y_1 = 1.2\\times 10^{-4}\\,\\text{m}$, $\\Delta y_2 = 2.5\\times 10^{-4}\\,\\text{m}$, $u_1 = 0.04\\,\\text{m/s}$, $u_2 = 0.07\\,\\text{m/s}$, $\\mu = 1.0\\times 10^{-3}\\,\\text{Pa}\\cdot\\text{s}$, $\\rho = 998.2\\,\\text{kg/m}^3$, $U_w = 0\\,\\text{m/s}$.\n- Case B (no-slip, stationary wall, locally uniform): $\\Delta y_1 = 5.0\\times 10^{-3}\\,\\text{m}$, $\\Delta y_2 = 5.0\\times 10^{-3}\\,\\text{m}$, $u_1 = 0.20\\,\\text{m/s}$, $u_2 = 0.35\\,\\text{m/s}$, $\\mu = 1.8\\times 10^{-5}\\,\\text{Pa}\\cdot\\text{s}$, $\\rho = 1.225\\,\\text{kg/m}^3$, $U_w = 0\\,\\text{m/s}$.\n- Case C (free-slip wall): $\\Delta y_1 = 1.0\\times 10^{-3}\\,\\text{m}$, $\\Delta y_2 = 1.5\\times 10^{-3}\\,\\text{m}$, $u_1 = 0.12\\,\\text{m/s}$, $u_2 = 0.125\\,\\text{m/s}$, $\\mu = 1.0\\times 10^{-3}\\,\\text{Pa}\\cdot\\text{s}$, $\\rho = 1000.0\\,\\text{kg/m}^3$, $U_w = 0\\,\\text{m/s}$.\n- Case D (no-slip, moving wall): $\\Delta y_1 = 2.0\\times 10^{-4}\\,\\text{m}$, $\\Delta y_2 = 3.0\\times 10^{-4}\\,\\text{m}$, $u_1 = 0.11\\,\\text{m/s}$, $u_2 = 0.115\\,\\text{m/s}$, $\\mu = 1.5\\times 10^{-3}\\,\\text{Pa}\\cdot\\text{s}$, $\\rho = 1050.0\\,\\text{kg/m}^3$, $U_w = 0.10\\,\\text{m/s}$.\n- Case E (no-slip, thin first cell): $\\Delta y_1 = 1.0\\times 10^{-6}\\,\\text{m}$, $\\Delta y_2 = 1.0\\times 10^{-4}\\,\\text{m}$, $u_1 = 0.005\\,\\text{m/s}$, $u_2 = 0.05\\,\\text{m/s}$, $\\mu = 1.0\\times 10^{-3}\\,\\text{Pa}\\cdot\\text{s}$, $\\rho = 1000.0\\,\\text{kg/m}^3$, $U_w = 0\\,\\text{m/s}$.\n\nYour program must implement the derivation-based second-order one-sided approximation described above, compute $\\tau_w$ and $u_\\tau$ for each case, and print the single-line output in the exact format: $[[\\tau_A,u_{\\tau,A}],[\\tau_B,u_{\\tau,B}],[\\tau_C,u_{\\tau,C}],[\\tau_D,u_{\\tau,D}],[\\tau_E,u_{\\tau,E}]]$ with all numbers rounded to six decimal places and no spaces.", "solution": "The problem requires the computation of wall shear stress $\\tau_w$ and friction velocity $u_\\tau$ for a viscous flow near a flat wall. The solution is predicated on deriving and implementing a second-order accurate numerical approximation for the wall-normal gradient of the tangential velocity, $\\left.\\frac{\\partial u_t}{\\partial n}\\right|_{w}$, using cell-centered velocity data from a non-uniform grid.\n\nWe are given a flat wall at the position $n=0$. The velocity profile in the wall-normal direction is $u_t(n)$. The available data points are derived from a cell-centered finite-volume scheme:\n1. The tangential velocity at the wall, $u_w = u_t(0)$, which is determined by the boundary condition. For a no-slip condition, $u_w$ is the prescribed wall velocity, $U_w$. For a stationary wall, $U_w=0$.\n2. The cell-centered velocity $u_1 = u_t(y_1)$ in the first cell, located at $y_1 = \\Delta y_1/2$.\n3. The cell-centered velocity $u_2 = u_t(y_2)$ in the second cell, located at $y_2 = \\Delta y_1 + \\Delta y_2/2$.\n\nThe core of the problem is to construct a second-order accurate, one-sided finite difference formula for the derivative $u_t'(0)$ using the three points $(0, u_w)$, $(y_1, u_1)$, and $(y_2, u_2)$. This can be achieved by writing Taylor series expansions for $u_1$ and $u_2$ around the point $n=0$. Let $u_t'(0)$ and $u_t''(0)$ denote the first and second derivatives at the wall, respectively.\n\nThe Taylor series expansions are:\n$$\nu_1 = u_t(y_1) = u_t(0) + y_1 u_t'(0) + \\frac{y_1^2}{2} u_t''(0) + O(y_1^3)\n$$\n$$\nu_2 = u_t(y_2) = u_t(0) + y_2 u_t'(0) + \\frac{y_2^2}{2} u_t''(0) + O(y_2^3)\n$$\n\nSubstituting $u_w = u_t(0)$ and rearranging, we obtain a system of two linear equations for the two unknowns, $u_t'(0)$ and $u_t''(0)$. We neglect the higher-order terms, which is consistent with seeking a second-order accurate scheme:\n$$\nu_1 - u_w = y_1 u_t'(0) + \\frac{y_1^2}{2} u_t''(0) \\quad (1)\n$$\n$$\nu_2 - u_w = y_2 u_t'(0) + \\frac{y_2^2}{2} u_t''(0) \\quad (2)\n$$\n\nTo solve for the gradient $u_t'(0)$, we can eliminate $u_t''(0)$. Multiply equation (1) by $y_2^2$ and equation (2) by $y_1^2$:\n$$\ny_2^2 (u_1 - u_w) = y_1 y_2^2 u_t'(0) + \\frac{y_1^2 y_2^2}{2} u_t''(0)\n$$\n$$\ny_1^2 (u_2 - u_w) = y_1^2 y_2 u_t'(0) + \\frac{y_1^2 y_2^2}{2} u_t''(0)\n$$\n\nSubtracting the second new equation from the first yields:\n$$\ny_2^2 (u_1 - u_w) - y_1^2 (u_2 - u_w) = (y_1 y_2^2 - y_1^2 y_2) u_t'(0)\n$$\n$$\ny_2^2 (u_1 - u_w) - y_1^2 (u_2 - u_w) = y_1 y_2 (y_2 - y_1) u_t'(0)\n$$\n\nSolving for the wall gradient, denoted $\\left.\\frac{\\partial u_t}{\\partial n}\\right|_{w} = u_t'(0)$, gives the desired second-order accurate, one-sided formula valid for a non-uniform grid:\n$$\n\\left.\\frac{\\partial u_t}{\\partial n}\\right|_{w} = \\frac{y_2^2 (u_1 - u_w) - y_1^2 (u_2 - u_w)}{y_1 y_2 (y_2 - y_1)}\n$$\n\nThis formula is equivalent to finding the derivative at $n=0$ of a unique quadratic polynomial $P(n) = an^2 + bn + c$ that passes through the three data points $(0, u_w)$, $(y_1, u_1)$, and $(y_2, u_2)$, where the derivative is $\\left.\\frac{dP}{dn}\\right|_{n=0} = b$.\n\nOnce the wall gradient is computed, the wall shear stress $\\tau_w$ is found from the Newtonian constitutive relation:\n$$\n\\tau_w = \\mu \\left.\\frac{\\partial u_t}{\\partial n}\\right|_{w}\n$$\nThe friction velocity $u_\\tau$ is then calculated from its definition:\n$$\nu_\\tau = \\sqrt{\\frac{|\\tau_w|}{\\rho}}\n$$\n\nThe procedure for each test case is as follows:\n1.  **Identify Boundary Condition:**\n    -   For a no-slip wall (stationary or moving), set $u_w = U_w$. Proceed with the calculation.\n    -   For a free-slip wall, the boundary condition definitionally imposes zero tangential stress, so $\\tau_w = 0\\,\\text{Pa}$. This implies $\\left.\\frac{\\partial u_t}{\\partial n}\\right|_{w} = 0$, and consequently, $u_\\tau = 0\\,\\text{m/s}$. The values of $u_1$, $u_2$, and fluid properties are not needed to determine the wall quantities in this specific case.\n\n2.  **Calculate Grid Point Locations (for no-slip cases):**\n    -   First cell center: $y_1 = \\Delta y_1 / 2$.\n    -   Second cell center: $y_2 = \\Delta y_1 + \\Delta y_2 / 2$.\n\n3.  **Compute Wall Gradient (for no-slip cases):**\n    -   Apply the derived formula for $\\left.\\frac{\\partial u_t}{\\partial n}\\right|_{w}$.\n\n4.  **Compute $\\tau_w$ and $u_\\tau$ (for no-slip cases):**\n    -   Use the definitions of $\\tau_w$ and $u_\\tau$ with the calculated gradient and given fluid properties $\\mu$ and $\\rho$.\n\n5.  **Format Output:**\n    -   Round the final computed values of $\\tau_w$ and $u_\\tau$ to six decimal places as required. The program will systematically apply this methodology to each test case.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes wall shear stress and friction velocity for various boundary\n    conditions and grid configurations using a second-order one-sided\n    approximation for the wall-normal velocity gradient.\n    \"\"\"\n    test_cases = [\n        # Case A: no-slip, stationary wall\n        {\n            \"name\": \"A\", \"type\": \"no_slip\",\n            \"delta_y1\": 1.2e-4, \"delta_y2\": 2.5e-4,\n            \"u1\": 0.04, \"u2\": 0.07,\n            \"mu\": 1.0e-3, \"rho\": 998.2, \"Uw\": 0.0\n        },\n        # Case B: no-slip, stationary wall, locally uniform\n        {\n            \"name\": \"B\", \"type\": \"no_slip\",\n            \"delta_y1\": 5.0e-3, \"delta_y2\": 5.0e-3,\n            \"u1\": 0.20, \"u2\": 0.35,\n            \"mu\": 1.8e-5, \"rho\": 1.225, \"Uw\": 0.0\n        },\n        # Case C: free-slip wall\n        {\n            \"name\": \"C\", \"type\": \"free_slip\",\n            \"delta_y1\": 1.0e-3, \"delta_y2\": 1.5e-3,\n            \"u1\": 0.12, \"u2\": 0.125,\n            \"mu\": 1.0e-3, \"rho\": 1000.0, \"Uw\": 0.0\n        },\n        # Case D: no-slip, moving wall\n        {\n            \"name\": \"D\", \"type\": \"no_slip\",\n            \"delta_y1\": 2.0e-4, \"delta_y2\": 3.0e-4,\n            \"u1\": 0.11, \"u2\": 0.115,\n            \"mu\": 1.5e-3, \"rho\": 1050.0, \"Uw\": 0.10\n        },\n        # Case E: no-slip, thin first cell\n        {\n            \"name\": \"E\", \"type\": \"no_slip\",\n            \"delta_y1\": 1.0e-6, \"delta_y2\": 1.0e-4,\n            \"u1\": 0.005, \"u2\": 0.05,\n            \"mu\": 1.0e-3, \"rho\": 1000.0, \"Uw\": 0.0\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        if case[\"type\"] == \"free_slip\":\n            # For a free-slip wall, tangential stress is zero by definition.\n            tau_w = 0.0\n            u_tau = 0.0\n        else: # no_slip case\n            # Extract parameters\n            delta_y1 = case[\"delta_y1\"]\n            delta_y2 = case[\"delta_y2\"]\n            u1 = case[\"u1\"]\n            u2 = case[\"u2\"]\n            mu = case[\"mu\"]\n            rho = case[\"rho\"]\n            u_w = case[\"Uw\"]\n\n            # Calculate cell-center distances from the wall\n            y1 = delta_y1 / 2.0\n            y2 = delta_y1 + delta_y2 / 2.0\n\n            # Calculate the wall-normal velocity gradient using the second-order\n            # one-sided formula derived from first principles.\n            # grad_u = (y2^2 * (u1 - u_w) - y1^2 * (u2 - u_w)) / (y1 * y2 * (y2 - y1))\n            numerator = y2**2 * (u1 - u_w) - y1**2 * (u2 - u_w)\n            denominator = y1 * y2 * (y2 - y1)\n            \n            # Avoid division by zero if y1 is very close to y2 (not an issue here)\n            if abs(denominator)  1e-30:\n                # Fallback to a lower-order scheme if needed, but not for this problem.\n                # For this setup, y2 is always greater than y1.\n                grad_u = 0.0 \n            else:\n                grad_u = numerator / denominator\n\n            # Calculate wall shear stress (tau_w)\n            tau_w = mu * grad_u\n\n            # Calculate friction velocity (u_tau)\n            u_tau = np.sqrt(np.abs(tau_w) / rho)\n        \n        results.append([tau_w, u_tau])\n\n    # Format the final output string as per requirements\n    # [[tau_A,u_tau_A],[tau_B,u_tau_B],...,[tau_E,u_tau_E]]\n    # Numbers are rounded to six decimal places, with no spaces.\n    output_str = \"[\" + \",\".join([f\"[{res[0]:.6f},{res[1]:.6f}]\" for res in results]) + \"]\"\n    print(output_str)\n\nsolve()\n```", "id": "3389984"}, {"introduction": "For wall-resolved simulations, especially in turbulence modeling, the quality of the mesh adjacent to the wall is critical, and the dimensionless wall distance, $y^+$, is the standard metric for quantifying this resolution. This practice connects the analytical solution for a laminar boundary layer to the practical task of assessing mesh quality. You will derive how $y^+$ varies along a flat plate for a fixed first-cell height, illustrating a common challenge in grid design and reinforcing the physical meaning of wall units. [@problem_id:3389986]", "problem": "An incompressible Newtonian fluid of constant density $\\rho$ and dynamic viscosity $\\mu$ flows with uniform free-stream speed $U_{\\infty}$ over a smooth, isothermal, semi-infinite flat plate aligned with the flow. For $0x\\leq L$, the local wall shear stress distribution is known (from a similarity solution of the laminar boundary layer) to be\n$$\n\\tau_{w}(x)=0.332\\,\\rho\\,U_{\\infty}^{2}\\,\\sqrt{\\frac{\\nu}{U_{\\infty}\\,x}},\n$$\nwhere $\\nu=\\mu/\\rho$ is the kinematic viscosity, $x$ is the streamwise distance from the leading edge, and $L$ is a characteristic plate length used to delimit the computational domain. A Computational Fluid Dynamics (CFD) mesh employs a uniform first off-wall cell height $\\Delta y$ everywhere along the plate.\n\nUsing only fundamental definitions and conservation-law-based scaling, derive closed-form analytic expressions for the friction velocity $u_{\\tau}(x)$ and the dimensionless wall distance $y^{+}(x)$ in terms of $x$, $U_{\\infty}$, $\\nu$, and $\\Delta y$. Express $u_{\\tau}(x)$ in $\\mathrm{m}\\,\\mathrm{s}^{-1}$ and $y^{+}(x)$ as dimensionless. Do not substitute numerical values or perform rounding; present simplified symbolic expressions.", "solution": "The problem statement has been validated and is deemed scientifically grounded, well-posed, and objective. It provides all necessary information to derive the requested quantities based on fundamental definitions in fluid mechanics.\n\nThe derivation proceeds in two parts. First, we will derive the expression for the friction velocity, $u_{\\tau}(x)$, and second, we will derive the expression for the dimensionless wall distance, $y^{+}(x)$.\n\nThe friction velocity, $u_{\\tau}$, is a quantity with units of velocity, defined in terms of the wall shear stress, $\\tau_{w}$, and the fluid density, $\\rho$. The fundamental definition is:\n$$\nu_{\\tau} = \\sqrt{\\frac{\\tau_{w}}{\\rho}}\n$$\nThe problem provides the expression for the local wall shear stress, $\\tau_{w}(x)$, for laminar flow over a flat plate:\n$$\n\\tau_{w}(x) = 0.332\\,\\rho\\,U_{\\infty}^{2}\\,\\sqrt{\\frac{\\nu}{U_{\\infty}\\,x}}\n$$\nwhere $U_{\\infty}$ is the free-stream speed, $\\nu$ is the kinematic viscosity, and $x$ is the streamwise coordinate. Substituting this expression for $\\tau_{w}(x)$ into the definition of $u_{\\tau}$ yields the friction velocity as a function of $x$:\n$$\nu_{\\tau}(x) = \\sqrt{\\frac{1}{\\rho} \\left( 0.332\\,\\rho\\,U_{\\infty}^{2}\\,\\sqrt{\\frac{\\nu}{U_{\\infty}\\,x}} \\right)}\n$$\nThe density $\\rho$ cancels out:\n$$\nu_{\\tau}(x) = \\sqrt{0.332\\,U_{\\infty}^{2}\\,\\left(\\frac{\\nu}{U_{\\infty}\\,x}\\right)^{1/2}}\n$$\nWe can simplify this expression by applying the properties of exponents:\n$$\nu_{\\tau}(x) = (0.332)^{1/2} \\, (U_{\\infty}^{2})^{1/2} \\, \\left(\\left(\\frac{\\nu}{U_{\\infty}\\,x}\\right)^{1/2}\\right)^{1/2}\n$$\n$$\nu_{\\tau}(x) = \\sqrt{0.332} \\, U_{\\infty} \\, \\left(\\frac{\\nu}{U_{\\infty}\\,x}\\right)^{1/4}\n$$\nDistributing the exponent $1/4$ to the terms inside the parenthesis gives:\n$$\nu_{\\tau}(x) = \\sqrt{0.332} \\, U_{\\infty} \\, \\frac{\\nu^{1/4}}{U_{\\infty}^{1/4} \\, x^{1/4}}\n$$\nCombining the terms involving $U_{\\infty}$ leads to the final simplified expression for the friction velocity:\n$$\nu_{\\tau}(x) = \\sqrt{0.332} \\, U_{\\infty}^{1 - 1/4} \\, \\nu^{1/4} \\, x^{-1/4} = \\sqrt{0.332} \\, U_{\\infty}^{3/4} \\, \\nu^{1/4} \\, x^{-1/4}\n$$\nThis expression provides the friction velocity in units of velocity ($\\mathrm{m}\\,\\mathrm{s}^{-1}$), as requested.\n\nNext, we derive the expression for the dimensionless wall distance, $y^{+}$. The fundamental definition of $y^{+}$ is:\n$$\ny^{+} = \\frac{y u_{\\tau}}{\\nu}\n$$\nwhere $y$ is the physical distance from the wall. In the context of Computational Fluid Dynamics (CFD), $y^{+}$ is a crucial parameter for evaluating the resolution of the mesh near a wall. The problem specifies a uniform first off-wall cell height of $\\Delta y$. The dimensionless distance is typically evaluated at a characteristic height within this first cell. The problem requires the expression for $y^{+}(x)$ in terms of $\\Delta y$, implying that we should use this height as the characteristic physical distance from the wall. Therefore, we set $y = \\Delta y$. This gives the $y^{+}$ value at the top of the first cell layer.\n$$\ny^{+}(x) = \\frac{\\Delta y \\, u_{\\tau}(x)}{\\nu}\n$$\nNow, we substitute the previously derived expression for $u_{\\tau}(x)$:\n$$\ny^{+}(x) = \\frac{\\Delta y}{\\nu} \\left( \\sqrt{0.332} \\, U_{\\infty}^{3/4} \\, \\nu^{1/4} \\, x^{-1/4} \\right)\n$$\nWe can simplify this expression by combining the terms involving the kinematic viscosity $\\nu$:\n$$\ny^{+}(x) = \\sqrt{0.332} \\, \\Delta y \\, U_{\\infty}^{3/4} \\, \\nu^{1/4 - 1} \\, x^{-1/4}\n$$\n$$\ny^{+}(x) = \\sqrt{0.332} \\, \\Delta y \\, U_{\\infty}^{3/4} \\, \\nu^{-3/4} \\, x^{-1/4}\n$$\nThis expression gives the dimensionless wall distance $y^{+}$ as a function of $x$ and the mesh parameter $\\Delta y$. The expression is dimensionless as required.\n\nThe two requested expressions are thus:\n1. Friction velocity: $u_{\\tau}(x) = \\sqrt{0.332} \\, U_{\\infty}^{3/4} \\, \\nu^{1/4} \\, x^{-1/4}$\n2. Dimensionless wall distance: $y^{+}(x) = \\sqrt{0.332} \\, \\Delta y \\, U_{\\infty}^{3/4} \\, \\nu^{-3/4} \\, x^{-1/4}$\nThese are the final, simplified, closed-form analytic expressions based on the provided information and fundamental definitions.", "answer": "$$\n\\boxed{\\begin{pmatrix} \\sqrt{0.332} \\, U_{\\infty}^{3/4} \\, \\nu^{1/4} \\, x^{-1/4}  \\sqrt{0.332} \\, \\Delta y \\, U_{\\infty}^{3/4} \\, \\nu^{-3/4} \\, x^{-1/4} \\end{pmatrix}}\n$$", "id": "3389986"}]}