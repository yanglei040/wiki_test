{"hands_on_practices": [{"introduction": "In Reynolds-Averaged Navier-Stokes (RANS) simulations, accurately specifying conditions at the inlet is paramount for obtaining physically meaningful results. While turbulence models operate with variables like turbulent kinetic energy ($k$) and specific dissipation rate ($\\omega$), experimental data or engineering estimates are often expressed in terms of physical quantities like turbulence intensity ($I$) and integral length scale ($L$). This practice bridges that gap, guiding you through the essential derivation of model-ready inlet values from practical turbulence parameters, a foundational skill for any CFD practitioner. [@problem_id:3335042]", "problem": "Consider a statistically steady, incompressible, high-Reynolds-number flow simulated with the Reynolds-Averaged Navier–Stokes (RANS) equations closed by the two-equation turbulence model known as the turbulent kinetic energy–specific dissipation rate model ($k$–$\\omega$). At the inlet, the mean streamwise velocity is uniform with magnitude $U_{\\infty}$, the turbulence intensity is $I$ (defined as the ratio of the root-mean-square of the velocity fluctuations to the mean speed), and the integral length scale is $L$ (assumed to represent the turbulence production scale and to be commensurate with the turbulence length scale at the inlet). Assume the inlet turbulence is approximately isotropic.\n\nStarting from fundamental definitions and widely accepted relationships, derive the inlet values for the turbulent kinetic energy $k$ and the specific dissipation rate $\\omega$. Use $k=\\tfrac{3}{2}(I U_{\\infty})^{2}$, and obtain an expression for $\\omega$ in terms of $k$, $L$, and a model constant $C_{\\mu}$ associated with the eddy viscosity closure in the turbulent kinetic energy–dissipation rate model ($k$–$\\varepsilon$). You may use well-tested equilibrium relations to connect the $k$–$\\varepsilon$ and $k$–$\\omega$ closures. Discuss the consistency of your inlet turbulence specification with the mean-flow boundary condition, and address how the chosen inlet $k$ and $\\omega$ relate to other boundary types such as outlet, far-field, symmetry, and periodic boundaries in terms of maintaining physical and mathematical compatibility of the RANS problem.\n\nReport the final expression for the inlet specific dissipation rate $\\omega_{\\text{in}}$ as a single closed-form analytic expression in terms of $I$, $U_{\\infty}$, $L$, and $C_{\\mu}$. Do not substitute numerical values. No rounding is required. Do not include units in your final expression; however, interpret $\\omega_{\\text{in}}$ physically as having dimensions of inverse time.", "solution": "The user wants me to solve the following problem:\nConsider a statistically steady, incompressible, high-Reynolds-number flow simulated with the Reynolds-Averaged Navier–Stokes (RANS) equations closed by the two-equation turbulence model known as the turbulent kinetic energy–specific dissipation rate model ($k$–$\\omega$). At the inlet, the mean streamwise velocity is uniform with magnitude $U_{\\infty}$, the turbulence intensity is $I$ (defined as the ratio of the root-mean-square of the velocity fluctuations to the mean speed), and the integral length scale is $L$ (assumed to represent the turbulence production scale and to be commensurate with the turbulence length scale at the inlet). Assume the inlet turbulence is approximately isotropic.\n\nStarting from fundamental definitions and widely accepted relationships, derive the inlet values for the turbulent kinetic energy $k$ and the specific dissipation rate $\\omega$. Use $k=\\tfrac{3}{2}(I U_{\\infty})^{2}$, and obtain an expression for $\\omega$ in terms of $k$, $L$, and a model constant $C_{\\mu}$ associated with the eddy viscosity closure in the turbulent kinetic energy–dissipation rate model ($k$–$\\varepsilon$). You may use well-tested equilibrium relations to connect the $k$–$\\varepsilon$ and $k$–$\\omega$ closures. Discuss the consistency of your inlet turbulence specification with the mean-flow boundary condition, and address how the chosen inlet $k$ and $\\omega$ relate to other boundary types such as outlet, far-field, symmetry, and periodic boundaries in terms of maintaining physical and mathematical compatibility of the RANS problem.\n\nReport the final expression for the inlet specific dissipation rate $\\omega_{\\text{in}}$ as a single closed-form analytic expression in terms of $I$, $U_{\\infty}$, $L$, and $C_{\\mu}$. Do not substitute numerical values. No rounding is required. Do not include units in your final expression; however, interpret $\\omega_{\\text{in}}$ physically as having dimensions of inverse time.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n- Flow type: Statistically steady, incompressible, high-Reynolds-number.\n- Governing equations: Reynolds-Averaged Navier–Stokes (RANS).\n- Turbulence model: Turbulent kinetic energy–specific dissipation rate model ($k$–$\\omega$).\n- Inlet mean streamwise velocity: Uniform, magnitude $U_{\\infty}$.\n- Inlet turbulence intensity: $I$.\n- Inlet integral length scale: $L$.\n- Inlet turbulence assumption: Approximately isotropic.\n- Inlet turbulent kinetic energy: $k = \\frac{3}{2}(I U_{\\infty})^{2}$.\n- Task: Derive inlet specific dissipation rate, $\\omega_{\\text{in}}$.\n- Constraint on derivation: The expression for $\\omega$ must be in terms of $k$, $L$, and the model constant $C_{\\mu}$ from the $k$–$\\varepsilon$ model.\n- Method hint: Use well-tested equilibrium relations to connect $k$–$\\varepsilon$ and $k$–$\\omega$ closures.\n- Discussion topic: Consistency of the derived inlet conditions with the mean flow boundary condition and relationship to other boundary conditions (outlet, far-field, symmetry, periodic).\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientific Grounding**: The problem is firmly grounded in the principles of computational fluid dynamics (CFD) and turbulence modeling. The RANS equations, the $k$–$\\omega$ and $k$–$\\varepsilon$ models, and the concepts of turbulence intensity, length scale, and turbulent kinetic energy are standard and fundamental to the field.\n- **Well-Posedness**: The problem is well-posed. It asks for the derivation of a specific quantity ($\\omega_{\\text{in}}$) from a given set of parameters ($I$, $U_{\\infty}$, $L$, $C_{\\mu}$) using established theoretical relationships. A unique analytical solution is achievable.\n- **Objectivity**: The problem is stated using precise, objective, and standard terminology from fluid mechanics and CFD. There are no subjective or ambiguous statements.\n- **Consistency and Completeness**: The provided information is self-contained and sufficient. The relationship for $k$ is consistent with the definition of turbulence intensity for isotropic turbulence. The instruction to use equilibrium relations and the constant $C_{\\mu}$ from the $k$–$\\varepsilon$ model provides a clear pathway for the derivation.\n- **Validity Check**: The problem does not violate any of the invalidity criteria. It is scientifically sound, well-posed, objective, complete, and relevant to the specified topic of CFD boundary conditions.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A full solution will be provided.\n\n### Solution Derivation\n\nThe objective is to determine the inlet boundary condition for the specific dissipation rate, $\\omega_{\\text{in}}$, for a RANS simulation using the $k$–$\\omega$ turbulence model. The derivation will be based on the provided inlet parameters and standard relationships from turbulence modeling theory.\n\nFirst, we establish the connection between the $k$–$\\omega$ model and the $k$–$\\varepsilon$ model. Both are two-equation models that introduce an eddy (or turbulent) viscosity, $\\nu_t$, to close the RANS equations. The Boussinesq hypothesis relates the Reynolds stresses to the mean strain rate via this eddy viscosity.\n\nIn the standard $k$–$\\omega$ model, the eddy viscosity is defined as:\n$$ \\nu_t = \\frac{k}{\\omega} $$\nIn the standard $k$–$\\varepsilon$ model, the eddy viscosity is defined as:\n$$ \\nu_t = C_{\\mu} \\frac{k^2}{\\varepsilon} $$\nwhere $k$ is the turbulent kinetic energy, $\\omega$ is the specific dissipation rate, $\\varepsilon$ is the turbulent dissipation rate, and $C_{\\mu}$ is an empirical model constant (typically, $C_{\\mu} \\approx 0.09$).\n\nBy equating these two expressions for the same physical quantity, $\\nu_t$, we establish a \"closure-level\" relationship between $\\omega$ and $\\varepsilon$:\n$$ \\frac{k}{\\omega} = C_{\\mu} \\frac{k^2}{\\varepsilon} $$\nAssuming $k \\ne 0$, we can rearrange this expression to solve for $\\varepsilon$ in terms of $\\omega$, or vice-versa:\n$$ \\varepsilon = C_{\\mu} k \\omega $$\nThis equation provides the fundamental bridge between the variables of the two models.\n\nNext, we must relate these turbulence quantities to the given integral length scale, $L$. For high-Reynolds-number turbulent flows, particularly those near a state of equilibrium where the rate of turbulence production is nearly equal to the rate of dissipation, a characteristic length scale of the energy-containing eddies, $L_t$, can be related to $k$ and $\\varepsilon$. This relationship arises from dimensional analysis: $\\varepsilon$ has dimensions of $[(\\text{length})^2(\\text{time})^{-3}]$ and $k$ has dimensions of $[(\\text{length})^2(\\text{time})^{-2}]$. The only combination of $k$ and a length scale $L_t$ that produces the dimensions of $\\varepsilon$ is $k^{3/2}/L_t$.\n\nA widely used relationship, which is a cornerstone of the $k$–$\\varepsilon$ model's formulation and consistent with observations in simple shear flows, connects the length scale $L$, turbulent kinetic energy $k$, and dissipation rate $\\varepsilon$ through the model constant $C_{\\mu}$:\n$$ \\varepsilon = C_{\\mu}^{3/4} \\frac{k^{3/2}}{L} $$\nHere, we have identified the problem's given integral length scale $L$ with the characteristic turbulence length scale. This is a common and reasonable assumption for specifying inlet conditions representing developed turbulence.\n\nNow we have two distinct expressions for $\\varepsilon$. By equating them, we can solve for $\\omega$:\n$$ C_{\\mu} k \\omega = C_{\\mu}^{3/4} \\frac{k^{3/2}}{L} $$\nSolving for $\\omega$ yields:\n$$ \\omega = \\frac{C_{\\mu}^{3/4}}{C_{\\mu}} \\frac{k^{3/2}}{k L} = C_{\\mu}^{3/4 - 1} \\frac{k^{1/2}}{L} = C_{\\mu}^{-1/4} \\frac{k^{1/2}}{L} $$\nThis expression provides the specific dissipation rate $\\omega$ in terms of $k$, $L$, and the constant $C_{\\mu}$, as required.\n\nThe final step is to substitute the given expression for the inlet turbulent kinetic energy, $k_{\\text{in}}$, into our derived formula for $\\omega$. The problem states:\n$$ k_{\\text{in}} = \\frac{3}{2}(I U_{\\infty})^{2} $$\nSubstituting this into the equation for $\\omega$:\n$$ \\omega_{\\text{in}} = C_{\\mu}^{-1/4} \\frac{\\left( \\frac{3}{2}(I U_{\\infty})^{2} \\right)^{1/2}}{L} $$\nSimplifying the expression gives:\n$$ \\omega_{\\text{in}} = C_{\\mu}^{-1/4} \\frac{\\sqrt{\\frac{3}{2}} |I U_{\\infty}|}{L} $$\nSince the turbulence intensity $I$ and the mean speed $U_{\\infty}$ are non-negative physical quantities, the absolute value is redundant.\n$$ \\omega_{\\text{in}} = \\sqrt{\\frac{3}{2}} C_{\\mu}^{-1/4} \\frac{I U_{\\infty}}{L} $$\nThis is the final analytical expression for the inlet specific dissipation rate.\n\n### Discussion on Boundary Conditions\n\n**Consistency with Mean-Flow Boundary Condition:**\nThe inlet is specified with a uniform mean velocity profile, $U_{\\infty}$, which is a \"plug flow\" condition. The derived turbulence quantities, $k_{\\text{in}}$ and $\\omega_{\\text{in}}$, are also uniform across the inlet. This uniformity is self-consistent; specifying a spatially varying turbulence field with a uniform mean flow would be physically incongruous for an equilibrium inlet condition. The derived values of $k_{\\text{in}}$ and $\\omega_{\\text{in}}$ represent a state of near-equilibrium isotropic turbulence, which is a physically plausible and stable state to initialize a flow field, preventing the unphysical rapid decay or growth of turbulence immediately downstream of the inlet.\n\n**Relation to Other Boundary Condition Types:**\n- **Outlet:** An outlet boundary is designed to allow flow to exit the computational domain with minimal upstream influence. A common treatment is the zero-gradient (Neumann) condition, $\\frac{\\partial \\phi}{\\partial n} = 0$, for all transported variables, including $k$ and $\\omega$. This assumes the flow is \"fully developed\" at the outlet. The inlet specification derived here is compatible with a zero-gradient outlet, provided the domain is long enough to permit the flow to evolve from its inlet state to a fully developed one.\n- **Far-field:** For external aerodynamic simulations, a far-field boundary condition specifies the freestream state. The conditions imposed are identical in form to the inlet conditions derived here: a uniform velocity $U_{\\infty}$, and turbulence properties ($k_{\\infty}$, $\\omega_{\\infty}$) calculated from freestream turbulence intensity $I_{\\infty}$ and a characteristic length scale $L_{\\infty}$. Therefore, the derived formulation is directly applicable to far-field boundaries.\n- **Symmetry:** A symmetry plane enforces a no-flux condition across the boundary ($\\mathbf{u} \\cdot \\mathbf{n} = 0$) and zero normal gradients for all scalar quantities ($\\frac{\\partial k}{\\partial n} = 0$, $\\frac{\\partial \\omega}{\\partial n} = 0$). This is a local constraint on the flow field's structure. It is mathematically independent of and compatible with the global turbulence level set by the inlet conditions.\n- **Periodic:** Periodic boundaries enforce that the flow state on one boundary is identical to the state on a corresponding boundary elsewhere. This is used for geometries with spatial periodicity, such as blade cascades or fully-developed channel flow. In such cases, there is no \"inlet\" in the traditional sense; the flow re-enters the domain with the properties it had upon exiting. The concept of specifying inlet $k$ and $\\omega$ is therefore mutually exclusive with the use of periodic boundaries in the main flow direction. The derived inlet conditions are thus for non-periodic problems.\n\nIn summary, the derived inlet specification for $k$ and $\\omega$ is a standard, physically grounded method for initializing a RANS simulation. It ensures mathematical and physical compatibility with other common boundary condition types used in CFD, forming a well-posed problem setup.", "answer": "$$ \\boxed{\\sqrt{\\frac{3}{2}} C_{\\mu}^{-\\frac{1}{4}} \\frac{I U_{\\infty}}{L}} $$", "id": "3335042"}, {"introduction": "An ideal outflow boundary condition should be \"invisible,\" allowing fluid to exit the computational domain without generating unphysical reflections or instabilities. However, achieving this is non-trivial, as poorly formulated conditions can artificially inject energy into the system, leading to simulation failure. This exercise employs the energy method, a powerful tool from numerical analysis, to rigorously investigate the stability of outflow conditions for the incompressible Navier-Stokes equations, revealing why some common approaches can fail and how to construct alternatives that are guaranteed to be stable. [@problem_id:3335037]", "problem": "Consider the incompressible Navier–Stokes equations for a Newtonian fluid in a bounded domain with a planar outflow boundary subset. Let the velocity be $u(x,t)$ and the pressure be $p(x,t)$, both nondimensional. The equations are\n$$\n\\partial_t u + (u \\cdot \\nabla) u + \\nabla p - \\nu \\Delta u = 0, \\quad \\nabla \\cdot u = 0,\n$$\nwith kinematic viscosity $\\nu \\ge 0$. Let the discrete spatial operator be chosen to be skew-symmetric for the convective term and consistent with a Summation-By-Parts (SBP) property so that the semi-discrete kinetic energy budget mirrors the continuous integration-by-parts identities, up to boundary terms. Define the (nondimensional) kinetic energy\n$$\nE(t) = \\frac{1}{2} \\int_{\\Omega} |u|^2 \\, dx.\n$$\nAssume there are no body forces and that all boundaries except the outflow contribute no energy production (for instance, no-slip walls or symmetry planes that imply zero work-rate by boundary tractions). On the outflow boundary subset, two classes of conditions are to be examined:\n\n- A natural, traction-type boundary condition sometimes referred to as a “do-nothing” outflow, obtained from the weak form by leaving the traction uncompensated.\n\n- A convective outflow condition on the plane $x=L$ of the form $\\partial_t u + U_0 \\partial_{x} u = 0$ with a given constant speed $U_0$.\n\nYour tasks are:\n\n1) Starting from the fundamental identities obtained by multiplying the momentum equation by $u$ and integrating over the domain, and using the incompressibility constraint, derive the semi-discrete kinetic energy balance that isolates a boundary energy production term on the outflow. Express this boundary term in a form that depends only on the local normal velocity $u \\cdot n$, the traction $t = \\left( -p I + \\nu \\nabla u \\right) n$, and the local speed $|u|^2$, without assuming any particular sign of $u \\cdot n$. Then, specialize this balance to the “do-nothing” case by setting the traction to zero on the outflow. Using only the resulting expression and first principles, determine a pointwise sign condition on $u \\cdot n$ under which the “do-nothing” boundary is guaranteed to be energy non-increasing. Then, propose and justify an energy-stable modification of the natural boundary condition that reduces to the “do-nothing” when $u \\cdot n \\ge 0$ and that prevents energy inflow when $u \\cdot n  0$.\n\n2) For the convective outflow condition $\\partial_t u + U_0 \\partial_x u = 0$ on the plane $x=L$, derive its contribution to the kinetic energy balance using the SBP/skew-symmetric discrete framework. Determine the sign condition on $U_0$ that guarantees the outflow boundary contribution is energy non-increasing.\n\n3) Based on the derived boundary energy terms, implement a computation that, for a discrete set of outflow boundary nodes with quadrature weights, evaluates the boundary energy production predicted by:\n- the “do-nothing” traction-free condition,\n- the energy-stable modification you proposed in task 1),\n- the convective outflow with constant $U_0$ from task 2).\n\nA boundary condition is deemed to violate the discrete kinetic energy budget if and only if its discrete boundary energy production (the outflow boundary contribution to $\\frac{dE}{dt}$ obtained in your derivation) is strictly positive. Otherwise, it is deemed energy non-increasing.\n\nUse nondimensional variables throughout, so no physical units are required.\n\nTest Suite and Output Specification:\n\nUse the following five test cases. Each test case is a tuple consisting of:\n- a list of local squared speeds $|u|^2$ at outflow quadrature points,\n- a list of local normal velocities $u \\cdot n$ at those points (with the outward unit normal $n$ pointing out of the domain),\n- a list of positive quadrature weights for those points,\n- the constant convective speed $U_0$ for the convective outflow condition at $x=L$.\n\nThe test cases are:\n\n- Case A: $|u|^2 = [\\,1.0,\\,0.25\\,]$, $u \\cdot n = [\\,0.8,\\,1.2\\,]$, weights $[\\,1.0,\\,1.0\\,]$, $U_0 = 1.0$.\n- Case B: $|u|^2 = [\\,0.5,\\,3.0\\,]$, $u \\cdot n = [\\,0.2,\\,-0.7\\,]$, weights $[\\,1.0,\\,1.0\\,]$, $U_0 = 1.0$.\n- Case C: $|u|^2 = [\\,1.0,\\,1.0\\,]$, $u \\cdot n = [\\,0.0,\\,0.0\\,]$, weights $[\\,1.0,\\,1.0\\,]$, $U_0 = 0.0$.\n- Case D: $|u|^2 = [\\,1.5,\\,0.2\\,]$, $u \\cdot n = [\\,-0.3,\\,-0.4\\,]$, weights $[\\,1.0,\\,1.0\\,]$, $U_0 = -0.5$.\n- Case E: $|u|^2 = [\\,2.0,\\,2.0,\\,2.0\\,]$, $u \\cdot n = [\\,0.1,\\,-0.2,\\,0.3\\,]$, weights $[\\,0.5,\\,1.0,\\,1.5\\,]$, $U_0 = 0.4$.\n\nYour program must compute, for each case, a triplet of booleans:\n- the first boolean indicates whether the “do-nothing” condition is energy non-increasing,\n- the second boolean indicates whether your energy-stable modification is energy non-increasing,\n- the third boolean indicates whether the convective outflow condition is energy non-increasing.\n\nYour program should produce a single line of output containing the results as a comma-separated list of the five triplets, enclosed in square brackets, with no spaces. For example, a valid format with two hypothetical triplets would be: [[True,False,True],[False,True,True]].", "solution": "The problem is valid as it is scientifically grounded, well-posed, and objective, based on standard principles of computational fluid dynamics and the energy method for analyzing the stability of numerical schemes for the Navier-Stokes equations.\n\nThe solution is presented in three parts as requested by the problem statement. All mathematical entities are rendered in LaTeX as required.\n\n1) Derivation of the kinetic energy balance and analysis of the \"do-nothing\" boundary condition.\n\nWe begin with the incompressible Navier-Stokes momentum equation, with velocity $\\mathbf{u}$, pressure $p$, and kinematic viscosity $\\nu$:\n$$\n\\partial_t \\mathbf{u} + (\\mathbf{u} \\cdot \\nabla) \\mathbf{u} + \\nabla p - \\nu \\Delta \\mathbf{u} = 0\n$$\nTo derive the evolution equation for the total kinetic energy, $E(t) = \\frac{1}{2} \\int_{\\Omega} |\\mathbf{u}|^2 \\, d\\mathbf{x}$, we take the $L^2$ inner product of the momentum equation with the velocity field $\\mathbf{u}$:\n$$\n\\int_{\\Omega} \\mathbf{u} \\cdot (\\partial_t \\mathbf{u}) \\, d\\mathbf{x} + \\int_{\\Omega} \\mathbf{u} \\cdot ((\\mathbf{u} \\cdot \\nabla) \\mathbf{u}) \\, d\\mathbf{x} + \\int_{\\Omega} \\mathbf{u} \\cdot \\nabla p \\, d\\mathbf{x} - \\nu \\int_{\\Omega} \\mathbf{u} \\cdot \\Delta \\mathbf{u} \\, d\\mathbf{x} = 0\n$$\nWe analyze each term:\n- The time-derivative term is $\\int_{\\Omega} \\mathbf{u} \\cdot \\partial_t \\mathbf{u} \\, d\\mathbf{x} = \\int_{\\Omega} \\frac{1}{2} \\partial_t(|\\mathbf{u}|^2) \\, d\\mathbf{x} = \\frac{d}{dt} \\left(\\frac{1}{2} \\int_{\\Omega} |\\mathbf{u}|^2 \\, d\\mathbf{x}\\right) = \\frac{dE}{dt}$.\n- The convective and pressure terms can be combined. Using the vector calculus identity $\\nabla \\cdot (\\phi \\mathbf{v}) = \\phi(\\nabla \\cdot \\mathbf{v}) + \\mathbf{v} \\cdot \\nabla \\phi$ and the incompressibility constraint $\\nabla \\cdot \\mathbf{u} = 0$:\n$$\n\\mathbf{u} \\cdot ((\\mathbf{u} \\cdot \\nabla) \\mathbf{u}) + \\mathbf{u} \\cdot \\nabla p = \\mathbf{u} \\cdot \\nabla\\left(\\frac{1}{2}|\\mathbf{u}|^2\\right) + \\mathbf{u} \\cdot \\nabla p = \\nabla \\cdot \\left(\\left(\\frac{1}{2}|\\mathbf{u}|^2 + p\\right)\\mathbf{u}\\right)\n$$\nIntegrating over the domain $\\Omega$ and applying the divergence theorem gives the boundary contribution from these terms:\n$$\n\\int_{\\Omega} \\left( \\mathbf{u} \\cdot ((\\mathbf{u} \\cdot \\nabla) \\mathbf{u}) + \\mathbf{u} \\cdot \\nabla p \\right) \\, d\\mathbf{x} = \\int_{\\partial\\Omega} \\left(\\frac{1}{2}|\\mathbf{u}|^2 + p\\right)(\\mathbf{u} \\cdot \\mathbf{n}) \\, dS\n$$\nwhere $\\mathbf{n}$ is the outward unit normal. This identity also relies on the skew-symmetric property of the discrete convective operator, which makes its contribution to the energy budget appear only at the boundary.\n- The viscous term is analyzed using integration by parts (Green's first identity component-wise):\n$$\n- \\nu \\int_{\\Omega} \\mathbf{u} \\cdot \\Delta \\mathbf{u} \\, d\\mathbf{x} = - \\nu \\left( \\int_{\\partial\\Omega} \\mathbf{u} \\cdot ((\\nabla \\mathbf{u}) \\mathbf{n}) \\, dS - \\int_{\\Omega} |\\nabla \\mathbf{u}|^2 d\\Omega \\right)\n$$\nwhere $|\\nabla \\mathbf{u}|^2 = \\sum_{i,j} (\\partial_j u_i)^2$ is the Frobenius norm of the velocity gradient tensor, representing viscous dissipation.\n\nCombining all terms yields the kinetic energy evolution equation:\n$$\n\\frac{dE}{dt} + \\int_{\\partial\\Omega} \\left(\\frac{1}{2}|\\mathbf{u}|^2 + p\\right)(\\mathbf{u} \\cdot \\mathbf{n}) \\, dS - \\nu \\int_{\\partial\\Omega} \\mathbf{u} \\cdot ((\\nabla \\mathbf{u}) \\mathbf{n}) \\, dS + \\nu \\int_{\\Omega} |\\nabla \\mathbf{u}|^2 d\\Omega = 0\n$$\nThe problem states that all boundaries except the outflow boundary $\\partial\\Omega_{out}$ have a net-zero energy contribution. The term $\\nu \\int_{\\Omega} |\\nabla \\mathbf{u}|^2 d\\Omega$ is the viscous dissipation rate, which is always non-negative, hence it always decreases kinetic energy. The boundary energy production on $\\partial\\Omega_{out}$ is the contribution to $\\frac{dE}{dt}$ from the boundary integrals. Isolating these terms, we get:\n$$\n\\left. \\frac{dE}{dt} \\right|_{bdy} = - \\int_{\\partial\\Omega_{out}} \\left(\\frac{1}{2}|\\mathbf{u}|^2 + p\\right)(\\mathbf{u} \\cdot \\mathbf{n}) \\, dS + \\nu \\int_{\\partial\\Omega_{out}} \\mathbf{u} \\cdot ((\\nabla \\mathbf{u}) \\mathbf{n}) \\, dS\n$$\nThis can be rewritten using the traction vector $\\mathbf{t} = (-p \\mathbf{I} + \\nu \\nabla \\mathbf{u})\\mathbf{n}$:\n$$\n\\left. \\frac{dE}{dt} \\right|_{bdy} = \\int_{\\partial\\Omega_{out}} \\left( -\\frac{1}{2}|\\mathbf{u}|^2(\\mathbf{u} \\cdot \\mathbf{n}) - p(\\mathbf{u} \\cdot \\mathbf{n}) + \\nu \\mathbf{u} \\cdot ((\\nabla \\mathbf{u})\\mathbf{n}) \\right) \\, dS\n$$\n$$\n\\left. \\frac{dE}{dt} \\right|_{bdy} = \\int_{\\partial\\Omega_{out}} \\left( \\mathbf{u} \\cdot (-p\\mathbf{n} + \\nu(\\nabla \\mathbf{u})\\mathbf{n}) - \\frac{1}{2}|\\mathbf{u}|^2(\\mathbf{u} \\cdot \\mathbf{n}) \\right) \\, dS\n$$\n$$\n\\left. \\frac{dE}{dt} \\right|_{bdy} = \\int_{\\partial\\Omega_{out}} \\left( \\mathbf{u} \\cdot \\mathbf{t} - \\frac{1}{2}|\\mathbf{u}|^2(\\mathbf{u} \\cdot \\mathbf{n}) \\right) \\, dS\n$$\nThis is the desired expression for the boundary energy production, which is the rate of work done by boundary tractions minus the convective flux of kinetic energy.\n\nFor the \"do-nothing\" outflow condition, the traction $\\mathbf{t}$ is set to zero on $\\partial\\Omega_{out}$. The boundary energy production becomes:\n$$\n\\left. \\frac{dE}{dt} \\right|_{bdy, \\text{do-nothing}} = -\\frac{1}{2} \\int_{\\partial\\Omega_{out}} |\\mathbf{u}|^2 (\\mathbf{u} \\cdot \\mathbf{n}) \\, dS\n$$\nFor this boundary condition to be energy non-increasing, we must have $\\left. \\frac{dE}{dt} \\right|_{bdy} \\le 0$. Since $|\\mathbf{u}|^2 \\ge 0$, this integral is guaranteed to be non-positive if and only if the integrand is pointwise non-negative. This leads to the condition $\\mathbf{u} \\cdot \\mathbf{n} \\ge 0$ everywhere on $\\partial\\Omega_{out}$. Any region of inflow ($\\mathbf{u} \\cdot \\mathbf{n}  0$), often called backflow, will lead to a positive contribution to $\\frac{dE}{dt}$, making the condition energetically unstable.\n\nTo construct an energy-stable modification, we must alter the traction $\\mathbf{t}$ in regions of backflow to prevent energy from increasing. The goal is to define $\\mathbf{t}$ such that the integrand $I = \\mathbf{u} \\cdot \\mathbf{t} - \\frac{1}{2}|\\mathbf{u}|^2(\\mathbf{u} \\cdot \\mathbf{n})$ is always non-positive.\n- When $\\mathbf{u} \\cdot \\mathbf{n} \\ge 0$, we want to recover the \"do-nothing\" condition. We set $\\mathbf{t}=0$, which gives $I = - \\frac{1}{2}|\\mathbf{u}|^2(\\mathbf{u} \\cdot \\mathbf{n}) \\le 0$. This is stable.\n- When $\\mathbf{u} \\cdot \\mathbf{n}  0$, the \"do-nothing\" condition $\\mathbf{t}=0$ gives $I = - \\frac{1}{2}|\\mathbf{u}|^2(\\mathbf{u} \\cdot \\mathbf{n}) > 0$, which is unstable. To remedy this, we can choose a traction $\\mathbf{t}$ that counteracts this positive term. A simple and effective choice is to set the work term $\\mathbf{u} \\cdot \\mathbf{t}$ equal to the kinetic energy advection term, thereby making the net contribution zero.\n$$\n\\mathbf{u} \\cdot \\mathbf{t} = \\frac{1}{2}|\\mathbf{u}|^2(\\mathbf{u} \\cdot \\mathbf{n})\n$$\nA simple traction that satisfies this is $\\mathbf{t} = \\frac{1}{2}(\\mathbf{u} \\cdot \\mathbf{n})\\mathbf{u}$. This leads to the proposed modification:\n$$\n\\mathbf{t} = \\frac{1}{2}\\min(0, \\mathbf{u} \\cdot \\mathbf{n}) \\mathbf{u}\n$$\nLet's verify this. If $\\mathbf{u} \\cdot \\mathbf{n} \\ge 0$, $\\min(0, \\mathbf{u} \\cdot \\mathbf{n}) = 0$, so $\\mathbf{t}=0$. If $\\mathbf{u} \\cdot \\mathbf{n}  0$, $\\min(0, \\mathbf{u} \\cdot \\mathbf{n}) = \\mathbf{u} \\cdot \\mathbf{n}$, so $\\mathbf{t} = \\frac{1}{2}(\\mathbf{u} \\cdot \\mathbf{n}) \\mathbf{u}$. The integrand becomes $I = \\mathbf{u} \\cdot (\\frac{1}{2}(\\mathbf{u} \\cdot \\mathbf{n})\\mathbf{u}) - \\frac{1}{2}|\\mathbf{u}|^2(\\mathbf{u} \\cdot \\mathbf{n}) = \\frac{1}{2}(\\mathbf{u} \\cdot \\mathbf{n})|\\mathbf{u}|^2 - \\frac{1}{2}|\\mathbf{u}|^2(\\mathbf{u} \\cdot \\mathbf{n}) = 0$.\nThus, with this modified traction, the boundary energy production is always non-positive, guaranteeing energy stability.\n\n2) Analysis of the convective outflow condition.\n\nThe convective outflow condition is $\\partial_t \\mathbf{u} + U_0 \\partial_x \\mathbf{u} = 0$ on the plane $x=L$. The SBP/skew-symmetric framework provides a robust way to analyze the stability of boundary conditions by relating them to the energy flux. By analogy with the one-dimensional advection equation $\\partial_t f + c \\partial_x f = 0$, the energy is $\\frac{1}{2}\\int f^2 dx$. The rate of change of energy is determined by the flux at the boundaries: $\\frac{d}{dt} \\left(\\frac{1}{2}\\int f^2 dx\\right) = -\\frac{c}{2}[f^2]_{\\text{boundaries}}$. At an outflow boundary, the energy flux is $-\\frac{c}{2}f^2$. For this contribution to be non-positive (energy non-increasing), we require $c \\ge 0$.\n\nExtrapolating this well-established principle to the vector-valued case at hand, the kinetic energy is $\\frac{1}{2}|\\mathbf{u}|^2$. The energy production associated with the convective boundary condition is therefore modeled as the integral of the energy flux over the boundary:\n$$\n\\left. \\frac{dE}{dt} \\right|_{bdy, \\text{conv}} = - \\frac{1}{2} \\int_{\\partial\\Omega_{out}} U_0 |\\mathbf{u}|^2 \\, dS\n$$\nFor this to be energy non-increasing, we require $\\left. \\frac{dE}{dt} \\right|_{bdy, \\text{conv}} \\le 0$. Because $|\\mathbf{u}|^2 \\ge 0$ and the integral is over a surface, this condition is satisfied for arbitrary velocity fields if the constant $U_0$ is non-negative. Therefore, the sign condition for guaranteed energy stability is $U_0 \\ge 0$. A positive $U_0$ ensures that energy is convected out of the domain.\n\n3) Implementation of the boundary energy production computation.\n\nThe discrete boundary energy production $P_{bdy}$ is computed by summing the integrand multiplied by the quadrature weight $w_j$ over all discrete points $j$ on the outflow boundary. A condition is energy non-increasing if $P_{bdy} \\le 0$. Let the data at point $j$ be $|\\mathbf{u}_j|^2$, $(\\mathbf{u} \\cdot \\mathbf{n})_j$, and $w_j$.\n- **\"Do-nothing\" condition**: The discrete energy production is:\n$$ P_{bdy, 1} = \\sum_j w_j \\left( -\\frac{1}{2} |\\mathbf{u}_j|^2 (\\mathbf{u} \\cdot \\mathbf{n})_j \\right) $$\n- **Energy-stable modification**: The integrand is $0$ for $(\\mathbf{u} \\cdot \\mathbf{n})_j  0$ and $-\\frac{1}{2}|\\mathbf{u}_j|^2 (\\mathbf{u} \\cdot \\mathbf{n})_j$ for $(\\mathbf{u} \\cdot \\mathbf{n})_j \\ge 0$. The discrete energy production is:\n$$ P_{bdy, 2} = \\sum_{j \\text{ where } (\\mathbf{u} \\cdot \\mathbf{n})_j \\ge 0} w_j \\left( -\\frac{1}{2} |\\mathbf{u}_j|^2 (\\mathbf{u} \\cdot \\mathbf{n})_j \\right) $$\nBy construction, every term in this sum is non-positive, so $P_{bdy, 2} \\le 0$ is always true.\n- **Convective outflow condition**: The discrete energy production is:\n$$ P_{bdy, 3} = \\sum_j w_j \\left( -\\frac{1}{2} U_0 |\\mathbf{u}_j|^2 \\right) = -\\frac{1}{2} U_0 \\sum_j w_j |\\mathbf{u}_j|^2 $$\nThe following program implements these computations for the given test suite.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the energy stability for three outflow boundary conditions\n    across five test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A\n        {'u2': [1.0, 0.25], 'un': [0.8, 1.2], 'weights': [1.0, 1.0], 'U0': 1.0},\n        # Case B\n        {'u2': [0.5, 3.0], 'un': [0.2, -0.7], 'weights': [1.0, 1.0], 'U0': 1.0},\n        # Case C\n        {'u2': [1.0, 1.0], 'un': [0.0, 0.0], 'weights': [1.0, 1.0], 'U0': 0.0},\n        # Case D\n        {'u2': [1.5, 0.2], 'un': [-0.3, -0.4], 'weights': [1.0, 1.0], 'U0': -0.5},\n        # Case E\n        {'u2': [2.0, 2.0, 2.0], 'un': [0.1, -0.2, 0.3], 'weights': [0.5, 1.0, 1.5], 'U0': 0.4},\n    ]\n\n    results = []\n    # A small tolerance to test for strictly positive values.\n    tol = 1e-12\n\n    for case in test_cases:\n        u_squared = np.array(case['u2'])\n        u_dot_n = np.array(case['un'])\n        weights = np.array(case['weights'])\n        U0 = case['U0']\n\n        # 1. \"Do-nothing\" condition\n        # P_bdy = sum( -0.5 * |u|^2 * (u . n) * w )\n        p_bdy1 = np.sum(-0.5 * u_squared * u_dot_n * weights)\n        is_stable1 = p_bdy1 = tol\n\n        # 2. Energy-stable modification\n        # Integrand is -0.5*|u|^2*(u.n) where u.n =0, and 0 otherwise.\n        integrand_2 = np.where(u_dot_n = 0, -0.5 * u_squared * u_dot_n, 0)\n        p_bdy2 = np.sum(integrand_2 * weights)\n        is_stable2 = p_bdy2 = tol\n\n        # 3. Convective outflow condition\n        # P_bdy = -0.5 * U0 * sum( |u|^2 * w )\n        p_bdy3 = -0.5 * U0 * np.sum(u_squared * weights)\n        is_stable3 = p_bdy3 = tol\n\n        results.append((is_stable1, is_stable2, is_stable3))\n\n    # Format the final output string as specified, e.g., [[True,False,True],[...]]\n    triplet_strings = []\n    for r in results:\n        # Convert boolean to lowercase 'true'/'false' if needed, but str(bool) gives 'True'/'False'\n        # which is more common in Python context. The example shows capitalized Booleans.\n        triplet_strings.append(f\"[{r[0]},{r[1]},{r[2]}]\")\n    \n    final_output = f\"[{','.join(triplet_strings)}]\"\n    # Replace Python's default spaces after commas for exact format matching.\n    final_output = final_output.replace(\" \", \"\")\n\n    print(final_output)\n\nsolve()\n```", "id": "3335037"}, {"introduction": "Periodic boundaries are indispensable for efficiently simulating systems with repeating geometries, such as turbomachinery cascades or heat exchanger arrays. A significant practical challenge arises when the meshes on the two corresponding periodic faces are non-conformal, meaning they do not align perfectly. This final practice addresses the crucial task of creating a numerical mapping between such faces that ensures strict, bit-for-bit conservation of mass, momentum, and energy across the interface, a non-negotiable requirement for the physical fidelity of any finite volume simulation. [@problem_id:3334990]", "problem": "You are given two parallel periodic planes, denoted as $\\Gamma_L$ (donor side) and $\\Gamma_R$ (receiver side), that together form a periodic boundary in a compressible flow discretized by the Finite Volume Method (FVM). Each plane is tessellated by an unstructured set of faces. The interface geometry on each plane is represented by a one-dimensional parameterization $s \\in [0,L]$ along the interface curve. Each face on either plane is identified by an interval in $s$ and has associated geometric and flow data. The goal is to construct a strictly conservative discrete mapping between the donor faces on $\\Gamma_L$ and the receiver faces on $\\Gamma_R$ such that the total mass, momentum, and energy fluxes are exactly conserved across the periodic interface even when face areas and unit normals differ between the planes.\n\nThe fundamental base of this problem is the conservation laws for compressible flow expressed by the compressible Euler equations and their surface fluxes. For a face with unit normal vector $\\mathbf{n}$ and area $A$, assuming a piecewise constant reconstruction per face, the convective mass flux through the face is\n$$\nF_m = \\rho \\, (\\mathbf{u} \\cdot \\mathbf{n}) \\, A,\n$$\nthe convective momentum flux vector is\n$$\n\\mathbf{F}_{\\mathbf{p}} = F_m \\, \\mathbf{u},\n$$\nand the convective energy flux is\n$$\nF_E = F_m \\, E,\n$$\nwhere $\\rho$ is the density, $\\mathbf{u}$ is the velocity vector, and $E$ is the specific total energy in joules per kilogram. These definitions exclude the pressure term and viscous stresses and focus on the convective part, which suffices for demonstrating strict conservation via a discrete mapping and ghost-state construction.\n\nYou must construct a linear mapping matrix $W \\in \\mathbb{R}^{|R| \\times |D|}$ between the donor face set $D$ on $\\Gamma_L$ and the receiver face set $R$ on $\\Gamma_R$ using a common-refinement in the one-dimensional parameterization. Let donor face $i \\in D$ cover the interval $[s_{i0}, s_{i1}]$ of length $\\ell_i = s_{i1} - s_{i0}$ and receiver face $j \\in R$ cover $[s_{j0}, s_{j1}]$. Define the overlap length\n$$\n\\ell_{ji} = \\max\\!\\left(0, \\min(s_{i1}, s_{j1}) - \\max(s_{i0}, s_{j0})\\right),\n$$\nand the discrete mapping weight\n$$\nW_{ji} = \\frac{\\ell_{ji}}{\\ell_i}.\n$$\nThis mapping satisfies $\\sum_{j \\in R} W_{ji} = 1$ for every donor face $i \\in D$ when the receiver tessellation covers the same global interval as the donor tessellation.\n\nUsing $W$, define the receiver-assigned convective fluxes by linear combination of donor fluxes:\n$$\nF_m^{(r)}(j) = \\sum_{i \\in D} W_{ji} \\, F_m^{(d)}(i),\n$$\n$$\n\\mathbf{F}_{\\mathbf{p}}^{(r)}(j) = \\sum_{i \\in D} W_{ji} \\, F_m^{(d)}(i) \\, \\mathbf{u}_i,\n$$\n$$\nF_E^{(r)}(j) = \\sum_{i \\in D} W_{ji} \\, F_m^{(d)}(i) \\, E_i,\n$$\nwhere $F_m^{(d)}(i)$ is the donor mass flux, and $\\mathbf{u}_i$, $E_i$ are the donor face’s velocity and specific total energy, respectively.\n\nTo ensure strict conservation on the receiver faces with possibly different areas $A_j$ and normals $\\mathbf{n}_j$, construct a ghost state on each receiver face $j$ as follows:\n- If $|F_m^{(r)}(j)| > \\varepsilon$ for a small tolerance $\\varepsilon$, set\n$$\n\\mathbf{u}_j^{\\mathrm{ghost}} = \\frac{\\mathbf{F}_{\\mathbf{p}}^{(r)}(j)}{F_m^{(r)}(j)}, \\quad\nE_j^{\\mathrm{ghost}} = \\frac{F_E^{(r)}(j)}{F_m^{(r)}(j)}, \\quad\n\\rho_j^{\\mathrm{ghost}} = \\frac{F_m^{(r)}(j)}{A_j \\, \\left(\\mathbf{u}_j^{\\mathrm{ghost}} \\cdot \\mathbf{n}_j\\right)}.\n$$\n- If $|F_m^{(r)}(j)| \\le \\varepsilon$, set\n$$\n\\mathbf{u}_j^{\\mathrm{ghost}} = \\mathbf{0}, \\quad E_j^{\\mathrm{ghost}} = 0, \\quad \\rho_j^{\\mathrm{ghost}} = 0.\n$$\nWith this construction, the receiver face’s computed convective fluxes using its own geometry satisfy\n$$\nF_m^{\\mathrm{check}}(j) = \\rho_j^{\\mathrm{ghost}} \\, \\left(\\mathbf{u}_j^{\\mathrm{ghost}} \\cdot \\mathbf{n}_j\\right) \\, A_j = F_m^{(r)}(j),\n$$\n$$\n\\mathbf{F}_{\\mathbf{p}}^{\\mathrm{check}}(j) = F_m^{\\mathrm{check}}(j) \\, \\mathbf{u}_j^{\\mathrm{ghost}} = \\mathbf{F}_{\\mathbf{p}}^{(r)}(j),\n$$\n$$\nF_E^{\\mathrm{check}}(j) = F_m^{\\mathrm{check}}(j) \\, E_j^{\\mathrm{ghost}} = F_E^{(r)}(j),\n$$\nensuring strict per-face equality and hence strict global conservation on the interface. Angles are not directly used; normals are provided component-wise. All physical quantities use International System of Units (SI): density in kilograms per cubic meter, velocity in meters per second, area in square meters, specific total energy in joules per kilogram, mass flux in kilograms per second, momentum flux in newtons, and energy flux in watts. Your program must output booleans, so do not print units.\n\nImplement a program that:\n1. Constructs $W$ from donor and receiver face intervals.\n2. Computes donor convective fluxes $F_m^{(d)}(i)$, $\\mathbf{F}_{\\mathbf{p}}^{(d)}(i)$, $F_E^{(d)}(i)$.\n3. Computes receiver-assigned fluxes via $W$.\n4. Constructs ghost states on receiver faces as above.\n5. Verifies per-face equality of assigned and checked fluxes and global conservation by comparing the sums over all faces on each side using a small tolerance.\n\nUse the following test suite, each defining $L$, donor faces, and receiver faces. Each face is specified by $(s_0, s_1, A, \\mathbf{n}, \\rho, \\mathbf{u}, E)$ with $\\mathbf{n}$ and $\\mathbf{u}$ given as $(u_x,u_y,u_z)$.\n\nTest case $1$ (general case with different areas and mild normal misalignment):\n- $L = 1.0$.\n- Donors $D$:\n  - $[0.0, 0.5], A=1.0, \\mathbf{n}=(1.0, 0.0, 0.0), \\rho=1.2, \\mathbf{u}=(10.0, 2.0, 0.0), E=100000.0$.\n  - $[0.5, 0.75], A=0.5, \\mathbf{n}=(1.0, 0.0, 0.0), \\rho=1.0, \\mathbf{u}=(8.0, -1.0, 0.0), E=90000.0$.\n  - $[0.75, 1.0], A=1.5, \\mathbf{n}=(0.965925826, 0.258819045, 0.0), \\rho=0.95, \\mathbf{u}=(12.0, 0.5, 0.0), E=110000.0$.\n- Receivers $R$:\n  - $[0.0, 0.4], A=0.8, \\mathbf{n}=(-0.980580675, -0.196116135, 0.0)$.\n  - $[0.4, 1.0], A=2.2, \\mathbf{n}=(-1.0, 0.0, 0.0)$.\n  - For receiver faces, $\\rho$, $\\mathbf{u}$, $E$ are not given; they are constructed as ghost states.\n\nTest case $2$ (stronger misalignment and nonuniform partitioning over a longer interface):\n- $L = 2.0$.\n- Donors $D$:\n  - $[0.0, 0.6], A=0.7, \\mathbf{n}=(1.0, 0.0, 0.0), \\rho=1.3, \\mathbf{u}=(5.0, 0.0, 1.0), E=80000.0$.\n  - $[0.6, 1.5], A=1.2, \\mathbf{n}=(0.93969262, 0.342020143, 0.0), \\rho=1.1, \\mathbf{u}=(7.0, -0.5, 0.2), E=92000.0$.\n  - $[1.5, 2.0], A=0.9, \\mathbf{n}=(1.0, 0.0, 0.0), \\rho=1.25, \\mathbf{u}=(6.0, 0.2, -0.1), E=88000.0$.\n- Receivers $R$:\n  - $[0.0, 0.5], A=0.6, \\mathbf{n}=(-0.93969262, -0.342020143, 0.0)$.\n  - $[0.5, 1.2], A=1.0, \\mathbf{n}=(-1.0, 0.0, 0.0)$.\n  - $[1.2, 2.0], A=1.2, \\mathbf{n}=(-0.965925826, -0.258819045, 0.0)$.\n\nTest case $3$ (edge case with small normal component and highly varying areas):\n- $L = 1.0$.\n- Donors $D$:\n  - $[0.0, 0.3], A=0.3, \\mathbf{n}=(1.0, 0.0, 0.0), \\rho=1.0, \\mathbf{u}=(2.0, 0.0, 0.0), E=50000.0$.\n  - $[0.3, 0.7], A=1.7, \\mathbf{n}=(1.0, 0.0, 0.0), \\rho=1.0, \\mathbf{u}=(0.1, 4.0, 0.0), E=55000.0$.\n  - $[0.7, 1.0], A=0.5, \\mathbf{n}=(0.965925826, 0.258819045, 0.0), \\rho=1.0, \\mathbf{u}=(0.01, 0.1, 0.0), E=50000.0$.\n- Receivers $R$:\n  - $[0.0, 0.2], A=0.2, \\mathbf{n}=(-1.0, 0.0, 0.0)$.\n  - $[0.2, 0.6], A=1.6, \\mathbf{n}=(-0.999847695, -0.017452406, 0.0)$.\n  - $[0.6, 1.0], A=0.7, \\mathbf{n}=(-0.984807753, -0.173648178, 0.0)$.\n\nTest case $4$ (includes negative and zero donor mass flux contributions):\n- $L = 1.5$.\n- Donors $D$:\n  - $[0.0, 0.5], A=0.4, \\mathbf{n}=(1.0, 0.0, 0.0), \\rho=1.2, \\mathbf{u}=(-3.0, 0.0, 0.0), E=60000.0$.\n  - $[0.5, 1.0], A=0.8, \\mathbf{n}=(0.965925826, 0.258819045, 0.0), \\rho=1.0, \\mathbf{u}=(3.0, 1.0, 0.0), E=70000.0$.\n  - $[1.0, 1.5], A=0.5, \\mathbf{n}=(1.0, 0.0, 0.0), \\rho=1.1, \\mathbf{u}=(0.0, 2.0, 0.0), E=65000.0$.\n- Receivers $R$:\n  - $[0.0, 0.3], A=0.3, \\mathbf{n}=(-1.0, 0.0, 0.0)$.\n  - $[0.3, 1.2], A=1.4, \\mathbf{n}=(-0.965925826, -0.258819045, 0.0)$.\n  - $[1.2, 1.5], A=0.5, \\mathbf{n}=(-1.0, 0.0, 0.0)$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. For each test case, output a list $[b_m, b_p, b_E]$ of booleans indicating strict global conservation of mass ($b_m$), momentum ($b_p$), and energy ($b_E$), respectively, based on comparing the sums of donor and receiver-checked fluxes within a tolerance of $10^{-9}$. The final output must therefore be a list of lists of booleans in the form $\\big[\\,[b_m^{(1)}, b_p^{(1)}, b_E^{(1)}], [b_m^{(2)}, b_p^{(2)}, b_E^{(2)}], [b_m^{(3)}, b_p^{(3)}, b_E^{(3)}], [b_m^{(4)}, b_p^{(4)}, b_E^{(4)}]\\,\\big]$.", "solution": "The problem statement is assessed to be valid. It is scientifically grounded in the principles of computational fluid dynamics (CFD), specifically the Finite Volume Method (FVM) for compressible flows. The formulation is mathematically well-posed, objective, and provides a complete and consistent set of data and procedures for a verifiable computational task. The task is to implement and verify a strictly conservative mapping for periodic boundary conditions, a standard and important technique in numerical simulations.\n\nThe core of the problem lies in demonstrating that a specific numerical scheme for coupling two periodic boundaries, $\\Gamma_L$ and $\\Gamma_R$, conserves mass, momentum, and energy. The conservation property is by design, stemming from the construction of a linear mapping derived from a common refinement of the face tessellations. The procedure's validity will be confirmed by implementing it and verifying that the total fluxes entering the domain through the donor boundary $\\Gamma_L$ exactly equal the total fluxes reconstituted on the receiver boundary $\\Gamma_R$.\n\nThe methodology is based on a one-dimensional parameterization, $s$, of the interface. Each face on the donor and receiver boundaries corresponds to an interval in $s$. The mapping between a donor face $i$ and a receiver face $j$ is based on the length of their overlap in this parametric space.\n\nLet the set of donor faces be $D$ and receiver faces be $R$. For each donor face $i \\in D$, we are given its geometry (area $A_i$, unit normal $\\mathbf{n}_i$) and the flow state (density $\\rho_i$, velocity $\\mathbf{u}_i$, specific total energy $E_i$). The values are assumed to be piecewise constant over the face. The convective fluxes are defined as:\n$$\n\\text{Mass flux: } F_m^{(d)}(i) = \\rho_i \\, (\\mathbf{u}_i \\cdot \\mathbf{n}_i) \\, A_i\n$$\n$$\n\\text{Momentum flux: } \\mathbf{F}_{\\mathbf{p}}^{(d)}(i) = F_m^{(d)}(i) \\, \\mathbf{u}_i\n$$\n$$\n\\text{Energy flux: } F_E^{(d)}(i) = F_m^{(d)}(i) \\, E_i\n$$\nFor each receiver face $j \\in R$, we are given its geometry ($A_j$, $\\mathbf{n}_j$). The flow state on the receiver face, termed a \"ghost state\", is what we must construct.\n\nThe procedure to be implemented and verified is as follows:\n\n1.  **Construct the Mapping Matrix**: A mapping matrix $W \\in \\mathbb{R}^{|R| \\times |D|}$ is constructed. Its elements $W_{ji}$ represent the fraction of donor face $i$ that geometrically maps to receiver face $j$. A donor face $i$ covers the parametric interval $[s_{i0}, s_{i1}]$ of length $\\ell_i = s_{i1} - s_{i0}$. A receiver face $j$ covers $[s_{j0}, s_{j1}]$. The overlap length is $\\ell_{ji} = \\max\\!\\left(0, \\min(s_{i1}, s_{j1}) - \\max(s_{i0}, s_{j0})\\right)$. The matrix element is then defined as the ratio of the overlap length to the donor face's total length:\n    $$\n    W_{ji} = \\frac{\\ell_{ji}}{\\ell_i}\n    $$\n    Since the receiver faces form a complete partition of the parametric interval $[0, L]$ that is also covered by the donor faces, the sum of overlap lengths for a given donor face $i$ with all receiver faces $j$ must equal its own length: $\\sum_{j \\in R} \\ell_{ji} = \\ell_i$. This guarantees a crucial property of the mapping matrix:\n    $$\n    \\sum_{j \\in R} W_{ji} = \\sum_{j \\in R} \\frac{\\ell_{ji}}{\\ell_i} = \\frac{1}{\\ell_i} \\sum_{j \\in R} \\ell_{ji} = \\frac{\\ell_i}{\\ell_i} = 1\n    $$\n    This property is the foundation of the scheme's conservative nature.\n\n2.  **Assign Fluxes to Receiver Faces**: The fluxes from the donor side are distributed to the receiver faces using the mapping $W$. The assigned fluxes for a receiver face $j$ are a weighted average of the donor-side contributions:\n    $$\n    F_m^{(r)}(j) = \\sum_{i \\in D} W_{ji} \\, F_m^{(d)}(i)\n    $$\n    $$\n    \\mathbf{F}_{\\mathbf{p}}^{(r)}(j) = \\sum_{i \\in D} W_{ji} \\, \\mathbf{F}_{\\mathbf{p}}^{(d)}(i) = \\sum_{i \\in D} W_{ji} \\, F_m^{(d)}(i) \\, \\mathbf{u}_i\n    $$\n    $$\n    F_E^{(r)}(j) = \\sum_{i \\in D} W_{ji} \\, F_E^{(d)}(i) = \\sum_{i \\in D} W_{ji} \\, F_m^{(d)}(i) \\, E_i\n    $$\n\n3.  **Construct Receiver Ghost States**: To ensure that the assigned fluxes are consistent with the receiver face geometry ($A_j$, $\\mathbf{n}_j$), a \"ghost\" flow state ($\\rho_j^{\\mathrm{ghost}}$, $\\mathbf{u}_j^{\\mathrm{ghost}}$, $E_j^{\\mathrm{ghost}}$) is reverse-engineered from the assigned fluxes.\n    - If the assigned mass flux $|F_m^{(r)}(j)|$ is numerically significant (greater than a small tolerance $\\varepsilon$, e.g., $10^{-12}$), the ghost state is defined by inverting the flux equations:\n    $$\n    \\mathbf{u}_j^{\\mathrm{ghost}} = \\frac{\\mathbf{F}_{\\mathbf{p}}^{(r)}(j)}{F_m^{(r)}(j)}, \\quad\n    E_j^{\\mathrm{ghost}} = \\frac{F_E^{(r)}(j)}{F_m^{(r)}(j)}, \\quad\n    \\rho_j^{\\mathrm{ghost}} = \\frac{F_m^{(r)}(j)}{A_j \\, \\left(\\mathbf{u}_j^{\\mathrm{ghost}} \\cdot \\mathbf{n}_j\\right)}\n    $$\n    - If $|F_m^{(r)}(j)| \\le \\varepsilon$, the flux is considered zero, and the ghost state is set to zero to avoid division by zero and maintain consistency: $\\mathbf{u}_j^{\\mathrm{ghost}} = \\mathbf{0}$, $E_j^{\\mathrm{ghost}} = 0$, $\\rho_j^{\\mathrm{ghost}} = 0$. A potential issue, a zero-valued denominator $A_j \\, (\\mathbf{u}_j^{\\mathrm{ghost}} \\cdot \\mathbf{n}_j)$ when $F_m^{(r)}(j)$ is non-zero, is not explicitly handled by the problem description but represents a limitation of this specific ghost state construction. We proceed by implementing the given formulae.\n\n4.  **Verify Conservation**: The final step is to verify that the fluxes computed using the ghost states and receiver geometry match the assigned fluxes, and more importantly, that the total flux across the interface is conserved.\n    - First, we compute the \"checked\" fluxes on the receiver side:\n    $$\n    F_m^{\\mathrm{check}}(j) = \\rho_j^{\\mathrm{ghost}} \\, \\left(\\mathbf{u}_j^{\\mathrm{ghost}} \\cdot \\mathbf{n}_j\\right) \\, A_j\n    $$\n    $$\n    \\mathbf{F}_{\\mathbf{p}}^{\\mathrm{check}}(j) = F_m^{\\mathrm{check}}(j) \\, \\mathbf{u}_j^{\\mathrm{ghost}}\n    $$\n    $$\n    F_E^{\\mathrm{check}}(j) = F_m^{\\mathrm{check}}(j) \\, E_j^{\\mathrm{ghost}}\n    $$\n    By substituting the definitions of the ghost state variables, it is algebraically trivial to show that $F^{\\mathrm{check}}(j) = F^{(r)}(j)$ for each conserved quantity, provided the denominators in the ghost state construction are non-zero.\n    - Second, we verify global conservation by summing the fluxes over all faces on each side and comparing the totals. For mass, for instance:\n    $$\n    \\sum_{j \\in R} F_m^{\\mathrm{check}}(j) = \\sum_{j \\in R} F_m^{(r)}(j) = \\sum_{j \\in R} \\sum_{i \\in D} W_{ji} F_m^{(d)}(i) = \\sum_{i \\in D} F_m^{(d)}(i) \\left( \\sum_{j \\in R} W_{ji} \\right)\n    $$\n    Since $\\sum_{j \\in R} W_{ji} = 1$, we obtain:\n    $$\n    \\sum_{j \\in R} F_m^{\\mathrm{check}}(j) = \\sum_{i \\in D} F_m^{(d)}(i)\n    $$\n    This demonstrates that the total mass flux is conserved by construction. The same logic applies to momentum and energy. The program will execute these steps and compare the summed donor fluxes to the summed receiver checked fluxes using a numerical tolerance of $10^{-9}$.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements and verifies a conservative mapping for periodic boundary conditions\n    in computational fluid dynamics.\n    \"\"\"\n    \n    # Test case 1\n    donors1 = [\n        ([0.0, 0.5], 1.0, np.array([1.0, 0.0, 0.0]), 1.2, np.array([10.0, 2.0, 0.0]), 100000.0),\n        ([0.5, 0.75], 0.5, np.array([1.0, 0.0, 0.0]), 1.0, np.array([8.0, -1.0, 0.0]), 90000.0),\n        ([0.75, 1.0], 1.5, np.array([0.965925826, 0.258819045, 0.0]), 0.95, np.array([12.0, 0.5, 0.0]), 110000.0)\n    ]\n    receivers1 = [\n        ([0.0, 0.4], 0.8, np.array([-0.980580675, -0.196116135, 0.0])),\n        ([0.4, 1.0], 2.2, np.array([-1.0, 0.0, 0.0]))\n    ]\n\n    # Test case 2\n    donors2 = [\n        ([0.0, 0.6], 0.7, np.array([1.0, 0.0, 0.0]), 1.3, np.array([5.0, 0.0, 1.0]), 80000.0),\n        ([0.6, 1.5], 1.2, np.array([0.93969262, 0.342020143, 0.0]), 1.1, np.array([7.0, -0.5, 0.2]), 92000.0),\n        ([1.5, 2.0], 0.9, np.array([1.0, 0.0, 0.0]), 1.25, np.array([6.0, 0.2, -0.1]), 88000.0)\n    ]\n    receivers2 = [\n        ([0.0, 0.5], 0.6, np.array([-0.93969262, -0.342020143, 0.0])),\n        ([0.5, 1.2], 1.0, np.array([-1.0, 0.0, 0.0])),\n        ([1.2, 2.0], 1.2, np.array([-0.965925826, -0.258819045, 0.0]))\n    ]\n    \n    # Test case 3\n    donors3 = [\n        ([0.0, 0.3], 0.3, np.array([1.0, 0.0, 0.0]), 1.0, np.array([2.0, 0.0, 0.0]), 50000.0),\n        ([0.3, 0.7], 1.7, np.array([1.0, 0.0, 0.0]), 1.0, np.array([0.1, 4.0, 0.0]), 55000.0),\n        ([0.7, 1.0], 0.5, np.array([0.965925826, 0.258819045, 0.0]), 1.0, np.array([0.01, 0.1, 0.0]), 50000.0),\n    ]\n    receivers3 = [\n        ([0.0, 0.2], 0.2, np.array([-1.0, 0.0, 0.0])),\n        ([0.2, 0.6], 1.6, np.array([-0.999847695, -0.017452406, 0.0])),\n        ([0.6, 1.0], 0.7, np.array([-0.984807753, -0.173648178, 0.0]))\n    ]\n    \n    # Test case 4\n    donors4 = [\n        ([0.0, 0.5], 0.4, np.array([1.0, 0.0, 0.0]), 1.2, np.array([-3.0, 0.0, 0.0]), 60000.0),\n        ([0.5, 1.0], 0.8, np.array([0.965925826, 0.258819045, 0.0]), 1.0, np.array([3.0, 1.0, 0.0]), 70000.0),\n        ([1.0, 1.5], 0.5, np.array([1.0, 0.0, 0.0]), 1.1, np.array([0.0, 2.0, 0.0]), 65000.0)\n    ]\n    receivers4 = [\n        ([0.0, 0.3], 0.3, np.array([-1.0, 0.0, 0.0])),\n        ([0.3, 1.2], 1.4, np.array([-0.965925826, -0.258819045, 0.0])),\n        ([1.2, 1.5], 0.5, np.array([-1.0, 0.0, 0.0]))\n    ]\n\n    test_cases = [\n        (donors1, receivers1),\n        (donors2, receivers2),\n        (donors3, receivers3),\n        (donors4, receivers4),\n    ]\n\n    results = []\n    # Tolerance for checking if a mass flux is effectively zero\n    epsilon_flux = 1e-12 \n    # Tolerance for global conservation check\n    conservation_tol = 1e-9\n\n    for donors_data, receivers_data in test_cases:\n        num_donors = len(donors_data)\n        num_receivers = len(receivers_data)\n\n        # Step 1: Compute donor convective fluxes\n        F_m_d = np.zeros(num_donors)\n        F_p_d = np.zeros((num_donors, 3))\n        F_E_d = np.zeros(num_donors)\n\n        for i, data in enumerate(donors_data):\n            _, A, n, rho, u, E = data\n            F_m_d[i] = rho * np.dot(u, n) * A\n            F_p_d[i, :] = F_m_d[i] * u\n            F_E_d[i] = F_m_d[i] * E\n\n        # Step 2: Construct the mapping matrix W\n        W = np.zeros((num_receivers, num_donors))\n        for j, r_data in enumerate(receivers_data):\n            s_j0, s_j1 = r_data[0]\n            for i, d_data in enumerate(donors_data):\n                s_i0, s_i1 = d_data[0]\n                ell_i = s_i1 - s_i0\n                overlap_length = max(0.0, min(s_i1, s_j1) - max(s_i0, s_j0))\n                if ell_i  0:\n                    W[j, i] = overlap_length / ell_i\n\n        # Step 3: Compute receiver-assigned fluxes\n        F_m_r = W @ F_m_d\n        F_p_r = W @ F_p_d\n        F_E_r = W @ F_E_d\n\n        # Step 4: Construct ghost states on receiver faces\n        rho_ghost = np.zeros(num_receivers)\n        u_ghost = np.zeros((num_receivers, 3))\n        E_ghost = np.zeros(num_receivers)\n\n        for j in range(num_receivers):\n            if abs(F_m_r[j])  epsilon_flux:\n                u_ghost[j, :] = F_p_r[j, :] / F_m_r[j]\n                E_ghost[j] = F_E_r[j] / F_m_r[j]\n                \n                _, A_j, n_j = receivers_data[j]\n                \n                denominator = A_j * np.dot(u_ghost[j, :], n_j)\n                if abs(denominator)  epsilon_flux:\n                    rho_ghost[j] = F_m_r[j] / denominator\n                else:\n                    # This case implies the constructed velocity is tangent to the face,\n                    # or the area is zero. The resulting check flux will be zero.\n                    rho_ghost[j] = 0.0 # Effectively makes check flux zero\n            # else block is implicitly handled by numpy zeros initialization\n\n        # Step 5: Verify fluxes and global conservation\n        F_m_check = np.zeros(num_receivers)\n        F_p_check = np.zeros((num_receivers, 3))\n        F_E_check = np.zeros(num_receivers)\n        \n        for j in range(num_receivers):\n            _, A_j, n_j = receivers_data[j]\n            F_m_check[j] = rho_ghost[j] * np.dot(u_ghost[j, :], n_j) * A_j\n            F_p_check[j, :] = F_m_check[j] * u_ghost[j, :]\n            F_E_check[j] = F_m_check[j] * E_ghost[j]\n\n        # Compare sum of donor fluxes with sum of receiver check fluxes\n        is_mass_conserved = np.isclose(np.sum(F_m_d), np.sum(F_m_check), atol=conservation_tol, rtol=0)\n        is_momentum_conserved = np.allclose(np.sum(F_p_d, axis=0), np.sum(F_p_check, axis=0), atol=conservation_tol, rtol=0)\n        is_energy_conserved = np.isclose(np.sum(F_E_d), np.sum(F_E_check), atol=conservation_tol, rtol=0)\n\n        results.append([is_mass_conserved, is_momentum_conserved, is_energy_conserved])\n    \n    # Format according to Python's default list-of-lists representation\n    print(str(results).replace(\"'\", \"\"))\n\nsolve()\n\n```", "id": "3334990"}]}