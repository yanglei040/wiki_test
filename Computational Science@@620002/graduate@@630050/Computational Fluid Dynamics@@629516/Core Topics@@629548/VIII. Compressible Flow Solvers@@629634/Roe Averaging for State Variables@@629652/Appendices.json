{"hands_on_practices": [{"introduction": "To begin our practical exploration, we will ground the concept of Roe averaging in one of its most critical applications in computational fluid dynamics: ensuring the stability of a numerical simulation. This exercise requires you to compute the Roe-averaged state variables for a given shock tube-like problem. You will then use these values to determine the maximum wave speed at the interface, which is essential for calculating the maximum stable time step under the Courant-Friedrichs-Lewy (CFL) condition [@problem_id:3359591]. This practice directly connects the abstract mathematical averaging to a tangible and crucial parameter in any explicit time-marching scheme.", "problem": "Consider the one-dimensional compressible Euler equations for a calorically perfect ideal gas with constant ratio of specific heats $\\gamma$. An explicit finite volume method using the Roe approximate Riemann solver advances the conserved variables in time under a Courant-Friedrichs-Lewy (CFL) constraint. At a particular cell interface in a uniform grid of spacing $\\Delta x$, the left and right primitive states (density $\\rho$, velocity $u$, and pressure $p$) are\n- Left state: $\\rho_{L} = 1.2$ kg/m$^{3}$, $u_{L} = 50$ m/s, $p_{L} = 101325$ Pa,\n- Right state: $\\rho_{R} = 0.8$ kg/m$^{3}$, $u_{R} = -30$ m/s, $p_{R} = 80000$ Pa.\n\nAssume $\\gamma = 1.4$, and that the time step is limited by this interface. A Courant number of $0.7$ is chosen, and the grid spacing is $\\Delta x = 1.0 \\times 10^{-2}$ m. Using the Roe linearization constructed from these left and right states and the Courant-Friedrichs-Lewy (CFL) stability requirement for an explicit method, determine the maximum stable time step $\\Delta t_{\\max}$.\n\nExpress your final answer in seconds and round your result to four significant figures.", "solution": "The problem requires the determination of the maximum stable time step, $\\Delta t_{\\max}$, for an explicit finite volume scheme using the Roe approximate Riemann solver. The stability of such a scheme is governed by the Courant-Friedrichs-Lewy (CFL) condition. For the one-dimensional Euler equations, the CFL condition states that the numerical domain of dependence must contain the physical domain of dependence. This is expressed as:\n$$ C = \\frac{\\Delta t}{\\Delta x} S_{\\max} \\le C_{\\max} $$\nwhere $C$ is the Courant number, $\\Delta t$ is the time step, $\\Delta x$ is the grid spacing, and $S_{\\max}$ is the maximum signal speed (the magnitude of the fastest characteristic wave) at the interface. The problem specifies a Courant number $C = 0.7$. To find the maximum stable time step, we solve for $\\Delta t$:\n$$ \\Delta t_{\\max} = C \\frac{\\Delta x}{S_{\\max}} $$\nFor the Roe solver, the maximum signal speed $S_{\\max}$ is determined by the eigenvalues of the Roe-averaged Jacobian matrix, $\\tilde{A}$. The eigenvalues of $\\tilde{A}$ for the 1D Euler equations are $\\tilde{u}$, $\\tilde{u} + \\tilde{a}$, and $\\tilde{u} - \\tilde{a}$, where $\\tilde{u}$ is the Roe-averaged velocity and $\\tilde{a}$ is the Roe-averaged speed of sound. The maximum magnitude of these eigenvalues is the spectral radius of the matrix, given by:\n$$ S_{\\max} = \\max(|\\tilde{u}|, |\\tilde{u} + \\tilde{a}|, |\\tilde{u} - \\tilde{a}|) = |\\tilde{u}| + \\tilde{a} $$\nThe task thus reduces to calculating the Roe-averaged quantities $\\tilde{u}$ and $\\tilde{a}$ from the given left ($L$) and right ($R$) states.\n\nThe provided primitive variables are:\n- Left state: $\\rho_{L} = 1.2$ kg/m$^3$, $u_{L} = 50$ m/s, $p_{L} = 101325$ Pa.\n- Right state: $\\rho_{R} = 0.8$ kg/m$^3$, $u_{R} = -30$ m/s, $p_{R} = 80000$ Pa.\nThe ratio of specific heats is $\\gamma = 1.4$. The grid spacing is $\\Delta x = 1.0 \\times 10^{-2}$ m.\n\nFirst, we define and calculate the Roe-averaged velocity $\\tilde{u}$. The formula is a weighted average based on the square root of density:\n$$ \\tilde{u} = \\frac{\\sqrt{\\rho_{L}} u_{L} + \\sqrt{\\rho_{R}} u_{R}}{\\sqrt{\\rho_{L}} + \\sqrt{\\rho_{R}}} $$\nPlugging in the given values:\n$$ \\tilde{u} = \\frac{\\sqrt{1.2} (50) + \\sqrt{0.8} (-30)}{\\sqrt{1.2} + \\sqrt{0.8}} \\approx \\frac{(1.095445)(50) + (0.894427)(-30)}{1.095445 + 0.894427} \\approx \\frac{54.77225 - 26.83281}{1.989872} \\approx 14.0408 \\text{ m/s} $$\n\nNext, we calculate the Roe-averaged speed of sound $\\tilde{a}$. This is derived from the Roe-averaged specific total enthalpy, $\\tilde{H}$, using the relation:\n$$ \\tilde{a}^2 = (\\gamma - 1) \\left( \\tilde{H} - \\frac{1}{2} \\tilde{u}^2 \\right) $$\nThe Roe-averaged specific total enthalpy $\\tilde{H}$ is defined similarly to $\\tilde{u}$:\n$$ \\tilde{H} = \\frac{\\sqrt{\\rho_{L}} H_{L} + \\sqrt{\\rho_{R}} H_{R}}{\\sqrt{\\rho_{L}} + \\sqrt{\\rho_{R}}} $$\nwhere $H_L$ and $H_R$ are the specific total enthalpies of the left and right states. For a calorically perfect gas, the specific total enthalpy $H$ is given by:\n$$ H = \\frac{\\gamma}{\\gamma-1} \\frac{p}{\\rho} + \\frac{1}{2} u^2 $$\nWe calculate $H_L$ and $H_R$:\n$$ H_L = \\frac{1.4}{1.4-1} \\frac{101325}{1.2} + \\frac{1}{2} (50)^2 = \\frac{1.4}{0.4} (84437.5) + \\frac{1}{2}(2500) = 295531.25 + 1250 = 296781.25 \\text{ J/kg} $$\n$$ H_R = \\frac{1.4}{1.4-1} \\frac{80000}{0.8} + \\frac{1}{2} (-30)^2 = \\frac{1.4}{0.4} (100000) + \\frac{1}{2}(900) = 350000 + 450 = 350450 \\text{ J/kg} $$\nNow, we can compute $\\tilde{H}$:\n$$ \\tilde{H} = \\frac{\\sqrt{1.2} (296781.25) + \\sqrt{0.8} (350450)}{\\sqrt{1.2} + \\sqrt{0.8}} \\approx \\frac{(1.095445)(296781.25) + (0.894427)(350450)}{1.989872} \\approx \\frac{325102.39 + 313437.49}{1.989872} \\approx 320892.59 \\text{ J/kg} $$\nWith $\\tilde{u}$ and $\\tilde{H}$, we can find $\\tilde{a}$:\n$$ \\tilde{a}^2 = (1.4 - 1) \\left( 320892.59 - \\frac{1}{2} (14.0408)^2 \\right) \\approx 0.4 \\left( 320892.59 - \\frac{1}{2} (197.144) \\right) = 0.4 (320892.59 - 98.572) = 0.4(320794.018) \\approx 128317.61 $$\n$$ \\tilde{a} = \\sqrt{128317.61} \\approx 358.2145 \\text{ m/s} $$\nThe maximum signal speed at the interface is:\n$$ S_{\\max} = |\\tilde{u}| + \\tilde{a} \\approx |14.0408| + 358.2145 = 372.2553 \\text{ m/s} $$\nFinally, we calculate the maximum stable time step $\\Delta t_{\\max}$ using the CFL condition:\n$$ \\Delta t_{\\max} = C \\frac{\\Delta x}{S_{\\max}} = 0.7 \\times \\frac{1.0 \\times 10^{-2}}{372.2553} \\approx \\frac{0.007}{372.2553} \\approx 1.88044 \\times 10^{-5} \\text{ s} $$\nRounding the result to four significant figures, as requested:\n$$ \\Delta t_{\\max} \\approx 1.880 \\times 10^{-5} \\text{ s} $$", "answer": "$$\\boxed{1.880 \\times 10^{-5}}$$", "id": "3359591"}, {"introduction": "Having applied the 'how' of Roe averaging, we now delve into the 'why' by examining its fundamental properties. This problem guides you to derive the specific conditions under which the sophisticated Roe average simplifies to a basic arithmetic mean, offering a clear insight into its structure [@problem_id:3359628]. By further analyzing the case of constant density, you will derive an expression for the deviation of the Roe-averaged sound speed from a simple average, revealing how Roe's construction inherently accounts for kinetic energy effects and influences the numerical dissipation of acoustic waves.", "problem": "Consider a one-dimensional, inviscid flow of a calorically perfect gas with constant ratio of specific heats $\\gamma > 1$, modeled by the compressible Euler equations in conservative form for the state vector $\\boldsymbol{U} = (\\rho, \\rho u, E)^{\\mathsf{T}}$, where $\\rho$ is the mass density, $u$ is the velocity, and $E$ is the total energy per unit volume. The thermodynamic closure is given by $p = (\\gamma - 1)\\left(E - \\tfrac{1}{2}\\rho u^{2}\\right)$, where $p$ is the pressure. The specific total enthalpy is $H = \\dfrac{E + p}{\\rho} = h + \\tfrac{1}{2}u^{2}$ with $h$ the thermodynamic enthalpy. For a calorically perfect gas, the acoustic speed satisfies $a^{2} = \\gamma p / \\rho$ and $h = \\frac{a^{2}}{\\gamma - 1}$.\n\nLet $\\boldsymbol{U}_{L}$ and $\\boldsymbol{U}_{R}$ denote left and right states of a Riemann problem. The Roe linearization seeks a constant Jacobian $\\boldsymbol{A}(\\tilde{\\boldsymbol{U}})$, evaluated at a suitably averaged state $\\tilde{\\boldsymbol{U}}$, such that the exact flux difference satisfies $\\boldsymbol{F}(\\boldsymbol{U}_{R}) - \\boldsymbol{F}(\\boldsymbol{U}_{L}) = \\boldsymbol{A}(\\tilde{\\boldsymbol{U}})\\big(\\boldsymbol{U}_{R} - \\boldsymbol{U}_{L}\\big)$ and $\\boldsymbol{A}(\\tilde{\\boldsymbol{U}})$ has the eigenstructure of the physical system.\n\nStarting from these foundations, derive the conditions under which Roe-averaged primitive variables reduce to arithmetic means for specific variables. Then, specialize to the case where the mass densities are equal, $\\rho_{L} = \\rho_{R} = \\rho$, but $u_{L}$, $u_{R}$, $p_{L}$, and $p_{R}$ are arbitrary. Using only the above physical laws and definitions, derive a closed-form expression for the difference between the Roe-averaged acoustic speed and the arithmetic mean of the left and right acoustic speeds,\n$$\n\\Delta a \\equiv \\tilde{a} - \\frac{a_{L} + a_{R}}{2},\n$$\nexpressed in terms of $\\gamma$, $u_{L}$, $u_{R}$, $a_{L}$, and $a_{R}$. Discuss in your derivation the implications of the equality $\\rho_{L} = \\rho_{R}$ for the Roe-averaged velocity and enthalpy, and explain qualitatively how your result for $\\Delta a$ affects the magnitude of upwind dissipation associated with acoustic waves in a Roe-type flux.\n\nProvide the final expression for $\\Delta a$ in closed form. You may keep all quantities symbolic; no numerical substitution is required. If evaluated numerically, express the speed in meters per second.", "solution": "The foundation of Roe's linearization lies in finding an averaged state $\\tilde{\\boldsymbol{U}}$ such that the flux difference property $\\Delta \\boldsymbol{F} = \\boldsymbol{A}(\\tilde{\\boldsymbol{U}}) \\Delta \\boldsymbol{U}$ is satisfied, where $\\Delta(\\cdot) = (\\cdot)_R - (\\cdot)_L$. For the one-dimensional Euler equations for a calorically perfect gas, this is achieved by defining the following Roe-averaged quantities:\n$$\n\\tilde{\\rho} = \\sqrt{\\rho_{L} \\rho_{R}}\n$$\n$$\n\\tilde{u} = \\frac{\\sqrt{\\rho_{L}} u_{L} + \\sqrt{\\rho_{R}} u_{R}}{\\sqrt{\\rho_{L}} + \\sqrt{\\rho_{R}}}\n$$\n$$\n\\tilde{H} = \\frac{\\sqrt{\\rho_{L}} H_{L} + \\sqrt{\\rho_{R}} H_{R}}{\\sqrt{\\rho_{L}} + \\sqrt{\\rho_{R}}}\n$$\nHere, $\\tilde{\\rho}$, $\\tilde{u}$, and $\\tilde{H}$ (specific total enthalpy) are the fundamental averaged quantities. All other averaged variables, such as the averaged acoustic speed $\\tilde{a}$, are derived from these.\n\nThe first part of the problem asks for the conditions under which specific Roe-averaged variables reduce to arithmetic means. Inspecting the formulas for $\\tilde{u}$ and $\\tilde{H}$, we can see they are weighted averages with weights $\\sqrt{\\rho_{L}}$ and $\\sqrt{\\rho_{R}}$. These weighted averages become simple arithmetic means if and only if the weights are equal. This occurs when $\\sqrt{\\rho_{L}} = \\sqrt{\\rho_{R}}$, which is equivalent to the condition $\\rho_{L} = \\rho_{R}$. Thus, for constant density across the discontinuity, the Roe-averaged velocity and specific total enthalpy are simply the arithmetic means of their respective left and right state values. Note that the Roe-averaged density $\\tilde{\\rho} = \\sqrt{\\rho_{L}\\rho_{R}}$ becomes a geometric mean.\n\nWe now specialize to the case stipulated in the problem: $\\rho_{L} = \\rho_{R} = \\rho$. As just established, this condition has direct implications for the Roe-averaged velocity and enthalpy.\nThe Roe-averaged density becomes:\n$$\n\\tilde{\\rho} = \\sqrt{\\rho \\cdot \\rho} = \\rho\n$$\nThe Roe-averaged velocity becomes the arithmetic mean:\n$$\n\\tilde{u} = \\frac{\\sqrt{\\rho} u_{L} + \\sqrt{\\rho} u_{R}}{\\sqrt{\\rho} + \\sqrt{\\rho}} = \\frac{u_{L} + u_{R}}{2}\n$$\nThe Roe-averaged specific total enthalpy also becomes the arithmetic mean:\n$$\n\\tilde{H} = \\frac{\\sqrt{\\rho} H_{L} + \\sqrt{\\rho} H_{R}}{\\sqrt{\\rho} + \\sqrt{\\rho}} = \\frac{H_{L} + H_{R}}{2}\n$$\n\nThe Roe-averaged acoustic speed, $\\tilde{a}$, is defined through the averaged state variables, consistent with the thermodynamic relations of the gas. Specifically, it is given by:\n$$\n\\tilde{a}^{2} = (\\gamma - 1)\\left(\\tilde{H} - \\frac{1}{2}\\tilde{u}^{2}\\right)\n$$\nSubstituting the expressions for $\\tilde{u}$ and $\\tilde{H}$ for the constant density case:\n$$\n\\tilde{a}^{2} = (\\gamma - 1)\\left(\\frac{H_{L} + H_{R}}{2} - \\frac{1}{2}\\left(\\frac{u_{L} + u_{R}}{2}\\right)^{2}\\right)\n$$\nWe must now express $H_{L}$ and $H_{R}$ in terms of the given variables $a_{L}, a_{R}, u_{L}, u_{R}$. The specific total enthalpy $H$ is related to the acoustic speed $a$ and velocity $u$ via $H = h + \\frac{1}{2}u^{2}$ and $h = \\frac{a^{2}}{\\gamma-1}$. Therefore:\n$$\nH = \\frac{a^{2}}{\\gamma-1} + \\frac{1}{2}u^{2}\n$$\nApplying this to the left and right states:\n$$\nH_{L} = \\frac{a_{L}^{2}}{\\gamma-1} + \\frac{1}{2}u_{L}^{2} \\quad \\text{and} \\quad H_{R} = \\frac{a_{R}^{2}}{\\gamma-1} + \\frac{1}{2}u_{R}^{2}\n$$\nSubstituting these into our equation for $\\tilde{a}^{2}$:\n$$\n\\tilde{a}^{2} = (\\gamma - 1)\\left[ \\frac{1}{2}\\left(\\left(\\frac{a_{L}^{2}}{\\gamma-1} + \\frac{1}{2}u_{L}^{2}\\right) + \\left(\\frac{a_{R}^{2}}{\\gamma-1} + \\frac{1}{2}u_{R}^{2}\\right)\\right) - \\frac{1}{8}(u_{L} + u_{R})^{2} \\right]\n$$\nNow, we simplify the expression.\n$$\n\\tilde{a}^{2} = (\\gamma - 1)\\left[ \\frac{a_{L}^{2} + a_{R}^{2}}{2(\\gamma - 1)} + \\frac{u_{L}^{2} + u_{R}^{2}}{4} - \\frac{u_{L}^{2} + 2u_{L}u_{R} + u_{R}^{2}}{8} \\right]\n$$\nDistributing the $(\\gamma-1)$ term to the first term in the bracket and combining the velocity terms:\n$$\n\\tilde{a}^{2} = \\frac{a_{L}^{2} + a_{R}^{2}}{2} + (\\gamma - 1)\\left[ \\frac{2(u_{L}^{2} + u_{R}^{2}) - (u_{L}^{2} + 2u_{L}u_{R} + u_{R}^{2})}{8} \\right]\n$$\nThe term in the numerator simplifies as:\n$$\n2u_{L}^{2} + 2u_{R}^{2} - u_{L}^{2} - 2u_{L}u_{R} - u_{R}^{2} = u_{L}^{2} - 2u_{L}u_{R} + u_{R}^{2} = (u_{L} - u_{R})^{2}\n$$\nThis gives the final expression for the squared Roe-averaged acoustic speed:\n$$\n\\tilde{a}^{2} = \\frac{a_{L}^{2} + a_{R}^{2}}{2} + \\frac{\\gamma - 1}{8}(u_{L} - u_{R})^{2}\n$$\nThe problem requires the derivation of $\\Delta a = \\tilde{a} - \\frac{a_{L} + a_{R}}{2}$. Taking the square root of the above expression for $\\tilde{a}^2$ yields $\\tilde{a}$:\n$$\n\\tilde{a} = \\sqrt{\\frac{a_{L}^{2} + a_{R}^{2}}{2} + \\frac{\\gamma - 1}{8}(u_{L} - u_{R})^{2}}\n$$\nThus, the difference $\\Delta a$ is:\n$$\n\\Delta a = \\sqrt{\\frac{a_{L}^{2} + a_{R}^{2}}{2} + \\frac{\\gamma - 1}{8}(u_{L} - u_{R})^{2}} - \\frac{a_{L} + a_{R}}{2}\n$$\n\nFor the qualitative discussion, we analyze the sign of $\\Delta a$. Consider the identity $\\frac{a_{L}^{2} + a_{R}^{2}}{2} = \\left(\\frac{a_{L} + a_{R}}{2}\\right)^{2} + \\left(\\frac{a_{L} - a_{R}}{2}\\right)^{2}$. Substituting this into the expression for $\\tilde{a}^{2}$:\n$$\n\\tilde{a}^{2} = \\left(\\frac{a_{L} + a_{R}}{2}\\right)^{2} + \\left(\\frac{a_{L} - a_{R}}{2}\\right)^{2} + \\frac{\\gamma - 1}{8}(u_{L} - u_{R})^{2}\n$$\nSince squares of real numbers are non-negative and $\\gamma > 1$, all three terms on the right-hand side are non-negative. This directly implies that $\\tilde{a}^{2} \\geq \\left(\\frac{a_{L} + a_{R}}{2}\\right)^{2}$, and since acoustic speeds are non-negative, $\\tilde{a} \\geq \\frac{a_{L} + a_{R}}{2}$. Therefore, $\\Delta a \\geq 0$. The Roe-averaged acoustic speed is always greater than or equal to the arithmetic mean of the left and right acoustic speeds. Equality ($\\Delta a = 0$) holds if and only if $a_{L} = a_{R}$ and $u_{L} = u_{R}$, which, given $\\rho_{L}=\\rho_{R}$, means the left and right states are identical.\n\nThe magnitude of numerical dissipation in a Roe-type flux is proportional to the magnitude of the eigenvalues of the Roe matrix $\\boldsymbol{A}(\\tilde{\\boldsymbol{U}})$. The eigenvalues corresponding to acoustic waves are $\\tilde{\\lambda}_{1,3} = \\tilde{u} \\pm \\tilde{a}$. The result $\\Delta a \\geq 0$ shows that the Roe averaging procedure yields an acoustic speed $\\tilde{a}$ that is generally an overestimate compared to the simple arithmetic average. This larger value of $\\tilde{a}$ increases the magnitude of the acoustic eigenvalues, $|\\tilde{u} \\pm \\tilde{a}|$. Consequently, the upwind dissipation associated with the acoustic waves is increased. This effect is driven by differences in both pressure (reflected in $a_{L,R}$) and velocity between the left and right states. For discontinuities with a large velocity difference (shear layers) but constant density, this can introduce excessive numerical viscosity, leading to the smearing of such features more than is physically warranted.", "answer": "$$\n\\boxed{\\sqrt{\\frac{a_{L}^{2} + a_{R}^{2}}{2} + \\frac{\\gamma - 1}{8}(u_{L} - u_{R})^{2}} - \\frac{a_{L} + a_{R}}{2}}\n$$", "id": "3359628"}, {"introduction": "This final exercise highlights the necessity of the rigorous Roe formulation by contrasting it with a more intuitive but incorrect approach. You will investigate the non-linear relationship between primitive and conservative variables and demonstrate that simple arithmetic averaging does not commute with the transformation between these sets of variables [@problem_id:3359643]. By calculating the resulting 'wave-speed bias,' you will quantify the error introduced by naive averaging, reinforcing why the specific, property-conserving construction of the Roe average is indispensable for building accurate and robust numerical solvers.", "problem": "Consider the one-dimensional (1D) compressible Euler equations for an ideal gas with specific heat ratio $\\gamma = 1.4$. The conservative variables are $U = [\\rho, \\rho u, \\rho v, \\rho w, E]^{T}$ and the primitive variables are $W = [\\rho, u, v, w, p]^{T}$. The transformation $U(W)$ is defined by the identities $U_{1} = \\rho$, $U_{2} = \\rho u$, $U_{3} = \\rho v$, $U_{4} = \\rho w$, and $U_{5} = E = \\frac{p}{\\gamma - 1} + \\frac{1}{2}\\rho\\left(u^{2} + v^{2} + w^{2}\\right)$ (ideal gas closure).\n\nYou are given a Riemann problem with left and right states, with flow aligned with the $x$-axis and no transverse motion:\n- Left state $W_{L}$: $\\rho_{L} = 1.0$, $u_{L} = 200$, $v_{L} = 0$, $w_{L} = 0$, $p_{L} = 100000$.\n- Right state $W_{R}$: $\\rho_{R} = 0.5$, $u_{R} = 0$, $v_{R} = 0$, $w_{R} = 0$, $p_{R} = 50000$.\n\nTasks:\n1) Starting from the Euler conservation laws and the ideal-gas enthalpy relation, construct the Roe-consistent average state characterized by the Roe-averaged velocity $\\tilde{u}$ and Roe-averaged specific total enthalpy $\\tilde{H}$ that satisfy the Roe linearization property. Use these to compute the Roe-averaged acoustic speed $\\tilde{a}$ through the ideal-gas relation between specific enthalpy and acoustic speed.\n\n2) Form the arithmetic average in primitive variables $W_{\\mathrm{avg}} = \\dfrac{1}{2}(W_{L} + W_{R})$, and from it compute the corresponding acoustic speed $a_{\\mathrm{avg}}$ using the ideal-gas relation $a = \\sqrt{\\gamma p/\\rho}$ and the mean velocity $u_{\\mathrm{avg}}$.\n\n3) Demonstrate that, in general, averaging and transforming do not commute by showing that $U\\!\\left(\\dfrac{W_{L} + W_{R}}{2}\\right) \\neq \\dfrac{U(W_{L}) + U(W_{R})}{2}$ for the given data, and explain briefly which nonlinearity is responsible.\n\n4) Define the wave-speed bias as the difference between the right-going characteristic speeds predicted by the two averaging paths,\n$$\nB \\equiv \\left(u_{\\mathrm{avg}} + a_{\\mathrm{avg}}\\right) - \\left(\\tilde{u} + \\tilde{a}\\right).\n$$\nCompute $B$ for the given states. Express the final bias in meters per second and round your answer to four significant figures.", "solution": "The problem requires the calculation and comparison of state variables and wave speeds derived from two different averaging methods for a given Riemann problem in one-dimensional gas dynamics.\n\n### Task 1: Roe-Averaged State Calculation\n\nThe Roe-averaging procedure defines a specific mean state, denoted by a tilde $(\\tilde{\\cdot})$, that linearizes the Riemann problem. The Roe-averaged quantities are constructed to satisfy the property $F(U_R) - F(U_L) = \\tilde{A}(U_R - U_L)$, where $\\tilde{A}$ is the flux Jacobian evaluated at the Roe state. For the Euler equations with an ideal gas, the Roe-averaged density, velocity components, and total enthalpy are given by weighted averages.\n\nThe Roe-averaged density is the geometric mean:\n$$\n\\tilde{\\rho} = \\sqrt{\\rho_{L}\\rho_{R}}\n$$\nAny other variable $q$ is averaged using a density-weighted formula:\n$$\n\\tilde{q} = \\frac{\\sqrt{\\rho_{L}}q_{L} + \\sqrt{\\rho_{R}}q_{R}}{\\sqrt{\\rho_{L}} + \\sqrt{\\rho_{R}}}\n$$\nGiven $\\rho_L = 1.0$ and $\\rho_R = 0.5$, we have $\\sqrt{\\rho_L} = 1.0$ and $\\sqrt{\\rho_R} = \\sqrt{0.5} = \\frac{1}{\\sqrt{2}}$.\n\nThe Roe-averaged velocity $\\tilde{u}$ is:\n$$\n\\tilde{u} = \\frac{\\sqrt{\\rho_{L}}u_{L} + \\sqrt{\\rho_{R}}u_{R}}{\\sqrt{\\rho_{L}} + \\sqrt{\\rho_{R}}} = \\frac{1.0 \\times 200 + \\frac{1}{\\sqrt{2}} \\times 0}{1.0 + \\frac{1}{\\sqrt{2}}} = \\frac{200}{1 + \\frac{1}{\\sqrt{2}}} = \\frac{200\\sqrt{2}}{\\sqrt{2}+1}\n$$\n$$\n\\tilde{u} = \\frac{200\\sqrt{2}(\\sqrt{2}-1)}{(\\sqrt{2}+1)(\\sqrt{2}-1)} = 200(2 - \\sqrt{2}) \\approx 117.1573 \\, \\text{m/s}\n$$\nTo find the Roe-averaged specific total enthalpy $\\tilde{H}$, we first compute the specific total enthalpies for the left and right states, $H_L$ and $H_R$. The specific total enthalpy $H$ is defined as $H = \\frac{E+p}{\\rho}$. For an ideal gas, this is $H = \\frac{\\gamma}{\\gamma-1}\\frac{p}{\\rho} + \\frac{1}{2}|\\mathbf{u}|^2$.\nGiven $\\gamma = 1.4$, we have $\\gamma-1 = 0.4$.\n$$\nH_L = \\frac{1.4}{0.4}\\frac{p_L}{\\rho_L} + \\frac{1}{2}u_L^2 = 3.5 \\times \\frac{100000}{1.0} + \\frac{1}{2}(200)^2 = 350000 + 20000 = 370000 \\, \\text{J/kg}\n$$\n$$\nH_R = \\frac{1.4}{0.4}\\frac{p_R}{\\rho_R} + \\frac{1}{2}u_R^2 = 3.5 \\times \\frac{50000}{0.5} + \\frac{1}{2}(0)^2 = 3.5 \\times 100000 = 350000 \\, \\text{J/kg}\n$$\nNow, we compute $\\tilde{H}$:\n$$\n\\tilde{H} = \\frac{\\sqrt{\\rho_{L}}H_{L} + \\sqrt{\\rho_{R}}H_{R}}{\\sqrt{\\rho_{L}} + \\sqrt{\\rho_{R}}} = \\frac{1.0 \\times 370000 + \\frac{1}{\\sqrt{2}} \\times 350000}{1.0 + \\frac{1}{\\sqrt{2}}} = \\frac{370000\\sqrt{2} + 350000}{\\sqrt{2}+1}\n$$\n$$\n\\tilde{H} = (370000\\sqrt{2} + 350000)(\\sqrt{2}-1) = 370000 \\times 2 - 370000\\sqrt{2} + 350000\\sqrt{2} - 350000\n$$\n$$\n\\tilde{H} = 740000 - 350000 - 20000\\sqrt{2} = 390000 - 20000\\sqrt{2} \\approx 361715.73 \\, \\text{J/kg}\n$$\nThe Roe-averaged speed of sound $\\tilde{a}$ is derived from the Roe-averaged enthalpy and velocity:\n$$\n\\tilde{a}^2 = (\\gamma-1)\\left(\\tilde{H} - \\frac{1}{2}\\tilde{u}^2\\right)\n$$\nWe need $\\frac{1}{2}\\tilde{u}^2$:\n$$\n\\frac{1}{2}\\tilde{u}^2 = \\frac{1}{2}\\left(200(2-\\sqrt{2})\\right)^2 = \\frac{1}{2} \\times 40000 \\times (4 - 4\\sqrt{2} + 2) = 20000(6 - 4\\sqrt{2}) = 120000 - 80000\\sqrt{2}\n$$\nSubstituting into the expression for $\\tilde{a}^2$:\n$$\n\\tilde{a}^2 = 0.4 \\left( (390000 - 20000\\sqrt{2}) - (120000 - 80000\\sqrt{2}) \\right)\n$$\n$$\n\\tilde{a}^2 = 0.4 (270000 + 60000\\sqrt{2}) = 108000 + 24000\\sqrt{2}\n$$\n$$\n\\tilde{a} = \\sqrt{108000 + 24000\\sqrt{2}} \\approx 376.7508 \\, \\text{m/s}\n$$\n\n### Task 2: Arithmetic Average State Calculation\n\nThe arithmetic average of the primitive variables $W_{\\mathrm{avg}} = \\frac{1}{2}(W_L + W_R)$ is computed as:\n$$\n\\rho_{\\mathrm{avg}} = \\frac{1}{2}(\\rho_L + \\rho_R) = \\frac{1}{2}(1.0 + 0.5) = 0.75\n$$\n$$\nu_{\\mathrm{avg}} = \\frac{1}{2}(u_L + u_R) = \\frac{1}{2}(200 + 0) = 100 \\, \\text{m/s}\n$$\n$$\np_{\\mathrm{avg}} = \\frac{1}{2}(p_L + p_R) = \\frac{1}{2}(100000 + 50000) = 75000 \\, \\text{Pa}\n$$\nThe speed of sound $a_{\\mathrm{avg}}$ corresponding to this arithmetically averaged state is calculated using the standard formula for an ideal gas:\n$$\na_{\\mathrm{avg}} = \\sqrt{\\frac{\\gamma p_{\\mathrm{avg}}}{\\rho_{\\mathrm{avg}}}} = \\sqrt{\\frac{1.4 \\times 75000}{0.75}} = \\sqrt{1.4 \\times 100000} = \\sqrt{140000} = 100\\sqrt{14} \\approx 374.1657 \\, \\text{m/s}\n$$\n\n### Task 3: Non-Commutativity of Averaging and Transformation\n\nWe demonstrate that the transformation from primitive to conservative variables $U(W)$ does not commute with arithmetic averaging. We must show $U(W_{\\mathrm{avg}}) \\neq \\frac{1}{2}(U(W_L) + U(W_R))$.\n\nFirst, we compute the conservative vectors for the left and right states, $U(W_L)$ and $U(W_R)$.\n$E_L = \\frac{p_L}{\\gamma-1} + \\frac{1}{2}\\rho_L u_L^2 = \\frac{100000}{0.4} + \\frac{1}{2}(1.0)(200)^2 = 250000 + 20000 = 270000$.\n$E_R = \\frac{p_R}{\\gamma-1} + \\frac{1}{2}\\rho_R u_R^2 = \\frac{50000}{0.4} + 0 = 125000$.\nSo, $U(W_L) = [1.0, 200, 0, 0, 270000]^T$ and $U(W_R) = [0.5, 0, 0, 0, 125000]^T$.\n\nThe arithmetic average of these conservative vectors is:\n$$\n\\frac{1}{2}(U(W_L) + U(W_R)) = \\frac{1}{2}[1.5, 200, 0, 0, 395000]^T = [0.75, 100, 0, 0, 197500]^T\n$$\nNow, we transform the arithmetically averaged primitive state $W_{\\mathrm{avg}} = [0.75, 100, 0, 0, 75000]^T$ to conservative variables $U(W_{\\mathrm{avg}})$:\n$U_1 = \\rho_{\\mathrm{avg}} = 0.75$.\n$U_2 = \\rho_{\\mathrm{avg}} u_{\\mathrm{avg}} = 0.75 \\times 100 = 75$.\n$U_5 = E_{\\mathrm{avg}} = \\frac{p_{\\mathrm{avg}}}{\\gamma-1} + \\frac{1}{2}\\rho_{\\mathrm{avg}} u_{\\mathrm{avg}}^2 = \\frac{75000}{0.4} + \\frac{1}{2}(0.75)(100)^2 = 187500 + 3750 = 191250$.\nSo, $U(W_{\\mathrm{avg}}) = [0.75, 75, 0, 0, 191250]^T$.\n\nComparing the two results:\n$$\nU(W_{\\mathrm{avg}}) = [0.75, 75, 0, 0, 191250]^T \\neq [0.75, 100, 0, 0, 197500]^T = \\frac{1}{2}(U(W_L) + U(W_R))\n$$\nThe inequality holds. This is a direct consequence of the nonlinear nature of the transformation $U(W)$. Specifically, the expressions for momentum ($\\rho u$) and total energy ($E$) involve products of primitive variables. For any two states $W_L$ and $W_R$, the average of the products is not equal to the product of the averages, e.g., $\\frac{1}{2}(\\rho_L u_L + \\rho_R u_R) \\neq \\left(\\frac{\\rho_L+\\rho_R}{2}\\right)\\left(\\frac{u_L+u_R}{2}\\right)$ unless the states are trivially related. The difference for the momentum components is $\\frac{1}{4}(\\rho_L u_L + \\rho_R u_R - \\rho_L u_R - \\rho_R u_L) = \\frac{1}{4}(\\rho_L - \\rho_R)(u_L - u_R)$, which is non-zero for the given data.\n\n### Task 4: Wave-Speed Bias Calculation\n\nThe wave-speed bias $B$ is defined as the difference between the right-going characteristic speeds $\\lambda_{\\max} = u+a$ from the two averaging methods.\n$$\nB = \\left(u_{\\mathrm{avg}} + a_{\\mathrm{avg}}\\right) - \\left(\\tilde{u} + \\tilde{a}\\right)\n$$\nUsing the values computed in the previous tasks:\n$u_{\\mathrm{avg}} + a_{\\mathrm{avg}} = 100 + \\sqrt{140000} \\approx 100 + 374.1657 = 474.1657$ m/s.\n$\\tilde{u} + \\tilde{a} = 200(2-\\sqrt{2}) + \\sqrt{108000 + 24000\\sqrt{2}} \\approx 117.1573 + 376.7508 = 493.9081$ m/s.\n\nThe bias $B$ is:\n$$\nB \\approx 474.1657 - 493.9081 = -19.7424 \\, \\text{m/s}\n$$\nRounding the result to four significant figures, we get $B = -19.74$ m/s.", "answer": "$$\n\\boxed{-19.74}\n$$", "id": "3359643"}]}