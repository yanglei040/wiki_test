{"hands_on_practices": [{"introduction": "A fundamental decision in constructing a compressible flow solver is the choice of the primary energy variable. While density-based solvers traditionally use total energy $E$ to ensure strict conservation, pressure-based methods often favor static enthalpy $h$. This practice guides you through the derivation of both transport equations from first principles, illuminating how crucial terms related to pressure work and compressibility are represented differently in each formulation [@problem_id:3353133]. Understanding this transformation is key to appreciating the strengths and weaknesses of each approach, particularly regarding shock-capturing and pressure-velocity coupling.", "problem": "Consider a compressible Newtonian fluid with constant dynamic viscosity $\\mu$ and thermal conductivity $k$, governed by the conservation of mass, momentum, and the First Law of Thermodynamics for internal energy. Let $\\rho$ denote the mass density, $\\boldsymbol{u}$ the velocity, $p$ the thermodynamic pressure, $\\boldsymbol{\\tau}$ the viscous stress tensor, and $\\boldsymbol{q}$ the heat flux vector obeying Fourier’s law $\\boldsymbol{q} = -k \\nabla T$, where $T$ is the temperature. Define the total specific energy $E = e + \\tfrac{1}{2}|\\boldsymbol{u}|^2$, where $e$ is the specific internal energy, and the static specific enthalpy $h = e + p/\\rho$. Your task is to reason from the conservation laws and thermodynamic identities to express how the pressure work and kinetic energy exchange terms are represented differently when a pressure-based Computational Fluid Dynamics (CFD) solver chooses to advance either $h$ or $E$.\n\nStarting only from:\n- the continuity equation,\n- the momentum equation, and\n- the internal energy statement of the First Law for a viscous, heat-conducting fluid,\n\nperform the following conceptual derivations:\n- combine the internal and kinetic energy balances to obtain the conservative form for the total energy and identify where pressure–velocity coupling appears,\n- transform the internal energy balance to a static enthalpy balance using thermodynamic identities and the continuity equation, and identify how compressibility enters.\n\nThen, based on your derivations, select all statements that are correct about how the pressure work and kinetic energy exchange terms appear in the $h$-based versus $E$-based formulations in a pressure-based compressible solver.\n\nA. In the conservative total-energy formulation for $E$, the pressure–work and kinetic–internal energy exchange appear as a face flux via $\\nabla\\cdot(p \\boldsymbol{u})$, and there is no explicit volumetric source term $-p\\,\\nabla\\cdot\\boldsymbol{u}$ in the $E$ equation.\n\nB. In the static-enthalpy formulation for $h$, the compressibility interaction appears as the material derivative of pressure $D p/D t$ on the right-hand side, i.e., the explicit $p\\,\\nabla\\cdot\\boldsymbol{u}$ term is absent.\n\nC. Summing the internal-energy and kinetic-energy balances eliminates the pair of terms $-p\\,\\nabla\\cdot\\boldsymbol{u}$ and $-\\boldsymbol{u}\\cdot\\nabla p$, converting them to $\\nabla\\cdot(p \\boldsymbol{u})$; this identity underpins the conservative total-energy flux.\n\nD. Viscous dissipation $\\boldsymbol{\\tau}:\\nabla \\boldsymbol{u}$ does not enter the static-enthalpy equation, because enthalpy already accounts for mechanical effects.\n\nE. For an ideal gas, the static-enthalpy equation contains only a source proportional to $\\nabla\\cdot \\boldsymbol{u}$; therefore it does not need $D p/D t$.\n\nF. In a pressure-based compressible solver, using $h$ instead of $E$ moves the pressure–velocity coupling from the convective flux to a source involving $D p/D t$, which can affect discrete conservation across shocks unless special measures are taken.\n\nSelect all that apply.", "solution": "The problem statement is a valid, well-posed query in the field of computational fluid dynamics, grounded in the fundamental principles of fluid and thermodynamics. We will proceed with a full derivation and analysis.\n\nThe fundamental governing equations provided as a starting point are:\n1.  **Continuity Equation:**\n    $$ \\frac{\\partial \\rho}{\\partial t} + \\nabla \\cdot (\\rho \\boldsymbol{u}) = 0 $$\n    In terms of the material derivative, $D/Dt = \\partial/\\partial t + \\boldsymbol{u} \\cdot \\nabla$, this is equivalent to $\\frac{1}{\\rho}\\frac{D\\rho}{Dt} = -\\nabla \\cdot \\boldsymbol{u}$.\n\n2.  **Momentum Equation (non-conservative form):**\n    $$ \\rho \\frac{D\\boldsymbol{u}}{Dt} = -\\nabla p + \\nabla \\cdot \\boldsymbol{\\tau} $$\n\n3.  **Internal Energy Equation:**\n    $$ \\rho \\frac{De}{Dt} = -p (\\nabla \\cdot \\boldsymbol{u}) + \\boldsymbol{\\tau} : \\nabla \\boldsymbol{u} - \\nabla \\cdot \\boldsymbol{q} $$\n    Here, $-p (\\nabla \\cdot \\boldsymbol{u})$ represents the reversible work of compression/expansion, $\\boldsymbol{\\tau} : \\nabla \\boldsymbol{u}$ is the irreversible viscous dissipation (work done by viscous stresses converted to internal energy), and $-\\nabla \\cdot \\boldsymbol{q}$ is the heat addition by conduction.\n\n### Derivation of the Total Energy ($E$) Equation\n\nThe total specific energy is defined as $E = e + \\frac{1}{2}|\\boldsymbol{u}|^2$. Its evolution is found by summing the evolution equations for internal energy and kinetic energy.\n\nFirst, we derive the kinetic energy equation by taking the dot product of the velocity vector $\\boldsymbol{u}$ with the momentum equation:\n$$ \\boldsymbol{u} \\cdot \\left(\\rho \\frac{D\\boldsymbol{u}}{Dt}\\right) = \\boldsymbol{u} \\cdot (-\\nabla p) + \\boldsymbol{u} \\cdot (\\nabla \\cdot \\boldsymbol{\\tau}) $$\nRecognizing that $\\boldsymbol{u} \\cdot \\frac{D\\boldsymbol{u}}{Dt} = \\frac{D}{Dt}\\left(\\frac{1}{2}\\boldsymbol{u}\\cdot\\boldsymbol{u}\\right) = \\frac{D}{Dt}\\left(\\frac{1}{2}|\\boldsymbol{u}|^2\\right)$, we obtain the equation for specific kinetic energy:\n$$ \\rho \\frac{D}{Dt}\\left(\\frac{1}{2}|\\boldsymbol{u}|^2\\right) = -\\boldsymbol{u} \\cdot \\nabla p + \\boldsymbol{u} \\cdot (\\nabla \\cdot \\boldsymbol{\\tau}) $$\nNow, we add the internal energy equation to the kinetic energy equation:\n$$ \\rho \\frac{De}{Dt} + \\rho \\frac{D}{Dt}\\left(\\frac{1}{2}|\\boldsymbol{u}|^2\\right) = [-p (\\nabla \\cdot \\boldsymbol{u}) - \\boldsymbol{u} \\cdot \\nabla p] + [\\boldsymbol{\\tau} : \\nabla \\boldsymbol{u} + \\boldsymbol{u} \\cdot (\\nabla \\cdot \\boldsymbol{\\tau})] - \\nabla \\cdot \\boldsymbol{q} $$\nThe left side combines to give $\\rho \\frac{DE}{Dt}$. We group the terms on the right side.\nUsing the product rule for divergence, we identify two key identities:\n1.  For the pressure work terms: $p (\\nabla \\cdot \\boldsymbol{u}) + \\boldsymbol{u} \\cdot \\nabla p = \\nabla \\cdot (p \\boldsymbol{u})$.\n2.  For the viscous work terms: $\\boldsymbol{\\tau} : \\nabla \\boldsymbol{u} + \\boldsymbol{u} \\cdot (\\nabla \\cdot \\boldsymbol{\\tau}) = \\nabla \\cdot (\\boldsymbol{\\tau} \\cdot \\boldsymbol{u})$.\n\nSubstituting these identities into the summed equation yields the transport equation for total energy in non-conservative form:\n$$ \\rho \\frac{DE}{Dt} = -\\nabla \\cdot (p \\boldsymbol{u}) + \\nabla \\cdot (\\boldsymbol{\\tau} \\cdot \\boldsymbol{u}) - \\nabla \\cdot \\boldsymbol{q} $$\nTo obtain the fully conservative form, we use the relation $\\rho \\frac{D\\phi}{Dt} = \\frac{\\partial (\\rho \\phi)}{\\partial t} + \\nabla \\cdot (\\rho \\boldsymbol{u} \\phi)$, which is a direct consequence of the continuity equation. Applying this to $E$:\n$$ \\frac{\\partial (\\rho E)}{\\partial t} + \\nabla \\cdot (\\rho E \\boldsymbol{u}) = -\\nabla \\cdot (p \\boldsymbol{u}) + \\nabla \\cdot (\\boldsymbol{\\tau} \\cdot \\boldsymbol{u}) - \\nabla \\cdot \\boldsymbol{q} $$\nRearranging all terms as divergences gives the standard conservative form:\n$$ \\frac{\\partial (\\rho E)}{\\partial t} + \\nabla \\cdot [(\\rho E + p) \\boldsymbol{u}] = \\nabla \\cdot (\\boldsymbol{\\tau} \\cdot \\boldsymbol{u} - \\boldsymbol{q}) $$\nThe crucial observation is that the pressure work terms, $-p(\\nabla \\cdot \\boldsymbol{u})$ from internal energy and $-\\boldsymbol{u}\\cdot\\nabla p$ from kinetic energy, which are volumetric source terms, combine into a single divergence term, $-\\nabla \\cdot (p \\boldsymbol{u})$, which represents a flux of energy.\n\n### Derivation of the Static Enthalpy ($h$) Equation\n\nThe static specific enthalpy is defined as $h = e + p/\\rho$. To find its transport equation, we start from this definition. Applying the material derivative:\n$$ \\frac{Dh}{Dt} = \\frac{De}{Dt} + \\frac{D}{Dt}\\left(\\frac{p}{\\rho}\\right) $$\nUsing the quotient rule on the pressure/density term:\n$$ \\frac{D}{Dt}\\left(\\frac{p}{\\rho}\\right) = \\frac{1}{\\rho}\\frac{Dp}{Dt} - \\frac{p}{\\rho^2}\\frac{D\\rho}{Dt} $$\nFrom the continuity equation, we have $\\frac{D\\rho}{Dt} = -\\rho \\nabla \\cdot \\boldsymbol{u}$. Substituting this:\n$$ \\frac{D}{Dt}\\left(\\frac{p}{\\rho}\\right) = \\frac{1}{\\rho}\\frac{Dp}{Dt} - \\frac{p}{\\rho^2}(-\\rho \\nabla \\cdot \\boldsymbol{u}) = \\frac{1}{\\rho}\\frac{Dp}{Dt} + \\frac{p}{\\rho}\\nabla \\cdot \\boldsymbol{u} $$\nSubstituting this back into the expression for $Dh/Dt$ and multiplying by $\\rho$:\n$$ \\rho \\frac{Dh}{Dt} = \\rho \\frac{De}{Dt} + \\rho \\left( \\frac{1}{\\rho}\\frac{Dp}{Dt} + \\frac{p}{\\rho}\\nabla \\cdot \\boldsymbol{u} \\right) = \\rho \\frac{De}{Dt} + \\frac{Dp}{Dt} + p \\nabla \\cdot \\boldsymbol{u} $$\nFinally, we substitute the given equation for internal energy, $\\rho \\frac{De}{Dt} = -p (\\nabla \\cdot \\boldsymbol{u}) + \\boldsymbol{\\tau} : \\nabla \\boldsymbol{u} - \\nabla \\cdot \\boldsymbol{q}$:\n$$ \\rho \\frac{Dh}{Dt} = (-p \\nabla \\cdot \\boldsymbol{u} + \\boldsymbol{\\tau} : \\nabla \\boldsymbol{u} - \\nabla \\cdot \\boldsymbol{q}) + \\frac{Dp}{Dt} + p \\nabla \\cdot \\boldsymbol{u} $$\nThe terms $+p \\nabla \\cdot \\boldsymbol{u}$ and $-p \\nabla \\cdot \\boldsymbol{u}$ cancel. This yields the transport equation for static enthalpy:\n$$ \\rho \\frac{Dh}{Dt} = \\frac{Dp}{Dt} + \\boldsymbol{\\tau} : \\nabla \\boldsymbol{u} - \\nabla \\cdot \\boldsymbol{q} $$\nHere, the explicit work of compression term $p(\\nabla\\cdot \\boldsymbol{u})$ has been replaced by the material derivative of pressure, $Dp/Dt$, which acts as a source term. This is the key difference from the internal energy formulation.\n\n### Evaluation of Options\n\n**A. In the conservative total-energy formulation for $E$, the pressure–work and kinetic–internal energy exchange appear as a face flux via $\\nabla\\cdot(p \\boldsymbol{u})$, and there is no explicit volumetric source term $-p\\,\\nabla\\cdot\\boldsymbol{u}$ in the $E$ equation.**\nThis is correct. Our derivation shows that the combination of the volumetric source terms $-p(\\nabla \\cdot \\boldsymbol{u})$ (from $e$) and $-\\boldsymbol{u} \\cdot \\nabla p$ (from kinetic energy) results in the term $-\\nabla \\cdot(p \\boldsymbol{u})$ in the equation for $E$. A divergence term is integrated over a control volume to become a surface integral (flux), which is evaluated at cell faces in a finite volume method. The original source term $-p\\,\\nabla\\cdot\\boldsymbol{u}$ is no longer explicitly present. **Correct**.\n\n**B. In the static-enthalpy formulation for $h$, the compressibility interaction appears as the material derivative of pressure $D p/D t$ on the right-hand side, i.e., the explicit $p\\,\\nabla\\cdot\\boldsymbol{u}$ term is absent.**\nThis is correct. Our derivation of the $h$ equation explicitly shows that the terms $\\pm p\\,\\nabla\\cdot\\boldsymbol{u}$ cancel, and the effect of pressure changes on the fluid parcel appears as the source term $Dp/Dt$. This term encapsulates the compressibility effects that were represented by $-p(\\nabla\\cdot\\boldsymbol{u})$ in the internal energy equation. **Correct**.\n\n**C. Summing the internal-energy and kinetic-energy balances eliminates the pair of terms $-p\\,\\nabla\\cdot\\boldsymbol{u}$ and $-\\boldsymbol{u}\\cdot\\nabla p$, converting them to $\\nabla\\cdot(p \\boldsymbol{u})$; this identity underpins the conservative total-energy flux.**\nThis is correct. This statement accurately describes the key mathematical step in deriving the total energy equation. The identity $-\\left(p\\nabla\\cdot\\boldsymbol{u} + \\boldsymbol{u}\\cdot\\nabla p\\right) = -\\nabla\\cdot(p\\boldsymbol{u})$ is precisely what allows the separate, non-conservative work terms to be consolidated into a single term that has the mathematical form of a flux divergence, which is the requirement for a conservative formulation. **Correct**.\n\n**D. Viscous dissipation $\\boldsymbol{\\tau}:\\nabla \\boldsymbol{u}$ does not enter the static-enthalpy equation, because enthalpy already accounts for mechanical effects.**\nThis is incorrect. Our derivation $\\rho \\frac{Dh}{Dt} = \\frac{Dp}{Dt} + \\boldsymbol{\\tau} : \\nabla \\boldsymbol{u} - \\nabla \\cdot \\boldsymbol{q}$ clearly shows that the viscous dissipation term $\\boldsymbol{\\tau} : \\nabla \\boldsymbol{u}$ is present. This term represents an irreversible conversion of mechanical energy to internal energy (heat), and it must be accounted for in any energy or enthalpy balance. Enthalpy does not inherently account for this dissipative effect. **Incorrect**.\n\n**E. For an ideal gas, the static-enthalpy equation contains only a source proportional to $\\nabla\\cdot \\boldsymbol{u}$; therefore it does not need $D p/D t$.**\nThis is incorrect. The derived enthalpy equation is general for any fluid. The equation is $\\rho \\frac{Dh}{Dt} = \\frac{Dp}{Dt} + \\dots$. It contains the source term $Dp/Dt$ and does *not* contain a source term proportional to $\\nabla\\cdot\\boldsymbol{u}$. Assuming an ideal gas does not change this fundamental structure. The statement confuses the enthalpy formulation with the internal energy formulation, which does contain the term $-p \\nabla\\cdot\\boldsymbol{u}$. **Incorrect**.\n\n**F. In a pressure-based compressible solver, using $h$ instead of $E$ moves the pressure–velocity coupling from the convective flux to a source involving $D p/D t$, which can affect discrete conservation across shocks unless special measures are taken.**\nThis is correct. This statement correctly interprets the numerical implications of our derivations. In the $E$-formulation, pressure appears in the convective flux term $(\\rho E + p)\\boldsymbol{u}$. This is a strict conservation form that correctly captures shock waves. In the $h$-formulation, which in conservative form is $\\frac{\\partial (\\rho h)}{\\partial t} + \\nabla \\cdot (\\rho h \\boldsymbol{u}) = \\frac{Dp}{Dt} + \\dots$, the pressure coupling has moved to the source term $Dp/Dt$. An equation with derivatives in the source term is not in strict conservation form. Standard numerical schemes applied to such an equation will not correctly compute the speed and strength of discontinuities like shocks, violating the Rankine-Hugoniot jump conditions. This is a well-known issue in CFD, necessitating special treatment for the $h$-formulation in transonic/supersonic flows. **Correct**.", "answer": "$$\\boxed{ABCF}$$", "id": "3353133"}, {"introduction": "Having established the utility of the static enthalpy formulation, we must accurately define enthalpy in terms of state variables like temperature. For many applications, assuming a constant specific heat is insufficient; accuracy demands that we account for its temperature dependence, $c_p(T)$. This exercise provides hands-on practice in deriving the specific enthalpy $h(T)$ from a polynomial representation of $c_p(T)$ and computing its derivative with respect to temperature, $\\partial h / \\partial T$ [@problem_id:3353153]. This Jacobian term is a critical component for the stability and convergence of implicit, coupled numerical solvers.", "problem": "Consider a single-component ideal gas with constant gas constant $R$ and temperature-dependent isobaric heat capacity $c_{p}(T)$. A pressure-based compressible solver advances the static enthalpy $h(T)$ via an enthalpy transport equation, and uses a fully coupled Newton linearization in which the Jacobian requires $\\partial h/\\partial T$. Starting from the First Law of Thermodynamics and the definition of static enthalpy for a continuum, and taking the equation of state for an ideal gas, write the enthalpy transport equation in terms of $h(T)$, and express $h(T)$ relative to a chosen reference temperature $T_{\\mathrm{ref}}$ (with $h(T_{\\mathrm{ref}})=0$) in a form consistent with a temperature-dependent $c_{p}(T)$. Assume the following scientifically plausible representation for the heat capacity over a moderate temperature range:\n$$\nc_{p}(T) \\;=\\; c_{0} \\;+\\; c_{1}\\,T \\;+\\; c_{2}\\,T^{2} \\;+\\; \\frac{c_{3}}{T},\n$$\nwhere $c_{0}$, $c_{1}$, $c_{2}$, and $c_{3}$ are positive constants. Derive the Jacobian contribution $\\partial h/\\partial T$ needed by the coupled solver in closed form, as a function of $T$ and the given constants. Express your final answer as a single closed-form analytic expression. No numerical evaluation is required.", "solution": "The problem requires the derivation of the Jacobian contribution $\\frac{\\partial h}{\\partial T}$ for an ideal gas with a temperature-dependent specific heat at constant pressure, $c_p(T)$. The derivation must be grounded in fundamental thermodynamic principles.\n\nLet us begin with the definition of specific static enthalpy, $h$, for a continuum:\n$$h = e + \\frac{p}{\\rho}$$\nwhere $e$ is the specific internal energy, $p$ is the static pressure, and $\\rho$ is the density. In differential form, using the specific volume $v = 1/\\rho$:\n$$dh = de + d(pv) = de + p\\,dv + v\\,dp$$\nThe First Law of Thermodynamics for a reversible process, expressed in terms of specific properties, is:\n$$de = T\\,ds - p\\,dv$$\nwhere $T$ is the absolute temperature and $s$ is the specific entropy. Substituting this expression for $de$ into the differential for $dh$ yields a fundamental thermodynamic relation:\n$$dh = (T\\,ds - p\\,dv) + p\\,dv + v\\,dp = T\\,ds + v\\,dp$$\nThe specific heat at constant pressure, $c_p$, is defined as the partial derivative of enthalpy with respect to temperature at constant pressure:\n$$c_p \\equiv \\left(\\frac{\\partial h}{\\partial T}\\right)_p$$\nFor a general substance, enthalpy $h$ is a function of both temperature and pressure, $h(T, p)$. Its total differential is $dh = (\\frac{\\partial h}{\\partial T})_p dT + (\\frac{\\partial h}{\\partial p})_T dp$. Using the definition of $c_p$, this becomes:\n$$dh = c_p\\,dT + \\left(\\frac{\\partial h}{\\partial p}\\right)_T dp$$\nFor an ideal gas, the equation of state is $p = \\rho R T$ or $pv = RT$. We can show that the enthalpy of an ideal gas is a function of temperature only. The term $(\\frac{\\partial h}{\\partial p})_T$ can be related to the equation of state by the expression $(\\frac{\\partial h}{\\partial p})_T = v - T(\\frac{\\partial v}{\\partial T})_p$. For an ideal gas, $v(T,p) = RT/p$, so $(\\frac{\\partial v}{\\partial T})_p = R/p = v/T$. Substituting this gives:\n$$\\left(\\frac{\\partial h}{\\partial p}\\right)_T = v - T\\left(\\frac{v}{T}\\right) = v - v = 0$$\nThus, for an ideal gas, enthalpy does not depend on pressure, i.e., $h = h(T)$. The differential $dh$ simplifies to:\n$$dh = c_p(T)\\,dT$$\nThis demonstrates that for an ideal gas, even one with a temperature-dependent heat capacity, the ordinary derivative of enthalpy with respect to temperature is equal to the specific heat at constant pressure.\n\nThe problem asks for an expression for $h(T)$ relative to a reference temperature $T_{\\mathrm{ref}}$ at which $h(T_{\\mathrm{ref}}) = 0$. We obtain this by integrating the preceding relation from $T_{\\mathrm{ref}}$ to $T$:\n$$\\int_{h(T_{\\mathrm{ref}})}^{h(T)} dh' = \\int_{T_{\\mathrm{ref}}}^{T} c_p(\\tau)\\,d\\tau$$\n$$h(T) - h(T_{\\mathrm{ref}}) = \\int_{T_{\\mathrm{ref}}}^{T} c_p(\\tau)\\,d\\tau$$\nApplying the condition $h(T_{\\mathrm{ref}}) = 0$:\n$$h(T) = \\int_{T_{\\mathrm{ref}}}^{T} c_p(\\tau)\\,d\\tau$$\nThe problem provides the functional form for $c_p(T)$:\n$$c_p(T) = c_{0} + c_{1}T + c_{2}T^{2} + \\frac{c_{3}}{T}$$\nSubstituting this into the integral for $h(T)$:\n$$h(T) = \\int_{T_{\\mathrm{ref}}}^{T} \\left(c_{0} + c_{1}\\tau + c_{2}\\tau^{2} + \\frac{c_{3}}{\\tau}\\right) d\\tau$$\nPerforming the definite integration yields:\n$$h(T) = \\left[ c_{0}\\tau + \\frac{c_{1}}{2}\\tau^{2} + \\frac{c_{2}}{3}\\tau^{3} + c_{3}\\ln(\\tau) \\right]_{T_{\\mathrm{ref}}}^{T}$$\n$$h(T) = \\left( c_{0}T + \\frac{c_{1}}{2}T^{2} + \\frac{c_{2}}{3}T^{3} + c_{3}\\ln(T) \\right) - \\left( c_{0}T_{\\mathrm{ref}} + \\frac{c_{1}}{2}T_{\\mathrm{ref}}^{2} + \\frac{c_{2}}{3}T_{\\mathrm{ref}}^{3} + c_{3}\\ln(T_{\\mathrm{ref}}) \\right)$$\nThis is the expression for the specific static enthalpy as a function of temperature.\n\nThe primary quantity to be derived is the Jacobian contribution $\\frac{\\partial h}{\\partial T}$. Since $h$ is a function of $T$ only, this is equivalent to the total derivative $\\frac{dh}{dT}$. We can obtain this by directly differentiating the derived expression for $h(T)$ with respect to $T$. The term involving $T_{\\mathrm{ref}}$ is a constant and its derivative is zero.\n$$\\frac{\\partial h}{\\partial T} = \\frac{\\partial}{\\partial T} \\left[ \\left( c_{0}T + \\frac{c_{1}}{2}T^{2} + \\frac{c_{2}}{3}T^{3} + c_{3}\\ln(T) \\right) - (\\text{constant}) \\right]$$\n$$\\frac{\\partial h}{\\partial T} = c_{0}\\frac{d(T)}{dT} + \\frac{c_{1}}{2}\\frac{d(T^{2})}{dT} + \\frac{c_{2}}{3}\\frac{d(T^{3})}{dT} + c_{3}\\frac{d(\\ln(T))}{dT}$$\n$$\\frac{\\partial h}{\\partial T} = c_{0}(1) + \\frac{c_{1}}{2}(2T) + \\frac{c_{2}}{3}(3T^{2}) + c_{3}\\left(\\frac{1}{T}\\right)$$\nSimplifying this expression, we arrive at the final result:\n$$\\frac{\\partial h}{\\partial T} = c_{0} + c_{1}T + c_{2}T^{2} + \\frac{c_{3}}{T}$$\nAs expected from the Fundamental Theorem of Calculus and our initial thermodynamic analysis, the derivative of the enthalpy integral is the specific heat capacity, $\\frac{\\partial h}{\\partial T} = c_p(T)$. This term is essential for the Newton linearization of the energy (or enthalpy) transport equation in a coupled solver where temperature is an independent variable.\n\nFor completeness, the enthalpy transport equation, requested in the problem statement, can be derived from the general energy equation. A common form is:\n$$\\rho \\frac{Dh}{Dt} = \\frac{Dp}{Dt} - \\nabla \\cdot \\mathbf{q} + \\mathbf{\\Phi}$$\nwhere $\\frac{D}{Dt} = \\frac{\\partial}{\\partial t} + \\mathbf{u} \\cdot \\nabla$ is the material derivative, $\\mathbf{q}$ is the heat flux vector (e.g., from Fourier's law, $\\mathbf{q} = -k \\nabla T$), and $\\mathbf{\\Phi} = \\mathbf{\\tau} : \\nabla\\mathbf{u}$ represents the viscous dissipation function. In a coupled numerical solver that solves for temperature $T$, the enthalpy $h$ is treated as $h(T)$. The term $\\frac{\\partial h}{\\partial T}$ arises during the linearization of any term involving $h$, such as the transient term $\\rho \\frac{\\partial h}{\\partial t} = \\rho \\frac{\\partial h}{\\partial T} \\frac{\\partial T}{\\partial t}$.", "answer": "$$\\boxed{c_{0} + c_{1}T + c_{2}T^{2} + \\frac{c_{3}}{T}}$$", "id": "3353153"}, {"introduction": "A significant challenge in simulating compressible flows, particularly at low to moderate Mach numbers, is numerical stiffness. The large disparity between the convective speed $u_{0}$ and the acoustic speed $a$ forces traditional explicit time-stepping schemes to use prohibitively small time steps for stability. This practice delves into a powerful solution, the Implicit-Explicit (IMEX) time integration method, by performing a von Neumann stability analysis on a model problem [@problem_id:3353113]. By deriving the stability region, you will quantify how this approach alleviates stiffness and allows for much larger, more efficient time steps based on the convective timescale.", "problem": "Consider a one-dimensional isentropic compressible flow governed by the linearized Euler equations about a uniform state with constant velocity $u_{0} > 0$, density $\\rho_{0}$, pressure $p_{0}$, and sound speed $a$. The Mach number is defined as $M = u_{0}/a$. In a pressure-based formulation, linearization of the momentum and continuity (pressure) equations yields the system for the primitive variables $u$ and $p$:\n$$\n\\frac{\\partial u}{\\partial t} + u_{0} \\frac{\\partial u}{\\partial x} + \\frac{1}{\\rho_{0}} \\frac{\\partial p}{\\partial x} = 0, \\qquad\n\\frac{\\partial p}{\\partial t} + u_{0} \\frac{\\partial p}{\\partial x} + \\rho_{0} a^{2} \\frac{\\partial u}{\\partial x} = 0,\n$$\nwhere isentropic behavior is assumed so that $a^{2} = \\left(\\frac{\\partial p}{\\partial \\rho}\\right)_{s}$.\n\nYou will investigate an Implicit–Explicit (IMEX) time integration strategy in which the pressure-related acoustic coupling terms are treated implicitly and the convective terms are treated explicitly. Specifically, consider a uniform periodic grid with spacing $\\Delta x$ and apply the following spatial discretizations to the Fourier mode with nondimensional wavenumber angle $\\theta \\in [0,\\pi]$:\n- For the convective derivatives proportional to $u_{0}$, use the first-order upwind difference with symbol $D_{\\text{up}}(\\theta) = \\frac{1 - \\exp(-i\\theta)}{\\Delta x}$.\n- For the acoustic coupling derivatives in the off-diagonal terms, use the centered difference with symbol $D_{\\text{c}}(\\theta) = \\frac{i \\sin\\theta}{\\Delta x}$.\n\nLet the Implicit–Explicit (IMEX) update advance from time level $n$ to $n+1$ by Forward Euler for the explicit convective part and Backward Euler for the implicit acoustic part. Denote the Courant–Friedrichs–Lewy (CFL) numbers\n$$\nC = \\frac{u_{0} \\Delta t}{\\Delta x}, \\qquad \\Lambda = \\frac{a \\Delta t}{\\Delta x},\n$$\nwhere $\\Delta t$ is the time step. Perform a von Neumann Fourier analysis of the resulting linear update to derive the complex amplification factors and the corresponding stability condition requiring that the spectral radius of the amplification matrix be less than or equal to $1$ for all $\\theta \\in [0,\\pi]$. From this, determine the maximum allowable nondimensional acoustic CFL number $\\Lambda_{\\max}$ as an explicit function of the Mach number $M$, and explain based on the derived condition why the stiffness associated with acoustic waves is reduced at moderate $M$ under this IMEX treatment.\n\nProvide your final answer as a single closed-form expression for $\\Lambda_{\\max}(M)$ with no units. The answer must be a single analytic expression, not an inequality or an equation.", "solution": "The problem requires a von Neumann stability analysis of a given Implicit-Explicit (IMEX) scheme for the one-dimensional linearized compressible Euler equations. We will determine the maximum allowable acoustic CFL number $\\Lambda_{\\max}$ as a function of the Mach number $M$.\n\nFirst, we write the given system of partial differential equations:\n$$\n\\frac{\\partial u}{\\partial t} + u_{0} \\frac{\\partial u}{\\partial x} + \\frac{1}{\\rho_{0}} \\frac{\\partial p}{\\partial x} = 0\n$$\n$$\n\\frac{\\partial p}{\\partial t} + u_{0} \\frac{\\partial p}{\\partial x} + \\rho_{0} a^{2} \\frac{\\partial u}{\\partial x} = 0\n$$\nTo simplify the analysis without loss of generality, we can apply a scaling transformation to the variables to make the acoustic terms symmetric. The eigenvalues of the amplification matrix are invariant under such a linear transformation. Let the new variables be $u' = u$ and $p' = p/(\\rho_0 a)$. The system becomes:\n$$\n\\frac{\\partial u'}{\\partial t} + u_{0} \\frac{\\partial u'}{\\partial x} + a \\frac{\\partial p'}{\\partial x} = 0\n$$\n$$\n\\frac{\\partial p'}{\\partial t} + u_{0} \\frac{\\partial p'}{\\partial x} + a \\frac{\\partial u'}{\\partial x} = 0\n$$\nFor simplicity, we drop the primes and work with this symmetric form. We consider a single Fourier mode for the solution vector $\\mathbf{v}(x,t) = [u(x,t), p(x,t)]^T$ of the form $\\mathbf{v}(x,t) = \\hat{\\mathbf{v}}(t) \\exp(ikx)$, where $k$ is the wavenumber. The spatial derivative $\\partial/\\partial x$ is replaced by its discrete Fourier symbol. Let $\\theta = k\\Delta x$ be the nondimensional wavenumber angle.\n\nThe semi-discretized system in Fourier space is:\n$$\n\\frac{d\\hat{\\mathbf{v}}}{dt} = \\mathbf{A} \\hat{\\mathbf{v}}\n$$\nAccording to the IMEX splitting, the operator matrix $\\mathbf{A}$ is split into an explicit part $\\mathbf{E}$ (convection) and an implicit part $\\mathbf{I}$ (acoustics).\n$$\n\\mathbf{E} = -u_0 D_{\\text{up}}(\\theta) \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix} \\quad , \\quad \\mathbf{I} = -a D_{\\text{c}}(\\theta) \\begin{pmatrix} 0 & 1 \\\\ 1 & 0 \\end{pmatrix}\n$$\nwhere $D_{\\text{up}}(\\theta) = \\frac{1 - \\exp(-i\\theta)}{\\Delta x}$ and $D_{\\text{c}}(\\theta) = \\frac{i \\sin\\theta}{\\Delta x}$.\n\nThe IMEX time integration scheme, using Forward Euler for the explicit part and Backward Euler for the implicit part, is given by:\n$$\n\\frac{\\hat{\\mathbf{v}}^{n+1} - \\hat{\\mathbf{v}}^n}{\\Delta t} = \\mathbf{E} \\hat{\\mathbf{v}}^n + \\mathbf{I} \\hat{\\mathbf{v}}^{n+1}\n$$\nRearranging for $\\hat{\\mathbf{v}}^{n+1}$ gives the update rule $\\hat{\\mathbf{v}}^{n+1} = \\mathbf{G} \\hat{\\mathbf{v}}^n$, where $\\mathbf{G}$ is the amplification matrix:\n$$\n(\\mathbf{I}_{\\text{mat}} - \\Delta t \\mathbf{I}) \\hat{\\mathbf{v}}^{n+1} = (\\mathbf{I}_{\\text{mat}} + \\Delta t \\mathbf{E}) \\hat{\\mathbf{v}}^n \\implies \\mathbf{G} = (\\mathbf{I}_{\\text{mat}} - \\Delta t \\mathbf{I})^{-1} (\\mathbf{I}_{\\text{mat}} + \\Delta t \\mathbf{E})\n$$\nHere, $\\mathbf{I}_{\\text{mat}}$ is the identity matrix. The matrices $(\\mathbf{I}_{\\text{mat}} + \\Delta t \\mathbf{E})$ and $(\\mathbf{I}_{\\text{mat}} - \\Delta t \\mathbf{I})^{-1}$ commute because the former is a scalar multiple of the identity matrix. The eigenvalues of their product $\\mathbf{G}$, denoted $\\lambda_G$, are therefore the products of their individual eigenvalues.\n\nThe eigenvalue of the explicit part, $(\\mathbf{I}_{\\text{mat}} + \\Delta t \\mathbf{E})$, is simply $\\lambda_E = 1 - C(1 - \\exp(-i\\theta))$, where $C = u_0 \\Delta t / \\Delta x$ is the convective CFL number.\n\nThe eigenvalues of the inverse implicit part, $(\\mathbf{I}_{\\text{mat}} - \\Delta t \\mathbf{I})^{-1}$, are the reciprocals of the eigenvalues of $(\\mathbf{I}_{\\text{mat}} - \\Delta t \\mathbf{I}) = \\begin{pmatrix} 1 & i \\Lambda \\sin\\theta \\\\ i \\Lambda \\sin\\theta & 1 \\end{pmatrix}$, where $\\Lambda = a \\Delta t / \\Delta x$. The characteristic equation for this matrix is $(1-\\lambda)^2 - (i\\Lambda\\sin\\theta)^2 = 0$, which yields eigenvalues $1 \\mp i\\Lambda\\sin\\theta$. The eigenvalues of the inverse matrix are thus $\\lambda_I = \\frac{1}{1 \\mp i\\Lambda\\sin\\theta}$.\n\nThe eigenvalues of the full amplification matrix are $\\lambda_G = \\lambda_E \\cdot \\lambda_I$. For stability, the spectral radius of $\\mathbf{G}$ must be less than or equal to $1$, which means $|\\lambda_G|^2 \\le 1$ for all $\\theta \\in [0, \\pi]$.\n$$\n|\\lambda_G|^2 = |\\lambda_E|^2 \\cdot |\\lambda_I|^2 \\le 1\n$$\nLet's compute the squared magnitudes of the two factors.\n$|\\lambda_E|^2 = |1 - C(1 - \\exp(-i\\theta))|^2 = |(1-C+C\\cos\\theta) - iC\\sin\\theta|^2 = (1-C+C\\cos\\theta)^2 + (C\\sin\\theta)^2 = 1 - 2C(1-C)(1-\\cos\\theta)$.\n$|\\lambda_I|^2 = \\left| \\frac{1}{1 \\mp i\\Lambda\\sin\\theta} \\right|^2 = \\frac{1}{|1 \\mp i\\Lambda\\sin\\theta|^2} = \\frac{1}{1 + \\Lambda^2 \\sin^2\\theta}$.\nThe stability condition becomes:\n$$\n\\frac{1 - 2C(1-C)(1-\\cos\\theta)}{1 + \\Lambda^2 \\sin^2\\theta} \\le 1\n$$\n$$\n1 - 2C(1-C)(1-\\cos\\theta) \\le 1 + \\Lambda^2 \\sin^2\\theta\n$$\n$$\n-2C(1-C)(1-\\cos\\theta) \\le \\Lambda^2 \\sin^2\\theta\n$$\nFor this inequality to hold for all $\\theta \\in [0, \\pi]$, we analyze the signs of the terms. Since $\\Lambda^2 \\ge 0$, $\\sin^2\\theta \\ge 0$, and $1-\\cos\\theta \\ge 0$, the right-hand side is always non-negative.\nIf the coefficient of the $(1-\\cos\\theta)$ term on the left is non-positive, i.e., $-2C(1-C) \\le 0$, then the left-hand side is always non-positive, and the inequality holds for any value of $\\Lambda$.\nThe condition $-2C(1-C) \\le 0$ implies $C(1-C) \\ge 0$. Since the CFL number $C = u_0 \\Delta t / \\Delta x$ must be positive, we require $1-C \\ge 0$, which gives the constraint $C \\le 1$.\nTherefore, the scheme is stable for any acoustic CFL number $\\Lambda$ as long as the convective CFL number satisfies $C \\le 1$.\n\nThe problem asks for the maximum allowable acoustic CFL number $\\Lambda_{\\max}$ as a function of the Mach number $M$. We use the relationship between the CFL numbers:\n$$\nC = \\frac{u_0 \\Delta t}{\\Delta x} = \\frac{u_0}{a} \\frac{a \\Delta t}{\\Delta x} = M \\Lambda\n$$\nThe stability condition $C \\le 1$ can be rewritten in terms of $M$ and $\\Lambda$:\n$$\nM \\Lambda \\le 1\n$$\nFor a given Mach number $M > 0$, this imposes an upper bound on $\\Lambda$:\n$$\n\\Lambda \\le \\frac{1}{M}\n$$\nThe maximum allowable nondimensional acoustic CFL number is therefore $\\Lambda_{\\max} = 1/M$.\n\nFinally, we explain why this IMEX treatment reduces stiffness. A fully explicit scheme must resolve the fastest waves in the system, which propagate at speeds $u_0 \\pm a$. The stability limit for such a scheme is typically of the form $\\Delta t \\le \\frac{\\Delta x}{|u_0|+a}$, which translates to $\\frac{(|u_0|+a)\\Delta t}{\\Delta x} \\le K$ for some constant $K$ of order unity. Assuming $K=1$ and $u_0>0$, we get $C + \\Lambda \\le 1$, or $\\Lambda(M+1) \\le 1$, leading to an explicit acoustic CFL limit of $\\Lambda_{\\text{exp}} \\le \\frac{1}{M+1}$.\nComparing the IMEX limit, $\\Lambda_{\\text{IMEX}} \\le 1/M$, with the explicit limit, we see that $\\frac{1}{M} > \\frac{1}{M+1}$. The ratio of maximum time steps is $\\frac{\\Delta t_{\\text{IMEX}}}{\\Delta t_{\\text{exp}}} = \\frac{1/M}{1/(M+1)} = \\frac{M+1}{M} = 1 + \\frac{1}{M}$.\nAt moderate Mach numbers (e.g., $M<1$), this ratio is significantly greater than $1$. For example, at $M=0.1$, the IMEX scheme allows a time step $11$ times larger than the explicit scheme. The stiffness arises when $a \\gg u_0$ (i.e., small $M$), forcing a very small $\\Delta t$ in explicit schemes to resolve the fast acoustic waves. The IMEX scheme treats these stiff acoustic terms implicitly, effectively removing the acoustic speed $a$ from the stability constraint. The resulting time-step limit, $\\Delta t \\le \\frac{\\Delta x}{u_0}$, depends only on the much slower convective speed $u_0$, thereby alleviating the stiffness.", "answer": "$$\\boxed{\\frac{1}{M}}$$", "id": "3353113"}]}