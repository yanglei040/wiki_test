{"hands_on_practices": [{"introduction": "The first step in implementing any explicit time-marching scheme is to understand its stability limits. This exercise connects the AUSM scheme's design back to the fundamental physics of wave propagation in the Euler equations. By deriving the Courant–Friedrichs–Lewy (CFL) condition, you will gain a deep understanding of why the maximum allowable time step, $\\Delta t$, is constrained by the fastest physical wave speed in the system, $|u| + a$ [@problem_id:3292940]. This analysis demonstrates that despite their complex formulation, AUSM-family schemes must respect the same physical information propagation limits as simpler upwind schemes.", "problem": "Consider the one-dimensional compressible Euler equations for an ideal gas with a constant ratio of specific heats $\\gamma$,\n$$\n\\frac{\\partial \\boldsymbol{Q}}{\\partial t} + \\frac{\\partial \\boldsymbol{F}(\\boldsymbol{Q})}{\\partial x} = \\boldsymbol{0},\n$$\nwhere $\\boldsymbol{Q} = \\begin{pmatrix} \\rho \\\\ \\rho u \\\\ \\rho E \\end{pmatrix}$ and $\\boldsymbol{F}(\\boldsymbol{Q}) = \\begin{pmatrix} \\rho u \\\\ \\rho u^{2} + p \\\\ u(\\rho E + p) \\end{pmatrix}$, with pressure $p$ given by the ideal-gas equation of state $p = (\\gamma - 1)\\left(\\rho E - \\tfrac{1}{2}\\rho u^{2}\\right)$. Let $a = \\sqrt{\\gamma p / \\rho}$ denote the speed of sound and $u$ the flow velocity.\n\nDiscretize the spatial domain using a uniform finite volume mesh with cell width $\\Delta x$ and denote cell averages by $\\boldsymbol{Q}_{i}(t)$. Let the numerical flux at face $x_{i+\\frac{1}{2}}$ be given by a member of the Advection Upstream Splitting Method (AUSM) family, constructed by splitting the flux into a convective part and an acoustic (pressure) part through Mach-number-based polynomials that recover exact upwinding in supersonic limits and preserve linearized consistency about a uniform state. Advance in time with an explicit forward Euler update,\n$$\n\\boldsymbol{Q}_{i}^{n+1} = \\boldsymbol{Q}_{i}^{n} - \\frac{\\Delta t}{\\Delta x}\\left(\\boldsymbol{F}_{i+\\frac{1}{2}}^{n} - \\boldsymbol{F}_{i-\\frac{1}{2}}^{n}\\right).\n$$\n\nStarting from the Euler equations’ characteristic structure and the AUSM construction principles stated above, analyze the spectral radius of the semi-discrete spatial operator implied by AUSM at a uniform reference state where $u$ and $a$ are constant across all faces. Identify the relevant wave speeds captured by AUSM and, by linearizing the scheme about this uniform state and invoking the requirement for monotonicity of a first-order upwind flux in each characteristic field, derive a sufficient Courant–Friedrichs–Lewy (CFL) stability bound for the forward Euler update in terms of the maximum characteristic speed.\n\nUnder these assumptions, what is the largest admissible time step $\\Delta t_{\\max}$ that guarantees stability of the forward Euler update with the AUSM flux on this uniform mesh, expressed in terms of $\\Delta x$, $|u|$, and $a$? Express your answer in terms of $\\Delta x$ (in meters), $u$ (in meters per second), and $a$ (in meters per second), so that $\\Delta t_{\\max}$ is in seconds. Your final answer must be a single closed-form analytic expression.", "solution": "The problem requires the derivation of the Courant–Friedrichs–Lewy (CFL) stability bound for a first-order Euler forward time-stepping scheme applied to the one-dimensional compressible Euler equations, discretized using a numerical flux from the Advection Upstream Splitting Method (AUSM) family. The analysis is to be performed for a uniform reference state.\n\nThe semi-discrete finite volume formulation for a cell $i$ is given by the time evolution of the cell-averaged state vector $\\boldsymbol{Q}_i$:\n$$\n\\frac{d\\boldsymbol{Q}_i}{dt} = -\\frac{1}{\\Delta x}\\left(\\boldsymbol{F}_{i+\\frac{1}{2}} - \\boldsymbol{F}_{i-\\frac{1}{2}}\\right)\n$$\nwhere $\\Delta x$ is the uniform cell width and $\\boldsymbol{F}_{i\\pm\\frac{1}{2}}$ are the numerical fluxes at the cell interfaces. The scheme is advanced in time using an explicit forward Euler method:\n$$\n\\frac{\\boldsymbol{Q}_{i}^{n+1} - \\boldsymbol{Q}_{i}^{n}}{\\Delta t} = -\\frac{1}{\\Delta x}\\left(\\boldsymbol{F}_{i+\\frac{1}{2}}^{n} - \\boldsymbol{F}_{i-\\frac{1}{2}}^{n}\\right)\n$$\n\nThe stability of this scheme is determined by analyzing its behavior for small perturbations around a uniform reference state, where the primitive variables—density $\\rho$, velocity $u$, and pressure $p$—and consequently the speed of sound $a$, are constant throughout the domain.\n\nThe governing equations, $\\frac{\\partial \\boldsymbol{Q}}{\\partial t} + \\frac{\\partial \\boldsymbol{F}(\\boldsymbol{Q})}{\\partial x} = \\boldsymbol{0}$, form a system of hyperbolic conservation laws. The local propagation of information in such a system is described by the flux Jacobian matrix, $\\boldsymbol{A}(\\boldsymbol{Q}) = \\frac{\\partial \\boldsymbol{F}}{\\partial \\boldsymbol{Q}}$. The eigenvalues of this matrix represent the characteristic speeds of the system, which are the speeds of the physical waves.\n\nFor the one-dimensional Euler equations, the flux Jacobian $\\boldsymbol{A}$ has three real eigenvalues:\n$$\n\\lambda_1 = u - a\n$$\n$$\n\\lambda_2 = u\n$$\n$$\n\\lambda_3 = u + a\n$$\nThese eigenvalues correspond to the speeds of the two acoustic waves (propagating at speed $a$ relative to the flow) and the entropy/contact discontinuity (propagating with the flow velocity $u$), respectively.\n\nThe problem states that the AUSM flux \"preserves linearized consistency about a uniform state\" and is constructed to \"recover exact upwinding in supersonic limits.\" For a first-order scheme, these properties imply that when linearized about a uniform state, the scheme's behavior is equivalent to a first-order upwind discretization applied to each of the characteristic fields.\n\nThe system of partial differential equations can be locally diagonalized into a set of three uncoupled scalar advection equations for the characteristic variables $w_k$:\n$$\n\\frac{\\partial w_k}{\\partial t} + \\lambda_k \\frac{\\partial w_k}{\\partial x} = 0, \\quad k \\in \\{1, 2, 3\\}\n$$\nA first-order upwind, forward Euler discretization for such a scalar equation is stable if and only if the Courant number, $C_k = |\\lambda_k| \\frac{\\Delta t}{\\Delta x}$, satisfies the CFL condition:\n$$\nC_k \\le 1 \\implies |\\lambda_k| \\frac{\\Delta t}{\\Delta x} \\le 1\n$$\nThis condition ensures that the numerical domain of dependence contains the physical domain of dependence for each wave. The problem's \"requirement for monotonicity of a first-order upwind flux in each characteristic field\" is precisely the physical motivation leading to this mathematical constraint on the amplification factor of the discretized scheme.\n\nFor the complete system of Euler equations to be stable, the time step $\\Delta t$ must be small enough to satisfy this condition for all characteristic waves simultaneously. This means the condition must hold for the wave with the largest propagation speed. The maximum characteristic speed is given by the spectral radius of the flux Jacobian matrix, denoted $\\rho(\\boldsymbol{A})$:\n$$\n\\rho(\\boldsymbol{A}) = \\max(|\\lambda_1|, |\\lambda_2|, |\\lambda_3|) = \\max(|u-a|, |u|, |u+a|)\n$$\nThe stability condition for the coupled system is therefore:\n$$\n\\rho(\\boldsymbol{A}) \\frac{\\Delta t}{\\Delta x} \\le 1\n$$\nTo find the explicit form of $\\rho(\\boldsymbol{A})$, we analyze the term $\\max(|u-a|, |u|, |u+a|)$. The speed of sound $a = \\sqrt{\\gamma p / \\rho}$ is, for any physical gas, a strictly positive quantity ($a > 0$).\nBy the triangle inequality, we know that $|u+a| \\le |u|+|a| = |u|+a$ and $|u-a| \\le |u|+|-a| = |u|+a$.\nLet us prove that $\\max(|u-a|, |u|, |u+a|)$ is exactly $|u|+a$.\n- We have $|u+a| \\ge u+a$ or $|u+a| \\ge -u-a$.\n- We have $|u-a| \\ge u-a$ or $|u-a| \\ge a-u$.\n- Since $a > 0$, it is clear that $|u| < |u|+a$.\n- We must compare $|u|+a$ against $|u+a|$ and $|u-a|$.\n- If $u \\ge 0$, then $|u|=u$. The term becomes $u+a$. Since $a>0$, $u+a \\ge |u+a| = u+a$ and $u+a \\ge |u-a|$. The equality holds in the first comparison, and the second is true because $u+a-(u-a) = 2a > 0$ if $u \\ge a$, and $u+a-(a-u) = 2u \\ge 0$ if $u < a$.\n- If $u < 0$, then $|u|=-u$. The term becomes $a-u$. Since $a>0$ and $u<0$, $a-u$ is positive. We have $a-u \\ge |u+a|$ and $a-u \\ge |u-a|=|u|+a$. The equality holds in the second comparison. The first comparison reduces to $a-u \\ge |a-|u||$, which is true since $a-u-(a-|u|) = |u| > 0$ if $a>|u|$, and $a-u-(|u|-a) = 2(a-|u|)$ can be negative, but $|u|+a$ is the maximum.\nLet's restart the argument more clearly.\nThe speeds are $|u|$, $|u-a|$, and $|u+a|$. By the triangle inequality, $|u-a| \\leq |u|+a$ and $|u+a| \\leq |u|+a$. Also, since $a>0$, $|u| < |u|+a$. Thus, the maximum of the three values is $|u|+a$. This is the speed of the fastest-moving acoustic wave relative to the stationary grid.\n\nTherefore, the spectral radius of the flux Jacobian is:\n$$\n\\rho(\\boldsymbol{A}) = |u| + a\n$$\nSubstituting this into the stability condition gives:\n$$\n(|u| + a) \\frac{\\Delta t}{\\Delta x} \\le 1\n$$\nThe problem asks for the largest admissible time step, $\\Delta t_{\\max}$, which corresponds to the limit of this inequality:\n$$\n(|u| + a) \\frac{\\Delta t_{\\max}}{\\Delta x} = 1\n$$\nSolving for $\\Delta t_{\\max}$ yields the final expression:\n$$\n\\Delta t_{\\max} = \\frac{\\Delta x}{|u| + a}\n$$\nThis result is the standard CFL condition for first-order explicit upwind schemes applied to the 1D Euler equations. The specific internal machinery of the AUSM scheme is not needed, only its fundamental properties of consistency and adherence to upwinding principles, which guarantee that its linear stability is governed by the physical wave speeds of the underlying system.", "answer": "$$\\boxed{\\frac{\\Delta x}{|u| + a}}$$", "id": "3292940"}, {"introduction": "A key advantage of advanced flux-splitting schemes like AUSM$+$ is their ability to resolve certain flow features with high accuracy. This exercise explores the conditions necessary for the exact capturing of a contact discontinuity, where velocity and pressure are continuous but density jumps. By deriving these conditions, you will see how the careful design of the convective velocity and pressure flux components allows the scheme to eliminate numerical errors for this specific wave type [@problem_id:3292971]. This practice illuminates a core design philosophy behind modern shock-capturing schemes: tailoring the numerical flux to mimic the behavior of distinct physical wave patterns.", "problem": "Consider the one-dimensional Euler equations for a calorically perfect ideal gas with ratio of specific heats $\\gamma$, written in conservative form for the state vector $\\mathbf{U} = \\begin{pmatrix} \\rho \\\\ \\rho u \\\\ \\rho E \\end{pmatrix}$ and flux $\\mathbf{F}(\\mathbf{U}) = \\begin{pmatrix} \\rho u \\\\ \\rho u^2 + p \\\\ u(\\rho E + p) \\end{pmatrix}$. The equation of state and speed of sound are $p = (\\gamma - 1)\\left(\\rho E - \\tfrac{1}{2}\\rho u^{2}\\right)$ and $a = \\sqrt{\\gamma p / \\rho}$. A contact discontinuity is defined by left and right states with equal velocity and pressure but different density, i.e., $u_{L} = u_{R}$, $p_{L} = p_{R}$, and $\\rho_{L} \\neq \\rho_{R}$. In the exact solution of the Riemann problem, the contact advects at speed $u$, with $u$ and $p$ constant and the density jump preserved.\n\nAn Advection Upstream Splitting Method (AUSM) flux of the AUSM$+$ family splits the intercell numerical flux at a face into a convective contribution and a pressure contribution. Without prescribing a particular variant, suppose the mass flux can be written as a product of a reference speed of sound $a_{f}$, an interface convective Mach number $\\widehat{M}$, and an upwinded density $\\rho^{\\mathrm{up}}$, while the pressure contribution entering the momentum flux is built from a pressure-splitting that reduces to the physical pressure when $p_{L} = p_{R}$. Assume second-order piecewise linear reconstruction is used on primitive variables $(\\rho,u,p)$ with a limiter that preserves equality when the true solution is constant.\n\nYour tasks:\n\n1) Starting from the Euler equations and the exact-contact property above, derive sufficient conditions on the numerical reconstruction and on the AUSM$+$-type flux parameters so that, for interfacial left/right data with $u_{L} = u_{R}$ and $p_{L} = p_{R}$ (but $\\rho_{L} \\neq \\rho_{R}$), the computed interface fluxes coincide with the exact contact fluxes. Express these conditions as requirements on the reconstructed interfacial primitive variables, the convective Mach number and reference speed of sound used in the mass flux, and the pressure-splitting used in the momentum flux. Your conditions must be sufficient to guarantee exact contact capture for arbitrary $\\rho_{L} \\neq \\rho_{R}$ and any subsonic or supersonic $u$ consistent with the Euler model.\n\n2) Under the sufficient conditions you derived, evaluate the numerical mass flux for the following left/right state with only density differing:\n- Ratio of specific heats $\\gamma = 1.4$,\n- Left and right pressures $p_{L} = p_{R} = 1.0 \\times 10^{5}$ in $\\mathrm{Pa}$,\n- Left and right velocities $u_{L} = u_{R} = 100$ in $\\mathrm{m/s}$,\n- Left and right densities $\\rho_{L} = 1.0$ and $\\rho_{R} = 2.0$ in $\\mathrm{kg/m^{3}}$.\n\nExpress the final mass flux in $\\mathrm{kg}/(\\mathrm{m}^{2}\\,\\mathrm{s})$, and round your answer to four significant figures. Report only the numerical value of the mass flux.", "solution": "The problem asks for two parts: first, to derive sufficient conditions for an Advection Upstream Splitting Method (AUSM) type scheme to exactly resolve a contact discontinuity, and second, to calculate the numerical mass flux for a specific contact discontinuity under these conditions.\n\n### Part 1: Sufficient Conditions for Exact Contact Resolution\n\nA contact discontinuity is characterized by left ($L$) and right ($R$) states with equal velocity $u_{L} = u_{R} = u_{c}$ and equal pressure $p_{L} = p_{R} = p_{c}$, but unequal density $\\rho_{L} \\neq \\rho_{R}$. In the exact solution to the one-dimensional Euler equations, this discontinuity advects with velocity $u_{c}$ while maintaining the jump in density. The velocity and pressure remain constant at $u_{c}$ and $p_{c}$ everywhere.\n\nThe exact physical flux vector $\\mathbf{F}(\\mathbf{U})$ is $\\mathbf{F}(\\mathbf{U}) = \\begin{pmatrix} \\rho u \\\\ \\rho u^2 + p \\\\ u(\\rho E + p) \\end{pmatrix}$. For a contact discontinuity moving at speed $u_c$, the state variables on the discontinuity itself are $(u_c, p_c)$, and the density is taken from the upwind direction. If $u_{c} > 0$, the left state $(\\rho_{L}, u_{c}, p_{c})$ is on the interface. If $u_{c} < 0$, the right state $(\\rho_{R}, u_{c}, p_{c})$ is on the interface. If $u_{c} = 0$, the flux is zero for mass and energy, and $[0, p_c, 0]^\\mathsf{T}$ for momentum. Let $\\rho^{\\mathrm{upwind}}$ denote the density on the upwind side. The exact flux $F_{exact}$ across the contact is:\n$F_{exact} = \\mathbf{F}(\\rho^{\\mathrm{upwind}}, u_{c}, p_{c}) = \\begin{pmatrix} \\rho^{\\mathrm{upwind}} u_{c} \\\\ \\rho^{\\mathrm{upwind}} u_{c}^{2} + p_{c} \\\\ u_{c}(\\rho^{\\mathrm{upwind}} E^{\\mathrm{upwind}} + p_{c}) \\end{pmatrix}$\nwhere $E^{\\mathrm{upwind}} = \\frac{p_{c}}{(\\gamma - 1)\\rho^{\\mathrm{upwind}}} + \\frac{1}{2}u_{c}^{2}$. The third component can also be written in terms of total enthalpy $H = E + p/\\rho$ as $(\\rho^{\\mathrm{upwind}}u_{c})H^{\\mathrm{upwind}}$.\n\nThe numerical flux $F_{num}$ for an AUSM-type scheme is split into a convective part and a pressure part. Following the problem description, at an interface with reconstructed left ($L$) and right ($R$) states, the numerical flux components are:\n1.  Mass flux: $F_{num, 1} = \\dot{m} = (a_{f}\\widehat{M})\\rho^{\\mathrm{up}}$\n2.  Momentum flux: $F_{num, 2} = \\dot{m}u^{\\mathrm{up}} + p_{num}$\n3.  Energy flux: $F_{num, 3} = \\dot{m}H^{\\mathrm{up}}$\n\nHere, $a_{f}$ is a reference speed of sound, $\\widehat{M}$ is a convective Mach number, and the superscript `up` denotes a value taken from the upwind side, determined by the sign of the convective velocity $u_f = a_f \\widehat{M}$. To achieve exact resolution of the contact, the numerical flux $F_{num}$ must equal the exact flux $F_{exact}$. We analyze the conditions for this equality component by component.\n\n**Condition 1: Reconstruction**\nThe problem states that a second-order piecewise linear reconstruction is applied to the primitive variables $(\\rho, u, p)$ and that the limiter preserves equality for constant data. For a contact discontinuity, the velocity and pressure fields are constant ($u=u_{c}, p=p_{c}$). Therefore, the reconstruction process must yield constant values for $u$ and $p$ at the cell interface. Let these interface values be denoted with subscripts $L$ and $R$:\n$$ u_{L} = u_{R} = u_{c} $$\n$$ p_{L} = p_{R} = p_{c} $$\nThe density $\\rho$ is discontinuous, so the reconstructed values $\\rho_{L}$ and $\\rho_{R}$ will in general be different. This condition on the reconstruction is a prerequisite for the analysis.\n\n**Condition 2: Pressure Flux**\nThe problem states that the pressure contribution $p_{num}$ reduces to the physical pressure when $p_{L} = p_{R}$. Since for a contact we have $p_{L} = p_{R} = p_{c}$, a sufficient condition is:\n$$ p_{num}(p_{L}, p_{R}) = p_{c} \\quad \\text{when} \\quad p_{L} = p_{R} = p_{c} $$\n\n**Condition 3: Convective Velocity and Upwinding**\nWe equate the numerical mass flux to the exact mass flux. Let's assume $u_c \\neq 0$.\n$$ F_{num, 1} = (a_{f}\\widehat{M})\\rho^{\\mathrm{up}} $$\n$$ F_{exact, 1} = u_{c}\\rho^{\\mathrm{upwind}} $$\nFor these to be equal for an arbitrary density jump ($\\rho_L \\neq \\rho_R$), two things must hold simultaneously:\n(a) The numerical scheme must choose the same upwind density as the exact solution, i.e., $\\rho^{\\mathrm{up}} = \\rho^{\\mathrm{upwind}}$. This means the upwinding direction must be determined by the sign of $u_{c}$. Since numerical upwinding is based on the sign of the convective velocity $u_{f} = a_{f}\\widehat{M}$, this implies that $\\mathrm{sgn}(u_f) = \\mathrm{sgn}(u_c)$.\n(b) The magnitude of the convective velocity must match the physical advection speed: $|u_f| = |u_c|$.\nCombining (a) and (b), the convective velocity must be exactly equal to the physical velocity:\n$$ a_{f}\\widehat{M} = u_{c} $$\nThis is a condition on the formulation of $a_f$ and $\\widehat{M}$. When evaluated for states satisfying $u_{L}=u_{R}=u_{c}$ and $p_{L}=p_{R}=p_{c}$, the resulting convective velocity must be $u_c$.\n\n**Momentum and Energy Flux Verification**\nWith these conditions, let's check the other flux components.\nFor the momentum flux:\n$F_{num, 2} = \\dot{m}u^{\\mathrm{up}} + p_{num}$. From the mass flux condition, $\\dot{m} = u_{c}\\rho^{\\mathrm{upwind}}$. The upwinded velocity $u^{\\mathrm{up}}$ is chosen based on the sign of $u_f=u_c$. Since $u_L=u_R=u_c$, $u^{\\mathrm{up}}$ is always $u_c$. From the pressure flux condition, $p_{num} = p_c$.\n$$ F_{num, 2} = (u_{c}\\rho^{\\mathrm{upwind}})u_{c} + p_{c} = \\rho^{\\mathrm{upwind}}u_{c}^{2} + p_{c} $$\nThis exactly matches the exact momentum flux $F_{exact, 2}$.\n\nFor the energy flux:\n$F_{num, 3} = \\dot{m}H^{\\mathrm{up}}$. The upwinded total enthalpy $H^{\\mathrm{up}}$ is chosen from the state $(\\rho^{\\mathrm{upwind}}, u_{c}, p_{c})$. Let's denote this as $H^{\\mathrm{upwind}}$.\n$$ F_{num, 3} = (u_{c}\\rho^{\\mathrm{upwind}})H^{\\mathrm{upwind}} = u_{c}\\rho^{\\mathrm{upwind}}\\left(E^{\\mathrm{upwind}} + \\frac{p_{c}}{\\rho^{\\mathrm{upwind}}}\\right) = u_{c}(\\rho^{\\mathrm{upwind}}E^{\\mathrm{upwind}} + p_{c}) $$\nThis exactly matches the exact energy flux $F_{exact, 3}$.\n\n**Summary of Sufficient Conditions:**\nFor an AUSM$+$ type scheme to exactly resolve a contact discontinuity, the following conditions are sufficient:\n1.  **Reconstruction:** The reconstruction of primitive variables $(\\rho, u, p)$ at a cell interface must yield unique values for velocity and pressure when the underlying data is constant, i.e., $u_{L}=u_{R}=u_{c}$ and $p_{L}=p_{R}=p_{c}$.\n2.  **Pressure Splitting:** The numerical pressure term $p_{num}$ in the momentum flux must evaluate to the common physical pressure $p_{c}$ when $p_{L}=p_{R}=p_{c}$.\n3.  **Convective Velocity:** The formulation for the interface convective velocity $u_f = a_{f}\\widehat{M}$ must reduce to the physical velocity $u_c$ when evaluated for interface states satisfying $u_{L}=u_{R}=u_c$ and $p_{L}=p_{R}=p_c$.\n4.  **Upwinding Consistency:** The upwinded quantities $(\\rho^{\\mathrm{up}}, u^{\\mathrm{up}}, H^{\\mathrm{up}})$ must be selected from the left or right state based on the sign of the convective velocity $u_f$.\n\n### Part 2: Numerical Mass Flux Calculation\n\nWe are asked to evaluate the numerical mass flux for a specific state under the sufficient conditions derived above. The given state is:\n- Ratio of specific heats: $\\gamma = 1.4$\n- Left and right pressures: $p_{L}=p_{R}=1.0 \\times 10^{5} \\, \\mathrm{Pa}$\n- Left and right velocities: $u_{L}=u_{R}=100 \\, \\mathrm{m/s}$\n- Left and right densities: $\\rho_{L}=1.0 \\, \\mathrm{kg/m^{3}}$, $\\rho_{R}=2.0 \\, \\mathrm{kg/m^{3}}$\n\nThis state represents a contact discontinuity where the common velocity is $u_{c} = 100 \\, \\mathrm{m/s}$ and the common pressure is $p_{c} = 1.0 \\times 10^{5} \\, \\mathrm{Pa}$.\n\nThe numerical mass flux is given by the formula $\\dot{m} = (a_{f}\\widehat{M})\\rho^{\\mathrm{up}}$.\nThe sufficient conditions derived in Part 1 ensure that the numerical flux calculation reproduces the exact physical flux. Specifically, Condition 3 requires that the convective velocity $u_f = a_{f}\\widehat{M}$ equals the physical velocity $u_c$.\n$$ u_{f} = a_{f}\\widehat{M} = u_{c} = 100 \\, \\mathrm{m/s} $$\nCondition 4 dictates that the upwinded density $\\rho^{\\mathrm{up}}$ is chosen based on the sign of $u_f$. Since $u_f = 100 > 0$, the flow is from left to right, and the upwind state is the left state.\n$$ \\rho^{\\mathrm{up}} = \\rho_{L} = 1.0 \\, \\mathrm{kg/m^{3}} $$\nSubstituting these into the formula for the numerical mass flux:\n$$ \\dot{m} = u_{f} \\rho^{\\mathrm{up}} = (100 \\, \\mathrm{m/s}) \\times (1.0 \\, \\mathrm{kg/m^{3}}) = 100 \\, \\mathrm{kg}/(\\mathrm{m}^{2}\\,\\mathrm{s}) $$\nAlternatively, we can directly state that the conditions enforce $\\dot{m}_{num} = \\dot{m}_{exact}$. The exact mass flux for a contact moving at $u_c > 0$ is $\\rho_{L}u_{c}$.\n$$ \\dot{m}_{exact} = \\rho_{L} u_{c} = (1.0 \\, \\mathrm{kg/m^{3}}) \\times (100 \\, \\mathrm{m/s}) = 100 \\, \\mathrm{kg}/(\\mathrm{m}^{2}\\,\\mathrm{s}) $$\nThe problem requires the answer to be rounded to four significant figures.\n$$ \\dot{m} = 100.0 \\, \\mathrm{kg}/(\\mathrm{m}^{2}\\,\\mathrm{s}) = 1.000 \\times 10^{2} \\, \\mathrm{kg}/(\\mathrm{m}^{2}\\,\\mathrm{s}) $$", "answer": "$$\n\\boxed{1.000 \\times 10^{2}}\n$$", "id": "3292971"}, {"introduction": "While schemes can be designed for high accuracy on some structures, they inevitably introduce errors for others, a primary form of which is artificial diffusion. This exercise delves into analyzing this common form of numerical error. Using modified equation analysis on a shear layer problem, you will quantify the numerical diffusion that a first-order AUSM scheme introduces into the tangential velocity field, which should ideally be purely convected [@problem_id:3292943]. This powerful technique reveals the leading-order error behavior of a scheme, providing critical insight into its performance and the motivation for developing higher-order reconstructions.", "problem": "Consider the two-dimensional compressible Euler equations for a perfect gas with constant ratio of specific heats $\\gamma$, written in conservation form along the $x$-direction for the state vector $\\mathbf{U} = \\begin{pmatrix} \\rho \\\\ \\rho u \\\\ \\rho v \\\\ \\rho E \\end{pmatrix}$, where $\\rho$ is density, $u$ is the velocity component normal to the interface ($x$-direction), $v$ is the tangential velocity component ($y$-direction), and $E$ is total energy per unit mass. A planar shear layer aligned with the $y$-axis at $x=0$ is initialized with uniform pressure $p_0$ and density $\\rho_0$ on both sides, a uniform normal velocity $u_0>0$ on both sides, and a jump only in the tangential velocity: $v_L \\neq v_R$, where subscript $L$ denotes the state for $x<0$ and $R$ denotes the state for $x>0$. The local speed of sound $a_0$ is uniform as well, given by $a_0 = \\sqrt{\\gamma p_0 / \\rho_0}$, and the common Mach number $M_0 = u_0 / a_0$ satisfies $0 < M_0 < 1$.\n\nYou discretize the $x$-direction on a uniform finite-volume grid with spacing $\\Delta x$, and use the Advection Upstream Splitting Method (AUSM) to split the Euler flux into convective and pressure parts. For the spatial reconstruction of primitive variables, you use second-order Monotonic Upstream-centered Schemes for Conservation Laws (MUSCL) with the minmod limiter. At the unique face located at the material interface (the shear layer discontinuity), assume the MUSCL limiter collapses to first order (piecewise constant) because of the jump in $v$, while all other primitive variables remain uniform.\n\nStarting only from the Euler equations and the general AUSM principles of separating convective transport and pressure projection along characteristics, derive the AUSM convective mass flux at the face and the resulting convective flux of tangential momentum. Then, perform a modified-equation analysis of the semi-discrete finite-volume update for the tangential velocity in the neighborhood of the discontinuity under the stated conditions, and estimate the leading-order effective numerical diffusion coefficient acting on $v$ due solely to the spatial discretization with AUSM convective flux and first-order reconstruction at the interface.\n\nExpress your final answer as a single row matrix containing:\n- the face tangential momentum convective flux, and\n- the effective semi-discrete numerical diffusion coefficient for the tangential velocity,\n\nboth in closed-form symbolic expressions in terms of $\\rho_0$, $u_0$, $v_L$, $v_R$, and $\\Delta x$. No numerical evaluation is required. If you need to assume a sign for $u_0$ to determine upwinding, use $u_0>0$. No rounding is necessary. If any physical units are needed for interpretation, use the International System of Units (SI) for consistency, but do not include units in the final boxed expression.", "solution": "The problem requires the derivation of the AUSM convective flux for tangential momentum and the effective numerical diffusion coefficient for the tangential velocity at a shear layer. The analysis will proceed in two main stages: first, determining the numerical flux based on the Advection Upstream Splitting Method (AUSM) principles under the specified conditions; second, performing a modified-equation analysis on the resulting semi-discrete scheme to extract the diffusion coefficient.\n\nThe governing equations are the two-dimensional compressible Euler equations. The flux vector in the $x$-direction is $\\mathbf{F} = \\begin{pmatrix} \\rho u \\\\ \\rho u^2+p \\\\ \\rho u v \\\\ u(\\rho E+p) \\end{pmatrix}$. The third component of this vector, $F_3 = \\rho u v$, represents the flux of tangential momentum ($\\rho v$).\n\nThe AUSM scheme splits the numerical flux at a cell face, denoted by the subscript $i+1/2$, into a convective part $\\mathbf{F}^c$ and a pressure part $\\mathbf{F}^p$:\n$$\n\\mathbf{F}_{i+1/2} = \\mathbf{F}^c_{i+1/2} + \\mathbf{F}^p_{i+1/2}\n$$\nThe pressure flux vector is defined as $\\mathbf{F}^p_{i+1/2} = (0, p_{i+1/2}, 0, 0)^{\\top}$. The convective flux vector is given by\n$$\n\\mathbf{F}^c_{i+1/2} = \\dot{m}_{i+1/2} \\mathbf{\\Psi}_{L/R}\n$$\nwhere $\\dot{m}_{i+1/2}$ is the mass flux across the face, and $\\mathbf{\\Psi} = (1, u, v, H)^{\\top}$ is the vector of convected quantities, with $H = E + p/\\rho$ being the total enthalpy per unit mass. The subscript $L/R$ signifies that the state vector $\\mathbf{\\Psi}$ is chosen from the left ($L$) or right ($R$) side of the face based on an upwinding criterion.\n\nThe problem states that due to the action of the MUSCL limiter at the sharp discontinuity, the reconstruction collapses to first order. This means the states at the left and right of the face $i+1/2$ (the location of the shear layer) are the cell-average values of the adjacent cells. Let cell $i$ be to the left ($x<0$) and cell $i+1$ to the right ($x>0$).\nThe left state is: $\\rho_L = \\rho_0, u_L = u_0, v_L, p_L = p_0$.\nThe right state is: $\\rho_R = \\rho_0, u_R = u_0, v_R, p_R = p_0$.\nThe speed of sound $a_0 = \\sqrt{\\gamma p_0 / \\rho_0}$ is uniform, so $a_L = a_R = a_0$. The normal Mach number is also uniform, $M_L = M_R = u_0/a_0 = M_0$.\n\nFirst, we determine the mass flux $\\dot{m}_{i+1/2}$. In AUSM, this is constructed from the face velocity $u_{i+1/2}$ and an upwinded density $\\rho_{L/R}$. The face velocity is built from split Mach numbers: $u_{i+1/2} = a_{i+1/2} (M_L^+ + M_R^-)$. For the subsonic case ($0 < M_0 < 1$), the splitting is:\n$$\nM^+ = \\frac{1}{4}(M+1)^2 \\quad \\text{and} \\quad M^- = M - M^+ = -\\frac{1}{4}(M-1)^2\n$$\nSince $M_L = M_R = M_0$, we have $M_L^+ = \\frac{1}{4}(M_0+1)^2$ and $M_R^- = -\\frac{1}{4}(M_0-1)^2$.\nThe face Mach number is:\n$$\nM_{i+1/2} = M_L^+ + M_R^- = \\frac{1}{4}(M_0+1)^2 - \\frac{1}{4}(M_0-1)^2 = \\frac{1}{4}((M_0^2+2M_0+1) - (M_0^2-2M_0+1)) = \\frac{1}{4}(4M_0) = M_0\n$$\nThe face speed of sound $a_{i+1/2}$ is typically an average; since $a_L=a_R=a_0$, we have $a_{i+1/2}=a_0$.\nThe face velocity is therefore $u_{i+1/2} = a_{i+1/2} M_{i+1/2} = a_0 M_0 = u_0$.\nThe mass flux is $\\dot{m}_{i+1/2} = u_{i+1/2} \\rho_{L/R}$. Since $u_{i+1/2} = u_0 > 0$, the density is upwinded from the left: $\\rho_{L/R} = \\rho_L = \\rho_0$.\nThus, the AUSM convective mass flux is $\\dot{m}_{i+1/2} = \\rho_0 u_0$.\n\nNow we can determine the convective flux of tangential momentum, which is the third component of $\\mathbf{F}^c_{i+1/2}$.\n$$\nF^c_{3, i+1/2} = \\dot{m}_{i+1/2} \\Psi_{3, L/R} = (\\rho_0 u_0) v_{L/R}\n$$\nThe upwinding for $\\Psi$ is based on the sign of the mass flux or face velocity. Since $\\dot{m}_{i+1/2} > 0$, we select the left state for the convected quantity $v$.\n$$\nv_{L/R} = v_L\n$$\nThe pressure-part of the flux for this component is zero, $F^p_{3, i+1/2}=0$. Therefore, the total numerical flux of tangential momentum at the face is:\n$$\nF_{3, i+1/2} = \\rho_0 u_0 v_L\n$$\nThis is the first requested result.\n\nNext, we perform a modified-equation analysis to find the effective numerical diffusion coefficient. The semi-discrete finite-volume update for the conserved quantity $\\rho v$ in a generic cell $i$ is:\n$$\n\\frac{d(\\rho v)_i}{dt} = -\\frac{1}{\\Delta x} (F_{3, i+1/2} - F_{3, i-1/2})\n$$\nUnder the given conditions, the numerical flux $F_{3, i+1/2} = F_3(U_i, U_{i+1})$ for a first-order scheme is found to be $\\rho_i u_i v_i$. This is because the parameters $\\rho$ and $u$ are constant and uniform ($\\rho_0, u_0$), and the upwinding for $v$ depends only on the left state since $u_0 > 0$. So, the numerical flux function is equivalent to the physical flux evaluated at the upwind state (left state for $u_0>0$):\n$$\nF_{3, i+1/2} \\equiv F_3(U_i) = \\rho_i u_i v_i \\quad \\text{and} \\quad F_{3, i-1/2} \\equiv F_3(U_{i-1}) = \\rho_{i-1} u_{i-1} v_{i-1}\n$$\nSubstituting these into the semi-discrete equation:\n$$\n\\frac{d(\\rho v)_i}{dt} = -\\frac{1}{\\Delta x} (F_3(U_i) - F_3(U_{i-1}))\n$$\nWe recognize this as a first-order upwind discretization of the flux derivative. To find the modified equation, we Taylor expand $F_3(U_{i-1})$ about cell $i$:\n$$\nF_3(U_{i-1}) = F_3(U_i) - \\Delta x \\frac{\\partial F_3}{\\partial x}\\bigg|_i + \\frac{(\\Delta x)^2}{2} \\frac{\\partial^2 F_3}{\\partial x^2}\\bigg|_i - O((\\Delta x)^3)\n$$\nSubstituting this into the semi-discrete form gives:\n$$\n\\frac{d(\\rho v)_i}{dt} = -\\frac{1}{\\Delta x} \\left[ \\Delta x \\frac{\\partial F_3}{\\partial x}\\bigg|_i - \\frac{(\\Delta x)^2}{2} \\frac{\\partial^2 F_3}{\\partial x^2}\\bigg|_i + O((\\Delta x)^3) \\right]\n$$\n$$\n\\frac{\\partial (\\rho v)}{\\partial t} = -\\frac{\\partial F_3}{\\partial x} + \\frac{\\Delta x}{2} \\frac{\\partial^2 F_3}{\\partial x^2} - O((\\Delta x)^2)\n$$\nThe modified partial differential equation for the conserved variable $\\rho v$ is thus:\n$$\n\\frac{\\partial (\\rho v)}{\\partial t} + \\frac{\\partial (\\rho u v)}{\\partial x} = \\frac{\\Delta x}{2} \\frac{\\partial^2 (\\rho u v)}{\\partial x^2}\n$$\nTo find the diffusion coefficient for the primitive variable $v$, we expand the terms, assuming $\\rho=\\rho_0$ and $u=u_0$ are constants. The left-hand side (LHS) becomes:\n$$\n\\text{LHS} = \\frac{\\partial (\\rho_0 v)}{\\partial t} + \\frac{\\partial (\\rho_0 u_0 v)}{\\partial x} = \\rho_0 \\frac{\\partial v}{\\partial t} + \\rho_0 u_0 \\frac{\\partial v}{\\partial x}\n$$\nThis uses the fact that the continuity equation $\\frac{\\partial \\rho}{\\partial t} + \\frac{\\partial (\\rho u)}{\\partial x}=0$ is satisfied, and in this specific case, each term is independently zero.\nThe right-hand side (RHS), the leading-order truncation error, becomes:\n$$\n\\text{RHS} = \\frac{\\Delta x}{2} \\frac{\\partial^2 (\\rho_0 u_0 v)}{\\partial x^2} = \\frac{\\rho_0 u_0 \\Delta x}{2} \\frac{\\partial^2 v}{\\partial x^2}\n$$\nEquating the LHS and RHS and dividing by the constant density $\\rho_0$ yields the modified equation for $v$:\n$$\n\\frac{\\partial v}{\\partial t} + u_0 \\frac{\\partial v}{\\partial x} = \\frac{u_0 \\Delta x}{2} \\frac{\\partial^2 v}{\\partial x^2}\n$$\nThis is the advection-diffusion equation. By comparing this to the general form $\\frac{\\partial v}{\\partial t} + u_0 \\frac{\\partial v}{\\partial x} = D \\frac{\\partial^2 v}{\\partial x^2}$, we can identify the effective numerical diffusion coefficient $D$:\n$$\nD = \\frac{u_0 \\Delta x}{2}\n$$\nThis is the second requested result.\n\nThe final answer consists of the tangential momentum convective flux and the effective numerical diffusion coefficient.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\rho_0 u_0 v_L & \\frac{u_0 \\Delta x}{2}\n\\end{pmatrix}\n}\n$$", "id": "3292943"}]}