{"hands_on_practices": [{"introduction": "Flux vector splitting techniques are founded on the principle of separating information based on its direction of travel. For the Euler equations, these directions are precisely the characteristic speeds, which correspond to the eigenvalues of the flux Jacobian matrix. This first practice is a foundational exercise that connects the mathematical machinery of linear algebra to the physics of compressible flow, forming the cornerstone of all upwind and FVS methods. [@problem_id:3366221]", "problem": "Consider the one-dimensional compressible Euler equations for an ideal gas in conservative form with conserved state vector $\\mathbf{U} = (\\rho, \\rho u, E)^{\\mathsf{T}}$ and flux vector $\\mathbf{F}(\\mathbf{U}) = \\big(\\rho u, \\rho u^{2} + p, u(E + p)\\big)^{\\mathsf{T}}$. The pressure $p$ is related to the total energy density $E$ and the density $\\rho$ via the ideal-gas equation of state $p = (\\gamma - 1)\\left(E - \\tfrac{1}{2} \\rho u^{2}\\right)$, where $\\gamma$ is the ratio of specific heats. The speed of sound $a$ is defined thermodynamically by $a^{2} = \\left(\\frac{\\partial p}{\\partial \\rho}\\right)_{s}$, the derivative of pressure with respect to density at constant entropy $s$. The framework of Computational Fluid Dynamics (CFD) often employs characteristic information of the flux Jacobian to construct upwind schemes, such as the Steger–Warming flux vector splitting method, which separates flux contributions according to the signs of wave speeds.\n\nStarting from the above fundamental laws and definitions, without invoking any pre-stated characteristic formulas, first derive the characteristic wave speeds of the one-dimensional Euler equations and the expression for the sound speed $a$ for an ideal gas in terms of $\\gamma$, $p$, and $\\rho$. Then, for the specific uniform state $(\\rho, u, p) = (1.0, 0.3, 1.0)$ with $\\gamma = 1.4$, evaluate numerically the sound speed $a$ and the three characteristic speeds $u - a$, $u$, and $u + a$. Assume nondimensional variables so that no physical units are required. Round your numerical answers to six significant figures. Report your final answer as a single row matrix in the order $[a,\\ u - a,\\ u,\\ u + a]$.", "solution": "The problem requires the derivation of the characteristic wave speeds for the one-dimensional Euler equations and the expression for the speed of sound for an ideal gas, followed by a numerical evaluation for a specific state. The procedure is as follows.\n\nFirst, we derive the characteristic speeds of the system. The one-dimensional Euler equations in conservative form are given by:\n$$ \\frac{\\partial \\mathbf{U}}{\\partial t} + \\frac{\\partial \\mathbf{F}(\\mathbf{U})}{\\partial x} = 0 $$\nwhere $\\mathbf{U} = (\\rho, \\rho u, E)^{\\mathsf{T}}$ is the vector of conserved variables and $\\mathbf{F} = (\\rho u, \\rho u^{2} + p, u(E + p))^{\\mathsf{T}}$ is the flux vector. The variables are density $\\rho$, velocity $u$, total energy per unit volume $E$, and pressure $p$. The system is closed by the ideal gas equation of state, $p = (\\gamma - 1)(E - \\frac{1}{2}\\rho u^{2})$, where $\\gamma$ is the ratio of specific heats.\n\nThe characteristic wave speeds are the eigenvalues of the flux Jacobian matrix $\\mathbf{A} = \\frac{\\partial \\mathbf{F}}{\\partial \\mathbf{U}}$. A direct calculation of this Jacobian is algebraically intensive. A more systematic approach involves transforming the equations into a quasi-linear form using a vector of primitive variables, such as $\\mathbf{W} = (\\rho, u, p)^{\\mathsf{T}}$.\n\nUsing the chain rule, the Euler equations can be written as:\n$$ \\frac{\\partial \\mathbf{U}}{\\partial \\mathbf{W}} \\frac{\\partial \\mathbf{W}}{\\partial t} + \\frac{\\partial \\mathbf{F}}{\\partial \\mathbf{W}} \\frac{\\partial \\mathbf{W}}{\\partial x} = 0 $$\nLet $\\mathbf{M} = \\frac{\\partial \\mathbf{U}}{\\partial \\mathbf{W}}$ and $\\mathbf{B} = \\frac{\\partial \\mathbf{F}}{\\partial \\mathbf{W}}$. The equation becomes $\\mathbf{M} \\frac{\\partial \\mathbf{W}}{\\partial t} + \\mathbf{B} \\frac{\\partial \\mathbf{W}}{\\partial x} = 0$. Multiplying by $\\mathbf{M}^{-1}$ gives the quasi-linear form $\\frac{\\partial \\mathbf{W}}{\\partial t} + \\mathbf{M}^{-1}\\mathbf{B} \\frac{\\partial \\mathbf{W}}{\\partial x} = 0$. The characteristic speeds $\\lambda$ are the eigenvalues of the matrix $\\mathbf{A} = \\mathbf{M}^{-1}\\mathbf{B}$, which are the roots of the generalized eigenvalue problem $\\det(\\mathbf{B} - \\lambda\\mathbf{M}) = 0$.\n\nLet's compute the matrices $\\mathbf{M}$ and $\\mathbf{B}$. First, we express the conserved variables $\\mathbf{U}$ in terms of the primitive variables $\\mathbf{W}$:\n$U_1 = \\rho$\n$U_2 = \\rho u$\n$U_3 = E = \\frac{p}{\\gamma-1} + \\frac{1}{2}\\rho u^2$\nThe matrix $\\mathbf{M} = \\frac{\\partial \\mathbf{U}}{\\partial \\mathbf{W}}$ is:\n$$ \\mathbf{M} = \\frac{\\partial(U_1, U_2, U_3)}{\\partial(\\rho, u, p)} = \\begin{pmatrix} 1  0  0 \\\\ u  \\rho  0 \\\\ \\frac{1}{2}u^2  \\rho u  \\frac{1}{\\gamma-1} \\end{pmatrix} $$\nNext, we express the flux vector $\\mathbf{F}$ in terms of $\\mathbf{W}$:\n$F_1 = \\rho u$\n$F_2 = \\rho u^2 + p$\n$F_3 = u(E+p) = u\\left(\\frac{p}{\\gamma-1} + \\frac{1}{2}\\rho u^2 + p\\right) = u\\left(\\frac{\\gamma p}{\\gamma-1} + \\frac{1}{2}\\rho u^2\\right) = \\frac{\\gamma u p}{\\gamma-1} + \\frac{1}{2}\\rho u^3$\nThe matrix $\\mathbf{B} = \\frac{\\partial \\mathbf{F}}{\\partial \\mathbf{W}}$ is:\n$$ \\mathbf{B} = \\frac{\\partial(F_1, F_2, F_3)}{\\partial(\\rho, u, p)} = \\begin{pmatrix} u  \\rho  0 \\\\ u^2  2\\rho u  1 \\\\ \\frac{1}{2}u^3  \\frac{\\gamma p}{\\gamma-1} + \\frac{3}{2}\\rho u^2  \\frac{\\gamma u}{\\gamma-1} \\end{pmatrix} $$\nNow we solve the characteristic equation $\\det(\\mathbf{B} - \\lambda\\mathbf{M}) = 0$:\n$$ \\det\\begin{pmatrix} u-\\lambda  \\rho  0 \\\\ u^2 - \\lambda u  2\\rho u - \\lambda \\rho  1 \\\\ \\frac{1}{2}u^3 - \\frac{\\lambda}{2}u^2  \\frac{\\gamma p}{\\gamma-1} + \\frac{3}{2}\\rho u^2 - \\lambda \\rho u  \\frac{\\gamma u}{\\gamma-1} - \\frac{\\lambda}{\\gamma-1} \\end{pmatrix} = 0 $$\nFactoring terms:\n$$ \\det\\begin{pmatrix} u-\\lambda  \\rho  0 \\\\ u(u-\\lambda)  \\rho(2u - \\lambda)  1 \\\\ \\frac{u^2}{2}(u-\\lambda)  \\frac{\\gamma p}{\\gamma-1} + \\frac{3}{2}\\rho u^2 - \\lambda \\rho u  \\frac{\\gamma u - \\lambda}{\\gamma-1} \\end{pmatrix} = 0 $$\nThe factor $(u-\\lambda)$ in the first column indicates that we can factor it out of the determinant. This implies that one eigenvalue is $\\lambda_1 = u$.\nFor $\\lambda \\neq u$, we can divide the first column by $(u-\\lambda)$ (or perform column operations to see this more formally) and solve the remaining determinant. A more direct way is cofactor expansion along the first row:\n$$ (u-\\lambda)\\left[\\rho(2u-\\lambda)\\frac{\\gamma u - \\lambda}{\\gamma-1} - \\left(\\frac{\\gamma p}{\\gamma-1} + \\frac{3}{2}\\rho u^2 - \\lambda\\rho u\\right)\\right] - \\rho\\left[u(u-\\lambda)\\frac{\\gamma u - \\lambda}{\\gamma-1} - \\frac{u^2}{2}(u-\\lambda)\\right] = 0 $$\nFactoring out the common term $(u-\\lambda)$:\n$$ (u-\\lambda)\\left\\{\\left[\\rho(2u-\\lambda)\\frac{\\gamma u - \\lambda}{\\gamma-1} - \\frac{\\gamma p}{\\gamma-1} - \\frac{3}{2}\\rho u^2 + \\lambda\\rho u\\right] - \\rho\\left[u\\frac{\\gamma u - \\lambda}{\\gamma-1} - \\frac{u^2}{2}\\right]\\right\\} = 0 $$\nFor $\\lambda \\neq u$, the expression in the curly braces must be zero. Expanding and simplifying this expression leads to the quadratic equation for the remaining eigenvalues:\n$$ \\rho\\lambda^2 - 2\\rho u \\lambda + (\\rho u^2 - \\gamma p) = 0 $$\nDividing by $\\rho$ (which is non-zero):\n$$ \\lambda^2 - 2u\\lambda + u^2 - \\frac{\\gamma p}{\\rho} = 0 $$\n$$ (\\lambda - u)^2 = \\frac{\\gamma p}{\\rho} $$\n$$ \\lambda - u = \\pm\\sqrt{\\frac{\\gamma p}{\\rho}} $$\nThis gives the other two eigenvalues: $\\lambda_{2,3} = u \\pm \\sqrt{\\frac{\\gamma p}{\\rho}}$.\n\nSecond, we derive the expression for the speed of sound $a$. The problem defines it as $a^2 = \\left(\\frac{\\partial p}{\\partial \\rho}\\right)_s$, where the derivative is taken at constant entropy $s$. For a calorically perfect ideal gas, an isentropic process is governed by the relation $p = K\\rho^\\gamma$, where $K$ is constant. This relation arises from the first law of thermodynamics, $de = Tds - p d(1/\\rho)$, where $e$ is the specific internal energy. For an ideal gas, $e=c_v T$ and $p=\\rho R T$. For an isentropic process ($ds=0$), this leads to $p/\\rho^\\gamma = \\text{const}$.\nTaking the partial derivative of $p$ with respect to $\\rho$:\n$$ a^2 = \\left(\\frac{\\partial p}{\\partial \\rho}\\right)_s = \\frac{\\partial}{\\partial \\rho}(K\\rho^\\gamma) = K\\gamma\\rho^{\\gamma-1} $$\nSubstituting $K = p/\\rho^\\gamma$:\n$$ a^2 = \\left(\\frac{p}{\\rho^\\gamma}\\right)\\gamma\\rho^{\\gamma-1} = \\frac{\\gamma p}{\\rho} $$\nThus, the speed of sound is $a = \\sqrt{\\frac{\\gamma p}{\\rho}}$.\nThe three characteristic wave speeds of the one-dimensional Euler equations are therefore $\\lambda_1 = u$, $\\lambda_2 = u - a$, and $\\lambda_3 = u + a$.\n\nThird, we evaluate these speeds for the given uniform state: $\\rho = 1.0$, $u = 0.3$, $p = 1.0$, and $\\gamma = 1.4$. All variables are non-dimensional.\n\nThe speed of sound $a$ is:\n$$ a = \\sqrt{\\frac{\\gamma p}{\\rho}} = \\sqrt{\\frac{(1.4)(1.0)}{1.0}} = \\sqrt{1.4} \\approx 1.183215956... $$\nRounding to six significant figures, we get $a \\approx 1.18322$.\n\nThe three characteristic speeds are:\n1.  $u - a = 0.3 - \\sqrt{1.4} \\approx 0.3 - 1.183215956... = -0.883215956...$\n    Rounding to six significant figures, $u - a \\approx -0.883216$.\n2.  $u = 0.3$. Expressed with six significant figures, this is $0.300000$.\n3.  $u + a = 0.3 + \\sqrt{1.4} \\approx 0.3 + 1.183215956... = 1.483215956...$\n    Rounding to six significant figures, $u + a \\approx 1.48322$.\n\nThe final results are ordered as $[a,\\ u-a,\\ u,\\ u+a]$.", "answer": "$$ \\boxed{\\begin{pmatrix} 1.18322  -0.883216  0.300000  1.48322 \\end{pmatrix}} $$", "id": "3366221"}, {"introduction": "Once the characteristic structure is known, a flux splitting scheme like Steger-Warming can be constructed, but it is just one of many ways to define a numerical flux. This exercise provides a direct, quantitative comparison between this classic upwind flux and a central-dissipative scheme like the Rusanov flux. Calculating the fluxes for a supersonic test case reveals how each method handles information advection and introduces numerical dissipation, a key concept in the stability and accuracy of shock-capturing schemes. [@problem_id:3320859]", "problem": "Consider the one-dimensional compressible Euler equations for an ideal gas with ratio of specific heats $\\gamma = 1.4$. Let an interface separate two constant states with primitive variables given by the left state $(\\rho_{L}, u_{L}, p_{L}) = (\\,1.2\\,\\text{kg}\\,\\text{m}^{-3},\\, 600\\,\\text{m}\\,\\text{s}^{-1},\\, 2.0 \\times 10^{5}\\,\\text{Pa}\\,)$ and the right state $(\\rho_{R}, u_{R}, p_{R}) = (\\,0.8\\,\\text{kg}\\,\\text{m}^{-3},\\, 700\\,\\text{m}\\,\\text{s}^{-1},\\, 1.0 \\times 10^{5}\\,\\text{Pa}\\,)$. Using first principles for flux vector splitting techniques in computational fluid dynamics, compute at this interface:\n- the mass-flux component produced by the Rusanov (local Lax–Friedrichs) numerical flux,\n- the mass-flux component produced by the Steger–Warming flux-vector splitting,\nand then form the scalar difference $\\Delta = f_{\\rho}^{\\text{Rusanov}} - f_{\\rho}^{\\text{SW}}$.\n\nYou must start from the Euler equations and their eigenstructure and use the ideal-gas relation for the speed of sound to justify each numerical flux construction before evaluating $\\Delta$ for the given states. Express the final $\\Delta$ in $\\text{kg}\\,\\text{m}^{-2}\\,\\text{s}^{-1}$ and round your final answer to five significant figures.", "solution": "The problem requires the computation and comparison of the mass flux components from two distinct numerical flux schemes, Rusanov and Steger-Warming, at an interface between two specified fluid states. The governing equations are the one-dimensional compressible Euler equations, which can be written in conservative form as:\n$$\n\\frac{\\partial \\mathbf{U}}{\\partial t} + \\frac{\\partial \\mathbf{F}}{\\partial x} = 0\n$$\nwhere $\\mathbf{U}$ is the vector of conserved variables and $\\mathbf{F}$ is the flux vector. For an ideal gas, these are given by:\n$$\n\\mathbf{U} = \\begin{pmatrix} \\rho \\\\ \\rho u \\\\ E \\end{pmatrix}, \\quad \\mathbf{F}(\\mathbf{U}) = \\begin{pmatrix} \\rho u \\\\ \\rho u^2 + p \\\\ (E+p)u \\end{pmatrix}\n$$\nHere, $\\rho$ is the density, $u$ is the velocity, $p$ is the pressure, and $E$ is the total energy per unit volume. The total energy is related to the other variables by the equation of state for an ideal gas:\n$$\nE = \\frac{p}{\\gamma - 1} + \\frac{1}{2}\\rho u^2\n$$\nwhere $\\gamma$ is the ratio of specific heats, given as $\\gamma = 1.4$. The speed of sound, $c$, is given by:\n$$\nc = \\sqrt{\\frac{\\gamma p}{\\rho}}\n$$\nThe problem specifies two states, a left state (L) and a right state (R), at an interface.\nLeft state: $(\\rho_L, u_L, p_L) = (1.2\\,\\text{kg}\\,\\text{m}^{-3}, 600\\,\\text{m}\\,\\text{s}^{-1}, 2.0 \\times 10^{5}\\,\\text{Pa})$.\nRight state: $(\\rho_R, u_R, p_R) = (0.8\\,\\text{kg}\\,\\text{m}^{-3}, 700\\,\\text{m}\\,\\text{s}^{-1}, 1.0 \\times 10^{5}\\,\\text{Pa})$.\n\nFirst, we compute the derived quantities for each state.\n\nFor the left state (L):\nThe speed of sound is:\n$$\nc_L = \\sqrt{\\frac{\\gamma p_L}{\\rho_L}} = \\sqrt{\\frac{1.4 \\times (2.0 \\times 10^5)}{1.2}} = \\sqrt{\\frac{2.8 \\times 10^5}{1.2}} \\approx 483.0459\\,\\text{m}\\,\\text{s}^{-1}\n$$\nThe total energy is:\n$$\nE_L = \\frac{p_L}{\\gamma-1} + \\frac{1}{2}\\rho_L u_L^2 = \\frac{2.0 \\times 10^5}{1.4-1} + \\frac{1}{2}(1.2)(600)^2 = 5.0 \\times 10^5 + 2.16 \\times 10^5 = 7.16 \\times 10^5\\,\\text{J}\\,\\text{m}^{-3}\n$$\nThe state vector $\\mathbf{U}_L$ and flux vector $\\mathbf{F}_L$ are:\n$$\n\\mathbf{U}_L = \\begin{pmatrix} \\rho_L \\\\ \\rho_L u_L \\\\ E_L \\end{pmatrix} = \\begin{pmatrix} 1.2 \\\\ 1.2 \\times 600 \\\\ 7.16 \\times 10^5 \\end{pmatrix} = \\begin{pmatrix} 1.2 \\\\ 720 \\\\ 7.16 \\times 10^5 \\end{pmatrix}\n$$\n$$\n\\mathbf{F}_L = \\begin{pmatrix} \\rho_L u_L \\\\ \\rho_L u_L^2 + p_L \\\\ (E_L+p_L)u_L \\end{pmatrix} = \\begin{pmatrix} 720 \\\\ 1.2 \\times (600)^2 + 2.0 \\times 10^5 \\\\ (7.16 \\times 10^5 + 2.0 \\times 10^5) \\times 600 \\end{pmatrix} = \\begin{pmatrix} 720 \\\\ 6.32 \\times 10^5 \\\\ 5.496 \\times 10^8 \\end{pmatrix}\n$$\n\nFor the right state (R):\nThe speed of sound is:\n$$\nc_R = \\sqrt{\\frac{\\gamma p_R}{\\rho_R}} = \\sqrt{\\frac{1.4 \\times (1.0 \\times 10^5)}{0.8}} = \\sqrt{1.75 \\times 10^5} \\approx 418.3300\\,\\text{m}\\,\\text{s}^{-1}\n$$\nThe total energy is:\n$$\nE_R = \\frac{p_R}{\\gamma-1} + \\frac{1}{2}\\rho_R u_R^2 = \\frac{1.0 \\times 10^5}{1.4-1} + \\frac{1}{2}(0.8)(700)^2 = 2.5 \\times 10^5 + 1.96 \\times 10^5 = 4.46 \\times 10^5\\,\\text{J}\\,\\text{m}^{-3}\n$$\nThe state vector $\\mathbf{U}_R$ and flux vector $\\mathbf{F}_R$ are:\n$$\n\\mathbf{U}_R = \\begin{pmatrix} \\rho_R \\\\ \\rho_R u_R \\\\ E_R \\end{pmatrix} = \\begin{pmatrix} 0.8 \\\\ 0.8 \\times 700 \\\\ 4.46 \\times 10^5 \\end{pmatrix} = \\begin{pmatrix} 0.8 \\\\ 560 \\\\ 4.46 \\times 10^5 \\end{pmatrix}\n$$\n$$\n\\mathbf{F}_R = \\begin{pmatrix} \\rho_R u_R \\\\ \\rho_R u_R^2 + p_R \\\\ (E_R+p_R)u_R \\end{pmatrix} = \\begin{pmatrix} 560 \\\\ 0.8 \\times (700)^2 + 1.0 \\times 10^5 \\\\ (4.46 \\times 10^5 + 1.0 \\times 10^5) \\times 700 \\end{pmatrix} = \\begin{pmatrix} 560 \\\\ 4.92 \\times 10^5 \\\\ 3.822 \\times 10^8 \\end{pmatrix}\n$$\n\nNow we can compute the numerical fluxes.\n\n**Steger-Warming Flux-Vector Splitting**\nThe Steger-Warming scheme splits the flux vector $\\mathbf{F}$ into two parts, $\\mathbf{F}^+$ and $\\mathbf{F}^-$, based on the signs of the eigenvalues of the flux Jacobian matrix $A = \\partial \\mathbf{F} / \\partial \\mathbf{U}$. The eigenvalues of $A$ are $\\lambda_1 = u-c$, $\\lambda_2 = u$, and $\\lambda_3 = u+c$. The numerical flux at the interface is given by:\n$$\n\\mathbf{F}^{\\text{SW}} = \\mathbf{F}^+(\\mathbf{U}_L) + \\mathbf{F}^-(\\mathbf{U}_R)\n$$\nThe splitting is defined such that if all eigenvalues are positive, $\\mathbf{F}^+ = \\mathbf{F}$ and $\\mathbf{F}^- = \\mathbf{0}$. If all eigenvalues are negative, $\\mathbf{F}^+ = \\mathbf{0}$ and $\\mathbf{F}^- = \\mathbf{F}$.\nFor the left state, $u_L = 600$ and $c_L \\approx 483.05$. Since $u_L  c_L  0$, the flow is supersonic. All eigenvalues for state L are positive:\n$\\lambda_{1,L} = u_L - c_L  0$\n$\\lambda_{2,L} = u_L  0$\n$\\lambda_{3,L} = u_L + c_L  0$\nTherefore, for state L, the split fluxes are $\\mathbf{F}^+(\\mathbf{U}_L) = \\mathbf{F}_L$ and $\\mathbf{F}^-(\\mathbf{U}_L) = \\mathbf{0}$.\n\nFor the right state, $u_R = 700$ and $c_R \\approx 418.33$. Since $u_R  c_R  0$, the flow is also supersonic. All eigenvalues for state R are positive:\n$\\lambda_{1,R} = u_R - c_R  0$\n$\\lambda_{2,R} = u_R  0$\n$\\lambda_{3,R} = u_R + c_R  0$\nTherefore, for state R, the split fluxes are $\\mathbf{F}^+(\\mathbf{U}_R) = \\mathbf{F}_R$ and $\\mathbf{F}^-(\\mathbf{U}_R) = \\mathbf{0}$.\n\nSubstituting these into the formula for the interface flux:\n$$\n\\mathbf{F}^{\\text{SW}} = \\mathbf{F}^+(\\mathbf{U}_L) + \\mathbf{F}^-(\\mathbf{U}_R) = \\mathbf{F}_L + \\mathbf{0} = \\mathbf{F}_L\n$$\nThe mass-flux component, $f_{\\rho}^{\\text{SW}}$, is the first component of $\\mathbf{F}^{\\text{SW}}$, which is the first component of $\\mathbf{F}_L$:\n$$\nf_{\\rho}^{\\text{SW}} = (\\rho u)_L = 1.2 \\times 600 = 720\\,\\text{kg}\\,\\text{m}^{-2}\\,\\text{s}^{-1}\n$$\n\n**Rusanov (Local Lax-Friedrichs) Flux**\nThe Rusanov flux is defined as:\n$$\n\\mathbf{F}^{\\text{Rusanov}} = \\frac{1}{2}(\\mathbf{F}_L + \\mathbf{F}_R) - \\frac{S_{\\max}}{2}(\\mathbf{U}_R - \\mathbf{U}_L)\n$$\nwhere $S_{\\max}$ is the maximum local signal speed at the interface, given by:\n$$\nS_{\\max} = \\max(|u_L| + c_L, |u_R| + c_R)\n$$\nUsing the previously computed values:\n$|u_L| + c_L = 600 + 483.0459 = 1083.0459\\,\\text{m}\\,\\text{s}^{-1}$\n$|u_R| + c_R = 700 + 418.3300 = 1118.3300\\,\\text{m}\\,\\text{s}^{-1}$\nSo, $S_{\\max} = 1118.3300\\,\\text{m}\\,\\text{s}^{-1}$.\n\nWe need the mass-flux component, $f_{\\rho}^{\\text{Rusanov}}$, which is the first component of the vector $\\mathbf{F}^{\\text{Rusanov}}$:\n$$\nf_{\\rho}^{\\text{Rusanov}} = \\frac{1}{2}((\\rho u)_L + (\\rho u)_R) - \\frac{S_{\\max}}{2}(\\rho_R - \\rho_L)\n$$\nSubstituting the numerical values:\n$$\nf_{\\rho}^{\\text{Rusanov}} = \\frac{1}{2}(720 + 560) - \\frac{1118.3300}{2}(0.8 - 1.2)\n$$\n$$\nf_{\\rho}^{\\text{Rusanov}} = \\frac{1}{2}(1280) - (559.1650)( -0.4)\n$$\n$$\nf_{\\rho}^{\\text{Rusanov}} = 640 + 223.6660 = 863.6660\\,\\text{kg}\\,\\text{m}^{-2}\\,\\text{s}^{-1}\n$$\n\n**Difference $\\Delta$**\nFinally, we compute the difference $\\Delta = f_{\\rho}^{\\text{Rusanov}} - f_{\\rho}^{\\text{SW}}$:\n$$\n\\Delta = 863.6660 - 720 = 143.6660\\,\\text{kg}\\,\\text{m}^{-2}\\,\\text{s}^{-1}\n$$\nRounding the result to five significant figures, as requested:\n$$\n\\Delta \\approx 143.67\\,\\text{kg}\\,\\text{m}^{-2}\\,\\text{s}^{-1}\n$$", "answer": "$$\n\\boxed{143.67}\n$$", "id": "3320859"}, {"introduction": "The elegance of the Steger-Warming splitting can break down in critical flow regimes, such as transonic rarefactions where an eigenvalue passes through zero, potentially generating non-physical expansion shocks. This advanced practice addresses this crucial flaw by introducing the concept of an \"entropy fix,\" a vital technique for ensuring the physical robustness of numerical schemes. By analyzing how targeted numerical dissipation is added at the sonic point, you will learn how to remedy deficiencies in a numerical method to guarantee physically meaningful solutions. [@problem_id:3320873]", "problem": "Consider the one-dimensional Euler equations for a calorically perfect gas with constant specific heat ratio $\\gamma$ governing a smooth, isentropic transonic rarefaction. Let the conservative variable vector be $U = (\\rho, \\rho u, E)^{\\mathsf{T}}$, the flux be $f(U) = (\\rho u, \\rho u^{2} + p, u(E+p))^{\\mathsf{T}}$, and the flux Jacobian be $A(U) = \\frac{\\partial f}{\\partial U}$. The eigenstructure of $A(U)$ at a state with density $\\rho$, velocity $u$, pressure $p$, speed of sound $a = \\sqrt{\\gamma p/\\rho}$, and total enthalpy $H = (E+p)/\\rho$ consists of eigenvalues $\\lambda_{1} = u - a$, $\\lambda_{2} = u$, $\\lambda_{3} = u + a$, with corresponding right eigenvectors $r_{1} = (1, u - a, H - u a)^{\\mathsf{T}}$, $r_{2} = (1, u, \\tfrac{1}{2}u^{2})^{\\mathsf{T}}$, and $r_{3} = (1, u + a, H + u a)^{\\mathsf{T}}$. In the Steger–Warming flux vector splitting, one writes $A(U) = R \\Lambda R^{-1}$ and defines the split operators $A^{\\pm}(U) = R \\Lambda^{\\pm} R^{-1}$ with $\\Lambda^{\\pm} = \\mathrm{diag}(\\lambda_{1}^{\\pm}, \\lambda_{2}^{\\pm}, \\lambda_{3}^{\\pm})$, where $\\lambda^{\\pm} = \\tfrac{1}{2}(\\lambda \\pm |\\lambda|)$.\n\nIn a centered rarefaction that crosses the sonic condition, consider the interfacial (Roe-averaged) state at which the local Mach number $M = u/a$ satisfies $M = 1$, so that $\\lambda_{1} = u - a = 0$, $\\lambda_{2} = u = a  0$, and $\\lambda_{3} = u + a = 2a  0$. To enforce the correct entropy production in the transonic region, apply an entropy fix that smooths the sign function near zero in terms of a dimensionless Mach-based threshold. Specifically, for each characteristic, introduce the dimensionless eigenvalue $\\mu = \\lambda/a$ and replace $|\\mu|$ by\n$$\n\\phi_{M}(\\mu) = \\begin{cases}\n\\displaystyle \\frac{\\mu^{2} + \\delta_{M}^{2}}{2 \\delta_{M}},  |\\mu|  \\delta_{M}, \\\\\n|\\mu|,  |\\mu| \\ge \\delta_{M},\n\\end{cases}\n$$\nwhere $\\delta_{M}  0$ is a prescribed (dimensionless) entropy-fix parameter. The modified split eigenvalues are then defined by $\\mu^{\\pm} = \\tfrac{1}{2}(\\mu \\pm \\phi_{M}(\\mu))$, and returned to dimensional form via $\\lambda^{\\pm} = a\\,\\mu^{\\pm}$.\n\nUsing this entropy fix, compute the modified split flux operators $A^{+}$ and $A^{-}$ at the sonic interfacial state and explicitly identify how the previously vanishing acoustic contribution associated with $\\lambda_{1}$ is altered. Next, quantify the change in the dimensionless numerical dissipation coefficient per unit characteristic amplitude for the left-going acoustic field, defined as $d_{1} = \\tfrac{1}{2}|\\mu_{1}|$ without the entropy fix and $d_{1}^{\\mathrm{EF}} = \\tfrac{1}{2}\\phi_{M}(\\mu_{1})$ with the entropy fix, evaluated at the sonic interfacial state where $\\mu_{1} = (\\lambda_{1}/a) = 0$. Express your final answer as a single closed-form analytic expression in terms of $\\delta_{M}$, with no units required.", "solution": "We begin from the one-dimensional Euler equations for a calorically perfect gas, whose flux Jacobian $A(U) = \\frac{\\partial f}{\\partial U}$ possesses the well-known eigenstructure determined by the flow speed $u$, the speed of sound $a = \\sqrt{\\gamma p/\\rho}$, and the total enthalpy $H = (E+p)/\\rho$. The eigenvalues are $\\lambda_{1} = u - a$, $\\lambda_{2} = u$, and $\\lambda_{3} = u + a$. The corresponding right eigenvectors under Roe linearization are\n$$\nr_{1} = \\begin{pmatrix} 1 \\\\ u - a \\\\ H - u a \\end{pmatrix}^{\\mathsf{T}}, \\quad\nr_{2} = \\begin{pmatrix} 1 \\\\ u \\\\ \\tfrac{1}{2}u^{2} \\end{pmatrix}^{\\mathsf{T}}, \\quad\nr_{3} = \\begin{pmatrix} 1 \\\\ u + a \\\\ H + u a \\end{pmatrix}^{\\mathsf{T}},\n$$\nand the flux Jacobian admits the decomposition $A = R \\Lambda R^{-1}$, where $R = [r_{1}\\; r_{2}\\; r_{3}]$ and $\\Lambda = \\mathrm{diag}(\\lambda_{1}, \\lambda_{2}, \\lambda_{3})$.\n\nIn the Steger–Warming flux vector splitting, one defines the split operators\n$$\nA^{\\pm} = R \\Lambda^{\\pm} R^{-1}, \\quad \\Lambda^{\\pm} = \\mathrm{diag}(\\lambda_{1}^{\\pm}, \\lambda_{2}^{\\pm}, \\lambda_{3}^{\\pm}),\n$$\nwith\n$$\n\\lambda^{\\pm} = \\frac{1}{2}\\left(\\lambda \\pm |\\lambda|\\right).\n$$\nAt the interfacial state inside a centered isentropic rarefaction where the Mach number is $M = u/a = 1$, the eigenvalues are\n$$\n\\lambda_{1} = u - a = 0, \\quad \\lambda_{2} = u = a  0, \\quad \\lambda_{3} = u + a = 2a  0.\n$$\nUnder the unmodified splitting, we have\n$$\n\\lambda_{1}^{+} = \\frac{1}{2}(0 + |0|) = 0, \\quad \\lambda_{1}^{-} = \\frac{1}{2}(0 - |0|) = 0,\n$$\n$$\n\\lambda_{2}^{+} = \\frac{1}{2}(a + a) = a, \\quad \\lambda_{2}^{-} = \\frac{1}{2}(a - a) = 0,\n$$\n$$\n\\lambda_{3}^{+} = \\frac{1}{2}(2a + 2a) = 2a, \\quad \\lambda_{3}^{-} = \\frac{1}{2}(2a - 2a) = 0.\n$$\nThus, without entropy fix, the left-going acoustic field contributes nothing to either $A^{+}$ or $A^{-}$ at the sonic point; in particular, $A^{-}$ vanishes entirely and $A^{+} = R \\,\\mathrm{diag}(0, a, 2a)\\, R^{-1}$.\n\nThis zero contribution at the sonic point is associated with potential non-entropy-satisfying behavior in transonic expansions. To remove this deficiency, we introduce a Mach-based entropy fix that smooths the absolute value near zero. Define the dimensionless characteristic eigenvalues $\\mu_{k} = \\lambda_{k}/a$ and replace $|\\mu|$ by\n$$\n\\phi_{M}(\\mu) = \\begin{cases}\n\\displaystyle \\frac{\\mu^{2} + \\delta_{M}^{2}}{2 \\delta_{M}},  |\\mu|  \\delta_{M}, \\\\\n|\\mu|,  |\\mu| \\ge \\delta_{M},\n\\end{cases}\n$$\nwhere $\\delta_{M}  0$ is a prescribed dimensionless threshold. The modified split eigenvalues are formed in dimensionless variables as\n$$\n\\mu^{\\pm} = \\frac{1}{2}\\left(\\mu \\pm \\phi_{M}(\\mu)\\right),\n$$\nand converted back to dimensional form via\n$$\n\\lambda^{\\pm} = a\\,\\mu^{\\pm}.\n$$\nAt the sonic point for the left-going acoustic field, $\\mu_{1} = \\lambda_{1}/a = 0$. Because $|\\mu_{1}| = 0  \\delta_{M}$, we invoke the smoothed branch, yielding\n$$\n\\phi_{M}(\\mu_{1}) = \\phi_{M}(0) = \\frac{0^{2} + \\delta_{M}^{2}}{2 \\delta_{M}} = \\frac{\\delta_{M}}{2}.\n$$\nTherefore, the modified split eigenvalues for the first field are\n$$\n\\mu_{1}^{+} = \\frac{1}{2}\\left(0 + \\frac{\\delta_{M}}{2}\\right) = \\frac{\\delta_{M}}{4}, \\quad\n\\mu_{1}^{-} = \\frac{1}{2}\\left(0 - \\frac{\\delta_{M}}{2}\\right) = -\\frac{\\delta_{M}}{4},\n$$\nand in dimensional form,\n$$\n\\lambda_{1}^{+} = a\\,\\frac{\\delta_{M}}{4}, \\quad \\lambda_{1}^{-} = -a\\,\\frac{\\delta_{M}}{4}.\n$$\nThe other two eigenvalues remain strictly positive at $M=1$, so their splitting is unaffected: $\\lambda_{2}^{+} = a$, $\\lambda_{2}^{-} = 0$, $\\lambda_{3}^{+} = 2a$, $\\lambda_{3}^{-} = 0$. Consequently, the entropy-fixed split operators at the sonic state are\n$$\nA^{+}_{\\mathrm{EF}} = R \\,\\mathrm{diag}\\!\\left(a\\,\\frac{\\delta_{M}}{4},\\; a,\\; 2a\\right)\\, R^{-1}, \\quad\nA^{-}_{\\mathrm{EF}} = R \\,\\mathrm{diag}\\!\\left(-a\\,\\frac{\\delta_{M}}{4},\\; 0,\\; 0\\right)\\, R^{-1}.\n$$\nRelative to the unmodified scheme, the entropy fix introduces a nonzero contribution from the first acoustic field into both $A^{+}$ and $A^{-}$, symmetrically about zero, with magnitude set by $a\\,\\delta_{M}/4$.\n\nTo quantify the change in numerical dissipation, we define a dimensionless measure per unit characteristic amplitude for the $k$-th field as\n$$\nd_{k} = \\frac{1}{2}|\\mu_{k}|\n$$\nfor the unmodified scheme, and\n$$\nd_{k}^{\\mathrm{EF}} = \\frac{1}{2}\\phi_{M}(\\mu_{k})\n$$\nfor the entropy-fixed scheme. At the sonic interfacial state for the left-going acoustic field, $\\mu_{1} = 0$, so\n$$\nd_{1} = \\frac{1}{2}|0| = 0, \\quad\nd_{1}^{\\mathrm{EF}} = \\frac{1}{2}\\phi_{M}(0) = \\frac{1}{2}\\cdot \\frac{\\delta_{M}}{2} = \\frac{\\delta_{M}}{4}.\n$$\nThe change in the dimensionless numerical dissipation coefficient per unit characteristic amplitude for the left-going acoustic field is therefore\n$$\n\\Delta d \\equiv d_{1}^{\\mathrm{EF}} - d_{1} = \\frac{\\delta_{M}}{4} - 0 = \\frac{\\delta_{M}}{4}.\n$$\nThis closed-form expression in terms of $\\delta_{M}$ captures the additional entropy-consistent smoothing introduced by the fix precisely at the sonic point in a transonic rarefaction.", "answer": "$$\\boxed{\\frac{\\delta_{M}}{4}}$$", "id": "3320873"}]}