{"hands_on_practices": [{"introduction": "To effectively apply low-Mach preconditioning, one must first grasp the fundamental scaling issue it aims to solve. This exercise guides you through a first-principles derivation to show why the standard total energy formulation becomes ill-conditioned as the Mach number $M$ approaches zero, and how to define a consistent scaling that keeps the energy transport well-behaved [@problem_id:3341795]. By contrasting a proper scaling with a naive one, you will solidify your understanding of the physical and numerical challenges at the heart of all-speed flow simulation.", "problem": "You are to develop a principled nondimensionalization and scaling for the compressible energy variables that is consistent with low-Mach preconditioning, and then validate its consequences on a simple non-isentropic heated channel flow model. The context is Computational Fluid Dynamics (CFD) with low-Mach preconditioning for compressible equations. Your derivation and program must be self-contained and start from fundamental laws and core definitions without assuming any specialized preconditioning formula. The goal is to show what the scaling is, why it is correct, and how it is derived so the energy transport remains $\\mathcal{O}(1)$ as the Mach number ($M$) tends to zero.\n\nStart from the conservative compressible Navier–Stokes equations for a perfect gas and the Ideal Gas Law. Use the following base definitions and facts:\n- The Ideal Gas Law $p=\\rho R T$, where $p$ is pressure, $\\rho$ is density, $R$ is the specific gas constant, and $T$ is temperature.\n- The specific heats satisfy $c_p-c_v=R$, with $c_p=\\dfrac{\\gamma R}{\\gamma-1}$ and $c_v=\\dfrac{R}{\\gamma-1}$, where $\\gamma$ is the ratio of specific heats.\n- The speed of sound is $a=\\sqrt{\\gamma R T}$, and the Mach number is $M=\\dfrac{U}{a_{\\mathrm{ref}}}$, where $U$ is a characteristic velocity and $a_{\\mathrm{ref}}=\\sqrt{\\gamma R T_{\\mathrm{ref}}}$ is the reference speed of sound at the reference temperature $T_{\\mathrm{ref}}$.\n- The static enthalpy is $h=c_p T$, the internal energy is $e=c_v T$, the total energy per unit mass is $E=e+\\dfrac{1}{2}\\lvert\\mathbf{u}\\rvert^2$, and the total enthalpy per unit mass is $H=h+\\dfrac{1}{2}\\lvert\\mathbf{u}\\rvert^2$.\n- In one-dimensional steady channel flow directed along the $x$-axis with plug flow velocity $u=U$, the energy convective flux has the form $\\rho u H$.\n\nYour tasks are:\n1. Derivation task. Starting from the above base, derive a consistent scaling and nondimensionalization for $h$ and $E$ that is compatible with low-Mach preconditioning and yields an energy transport term that remains $\\mathcal{O}(1)$ as $M\\to 0$. You must reason from first principles, explaining why the appropriate reference scales are chosen and how the scales follow from the governing equations. You may assume that the preconditioning concept rescales thermodynamic stiffness to balance acoustic and convective contributions but do not introduce any unproved target formula in the problem statement.\n2. Validation task. Consider a non-isentropic heated channel flow with imposed heating such that the exit temperature $T_{\\mathrm{out}}$ is a multiple of the inlet/reference temperature $T_{\\mathrm{ref}}$, i.e., $T_{\\mathrm{out}}=f\\,T_{\\mathrm{ref}}$ with $f>1$. Assume low-Mach conditions where pressure variations are small and approximate $p\\approx p_{\\mathrm{ref}}$ along the channel, with a uniform plug flow $u=U$ equal to $U=M\\,a_{\\mathrm{ref}}$. Use the Ideal Gas Law to evaluate $\\rho_{\\mathrm{out}}\\approx \\dfrac{p_{\\mathrm{ref}}}{R\\,T_{\\mathrm{out}}}$ and take $H_{\\mathrm{out}}=c_p T_{\\mathrm{out}}+\\dfrac{1}{2}U^2$. Define a dimensionless “normalized convective energy transport measure at the exit” under two scalings:\n   - An acoustic-enthalpy-based normalization implied by your derived low-Mach preconditioned scaling. For testability, take the characteristic energy-flux scale to be $\\rho_{\\mathrm{ref}}\\,a_{\\mathrm{ref}}^2\\,U$, where $\\rho_{\\mathrm{ref}}=\\dfrac{p_{\\mathrm{ref}}}{R\\,T_{\\mathrm{ref}}}$ and $a_{\\mathrm{ref}}=\\sqrt{\\gamma R T_{\\mathrm{ref}}}$.\n   - A naive velocity-squared normalization using $\\rho_{\\mathrm{ref}}\\,U^3$, which is known to be inconsistent with low-Mach scaling.\n   The two dimensionless measures to compute are, respectively,\n   $$S_{\\mathrm{good}}=\\dfrac{\\rho_{\\mathrm{out}}\\,U\\,H_{\\mathrm{out}}}{\\rho_{\\mathrm{ref}}\\,a_{\\mathrm{ref}}^2\\,U},\\qquad S_{\\mathrm{bad}}=\\dfrac{\\rho_{\\mathrm{out}}\\,U\\,H_{\\mathrm{out}}}{\\rho_{\\mathrm{ref}}\\,U^3}.$$\n   You must use the above definitions in your program to numerically validate that $S_{\\mathrm{good}}$ remains $\\mathcal{O}(1)$ as $M\\to 0$ across heated cases, whereas $S_{\\mathrm{bad}}$ does not.\n\nPhysical constants and units to use in the validation:\n- Reference temperature $T_{\\mathrm{ref}}$ in $\\mathrm{K}$: $300$.\n- Reference pressure $p_{\\mathrm{ref}}$ in $\\mathrm{Pa}$: $101325$.\n- Ratio of specific heats $\\gamma$: $1.4$.\n- Specific gas constant $R$ in $\\mathrm{J}/(\\mathrm{kg}\\,\\mathrm{K})$: $287$.\nAll outputs must be unitless (dimensionless floats).\n\nTest suite:\nCompute the ordered pair $[S_{\\mathrm{good}},S_{\\mathrm{bad}}]$ for each of these $(M,f)$ cases:\n- Case $1$: $M=1.0$, $f=1.0$.\n- Case $2$: $M=0.1$, $f=1.5$.\n- Case $3$: $M=0.01$, $f=2.0$.\n- Case $4$: $M=0.001$, $f=1.2$.\nThese cases cover a general compressible regime, moderate low-Mach with heating, deep low-Mach with strong heating, and an extreme low-Mach boundary with mild heating.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list of the four ordered pairs, enclosed in square brackets, with each pair itself enclosed in square brackets, for example, `[[x_1,y_1],[x_2,y_2],[x_3,y_3],[x_4,y_4]]`. The numerical values $x_i$ and $y_i$ must be floats.", "solution": "The problem requires the derivation of a thermodynamically consistent scaling for energy variables in the context of low-Mach number compressible flows, followed by a numerical validation. The derivation must originate from first principles of fluid dynamics and thermodynamics.\n\n### Derivation of Low-Mach Energy Scaling\n\nThe fundamental challenge in simulating compressible flows at low Mach numbers, $M \\to 0$, is the multiscale nature of the governing equations. The speed of acoustic waves, $a$, is much larger than the fluid velocity, $U$, leading to a stiff system. This stiffness is particularly pronounced in the energy equation. Our goal is to derive a nondimensionalization scheme that ensures the terms in the energy equation remain of order unity, $\\mathcal{O}(1)$, as $M \\to 0$.\n\nWe begin with the definitions for total energy per unit mass, $E$, and total enthalpy per unit mass, $H$, for a perfect gas:\n$$E = e + \\frac{1}{2}|\\mathbf{u}|^2 = c_v T + \\frac{1}{2}|\\mathbf{u}|^2$$\n$$H = h + \\frac{1}{2}|\\mathbf{u}|^2 = c_p T + \\frac{1}{2}|\\mathbf{u}|^2$$\nwhere $e$ is the specific internal energy, $h$ is the specific static enthalpy, $T$ is temperature, $\\mathbf{u}$ is the velocity vector, and $c_v$ and $c_p$ are the specific heats at constant volume and pressure, respectively.\n\nThe core of the problem lies in choosing appropriate reference scales for nondimensionalization. Let us denote reference quantities with a subscript `ref` and dimensionless quantities with a prime, e.g., $\\mathbf{u} = U \\mathbf{u}'$, where $U$ is a characteristic velocity.\n\nA naive scaling, often used for high-speed compressible flows, would be to scale all energy quantities by the characteristic kinetic energy, $U^2$. Let us examine the consequences of this choice. The dimensionless total energy, $E'_{naive}$, would be:\n$$E'_{naive} = \\frac{E}{U^2} = \\frac{c_v T}{U^2} + \\frac{1}{2}\\frac{|\\mathbf{u}|^2}{U^2}$$\nTo analyze the first term, we use the definition of the speed of sound, $a^2 = \\gamma R T$, and the Mach number, $M = U/a_{\\mathrm{ref}}$.\n$$\\frac{c_v T}{U^2} = \\frac{c_v T}{M^2 a_{\\mathrm{ref}}^2} = \\left(\\frac{T}{T_{\\mathrm{ref}}}\\right) \\frac{c_v T_{\\mathrm{ref}}}{M^2 a_{\\mathrm{ref}}^2}$$\nUsing $c_v = R/(\\gamma-1)$ and $a_{\\mathrm{ref}}^2 = \\gamma R T_{\\mathrm{ref}}$, we find:\n$$\\frac{c_v T_{\\mathrm{ref}}}{a_{\\mathrm{ref}}^2} = \\frac{R/(\\gamma-1) T_{\\mathrm{ref}}}{\\gamma R T_{\\mathrm{ref}}} = \\frac{1}{\\gamma(\\gamma-1)}$$\nAssuming temperature fluctuations are bounded, $T/T_{\\mathrm{ref}} = \\mathcal{O}(1)$, the thermal energy contribution to $E'_{naive}$ becomes:\n$$\\frac{c_v T}{U^2} = \\mathcal{O}\\left(\\frac{1}{M^2}\\right)$$\nTherefore, the dimensionless total energy becomes:\n$$E'_{naive} = \\mathcal{O}\\left(\\frac{1}{M^2}\\right) + \\frac{1}{2}|\\mathbf{u}'|^2$$\nAs $M \\to 0$, the scaled thermal energy term diverges. This demonstrates that $U^2$ is an improper scale for total energy in the low-Mach regime. The physical reason is that for low-speed flows, the internal energy is vastly larger than the kinetic energy. The total energy is dominated by its thermal component.\n\nA consistent scaling must acknowledge this physical reality. The dominant thermal energy, $h = c_p T$, is directly related to the speed of sound squared, $a^2 = \\gamma R T$. This suggests that a natural reference scale for specific energy quantities ($e, h, E, H$) is $a_{\\mathrm{ref}}^2$. Let us define a new dimensionless total energy, $E'$, using this scale:\n$$E' = \\frac{E}{a_{\\mathrm{ref}}^2} = \\frac{c_v T}{a_{\\mathrm{ref}}^2} + \\frac{1}{2}\\frac{|\\mathbf{u}|^2}{a_{\\mathrm{ref}}^2}$$\nLet's analyze the terms again:\nThe thermal term is $\\dfrac{c_v T}{a_{\\mathrm{ref}}^2} = \\left(\\dfrac{T}{T_{\\mathrm{ref}}}\\right) \\dfrac{c_v T_{\\mathrm{ref}}}{a_{\\mathrm{ref}}^2} = \\left(\\dfrac{T}{T_{\\mathrm{ref}}}\\right) \\dfrac{1}{\\gamma(\\gamma-1)} = \\mathcal{O}(1)$.\nThe kinetic term is $\\dfrac{1}{2}\\dfrac{|\\mathbf{u}|^2}{a_{\\mathrm{ref}}^2} = \\dfrac{1}{2}\\dfrac{U^2 |\\mathbf{u}'|^2}{a_{\\mathrm{ref}}^2} = \\dfrac{1}{2} M^2 |\\mathbf{u}'|^2 = \\mathcal{O}(M^2)$.\nThus, the properly scaled dimensionless total energy is:\n$$E' = \\left(\\frac{T}{T_{\\mathrm{ref}}}\\right) \\frac{1}{\\gamma(\\gamma-1)} + \\frac{1}{2}M^2|\\mathbf{u}'|^2$$\nAs $M \\to 0$, $E'$ remains $\\mathcal{O}(1)$ and smoothly approaches the scaled internal energy. This scaling is well-behaved and removes the system stiffness associated with the energy variable.\n\nThis principle extends to the energy convective flux, $\\rho \\mathbf{u} H$. The characteristic scale of this flux is $(\\rho_{\\mathrm{ref}})(U)(H_{\\mathrm{ref}})$. Using our derived scale $H_{\\mathrm{ref}} = a_{\\mathrm{ref}}^2$, the characteristic flux becomes $\\rho_{\\mathrm{ref}} U a_{\\mathrm{ref}}^2$. This corresponds to the denominator in the definition of $S_{\\mathrm{good}}$. The dimensionless flux is then:\n$$\\frac{\\rho \\mathbf{u} H}{\\rho_{\\mathrm{ref}} U a_{\\mathrm{ref}}^2} = \\rho' \\mathbf{u}' \\frac{H}{a_{\\mathrm{ref}}^2} = \\rho' \\mathbf{u}' \\left(\\frac{c_p T}{a_{\\mathrm{ref}}^2} + \\frac{1}{2}\\frac{|\\mathbf{u}|^2}{a_{\\mathrm{ref}}^2}\\right)$$\nThe term $\\dfrac{c_p T}{a_{\\mathrm{ref}}^2} = \\left(\\dfrac{T}{T_{\\mathrm{ref}}}\\right)\\dfrac{1}{\\gamma-1} = \\mathcal{O}(1)$. The full dimensionless flux is $\\mathcal{O}(1)$ as $M \\to 0$, ensuring the energy transport equation is well-conditioned. This scaling is the essence of low-Mach preconditioning as applied to the energy equation: it rescales the thermodynamic state to balance with convective phenomena.\n\n### Numerical Validation\n\nWe now validate this conclusion using the specified heated channel flow model. We will compute the two dimensionless measures, $S_{\\mathrm{good}}$ and $S_{\\mathrm{bad}}$, which represent the correctly and incorrectly scaled energy fluxes, respectively.\n\nThe formulas are:\n$$S_{\\mathrm{good}}=\\dfrac{\\rho_{\\mathrm{out}}\\,U\\,H_{\\mathrm{out}}}{\\rho_{\\mathrm{ref}}\\,a_{\\mathrm{ref}}^2\\,U} = \\dfrac{\\rho_{\\mathrm{out}}\\,H_{\\mathrm{out}}}{\\rho_{\\mathrm{ref}}\\,a_{\\mathrm{ref}}^2}$$\n$$S_{\\mathrm{bad}}=\\dfrac{\\rho_{\\mathrm{out}}\\,U\\,H_{\\mathrm{out}}}{\\rho_{\\mathrm{ref}}\\,U^3}$$\nThe quantities at the channel exit are defined as:\n$T_{\\mathrm{out}} = f T_{\\mathrm{ref}}$\n$U = M a_{\\mathrm{ref}}$\nUnder the low-Mach assumption $p \\approx p_{\\mathrm{ref}}$, the ideal gas law $p = \\rho R T$ gives $\\rho_{\\mathrm{out}} = \\dfrac{p_{\\mathrm{ref}}}{R T_{\\mathrm{out}}} = \\dfrac{p_{\\mathrm{ref}}}{R f T_{\\mathrm{ref}}}$. Since $\\rho_{\\mathrm{ref}} = \\dfrac{p_{\\mathrm{ref}}}{R T_{\\mathrm{ref}}}$, we have $\\rho_{\\mathrm{out}} = \\dfrac{\\rho_{\\mathrm{ref}}}{f}$.\nThe exit total enthalpy is $H_{\\mathrm{out}} = c_p T_{\\mathrm{out}} + \\frac{1}{2}U^2 = c_p f T_{\\mathrm{ref}} + \\frac{1}{2}M^2 a_{\\mathrm{ref}}^2$.\n\nSubstituting these into the expression for $S_{\\mathrm{good}}$:\n$$S_{\\mathrm{good}} = \\frac{(\\rho_{\\mathrm{ref}}/f)(c_p f T_{\\mathrm{ref}} + \\frac{1}{2}M^2 a_{\\mathrm{ref}}^2)}{\\rho_{\\mathrm{ref}} a_{\\mathrm{ref}}^2} = \\frac{c_p T_{\\mathrm{ref}}}{a_{\\mathrm{ref}}^2} + \\frac{M^2}{2f}$$\nUsing $c_p = \\dfrac{\\gamma R}{\\gamma-1}$ and $a_{\\mathrm{ref}}^2 = \\gamma R T_{\\mathrm{ref}}$, the constant term simplifies to $\\dfrac{c_p T_{\\mathrm{ref}}}{a_{\\mathrm{ref}}^2} = \\dfrac{1}{\\gamma-1}$.\nThus, we arrive at the analytical expressions:\n$$S_{\\mathrm{good}} = \\frac{1}{\\gamma-1} + \\frac{M^2}{2f}$$\n$$S_{\\mathrm{bad}} = \\frac{S_{\\mathrm{good}}}{M^2} = \\frac{1}{M^2(\\gamma-1)} + \\frac{1}{2f}$$\nAs $M \\to 0$, $S_{\\mathrm{good}}$ approaches the constant $\\dfrac{1}{\\gamma-1}$, confirming it is an $\\mathcal{O}(1)$ quantity. In contrast, $S_{\\mathrm{bad}}$ diverges as $\\mathcal{O}(M^{-2})$. The following program will numerically compute these values from the fundamental definitions to verify this behavior for the given test cases. For $\\gamma=1.4$, the limiting value for $S_{\\mathrm{good}}$ is $1/(1.4-1.0) = 2.5$.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes and validates energy flux scaling for low-Mach number flows.\n    \"\"\"\n    # Define physical constants and reference-state properties\n    T_ref = 300.0  # Reference temperature in K\n    p_ref = 101325.0  # Reference pressure in Pa\n    gamma = 1.4  # Ratio of specific heats\n    R = 287.0  # Specific gas constant in J/(kg*K)\n\n    # Define the test cases as a list of (Mach number, temperature factor) tuples\n    test_cases = [\n        (1.0, 1.0),\n        (0.1, 1.5),\n        (0.01, 2.0),\n        (0.001, 1.2),\n    ]\n\n    results = []\n\n    # Calculate derived reference quantities\n    a_ref = np.sqrt(gamma * R * T_ref)\n    rho_ref = p_ref / (R * T_ref)\n    c_p = gamma * R / (gamma - 1.0)\n\n    for M, f in test_cases:\n        # Calculate flow properties based on the test case\n        U = M * a_ref\n        T_out = f * T_ref\n        \n        # Approximate density at exit assuming constant pressure p_ref\n        rho_out = p_ref / (R * T_out)\n        \n        # Calculate total enthalpy at exit\n        H_out = c_p * T_out + 0.5 * U**2\n        \n        # Calculate the convective energy flux at the exit\n        energy_flux = rho_out * U * H_out\n        \n        # Calculate the \"good\" scaling denominator (acoustic-enthalpy-based)\n        # This scale is O(rho_ref * U * a_ref^2)\n        denom_good = rho_ref * (a_ref**2) * U\n        \n        # Calculate the \"bad\" scaling denominator (naive velocity-squared-based)\n        # This scale is O(rho_ref * U^3)\n        denom_bad = rho_ref * (U**3)\n        \n        # Compute the two dimensionless measures\n        # Note: If M=0, U=0, leading to division by zero. The problem uses M > 0.\n        S_good = energy_flux / denom_good\n        S_bad = energy_flux / denom_bad\n        \n        results.append([S_good, S_bad])\n\n    # Format the output string precisely as required: [[r1_1,r1_2],[r2_1,r2_2],...]\n    formatted_results = [f\"[{r[0]},{r[1]}]\" for r in results]\n    final_output = f\"[{','.join(formatted_results)}]\"\n    \n    print(final_output)\n\nsolve()\n```", "id": "3341795"}, {"introduction": "A primary motivation for preconditioning is to accelerate the convergence of simulations to a steady state. This is achieved by re-scaling the system's eigenvalues to reduce stiffness, which in turn allows for a much larger stable time step in an explicit pseudo-time integration scheme. This practice asks you to quantify this benefit by calculating the stable pseudo-time step for a preconditioned system, directly connecting the modified characteristic speeds to a practical improvement in computational efficiency [@problem_id:3341765].", "problem": "Consider one-dimensional steady uniform flow of a calorically perfect ideal gas with specific heat ratio $\\gamma=1.4$ at a freestream Mach number $M=0.02$. The compressible Euler equations are written in quasi-linear form as $\\partial \\mathbf{Q}/\\partial t + \\partial \\mathbf{F}(\\mathbf{Q})/\\partial x = \\mathbf{0}$, where $\\mathbf{Q}$ denotes the conserved variables and $\\mathbf{F}$ the inviscid flux. To accelerate convergence to steady state, pseudo-time $\\tau$ integration with a preconditioning matrix is employed, so the pseudo-time system is $\\mathbf{P}\\,\\partial \\mathbf{Q}/\\partial \\tau + \\partial \\mathbf{F}(\\mathbf{Q})/\\partial x = \\mathbf{0}$, where $\\mathbf{P}$ is the Turkel preconditioning matrix.\n\nAssume linearization about the uniform state and consider a first-order explicit forward Euler update in pseudo-time over a uniform grid of spacing $\\Delta x$. The Courant–Friedrichs–Lewy (CFL) number is defined by $\\mathrm{CFL} = \\lambda_{\\max}\\,\\Delta \\tau/\\Delta x$, where $\\lambda_{\\max}$ is the maximum magnitude of the preconditioned characteristic speed along the $x$-direction, and $\\Delta \\tau$ is the pseudo-time step. The physical speed of sound is $a$, the flow speed is $u$, and the Mach number is defined as $M = |u|/a$. For a calorically perfect gas, $a = \\sqrt{\\gamma p/\\rho}$, where $p$ is the pressure and $\\rho$ is the density.\n\nUnder Turkel preconditioning in the low-Mach regime, the acoustic characteristic speeds are scaled by a factor $\\sqrt{\\beta}$, where the preconditioning parameter satisfies $\\beta = M^{2}$ for $M \\leq 1$, while the convective characteristic speed remains $u$. Using these facts, derive the stability constraint for the explicit scheme and compute the stable pseudo-time step $\\Delta \\tau$ when $\\mathrm{CFL} = 0.5$, $M = 0.02$, $\\gamma = 1.4$, and the grid size is $\\Delta x$. Express your final answer in seconds as a single simplified closed-form analytic expression in terms of $\\Delta x$ and $a$. No rounding is required.", "solution": "We start from the compressible Euler equations in quasi-linear form, linearized about a uniform state, where the flux Jacobian in one spatial dimension has characteristic speeds $u-a$, $u$, and $u+a$. These are the eigenvalues of the unpreconditioned Jacobian $\\partial \\mathbf{F}/\\partial \\mathbf{Q}$ along the $x$-direction. Introducing pseudo-time $\\tau$ and Turkel preconditioning, the system can be written as\n$$\n\\mathbf{P}\\,\\frac{\\partial \\mathbf{Q}}{\\partial \\tau} + \\frac{\\partial \\mathbf{F}(\\mathbf{Q})}{\\partial x} = \\mathbf{0},\n$$\nor equivalently\n$$\n\\frac{\\partial \\mathbf{Q}}{\\partial \\tau} + \\mathbf{P}^{-1}\\,\\frac{\\partial \\mathbf{F}(\\mathbf{Q})}{\\partial x} = \\mathbf{0}.\n$$\nThe effect of preconditioning is to modify the characteristic speeds of the spatial operator from their physical values to preconditioned values. In the Turkel preconditioner for low-Mach-number flows, the convective characteristic speed $u$ is unchanged, while the acoustic speeds are scaled by a factor $\\sqrt{\\beta}$, where the preconditioning parameter $\\beta$ satisfies $\\beta = M^{2}$ for $M \\leq 1$. Thus, the preconditioned characteristic speeds are\n$$\n\\lambda_{1} = u - a\\sqrt{\\beta}, \\quad \\lambda_{2} = u, \\quad \\lambda_{3} = u + a\\sqrt{\\beta}.\n$$\n\nFor an explicit forward Euler scheme in pseudo-time applied to the linearized system on a uniform grid of spacing $\\Delta x$, a standard von Neumann stability argument gives the Courant–Friedrichs–Lewy condition\n$$\n\\Delta \\tau \\leq \\frac{\\mathrm{CFL}\\,\\Delta x}{\\max\\left(|\\lambda_{1}|,|\\lambda_{2}|,|\\lambda_{3}|\\right)}.\n$$\nFor subsonic flow with $u \\geq 0$ and small Mach number (here $M=0.02$), the maximum magnitude among the three characteristic speeds is\n$$\n\\lambda_{\\max} = u + a\\sqrt{\\beta}.\n$$\nUsing the definition of Mach number $M = |u|/a$, we have $u = M a$. Substituting $u = M a$ and $\\beta = M^{2}$ into $\\lambda_{\\max}$ yields\n$$\n\\lambda_{\\max} = M a + a\\sqrt{M^{2}} = M a + a M = 2 M a.\n$$\n\nTherefore, the stability constraint becomes\n$$\n\\Delta \\tau \\leq \\frac{\\mathrm{CFL}\\,\\Delta x}{2 M a}.\n$$\nWith the specified parameters $\\mathrm{CFL} = 0.5$ and $M = 0.02$, this reduces to\n$$\n\\Delta \\tau = \\frac{0.5\\,\\Delta x}{2 \\cdot 0.02 \\, a} = \\frac{0.5\\,\\Delta x}{0.04\\,a} = \\frac{12.5\\,\\Delta x}{a}.\n$$\nHere, $a$ is the physical speed of sound, which for a calorically perfect ideal gas is $a = \\sqrt{\\gamma p/\\rho}$ with $\\gamma = 1.4$. Since $p$ and $\\rho$ are not specified, the closed-form expression in terms of $\\Delta x$ and $a$ is the final result. The units are seconds because $\\Delta x$ has units of length and $a$ has units of length per unit time, so their ratio has units of time.\n\nThus, the stable pseudo-time step under Turkel preconditioning for the given conditions is\n$$\n\\Delta \\tau = \\frac{12.5\\,\\Delta x}{a}.\n$$", "answer": "$$\\boxed{\\frac{12.5\\,\\Delta x}{a}}$$", "id": "3341765"}, {"introduction": "Implementing low-Mach preconditioning is more than just applying a matrix; it requires ensuring the entire numerical algorithm is consistent with the newly scaled wave physics. This advanced practice explores the crucial interaction between preconditioning and the entropy fix mechanism within a Roe-type Riemann solver. You will analyze how a naive entropy fix can introduce excessive numerical dissipation, and determine the correct scaling needed to preserve the accuracy of both acoustic and convective phenomena at low Mach numbers [@problem_id:3341806].", "problem": "In compressible Computational Fluid Dynamics (CFD), consider the inviscid Euler equations in conservative form, $\\partial_t \\mathbf{U} + \\nabla \\cdot \\mathbf{F}(\\mathbf{U}) = \\mathbf{0}$, where $\\mathbf{U}$ is the vector of conservative variables and $\\mathbf{F}$ is the flux tensor. A Roe-type approximate Riemann solver constructs an interface-normal numerical flux from a jump $\\Delta \\mathbf{U}$ using characteristic decomposition with respect to the normal flux Jacobian $\\mathbf{A}_n = \\partial \\mathbf{F}_n / \\partial \\mathbf{U}$, where $\\mathbf{F}_n = \\mathbf{F}(\\mathbf{U}) \\cdot \\mathbf{n}$ and $\\mathbf{n}$ is a unit normal. For low-Mach number flows with local Mach number $M = \\lvert \\mathbf{u} \\rvert / c \\ll 1$, a preconditioning matrix $\\mathbf{P}(M)$ is introduced so that the effective normal operator $\\mathbf{P}^{-1}\\mathbf{A}_n$ has eigenvalues $\\lambda_{\\pm} = u_n \\pm \\tilde{c}$ and convective eigenvalues equal to $u_n$ (possibly with multiplicity), where $u_n = \\mathbf{u} \\cdot \\mathbf{n}$, $c$ is the physical speed of sound, and $\\tilde{c} = \\phi(M)\\,c$ is a preconditioned acoustic speed with $\\phi(M) \\sim M$ as $M \\to 0$. In preconditioned formulations, the entropy condition for the acoustic fields is tied to the preconditioned sonic condition $\\lvert u_n \\rvert \\approx \\tilde{c}$.\n\nTo avoid non-physical expansion shocks in transonic rarefactions, Roe-type solvers apply an entropy fix that replaces $\\lvert \\lambda_k \\rvert$ by a Lipschitz-continuous entropy-corrected magnitude $\\lvert \\lambda_k \\rvert_e$ that increases the dissipation near sonic points, controlled by a threshold parameter $\\delta_k$ for each field $k$. In the classical (unpreconditioned) setting, choosing $\\delta_k$ proportional to $c$ ensures adequate entropy-satisfying dissipation near $\\lvert u_n \\rvert \\approx c$. However, at low $M$, such a choice can conflict with preconditioning and can overdamp vortical structures whose dynamics are dominated by the convective eigenvalues of magnitude $\\mathcal{O}(u_n) = \\mathcal{O}(M c)$.\n\nStarting from the above fundamentals and the definition of $M$, analyze the scaling of the entropy correction in the preconditioned problem and determine which of the following Mach-dependent entropy fixes simultaneously satisfies the following goals:\n\n- $(\\mathrm{G1})$ It aligns the entropy trigger with the preconditioned acoustic fields, i.e., it activates when $\\lvert u_n \\rvert \\approx \\tilde{c}$, not when $\\lvert u_n \\rvert \\approx c$.\n- $(\\mathrm{G2})$ It avoids contaminating the convective (vortical) modes with artificial dissipation that is not asymptotically negligible as $M \\to 0$.\n- $(\\mathrm{G3})$ It preserves Lipschitz continuity of the characteristic magnitudes near sonic points and does not alter the sign of the wave speeds.\n\nAssume that when a threshold $\\delta_k$ is specified for a field $k$, a standard Lipschitz continuous entropy replacement is used that yields an added magnitude of order $\\delta_k$ near the sonic point of that field (for example, at the sonic point the corrected magnitude is of order $\\delta_k$). You may assume any reasonable preconditioner for which $\\tilde{c} = \\phi(M)\\,c$ with $\\phi(M) \\sim M$ as $M \\to 0$, and that the Roe-averaging used to define characteristic fields is consistent with the above eigenstructure.\n\nWhich option best satisfies $(\\mathrm{G1})$–$(\\mathrm{G3})$?\n\nA. Use the unpreconditioned speed of sound for all fields: set $\\delta_k = \\kappa\\,c$ with a constant $\\kappa \\in (0,1)$, applied identically to all characteristic fields, including the convective fields.\n\nB. Use the preconditioned acoustic speed for all fields: set $\\delta_k = \\kappa\\,\\tilde{c}$ with a constant $\\kappa \\in (0,1)$, applied identically to all characteristic fields, including the convective fields.\n\nC. Restrict the entropy fix to the acoustic fields and tie it to proximity to the preconditioned sonic condition: for $k \\in \\{+,-\\}$ set $\\delta_{\\pm} = \\kappa\\,\\max\\!\\big(0,\\,\\tilde{c} - \\lvert u_n \\rvert\\big)$ with $\\kappa \\in (0,1)$, and set $\\delta_k = 0$ for the convective fields; use a Lipschitz continuous entropy replacement for the acoustic magnitudes only.\n\nD. Use the normal velocity magnitude for all fields: set $\\delta_k = \\kappa\\,\\lvert u_n \\rvert$ with a constant $\\kappa \\in (0,1)$, applied identically to all characteristic fields, including the convective fields.\n\nE. Trigger the entropy fix for the acoustic fields based on the unpreconditioned sonic condition: for $k \\in \\{+,-\\}$ set $\\delta_{\\pm} = \\kappa\\,\\max\\!\\big(0,\\,c - \\lvert u_n \\rvert\\big)$ with $\\kappa \\in (0,1)$, and set $\\delta_k = 0$ for the convective fields; use a Lipschitz continuous entropy replacement for the acoustic magnitudes only.\n\nSelect all that apply.", "solution": "To determine the correct entropy fix, we must analyze the scaling of the relevant physical quantities at low Mach numbers ($M \\ll 1$) and evaluate each option against the three stated goals: (G1) activating the fix near the preconditioned sonic point, (G2) avoiding unphysical dissipation of convective modes, and (G3) preserving mathematical properties like Lipschitz continuity.\n\nThe core issue is the disparity of scales. The physical sound speed $c$ is an $\\mathcal{O}(1)$ quantity (in appropriate non-dimensionalization), while the material velocity $u_n$ and the preconditioned sound speed $\\tilde{c}$ both scale with the Mach number: $u_n = \\mathcal{O}(Mc)$ and $\\tilde{c} = \\mathcal{O}(Mc)$. A correct entropy fix must respect these different scales.\n\nWe now evaluate each option:\n\n**A. Use a threshold proportional to the physical sound speed for all fields: $\\delta_k = \\kappa\\,c$.**\nThis sets a dissipation scale of order $\\mathcal{O}(c)$.\n-   For convective modes (eigenvalue $u_n \\sim \\mathcal{O}(Mc)$), this dissipation is orders of magnitude too large, violating **(G2)** by unphysically damping vortical structures.\n-   For acoustic modes (eigenvalues $u_n \\pm \\tilde{c} \\sim \\mathcal{O}(Mc)$), the fix is triggered everywhere at low Mach since $\\lvert \\lambda_{\\pm} \\rvert \\ll c$, not just at the preconditioned sonic point. This violates **(G1)**.\n\n**B. Use a threshold proportional to the preconditioned sound speed for all fields: $\\delta_k = \\kappa\\,\\tilde{c}$.**\nThis sets a dissipation scale of order $\\mathcal{O}(\\tilde{c}) = \\mathcal{O}(Mc)$.\n-   For acoustic modes, this scale is appropriate and correctly targets the preconditioned sonic point $\\lvert u_n \\rvert \\approx \\tilde{c}$, satisfying **(G1)**.\n-   For convective modes, the added dissipation is of the same order as the eigenvalue itself ($\\mathcal{O}(Mc)$). This is not negligible and still contaminates the convective physics, violating **(G2)**.\n\n**C. Restrict the fix to acoustic fields, with a threshold tied to the preconditioned sonic condition, and add no fix to convective fields.**\nThe threshold $\\delta_{\\pm} = \\kappa\\,\\max\\!\\big(0,\\,\\tilde{c} - \\lvert u_n \\rvert\\big)$ targets only the acoustic fields and is active only when $\\lvert u_n \\rvert  \\tilde{c}$, aligning perfectly with **(G1)**. By setting the threshold to zero for convective fields, it adds no artificial dissipation to them, satisfying **(G2)**. The `max` function is Lipschitz continuous, satisfying **(G3)**. This approach correctly treats each wave family according to its preconditioned physics.\n\n**D. Use a threshold proportional to the normal velocity: $\\delta_k = \\kappa\\,\\lvert u_n \\rvert$.**\nThis threshold vanishes at the convective sonic point ($u_n = 0$), providing no dissipation where it is needed. For many standard entropy fix formulations (e.g., Harten's), this would lead to division by zero, violating **(G3)**. The formulation is ill-conceived.\n\n**E. Restrict the fix to acoustic fields, but trigger based on the unpreconditioned sonic condition.**\nThe threshold $\\delta_{\\pm} = \\kappa\\,\\max\\!\\big(0,\\,c - \\lvert u_n \\rvert\\big)$ is based on the physical sound speed $c$. At low Mach numbers, $\\lvert u_n \\rvert \\ll c$, so the threshold becomes $\\delta_{\\pm} \\approx \\kappa c$. This reintroduces the excessive dissipation scale of Option A, which is far too large for the preconditioned acoustic waves. This violates **(G1)**.\n\n**Conclusion:** Only Option C satisfies all three design goals by correctly scaling the dissipation for the acoustic waves according to the preconditioned dynamics while protecting the convective waves from unphysical damping.", "answer": "$$\\boxed{C}$$", "id": "3341806"}]}