{"hands_on_practices": [{"introduction": "While the Lax–Wendroff scheme is formally second-order accurate, its interaction with different wave frequencies reveals important characteristics beyond the leading-order truncation error. This exercise [@problem_id:2225601] uses von Neumann stability analysis not just to confirm the stability range, but to probe the scheme's numerical dissipation. By analyzing the amplification factor, you will determine the specific Courant number, $\\nu$, that maximally damps the highest-frequency waves representable on the grid, providing insight into the scheme's inherent dissipative nature.", "problem": "A scientist is modeling the transport of a non-reactive tracer in a one-dimensional fluid flow. The concentration of the tracer, $u(x, t)$, is governed by the linear advection equation: $\\frac{\\partial u}{\\partial t} + c \\frac{\\partial u}{\\partial x} = 0$, where $c$ is the constant positive velocity of the fluid.\n\nTo solve this equation numerically, a finite difference method is employed on a uniform grid with spatial step size $\\Delta x$ and time step size $\\Delta t$. The update rule for the concentration $u_j^n \\approx u(j\\Delta x, n\\Delta t)$ is given by the Lax–Wendroff scheme:\n$$u_j^{n+1} = u_j^n - \\frac{c \\Delta t}{2 \\Delta x}(u_{j+1}^n - u_{j-1}^n) + \\frac{1}{2}\\left(\\frac{c \\Delta t}{\\Delta x}\\right)^2(u_{j+1}^n - 2u_j^n + u_{j-1}^n)$$\n\nThis scheme is known to introduce numerical dissipation, which damps the amplitude of Fourier modes of the solution. The amount of damping for a given mode depends on the dimensionless Courant number, $\\nu = \\frac{c \\Delta t}{\\Delta x}$. We are interested in the behavior of the highest-frequency mode that can be represented on the grid, which has a wavelength of $2\\Delta x$. This particular mode often experiences the most significant damping.\n\nFor the scheme to be stable, the Courant number must be within a certain range. Within this stable range, determine the specific positive value of the Courant number, $\\nu$, for which the numerical dissipation of this highest-frequency mode is maximized (i.e., its amplitude is most strongly reduced after a single time step).", "solution": "We analyze the Lax–Wendroff scheme via von Neumann analysis. Consider a Fourier mode $u_{j}^{n}=\\hat{u}^{n}\\exp(i j \\theta)$, where $\\theta=k\\Delta x$. Then\n$$\nu_{j+1}^{n}-u_{j-1}^{n}=\\hat{u}^{n}\\exp(i j \\theta)\\left[\\exp(i\\theta)-\\exp(-i\\theta)\\right]=2i\\hat{u}^{n}\\exp(i j \\theta)\\sin\\theta,\n$$\n$$\nu_{j+1}^{n}-2u_{j}^{n}+u_{j-1}^{n}=\\hat{u}^{n}\\exp(i j \\theta)\\left[\\exp(i\\theta)-2+\\exp(-i\\theta)\\right]=2\\hat{u}^{n}\\exp(i j \\theta)\\left(\\cos\\theta-1\\right).\n$$\nWith $\\nu=\\frac{c\\Delta t}{\\Delta x}$, substituting into the update gives\n$$\nu_{j}^{n+1}=\\hat{u}^{n}\\exp(i j \\theta)\\left[1-\\frac{\\nu}{2}(2i\\sin\\theta)+\\frac{\\nu^{2}}{2}\\cdot 2(\\cos\\theta-1)\\right]\n=\\hat{u}^{n}\\exp(i j \\theta)\\,G(\\theta),\n$$\nso the amplification factor is\n$$\nG(\\theta)=1-i\\nu\\sin\\theta+\\nu^{2}(\\cos\\theta-1).\n$$\nFor the highest-frequency mode on the grid, the wavelength is $2\\Delta x$, hence $\\theta=\\pi$. Using $\\sin\\pi=0$ and $\\cos\\pi=-1$,\n$$\nG(\\pi)=1- i\\nu\\cdot 0+\\nu^{2}(-1-1)=1-2\\nu^{2}.\n$$\nThus the amplitude after one step is multiplied by $|G(\\pi)|=|1-2\\nu^{2}|$. The Lax–Wendroff scheme is stable for $0\\leq \\nu \\leq 1$. On this interval,\n$$\n|1-2\\nu^{2}|=\\begin{cases}\n1-2\\nu^{2}, & 0\\leq \\nu \\leq \\frac{1}{\\sqrt{2}},\\\\\n2\\nu^{2}-1, & \\frac{1}{\\sqrt{2}}\\leq \\nu \\leq 1,\n\\end{cases}\n$$\nwhich decreases on $[0,\\frac{1}{\\sqrt{2}}]$ and increases on $[\\frac{1}{\\sqrt{2}},1]$. Therefore, the minimum of $|G(\\pi)|$ (i.e., the maximum damping) occurs at\n$$\n\\nu=\\frac{1}{\\sqrt{2}},\n$$\nfor which $G(\\pi)=0$ and the mode is completely damped in one step.", "answer": "$$\\boxed{\\frac{1}{\\sqrt{2}}}$$", "id": "2225601"}, {"introduction": "A significant drawback of higher-order linear schemes like Lax–Wendroff is the presence of numerical dispersion, which can manifest as non-physical oscillations near sharp gradients. This exercise [@problem_id:3603389] presents a classic analytical problem to demonstrate this behavior directly. By applying the scheme to a perfect step-function initial condition, you will show that the solution can overshoot the initial data's maximum value, proving that the scheme does not satisfy a discrete maximum principle.", "problem": "Consider the one-dimensional linear advection equation $\\partial_{t} u + a \\,\\partial_{x} u = 0$ for a passive scalar $u(x,t)$, where $a>0$ is a constant advection speed representative of a constant-velocity fluid flow. Let the spatial domain be uniform with grid points $x_{i} = i\\,\\Delta x$ and time levels $t^{n} = n\\,\\Delta t$. Define the Courant–Friedrichs–Lewy (CFL) number $\\sigma = a\\,\\Delta t/\\Delta x$ and assume $0<\\sigma<1$. Starting from the governing equation and using a second-order Taylor expansion in time together with second-order central differences for spatial derivatives, derive the explicit two-level-in-time, three-point-in-space high-order Lax–Wendroff update at a grid point $x_{i}$ in terms of $u_{i-1}^{n}$, $u_{i}^{n}$, and $u_{i+1}^{n}$.\n\nNow consider the following discrete initial condition intended to model a sharp tracer front: $u_{i}^{0} = 1$ for all $i \\leq 0$ and $u_{i}^{0} = 0$ for all $i \\geq 1$. Using your derived Lax–Wendroff update, compute the single-step update $u_{0}^{1}$ at $x_{0}$ as a function of the CFL number $\\sigma$. Express your final answer as a closed-form analytic expression. No rounding is required, and the quantity $u$ is dimensionless.", "solution": "The Lax–Wendroff scheme for the equation $\\partial_t u + a \\partial_x u = 0$ is derived from the Taylor series expansion in time:\n$$u(x, t+\\Delta t) \\approx u(x,t) + \\Delta t \\, \\partial_t u + \\frac{(\\Delta t)^2}{2} \\, \\partial_{tt} u$$\nUsing the governing equation, we substitute the time derivatives: $\\partial_t u = -a \\partial_x u$ and $\\partial_{tt} u = \\partial_t(-a \\partial_x u) = -a \\partial_x(\\partial_t u) = -a \\partial_x(-a \\partial_x u) = a^2 \\partial_{xx} u$.\nThis gives:\n$$u(x, t+\\Delta t) \\approx u(x,t) - a \\Delta t \\, \\partial_x u + \\frac{a^2 (\\Delta t)^2}{2} \\, \\partial_{xx} u$$\nDiscretizing with second-order central differences for the spatial derivatives ($(\\partial_x u)_i \\approx \\frac{u_{i+1}-u_{i-1}}{2\\Delta x}$ and $(\\partial_{xx} u)_i \\approx \\frac{u_{i+1}-2u_i+u_{i-1}}{(\\Delta x)^2}$) and using the CFL number $\\sigma = a\\Delta t/\\Delta x$, we get the scheme:\n$$u_i^{n+1} = u_i^n - \\frac{\\sigma}{2}(u_{i+1}^n - u_{i-1}^n) + \\frac{\\sigma^2}{2}(u_{i+1}^n - 2u_i^n + u_{i-1}^n)$$\nWe need to compute $u_0^1$ using the initial condition at $n=0$:\n$$u_0^1 = u_0^0 - \\frac{\\sigma}{2}(u_{1}^0 - u_{-1}^0) + \\frac{\\sigma^2}{2}(u_{1}^0 - 2u_0^0 + u_{-1}^0)$$\nThe initial data is $u_i^0=1$ for $i \\le 0$ and $u_i^0=0$ for $i \\ge 1$.\nThis means:\n*   $u_0^0 = 1$\n*   $u_{-1}^0 = 1$\n*   $u_1^0 = 0$\nSubstituting these values into the scheme:\n$$u_0^1 = 1 - \\frac{\\sigma}{2}(0 - 1) + \\frac{\\sigma^2}{2}(0 - 2(1) + 1)$$\n$$u_0^1 = 1 - \\frac{\\sigma}{2}(-1) + \\frac{\\sigma^2}{2}(-1)$$\n$$u_0^1 = 1 + \\frac{\\sigma}{2} - \\frac{\\sigma^2}{2}$$", "answer": "$$\\boxed{1 + \\frac{\\sigma}{2} - \\frac{\\sigma^2}{2}}$$", "id": "3603389"}, {"introduction": "The theoretical properties of dissipation and dispersion become particularly important in nonlinear problems where solutions can evolve to form shocks. This hands-on coding exercise [@problem_id:3375643] bridges the gap from theory to practice by tasking you with simulating the inviscid Burgers' equation. You will implement the Lax–Wendroff scheme to observe the formation of a shock from smooth initial data and quantify the resulting overshoots, exploring how these numerical artifacts behave under grid refinement.", "problem": "Consider the one-dimensional nonlinear scalar conservation law $u_t + f(u)_x = 0$ with convex flux $f(u)$ on the periodic domain $x \\in [0,1]$. Use the specific convex flux $f(u) = \\tfrac{1}{2} u^2$ (inviscid Burgers equation). Let the initial condition be a smooth monotone step from a high state to a low state,\n$$\nu(x,0) = u_R + \\tfrac{1}{2}(u_L - u_R)\\left(1 - \\tanh\\left(\\frac{x - x_0}{\\nu}\\right)\\right),\n$$\nwith $u_L = 1$, $u_R = 0$, $x_0 = 0.5$, and smoothing parameter $\\nu > 0$. This configuration is compressive and evolves to a shock, which is known to trigger dispersive overshoots in the Lax–Wendroff scheme.\n\nStarting from the conservation form $u_t + f(u)_x = 0$, derive the two-step explicit Lax–Wendroff (LW) scheme for general scalar nonlinear convex flux based on a Taylor expansion in time and maintaining conservative form. Implement this LW scheme on a uniform grid with $N$ points, grid spacing $\\Delta x = 1/N$, and periodic boundary conditions. Use a time step $\\Delta t$ chosen adaptively to satisfy a Courant–Friedrichs–Lewy (CFL) stability condition $\\max|f'(u)| \\tfrac{\\Delta t}{\\Delta x} \\leq \\mathrm{CFL}$ with $\\mathrm{CFL} = 0.9$. Evolve the solution to a fixed final time $T = 0.2$ (dimensionless).\n\nDefine the overshoot magnitude at time $T$ as the largest violation of the invariant range $[u_{\\min}, u_{\\max}] = [\\min(u_L,u_R), \\max(u_L,u_R)] = [0,1]$:\n$$\n\\mathcal{O} = \\max\\left( \\max_x\\left( u(x,T) - u_{\\max} \\right), \\max_x\\left( u_{\\min} - u(x,T) \\right) \\right),\n$$\nwhere negative values inside the maxima are taken as $0$ by convention. In other words, $\\mathcal{O}$ is the maximum distance of the numerical solution outside the physically admissible range $[0,1]$.\n\nYour task is to write a program that:\n- Constructs the initial condition for given $N$ and $\\nu$.\n- Evolves the solution to time $T$ using the derived LW scheme with periodic boundary conditions and adaptive time stepping that respects the stated CFL condition.\n- Computes the overshoot magnitude $\\mathcal{O}$ at time $T$.\n\nTest suite:\n- Case $1$: $(N,\\nu) = (256, 0.05)$.\n- Case $2$: $(N,\\nu) = (512, 0.05)$.\n- Case $3$: $(N,\\nu) = (1024, 0.05)$.\n- Case $4$: $(N,\\nu) = (512, 0.02)$.\n- Case $5$: $(N,\\nu) = (512, 0.10)$.\n- Case $6$: $(N,\\nu) = (128, 0.01)$.\n\nDesign for coverage:\n- Cases $1$–$3$ vary $\\Delta x$ at fixed $\\nu$ to probe how overshoot scales with grid refinement.\n- Cases $4$–$5$ vary $\\nu$ at fixed $N$ to probe dependence on initial smoothness scale.\n- Case $6$ combines a coarse grid and sharp transition to probe a challenging edge condition near stability and resolution limits.\n\nFinal output format:\n- Your program should produce a single line of output containing the overshoot magnitudes for the six test cases as a comma-separated list enclosed in square brackets, for example $[o_1,o_2,o_3,o_4,o_5,o_6]$, where each $o_k$ is a floating-point value equal to $\\mathcal{O}$ for the corresponding case.\n- No additional text should be printed.", "solution": "The problem is valid. It presents a standard computational fluid dynamics task: solving the inviscid Burgers' equation with a specific initial condition using the Lax-Wendroff scheme and quantifying the resulting numerical artifacts (overshoots). All parameters, equations, and conditions are well-defined, scientifically sound, and objective.\n\nThe governing equation is the one-dimensional scalar conservation law given by:\n$$\nu_t + f(u)_x = 0\n$$\nwith the convex flux function for the inviscid Burgers' equation:\n$$\nf(u) = \\tfrac{1}{2} u^2\n$$\nThe domain is $x \\in [0,1]$ with periodic boundary conditions. The initial condition is a smoothed shock profile:\n$$\nu(x,0) = u_R + \\tfrac{1}{2}(u_L - u_R)\\left(1 - \\tanh\\left(\\frac{x - x_0}{\\nu}\\right)\\right)\n$$\nwith parameters $u_L = 1$, $u_R = 0$, $x_0 = 0.5$, and a smoothing parameter $\\nu > 0$. This simplifies to:\n$$\nu(x,0) = \\tfrac{1}{2}\\left(1 - \\tanh\\left(\\frac{x - 0.5}{\\nu}\\right)\\right)\n$$\nThis initial profile represents a compressive wave that will steepen into a shock, a scenario known to produce spurious oscillations in second-order linear schemes like Lax-Wendroff.\n\n**Derivation of the Two-Step Lax-Wendroff Scheme**\nThe Lax-Wendroff (LW) scheme is derived from a Taylor series expansion of the solution $u(x,t)$ in the time variable $t$:\n$$\nu(x, t+\\Delta t) = u(x,t) + \\Delta t u_t(x,t) + \\frac{(\\Delta t)^2}{2} u_{tt}(x,t) + O((\\Delta t)^3)\n$$\nThe time derivatives, $u_t$ and $u_{tt}$, are replaced with spatial derivatives by repeatedly using the conservation law $u_t = -f(u)_x$. The first derivative is immediate. The second derivative is found by differentiating the PDE with respect to time:\n$$\nu_{tt} = \\frac{\\partial}{\\partial t}(-f(u)_x) = -\\frac{\\partial}{\\partial x}(f(u)_t)\n$$\nUsing the chain rule, $f(u)_t = f'(u) u_t$, where $f'(u)$ is the Jacobian of the flux. Substituting $u_t = -f(u)_x$ yields:\n$$\nu_{tt} = -\\frac{\\partial}{\\partial x}\\left(f'(u) (-f(u)_x)\\right) = \\frac{\\partial}{\\partial x}\\left(f'(u) f(u)_x\\right)\n$$\nFor Burgers' equation, $f'(u) = u$. Substituting the time derivatives back into the Taylor expansion gives a single-step update formula. However, to maintain a conservative form more easily, the equivalent Richtmyer two-step formulation is used. Let $u^n_j$ be the a numerical approximation of $u(x_j, t_n)$ on a grid with spacing $\\Delta x$ and time step $\\Delta t$.\n\n**Step 1: Predictor.** An intermediate solution $u^{n+1/2}_{j+1/2}$ is computed at cell interfaces $x_{j+1/2}$ and time $t_n + \\Delta t/2$:\n$$\nu^{n+1/2}_{j+1/2} = \\frac{1}{2}(u^n_{j+1} + u^n_j) - \\frac{\\Delta t}{2 \\Delta x}(f(u^n_{j+1}) - f(u^n_j))\n$$\nThis is effectively a forward-time, centered-space (FTCS) step applied over half intervals.\n\n**Step 2: Corrector.** The final solution $u^{n+1}_j$ is found using a centered difference of the fluxes evaluated at the predicted half-step values:\n$$\nu^{n+1}_j = u^n_j - \\frac{\\Delta t}{\\Delta x}(f(u^{n+1/2}_{j+1/2}) - f(u^{n+1/2}_{j-1/2}))\n$$\nThis scheme is second-order accurate in both space and time and is conservative, ensuring correct shock speeds.\n\n**Numerical Implementation**\nThe simulation is performed on a uniform grid of $N$ points, $x_j = j \\Delta x$ for $j=0, \\dots, N-1$, with $\\Delta x = 1/N$. Periodic boundary conditions are handled by wrapping around the indices, for instance, the neighbor of cell $N-1$ is cell $0$.\n\nThe time step $\\Delta t$ is adaptive, recalculated at each iteration to satisfy the Courant-Friedrichs-Lewy (CFL) stability condition:\n$$\n\\max|f'(u^n)| \\frac{\\Delta t}{\\Delta x} \\leq \\mathrm{CFL}\n$$\nWith $f'(u) = u$ and $\\mathrm{CFL} = 0.9$, the time step is:\n$$\n\\Delta t = 0.9 \\frac{\\Delta x}{\\max_j |u^n_j|}\n$$\nThe simulation runs from $t=0$ to the final time $T=0.2$. The last time step is adjusted to end exactly at $T$.\n\n**Overshoot Calculation**\nOnce the final solution $u(x,T)$ is obtained, the overshoot magnitude $\\mathcal{O}$ is calculated. It is defined as the maximum violation of the initial data range $[u_{\\min}, u_{\\max}] = [0,1]$. Given the problem's definition:\n$$\n\\mathcal{O} = \\max\\left( \\max_x\\left( u(x,T) - u_{\\max} \\right), \\max_x\\left( u_{\\min} - u(x,T) \\right) \\right)\n$$\nwhere negative values inside the maxima are treated as $0$. This is equivalent to:\n$$\n\\mathcal{O} = \\max\\left( 0.0, \\max_x(u(x,T)) - 1.0, 0.0 - \\min_x(u(x,T)) \\right)\n$$\nThis formula computes the largest deviation above $u_{\\max}=1$ or below $u_{\\min}=0$.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_overshoot(N, nu, T_final=0.2, CFL=0.9):\n    \"\"\"\n    Solves the 1D inviscid Burgers' equation using the two-step Lax-Wendroff scheme\n    and computes the overshoot magnitude at a final time.\n\n    Args:\n        N (int): Number of grid points.\n        nu (float): Smoothing parameter for the initial condition.\n        T_final (float): Final time for the simulation.\n        CFL (float): CFL number for stability.\n\n    Returns:\n        float: The computed overshoot magnitude O.\n    \"\"\"\n    # 1. Grid and Initial Condition Setup\n    dx = 1.0 / N\n    # Grid points x_j = j*dx for j = 0, ..., N-1\n    x = np.linspace(0.0, 1.0 - dx, N)\n\n    u_L, u_R, x_0 = 1.0, 0.0, 0.5\n    u = u_R + 0.5 * (u_L - u_R) * (1.0 - np.tanh((x - x_0) / nu))\n\n    # 2. Flux Function\n    def f(u_vec):\n        \"\"\"Flux function for inviscid Burgers' equation.\"\"\"\n        return 0.5 * u_vec**2\n\n    # 3. Time Evolution Loop\n    t = 0.0\n    while t < T_final:\n        # a. Adaptive time step based on CFL condition\n        # f'(u) = u, so max|f'(u)| is max|u|\n        max_speed = np.max(np.abs(u))\n        if max_speed < 1e-12: # Avoid division by zero if solution is trivial\n            dt = CFL * dx \n        else:\n            dt = CFL * dx / max_speed\n\n        # Ensure the final time step lands exactly on T_final\n        if t + dt > T_final:\n            dt = T_final - t\n        \n        # b. Two-Step Lax-Wendroff Scheme\n        # Periodic boundary conditions are handled by np.roll\n        \n        # Step 1: Predictor (calculates u at half-steps j+1/2)\n        # u_jp1 corresponds to u at index j+1\n        u_jp1 = np.roll(u, -1)\n        f_u = f(u)\n        f_u_jp1 = f(u_jp1)\n        u_half = 0.5 * (u_jp1 + u) - (dt / (2.0 * dx)) * (f_u_jp1 - f_u)\n\n        # Step 2: Corrector (updates u at grid points j)\n        f_half = f(u_half)\n        # f_half_jm1 corresponds to flux at half-step j-1/2\n        f_half_jm1 = np.roll(f_half, 1)\n        u = u - (dt / dx) * (f_half - f_half_jm1)\n\n        t += dt\n\n    # 4. Overshoot Calculation\n    u_max_range = 1.0\n    u_min_range = 0.0\n    \n    # Positive overshoot: max(u) - u_max_range\n    # Negative overshoot magnitude: u_min_range - min(u)\n    overshoot_pos = np.max(u) - u_max_range\n    overshoot_neg = u_min_range - np.min(u)\n    \n    # The magnitude is the larger of the two, or 0 if within range\n    overshoot_magnitude = np.max([0.0, overshoot_pos, overshoot_neg])\n\n    return overshoot_magnitude\n\ndef solve():\n    \"\"\"\n    Runs the simulation for all test cases and prints the results\n    in the specified format.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (256, 0.05),     # Case 1\n        (512, 0.05),     # Case 2\n        (1024, 0.05),    # Case 3\n        (512, 0.02),     # Case 4\n        (512, 0.10),     # Case 5\n        (128, 0.01),     # Case 6\n    ]\n\n    results = []\n    for N, nu in test_cases:\n        result = compute_overshoot(N=N, nu=nu)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    # The format specifier ensures high precision floating-point representation.\n    print(f\"[{','.join(f'{r:.15f}' for r in results)}]\")\n\nsolve()\n```", "id": "3375643"}]}