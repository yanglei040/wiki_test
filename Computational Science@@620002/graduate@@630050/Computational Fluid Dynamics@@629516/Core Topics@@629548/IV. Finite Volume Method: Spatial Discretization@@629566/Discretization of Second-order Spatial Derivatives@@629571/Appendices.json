{"hands_on_practices": [{"introduction": "The foundation of finite difference methods is the approximation of derivatives using values at discrete grid points. The method of undetermined coefficients, which leverages Taylor series expansions, offers a systematic procedure for deriving the weights of a numerical stencil to achieve any desired order of accuracy. This exercise builds a core skill by walking you through the construction of a custom, high-order accurate discretization scheme from first principles, a task essential for developing and understanding advanced numerical methods [@problem_id:3311335].", "problem": "Consider a smooth scalar field $u(x)$ that is at least eight times continuously differentiable on an interval, sampled on a uniform grid $x_i = x_0 + i h$ with grid spacing $h > 0$. In Computational Fluid Dynamics (CFD), high-order accurate discretizations of spatial derivatives are essential for reducing numerical dispersion and dissipation. Using the method of undetermined coefficients starting from the Taylor series expansion of $u(x)$ about $x_i$, construct a seven-point symmetric finite-difference approximation to the second derivative $u''(x_i)$ on the stencil $\\{x_{i-3}, x_{i-2}, x_{i-1}, x_i, x_{i+1}, x_{i+2}, x_{i+3}\\}$ that achieves a formal truncation error of order $\\mathcal{O}(h^6)$.\n\nAssume the approximation has the form\n$$\n\\frac{1}{h^2}\\bigl[a_0\\,u(x_i) + a_1\\bigl(u(x_{i+1}) + u(x_{i-1})\\bigr) + a_2\\bigl(u(x_{i+2}) + u(x_{i-2})\\bigr) + a_3\\bigl(u(x_{i+3}) + u(x_{i-3})\\bigr)\\bigr],\n$$\nwhere $a_0, a_1, a_2, a_3$ are real coefficients to be determined such that the approximation targets $u''(x_i)$ and cancels all lower-order error terms consistent with a formal $\\mathcal{O}(h^6)$ truncation error. Begin from first principles by expanding $u(x_{i \\pm m})$ in Taylor series about $x_i$ and impose the necessary consistency and accuracy conditions implied by the definition of the second derivative.\n\nExpress your final answer as a single row matrix containing the four stencil weights $(a_0, a_1, a_2, a_3)$ corresponding respectively to the coefficients of $u(x_i)$, $u(x_{i\\pm 1})$, $u(x_{i\\pm 2})$, and $u(x_{i\\pm 3})$. No rounding is required; provide exact values. The normalization is such that the discrete operator is the above weighted sum multiplied by $1/h^2$, so do not include the factor $1/h^2$ in your row matrix.", "solution": "The user wants to find a seven-point symmetric finite-difference approximation for the second derivative $u''(x_i)$ with a truncation error of $\\mathcal{O}(h^6)$.\n\nThe problem is first validated to ensure it is scientifically sound, well-posed, and complete.\n\n### Step 1: Extract Givens\n- **Scalar Field**: $u(x)$, at least eight times continuously differentiable ($u \\in C^8$).\n- **Grid**: Uniform, $x_i = x_0 + i h$, with spacing $h > 0$.\n- **Target Derivative**: $u''(x_i)$.\n- **Stencil**: Seven-point symmetric: $\\{x_{i-3}, x_{i-2}, x_{i-1}, x_i, x_{i+1}, x_{i+2}, x_{i+3}\\}$.\n- **Approximation Form**: The discrete operator $D_h^2 u_i$ is given by\n$$D_h^2 u_i = \\frac{1}{h^2}\\bigl[a_0\\,u(x_i) + a_1\\bigl(u(x_{i+1}) + u(x_{i-1})\\bigr) + a_2\\bigl(u(x_{i+2}) + u(x_{i-2})\\bigr) + a_3\\bigl(u(x_{i+3}) + u(x_{i-3})\\bigr)\\bigr]$$\n- **Accuracy Requirement**: The truncation error $T = D_h^2 u_i - u''(x_i)$ must be of order $\\mathcal{O}(h^6)$.\n- **Method**: Method of undetermined coefficients using Taylor series expansions.\n- **Coefficients to find**: $a_0, a_1, a_2, a_3$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is a standard exercise in numerical analysis for deriving high-order finite difference schemes. The method of undetermined coefficients is the appropriate technique for this task. The problem specifies a smooth function ($C^8$), a symmetric stencil, and a target order of accuracy, providing a complete and consistent set of constraints to uniquely determine the four unknown coefficients. The problem is scientifically grounded, well-posed, objective, and contains no ambiguities or contradictions.\n\n### Step 3: Verdict and Action\nThe problem is valid. The solution will now be derived.\n\nTo construct the finite difference formula, we use the method of undetermined coefficients. This involves expanding each term $u(x_{i \\pm m})$ in a Taylor series around the point $x_i$. Let $u_i = u(x_i)$ and $u_i^{(k)} = \\frac{d^k u}{dx^k}\\bigr|_{x=x_i}$.\nThe Taylor series expansions for $u(x_{i+m}) = u(x_i + mh)$ and $u(x_{i-m}) = u(x_i - mh)$ are:\n$$u(x_{i+m}) = u_i + (mh)u_i^{(1)} + \\frac{(mh)^2}{2!}u_i^{(2)} + \\frac{(mh)^3}{3!}u_i^{(3)} + \\frac{(mh)^4}{4!}u_i^{(4)} + \\dots$$\n$$u(x_{i-m}) = u_i - (mh)u_i^{(1)} + \\frac{(mh)^2}{2!}u_i^{(2)} - \\frac{(mh)^3}{3!}u_i^{(3)} + \\frac{(mh)^4}{4!}u_i^{(4)} - \\dots$$\n\nThe specified approximation form uses symmetric pairs $u(x_{i+m}) + u(x_{i-m})$. Summing the two series cancels all odd-order derivative terms:\n$$u(x_{i+m}) + u(x_{i-m}) = 2u_i + \\frac{2(mh)^2}{2!}u_i^{(2)} + \\frac{2(mh)^4}{4!}u_i^{(4)} + \\frac{2(mh)^6}{6!}u_i^{(6)} + \\frac{2(mh)^8}{8!}u_i^{(8)} + \\mathcal{O}(h^{10})$$\nSimplifying the factorial terms, we have:\n$$u(x_{i+m}) + u(x_{i-m}) = 2u_i + (mh)^2 u_i^{(2)} + \\frac{(mh)^4}{12}u_i^{(4)} + \\frac{(mh)^6}{360}u_i^{(6)} + \\frac{(mh)^8}{20160}u_i^{(8)} + \\mathcal{O}(h^{10})$$\nSince the function $u(x)$ is at least $C^8$, this expansion is valid.\n\nNow, we substitute this into the given form of the approximation, which we denote as $L_h(u_i)$:\n$$L_h(u_i) = a_0 u_i + a_1\\bigl(u_{i+1} + u_{i-1}\\bigr) + a_2\\bigl(u_{i+2} + u_{i-2}\\bigr) + a_3\\bigl(u_{i+3} + u_{i-3}\\bigr)$$\nSubstituting the series for $m=1, 2, 3$:\n$$L_h(u_i) = a_0u_i + a_1\\left(2u_i + h^2 u_i^{(2)} + \\frac{h^4}{12}u_i^{(4)} + \\frac{h^6}{360}u_i^{(6)} + \\frac{h^8}{20160}u_i^{(8)} + \\dots \\right)$$\n$$+ a_2\\left(2u_i + (2h)^2 u_i^{(2)} + \\frac{(2h)^4}{12}u_i^{(4)} + \\frac{(2h)^6}{360}u_i^{(6)} + \\frac{(2h)^8}{20160}u_i^{(8)} + \\dots \\right)$$\n$$+ a_3\\left(2u_i + (3h)^2 u_i^{(2)} + \\frac{(3h)^4}{12}u_i^{(4)} + \\frac{(3h)^6}{360}u_i^{(6)} + \\frac{(3h)^8}{20160}u_i^{(8)} + \\dots \\right)$$\n\nWe group the terms by the derivatives of $u_i$:\n$$L_h(u_i) = u_i \\left( a_0 + 2a_1 + 2a_2 + 2a_3 \\right)$$\n$$+ u_i^{(2)} h^2 \\left( a_1 \\cdot 1^2 + a_2 \\cdot 2^2 + a_3 \\cdot 3^2 \\right)$$\n$$+ u_i^{(4)} \\frac{h^4}{12} \\left( a_1 \\cdot 1^4 + a_2 \\cdot 2^4 + a_3 \\cdot 3^4 \\right)$$\n$$+ u_i^{(6)} \\frac{h^6}{360} \\left( a_1 \\cdot 1^6 + a_2 \\cdot 2^6 + a_3 \\cdot 3^6 \\right)$$\n$$+ u_i^{(8)} \\frac{h^8}{20160} \\left( a_1 \\cdot 1^8 + a_2 \\cdot 2^8 + a_3 \\cdot 3^8 \\right) + \\mathcal{O}(h^{10})$$\n\nThe total approximation is $D_h^2 u_i = \\frac{1}{h^2} L_h(u_i)$. We require this to be equal to $u_i^{(2)}$ with a truncation error of $\\mathcal{O}(h^6)$. This means:\n$$\\frac{1}{h^2}L_h(u_i) = u_i^{(2)} + \\mathcal{O}(h^6)$$\nor\n$$L_h(u_i) = h^2 u_i^{(2)} + \\mathcal{O}(h^8)$$\n\nBy comparing the coefficients of the derivatives in the expansion of $L_h(u_i)$ with the target $h^2 u_i^{(2)}$, we obtain a system of linear equations for the coefficients $a_0, a_1, a_2, a_3$:\n1. Coefficient of $u_i$: $a_0 + 2a_1 + 2a_2 + 2a_3 = 0$\n2. Coefficient of $u_i^{(2)} h^2$: $a_1 + 4a_2 + 9a_3 = 1$\n3. Coefficient of $u_i^{(4)} h^4$: $a_1 + 16a_2 + 81a_3 = 0$\n4. Coefficient of $u_i^{(6)} h^6$: $a_1 + 64a_2 + 729a_3 = 0$\n\nWe first solve the $3 \\times 3$ system for $a_1, a_2, a_3$:\nSubtracting equation (2) from (3):\n$$(a_1 + 16a_2 + 81a_3) - (a_1 + 4a_2 + 9a_3) = 0 - 1 \\implies 12a_2 + 72a_3 = -1 \\quad (5)$$\nSubtracting equation (3) from (4):\n$$(a_1 + 64a_2 + 729a_3) - (a_1 + 16a_2 + 81a_3) = 0 - 0 \\implies 48a_2 + 648a_3 = 0$$\nDividing by $48$:\n$$a_2 + \\frac{648}{48}a_3 = 0 \\implies a_2 + \\frac{27}{2}a_3 = 0 \\implies a_2 = -\\frac{27}{2}a_3 \\quad (6)$$\nSubstitute (6) into (5):\n$$12\\left(-\\frac{27}{2}a_3\\right) + 72a_3 = -1$$\n$$-162a_3 + 72a_3 = -1$$\n$$-90a_3 = -1 \\implies a_3 = \\frac{1}{90}$$\nNow, find $a_2$ from (6):\n$$a_2 = -\\frac{27}{2} \\left(\\frac{1}{90}\\right) = -\\frac{27}{180} = -\\frac{3 \\cdot 9}{20 \\cdot 9} = -\\frac{3}{20}$$\nFind $a_1$ from (2):\n$$a_1 = 1 - 4a_2 - 9a_3 = 1 - 4\\left(-\\frac{3}{20}\\right) - 9\\left(\\frac{1}{90}\\right)$$\n$$a_1 = 1 + \\frac{12}{20} - \\frac{9}{90} = 1 + \\frac{3}{5} - \\frac{1}{10}$$\n$$a_1 = \\frac{10}{10} + \\frac{6}{10} - \\frac{1}{10} = \\frac{15}{10} = \\frac{3}{2}$$\nFinally, find $a_0$ from (1):\n$$a_0 = -2(a_1 + a_2 + a_3) = -2\\left(\\frac{3}{2} - \\frac{3}{20} + \\frac{1}{90}\\right)$$\nThe common denominator for the sum is $180$:\n$$a_0 = -2\\left(\\frac{3 \\cdot 90}{180} - \\frac{3 \\cdot 9}{180} + \\frac{1 \\cdot 2}{180}\\right) = -2\\left(\\frac{270 - 27 + 2}{180}\\right)$$\n$$a_0 = -2\\left(\\frac{245}{180}\\right) = -2\\left(\\frac{49 \\cdot 5}{36 \\cdot 5}\\right) = -2\\left(\\frac{49}{36}\\right) = -\\frac{49}{18}$$\n\nThe coefficients are:\n$$a_0 = -\\frac{49}{18}, \\quad a_1 = \\frac{3}{2}, \\quad a_2 = -\\frac{3}{20}, \\quad a_3 = \\frac{1}{90}$$\nThe leading truncation error term is the first non-zero term we did not cancel, which corresponds to the coefficient of $u_i^{(8)}$.\n$$T = \\frac{1}{h^2} \\left( \\frac{h^8}{20160} \\left( a_1 \\cdot 1^8 + a_2 \\cdot 2^8 + a_3 \\cdot 3^8 \\right) u_i^{(8)} + \\dots \\right)$$\n$$T = \\frac{h^6}{20160} \\left( a_1 + 256a_2 + 6561a_3 \\right) u_i^{(8)} + \\mathcal{O}(h^8)$$\nThe coefficient is:\n$$\\frac{3}{2} + 256\\left(-\\frac{3}{20}\\right) + 6561\\left(\\frac{1}{90}\\right) = \\frac{3}{2} - \\frac{192}{5} + \\frac{729}{10} = \\frac{15 - 384 + 729}{10} = \\frac{360}{10} = 36$$\nSo, the truncation error is $T = \\frac{36}{20160}h^6 u_i^{(8)} + \\mathcal{O}(h^8) = \\frac{1}{560}h^6 u_i^{(8)} + \\mathcal{O}(h^8)$. This confirms the order of accuracy is $\\mathcal{O}(h^6)$.\n\nThe final set of coefficients $(a_0, a_1, a_2, a_3)$ is $(-\\frac{49}{18}, \\frac{3}{2}, -\\frac{3}{20}, \\frac{1}{90})$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-\\frac{49}{18} & \\frac{3}{2} & -\\frac{3}{20} & \\frac{1}{90}\n\\end{pmatrix}\n}\n$$", "id": "3311335"}, {"introduction": "While formal order of accuracy describes a scheme's performance as the grid spacing $h$ approaches zero, it doesn't tell the whole story for practical simulations on finite grids. Spectral analysis, using the concept of a modified wavenumber, provides a more powerful tool by revealing how a discrete operator resolves different wavelengths present in the solution. This practice moves beyond local truncation error to compare the performance of explicit and compact schemes, offering a deeper understanding of numerical dispersion and dissipation—critical factors in selecting schemes for turbulence or wave propagation simulations [@problem_id:3311379].", "problem": "A one-dimensional, periodic domain of length $L$ is discretized by a uniform grid with spacing $h$ and nodes $x_j = j h$, where $j$ is an integer and $N h = L$ for some integer $N$. In computational fluid dynamics (CFD), the spectral resolution of discrete operators is assessed by their action on Fourier modes. Consider a grid function $u_j = \\exp(i k x_j)$ with continuous wavenumber $k$ and define the nondimensional wavenumber $\\theta = k h \\in [0,\\pi]$. For such a Fourier mode, any linear, translation-invariant discrete approximation to the second spatial derivative produces a response of the form $D(\\theta) u_j$, where $D(\\theta)$ is the discrete Fourier symbol of the operator. The continuous second derivative yields $-k^2 u_j$, so one defines a modified wavenumber $k_*$ via $D(\\theta) = -k_*^2$ and uses the ratio $(k_* h)^2 / \\theta^2$ as a measure of spectral resolution.\n\nTwo fourth-order accurate approximations of the second derivative are considered:\n\n(1) An explicit, centered, five-point stencil:\napply the operator\n$$\n\\frac{-\\frac{1}{12} u_{j-2} + \\frac{4}{3} u_{j-1} - \\frac{5}{2} u_j + \\frac{4}{3} u_{j+1} - \\frac{1}{12} u_{j+2}}{h^2}.\n$$\n\n(2) A compact, centered, tridiagonal scheme in which the discrete second derivative values $u''_j$ satisfy\n$$\n\\alpha\\, u''_{j-1} + u''_j + \\alpha\\, u''_{j+1} \\;=\\; \\frac{c}{h^2}\\,\\big(u_{j-1} - 2 u_j + u_{j+1}\\big),\n$$\nwhere the coefficients $\\alpha$ and $c$ are chosen so that the formal truncation error is $\\mathcal{O}(h^4)$.\n\nUsing Taylor-series consistency to determine $\\alpha$ and $c$, and discrete Fourier analysis on a periodic grid to derive the modified wavenumbers for each scheme, compare their spectral resolution by evaluating the ratios $(k_* h)^2 / \\theta^2$ at the representative wavenumbers $\\theta = \\pi/2$ and $\\theta = \\pi$. Which of the following statements is correct?\n\nA. On a periodic uniform grid, the fourth-order compact scheme with $\\alpha = \\frac{1}{10}$ and $c = \\frac{6}{5}$ has Fourier symbol $-k_c^2$ with\n$$\n(k_c h)^2 \\;=\\; \\frac{12}{5}\\,\\frac{1 - \\cos \\theta}{1 + \\frac{1}{5} \\cos \\theta},\n$$\nwhich yields $(k_c h)^2/\\theta^2$ closer to $1$ than that of the explicit five-point stencil whose\n$$\n(k_e h)^2 \\;=\\; \\frac{8}{3}\\,(1 - \\cos \\theta)\\;-\\;\\frac{1}{6}\\,(1 - \\cos 2\\theta),\n$$\nover $\\theta \\in [0,\\pi]$ (for example, at $\\theta = \\pi/2$ the ratios are approximately $0.973$ versus $0.946$, and at $\\theta = \\pi$ they are $0.608$ versus $0.540$).\n\nB. The explicit five-point stencil exactly reproduces the continuous second derivative at the Nyquist frequency $\\theta = \\pi$, i.e., $(k_e h)^2 = \\pi^2$, while the compact scheme underestimates it.\n\nC. Both schemes have identical small-wavenumber error in $(k_* h)^2 = \\theta^2 - C\\,\\theta^6 + \\mathcal{O}(\\theta^8)$ with $C = \\frac{1}{180}$, implying no spectral-resolution advantage at low wavenumbers.\n\nD. The compact scheme’s denominator $1 + \\frac{1}{5} \\cos \\theta$ vanishes for some $\\theta \\in (0,\\pi)$ on a periodic grid, causing loss of ellipticity and a non-real modified wavenumber.", "solution": "The user has provided a problem on the spectral analysis of two finite difference schemes for the second spatial derivative. I will first validate the problem statement and then proceed to a full solution, including the evaluation of each option.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n\n*   Domain: 1D, periodic, length $L$.\n*   Grid: Uniform, spacing $h$, nodes $x_j = j h$, $N h = L$.\n*   Test function: Grid function $u_j = \\exp(i k x_j)$, continuous wavenumber $k$.\n*   Nondimensional wavenumber: $\\theta = k h \\in [0,\\pi]$.\n*   Discrete operator response: $D(\\theta) u_j$.\n*   Modified wavenumber $k_*$: $D(\\theta) = -k_*^2$.\n*   Spectral resolution measure: Ratio $(k_* h)^2 / \\theta^2$.\n*   Scheme (1), explicit 5-point: $\\frac{-\\frac{1}{12} u_{j-2} + \\frac{4}{3} u_{j-1} - \\frac{5}{2} u_j + \\frac{4}{3} u_{j+1} - \\frac{1}{12} u_{j+2}}{h^2}$.\n*   Scheme (2), compact tridiagonal: $\\alpha\\, u''_{j-1} + u''_j + \\alpha\\, u''_{j+1} \\;=\\; \\frac{c}{h^2}\\,\\big(u_{j-1} - 2 u_j + u_{j+1}\\big)$, with $\\alpha, c$ chosen for $\\mathcal{O}(h^4)$ formal truncation error.\n\nThe task is to determine $\\alpha$ and $c$, find the modified wavenumbers for both schemes, and compare their spectral resolution at $\\theta = \\pi/2$ and $\\theta = \\pi$.\n\n**Step 2: Validate Using Extracted Givens**\n\n*   **Scientifically Grounded:** The problem is a standard exercise in the field of numerical analysis, specifically for computational fluid dynamics (CFD). The concepts of finite differences, Taylor series analysis, truncation error, and discrete Fourier analysis (or von Neumann analysis) are fundamental and well-established principles.\n*   **Well-Posed:** The problem is clearly defined. It requires the determination of unknown coefficients using a specified method (Taylor-series consistency), the derivation of analytical expressions (modified wavenumbers), and a quantitative comparison based on these expressions. A unique solution exists.\n*   **Objective:** The problem is stated using precise, objective mathematical language. It is free from ambiguity and subjective claims.\n*   **Completeness:** All necessary information, including the stencil coefficients for the explicit scheme and the symbolic form of the compact scheme, is provided. The criterion for determining the unknown coefficients for the compact scheme is also clearly stated.\n\n**Step 3: Verdict and Action**\n\nThe problem statement is valid. It is scientifically sound, well-posed, objective, and self-contained. I will now proceed with the solution.\n\n### Solution\n\nThe solution involves three main steps: (1) determining the coefficients for the compact scheme, (2) deriving the modified wavenumber for each scheme, and (3) comparing their spectral resolution ratios $(k_*h)^2/\\theta^2$.\n\n**1. Determine Coefficients for the Compact Scheme (Scheme 2)**\n\nThe scheme is given by $\\alpha\\, u''_{j-1} + u''_j + \\alpha\\, u''_{j+1} = \\frac{c}{h^2}(u_{j-1} - 2u_j + u_{j+1})$. To find the coefficients $\\alpha$ and $c$ that yield fourth-order accuracy, we analyze the truncation error. This is done by substituting the exact solution $u(x)$ and its derivatives into the scheme and expanding all terms in a Taylor series around $x_j$.\n\nLet $T_j$ be the truncation error:\n$$ T_j = \\left( \\alpha u''(x_{j-1}) + u''(x_j) + \\alpha u''(x_{j+1}) \\right) - \\frac{c}{h^2}\\left( u(x_{j-1}) - 2u(x_j) + u(x_{j+1}) \\right) $$\nWe expand the terms around $x_j$:\n$u(x_{j\\pm 1}) = u(x_j) \\pm h u'(x_j) + \\frac{h^2}{2}u''(x_j) \\pm \\frac{h^3}{6}u'''(x_j) + \\frac{h^4}{24}u''''(x_j) + \\frac{h^6}{720}u^{(6)}(x_j) + \\mathcal{O}(h^8)$\n$u''(x_{j\\pm 1}) = u''(x_j) \\pm h u'''(x_j) + \\frac{h^2}{2}u''''(x_j) \\pm \\frac{h^3}{6}u^{(5)}(x_j) + \\frac{h^4}{24}u^{(6)}(x_j) + \\mathcal{O}(h^6)$\n\nThe right-hand side (RHS) term becomes:\n$$ \\frac{c}{h^2} \\left( h^2 u'' + \\frac{h^4}{12}u'''' + \\frac{h^6}{360}u^{(6)} + \\mathcal{O}(h^8) \\right) = c \\left( u'' + \\frac{h^2}{12}u'''' + \\frac{h^4}{360}u^{(6)} + \\mathcal{O}(h^6) \\right) $$\nThe left-hand side (LHS) term becomes:\n$$ \\alpha(2u'' + h^2 u'''' + \\frac{h^4}{12}u^{(6)} + \\mathcal{O}(h^6)) + u'' = (1+2\\alpha)u'' + \\alpha h^2 u'''' + \\frac{\\alpha h^4}{12}u^{(6)} + \\mathcal{O}(h^6) $$\nEquating the expanded LHS and RHS inside the definition of $T_j$:\n$$ T_j = (1+2\\alpha-c)u'' + (\\alpha - \\frac{c}{12})h^2 u'''' + (\\frac{\\alpha}{12} - \\frac{c}{360})h^4 u^{(6)} + \\mathcal{O}(h^6) $$\nFor fourth-order accuracy ($\\mathcal{O}(h^4)$), the coefficients of $u''$ and $u''''$ must be zero.\n1.  Term in $u''$: $1+2\\alpha-c=0 \\implies c = 1+2\\alpha$\n2.  Term in $h^2 u''''$: $\\alpha - \\frac{c}{12} = 0 \\implies c = 12\\alpha$\n\nSolving this system of equations: $12\\alpha = 1+2\\alpha \\implies 10\\alpha = 1 \\implies \\alpha = \\frac{1}{10}$.\nThen $c = 12\\alpha = \\frac{12}{10} = \\frac{6}{5}$.\nThese values match the ones provided in option A.\n\n**2. Derive Modified Wavenumbers**\n\nFor a grid function $u_j = e^{ikx_j} = e^{ikjh}$, a discrete operator approximating the second derivative gives $L_h u_j = D(\\theta) u_j = -k_*^2 u_j$, where $\\theta=kh$.\n\n**Scheme (1): Explicit 5-point**\nThe operator is $L_e u_j = \\frac{1}{h^2} (-\\frac{1}{12} u_{j-2} + \\frac{4}{3} u_{j-1} - \\frac{5}{2} u_j + \\frac{4}{3} u_{j+1} - \\frac{1}{12} u_{j+2})$.\nApplying this to $u_j=e^{ikjh}$:\n$$ L_e u_j = \\frac{u_j}{h^2} \\left( -\\frac{1}{12}e^{-i2\\theta} + \\frac{4}{3}e^{-i\\theta} - \\frac{5}{2} + \\frac{4}{3}e^{i\\theta} - \\frac{1}{12}e^{i2\\theta} \\right) $$\n$$ -k_e^2 = \\frac{1}{h^2} \\left( \\frac{8}{3}\\cos\\theta - \\frac{1}{6}\\cos(2\\theta) - \\frac{5}{2} \\right) $$\n$$(k_e h)^2 = -\\left( \\frac{8}{3}\\cos\\theta - \\frac{1}{6}\\cos(2\\theta) - \\frac{5}{2} \\right) = \\frac{5}{2} - \\frac{8}{3}\\cos\\theta + \\frac{1}{6}\\cos(2\\theta) $$\nTo match the form in option A, we use $1 = 1$:\n$$ (k_e h)^2 = \\left(\\frac{8}{3} - \\frac{1}{6}\\right) - \\frac{8}{3}\\cos\\theta + \\frac{1}{6}\\cos(2\\theta) = \\frac{8}{3}(1-\\cos\\theta) - \\frac{1}{6}(1-\\cos(2\\theta)) $$\nThe expression for $(k_e h)^2$ in option A is correct.\n\n**Scheme (2): Compact Tridiagonal**\nThe scheme is $\\alpha u''_{j-1} + u''_j + \\alpha u''_{j+1} = \\frac{c}{h^2}(u_{j-1} - 2u_j + u_{j+1})$.\nSubstitute $u_j = e^{ikjh}$ and $u''_j = -k_c^2 u_j$:\n$$ \\alpha(-k_c^2)e^{ik(j-1)h} + (-k_c^2)e^{ikjh} + \\alpha(-k_c^2)e^{ik(j+1)h} = \\frac{c}{h^2}(e^{ik(j-1)h} - 2e^{ikjh} + e^{ik(j+1)h}) $$\nDivide by $e^{ikjh}$:\n$$ -k_c^2 (\\alpha e^{-i\\theta} + 1 + \\alpha e^{i\\theta}) = \\frac{c}{h^2}(e^{-i\\theta} - 2 + e^{i\\theta}) $$\n$$ -k_c^2 (1 + 2\\alpha\\cos\\theta) = \\frac{c}{h^2}(2\\cos\\theta - 2) = -\\frac{2c}{h^2}(1-\\cos\\theta) $$\n$$(k_c h)^2 = \\frac{2c(1-\\cos\\theta)}{1+2\\alpha\\cos\\theta} $$\nSubstitute $\\alpha=1/10$ and $c=6/5$:\n$$ (k_c h)^2 = \\frac{2(6/5)(1-\\cos\\theta)}{1+2(1/10)\\cos\\theta} = \\frac{\\frac{12}{5}(1-\\cos\\theta)}{1+\\frac{1}{5}\\cos\\theta} $$\nThis expression for $(k_c h)^2$ also matches that in option A.\n\n**3. Comparison of Spectral Resolution Ratios ($R(\\theta) = (k_*h)^2/\\theta^2$)**\n\nAn ideal scheme would give $(k_*h)^2 = \\theta^2$, so $R(\\theta) = 1$.\n\n**At\n$\\theta = \\pi/2$:**\n*   Ideal Value: $\\theta^2 = (\\pi/2)^2 \\approx 2.4674$.\n*   Scheme (1), Explicit: $(k_e h)^2 = \\frac{8}{3}(1-\\cos(\\frac{\\pi}{2})) - \\frac{1}{6}(1-\\cos(\\pi)) = \\frac{8}{3}(1) - \\frac{1}{6}(1 - (-1)) = \\frac{8}{3} - \\frac{2}{6} = \\frac{8}{3} - \\frac{1}{3} = \\frac{7}{3} \\approx 2.3333$.\n    $R_e(\\pi/2) = \\frac{7/3}{(\\pi/2)^2} = \\frac{28}{3\\pi^2} \\approx 0.9457$.\n*   Scheme (2), Compact: $(k_c h)^2 = \\frac{12/5(1-\\cos(\\frac{\\pi}{2}))}{1+1/5\\cos(\\frac{\\pi}{2})} = \\frac{12/5(1)}{1} = \\frac{12}{5} = 2.4$.\n    $R_c(\\pi/2) = \\frac{12/5}{(\\pi/2)^2} = \\frac{48}{5\\pi^2} \\approx 0.9727$.\n\nAt $\\theta=\\pi/2$, $R_c \\approx 0.973$ is closer to $1$ than $R_e \\approx 0.946$.\n\n**At\n$\\theta = \\pi$:**\n*   Ideal Value: $\\theta^2 = \\pi^2 \\approx 9.8696$.\n*   Scheme (1), Explicit: $(k_e h)^2 = \\frac{8}{3}(1-\\cos\\pi) - \\frac{1}{6}(1-\\cos(2\\pi)) = \\frac{8}{3}(2) - \\frac{1}{6}(0) = \\frac{16}{3} \\approx 5.3333$.\n    $R_e(\\pi) = \\frac{16/3}{\\pi^2} = \\frac{16}{3\\pi^2} \\approx 0.5404$.\n*   Scheme (2), Compact: $(k_c h)^2 = \\frac{12/5(1-\\cos\\pi)}{1+1/5\\cos\\pi} = \\frac{12/5(2)}{1-1/5} = \\frac{24/5}{4/5} = 6$.\n    $R_c(\\pi) = \\frac{6}{\\pi^2} \\approx 0.6079$.\n\nAt $\\theta=\\pi$, $R_c \\approx 0.608$ is closer to $1$ than $R_e \\approx 0.540$.\n\n**Analysis of Options**\n\n*   **A. On a periodic uniform grid, the fourth-order compact scheme with $\\alpha = \\frac{1}{10}$ and $c = \\frac{6}{5}$ has Fourier symbol $-k_c^2$ with $(k_c h)^2 = \\frac{12}{5}\\,\\frac{1 - \\cos \\theta}{1 + \\frac{1}{5} \\cos \\theta}$, which yields $(k_c h)^2/\\theta^2$ closer to $1$ than that of the explicit five-point stencil whose $(k_e h)^2 = \\frac{8}{3}\\,(1 - \\cos \\theta)\\;-\\;\\frac{1}{6}\\,(1 - \\cos 2\\theta)$, over $\\theta \\in [0,\\pi]$ (for example, at $\\theta = \\pi/2$ the ratios are approximately $0.973$ versus $0.946$, and at $\\theta = \\pi$ they are $0.608$ versus $0.540$).**\n    Our derivations have confirmed that the coefficients $\\alpha$ and $c$ are correct for a fourth-order scheme. The formulas for $(k_e h)^2$ and $(k_c h)^2$ are correct. The numerical examples at $\\theta=\\pi/2$ and $\\theta=\\pi$ are correct, and they support the claim that the compact scheme has better spectral resolution (ratio closer to $1$). This statement is entirely consistent with our detailed analysis.\n    **Verdict: Correct.**\n\n*   **B. The explicit five-point stencil exactly reproduces the continuous second derivative at the Nyquist frequency $\\theta = \\pi$, i.e., $(k_e h)^2 = \\pi^2$, while the compact scheme underestimates it.**\n    At $\\theta=\\pi$, the exact operator gives $-k^2 = -(\\pi/h)^2$, so the ideal modified wavenumber squared is $(kh)^2=\\pi^2$. We calculated that for the explicit scheme, $(k_e h)^2 = 16/3 \\approx 5.33$, which is not equal to $\\pi^2 \\approx 9.87$. The statement is false.\n    **Verdict: Incorrect.**\n\n*   **C. Both schemes have identical small-wavenumber error in $(k_* h)^2 = \\theta^2 - C\\,\\theta^6 + \\mathcal{O}(\\theta^8)$ with $C = \\frac{1}{180}$, implying no spectral-resolution advantage at low wavenumbers.**\n    We can find the leading error term by Taylor expanding the expressions for $(k_* h)^2$ for small $\\theta$.\n    For the explicit scheme: $(k_e h)^2 = \\theta^2 - \\frac{1}{90}\\theta^6 + \\mathcal{O}(\\theta^8)$. So $C_e = 1/90$.\n    For the compact scheme: $(k_c h)^2 = \\theta^2 - \\frac{1}{240}\\theta^6 + \\mathcal{O}(\\theta^8)$. So $C_c = 1/240$.\n    The error coefficients are not identical, and neither is equal to $1/180$. The compact scheme has a smaller leading error coefficient, giving it a spectral-resolution advantage at low wavenumbers.\n    **Verdict: Incorrect.**\n\n*   **D. The compact scheme’s denominator $1 + \\frac{1}{5} \\cos \\theta$ vanishes for some $\\theta \\in (0,\\pi)$ on a periodic grid, causing loss of ellipticity and a non-real modified wavenumber.**\n    The denominator is $1 + \\frac{1}{5}\\cos\\theta$. For this to be zero, we need $\\cos\\theta = -5$. Since the range of the cosine function is $[-1, 1]$, there is no real value of $\\theta$ for which this condition is met. The denominator is always strictly positive, ranging from $1+1/5=6/5$ at $\\theta=0$ to $1-1/5=4/5$ at $\\theta=\\pi$. Therefore, it never vanishes.\n    **Verdict: Incorrect.**\n\nBased on the detailed analysis, only option A is correct.", "answer": "$$\\boxed{A}$$", "id": "3311379"}, {"introduction": "Real-world fluid dynamics problems rarely conform to simple Cartesian domains, necessitating the use of complex, body-fitted curvilinear grids. Discretizing differential operators on these grids requires careful handling of geometric transformation terms to ensure physical consistency. A key benchmark for any robust CFD solver is \"freestream preservation\"—the principle that a uniform flow should remain exactly undisturbed by the numerical scheme. This coding exercise provides hands-on experience implementing a conservative Laplacian on a mapped grid and verifying this crucial property, which is tied to the satisfaction of discrete geometric identities known as metric identities [@problem_id:3311337].", "problem": "Consider a two-dimensional curvilinear mapping from computational coordinates $(\\xi,\\eta)$ to physical coordinates $(x,y)$ with smooth, invertible functions $x(\\xi,\\eta)$ and $y(\\xi,\\eta)$. In Computational Fluid Dynamics (CFD), freestream preservation for viscous fluxes requires that the discretized second-order spatial derivative operator, specifically the Laplacian $\\nabla^2 u$, vanishes for constant $u$ even on mapped grids. Starting from the definitions of the Jacobian determinant and the contravariant basis vectors, construct a second-order accurate finite difference discretization of the Laplacian in conservative flux form on a uniform, periodic computational grid. The discretization must be expressed in computational space $(\\xi,\\eta)$ and must be consistent with discrete metric identities.\n\nYou are to implement the following steps:\n\n1. Define a uniform periodic grid in computational space $(\\xi,\\eta)$ with $N_\\xi$ points in the $\\xi$-direction and $N_\\eta$ points in the $\\eta$-direction, with spacings $\\Delta \\xi$ and $\\Delta \\eta$, respectively. Use $\\Delta \\xi = 1/N_\\xi$ and $\\Delta \\eta = 1/N_\\eta$, and let grid nodes be located at $(\\xi_i,\\eta_j) = (i/N_\\xi, j/N_\\eta)$ for integers $i$ and $j$. All trigonometric functions must use angles in radians.\n\n2. For each mapping, compute the discrete partial derivatives $x_\\xi$, $x_\\eta$, $y_\\xi$, and $y_\\eta$ using second-order centered differences with periodic boundaries. Construct the discrete Jacobian $J = x_\\xi y_\\eta - x_\\eta y_\\xi$. Compute the contravariant components $(\\xi_x, \\xi_y)$ and $(\\eta_x, \\eta_y)$ using $J$.\n\n3. Using the contravariant components, build the contravariant metric coefficients $g^{11}$, $g^{22}$, and $g^{12}$ from first principles. Then construct the conservative flux-form Laplacian operator applied to a constant scalar field $u$ on the mapped grid using second-order centered differences with periodic boundaries.\n\n4. Verify the discrete metric identities by evaluating the discrete divergence of $(J \\xi_x, J \\eta_x)$ and $(J \\xi_y, J \\eta_y)$ with the same second-order centered differences. Report the maximum absolute value over the grid of these divergences aggregated into a single scalar per test case.\n\n5. Apply your discretization to a constant scalar field $u = u_0$ with $u_0$ any fixed nonzero constant. For each test case, compute the maximum absolute value over the grid of the discrete Laplacian of $u$.\n\nYour program must implement the above using the following mapping definitions and grid sizes as a test suite:\n\n- Test Case 1 (baseline identity mapping):\n  - Mapping: $x(\\xi,\\eta) = \\xi$, $y(\\xi,\\eta) = \\eta$.\n  - Grid: $N_\\xi = 33$, $N_\\eta = 33$.\n\n- Test Case 2 (smooth wavy mapping):\n  - Mapping: $x(\\xi,\\eta) = \\xi + a \\sin(2\\pi \\xi)\\sin(2\\pi \\eta)$, $y(\\xi,\\eta) = \\eta + a \\cos(2\\pi \\xi)\\sin(2\\pi \\eta)$, with $a = 0.2$.\n  - Grid: $N_\\xi = 65$, $N_\\eta = 64$.\n\n- Test Case 3 (shear mapping):\n  - Mapping: $x(\\xi,\\eta) = \\xi + s \\eta$, $y(\\xi,\\eta) = \\eta$, with $s = 0.3$.\n  - Grid: $N_\\xi = 32$, $N_\\eta = 31$.\n\n- Test Case 4 (streamwise stretch mapping):\n  - Mapping: $x(\\xi,\\eta) = \\xi$, $y(\\xi,\\eta) = \\eta + b \\sin(\\pi \\xi)$, with $b = 0.45$.\n  - Grid: $N_\\xi = 40$, $N_\\eta = 40$.\n\nFor each test case, compute two quantities:\n- The maximum absolute discrete metric identity residual $R_{\\text{metric}} = \\max \\left( \\left| \\partial_\\xi (J \\xi_x) + \\partial_\\eta (J \\eta_x) \\right|, \\left| \\partial_\\xi (J \\xi_y) + \\partial_\\eta (J \\eta_y) \\right| \\right)$ evaluated with second-order centered differences.\n- The maximum absolute discrete Laplacian $R_{\\Delta} = \\max \\left| \\nabla^2 u \\right|$ of the constant field $u = u_0$ computed with your conservative flux-form discretization.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, ordered as $[R_{\\text{metric}}^{(1)}, R_{\\Delta}^{(1)}, R_{\\text{metric}}^{(2)}, R_{\\Delta}^{(2)}, R_{\\text{metric}}^{(3)}, R_{\\Delta}^{(3)}, R_{\\text{metric}}^{(4)}, R_{\\Delta}^{(4)}]$, where the superscript denotes the test case index.\n\nAll quantities are dimensionless, and angles are in radians. The outputs must be real numbers (floats). No external input is permitted, and the computation must be self-contained.", "solution": "The user wants to validate and solve a computational fluid dynamics problem concerning freestream preservation on curvilinear grids.\n\n### Step 1: Extract Givens\n- **Task**: Discretize the Laplacian operator $\\nabla^2 u$ in conservative form on a 2D curvilinear grid and verify freestream preservation and discrete metric identities.\n- **Coordinates**: Computational $(\\xi, \\eta)$ map to physical $(x, y)$ via smooth, invertible functions $x(\\xi, \\eta)$ and $y(\\xi, \\eta)$.\n- **Grid**: Uniform, periodic computational grid.\n  - Size: $N_\\xi \\times N_\\eta$ points.\n  - Spacing: $\\Delta \\xi = 1/N_\\xi$, $\\Delta \\eta = 1/N_\\eta$.\n  - Node locations: $(\\xi_i, \\eta_j) = (i/N_\\xi, j/N_\\eta)$.\n- **Discretization Method**: Second-order centered differences with periodic boundaries for all spatial derivatives.\n- **Quantities to Compute**:\n  1. Discrete partial derivatives: $x_\\xi, x_\\eta, y_\\xi, y_\\eta$.\n  2. Discrete Jacobian: $J = x_\\xi y_\\eta - x_\\eta y_\\xi$.\n  3. Contravariant components: $(\\xi_x, \\xi_y, \\eta_x, \\eta_y)$ using $J$.\n  4. Contravariant metric coefficients: $g^{11}, g^{22}, g^{12}$.\n  5. The maximum absolute discrete metric identity residual, $R_{\\text{metric}}$:\n     $$ R_{\\text{metric}} = \\max \\left( \\max_{\\text{grid}} \\left| \\partial_\\xi (J \\xi_x) + \\partial_\\eta (J \\eta_x) \\right|, \\max_{\\text{grid}} \\left| \\partial_\\xi (J \\xi_y) + \\partial_\\eta (J \\eta_y) \\right| \\right) $$\n     where derivatives are discrete.\n  6. The maximum absolute value of the discrete Laplacian of a constant field $u = u_0$, $R_{\\Delta}$:\n     $$ R_{\\Delta} = \\max_{\\text{grid}} \\left| \\nabla^2 u_0 \\right| $$\n- **Test Cases**:\n  1. **Identity Mapping**: $x(\\xi,\\eta) = \\xi$, $y(\\xi,\\eta) = \\eta$. Grid: $N_\\xi = 33, N_\\eta = 33$.\n  2. **Wavy Mapping**: $x(\\xi,\\eta) = \\xi + a \\sin(2\\pi \\xi)\\sin(2\\pi \\eta)$, $y(\\xi,\\eta) = \\eta + a \\cos(2\\pi \\xi)\\sin(2\\pi \\eta)$, with $a = 0.2$. Grid: $N_\\xi = 65, N_\\eta = 64$.\n  3. **Shear Mapping**: $x(\\xi,\\eta) = \\xi + s \\eta$, $y(\\xi,\\eta) = \\eta$, with $s = 0.3$. Grid: $N_\\xi = 32, N_\\eta = 31$.\n  4. **Stretch Mapping**: $x(\\xi,\\eta) = \\xi$, $y(\\xi,\\eta) = \\eta + b \\sin(\\pi \\xi)$, with $b = 0.45$. Grid: $N_\\xi = 40, N_\\eta = 40$.\n- **Output Format**: A single list $[R_{\\text{metric}}^{(1)}, R_{\\Delta}^{(1)}, R_{\\text{metric}}^{(2)}, R_{\\Delta}^{(2)}, \\ldots]$.\n\n### Step 2: Validate Using Extracted Givens\n1.  **Scientific or Factual Soundness**: The problem is well-grounded in the principles of differential geometry, tensor calculus, and numerical methods for partial differential equations, specifically in the context of computational fluid dynamics. The concepts of curvilinear coordinates, Jacobian, metric tensors, and freestream preservation are fundamental to the field. The problem is scientifically sound.\n2.  **Non-Formalizable or Irrelevant**: The problem is highly formalizable and directly relevant to the topic of discretizing differential operators in CFD.\n3.  **Incomplete or Contradictory Setup**: All necessary parameters, mappings, and grid sizes are provided. The instructions for discretization are specific (second-order centered differences, periodic boundaries). The setup is complete and self-consistent.\n4.  **Unrealistic or Infeasible**: The coordinate mappings are standard test cases for grid generation and are mathematically well-behaved. The parameters ($a, s, b$) are chosen to ensure the mappings remain invertible ($J \\neq 0$). The task is computationally feasible.\n5.  **Ill-Posed or Poorly Structured**: The problem is well-posed. The sequence of calculations leads to a unique, deterministic result for each test case. The terminology is standard within the field.\n6.  **Pseudo-Profound, Trivial, or Tautological**: While the final numerical answers are expected to be near machine precision, arriving at this conclusion requires a correct understanding and implementation of several non-trivial concepts: curvilinear coordinate transformations, metric identities, and conservative discretization schemes. The problem serves as a critical verification exercise, which is a common and important practice in numerical code development. It is not trivial.\n7.  **Outside Scientific Verifiability**: The results are numerically verifiable and based on established mathematical principles.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. It is a standard and informative exercise in numerical methods for CFD. A full solution will be provided.\n\n### Principle-Based Solution\n\nThe core of this problem lies in verifying two fundamental properties of a finite difference scheme on a curvilinear grid: the satisfaction of discrete metric identities and freestream preservation.\n\n#### 1. Curvilinear Coordinates and Metric Terms\nThe transformation from computational coordinates $(\\xi^1, \\xi^2) = (\\xi, \\eta)$ to physical coordinates $(x^1, x^2) = (x, y)$ is defined by $x(\\xi, \\eta)$ and $y(\\xi, \\eta)$. The partial derivatives of the mapping, $x_\\xi, x_\\eta, y_\\xi, y_\\eta$, form the Jacobian matrix of the transformation. The determinant of this matrix is the Jacobian $J$:\n$$ J = \\det\\begin{pmatrix} x_\\xi & x_\\eta \\\\ y_\\xi & y_\\eta \\end{pmatrix} = x_\\xi y_\\eta - x_\\eta y_\\xi $$\nThe metric terms relating derivatives in the physical and computational frames are derived from the chain rule. For instance, $\\nabla \\xi$ and $\\nabla \\eta$ are gradients in physical space. Their components are given by the inverse of the Jacobian matrix:\n$$ \\begin{pmatrix} \\xi_x & \\xi_y \\\\ \\eta_x & \\eta_y \\end{pmatrix} = \\begin{pmatrix} x_\\xi & x_\\eta \\\\ y_\\xi & y_\\eta \\end{pmatrix}^{-1} = \\frac{1}{J} \\begin{pmatrix} y_\\eta & -x_\\eta \\\\ -y_\\xi & x_\\xi \\end{pmatrix} $$\nThis gives the important relations:\n$$ J\\xi_x = y_\\eta, \\quad J\\xi_y = -x_\\eta, \\quad J\\eta_x = -y_\\xi, \\quad J\\eta_y = x_\\xi $$\n\n#### 2. Discrete Metric Identities\nA direct consequence of Clairaut's theorem on the equality of mixed partials (e.g., $\\partial_\\xi \\partial_\\eta y = \\partial_\\eta \\partial_\\xi y$) are the analytical metric identities:\n$$ \\frac{\\partial}{\\partial \\xi}(J\\xi_x) + \\frac{\\partial}{\\partial \\eta}(J\\eta_x) = \\frac{\\partial}{\\partial \\xi}(y_\\eta) + \\frac{\\partial}{\\partial \\eta}(-y_\\xi) = \\frac{\\partial^2 y}{\\partial \\xi \\partial \\eta} - \\frac{\\partial^2 y}{\\partial \\eta \\partial \\xi} = 0 $$\n$$ \\frac{\\partial}{\\partial \\xi}(J\\xi_y) + \\frac{\\partial}{\\partial \\eta}(J\\eta_y) = \\frac{\\partial}{\\partial \\xi}(-x_\\eta) + \\frac{\\partial}{\\partial \\eta}(x_\\xi) = -\\frac{\\partial^2 x}{\\partial \\xi \\partial \\eta} + \\frac{\\partial^2 x}{\\partial \\eta \\partial \\xi} = 0 $$\nThe problem requires verifying these identities discretely. We define second-order periodic centered difference operators, $\\delta_\\xi$ and $\\delta_\\eta$. For a grid function $f_{i,j}$ on a grid with spacings $\\Delta\\xi, \\Delta\\eta$:\n$$ (\\delta_\\xi f)_{i,j} = \\frac{f_{i+1,j} - f_{i-1,j}}{2\\Delta\\xi}, \\quad (\\delta_\\eta f)_{i,j} = \\frac{f_{i,j+1} - f_{i,j-1}}{2\\Delta\\eta} $$\nA key property of these operators is that they commute: $\\delta_\\xi(\\delta_\\eta f) = \\delta_\\eta(\\delta_\\xi f)$. This can be verified by expanding the stencils. Consequently, the discrete metric identities, such as $\\delta_\\xi(y_\\eta) - \\delta_\\eta(y_\\xi)$, should evaluate to zero up to machine floating-point precision. The quantity $R_{\\text{metric}}$ measures the maximum deviation from zero.\n\n#### 3. Conservative Laplacian and Freestream Preservation\nThe Laplacian operator, $\\nabla^2 u = \\nabla \\cdot (\\nabla u)$, can be expressed in a conservative form in curvilinear coordinates. The divergence of a vector field $\\mathbf{F}$ is given by $\\nabla \\cdot \\mathbf{F} = \\frac{1}{J} \\sum_{i,j} \\frac{\\partial}{\\partial \\xi^i} (J g^{ij} F_j)$, where $F_j$ are covariant components. For $\\mathbf{F} = \\nabla u$, the covariant components are $u_\\xi$ and $u_\\eta$. The Laplacian is therefore:\n$$ \\nabla^2 u = \\frac{1}{J} \\left[ \\frac{\\partial}{\\partial \\xi} \\left( J (g^{11} u_\\xi + g^{12} u_\\eta) \\right) + \\frac{\\partial}{\\partial \\eta} \\left( J (g^{12} u_\\xi + g^{22} u_\\eta) \\right) \\right] $$\nwhere $g^{ij}$ are the contravariant metric tensor components:\n$$ g^{11} = \\xi_x^2 + \\xi_y^2, \\quad g^{22} = \\eta_x^2 + \\eta_y^2, \\quad g^{12} = \\xi_x\\eta_x + \\xi_y\\eta_y $$\nFreestream preservation requires that a uniform flow (or constant scalar field) remains a solution to the governing equations. For the Laplacian, this means $\\nabla^2 u_0$ must be zero for a constant $u_0$.\nWhen we discretize the conservative form of the Laplacian, we first compute the derivatives of the field, $u_\\xi$ and $u_\\eta$. For a constant field $u = u_0$, its discrete derivatives are identically zero:\n$$ u_{\\xi, i,j} = \\delta_\\xi u_0 = \\frac{u_0 - u_0}{2\\Delta\\xi} = 0, \\quad u_{\\eta, i,j} = \\delta_\\eta u_0 = \\frac{u_0 - u_0}{2\\Delta\\eta} = 0 $$\nSince $u_\\xi$ and $u_\\eta$ are zero everywhere, the flux terms within the parentheses, e.g., $J(g^{11} u_\\xi + g^{12} u_\\eta)$, are also identically zero. The subsequent outer differentiation, $\\delta_\\xi(\\text{zero flux})$ and $\\delta_\\eta(\\text{zero flux})$, also yields zero. Thus, the entire discrete Laplacian evaluates to zero. This demonstrates freestream preservation. The quantity $R_\\Delta$ measures this, and it is also expected to be zero to machine precision.\n\n#### 4. Implementation Strategy\nFor each test case, we will:\n1.  Construct the 2D computational grid $(\\xi, \\eta)$ and compute the physical grid coordinates $(x, y)$ from the given mapping.\n2.  Implement a function for second-order periodic centered differencing using `numpy.roll` for efficient handling of periodic boundaries.\n3.  Compute the discrete metric derivatives $x_\\xi, x_\\eta, y_\\xi, y_\\eta$.\n4.  Compute the discrete metric identity residuals by applying the difference operators again, as per the identity definitions, and find the maximum absolute value $R_{\\text{metric}}$.\n5.  Construct the terms of the Laplacian operator: compute $J$, the products $J g^{ij}$, and the field derivatives $u_\\xi, u_\\eta$ for a constant field $u_0=1.0$.\n6.  Assemble the discrete Laplacian and find its maximum absolute value $R_\\Delta$.\nThe expected result for both $R_{\\text{metric}}$ and $R_\\Delta$ in all test cases is a value on the order of machine epsilon, confirming the theoretical properties of the discretization.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the CFD problem for all test cases.\n    \"\"\"\n\n    def diff_centered_periodic(field, delta, axis):\n        \"\"\"\n        Computes the second-order centered difference of a 2D array\n        with periodic boundary conditions.\n        \n        Args:\n            field (np.ndarray): The 2D input array.\n            delta (float): The grid spacing in the direction of the derivative.\n            axis (int): The axis along which to differentiate (0 for xi, 1 for eta).\n            \n        Returns:\n            np.ndarray: The computed derivative.\n        \"\"\"\n        f_plus_1 = np.roll(field, -1, axis=axis)\n        f_minus_1 = np.roll(field, 1, axis=axis)\n        return (f_plus_1 - f_minus_1) / (2.0 * delta)\n\n    def compute_residuals(N_xi, N_eta, mapping_funcs, mapping_params):\n        \"\"\"\n        Computes the metric identity and Laplacian residuals for a given\n        grid and mapping.\n        \n        Args:\n            N_xi (int): Number of points in the xi-direction.\n            N_eta (int): Number of points in the eta-direction.\n            mapping_funcs (tuple): A tuple of two functions for x(xi,eta) and y(xi,eta).\n            mapping_params (dict): A dictionary of parameters for the mapping functions.\n\n        Returns:\n            tuple: A tuple containing (R_metric, R_delta).\n        \"\"\"\n        delta_xi = 1.0 / N_xi\n        delta_eta = 1.0 / N_eta\n\n        # 1. Define grid and compute physical coordinates\n        xi_1d = np.arange(N_xi) * delta_xi\n        eta_1d = np.arange(N_eta) * delta_eta\n        xi_mesh, eta_mesh = np.meshgrid(xi_1d, eta_1d, indexing='ij')\n\n        x_func, y_func = mapping_funcs\n        x = x_func(xi_mesh, eta_mesh, **mapping_params)\n        y = y_func(xi_mesh, eta_mesh, **mapping_params)\n\n        # 2. Compute discrete metric derivatives\n        x_xi = diff_centered_periodic(x, delta_xi, axis=0)\n        x_eta = diff_centered_periodic(x, delta_eta, axis=1)\n        y_xi = diff_centered_periodic(y, delta_xi, axis=0)\n        y_eta = diff_centered_periodic(y, delta_eta, axis=1)\n\n        # 3. Verify discrete metric identities\n        # Identity 1: d/d_xi(y_eta) - d/d_eta(y_xi) = 0\n        d_yeta_dxi = diff_centered_periodic(y_eta, delta_xi, axis=0)\n        d_yxi_deta = diff_centered_periodic(y_xi, delta_eta, axis=1)\n        metric_res_1 = d_yeta_dxi - d_yxi_deta\n\n        # Identity 2: d/d_eta(x_xi) - d/d_xi(x_eta) = 0\n        d_xxi_deta = diff_centered_periodic(x_xi, delta_eta, axis=1)\n        d_xeta_dxi = diff_centered_periodic(x_eta, delta_xi, axis=0)\n        metric_res_2 = d_xxi_deta - d_xeta_dxi\n\n        R_metric = max(np.max(np.abs(metric_res_1)), np.max(np.abs(metric_res_2)))\n\n        # 4. Construct and apply conservative Laplacian to a constant field\n        u0 = 1.0\n        u = np.full((N_xi, N_eta), u0)\n        \n        # Derivatives of a constant field are zero\n        u_xi = diff_centered_periodic(u, delta_xi, axis=0)\n        u_eta = diff_centered_periodic(u, delta_eta, axis=1)\n\n        # Compute Jacobian and metric tensor components (J*g^ij)\n        J = x_xi * y_eta - x_eta * y_xi\n        \n        # Check for non-invertible mapping\n        if np.any(np.abs(J)  1e-12):\n            # This case should not be hit with the given parameters, but it's good practice\n            return (np.nan, np.nan)\n\n        # J * g^11 = (x_eta^2 + y_eta^2) / J\n        # J * g^12 = -(x_xi*x_eta + y_xi*y_eta) / J\n        # J * g^22 = (x_xi^2 + y_xi^2) / J\n        J_g11 = (x_eta**2 + y_eta**2) / J\n        J_g12 = -(x_xi * x_eta + y_xi * y_eta) / J\n        J_g22 = (x_xi**2 + y_xi**2) / J\n\n        # Fluxes in xi and eta directions\n        # F_xi = J * (g^11 * u_xi + g^12 * u_eta)\n        # F_eta = J * (g^12 * u_xi + g^22 * u_eta)\n        F_xi = J_g11 * u_xi + J_g12 * u_eta\n        F_eta = J_g12 * u_xi + J_g22 * u_eta\n        \n        # Since u_xi and u_eta are zero, F_xi and F_eta are zero matrices.\n        # Taking their derivatives will also result in zero matrices.\n        \n        dFxi_dxi = diff_centered_periodic(F_xi, delta_xi, axis=0)\n        dFeta_deta = diff_centered_periodic(F_eta, delta_eta, axis=1)\n\n        # J * nabla^2(u)\n        J_lap_u = dFxi_dxi + dFeta_deta\n        \n        lap_u = J_lap_u / J\n        \n        R_delta = np.max(np.abs(lap_u))\n\n        return (R_metric, R_delta)\n\n    # --- Test Case Definitions ---\n    \n    # Case 1: Identity\n    def x1(xi, eta, **kwargs): return xi\n    def y1(xi, eta, **kwargs): return eta\n    \n    # Case 2: Wavy\n    def x2(xi, eta, a): return xi + a * np.sin(2 * np.pi * xi) * np.sin(2 * np.pi * eta)\n    def y2(xi, eta, a): return eta + a * np.cos(2 * np.pi * xi) * np.sin(2 * np.pi * eta)\n\n    # Case 3: Shear\n    def x3(xi, eta, s): return xi + s * eta\n    def y3(xi, eta, s): return eta\n\n    # Case 4: Stretch\n    def x4(xi, eta, b): return xi\n    def y4(xi, eta, b): return eta + b * np.sin(np.pi * xi)\n\n    test_cases = [\n        {'N_xi': 33, 'N_eta': 33, 'map_funcs': (x1, y1), 'params': {}},\n        {'N_xi': 65, 'N_eta': 64, 'map_funcs': (x2, y2), 'params': {'a': 0.2}},\n        {'N_xi': 32, 'N_eta': 31, 'map_funcs': (x3, y3), 'params': {'s': 0.3}},\n        {'N_xi': 40, 'N_eta': 40, 'map_funcs': (x4, y4), 'params': {'b': 0.45}},\n    ]\n\n    results = []\n    for case in test_cases:\n        # Added placeholder for kwargs in mapping funcs\n        R_metric, R_delta = compute_residuals(case['N_xi'], case['N_eta'], case['map_funcs'], case['params'])\n        results.append(R_metric)\n        results.append(R_delta)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3311337"}]}