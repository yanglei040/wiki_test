{"hands_on_practices": [{"introduction": "To build a solid understanding of deferred correction, we begin with its most fundamental component: the calculation of the flux at a single cell face. This exercise strips away the complexity of a full simulation to focus on the core mechanics. By constructing a high-order flux from first principles using polynomial interpolation and comparing it to a robust low-order upwind flux, you will directly compute the 'correction' term that is central to the DC method [@problem_id:3306429].", "problem": "Consider the one-dimensional steady pure convection of a passive scalar on a uniform grid within the Finite Volume Method (FVM). Let the convective velocity be constant and positive, so that the upwind cell for the face between control volumes at indices $i$ and $i+1$ is the cell $i$. Assume non-dimensionalization such that the product of density and face area is unity, so that the face convective flux equals velocity times the advected value. You are to apply the Deferred Correction (DC) framework to construct a higher-order face flux at the face $i+1/2$.\n\nStart from the integral conservation law over a control volume and the definition of the convective face flux as the product of normal velocity and the face value of the scalar. For the low-order (LO) scheme, use first-order upwind for positive velocity. For the high-order (HO) scheme, do not assume any pre-given formula; instead, construct the face value by fitting a cubic polynomial through the scalar values at four consecutive cell centers $x_{i-1}$, $x_{i}$, $x_{i+1}$, and $x_{i+2}$ on a uniform grid, and then evaluate this polynomial at the face location $x_{i+1/2}$. Use this to obtain the high-order face flux.\n\nIn the DC framework, assemble the low-order contribution implicitly and add a fraction of the high-order correction explicitly to the right-hand side. Let the DC blending factor be $\\beta = 0.8$.\n\nGiven the discrete scalar values $\\phi_{i-1} = 2$, $\\phi_{i} = 3$, $\\phi_{i+1} = 5$, and $\\phi_{i+2} = 7$, and a positive velocity $u = 2.4$, perform the following:\n\n- Derive and evaluate the low-order face flux $F^{LO}_{i+1/2}$, the high-order face flux $F^{HO}_{i+1/2}$, and the deferred correction $\\delta F_{i+1/2} = F^{HO}_{i+1/2} - F^{LO}_{i+1/2}$.\n- State clearly which part is assembled implicitly and which part is added explicitly in DC, and compute their numerical values for the given data.\n- Compute the final deferred-corrected face flux $F^{DC}_{i+1/2} = F^{LO}_{i+1/2} + \\beta\\,\\delta F_{i+1/2}$.\n\nReport as your final answer the single number $F^{DC}_{i+1/2}$. Round your answer to $4$ significant figures. Since the flux is non-dimensionalized as described, do not include units in your final answer.", "solution": "The problem is validated as scientifically grounded, well-posed, objective, and complete. All necessary data and definitions are provided for a unique solution. We may proceed with the solution.\n\nThe problem considers the one-dimensional steady pure convection of a passive scalar $\\phi$, governed by the conservation law:\n$$\n\\frac{d}{dx}(\\rho u \\phi) = 0\n$$\nIn the Finite Volume Method (FVM), this equation is integrated over a control volume (CV) from face $i-1/2$ to face $i+1/2$, yielding:\n$$\n(\\rho u A \\phi)_{i+1/2} - (\\rho u A \\phi)_{i-1/2} = 0\n$$\nwhere $A$ is the face area. The problem states that the product of density $\\rho$ and face area $A$ is unity, and the velocity $u$ is constant. The convective flux across a face is thus $F = u\\phi$. For the control volume $i$, the discretized equation is:\n$$\nF_{i+1/2} - F_{i-1/2} = 0\n$$\nWe are asked to compute the flux $F_{i+1/2}$ at the face between cells $i$ and $i+1$ using the Deferred Correction (DC) framework. The given data are the velocity $u = 2.4$ (positive) and the cell-centered scalar values $\\phi_{i-1} = 2$, $\\phi_{i} = 3$, $\\phi_{i+1} = 5$, and $\\phi_{i+2} = 7$. The DC blending factor is $\\beta = 0.8$.\n\nFirst, we determine the low-order (LO) face flux, $F^{LO}_{i+1/2}$. The problem specifies a first-order upwind scheme. Since the velocity $u$ is positive, the flow is from left to right, and the upwind cell for face $i+1/2$ is cell $i$. Thus, the scalar value at the face is taken from the upwind cell center:\n$$\n\\phi^{LO}_{i+1/2} = \\phi_i\n$$\nThe low-order flux is then:\n$$\nF^{LO}_{i+1/2} = u \\cdot \\phi^{LO}_{i+1/2} = u \\phi_i\n$$\nSubstituting the given numerical values:\n$$\nF^{LO}_{i+1/2} = (2.4)(3) = 7.2\n$$\n\nNext, we determine the high-order (HO) face flux, $F^{HO}_{i+1/2}$. This requires finding the face value $\\phi^{HO}_{i+1/2}$ by fitting a cubic polynomial through the scalar values at the four cell centers $x_{i-1}$, $x_i$, $x_{i+1}$, and $x_{i+2}$, and then evaluating this polynomial at the face location $x_{i+1/2}$.\n\nLet's define a local coordinate system $\\xi$ centered at $x_i$ and scaled by the uniform grid spacing $\\Delta x$: $\\xi = (x - x_i) / \\Delta x$. The cell centers are located at $\\xi_{i-1}=-1$, $\\xi_i=0$, $\\xi_{i+1}=1$, and $\\xi_{i+2}=2$. The face $i+1/2$ is located at $x_{i+1/2} = x_i + \\Delta x/2$, which corresponds to $\\xi_{i+1/2} = 1/2$.\n\nWe use Lagrange interpolation to find the value of the polynomial at $\\xi = 1/2$. The interpolated value is a linear combination of the nodal values:\n$$\n\\phi^{HO}_{i+1/2} = L_{i-1}(1/2)\\phi_{i-1} + L_i(1/2)\\phi_i + L_{i+1}(1/2)\\phi_{i+1} + L_{i+2}(1/2)\\phi_{i+2}\n$$\nThe Lagrange basis polynomials $L_k(\\xi)$ are calculated at $\\xi=1/2$ for the nodes $\\{-1, 0, 1, 2\\}$:\n$$\nL_{i-1}(1/2) = \\frac{(1/2 - 0)(1/2 - 1)(1/2 - 2)}{(-1 - 0)(-1 - 1)(-1 - 2)} = \\frac{(1/2)(-1/2)(-3/2)}{(-1)(-2)(-3)} = \\frac{3/8}{-6} = -\\frac{1}{16}\n$$\n$$\nL_i(1/2) = \\frac{(1/2 - (-1))(1/2 - 1)(1/2 - 2)}{(0 - (-1))(0 - 1)(0 - 2)} = \\frac{(3/2)(-1/2)(-3/2)}{(1)(-1)(-2)} = \\frac{9/8}{2} = \\frac{9}{16}\n$$\n$$\nL_{i+1}(1/2) = \\frac{(1/2 - (-1))(1/2 - 0)(1/2 - 2)}{(1 - (-1))(1 - 0)(1 - 2)} = \\frac{(3/2)(1/2)(-3/2)}{(2)(1)(-1)} = \\frac{-9/8}{-2} = \\frac{9}{16}\n$$\n$$\nL_{i+2}(1/2) = \\frac{(1/2 - (-1))(1/2 - 0)(1/2 - 1)}{(2 - (-1))(2 - 0)(2 - 1)} = \\frac{(3/2)(1/2)(-1/2)}{(3)(2)(1)} = \\frac{-3/8}{6} = -\\frac{1}{16}\n$$\nThe sum of the coefficients is $-1/16 + 9/16 + 9/16 - 1/16 = 16/16 = 1$, as expected.\n\nNow, we substitute the given scalar values to find $\\phi^{HO}_{i+1/2}$:\n$$\n\\phi^{HO}_{i+1/2} = -\\frac{1}{16}\\phi_{i-1} + \\frac{9}{16}\\phi_i + \\frac{9}{16}\\phi_{i+1} - \\frac{1}{16}\\phi_{i+2}\n$$\n$$\n\\phi^{HO}_{i+1/2} = \\frac{1}{16}[-1(2) + 9(3) + 9(5) - 1(7)] = \\frac{1}{16}[-2 + 27 + 45 - 7] = \\frac{63}{16} = 3.9375\n$$\nThe high-order flux is then:\n$$\nF^{HO}_{i+1/2} = u \\cdot \\phi^{HO}_{i+1/2} = (2.4)\\left(\\frac{63}{16}\\right) = \\left(\\frac{12}{5}\\right)\\left(\\frac{63}{16}\\right) = \\left(\\frac{3}{5}\\right)\\left(\\frac{63}{4}\\right) = \\frac{189}{20} = 9.45\n$$\nThe deferred correction term, $\\delta F_{i+1/2}$, is the difference between the high-order and low-order fluxes:\n$$\n\\delta F_{i+1/2} = F^{HO}_{i+1/2} - F^{LO}_{i+1/2} = 9.45 - 7.2 = 2.25\n$$\n\nIn the Deferred Correction framework, the total flux is modeled as $F = F^{LO} + \\text{correction}$. The low-order flux term $F^{LO}$ is treated implicitly, meaning it depends on the unknown solution variables and contributes to the main diagonal and off-diagonal elements of the system matrix. The correction term is treated explicitly, meaning it is calculated from known values (e.g., from the previous iteration) and moved to the right-hand side (source term) of the algebraic system.\nThe problem states that a fraction $\\beta$ of the high-order correction is added. Thus, the flux is decomposed as:\n$$\nF_{i+1/2} = \\underbrace{F^{LO}_{i+1/2}}_{\\text{implicit}} + \\underbrace{\\beta(F^{HO}_{i+1/2} - F^{LO}_{i+1/2})}_{\\text{explicit}} = \\underbrace{F^{LO}_{i+1/2}}_{\\text{implicit}} + \\underbrace{\\beta\\,\\delta F_{i+1/2}}_{\\text{explicit}}\n$$\nThe part assembled implicitly for face $i+1/2$ is $F^{LO}_{i+1/2} = 7.2$.\nThe part added explicitly to the source term is $\\beta\\,\\delta F_{i+1/2}$. Its numerical value is:\n$$\n\\beta\\,\\delta F_{i+1/2} = (0.8)(2.25) = 1.8\n$$\nNote that this term contributes with a negative sign to the source term of cell $i$ and a positive sign to the source term of cell $i+1$.\n\nFinally, we compute the total deferred-corrected face flux, $F^{DC}_{i+1/2}$:\n$$\nF^{DC}_{i+1/2} = F^{LO}_{i+1/2} + \\beta\\,\\delta F_{i+1/2} = 7.2 + 1.8 = 9.0\n$$\nThe problem requires the answer to be rounded to $4$ significant figures. Therefore, $9.0$ is written as $9.000$.", "answer": "$$\n\\boxed{9.000}\n$$", "id": "3306429"}, {"introduction": "After mastering the calculation of a single face flux, the next logical step is to see how these fluxes are integrated into the finite volume equations for a control volume. The deferred correction is typically added as an explicit source term to the right-hand side of the linear system. This practice will guide you through assembling this correction vector for a small, periodic domain and will have you verify that the net correction is conservativeâ€”a critical property for any valid flux-based scheme [@problem_id:3306397].", "problem": "Consider one-dimensional steady linear advection of a dimensionless passive scalar $\\phi$ with a constant, positive, non-dimensional velocity $u0$ on a periodic domain discretized by the finite-volume method into three uniform control volumes indexed by $i\\in\\{1,2,3\\}$. The face areas, cell widths, and density have all been non-dimensionalized to unity, so that the convective flux through a face equals $u$ times the face-interpolated value of $\\phi$. Let the cell-centered values be $\\phi=\\left[1,2,3\\right]$, with periodic indexing, so that $\\phi_{0}=\\phi_{3}$, $\\phi_{4}=\\phi_{1}$, and $\\phi_{-1}=\\phi_{2}$.\n\nTo obtain higher-order convection while preserving robustness, employ the Deferred Correction (DC) strategy: treat a first-order upwind discretization of the convective operator implicitly, and move the difference between a higher-order and the low-order convective flux to the right-hand side as a source term. Using DC with coefficient $\\alpha=1$, the right-hand side correction for cell $i$ is\n$$\nb_{i} \\;=\\; \\frac{\\alpha}{\\Delta x}\\left(\\Delta F_{i-\\frac{1}{2}} - \\Delta F_{i+\\frac{1}{2}}\\right),\n$$\nwhere $\\Delta F_{i\\pm\\frac{1}{2}}$ is the difference between the higher-order and the upwind flux at the corresponding face, and $\\Delta x=1$ by non-dimensionalization.\n\nFor $u0$ on a uniform grid, the first-order upwind face values are\n$$\n\\phi_{i+\\frac{1}{2}}^{\\text{UW}}=\\phi_{i}, \\qquad \\phi_{i-\\frac{1}{2}}^{\\text{UW}}=\\phi_{i-1}.\n$$\nAdopt Quadratic Upwind Interpolation for Convective Kinematics (QUICK) for the higher-order face interpolation. On a uniform grid with $u0$, QUICK gives\n$$\n\\phi_{i+\\frac{1}{2}}^{\\text{QUICK}}=\\frac{3}{8}\\,\\phi_{i+1}+\\frac{6}{8}\\,\\phi_{i}-\\frac{1}{8}\\,\\phi_{i-1}, \\qquad\n\\phi_{i-\\frac{1}{2}}^{\\text{QUICK}}=\\frac{3}{8}\\,\\phi_{i}+\\frac{6}{8}\\,\\phi_{i-1}-\\frac{1}{8}\\,\\phi_{i-2}.\n$$\nWith these definitions, explicitly compute the DC right-hand side vector $b=\\left[b_{1},\\,b_{2},\\,b_{3}\\right]$ for the given $\\phi$ and $u0$. Demonstrate the net conservation of the correction by verifying that the sum of the three components of $b$ is zero. Express your final answer as a single row matrix in terms of $u$ using the LaTeX `pmatrix` environment. No numerical rounding is required, and no units should be included in the final expression.", "solution": "The problem requires the computation of the Deferred Correction (DC) source term vector, $b = [b_1, b_2, b_3]$, for a one-dimensional steady linear advection problem on a periodic three-cell domain. The solution will proceed by first establishing the general formulas for the correction terms and then applying them to the specific cell-centered data provided.\n\nThe DC source term for a given cell $i$ is defined as:\n$$\nb_i = \\frac{\\alpha}{\\Delta x} \\left( \\Delta F_{i-\\frac{1}{2}} - \\Delta F_{i+\\frac{1}{2}} \\right)\n$$\nAccording to the problem statement, the DC coefficient is $\\alpha=1$ and the non-dimensional cell width is $\\Delta x=1$. Therefore, the expression simplifies to:\n$$\nb_i = \\Delta F_{i-\\frac{1}{2}} - \\Delta F_{i+\\frac{1}{2}}\n$$\nThe term $\\Delta F_{i\\pm\\frac{1}{2}}$ represents the difference between the higher-order (QUICK) and lower-order (Upwind) convective fluxes at the cell faces $i\\pm\\frac{1}{2}$. Since the convective flux is given by the product of velocity $u$ and the face-interpolated scalar value $\\phi$, we have:\n$$\n\\Delta F_{f} = F_{f}^{\\text{QUICK}} - F_{f}^{\\text{UW}} = u \\phi_{f}^{\\text{QUICK}} - u \\phi_{f}^{\\text{UW}} = u \\left( \\phi_{f}^{\\text{QUICK}} - \\phi_{f}^{\\text{UW}} \\right)\n$$\nwhere $f$ denotes a generic face. Let's define the difference in the interpolated face values as $\\Delta \\phi_f = \\phi_{f}^{\\text{QUICK}} - \\phi_{f}^{\\text{UW}}$.\n\nFor a constant positive velocity $u0$, the first-order upwind scheme gives the face value as the cell-centered value from the upwind direction. For the face $i+\\frac{1}{2}$, the upwind cell is $i$. Thus:\n$$\n\\phi_{i+\\frac{1}{2}}^{\\text{UW}} = \\phi_i\n$$\nThe higher-order QUICK scheme value at the same face is given as:\n$$\n\\phi_{i+\\frac{1}{2}}^{\\text{QUICK}} = \\frac{3}{8}\\phi_{i+1} + \\frac{6}{8}\\phi_i - \\frac{1}{8}\\phi_{i-1}\n$$\nThe difference in face values $\\Delta\\phi_{i+\\frac{1}{2}}$ is therefore:\n$$\n\\Delta\\phi_{i+\\frac{1}{2}} = \\left( \\frac{3}{8}\\phi_{i+1} + \\frac{6}{8}\\phi_i - \\frac{1}{8}\\phi_{i-1} \\right) - \\phi_i = \\frac{3}{8}\\phi_{i+1} - \\frac{2}{8}\\phi_i - \\frac{1}{8}\\phi_{i-1} = \\frac{1}{8} \\left( 3\\phi_{i+1} - 2\\phi_i - \\phi_{i-1} \\right)\n$$\nConsequently, the flux difference at face $i+\\frac{1}{2}$ is:\n$$\n\\Delta F_{i+\\frac{1}{2}} = \\frac{u}{8} \\left( 3\\phi_{i+1} - 2\\phi_i - \\phi_{i-1} \\right)\n$$\nWe are given the cell-centered values $\\phi_1=1$, $\\phi_2=2$, and $\\phi_3=3$. The domain is periodic with $3$ cells, which implies the following index mapping: $\\phi_0 = \\phi_3$, $\\phi_4 = \\phi_1$, and $\\phi_{-1} = \\phi_2$.\nSubstituting the known values:\n$\\phi_0 = 3$\n$\\phi_4 = 1$\n$\\phi_{-1} = 2$\n\nWe now compute the flux differences $\\Delta F_f$ for the faces of the three cells: $f = \\frac{1}{2}$, $\\frac{3}{2}$, $\\frac{5}{2}$. Note that due to periodicity, face $\\frac{7}{2}$ is identical to face $\\frac{1}{2}$.\n\nFor face $i+\\frac{1}{2} = \\frac{3}{2}$ (between cells $1$ and $2$), we set $i=1$:\n$$\n\\Delta F_{\\frac{3}{2}} = \\frac{u}{8} (3\\phi_2 - 2\\phi_1 - \\phi_0) = \\frac{u}{8} (3(2) - 2(1) - 3) = \\frac{u}{8} (6 - 2 - 3) = \\frac{u}{8}\n$$\n\nFor face $i+\\frac{1}{2} = \\frac{5}{2}$ (between cells $2$ and $3$), we set $i=2$:\n$$\n\\Delta F_{\\frac{5}{2}} = \\frac{u}{8} (3\\phi_3 - 2\\phi_2 - \\phi_1) = \\frac{u}{8} (3(3) - 2(2) - 1) = \\frac{u}{8} (9 - 4 - 1) = \\frac{4u}{8} = \\frac{u}{2}\n$$\n\nFor face $i+\\frac{1}{2} = \\frac{1}{2}$ (between cells $3$ and $1$), we can set $i=0$ for convenience, or use the periodicity rule that this is the same as face $\\frac{7}{2}$ where $i=3$:\n$$\n\\Delta F_{\\frac{1}{2}} = \\Delta F_{\\frac{7}{2}} = \\frac{u}{8} (3\\phi_4 - 2\\phi_3 - \\phi_2) = \\frac{u}{8} (3(1) - 2(3) - 2) = \\frac{u}{8} (3 - 6 - 2) = -\\frac{5u}{8}\n$$\n\nWith the flux differences calculated, we can now find the components of the source vector $b$:\n\nFor cell $i=1$:\n$$\nb_1 = \\Delta F_{1-\\frac{1}{2}} - \\Delta F_{1+\\frac{1}{2}} = \\Delta F_{\\frac{1}{2}} - \\Delta F_{\\frac{3}{2}} = -\\frac{5u}{8} - \\frac{u}{8} = -\\frac{6u}{8} = -\\frac{3u}{4}\n$$\n\nFor cell $i=2$:\n$$\nb_2 = \\Delta F_{2-\\frac{1}{2}} - \\Delta F_{2+\\frac{1}{2}} = \\Delta F_{\\frac{3}{2}} - \\Delta F_{\\frac{5}{2}} = \\frac{u}{8} - \\frac{4u}{8} = -\\frac{3u}{8}\n$$\n\nFor cell $i=3$:\n$$\nb_3 = \\Delta F_{3-\\frac{1}{2}} - \\Delta F_{3+\\frac{1}{2}} = \\Delta F_{\\frac{5}{2}} - \\Delta F_{\\frac{7}{2}} = \\frac{4u}{8} - \\left(-\\frac{5u}{8}\\right) = \\frac{9u}{8}\n$$\n\nThe resulting Deferred Correction source term vector is $b = \\left[-\\frac{3u}{4}, -\\frac{3u}{8}, \\frac{9u}{8}\\right]$.\n\nFinally, we must verify that the net correction is conservative, which means the sum of its components over the domain must be zero.\n$$\n\\sum_{i=1}^{3} b_i = b_1 + b_2 + b_3 = \\left(-\\frac{3u}{4}\\right) + \\left(-\\frac{3u}{8}\\right) + \\left(\\frac{9u}{8}\\right)\n$$\nTo sum these terms, we use a common denominator of $8$:\n$$\n\\sum_{i=1}^{3} b_i = -\\frac{6u}{8} - \\frac{3u}{8} + \\frac{9u}{8} = \\frac{-6u - 3u + 9u}{8} = \\frac{0}{8} = 0\n$$\nThe sum is zero, confirming that the DC source term is conservative. This is an expected and required property for a flux-difference formulation on a periodic domain, as the sum $\\sum_{i=1}^N (\\Delta F_{i-1/2} - \\Delta F_{i+1/2})$ is a telescoping sum that evaluates to $\\Delta F_{1/2} - \\Delta F_{N+1/2}$, and periodicity dictates $\\Delta F_{N+1/2} = \\Delta F_{1/2}$.\n\nThe final answer is the vector $b=\\left[b_{1},\\,b_{2},\\,b_{3}\\right]$ expressed as a row matrix.", "answer": "$$\n\\boxed{\\begin{pmatrix} -\\frac{3u}{4}  -\\frac{3u}{8}  \\frac{9u}{8} \\end{pmatrix}}\n$$", "id": "3306397"}, {"introduction": "Higher-order accuracy is desirable, but it often comes at the cost of producing non-physical oscillations near sharp gradients, violating principles like local bounds on the solution. This is a primary motivation for the deferred correction framework, which seeks to add accuracy without sacrificing the stability of a low-order scheme. In this exercise, you will analytically derive and quantify the magnitude of the numerical overshoot generated by an unlimited higher-order correction, providing a clear demonstration of why naive blending can fail and why robust limiting strategies are essential [@problem_id:3306415].", "problem": "Consider the one-dimensional linear advection equation for a passive scalar on a uniform mesh,\n$$\n\\frac{\\partial \\phi}{\\partial t} + a \\frac{\\partial \\phi}{\\partial x} = 0,\n$$\nwith constant positive velocity $a0$. Use a conservative finite-volume, explicit Euler time integration on cells indexed by integers $i \\in \\mathbb{Z}$ with uniform spacing $\\Delta x$, time step $\\Delta t$, and Courant number $C = a \\Delta t / \\Delta x$. The face-normal convective flux at the cell face between cells $i$ and $i+1$ uses a deferred correction construction without any nonlinear limiter (an unlimited correction): the advected state at face $i+1/2$ is\n$$\n\\phi_{i+1/2} = \\phi^{\\text{UD}}_{i+1/2} + \\alpha \\left( \\phi^{\\text{HO}}_{i+1/2} - \\phi^{\\text{UD}}_{i+1/2} \\right),\n$$\nwhere the upwind value for $a0$ is $\\phi^{\\text{UD}}_{i+1/2} = \\phi_i$, the higher-order candidate is the second-order central interpolation $\\phi^{\\text{HO}}_{i+1/2} = \\tfrac{1}{2}(\\phi_i + \\phi_{i+1})$, and $\\alpha \\ge 0$ is a tunable correction weight. The explicit Euler finite-volume update for cell $i$ reads\n$$\n\\phi_i^{n+1} = \\phi_i^n - C \\left( \\phi_{i+1/2}^n - \\phi_{i-1/2}^n \\right),\n$$\nwith $C \\in (0,1]$ for numerical stability of the upwind baseline.\n\nConstruct a sharp discontinuity at time level $n$ characterized locally by the values\n$$\n\\phi_{i-1}^n = 1,\\quad \\phi_i^n = 1,\\quad \\phi_{i+1}^n = 0,\\quad \\phi_{i+2}^n = 0,\n$$\nwhich corresponds to a unit step moving to the right. For this configuration, the discrete maximum principle demands that the updated solution at $i$ satisfy $\\phi_i^{n+1} \\le \\max(\\phi_{i-1}^n,\\phi_i^n) = 1$. However, unlimited higher-order corrections may violate this bound. Your task is to compute, for a single explicit Euler step, the overshoot magnitude at cell $i$ relative to the upstream maximum value $1$, defined as\n$$\n\\delta(\\alpha,C) = \\max\\left( 0,\\; \\phi_i^{n+1} - 1 \\right),\n$$\nfor various $(\\alpha,C)$ pairs.\n\nStarting from the conservation law and definitions above, derive an algorithm to evaluate $\\delta(\\alpha,C)$ for a single step using only the local stencil $\\{i-1,i,i+1,i+2\\}$ described. Implement this algorithm as a program that computes $\\delta(\\alpha,C)$ for the following test suite of $(\\alpha,C)$ values:\n- Test $1$: $\\alpha = 0$, $C = 0.8$.\n- Test $2$: $\\alpha = 0.5$, $C = 0.8$.\n- Test $3$: $\\alpha = 1$, $C = 0.8$.\n- Test $4$: $\\alpha = 1.5$, $C = 0.8$.\n- Test $5$: $\\alpha = 1$, $C = 1$.\n- Test $6$: $\\alpha = 2$, $C = 0.5$.\n\nAll quantities are dimensionless; no physical units are required. Your program should produce a single line of output containing the overshoot magnitudes for the six tests as a comma-separated list of decimal numbers enclosed in square brackets (for example, $[x_1,x_2,x_3,x_4,x_5,x_6]$), in the order of the tests given above. The output type for each entry must be a float. Ensure the computation follows directly from the update rule and face construction stated, with no additional limiters or artificial dissipation.", "solution": "The problem is well-posed, scientifically grounded, and contains all necessary information for a unique solution. We can therefore proceed with the derivation.\n\nThe objective is to derive an analytical expression for the updated cell value $\\phi_i^{n+1}$ and subsequently the overshoot magnitude $\\delta(\\alpha,C)$ for a single explicit Euler time step, given the initial data and numerical scheme.\n\nThe finite-volume update rule for the cell-averaged value $\\phi_i$ is given by:\n$$\n\\phi_i^{n+1} = \\phi_i^n - C \\left( \\phi_{i+1/2}^n - \\phi_{i-1/2}^n \\right)\n$$\nwhere $C = a \\Delta t / \\Delta x$ is the Courant number, and $\\phi_{j+1/2}^n$ is the value of the scalar advected across the face at $j+1/2$ during the time step.\n\nThe face value $\\phi_{j+1/2}$ is constructed using a deferred correction approach:\n$$\n\\phi_{j+1/2} = \\phi^{\\text{UD}}_{j+1/2} + \\alpha \\left( \\phi^{\\text{HO}}_{j+1/2} - \\phi^{\\text{UD}}_{j+1/2} \\right)\n$$\nThis can be rewritten as a weighted blend of the upwind (UD) and higher-order (HO) values:\n$$\n\\phi_{j+1/2} = (1-\\alpha) \\phi^{\\text{UD}}_{j+1/2} + \\alpha \\phi^{\\text{HO}}_{j+1/2}\n$$\nFor a positive velocity $a0$, the upwind value at face $j+1/2$ is taken from the cell upwind of the face, which is cell $j$.\n$$\n\\phi^{\\text{UD}}_{j+1/2} = \\phi_j\n$$\nThe higher-order candidate is a second-order central interpolation between the cells sharing the face:\n$$\n\\phi^{\\text{HO}}_{j+1/2} = \\frac{1}{2}(\\phi_j + \\phi_{j+1})\n$$\nSubstituting these definitions into the blended face value expression gives:\n$$\n\\phi_{j+1/2} = (1-\\alpha) \\phi_j + \\alpha \\left( \\frac{\\phi_j + \\phi_{j+1}}{2} \\right)\n$$\nSimplifying this expression yields a stencil for the face value:\n$$\n\\phi_{j+1/2} = \\left( (1-\\alpha) + \\frac{\\alpha}{2} \\right) \\phi_j + \\frac{\\alpha}{2} \\phi_{j+1} = \\left( 1 - \\frac{\\alpha}{2} \\right) \\phi_j + \\frac{\\alpha}{2} \\phi_{j+1}\n$$\nNow, we apply this general face value formula to the specific faces required for the update of cell $i$, namely the right face at $i+1/2$ and the left face at $i-1/2$. We use the superscript $n$ to denote the time level.\n\nThe value at face $i+1/2$ is:\n$$\n\\phi_{i+1/2}^n = \\left( 1 - \\frac{\\alpha}{2} \\right) \\phi_i^n + \\frac{\\alpha}{2} \\phi_{i+1}^n\n$$\nThe value at face $i-1/2$ is found by shifting the index $j \\to i-1$:\n$$\n\\phi_{i-1/2}^n = \\left( 1 - \\frac{\\alpha}{2} \\right) \\phi_{i-1}^n + \\frac{\\alpha}{2} \\phi_i^n\n$$\nThe problem provides the local initial state at time level $n$:\n$$\n\\phi_{i-1}^n = 1, \\quad \\phi_i^n = 1, \\quad \\phi_{i+1}^n = 0\n$$\nWe substitute these specific numerical values into the expressions for the face states:\nFor face $i+1/2$:\n$$\n\\phi_{i+1/2}^n = \\left( 1 - \\frac{\\alpha}{2} \\right) (1) + \\frac{\\alpha}{2} (0) = 1 - \\frac{\\alpha}{2}\n$$\nFor face $i-1/2$:\n$$\n\\phi_{i-1/2}^n = \\left( 1 - \\frac{\\alpha}{2} \\right) (1) + \\frac{\\alpha}{2} (1) = 1 - \\frac{\\alpha}{2} + \\frac{\\alpha}{2} = 1\n$$\nNow, we substitute these face values back into the finite-volume update equation for $\\phi_i^{n+1}$:\n$$\n\\phi_i^{n+1} = \\phi_i^n - C \\left( \\phi_{i+1/2}^n - \\phi_{i-1/2}^n \\right)\n$$\n$$\n\\phi_i^{n+1} = 1 - C \\left( \\left(1 - \\frac{\\alpha}{2}\\right) - 1 \\right)\n$$\nSimplifying the expression inside the parentheses:\n$$\n\\phi_i^{n+1} = 1 - C \\left( -\\frac{\\alpha}{2} \\right)\n$$\nThis gives the final analytical expression for the updated value in cell $i$:\n$$\n\\phi_i^{n+1} = 1 + \\frac{C\\alpha}{2}\n$$\nThe overshoot magnitude $\\delta(\\alpha,C)$ is defined as the excess of $\\phi_i^{n+1}$ above the local maximum of the initial data, which is $1$.\n$$\n\\delta(\\alpha,C) = \\max\\left( 0, \\phi_i^{n+1} - 1 \\right)\n$$\nSubstituting our expression for $\\phi_i^{n+1}$:\n$$\n\\delta(\\alpha,C) = \\max\\left( 0, \\left(1 + \\frac{C\\alpha}{2}\\right) - 1 \\right) = \\max\\left( 0, \\frac{C\\alpha}{2} \\right)\n$$\nAccording to the problem statement, the Courant number $C$ is positive ($C \\in (0,1]$), and the correction weight $\\alpha$ is non-negative ($\\alpha \\ge 0$). Therefore, the product $C\\alpha/2$ is always non-negative.\nThe final expression for the overshoot magnitude is:\n$$\n\\delta(\\alpha,C) = \\frac{C\\alpha}{2}\n$$\nWe now use this formula to compute the overshoot for each test case.\n- Test $1$: $(\\alpha, C) = (0, 0.8) \\implies \\delta = \\frac{0.8 \\times 0}{2} = 0.0$\n- Test $2$: $(\\alpha, C) = (0.5, 0.8) \\implies \\delta = \\frac{0.8 \\times 0.5}{2} = \\frac{0.4}{2} = 0.2$\n- Test $3$: $(\\alpha, C) = (1, 0.8) \\implies \\delta = \\frac{0.8 \\times 1}{2} = 0.4$\n- Test $4$: $(\\alpha, C) = (1.5, 0.8) \\implies \\delta = \\frac{0.8 \\times 1.5}{2} = \\frac{1.2}{2} = 0.6$\n- Test $5$: $(\\alpha, C) = (1, 1) \\implies \\delta = \\frac{1 \\times 1}{2} = 0.5$\n- Test $6$: $(\\alpha, C) = (2, 0.5) \\implies \\delta = \\frac{0.5 \\times 2}{2} = 0.5$\nThe resulting list of overshoot magnitudes is $[0.0, 0.2, 0.4, 0.6, 0.5, 0.5]$.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy import ...\n\ndef solve():\n    \"\"\"\n    Computes the overshoot magnitude delta(alpha, C) for a deferred correction\n    finite-volume scheme applied to the linear advection equation.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each tuple is of the form (alpha, C).\n    test_cases = [\n        (0.0, 0.8),   # Test 1\n        (0.5, 0.8),   # Test 2\n        (1.0, 0.8),   # Test 3\n        (1.5, 0.8),   # Test 4\n        (1.0, 1.0),   # Test 5\n        (2.0, 0.5),   # Test 6\n    ]\n\n    results = []\n    # The derived analytical expression for the overshoot is delta = C * alpha / 2.\n    # This comes from:\n    # phi_i^{n+1} = 1 + (C * alpha / 2)\n    # delta = max(0, phi_i^{n+1} - 1)\n    # Since C  0 and alpha = 0, the result is simply C * alpha / 2.\n    \n    for alpha, C in test_cases:\n        # Calculate the overshoot magnitude using the derived formula.\n        overshoot = (C * alpha) / 2.0\n        results.append(overshoot)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3306415"}]}