{"hands_on_practices": [{"introduction": "A fundamental task in numerical analysis is to quantify how well a discrete operator mimics its continuous counterpart. Fourier analysis provides a powerful lens for this, allowing us to examine the operator's behavior across all possible wavenumbers. In this exercise [@problem_id:3310598], you will apply this technique to the standard nine-point stencil for the mixed derivative, deriving its discrete symbol to precisely determine its order of accuracy and expose any directional dependencies, or anisotropy, in its performance.", "problem": "Consider a uniform Cartesian grid with spacings $h_x$ and $h_y$ in the $x$- and $y$-directions, respectively, and a sufficiently smooth scalar field $u(x,y)$. Mixed normal stresses and rotated diffusive fluxes in computational fluid dynamics often introduce the mixed second derivative operator $\\frac{\\partial^2 u}{\\partial x \\partial y}$. On the grid, approximate this operator at an interior node $(i,j)$ by the 9-point footprint central stencil whose only nonzero coefficients lie on the four diagonal neighbors:\n$$\n\\left(D_{xy}^{h} u\\right)_{i,j} \\;=\\; \\frac{1}{4 h_x h_y} \\left( u_{i+1,j+1} \\;-\\; u_{i+1,j-1} \\;-\\; u_{i-1,j+1} \\;+\\; u_{i-1,j-1} \\right).\n$$\nYour tasks are:\n- Using the definition of the discrete Fourier symbol for a linear, shift-invariant operator acting on the discrete Fourier mode $u_{i,j} = \\exp\\!\\big(i(k_x\\, i\\, h_x + k_y\\, j\\, h_y)\\big)$, derive the exact discrete Fourier symbol $\\sigma_h(k_x,k_y)$ of $D_{xy}^{h}$.\n- Starting from the continuous symbol $\\sigma_c(k_x,k_y)$ associated with the continuous operator $\\frac{\\partial^2}{\\partial x \\partial y}$ acting on $u(x,y) = \\exp\\!\\big(i(k_x x + k_y y)\\big)$, compare $\\sigma_h(k_x,k_y)$ and $\\sigma_c(k_x,k_y)$ via a small-wavenumber expansion and determine the leading-order truncation error and the corresponding formal order of accuracy with respect to $h_x$ and $h_y$.\n- To assess directional anisotropy, specialize to an isotropic grid with $h_x = h_y = h$ and introduce polar wavenumber coordinates $k_x = k \\cos\\theta$ and $k_y = k \\sin\\theta$, where $k \\ge 0$ and $\\theta \\in [0,2\\pi)$. Define the exact relative symbol \n$$\nR(kh,\\theta) \\;=\\; \\frac{\\sigma_h(k\\cos\\theta,\\,k\\sin\\theta)}{\\sigma_c(k\\cos\\theta,\\,k\\sin\\theta)}.\n$$\nInterpret the angular dependence of $R(kh,\\theta)$ for small $kh$ to quantify anisotropy.\n\nAnswer form requirement: As your final answer, provide the single closed-form analytic expression for $R(kh,\\theta)$ in terms of $k$, $h$, and $\\theta$. Do not include any units. No numerical rounding is required.", "solution": "The supplied problem asks for a multi-part analysis of a finite difference stencil for the mixed partial derivative $\\frac{\\partial^2 u}{\\partial x \\partial y}$. The analysis involves Fourier analysis to determine the discrete symbol, the order of accuracy, and the directional anisotropy of the scheme. The problem is well-posed and scientifically sound, so we may proceed with the solution.\n\n### Part 1: Derivation of the Discrete Fourier Symbol\n\nThe problem provides the discrete operator $(D_{xy}^{h})$ acting on a grid function $u_{i,j}$:\n$$ (D_{xy}^{h} u)_{i,j} = \\frac{1}{4 h_x h_y} ( u_{i+1,j+1} - u_{i+1,j-1} - u_{i-1,j+1} + u_{i-1,j-1} ) $$\nThe discrete Fourier symbol $\\sigma_h(k_x,k_y)$ is defined through the action of the operator on a single Fourier mode, $u_{i,j} = \\exp(i(k_x i h_x + k_y j h_y))$, such that $(D_{xy}^{h} u)_{i,j} = \\sigma_h(k_x, k_y) u_{i,j}$.\n\nTo find $\\sigma_h$, we first evaluate the stencil terms for the given Fourier mode. Any shifted term $u_{i+m, j+n}$ can be written as:\n$$ u_{i+m,j+n} = \\exp(i(k_x(i+m)h_x + k_y(j+n)h_y)) = \\exp(i(k_x i h_x + k_y j h_y)) \\exp(i(k_x m h_x + k_y n h_y)) = u_{i,j} \\exp(i(m k_x h_x + n k_y h_y)) $$\nApplying this to the four points in the stencil gives:\n$u_{i+1,j+1} = u_{i,j} \\exp(i(k_x h_x + k_y h_y))$\n$u_{i+1,j-1} = u_{i,j} \\exp(i(k_x h_x - k_y h_y))$\n$u_{i-1,j+1} = u_{i,j} \\exp(i(-k_x h_x + k_y h_y))$\n$u_{i-1,j-1} = u_{i,j} \\exp(i(-k_x h_x - k_y h_y))$\n\nSubstituting these into the operator definition:\n$$ (D_{xy}^{h} u)_{i,j} = \\frac{u_{i,j}}{4 h_x h_y} \\left[ \\exp(i(k_x h_x + k_y h_y)) - \\exp(i(k_x h_x - k_y h_y)) - \\exp(i(-k_x h_x + k_y h_y)) + \\exp(i(-k_x h_x - k_y h_y)) \\right] $$\nLet's simplify the expression in the brackets by factoring:\n$$ \\exp(ik_xh_x)(\\exp(ik_yh_y) - \\exp(-ik_yh_y)) - \\exp(-ik_xh_x)(\\exp(ik_yh_y) - \\exp(-ik_yh_y)) $$\n$$ = (\\exp(ik_xh_x) - \\exp(-ik_xh_x))(\\exp(ik_yh_y) - \\exp(-ik_yh_y)) $$\nUsing Euler's identity, $\\exp(i\\phi) - \\exp(-i\\phi) = 2i\\sin(\\phi)$, the expression becomes:\n$$ (2i \\sin(k_x h_x)) (2i \\sin(k_y h_y)) = 4i^2 \\sin(k_x h_x) \\sin(k_y h_y) = -4 \\sin(k_x h_x) \\sin(k_y h_y) $$\nSubstituting this result back into the equation for $(D_{xy}^{h} u)_{i,j}$:\n$$ (D_{xy}^{h} u)_{i,j} = \\frac{u_{i,j}}{4 h_x h_y} [-4 \\sin(k_x h_x) \\sin(k_y h_y)] = \\left( -\\frac{\\sin(k_x h_x) \\sin(k_y h_y)}{h_x h_y} \\right) u_{i,j} $$\nFrom this, we identify the discrete Fourier symbol as:\n$$ \\sigma_h(k_x, k_y) = -\\frac{\\sin(k_x h_x) \\sin(k_y h_y)}{h_x h_y} $$\n\n### Part 2: Truncation Error and Order of Accuracy\n\nFirst, we determine the continuous symbol $\\sigma_c(k_x, k_y)$ for the continuous operator $L = \\frac{\\partial^2}{\\partial x \\partial y}$ acting on the continuous mode $u(x,y) = \\exp(i(k_x x + k_y y))$.\n$$ \\frac{\\partial^2 u}{\\partial x \\partial y} = \\frac{\\partial}{\\partial x} \\left( \\frac{\\partial u}{\\partial y} \\right) = \\frac{\\partial}{\\partial x} (ik_y u) = (ik_y)(ik_x) u = -k_x k_y u $$\nBy definition, $L u = \\sigma_c u$, so the continuous symbol is:\n$$ \\sigma_c(k_x, k_y) = -k_x k_y $$\nTo determine the truncation error, we perform a Taylor series expansion of $\\sigma_h(k_x, k_y)$ for small wavenumbers, i.e., small $k_x h_x$ and $k_y h_y$. The Taylor series for the sine function is $\\sin(z) = z - z^3/6 + O(z^5)$.\n$$ \\sigma_h(k_x, k_y) = -\\frac{1}{h_x h_y} \\left( k_x h_x - \\frac{(k_x h_x)^3}{6} + \\dots \\right) \\left( k_y h_y - \\frac{(k_y h_y)^3}{6} + \\dots \\right) $$\n$$ \\sigma_h(k_x, k_y) = -\\left( k_x - \\frac{k_x^3 h_x^2}{6} + \\dots \\right) \\left( k_y - \\frac{k_y^3 h_y^2}{6} + \\dots \\right) $$\n$$ \\sigma_h(k_x, k_y) = -\\left( k_x k_y - \\frac{k_x k_y^3 h_y^2}{6} - \\frac{k_y k_x^3 h_x^2}{6} + \\text{h.o.t.} \\right) $$\n$$ \\sigma_h(k_x, k_y) = -k_x k_y + \\frac{k_x k_y}{6}(k_x^2 h_x^2 + k_y^2 h_y^2) + \\text{h.o.t.} $$\nThe difference between the discrete and continuous symbols is $\\sigma_h - \\sigma_c$:\n$$ \\sigma_h - \\sigma_c = \\left( -k_x k_y + \\frac{k_x k_y}{6}(k_x^2 h_x^2 + k_y^2 h_y^2) + \\dots \\right) - (-k_x k_y) = \\frac{k_x k_y}{6}(k_x^2 h_x^2 + k_y^2 h_y^2) + \\dots $$\nThe symbol of the leading-order truncation error is $\\frac{k_x k_y}{6}(k_x^2 h_x^2 + k_y^2 h_y^2)$. Since the error is proportional to $h_x^2$ and $h_y^2$, the formal order of accuracy of the discrete operator is second-order, denoted as $O(h_x^2, h_y^2)$.\n\n### Part 3: Directional Anisotropy\n\nWe now specialize to an isotropic grid with $h_x = h_y = h$. The discrete and continuous symbols become:\n$$ \\sigma_h(k_x, k_y) = -\\frac{\\sin(k_x h) \\sin(k_y h)}{h^2} $$\n$$ \\sigma_c(k_x, k_y) = -k_x k_y $$\nThe relative symbol $R$ is defined as the ratio $\\sigma_h / \\sigma_c$:\n$$ R(k_x, k_y) = \\frac{\\sigma_h(k_x, k_y)}{\\sigma_c(k_x, k_y)} = \\frac{-\\sin(k_x h) \\sin(k_y h)/h^2}{-k_x k_y} = \\frac{\\sin(k_x h) \\sin(k_y h)}{h^2 k_x k_y} = \\left(\\frac{\\sin(k_x h)}{k_x h}\\right) \\left(\\frac{\\sin(k_y h)}{k_y h}\\right) $$\nNext, we introduce polar wavenumber coordinates $k_x = k \\cos\\theta$ and $k_y = k \\sin\\theta$. Substituting these into the expression for $R$:\n$$ R(kh, \\theta) = \\left(\\frac{\\sin((k \\cos\\theta) h)}{(k \\cos\\theta) h}\\right) \\left(\\frac{\\sin((k \\sin\\theta) h)}{(k \\sin\\theta) h}\\right) $$\nThis expression represents the ratio of the discrete to continuous amplification factor as a function of dimensionless wavenumber $kh$ and wave propagation angle $\\theta$. This is the final analytical expression required.\n\nTo interpret the anisotropy, we can expand $R(kh, \\theta)$ for small $kh$. Let $\\xi = kh$.\n$$ R(\\xi, \\theta) = \\left(1 - \\frac{(\\xi \\cos\\theta)^2}{6} + \\dots\\right) \\left(1 - \\frac{(\\xi \\sin\\theta)^2}{6} + \\dots\\right) \\approx 1 - \\frac{\\xi^2}{6}(\\cos^2\\theta + \\sin^2\\theta) = 1 - \\frac{\\xi^2}{6} $$\nTo leading order, the error depends only on the magnitude of the wavenumber ($k$), not its direction ($\\theta$). This shows the scheme is isotropic to the leading error order. However, expanding to the next order reveals the anisotropy:\n$$ R(kh, \\theta) \\approx 1 - \\frac{(kh)^2}{6} + (kh)^4 \\frac{7 - \\cos(4\\theta)}{720} $$\nThe $O((kh)^4)$ term depends on $\\theta$ through $\\cos(4\\theta)$, indicating that the accuracy of the scheme is direction-dependent at this higher order. The error is smallest for waves aligned with the grid axes ($\\theta = n\\pi/2$) and largest for waves aligned with the grid diagonals ($\\theta = \\pi/4 + n\\pi/2$).\n\nThe final answer requires only the closed-form expression for $R(kh, \\theta)$.\n$$ R(kh, \\theta) = \\frac{\\sin(kh \\cos\\theta)}{kh \\cos\\theta} \\frac{\\sin(kh \\sin\\theta)}{kh \\sin\\theta} $$", "answer": "$$\n\\boxed{\\frac{\\sin(kh \\cos\\theta)}{kh \\cos\\theta} \\frac{\\sin(kh \\sin\\theta)}{kh \\sin\\theta}}\n$$", "id": "3310598"}, {"introduction": "Beyond formal accuracy, a high-quality numerical stencil should also preserve fundamental symmetries of the continuous operator it approximates. This practice [@problem_id:3310640] explores the concept of discrete rotational symmetry using a clever diagnostic test. By applying a hypothetical, generalized mixed-derivative operator to the purely radial function $u(x,y) = x^2 + y^2$, for which the continuous mixed derivative is zero, you will derive an expression that directly quantifies the operator's symmetry-breaking error.", "problem": "In Computational Fluid Dynamics (CFD), mixed partial derivatives arise naturally in coordinate-transformed equations and in anisotropic diffusion with non-diagonal diffusivity tensors. Consider a smooth scalar field $u(x,y)$ that models a velocity potential or temperature, and recall that the mixed derivative $\\frac{\\partial^{2} u}{\\partial x \\partial y}$ vanishes for any purely radial quadratic field $u(r)=r^{2}=x^{2}+y^{2}$ in the continuum. On a uniform Cartesian grid with grid spacings $\\Delta x$ and $\\Delta y$, and nodal coordinates $(x_{i},y_{j})=(x_{0}+i\\,\\Delta x,\\;y_{0}+j\\,\\Delta y)$, assess the discrete rotational symmetry of the following candidate linear stencil intended to approximate the mixed derivative at node $(i,j)$:\n$$\n\\mathcal{L}_{xy}[u]_{i,j} \\;=\\; \\frac{1}{\\Delta x\\,\\Delta y}\\Big( \\alpha\\big(u_{i+1,j+1}-u_{i+1,j-1}-u_{i-1,j+1}+u_{i-1,j-1}\\big) \\;+\\; \\beta\\big(u_{i+1,j}-u_{i-1,j}\\big) \\;+\\; \\gamma\\big(u_{i,j+1}-u_{i,j-1}\\big) \\Big),\n$$\nwhere $\\alpha$, $\\beta$, and $\\gamma$ are dimensionless weights. Compute the exact closed-form expression of $\\mathcal{L}_{xy}[u]_{i,j}$ when $u(x,y)=x^{2}+y^{2}$, expressed in terms of $\\alpha$, $\\beta$, $\\gamma$, $\\Delta x$, $\\Delta y$, $x_{i}$, and $y_{j}$. Your answer must be a single analytic expression. Explain, based on your computed expression, how deviations from zero quantify the violation of discrete rotational symmetry for this stencil. No numerical rounding is required, and no units should be included in the final expression.", "solution": "The problem is deemed valid as it is scientifically grounded in the principles of numerical analysis, specifically the study of finite difference methods for partial differential equations. It is well-posed, objective, and contains all necessary information to compute a unique and meaningful solution. The problem asks for the evaluation of a discrete operator on a specific function and an interpretation of the result in the context of discrete symmetry, which is a standard procedure for analyzing numerical stencils.\n\nThe task is to compute the exact closed-form expression of the discrete operator $\\mathcal{L}_{xy}[u]_{i,j}$ for the scalar field $u(x,y) = x^2+y^2$. The operator is defined as:\n$$\n\\mathcal{L}_{xy}[u]_{i,j} \\;=\\; \\frac{1}{\\Delta x\\,\\Delta y}\\Big( \\alpha\\big(u_{i+1,j+1}-u_{i+1,j-1}-u_{i-1,j+1}+u_{i-1,j-1}\\big) \\;+\\; \\beta\\big(u_{i+1,j}-u_{i-1,j}\\big) \\;+\\; \\gamma\\big(u_{i,j+1}-u_{i,j-1}\\big) \\Big)\n$$\nThe grid coordinates are given by $x_k = x_i + (k-i)\\Delta x$ and $y_l = y_j + (l-j)\\Delta y$. For the function $u(x,y) = x^2+y^2$, the value at a generic grid node $(x_k, y_l)$ is $u_{k,l} = x_k^2 + y_l^2$.\n\nWe proceed by evaluating the terms inside the operator's definition. We will analyze the three components of the sum, corresponding to the weights $\\alpha$, $\\beta$, and $\\gamma$, separately.\n\nFirst, consider the term multiplied by $\\alpha$:\n$u_{i+1,j+1}-u_{i+1,j-1}-u_{i-1,j+1}+u_{i-1,j-1}$.\nLet's evaluate the constituent differences:\n$u_{i+1,j+1} - u_{i+1,j-1} = \\left((x_i+\\Delta x)^2+(y_j+\\Delta y)^2\\right) - \\left((x_i+\\Delta x)^2+(y_j-\\Delta y)^2\\right)$\n$= (y_j+\\Delta y)^2 - (y_j-\\Delta y)^2 = (y_j^2+2y_j\\Delta y+\\Delta y^2) - (y_j^2-2y_j\\Delta y+\\Delta y^2) = 4y_j\\Delta y$.\n\n$u_{i-1,j+1} - u_{i-1,j-1} = \\left((x_i-\\Delta x)^2+(y_j+\\Delta y)^2\\right) - \\left((x_i-\\Delta x)^2+(y_j-\\Delta y)^2\\right)$\n$= (y_j+\\Delta y)^2 - (y_j-\\Delta y)^2 = 4y_j\\Delta y$.\n\nCombining these, the term for $\\alpha$ is:\n$(u_{i+1,j+1}-u_{i+1,j-1}) - (u_{i-1,j+1}-u_{i-1,j-1}) = 4y_j\\Delta y - 4y_j\\Delta y = 0$.\nThus, the contribution of the $\\alpha$-term to the operator is zero, regardless of the value of $\\alpha$. This is an important finding, as the standard central difference approximation for $\\frac{\\partial^2 u}{\\partial x \\partial y}$ corresponds to this part of the stencil with $\\alpha=1/4$.\n\nNext, consider the term multiplied by $\\beta$:\n$u_{i+1,j} - u_{i-1,j} = \\left((x_i+\\Delta x)^2+y_j^2\\right) - \\left((x_i-\\Delta x)^2+y_j^2\\right)$\n$= (x_i+\\Delta x)^2 - (x_i-\\Delta x)^2 = (x_i^2+2x_i\\Delta x+\\Delta x^2) - (x_i^2-2x_i\\Delta x+\\Delta x^2) = 4x_i\\Delta x$.\n\nFinally, consider the term multiplied by $\\gamma$:\n$u_{i,j+1} - u_{i,j-1} = \\left(x_i^2+(y_j+\\Delta y)^2\\right) - \\left(x_i^2+(y_j-\\Delta y)^2\\right)$\n$= (y_j+\\Delta y)^2 - (y_j-\\Delta y)^2 = (y_j^2+2y_j\\Delta y+\\Delta y^2) - (y_j^2-2y_j\\Delta y+\\Delta y^2) = 4y_j\\Delta y$.\n\nNow, we substitute these results back into the definition of $\\mathcal{L}_{xy}[u]_{i,j}$:\n$$\n\\mathcal{L}_{xy}[u]_{i,j} = \\frac{1}{\\Delta x\\,\\Delta y}\\Big( \\alpha(0) + \\beta(4x_i\\Delta x) + \\gamma(4y_j\\Delta y) \\Big)\n$$\n$$\n\\mathcal{L}_{xy}[u]_{i,j} = \\frac{1}{\\Delta x\\,\\Delta y}\\Big( 4\\beta x_i\\Delta x + 4\\gamma y_j\\Delta y \\Big)\n$$\nDistributing the leading factor $\\frac{1}{\\Delta x\\Delta y}$ to each term in the parenthesis gives:\n$$\n\\mathcal{L}_{xy}[u]_{i,j} = \\frac{4\\beta x_i\\Delta x}{\\Delta x\\Delta y} + \\frac{4\\gamma y_j\\Delta y}{\\Delta x\\Delta y}\n$$\n$$\n\\mathcal{L}_{xy}[u]_{i,j} = \\frac{4\\beta x_i}{\\Delta y} + \\frac{4\\gamma y_j}{\\Delta x}\n$$\nThis is the final closed-form expression for the action of the discrete operator on the function $u(x,y)=x^2+y^2$.\n\nThe problem also asks for an explanation of how this result quantifies the violation of discrete rotational symmetry. In the continuum, the function $u(x,y)=x^2+y^2$ is purely radial (rotationally symmetric), and its mixed partial derivative is identically zero:\n$$\n\\frac{\\partial^2 u}{\\partial x \\partial y} = \\frac{\\partial}{\\partial x}\\left(\\frac{\\partial}{\\partial y}(x^2+y^2)\\right) = \\frac{\\partial}{\\partial x}(2y) = 0\n$$\nAn ideal discrete operator intended to approximate $\\frac{\\partial^2}{\\partial x \\partial y}$ should preserve this fundamental property, meaning it should also yield zero when applied to the discrete samples of a rotationally symmetric quadratic field. This is a test of the operator's discrete symmetry properties.\n\nOur computed result is $\\mathcal{L}_{xy}[u]_{i,j} = \\frac{4\\beta x_i}{\\Delta y} + \\frac{4\\gamma y_j}{\\Delta x}$. For this expression to be zero for all grid points $(x_i, y_j)$, it is necessary and sufficient that the coefficients of $x_i$ and $y_j$ are both zero. This requires $\\beta=0$ and $\\gamma=0$.\n\nAny non-zero values for $\\beta$ or $\\gamma$ lead to a non-zero result. This non-zero value, $\\frac{4\\beta x_i}{\\Delta y} + \\frac{4\\gamma y_j}{\\Delta x}$, represents the error of the discrete operator for this specific case. This error explicitly breaks rotational symmetry because its value depends on the coordinates $x_i$ and $y_j$ individually, not on the radial distance $r_i = \\sqrt{x_i^2+y_j^2}$. For instance, along the $x$-axis ($y_j=0$), the error is $\\frac{4\\beta x_i}{\\Delta y}$, while along the $y$-axis ($x_i=0$), it is $\\frac{4\\gamma y_j}{\\Delta x}$. A rotationally invariant error would depend only on $r_i$.\n\nThe expression $\\frac{4\\beta x_i}{\\Delta y} + \\frac{4\\gamma y_j}{\\Delta x}$ is therefore a direct, quantitative measure of the stencil's failure to respect the rotational symmetry inherent in the continuum operator it is meant to approximate. The presence of non-zero $\\beta$ and $\\gamma$ \"contaminates\" the mixed-derivative stencil with terms that resemble first-derivative operators ($\\beta$ term is a scaled central difference for $\\frac{\\partial}{\\partial x}$, $\\gamma$ term for $\\frac{\\partial}{\\partial y}$), which are themselves not rotationally invariant. The fact that the $\\alpha$-term evaluates to zero demonstrates that the standard nine-point stencil for the mixed derivative ($\\beta=\\gamma=0$) does correctly preserve this discrete rotational symmetry.", "answer": "$$\\boxed{\\frac{4\\beta x_i}{\\Delta y} + \\frac{4\\gamma y_j}{\\Delta x}}$$", "id": "3310640"}, {"introduction": "Moving from idealized uniform grids to the stretched meshes common in practical CFD applications reveals subtle but critical challenges. A key property in calculus is the commutativity of mixed partial derivatives, $\\frac{\\partial^2 u}{\\partial x \\partial y} = \\frac{\\partial^2 u}{\\partial y \\partial x}$. This exercise [@problem_id:3310685] guides you to demonstrate that this property does not automatically hold for discrete operators on non-uniform grids. By directly calculating the commutator of two simple one-sided difference operators, you will see precisely how grid stretching breaks the symmetry and leads to non-commutativity, a concept crucial for understanding and satisfying the Geometric Conservation Law (GCL).", "problem": "Consider a smooth scalar field $u(x,y)$ on a two-dimensional physical domain and recall the continuous fact that, for sufficiently smooth $u$, the mixed partial derivatives commute, so that $\\frac{\\partial^{2} u}{\\partial x \\partial y} = \\frac{\\partial^{2} u}{\\partial y \\partial x}$. In computational fluid dynamics, partial derivatives are approximated on grids by discrete operators. On non-uniform grids, such discrete operators need not commute.\n\nLet the grid be structured with indices $(i,j)$, and define the physical location of the node $(i,j)$ by $x_{i,j} = \\alpha_{j}\\, i\\, h$ and $y_{i,j} = \\beta_{i}\\, j\\, h$, where $(\\alpha_{j})_{j\\in\\mathbb{Z}}$ and $(\\beta_{i})_{i\\in\\mathbb{Z}}$ are strictly positive sequences encoding grid stretching in the $x$- and $y$-directions, respectively, and $h>0$ is a reference spacing. Thus, the local spacings along coordinate lines are $h^{x}_{i-1/2}(j) = x_{i,j} - x_{i-1,j} = \\alpha_{j}\\, h$ and $h^{y}_{j+1/2}(i) = y_{i,j+1} - y_{i,j} = \\beta_{i}\\, h$. Define the discrete first-derivative operators at $(i,j)$ by the first-order backward difference in $x$ and the first-order forward difference in $y$:\n$$\nD_{x} u(i,j) = \\frac{u_{i,j} - u_{i-1,j}}{h^{x}_{i-1/2}(j)} = \\frac{u_{i,j} - u_{i-1,j}}{\\alpha_{j}\\, h}, \n\\qquad\nD_{y} u(i,j) = \\frac{u_{i,j+1} - u_{i,j}}{h^{y}_{j+1/2}(i)} = \\frac{u_{i,j+1} - u_{i,j}}{\\beta_{i}\\, h}.\n$$\nThese choices are representative of one-sided discrete gradients commonly used in flux-conservative discretizations.\n\nLet the test field be the bilinear function $u(x,y) = x\\, y$, so that $u_{i,j} = u(x_{i,j}, y_{i,j}) = x_{i,j}\\, y_{i,j}$. Consider an interior node $(i,j)$ where the neighbors $(i-1,j)$ and $(i,j+1)$ are available.\n\nDefine the grid-stretching ratios\n$$\nr_{x}(j) = \\frac{\\alpha_{j+1}}{\\alpha_{j}}, \n\\qquad\nr_{y}(i) = \\frac{\\beta_{i-1}}{\\beta_{i}},\n$$\nwhich quantify how spacings change when moving one index in the transverse direction.\n\nTask: Starting from the definitions above and without invoking any pre-derived discrete commutator identities, compute $D_{x} D_{y} u(i,j)$ and $D_{y} D_{x} u(i,j)$ at the generic interior node $(i,j)$ and simplify their difference $[D_{x}, D_{y}]\\, u(i,j) := D_{x} D_{y} u(i,j) - D_{y} D_{x} u(i,j)$. Express your final answer solely as a closed-form analytic expression in terms of $i$, $j$, $r_{x}(j)$, and $r_{y}(i)$. No numerical evaluation is required.", "solution": "The problem is valid as it is scientifically grounded, well-posed, objective, and contains a complete and consistent set of definitions. It presents a standard, albeit detailed, calculation in the field of numerical analysis for partial differential equations. We may proceed with the solution.\n\nThe task is to compute the commutator of the discrete derivative operators, $[D_{x}, D_{y}]\\, u(i,j) = D_{x} D_{y} u(i,j) - D_{y} D_{x} u(i,j)$, for the specified test field $u(x,y) = x\\,y$ on the given non-uniform grid.\n\nFirst, we express the discrete field $u_{i,j}$ using the definitions of the grid coordinates $x_{i,j} = \\alpha_{j}\\,i\\,h$ and $y_{i,j} = \\beta_{i}\\,j\\,h$.\n$$\nu_{i,j} = u(x_{i,j}, y_{i,j}) = x_{i,j} y_{i,j} = (\\alpha_{j}\\,i\\,h)(\\beta_{i}\\,j\\,h) = i\\,j\\,\\alpha_{j}\\,\\beta_{i}\\,h^{2}\n$$\nWe will compute the two terms of the commutator, $D_{x} D_{y} u(i,j)$ and $D_{y} D_{x} u(i,j)$, separately.\n\nLet's start by calculating $D_{x} D_{y} u(i,j)$. We first evaluate the inner operation, $v(i,j) = D_{y} u(i,j)$.\nThe operator $D_{y}$ is defined as:\n$$\nD_{y} u(i,j) = \\frac{u_{i,j+1} - u_{i,j}}{\\beta_{i}\\,h}\n$$\nWe need the value of $u$ at the node $(i, j+1)$:\n$$\nu_{i,j+1} = x_{i,j+1} y_{i,j+1} = (\\alpha_{j+1}\\,i\\,h)(\\beta_{i}\\,(j+1)\\,h) = i\\,(j+1)\\,\\alpha_{j+1}\\,\\beta_{i}\\,h^{2}\n$$\nSubstituting $u_{i,j}$ and $u_{i,j+1}$ into the expression for $D_{y} u(i,j)$:\n$$\nv(i,j) = D_{y} u(i,j) = \\frac{i\\,(j+1)\\,\\alpha_{j+1}\\,\\beta_{i}\\,h^{2} - i\\,j\\,\\alpha_{j}\\,\\beta_{i}\\,h^{2}}{\\beta_{i}\\,h}\n$$\nFactoring out common terms:\n$$\nv(i,j) = \\frac{i\\,\\beta_{i}\\,h^{2} \\left((j+1)\\,\\alpha_{j+1} - j\\,\\alpha_{j}\\right)}{\\beta_{i}\\,h} = i\\,h \\left((j+1)\\,\\alpha_{j+1} - j\\,\\alpha_{j}\\right)\n$$\nNow, we apply the $D_{x}$ operator to $v(i,j)$. The operator $D_{x}$ is defined as:\n$$\nD_{x} v(i,j) = \\frac{v(i,j) - v(i-1,j)}{\\alpha_{j}\\,h}\n$$\nWe need $v(i-1,j)$, which is obtained by substituting $i-1$ for $i$ in the expression for $v(i,j)$:\n$$\nv(i-1,j) = (i-1)\\,h \\left((j+1)\\,\\alpha_{j+1} - j\\,\\alpha_{j}\\right)\n$$\nSubstituting $v(i,j)$ and $v(i-1,j)$ into the expression for $D_{x}v(i,j)$:\n$$\nD_{x} D_{y} u(i,j) = \\frac{i\\,h \\left((j+1)\\,\\alpha_{j+1} - j\\,\\alpha_{j}\\right) - (i-1)\\,h \\left((j+1)\\,\\alpha_{j+1} - j\\,\\alpha_{j}\\right)}{\\alpha_{j}\\,h}\n$$\nFactoring out the common term in the numerator:\n$$\nD_{x} D_{y} u(i,j) = \\frac{(i - (i-1))\\,h \\left((j+1)\\,\\alpha_{j+1} - j\\,\\alpha_{j}\\right)}{\\alpha_{j}\\,h} = \\frac{\\left((j+1)\\,\\alpha_{j+1} - j\\,\\alpha_{j}\\right)}{\\alpha_{j}}\n$$\n$$\nD_{x} D_{y} u(i,j) = (j+1)\\,\\frac{\\alpha_{j+1}}{\\alpha_{j}} - j\n$$\nUsing the given grid-stretching ratio $r_{x}(j) = \\frac{\\alpha_{j+1}}{\\alpha_{j}}$, we get:\n$$\nD_{x} D_{y} u(i,j) = (j+1)\\,r_{x}(j) - j\n$$\n\nNext, we calculate $D_{y} D_{x} u(i,j)$. We first evaluate the inner operation, $w(i,j) = D_{x} u(i,j)$.\n$$\nD_{x} u(i,j) = \\frac{u_{i,j} - u_{i-1,j}}{\\alpha_{j}\\,h}\n$$\nWe need the value of $u$ at the node $(i-1, j)$:\n$$\nu_{i-1,j} = x_{i-1,j} y_{i-1,j} = (\\alpha_{j}\\,(i-1)\\,h)(\\beta_{i-1}\\,j\\,h) = j\\,(i-1)\\,\\alpha_{j}\\,\\beta_{i-1}\\,h^{2}\n$$\nSubstituting $u_{i,j}$ and $u_{i-1,j}$ into the expression for $D_{x} u(i,j)$:\n$$\nw(i,j) = D_{x} u(i,j) = \\frac{i\\,j\\,\\alpha_{j}\\,\\beta_{i}\\,h^{2} - j\\,(i-1)\\,\\alpha_{j}\\,\\beta_{i-1}\\,h^{2}}{\\alpha_{j}\\,h}\n$$\nFactoring out common terms:\n$$\nw(i,j) = \\frac{j\\,\\alpha_{j}\\,h^{2} \\left(i\\,\\beta_{i} - (i-1)\\,\\beta_{i-1}\\right)}{\\alpha_{j}\\,h} = j\\,h \\left(i\\,\\beta_{i} - (i-1)\\,\\beta_{i-1}\\right)\n$$\nNow, we apply the $D_{y}$ operator to $w(i,j)$:\n$$\nD_{y} w(i,j) = \\frac{w(i,j+1) - w(i,j)}{\\beta_{i}\\,h}\n$$\nWe need $w(i,j+1)$, which is obtained by substituting $j+1$ for $j$ in the expression for $w(i,j)$:\n$$\nw(i,j+1) = (j+1)\\,h \\left(i\\,\\beta_{i} - (i-1)\\,\\beta_{i-1}\\right)\n$$\nSubstituting $w(i,j)$ and $w(i,j+1)$ into the expression for $D_{y}w(i,j)$:\n$$\nD_{y} D_{x} u(i,j) = \\frac{(j+1)\\,h \\left(i\\,\\beta_{i} - (i-1)\\,\\beta_{i-1}\\right) - j\\,h \\left(i\\,\\beta_{i} - (i-1)\\,\\beta_{i-1}\\right)}{\\beta_{i}\\,h}\n$$\nFactoring out the common term in the numerator:\n$$\nD_{y} D_{x} u(i,j) = \\frac{((j+1) - j)\\,h \\left(i\\,\\beta_{i} - (i-1)\\,\\beta_{i-1}\\right)}{\\beta_{i}\\,h} = \\frac{i\\,\\beta_{i} - (i-1)\\,\\beta_{i-1}}{\\beta_{i}}\n$$\n$$\nD_{y} D_{x} u(i,j) = i - (i-1)\\,\\frac{\\beta_{i-1}}{\\beta_{i}}\n$$\nUsing the given grid-stretching ratio $r_{y}(i) = \\frac{\\beta_{i-1}}{\\beta_{i}}$, we get:\n$$\nD_{y} D_{x} u(i,j) = i - (i-1)\\,r_{y}(i)\n$$\n\nFinally, we compute the difference to find the commutator:\n$$\n[D_{x}, D_{y}]\\, u(i,j) = D_{x} D_{y} u(i,j) - D_{y} D_{x} u(i,j) = \\left((j+1)\\,r_{x}(j) - j\\right) - \\left(i - (i-1)\\,r_{y}(i)\\right)\n$$\nThis expression simplifies to:\n$$\n[D_{x}, D_{y}]\\, u(i,j) = (j+1)(r_x(j) - 1) + (i-1)(r_y(i) - 1)\n$$\nThis final form clearly shows that the commutator vanishes if the grid is uniform in both directions (i.e., $r_x(j)=1$ and $r_y(i)=1$).", "answer": "$$\n\\boxed{(j+1)(r_x(j) - 1) + (i-1)(r_y(i) - 1)}\n$$", "id": "3310685"}]}