{"hands_on_practices": [{"introduction": "To truly master a numerical method, it is essential to understand its construction from first principles. This exercise guides you through the derivation of the second-order upwind scheme using fundamental Taylor series expansions. By combining this spatial discretization with an implicit backward Euler time-stepping method, you will construct the full stencil for the resulting linear system, a common task when solving for steady-state solutions or when stability, rather than time-accuracy, is the primary concern [@problem_id:3361022]. This process illuminates the mathematical foundation of the scheme and how the upwind direction is chosen based on the physics of information flow.", "problem": "Consider the constant-coefficient linear advection equation $u_{t} + a\\,u_{x} = 0$ for a scalar field $u(x,t)$, where $a \\in \\mathbb{R}$ is constant. On a uniform spatial grid $x_{i} = x_{0} + i\\,\\Delta x$ with grid spacing $\\Delta x  0$ and a uniform time step $\\Delta t  0$, formulate a fully implicit backward Euler time discretization for the advection equation. For the spatial derivative $u_{x}$, use a second-order accurate upwind-biased finite difference operator constructed from Taylor series as follows: when $a0$, the spatial operator must be biased to the left of $x_{i}$ in a way that achieves second-order accuracy; when $a0$, it must be biased to the right of $x_{i}$ in a way that achieves second-order accuracy. Work at a generic interior node $x_{i}$, and assume sufficient smoothness of $u$ for the Taylor expansions to be valid. Starting from first principles and the Taylor expansions, derive the local linear system row that couples the unknowns at time level $t^{n+1}$, and collect the coefficients multiplying $u_{i-2}^{n+1}$, $u_{i-1}^{n+1}$, $u_{i}^{n+1}$, $u_{i+1}^{n+1}$, and $u_{i+2}^{n+1}$ on the left-hand side.\n\nExpress your final answer as a single closed-form analytic expression, in terms of $\\Delta t$, $a$, and $\\Delta x$, using the sign function $\\operatorname{sgn}(a)$ to unify the $a0$ and $a0$ cases. Order the coefficients as $\\left[u_{i-2}^{n+1},\\,u_{i-1}^{n+1},\\,u_{i}^{n+1},\\,u_{i+1}^{n+1},\\,u_{i+2}^{n+1}\\right]$. No rounding is required and no physical units are to be included in the final answer.", "solution": "The problem requires the derivation of the fully implicit finite difference scheme for the linear advection equation, $u_{t} + a\\,u_{x} = 0$, using a backward Euler method for time and a second-order accurate upwind-biased operator for space.\n\n### Step 1: Time Discretization\nThe given partial differential equation is:\n$$u_{t} + a\\,u_{x} = 0$$\nWe discretize in time using a fully implicit backward Euler scheme. Let $u_{i}^{n}$ denote the numerical approximation of $u(x_{i}, t^{n})$, where $x_i = x_0 + i\\,\\Delta x$ and $t^n = n\\,\\Delta t$. The time derivative $u_t$ at time level $t^{n+1}$ is approximated by a first-order backward difference:\n$$\\left(u_{t}\\right)_{i}^{n+1} \\approx \\frac{u_{i}^{n+1} - u_{i}^{n}}{\\Delta t}$$\nFor a fully implicit scheme, the spatial derivative $u_x$ is also evaluated at the new time level $t^{n+1}$. The discretized equation becomes:\n$$\\frac{u_{i}^{n+1} - u_{i}^{n}}{\\Delta t} + a \\left(u_{x}\\right)_{i}^{n+1} = 0$$\nRearranging the terms to place all unknowns at time level $n+1$ on the left-hand side (LHS) and knowns at time level $n$ on the right-hand side (RHS) yields:\n$$u_{i}^{n+1} + a \\Delta t \\left(u_{x}\\right)_{i}^{n+1} = u_{i}^{n}$$\nOur task is to determine the explicit form of the spatial operator $\\left(u_{x}\\right)_{i}^{n+1}$ and then find the coefficients of the terms on the LHS.\n\n### Step 2: Second-Order Upwind Spatial Discretization\nThe spatial operator must be second-order accurate and upwind-biased. The direction of \"upwind\" depends on the sign of the advection speed $a$.\n\n**Case 1: Advection speed $a  0$**\nFor $a0$, information propagates from left to right. An upwind-biased scheme must use nodes to the left of $x_i$ (i.e., with indices less than $i$). For second-order accuracy, a three-point stencil is required. We choose the stencil $\\{x_{i-2}, x_{i-1}, x_i\\}$.\nWe seek an approximation of the form:\n$$\\left(u_{x}\\right)_{i} \\approx c_{2} u_{i-2} + c_{1} u_{i-1} + c_{0} u_{i}$$\nTo find the coefficients $c_0, c_1, c_2$, we use Taylor series expansions of $u_{i-1}$ and $u_{i-2}$ around $x_i$:\n$$u_{i-1} = u(x_i - \\Delta x) = u_i - \\Delta x (u_x)_i + \\frac{(\\Delta x)^2}{2} (u_{xx})_i - \\frac{(\\Delta x)^3}{6} (u_{xxx})_i + O((\\Delta x)^4)$$\n$$u_{i-2} = u(x_i - 2\\Delta x) = u_i - 2\\Delta x (u_x)_i + \\frac{4(\\Delta x)^2}{2} (u_{xx})_i - \\frac{8(\\Delta x)^3}{6} (u_{xxx})_i + O((\\Delta x)^4)$$\nSubstituting these into the approximation and grouping terms by derivatives of $u$:\n$$c_{2}u_{i-2} + c_{1}u_{i-1} + c_{0}u_{i} = (c_{0}+c_{1}+c_{2})u_{i} - (c_{1}+2c_{2})\\Delta x (u_x)_i + (c_{1}+4c_{2})\\frac{(\\Delta x)^2}{2}(u_{xx})_i - \\dots$$\nFor this to approximate $(u_x)_i$ with second-order accuracy, we must satisfy:\n1.  Coefficient of $u_i$: $c_{0}+c_{1}+c_{2} = 0$\n2.  Coefficient of $(u_x)_i$: $-(c_{1}+2c_{2})\\Delta x = 1$\n3.  Coefficient of $(u_{xx})_i$: $(c_{1}+4c_{2})\\frac{(\\Delta x)^2}{2} = 0 \\implies c_{1}+4c_{2}=0$\n\nSolving this system of linear equations:\nFrom (3), $c_{1} = -4c_{2}$. Substituting into (2): $-(-4c_{2}+2c_{2})\\Delta x = 1 \\implies 2c_{2}\\Delta x = 1 \\implies c_{2} = \\frac{1}{2\\Delta x}$.\nThen $c_{1} = -4\\left(\\frac{1}{2\\Delta x}\\right) = -\\frac{2}{\\Delta x}$.\nFrom (1), $c_{0} = -c_{1}-c_{2} = -(-\\frac{2}{\\Delta x}) - \\frac{1}{2\\Delta x} = \\frac{3}{2\\Delta x}$.\nSo, for $a0$, the spatial operator is:\n$$\\left(u_{x}\\right)_{i} = \\frac{u_{i-2} - 4u_{i-1} + 3u_{i}}{2\\Delta x}$$\nNote the coefficients were $c_2, c_1, c_0$. A more intuitive ordering leads to: $\\frac{3u_i - 4u_{i-1} + u_{i-2}}{2\\Delta x}$. The error is of order $O((\\Delta x)^2)$.\n\n**Case 2: Advection speed $a  0$**\nFor $a0$, information propagates from right to left. An upwind-biased scheme must use nodes to the right of $x_i$. We choose the stencil $\\{x_i, x_{i+1}, x_{i+2}\\}$.\nThe approximation is of the form:\n$$\\left(u_{x}\\right)_{i} \\approx d_{0} u_{i} + d_{1} u_{i+1} + d_{2} u_{i+2}$$\nUsing Taylor expansions of $u_{i+1}$ and $u_{i+2}$ around $x_i$:\n$$u_{i+1} = u(x_i + \\Delta x) = u_i + \\Delta x (u_x)_i + \\frac{(\\Delta x)^2}{2} (u_{xx})_i + \\dots$$\n$$u_{i+2} = u(x_i + 2\\Delta x) = u_i + 2\\Delta x (u_x)_i + \\frac{4(\\Delta x)^2}{2} (u_{xx})_i + \\dots$$\nA symmetric argument yields the system:\n1.  $d_{0}+d_{1}+d_{2} = 0$\n2.  $(d_{1}+2d_{2})\\Delta x = 1$\n3.  $(d_{1}+4d_{2})=0$\nSolving gives: $d_{2} = -\\frac{1}{2\\Delta x}$, $d_{1} = \\frac{2}{\\Delta x}$, $d_{0} = -\\frac{3}{2\\Delta x}$.\nSo, for $a0$, the operator is:\n$$\\left(u_{x}\\right)_{i} = \\frac{-3u_{i} + 4u_{i+1} - u_{i+2}}{2\\Delta x}$$\n\n### Step 3: Assembling the Full Discretization and Unifying Cases\nWe now substitute the appropriate spatial operator into the semi-discretized equation $u_{i}^{n+1} + a \\Delta t \\left(u_{x}\\right)_{i}^{n+1} = u_{i}^{n}$.\n\n**For $a  0$:**\n$$u_{i}^{n+1} + a \\Delta t \\left( \\frac{3u_{i}^{n+1} - 4u_{i-1}^{n+1} + u_{i-2}^{n+1}}{2\\Delta x} \\right) = u_{i}^{n}$$\nCollecting coefficients for the unknowns on the LHS:\n$$\\left(\\frac{a \\Delta t}{2\\Delta x}\\right)u_{i-2}^{n+1} - \\left(\\frac{2a \\Delta t}{\\Delta x}\\right)u_{i-1}^{n+1} + \\left(1 + \\frac{3a \\Delta t}{2\\Delta x}\\right)u_{i}^{n+1} = u_{i}^{n}$$\nThe coefficients for $(u_{i-2}^{n+1}, u_{i-1}^{n+1}, u_{i}^{n+1}, u_{i+1}^{n+1}, u_{i+2}^{n+1})$ are:\n$\\left[ \\frac{a \\Delta t}{2\\Delta x}, -\\frac{2a \\Delta t}{\\Delta x}, 1 + \\frac{3a \\Delta t}{2\\Delta x}, 0, 0 \\right]$\n\n**For $a  0$:**\n$$u_{i}^{n+1} + a \\Delta t \\left( \\frac{-3u_{i}^{n+1} + 4u_{i+1}^{n+1} - u_{i+2}^{n+1}}{2\\Delta x} \\right) = u_{i}^{n}$$\nCollecting coefficients for the unknowns on the LHS:\n$$\\left(1 - \\frac{3a \\Delta t}{2\\Delta x}\\right)u_{i}^{n+1} + \\left(\\frac{2a \\Delta t}{\\Delta x}\\right)u_{i+1}^{n+1} - \\left(\\frac{a \\Delta t}{2\\Delta x}\\right)u_{i+2}^{n+1} = u_{i}^{n}$$\nThe coefficients for $(u_{i-2}^{n+1}, u_{i-1}^{n+1}, u_{i}^{n+1}, u_{i+1}^{n+1}, u_{i+2}^{n+1})$ are:\n$\\left[ 0, 0, 1 - \\frac{3a \\Delta t}{2\\Delta x}, \\frac{2a \\Delta t}{\\Delta x}, -\\frac{a \\Delta t}{2\\Delta x} \\right]$\n\n**Unification using $\\operatorname{sgn}(a)$:**\nWe unify these two sets of coefficients using the sign function, $\\operatorname{sgn}(a)$. Note that $|a| = a \\operatorname{sgn}(a)$.\n- **Coefficient of $u_{i-2}^{n+1}$**: It is non-zero only for $a0$. We can use the factor $\\frac{1+\\operatorname{sgn}(a)}{2}$, which is $1$ for $a0$ and $0$ for $a0$.\n  Coefficient = $\\frac{a \\Delta t}{2\\Delta x} \\frac{1+\\operatorname{sgn}(a)}{2} = \\frac{a \\Delta t (1+\\operatorname{sgn}(a))}{4\\Delta x}$.\n- **Coefficient of $u_{i-1}^{n+1}$**: Non-zero only for $a0$.\n  Coefficient = $-\\frac{2a \\Delta t}{\\Delta x} \\frac{1+\\operatorname{sgn}(a)}{2} = -\\frac{a \\Delta t (1+\\operatorname{sgn}(a))}{\\Delta x}$.\n- **Coefficient of $u_{i+2}^{n+1}$**: Non-zero only for $a0$. We can use $\\frac{1-\\operatorname{sgn}(a)}{2}$.\n  Coefficient = $-\\frac{a \\Delta t}{2\\Delta x} \\frac{1-\\operatorname{sgn}(a)}{2} = -\\frac{a \\Delta t (1-\\operatorname{sgn}(a))}{4\\Delta x}$.\n- **Coefficient of $u_{i+1}^{n+1}$**: Non-zero only for $a0$.\n  Coefficient = $\\frac{2a \\Delta t}{\\Delta x} \\frac{1-\\operatorname{sgn}(a)}{2} = \\frac{a \\Delta t (1-\\operatorname{sgn}(a))}{\\Delta x}$.\n- **Coefficient of $u_{i}^{n+1}$**:\n  For $a0$: $1 + \\frac{3a \\Delta t}{2\\Delta x}$. For $a0$: $1 - \\frac{3a \\Delta t}{2\\Delta x}$.\n  We can write this as $1 + \\frac{3|a|\\Delta t}{2\\Delta x}$. Using $a \\operatorname{sgn}(a) = |a|$, this becomes $1 + \\frac{3 a \\operatorname{sgn}(a) \\Delta t}{2 \\Delta x}$. This expression works for both signs of $a$.\n  If $a0$, $\\operatorname{sgn}(a)=1 \\implies 1 + \\frac{3a\\Delta t}{2\\Delta x}$.\n  If $a0$, $\\operatorname{sgn}(a)=-1 \\implies 1 - \\frac{3a\\Delta t}{2\\Delta x}$.\n\nThe unified vector of coefficients for $[u_{i-2}^{n+1},\\,u_{i-1}^{n+1},\\,u_{i}^{n+1},\\,u_{i+1}^{n+1},\\,u_{i+2}^{n+1}]$ is:\n$$\n\\left[\n\\frac{a \\Delta t (1+\\operatorname{sgn}(a))}{4 \\Delta x}, \\enspace\n-\\frac{a \\Delta t (1+\\operatorname{sgn}(a))}{\\Delta x}, \\enspace\n1 + \\frac{3 a \\operatorname{sgn}(a) \\Delta t}{2 \\Delta x}, \\enspace\n\\frac{a \\Delta t (1-\\operatorname{sgn}(a))}{\\Delta x}, \\enspace\n-\\frac{a \\Delta t (1-\\operatorname{sgn}(a))}{4 \\Delta x}\n\\right]\n$$", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{a \\Delta t (1 + \\operatorname{sgn}(a))}{4 \\Delta x}  -\\frac{a \\Delta t (1 + \\operatorname{sgn}(a))}{\\Delta x}  1 + \\frac{3 a \\operatorname{sgn}(a) \\Delta t}{2 \\Delta x}  \\frac{a \\Delta t (1 - \\operatorname{sgn}(a))}{\\Delta x}  -\\frac{a \\Delta t (1 - \\operatorname{sgn}(a))}{4 \\Delta x}\n\\end{pmatrix}\n}\n$$", "id": "3361022"}, {"introduction": "Theoretical derivations must be confirmed by numerical evidence. This hands-on coding practice implements the second-order upwind scheme to solve the linear advection equation and verifies its accuracy using the Method of Manufactured Solutions (MMS). By performing a grid refinement study and applying Richardson extrapolation, you will numerically measure the scheme's order of convergence [@problem_id:3360956]. This is a critical skill in computational science, ensuring that your code is free of bugs and performs as designed.", "problem": "Consider the one-dimensional linear advection equation $u_t + a u_x = 0$ on a periodic domain $[0,L)$ with constant advection speed $a \\in \\mathbb{R}\\setminus\\{0\\}$. You will use the Method of Manufactured Solutions to design a smooth periodic exact solution and then perform a grid refinement study of a fully discrete scheme that uses a second-order upwind discretization in space and a high-order explicit time integrator with a time step small enough to make the temporal error negligible relative to the spatial discretization error.\n\nStarting from the fundamental conservation law and constant-coefficient advection model, and using the definition of periodic boundary conditions and smooth periodic functions, construct a manufactured solution that satisfies $u_t + a u_x = 0$ for all $t \\ge 0$:\n- Choose the manufactured initial condition $u(x,0) = \\sin\\!\\big(2\\pi x/L\\big) + \\tfrac{1}{4}\\cos\\!\\big(6\\pi x/L\\big)$, where all trigonometric arguments are in radians. Then the exact solution for any $t \\ge 0$ is $u_{\\text{exact}}(x,t) = \\sin\\!\\big(2\\pi (x - a t)/L\\big) + \\tfrac{1}{4}\\cos\\!\\big(6\\pi (x - a t)/L\\big)$ under periodicity.\n\nDiscretize space on a uniform grid $x_i = i \\Delta x$ for $i=0,\\dots,N-1$ with $\\Delta x = L/N$ and periodic wrap-around indexing. Discretize the spatial derivative $u_x$ using the second-order upwind finite-difference operator:\n- For $a  0$,\n$$\n\\left(D_x u\\right)_i \\;=\\; \\frac{3 u_i - 4 u_{i-1} + u_{i-2}}{2\\,\\Delta x}.\n$$\n- For $a  0$,\n$$\n\\left(D_x u\\right)_i \\;=\\; \\frac{-3 u_i + 4 u_{i+1} - u_{i+2}}{2\\,\\Delta x}.\n$$\nUse periodic boundary conditions to define $u_{i\\pm 1}$ and $u_{i\\pm 2}$ for all $i$.\n\nAdvance in time with the third-order Strong Stability Preserving (SSP) Runge–Kutta method (also known as Shu–Osher form), which for the semi-discrete system $u_t = -a\\,D_x u$ reads\n$$\n\\begin{aligned}\nu^{(1)} = u^n + \\Delta t\\,\\mathcal{L}(u^n),\\\\\nu^{(2)} = \\tfrac{3}{4}u^n + \\tfrac{1}{4}\\left(u^{(1)} + \\Delta t\\,\\mathcal{L}(u^{(1)})\\right),\\\\\nu^{n+1} = \\tfrac{1}{3}u^n + \\tfrac{2}{3}\\left(u^{(2)} + \\Delta t\\,\\mathcal{L}(u^{(2)})\\right),\n\\end{aligned}\n$$\nwhere $\\mathcal{L}(u) = -a\\,D_x u$. Choose the time step $\\Delta t = \\text{CFL}\\,\\Delta x/|a|$ with a Courant–Friedrichs–Lewy (CFL) number $\\text{CFL} = 0.3$ so that the temporal error of order $\\mathcal{O}(\\Delta t^3)$ is negligible compared to the spatial error of order $\\mathcal{O}(\\Delta x^2)$ as $\\Delta x \\to 0$.\n\nFor a given final time $T0$, compute the numerical solution $u^N_i \\approx u(x_i,T)$, and measure the discrete $L^2$-error\n$$\nE(N) \\;=\\; \\left(\\sum_{i=0}^{N-1}\\left(u^N_i - u_{\\text{exact}}(x_i,T)\\right)^2\\Delta x\\right)^{1/2}.\n$$\nUsing a refinement ratio $r=2$ and consecutive grids $N, 2N, 4N, 8N$, estimate the observed spatial order $p$ via Richardson extrapolation between successive grids,\n$$\np(N \\to 2N) \\;=\\; \\frac{\\ln\\!\\left(\\dfrac{E(N)}{E(2N)}\\right)}{\\ln(2)}.\n$$\nTo minimize any potential contamination by coarse-grid pre-asymptotic effects, report the finest-grid pair estimate $p(4N \\to 8N)$ as the observed order for each test case.\n\nImplement the above as a complete, runnable program that:\n- Uses the manufactured solution stated above.\n- Employs the second-order upwind spatial discretization and the third-order SSP Runge–Kutta time integrator as specified.\n- Uses a uniform grid with periodic boundary conditions.\n- Uses $\\Delta t = 0.3\\,\\Delta x/|a|$.\n- Computes $E(N)$ for $N \\in \\{64,128,256,512\\}$, and outputs the Richardson estimate based on $E(256)$ and $E(512)$.\n\nTest Suite:\nProvide results for the following three parameter sets, which together test a representative case, a negative-advection case, and a single-period transport:\n- Case A (representative): $a = 1.3$, $L = 1.0$, $T = 0.3$.\n- Case B (negative advection): $a = -0.7$, $L = 1.0$, $T = 0.25$.\n- Case C (one period): $a = 1.0$, $L = 1.0$, $T = 1.0$.\n\nAngle units: All trigonometric functions use radians.\n\nFinal Output Format:\nYour program should produce a single line of output containing the three observed orders corresponding to Cases A, B, and C, as a comma-separated list of decimal numbers enclosed in square brackets, for example $[p_A,p_B,p_C]$. The values should be decimal floats. No additional text should be printed.", "solution": "The problem is subjected to validation before a solution is attempted.\n\n### Step 1: Extract Givens\n- **Governing Equation**: One-dimensional linear advection equation, $u_t + a u_x = 0$.\n- **Domain**: Periodic, $[0, L)$.\n- **Advection Speed**: Constant, $a \\in \\mathbb{R}\\setminus\\{0\\}$.\n- **Methodology**: Method of Manufactured Solutions.\n- **Initial Condition**: $u(x,0) = \\sin(2\\pi x/L) + \\tfrac{1}{4}\\cos(6\\pi x/L)$. All trigonometric function arguments are in radians.\n- **Exact Solution**: $u_{\\text{exact}}(x,t) = \\sin(2\\pi (x - a t)/L) + \\tfrac{1}{4}\\cos(6\\pi (x - a t)/L)$.\n- **Spatial Grid**: Uniform grid $x_i = i \\Delta x$ for $i=0,\\dots,N-1$, with $\\Delta x = L/N$.\n- **Spatial Discretization**: Second-order upwind finite-difference operator.\n  - For $a  0$: $\\left(D_x u\\right)_i = \\frac{3 u_i - 4 u_{i-1} + u_{i-2}}{2\\,\\Delta x}$.\n  - For $a  0$: $\\left(D_x u\\right)_i = \\frac{-3 u_i + 4 u_{i+1} - u_{i+2}}{2\\,\\Delta x}$.\n- **Boundary Conditions**: Periodic for stencil operations.\n- **Time Integration**: Third-order Strong Stability Preserving (SSP) Runge–Kutta a.k.a. Shu–Osher form for $u_t = \\mathcal{L}(u) = -a\\,D_x u$:\n  $$\n  \\begin{aligned}\n  u^{(1)} = u^n + \\Delta t\\,\\mathcal{L}(u^n),\\\\\n  u^{(2)} = \\tfrac{3}{4}u^n + \\tfrac{1}{4}\\left(u^{(1)} + \\Delta t\\,\\mathcal{L}(u^{(1)})\\right),\\\\\n  u^{n+1} = \\tfrac{1}{3}u^n + \\tfrac{2}{3}\\left(u^{(2)} + \\Delta t\\,\\mathcal{L}(u^{(2)})\\right).\n  \\end{aligned}\n  $$\n- **Time Step**: $\\Delta t = \\text{CFL}\\,\\Delta x/|a|$ with $\\text{CFL} = 0.3$.\n- **Error Metric**: Discrete $L^2$-error, $E(N) = \\left(\\sum_{i=0}^{N-1}\\left(u^N_i - u_{\\text{exact}}(x_i,T)\\right)^2\\Delta x\\right)^{1/2}$.\n- **Convergence Analysis**:\n  - Grid refinement study with $N \\in \\{64, 128, 256, 512\\}$.\n  - Observed order estimation: $p(N \\to 2N) = \\frac{\\ln(E(N)/E(2N))}{\\ln(2)}$.\n  - Reported Order: The estimate from the finest grid pair, $p(256 \\to 512)$.\n- **Test Cases**:\n  - Case A: $a = 1.3$, $L = 1.0$, $T = 0.3$.\n  - Case B: $a = -0.7$, $L = 1.0$, $T = 0.25$.\n  - Case C: $a = 1.0$, $L = 1.0$, $T = 1.0$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically and mathematically sound.\n1.  **Scientific Grounding**: The problem concerns the numerical solution of the linear advection equation, a fundamental model in transport phenomena. All specified components—the Method of Manufactured Solutions, upwind finite-difference schemes, and SSP Runge-Kutta methods—are standard, well-documented techniques in computational physics and numerical analysis. The provided formulas are correct representations of these methods.\n2.  **Well-Posedness**: The problem is well-posed. The linear advection equation with a smooth, periodic initial condition has a unique, stable analytical solution. The numerical scheme is also well-defined, with a specified stable time step (the CFL number of $0.3$ is well within the stability limits of the combined scheme). The task is to compute a specific, uniquely defined numerical quantity (the observed order of accuracy).\n3.  **Completeness and Consistency**: The problem is self-contained. It provides all necessary parameters ($a, L, T$), functions ($u_{\\text{exact}}$), discretization schemes, error metrics, and procedures for analysis. There are no contradictions.\n4.  **Objectivity**: The problem is stated in precise, objective, and quantitative terms without any ambiguity or subjective elements.\n\n### Step 3: Verdict and Action\nThe problem is deemed **valid**. A solution will be provided.\n\n### Solution\n\nThe problem requires the implementation of a numerical simulation for the one-dimensional linear advection equation, $u_t + a u_x = 0$, on a periodic domain. The goal is to verify the spatial order of accuracy of a second-order upwind scheme using the Method of Manufactured Solutions.\n\n**1. Manufactured Solution**\nThe provided exact solution is $u_{\\text{exact}}(x,t) = \\sin(k_1(x-at)) + \\tfrac{1}{4}\\cos(k_2(x-at))$, where $k_1 = 2\\pi/L$ and $k_2 = 6\\pi/L$. This function is a superposition of two traveling waves, which is the characteristic form of solutions to the linear advection equation. We can verify it satisfies the PDE:\n$$ \\frac{\\partial u_{\\text{exact}}}{\\partial t} = -a k_1 \\cos(k_1(x-at)) + \\frac{1}{4} a k_2 \\sin(k_2(x-at)) $$\n$$ \\frac{\\partial u_{\\text{exact}}}{\\partial x} = k_1 \\cos(k_1(x-at)) - \\frac{1}{4} k_2 \\sin(k_2(x-at)) $$\nSubstituting these into the PDE gives $u_t + a u_x = (-a k_1 \\cos(\\cdot) + a k_1 \\cos(\\cdot)) + (\\tfrac{1}{4} a k_2 \\sin(\\cdot) - \\tfrac{1}{4} a k_2 \\sin(\\cdot)) = 0$. The wavenumbers $k_1$ and $k_2$ are integer multiples of $2\\pi/L$, ensuring the solution is periodic on the domain $[0, L)$.\n\n**2. Semi-Discretization**\nThe domain $[0, L)$ is discretized into a uniform grid with $N$ points, $x_i = i \\Delta x$ for $i = 0, \\dots, N-1$, where $\\Delta x = L/N$. The solution at these grid points at a given time is represented by a vector $u(t) = [u_0(t), u_1(t), \\dots, u_{N-1}(t)]^T$.\nThe spatial derivative $u_x$ is approximated by a finite-difference operator $D_x$. The problem specifies a second-order upwind scheme, whose stencil depends on the sign of the advection speed $a$ to ensure information is drawn from the direction of wave propagation.\n\nFor $a  0$ (information propagates from left to right), the operator is:\n$$ (D_x u)_i = \\frac{3 u_i - 4 u_{i-1} + u_{i-2}}{2 \\Delta x} $$\nFor $a  0$ (information propagates from right to left), the operator is:\n$$ (D_x u)_i = \\frac{-3 u_i + 4 u_{i+1} - u_{i+2}}{2 \\Delta x} $$\nPeriodic boundary conditions are imposed by using modular arithmetic on the indices. For example, $u_{-1}$ is understood as $u_{N-1}$ and $u_{N}$ is understood as $u_0$.\n\nThis leads to a system of ordinary differential equations (ODEs), known as the semi-discrete form:\n$$ \\frac{d u}{d t} = -a (D_x u) \\equiv \\mathcal{L}(u) $$\n\n**3. Temporal Discretization**\nThe system of ODEs is integrated in time from $t=0$ to $t=T$ using the specified third-order Strong Stability Preserving Runge-Kutta (SSP3) method. Given the solution vector $u^n$ at time $t^n$, the solution $u^{n+1}$ at time $t^{n+1} = t^n + \\Delta t$ is computed via three stages:\n$$\n\\begin{aligned}\nu^{(1)} = u^n + \\Delta t\\,\\mathcal{L}(u^n) \\\\\nu^{(2)} = \\frac{3}{4}u^n + \\frac{1}{4}\\left(u^{(1)} + \\Delta t\\,\\mathcal{L}(u^{(1)})\\right) \\\\\nu^{n+1} = \\frac{1}{3}u^n + \\frac{2}{3}\\left(u^{(2)} + \\Delta t\\,\\mathcal{L}(u^{(2)})\\right)\n\\end{aligned}\n$$\nThe time step is chosen as $\\Delta t = 0.3 \\Delta x / |a|$. Since the spatial scheme is $\\mathcal{O}(\\Delta x^2)$ and the temporal scheme is $\\mathcal{O}(\\Delta t^3)$, and $\\Delta t \\propto \\Delta x$, the temporal error term $\\mathcal{O}(\\Delta x^3)$ will decay faster than the spatial error term $\\mathcal{O}(\\Delta x^2)$ as $\\Delta x \\to 0$. Thus, for sufficiently small $\\Delta x$, the total error will be dominated by the spatial discretization error, allowing for a clean measurement of its convergence rate.\n\n**4. Convergence Analysis**\nThe simulation is run for a sequence of grid resolutions $N \\in \\{64, 128, 256, 512\\}$. For each $N$, the numerical solution at the final time $T$, denoted $u^N_i$, is computed. The discrete $L^2$-error against the exact solution is calculated:\n$$ E(N) = \\sqrt{\\Delta x \\sum_{i=0}^{N-1} (u^N_i - u_{\\text{exact}}(x_i, T))^2} $$\nAssuming the error follows the form $E(N) \\approx C (\\Delta x)^p = C (L/N)^p$ for some constant $C$ and order of accuracy $p$, we can find $p$ by comparing errors from two different resolutions, $N_1$ and $N_2=r N_1$ where $r$ is the refinement ratio.\n$$ \\frac{E(N_1)}{E(N_2)} \\approx \\frac{C (L/N_1)^p}{C (L/(rN_1))^p} = r^p $$\nTaking the logarithm of both sides gives $\\ln(E(N_1)/E(N_2)) \\approx p \\ln(r)$. The problem specifies $r=2$, leading to the formula for the observed order of convergence:\n$$ p = \\frac{\\ln(E(N)/E(2N))}{\\ln(2)} $$\nTo obtain a more accurate estimate of the asymptotic order, we use the results from the finest grids, $N=256$ and $2N=512$.\n\nThe overall algorithm is:\n1. For each test case $(a, L, T)$, create a dictionary or list to store errors.\n2. For each grid size $N \\in \\{64, 128, 256, 512\\}$:\n    a. Define the computational grid $x$ and spatial step $\\Delta x$.\n    b. Set the initial condition $u$ from $u_{\\text{exact}}(x, 0)$.\n    c. Set the time step $\\Delta t$ based on the CFL condition.\n    d. Evolve the solution from $t=0$ to $t=T$ using the SSP3 integrator, ensuring the final time step lands exactly on $T$.\n    e. Compute the $L^2$-error $E(N)$ by comparing the final numerical solution to $u_{\\text{exact}}(x, T)$. Store this error.\n3. Calculate the observed order $p$ using the stored errors for $N=256$ and $N=512$.\n4. Collect the orders $p$ for all three test cases and format the output.\nThis procedure will be implemented in the provided Python script.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the 1D linear advection equation using a second-order upwind scheme\n    and third-order SSP Runge-Kutta time integration. It performs a grid\n    refinement study to measure the observed order of spatial accuracy.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A (representative)\n        {'a': 1.3, 'L': 1.0, 'T': 0.3, 'label': 'A'},\n        # Case B (negative advection)\n        {'a': -0.7, 'L': 1.0, 'T': 0.25, 'label': 'B'},\n        # Case C (one period)\n        {'a': 1.0, 'L': 1.0, 'T': 1.0, 'label': 'C'},\n    ]\n\n    # Grid sizes for the refinement study\n    N_values = [64, 128, 256, 512]\n    \n    # Courant–Friedrichs–Lewy (CFL) number\n    CFL = 0.3\n\n    results = []\n\n    def exact_solution(x, t, L, a):\n        \"\"\"Computes the manufactured exact solution.\"\"\"\n        k1 = 2.0 * np.pi / L\n        k2 = 6.0 * np.pi / L\n        return np.sin(k1 * (x - a * t)) + 0.25 * np.cos(k2 * (x - a * t))\n\n    def spatial_derivative(u, dx, a):\n        \"\"\"\n        Computes the second-order upwind spatial derivative on a periodic grid.\n        np.roll(u, k) shifts elements, effectively accessing u[i-k].\n        \"\"\"\n        if a > 0:\n            # Stencil uses points i, i-1, i-2. \n            # np.roll(u, 1) -> u_{i-1}, np.roll(u, 2) -> u_{i-2}\n            du_dx = (3.0 * u - 4.0 * np.roll(u, 1) + 1.0 * np.roll(u, 2)) / (2.0 * dx)\n        else: # a  0\n            # Stencil uses points i, i+1, i+2.\n            # np.roll(u, -1) -> u_{i+1}, np.roll(u, -2) -> u_{i+2}\n            du_dx = (-3.0 * u + 4.0 * np.roll(u, -1) - 1.0 * np.roll(u, -2)) / (2.0 * dx)\n        return du_dx\n\n    def l2_error(u_num, u_exact, dx):\n        \"\"\"Computes the discrete L2-error.\"\"\"\n        return np.sqrt(dx * np.sum((u_num - u_exact)**2))\n\n    for case in test_cases:\n        a = case['a']\n        L = case['L']\n        T = case['T']\n        \n        errors = {}\n\n        for N in N_values:\n            # 1. Setup grid and initial condition\n            dx = L / N\n            x = np.linspace(0.0, L, num=N, endpoint=False)\n            u = exact_solution(x, 0.0, L, a)\n\n            # 2. Setup time integration\n            dt = CFL * dx / np.abs(a)\n            t = 0.0\n\n            # 3. Main time-stepping loop\n            while t  T:\n                # Ensure the final time step hits T exactly\n                dt_effective = min(dt, T - t)\n                \n                # Define the spatial operator for the RK stages\n                def L_op(v):\n                    return -a * spatial_derivative(v, dx, a)\n\n                # SSP(3,3) Runge-Kutta stages\n                u1 = u + dt_effective * L_op(u)\n                u2 = 0.75 * u + 0.25 * (u1 + dt_effective * L_op(u1))\n                u = (1.0/3.0) * u + (2.0/3.0) * (u2 + dt_effective * L_op(u2))\n                \n                t += dt_effective\n\n            # 4. Compute and store the final error\n            u_ex_final = exact_solution(x, T, L, a)\n            errors[N] = l2_error(u, u_ex_final, dx)\n\n        # 5. Calculate the observed order of accuracy using the finest grid pair\n        E_256 = errors[256]\n        E_512 = errors[512]\n        \n        # p = log(E(N)/E(2N)) / log(2)\n        p = np.log(E_256 / E_512) / np.log(2.0)\n        results.append(p)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3360956"}, {"introduction": "When using explicit time integration methods, the choice of time step $ \\Delta t $ is not arbitrary; it is constrained by the spatial discretization and the grid spacing $ \\Delta x $ to ensure numerical stability. This exercise dives into von Neumann stability analysis to determine the precise stability limits for the second-order upwind scheme when coupled with common Runge-Kutta methods. By deriving the maximum stable Courant–Friedrichs–Lewy (CFL) number, you will gain a deeper, quantitative understanding of the interplay between the scheme's dissipative and dispersive properties and the stability of the overall algorithm [@problem_id:3360952].", "problem": "Consider the one-dimensional linear advection equation with constant advective speed $agt;0$,\n$$\nu_{t} + a\\,u_{x} = 0,\n$$\non a periodic domain, discretized on a uniform grid with spacing $\\Delta x$. Let the Courant–Friedrichs–Lewy (CFL) number be $C \\equiv a\\,\\Delta t/\\Delta x$, where $\\Delta t$ is the time step. Two spatial discretizations of the advective derivative are to be used:\n\n- A second-order upwind (for $agt;0$) discrete derivative at grid point $i$,\n$$\n\\left(u_{x}\\right)_{i} \\approx \\frac{3 u_{i} - 4 u_{i-1} + u_{i-2}}{2\\,\\Delta x},\n$$\n- A second-order central discrete derivative,\n$$\n\\left(u_{x}\\right)_{i} \\approx \\frac{u_{i+1} - u_{i-1}}{2\\,\\Delta x}.\n$$\n\nTime integration is performed by explicit two-stage Runge–Kutta (RK2) and explicit three-stage Runge–Kutta (RK3) methods. Using von Neumann (Fourier) stability analysis for the semi-discrete system and the linear stability functions associated with explicit Runge–Kutta methods applied to the linear test equation, determine the maximum stable CFL number $C_{\\max}$ for each of the following four couplings:\n1. RK2 with second-order upwind,\n2. RK3 with second-order upwind,\n3. RK2 with second-order central,\n4. RK3 with second-order central.\n\nYour derivation must start from the semi-discrete operator’s Fourier symbol and the Runge–Kutta stability polynomials. Then determine, for each coupling, the largest $C$ such that the corresponding stability condition holds for all Fourier wavenumbers. Finally, report the four $C_{\\max}$ values as a single row matrix in the order listed above. Round your answers to four significant figures. Express the final answers as dimensionless numbers.", "solution": "We begin from the linear advection equation $u_{t} + a\\,u_{x} = 0$, which on a uniform periodic grid yields a semi-discrete system of ordinary differential equations (ODEs). For von Neumann (Fourier) analysis, we consider Fourier modes of the form $u_{i}(t) = \\hat{u}(t)\\,\\exp\\!\\left(\\mathrm{i}\\,i\\,\\theta\\right)$, where $\\theta \\in [-\\pi,\\pi]$ is the nondimensional wavenumber. The spatial discretizations act diagonally on Fourier modes and are characterized by their symbols.\n\n1) Spatial symbols.\n\n- For the second-order upwind derivative (for $agt;0$),\n$$\n\\left(u_{x}\\right)_{i} \\approx \\frac{3 u_{i} - 4 u_{i-1} + u_{i-2}}{2\\,\\Delta x}.\n$$\nApplied to $u_{i} = \\hat{u}\\,\\exp(\\mathrm{i} i \\theta)$, we obtain the symbol\n$$\nD_{\\mathrm{up}}(\\theta) \\equiv \\frac{3 - 4\\,\\exp(-\\mathrm{i}\\theta) + \\exp(-2\\mathrm{i}\\theta)}{2\\,\\Delta x}.\n$$\nThe semi-discrete ODE is $u_{t} = -a\\,D_{\\mathrm{up}}(\\theta)\\,u$, so the eigenvalue is\n$$\n\\sigma_{\\mathrm{up}}(\\theta) = -a\\,D_{\\mathrm{up}}(\\theta) = -\\frac{a}{\\Delta x}\\,\\frac{3 - 4\\,\\exp(-\\mathrm{i}\\theta) + \\exp(-2\\mathrm{i}\\theta)}{2}.\n$$\nDefining the CFL number $C \\equiv a\\,\\Delta t/\\Delta x$, the dimensionless time-amplification argument is\n$$\nz_{\\mathrm{up}}(\\theta) \\equiv \\Delta t\\,\\sigma_{\\mathrm{up}}(\\theta) = -C\\,S_{\\mathrm{up}}(\\theta), \\quad S_{\\mathrm{up}}(\\theta) \\equiv \\frac{3 - 4\\,\\exp(-\\mathrm{i}\\theta) + \\exp(-2\\mathrm{i}\\theta)}{2}.\n$$\n\n- For the second-order central derivative,\n$$\n\\left(u_{x}\\right)_{i} \\approx \\frac{u_{i+1} - u_{i-1}}{2\\,\\Delta x}.\n$$\nApplied to $u_{i} = \\hat{u}\\,\\exp(\\mathrm{i} i \\theta)$, the symbol is\n$$\nD_{\\mathrm{c}}(\\theta) \\equiv \\frac{\\exp(\\mathrm{i}\\theta) - \\exp(-\\mathrm{i}\\theta)}{2\\,\\Delta x} = \\frac{\\mathrm{i}\\,\\sin\\theta}{\\Delta x}.\n$$\nHence,\n$$\n\\sigma_{\\mathrm{c}}(\\theta) = -a\\,D_{\\mathrm{c}}(\\theta) = -\\frac{a}{\\Delta x}\\,\\mathrm{i}\\,\\sin\\theta, \\quad\nz_{\\mathrm{c}}(\\theta) \\equiv \\Delta t\\,\\sigma_{\\mathrm{c}}(\\theta) = -\\mathrm{i}\\,C\\,\\sin\\theta.\n$$\n\n2) Runge–Kutta stability polynomials.\n\nFor a linear ODE $y'=\\lambda y$, applying an explicit $s$-stage Runge–Kutta method yields $y^{n+1} = R(z)\\,y^{n}$ with $z\\equiv \\lambda\\,\\Delta t$ and a polynomial stability function $R(z)$. For the explicit two-stage Runge–Kutta method (RK2, including the standard strong-stability-preserving two-stage scheme), the stability polynomial is\n$$\nR_{2}(z) = 1 + z + \\frac{z^{2}}{2}.\n$$\nFor the explicit three-stage Runge–Kutta method (RK3, including the standard strong-stability-preserving three-stage scheme), the stability polynomial for linear problems is\n$$\nR_{3}(z) = 1 + z + \\frac{z^{2}}{2} + \\frac{z^{3}}{6}.\n$$\nStability requires $|R(z)| \\leq 1$ for all relevant $z$ in the spectrum of the semi-discrete operator.\n\n3) Stability analysis and $C_{\\max}$.\n\n- Upwind + RK2 and RK3:\nWe first analyze $S_{\\mathrm{up}}(\\theta)$. Its real part is\n$$\n\\Re\\{S_{\\mathrm{up}}(\\theta)\\} = \\frac{1}{2}\\bigl(3 - 4\\cos\\theta + \\cos 2\\theta\\bigr).\n$$\nDifferentiate on $\\theta \\in [0,\\pi]$:\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}\\theta}\\Re\\{S_{\\mathrm{up}}(\\theta)\\} = \\frac{1}{2}\\bigl(4\\sin\\theta - 2\\sin 2\\theta\\bigr) = 2\\sin\\theta\\,(1 - \\cos\\theta) \\ge 0,\n$$\nwith equality only at $\\theta=0$. Thus $\\Re\\{S_{\\mathrm{up}}(\\theta)\\}$ is increasing and attains its maximum at $\\theta=\\pi$:\n$$\nS_{\\mathrm{up}}(\\pi) = \\frac{3 - 4(-1) + 1}{2} = 4, \\quad z_{\\mathrm{up}}(\\pi) = -4\\,C.\n$$\nTherefore, the upwind semi-discrete spectrum contains the purely real negative point $z=-4C$, and this is the extremal point in the negative real direction. For both $R_{2}$ and $R_{3}$, the region of absolute stability intersects the negative real axis at some $z=-\\alpha$ where $|R(-\\alpha)|=1$; the largest admissible $C$ is determined by requiring $-4C$ to remain within the intersection interval. Hence\n$$\nC_{\\max,\\mathrm{up}} = \\frac{\\alpha}{4},\n$$\nwhere $\\alpha$ is the (positive) negative-real-axis extent of the Runge–Kutta stability region.\n\nFor RK2, along the negative real axis set $z=-x$, $x\\ge 0$:\n$$\nR_{2}(-x) = 1 - x + \\frac{x^{2}}{2}.\n$$\nThe boundary $|R_{2}(-x)|=1$ occurs at $R_{2}(-x)=1$, which gives $-x + \\frac{x^{2}}{2}=0 \\Rightarrow x=0$ or $x=2$. Thus $\\alpha_{2}=2$ and\n$$\nC_{\\max,\\mathrm{up}}^{\\mathrm{(RK2)}} = \\frac{\\alpha_{2}}{4} = \\frac{2}{4} = \\frac{1}{2}.\n$$\n\nFor RK3, along the negative real axis with $z=-x$,\n$$\nR_{3}(-x) = 1 - x + \\frac{x^{2}}{2} - \\frac{x^{3}}{6}.\n$$\nThe boundary $|R_{3}(-x)|=1$ is attained at $R_{3}(-x)=-1$ (since $R_{3}(-x)$ decreases from $1$ and crosses $-1$ once before growing in magnitude), which gives\n$$\n1 - x + \\frac{x^{2}}{2} - \\frac{x^{3}}{6} = -1 \\;\\;\\Longleftrightarrow\\;\\; x^{3} - 3x^{2} + 6x - 12 = 0.\n$$\nLet $\\alpha_{3}$ be the unique positive root of this cubic; then\n$$\nC_{\\max,\\mathrm{up}}^{\\mathrm{(RK3)}} = \\frac{\\alpha_{3}}{4}.\n$$\nSolving $x^{3} - 3x^{2} + 6x - 12 = 0$ numerically (for example by Newton’s method, noting $f'(x)=3(x-1)^{2}+3gt;0$ so the root is unique), yields $\\alpha_{3} \\approx 2.51277$, hence\n$$\nC_{\\max,\\mathrm{up}}^{\\mathrm{(RK3)}} \\approx \\frac{2.51277}{4} \\approx 0.62819.\n$$\n\n- Central + RK2 and RK3:\nFor the central scheme,\n$$\nz_{\\mathrm{c}}(\\theta) = -\\mathrm{i}\\,C\\,\\sin\\theta,\n$$\nso the entire semi-discrete spectrum lies on the imaginary axis, with $|z| \\le C$ and the extremal points at $z = \\pm \\mathrm{i}\\,C$.\n\nFor RK2, substitute $z=\\mathrm{i}y$ into $R_{2}$:\n$$\nR_{2}(\\mathrm{i}y) = 1 + \\mathrm{i}y - \\frac{y^{2}}{2}, \\quad |R_{2}(\\mathrm{i}y)|^{2} = \\bigl(1 - \\tfrac{y^{2}}{2}\\bigr)^{2} + y^{2} = 1 + \\frac{y^{4}}{4} \\ge 1,\n$$\nwith equality only at $y=0$. Thus no nonzero imaginary $z$ is inside the RK2 stability region, implying\n$$\nC_{\\max,\\mathrm{c}}^{\\mathrm{(RK2)}} = 0.\n$$\n\nFor RK3, substitute $z=\\mathrm{i}y$ into $R_{3}$:\n$$\nR_{3}(\\mathrm{i}y) = 1 + \\mathrm{i}y - \\frac{y^{2}}{2} - \\mathrm{i}\\frac{y^{3}}{6},\n$$\nso\n$$\n|R_{3}(\\mathrm{i}y)|^{2} = \\bigl(1 - \\tfrac{y^{2}}{2}\\bigr)^{2} + \\bigl(y - \\tfrac{y^{3}}{6}\\bigr)^{2} = 1 - \\frac{y^{4}}{12} + \\frac{y^{6}}{36}.\n$$\nThe boundary $|R_{3}(\\mathrm{i}y)|=1$ satisfies\n$$\n-\\frac{y^{4}}{12} + \\frac{y^{6}}{36} = 0 \\;\\;\\Longleftrightarrow\\;\\; y^{4}\\Bigl(\\frac{y^{2}}{36} - \\frac{1}{12}\\Bigr) = 0 \\;\\;\\Longleftrightarrow\\;\\; y^{2} = 3.\n$$\nHence the intersection with the imaginary axis is at $|y|=\\sqrt{3}$. Since the extremal central-discretization eigenvalues satisfy $|z|=C$, stability requires $C \\le \\sqrt{3}$, i.e.,\n$$\nC_{\\max,\\mathrm{c}}^{\\mathrm{(RK3)}} = \\sqrt{3}.\n$$\n\n4) Interpretation via eigenvalues.\n\nThe second-order upwind symbol $S_{\\mathrm{up}}(\\theta)$ lies strictly in the right half of the complex plane (hence $z=-C S_{\\mathrm{up}}(\\theta)$ lies in the left half-plane), and attains a purely real negative extreme at $\\theta=\\pi$, which governs the stability limit through the negative-real-axis extent of the Runge–Kutta stability region. By contrast, the second-order central symbol is purely imaginary for all $\\theta$, so stability depends on how much of the imaginary axis is contained in the Runge–Kutta stability region: none for RK2 (except the origin), a finite segment $|y|\\le \\sqrt{3}$ for RK3. These spectral geometries explain why the central scheme with RK2 admits no nonzero $C$, while with RK3 it permits a relatively large $C_{\\max}$, and why the upwind scheme’s $C_{\\max}$ scales with the negative-real-axis intercept divided by the extreme spectral factor $4$.\n\n5) Numerical values and rounding.\n\nRounding to four significant figures:\n- $C_{\\max,\\mathrm{up}}^{\\mathrm{(RK2)}} = 1/2 = 0.5000$,\n- $C_{\\max,\\mathrm{up}}^{\\mathrm{(RK3)}} \\approx 0.6282$,\n- $C_{\\max,\\mathrm{c}}^{\\mathrm{(RK2)}} = 0.0000$,\n- $C_{\\max,\\mathrm{c}}^{\\mathrm{(RK3)}} = \\sqrt{3} \\approx 1.732$.\n\nThe requested row matrix, in the order specified, is\n$$\n\\bigl[C_{\\max,\\mathrm{up}}^{\\mathrm{(RK2)}},\\; C_{\\max,\\mathrm{up}}^{\\mathrm{(RK3)}},\\; C_{\\max,\\mathrm{c}}^{\\mathrm{(RK2)}},\\; C_{\\max,\\mathrm{c}}^{\\mathrm{(RK3)}}\\bigr].\n$$", "answer": "$$\\boxed{\\begin{pmatrix}0.5000  0.6282  0.0000  1.732\\end{pmatrix}}$$", "id": "3360952"}]}