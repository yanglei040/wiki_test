{"hands_on_practices": [{"introduction": "The fundamental challenge of co-located grids is the potential for pressure-velocity decoupling, which can manifest as non-physical, high-frequency \"checkerboard\" oscillations in the pressure field. This first practice provides a direct numerical demonstration of this instability, serving as the primary motivation for the stabilization techniques discussed in this chapter. By manufacturing a source term that specifically excites the checkerboard mode ([@problem_id:3365597]), you will see firsthand why a naive co-located discretization is susceptible to this error and how alternative arrangements, like the staggered Marker-And-Cell (MAC) grid, inherently avoid it. This exercise is crucial for building a strong intuition for the problem that methods like Rhie-Chow interpolation are designed to solve.", "problem": "Consider the steady, incompressible Stokes equations on a two-dimensional periodic domain of length $L=1$ in each direction, with spatial coordinates $(x,y)$ and velocity field $\\mathbf{u}(x,y) = (u(x,y), v(x,y))$:\n$$\n-\\nabla p + \\nu \\nabla^2 \\mathbf{u} = \\mathbf{f}, \\quad \\nabla \\cdot \\mathbf{u} = 0,\n$$\nwhere $p(x,y)$ is the pressure, $\\nu$ is the kinematic viscosity, and $\\mathbf{f}(x,y)$ is a given body force. In a fractional-step projection approach, the pressure field $p$ is recovered from the following Poisson equation for pressure associated with enforcing discrete incompressibility:\n$$\n\\nabla^2 p = s,\n$$\nwhere $s$ is a discrete source constructed from the divergence of an intermediate velocity field. On a uniform Cartesian grid with spacing $\\Delta x = \\Delta y$, different grid arrangements lead to different discrete gradient and divergence operators. In particular:\n- The co-located (cell-centered) arrangement places $u$, $v$, and $p$ all at cell centers. A common naive central-difference implementation computes the discrete pressure gradient at centers using nearest neighbors in each coordinate direction:\n$$\n\\left(\\frac{\\partial p}{\\partial x}\\right)_{i,j}^{\\text{co-located}} = \\frac{p_{i+1,j} - p_{i-1,j}}{2 \\Delta x}, \\quad\n\\left(\\frac{\\partial p}{\\partial y}\\right)_{i,j}^{\\text{co-located}} = \\frac{p_{i,j+1} - p_{i,j-1}}{2 \\Delta x}.\n$$\n- The Marker-And-Cell (MAC) staggered arrangement places $u$ on vertical faces at $(i+\\tfrac{1}{2}, j)$, $v$ on horizontal faces at $(i, j+\\tfrac{1}{2})$, and $p$ at cell centers $(i,j)$. The discrete pressure gradient naturally appears at faces:\n$$\n\\left(\\frac{\\partial p}{\\partial x}\\right)_{i+\\frac{1}{2},j}^{\\text{MAC}} = \\frac{p_{i+1,j} - p_{i,j}}{\\Delta x}, \\quad\n\\left(\\frac{\\partial p}{\\partial y}\\right)_{i,j+\\frac{1}{2}}^{\\text{MAC}} = \\frac{p_{i,j+1} - p_{i,j}}{\\Delta x}.\n$$\n\nIt is known that co-located central differences admit a spurious pressure mode, often called a checkerboard mode, which is defined on an $N_x \\times N_y$ uniform periodic grid by\n$$\np_{i,j}^{\\text{chk}} = (-1)^{i+j}, \\quad i = 0,1,\\dots,N_x-1, \\quad j = 0,1,\\dots,N_y-1,\n$$\nand corresponds to the highest resolvable spatial frequency (the Nyquist mode). This mode can be excited by certain discrete forcings and, on co-located grids, can decouple from the momentum equations under naive interpolation from centers to faces, leading to nonphysical oscillations in $p$ that do not drive momentum. In contrast, the MAC staggering suppresses this decoupling because the face-centered discrete gradient directly samples adjacent cell-center pressures, and the checkerboard difference does not vanish at faces.\n\nYour task is to:\n1. Use a manufactured source $s_{i,j} = (-1)^{i+j}$ to excite the checkerboard mode in the discrete pressure Poisson equation with periodic boundary conditions, discretized by the standard five-point Laplacian. The discrete Fourier symbol of the five-point Laplacian on a uniform grid of spacing $\\Delta x$ is\n$$\n\\lambda(k_x,k_y) = \\frac{2}{\\Delta x^2}\\left(\\cos(k_x \\Delta x)-1\\right) + \\frac{2}{\\Delta x^2}\\left(\\cos(k_y \\Delta x)-1\\right),\n$$\nfor discrete wavenumbers $k_x = \\frac{2\\pi m}{L}$, $k_y = \\frac{2\\pi n}{L}$, where $m = 0,1,\\dots,N_x-1$ and $n = 0,1,\\dots,N_y-1$. The checkerboard mode corresponds to $(m,n) = (N_x/2, N_y/2)$ when $N_x$ and $N_y$ are even, giving $\\cos(\\pi) = -1$ and thus\n$$\n\\lambda_{\\text{chk}} = -\\frac{4}{\\Delta x^2} - \\frac{4}{\\Delta x^2} = -\\frac{8}{\\Delta x^2}.\n$$\nFrom this, the pressure amplitude associated with the checkerboard forcing scales as\n$$\nA_p(\\Delta x) = \\frac{1}{|\\lambda_{\\text{chk}}|} = \\frac{\\Delta x^2}{8}.\n$$\n2. Numerically solve the discrete periodic Poisson equation $\\nabla^2 p = s$ using the discrete Laplacian symbol above in the Fourier domain for a sequence of uniform grids, and extract the numerical amplitude $A_p(\\Delta x)$ of the checkerboard component by projecting the computed $p$ onto $p^{\\text{chk}}$.\n3. Compute and compare the root-mean-square (RMS) magnitude of the face-centered pressure gradient that would enter the momentum equations under:\n   - A co-located naive face-gradient obtained by averaging cell-centered gradients at adjacent cells to faces:\n   $$\n   \\left(\\frac{\\partial p}{\\partial x}\\right)_{i+\\frac{1}{2},j}^{\\text{co-located-face}} = \\frac{1}{2}\\left[\\left(\\frac{\\partial p}{\\partial x}\\right)_{i,j}^{\\text{co-located}} + \\left(\\frac{\\partial p}{\\partial x}\\right)_{i+1,j}^{\\text{co-located}}\\right], \\quad\n   \\left(\\frac{\\partial p}{\\partial y}\\right)_{i,j+\\frac{1}{2}}^{\\text{co-located-face}} = \\frac{1}{2}\\left[\\left(\\frac{\\partial p}{\\partial y}\\right)_{i,j}^{\\text{co-located}} + \\left(\\frac{\\partial p}{\\partial y}\\right)_{i,j+1}^{\\text{co-located}}\\right].\n   $$\n   - The MAC face-gradient, as defined above. The RMS magnitude is defined as\n   $$\n   G_{\\text{RMS}} = \\sqrt{\\frac{1}{N_f}\\sum_{f} g_f^2},\n   $$\n   where $g_f$ ranges over all face gradient components in both directions and $N_f$ is the number of faces.\n4. Demonstrate numerically that:\n   - The co-located naive face-gradient is blind to the checkerboard component so that its RMS magnitude is numerically zero for the manufactured forcing, explaining the decoupling.\n   - The MAC face-gradient couples to the checkerboard mode, and its RMS magnitude scales like $\\mathcal{O}(\\Delta x)$ for the manufactured forcing because $A_p(\\Delta x) \\sim \\Delta x^2$ and the face gradient scales like $A_p(\\Delta x)/\\Delta x$.\n\nImplement a program that:\n- Builds the manufactured source $s_{i,j} = (-1)^{i+j}$ on a periodic domain of length $L=1$.\n- Solves the discrete Poisson equation in Fourier space using the discrete Laplacian symbol to obtain $p_{i,j}$.\n- Computes the numerical checkerboard amplitude $A_p(\\Delta x)$ via projection onto $(-1)^{i+j}$.\n- Computes $G_{\\text{RMS}}^{\\text{co-located-face}}$ and $G_{\\text{RMS}}^{\\text{MAC}}$ for the resulting $p_{i,j}$.\n- Reports the tuple $(A_p(\\Delta x), G_{\\text{RMS}}^{\\text{co-located-face}}, G_{\\text{RMS}}^{\\text{MAC}})$ for each grid.\n\nTest Suite:\n- Use square grids with $N_x=N_y$ and $L=1$ for the following cases:\n  1. $N_x=N_y=8$ (coarse grid, $\\Delta x = 1/8$).\n  2. $N_x=N_y=16$ (moderate grid, $\\Delta x = 1/16$).\n  3. $N_x=N_y=32$ (fine grid, $\\Delta x = 1/32$).\n  4. $N_x=N_y=64$ (very fine grid, $\\Delta x = 1/64$).\nAll reported quantities are dimensionless. Your program should produce a single line of output containing the results as a comma-separated list of four bracketed tuples, each tuple ordered as $(A_p(\\Delta x), G_{\\text{RMS}}^{\\text{co-located-face}}, G_{\\text{RMS}}^{\\text{MAC}})$ in the same order as the test cases, for example:\n\"[(a1,b1,c1),(a2,b2,c2),(a3,b3,c3),(a4,b4,c4)]\".", "solution": "We begin from the steady incompressible Stokes equations\n$$\n-\\nabla p + \\nu \\nabla^2 \\mathbf{u} = \\mathbf{f}, \\quad \\nabla \\cdot \\mathbf{u} = 0,\n$$\nwhich, under a fractional-step approach, leads to enforcing discrete incompressibility via a pressure Poisson equation\n$$\n\\nabla^2 p = s,\n$$\nwhere the source $s$ is obtained from the divergence of an intermediate velocity. On a uniform periodic grid, solving this Poisson equation in the discrete Fourier space is natural and reveals how certain spatial modes propagate into pressure. We focus on the checkerboard (Nyquist) mode,\n$$\np_{i,j}^{\\text{chk}} = (-1)^{i+j},\n$$\nwhich alternates in sign between neighboring cell centers.\n\nFor a uniform grid with spacing $\\Delta x$ and periodic boundary conditions, the standard five-point discrete Laplacian has Fourier symbol\n$$\n\\lambda(k_x,k_y) = \\frac{2}{\\Delta x^2}\\left(\\cos(k_x \\Delta x)-1\\right) + \\frac{2}{\\Delta x^2}\\left(\\cos(k_y \\Delta x)-1\\right),\n$$\nwith discrete wavenumbers $k_x = \\frac{2\\pi m}{L}$ and $k_y = \\frac{2\\pi n}{L}$, $m=0,\\dots,N_x-1$, $n=0,\\dots,N_y-1$, and $L=1$. For the checkerboard mode, $(m,n)=(N_x/2, N_y/2)$ and $k_x \\Delta x = \\pi$, $k_y \\Delta x = \\pi$, giving\n$$\n\\lambda_{\\text{chk}} = \\frac{2}{\\Delta x^2}\\left(\\cos \\pi - 1\\right) + \\frac{2}{\\Delta x^2}\\left(\\cos \\pi - 1\\right) = \\frac{2}{\\Delta x^2}\\left(-1 - 1\\right) + \\frac{2}{\\Delta x^2}\\left(-1 - 1\\right) = -\\frac{8}{\\Delta x^2}.\n$$\nForcing the Poisson equation with $s_{i,j}=(-1)^{i+j}$ means the right-hand side has only this mode. Therefore the solution is proportional to the same mode:\n$$\np_{i,j} = A_p(\\Delta x)\\, (-1)^{i+j}.\n$$\nPlugging into the discrete Poisson equation in Fourier space yields\n$$\n\\lambda_{\\text{chk}} A_p(\\Delta x) = 1 \\quad \\Rightarrow \\quad A_p(\\Delta x) = -\\frac{1}{\\lambda_{\\text{chk}}} = \\frac{\\Delta x^2}{8}.\n$$\nThus the amplitude of the checkerboard component in the computed pressure scales as $\\Delta x^2$.\n\nThe distinction between co-located and Marker-And-Cell (MAC) staggering enters through how the pressure gradient is represented in the momentum equations:\n- In a co-located (cell-centered) scheme, a common naive implementation uses central differences to estimate $\\left(\\frac{\\partial p}{\\partial x}\\right)_{i,j}^{\\text{co-located}}$ and $\\left(\\frac{\\partial p}{\\partial y}\\right)_{i,j}^{\\text{co-located}}$ at cell centers. For the checkerboard pressure $p_{i,j} = A_p(\\Delta x)\\,(-1)^{i+j}$,\n$$\n\\left(\\frac{\\partial p}{\\partial x}\\right)_{i,j}^{\\text{co-located}} = \\frac{p_{i+1,j} - p_{i-1,j}}{2 \\Delta x}\n= \\frac{A_p(\\Delta x)\\left[(-1)^{i+1+j} - (-1)^{i-1+j}\\right]}{2\\Delta x}\n= \\frac{A_p(\\Delta x)\\,(-1)^{i+j}\\left[-1 - (-1)\\right]}{2\\Delta x} = 0,\n$$\nand a similar calculation shows $\\left(\\frac{\\partial p}{\\partial y}\\right)_{i,j}^{\\text{co-located}}=0$. If one then naively forms face gradients by averaging adjacent center gradients, the resulting face pressure gradient that would drive the momentum equations is still zero. This demonstrates the decoupling: the checkerboard pressure produces no face-centered pressure force in the naive co-located scheme.\n- In the MAC staggered arrangement, the face-centered discrete gradient directly takes differences of adjacent center pressures:\n$$\n\\left(\\frac{\\partial p}{\\partial x}\\right)_{i+\\frac{1}{2},j}^{\\text{MAC}} = \\frac{p_{i+1,j} - p_{i,j}}{\\Delta x}\n= \\frac{A_p(\\Delta x)\\left[(-1)^{i+1+j} - (-1)^{i+j}\\right]}{\\Delta x}\n= \\frac{A_p(\\Delta x)\\,(-1)^{i+j}(-1 - 1)}{\\Delta x}\n= -\\frac{2\\,A_p(\\Delta x)}{\\Delta x}\\,(-1)^{i+j}.\n$$\nAn analogous expression holds for $\\left(\\frac{\\partial p}{\\partial y}\\right)_{i,j+\\frac{1}{2}}^{\\text{MAC}}$. Consequently, the MAC face-gradient couples strongly to the checkerboard and drives momentum corrections that suppress such oscillations. The magnitude of the MAC face-gradient scales like $\\frac{A_p(\\Delta x)}{\\Delta x} \\sim \\frac{\\Delta x^2}{\\Delta x} = \\mathcal{O}(\\Delta x)$ for the manufactured forcing.\n\nAlgorithmic design for the program:\n1. For each test grid with $N_x=N_y$ and $\\Delta x = 1/N_x$, construct the manufactured source $s_{i,j} = (-1)^{i+j}$.\n2. Compute the two-dimensional discrete Fourier transform of $s$ to obtain $\\hat{s}(m,n)$.\n3. For each Fourier mode $(m,n)$, compute the discrete Laplacian symbol $\\lambda(m,n)$ using\n$$\n\\lambda(m,n) = \\frac{2}{\\Delta x^2}\\left(\\cos\\left(\\frac{2\\pi m}{N_x}\\right)-1\\right) + \\frac{2}{\\Delta x^2}\\left(\\cos\\left(\\frac{2\\pi n}{N_y}\\right)-1\\right).\n$$\n4. Compute $\\hat{p}(m,n) = \\hat{s}(m,n) / \\lambda(m,n)$ for all $(m,n)$ such that $\\lambda(m,n) \\neq 0$. The zero mode $(m,n)=(0,0)$ is absent in $\\hat{s}$ due to the alternating pattern, so division by zero does not occur.\n5. Inverse transform to obtain $p_{i,j}$ in physical space.\n6. Project $p$ onto the checkerboard pattern to extract the amplitude,\n$$\nA_p(\\Delta x) = \\frac{1}{N_x N_y} \\sum_{i=0}^{N_x-1}\\sum_{j=0}^{N_y-1} p_{i,j}(-1)^{i+j}.\n$$\n7. Compute co-located center gradients using central differences and then obtain co-located face-gradients by averaging adjacent center gradients to faces. Compute the root-mean-square magnitude over all faces:\n$$\nG_{\\text{RMS}}^{\\text{co-located-face}} = \\sqrt{\\frac{1}{N_f}\\sum_{f}\\left(g_{f}^{\\text{co-located-face}}\\right)^2}.\n$$\n8. Compute MAC face-gradients from adjacent center pressures and the corresponding root-mean-square magnitude:\n$$\nG_{\\text{RMS}}^{\\text{MAC}} = \\sqrt{\\frac{1}{N_f}\\sum_{f}\\left(g_{f}^{\\text{MAC}}\\right)^2}.\n$$\n9. Output $(A_p(\\Delta x), G_{\\text{RMS}}^{\\text{co-located-face}}, G_{\\text{RMS}}^{\\text{MAC}})$ for each grid in the test suite, aggregated into a single line as specified.\n\nExpected behavior:\n- The numerical $A_p(\\Delta x)$ should scale closely with $\\Delta x^2/8$ (up to floating-point and discrete transform normalization).\n- $G_{\\text{RMS}}^{\\text{co-located-face}}$ should be numerically zero (to machine precision), demonstrating that the naive co-located gradient is blind to checkerboard pressure.\n- $G_{\\text{RMS}}^{\\text{MAC}}$ should scale linearly with $\\Delta x$ for this manufactured forcing because the face gradient magnitude behaves like $2 A_p(\\Delta x)/\\Delta x$.\n\nThis directly exhibits the mechanism by which the Marker-And-Cell (MAC) staggered grid suppresses checkerboard pressure modes: by placing velocities at faces, the discrete pressure gradient is evaluated as a difference of neighboring pressures, which does not vanish for alternating patterns, and thereby couples the spurious mode into momentum where it is damped. In contrast, a naive co-located central difference for the pressure gradient at centers annihilates the alternating component, allowing the spurious pressure mode to persist without influencing the velocity field.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef discrete_laplacian_symbol(nx, ny, dx):\n    \"\"\"\n    Build the discrete Laplacian symbol lambda(m,n) for a periodic grid\n    using the five-point stencil central differences on a uniform grid.\n    \"\"\"\n    # Wavenumber indices m, n\n    m = np.arange(nx)\n    n = np.arange(ny)\n    # Cosine terms for each axis\n    cos_m = np.cos(2.0 * np.pi * m / nx)\n    cos_n = np.cos(2.0 * np.pi * n / ny)\n    # Broadcast to 2D grid of (m,n)\n    lam = (2.0 / dx**2) * (cos_m[:, None] - 1.0) + (2.0 / dx**2) * (cos_n[None, :] - 1.0)\n    return lam\n\ndef solve_poisson_checkerboard(nx, ny, L=1.0):\n    \"\"\"\n    Solve the discrete periodic Poisson equation for s_{i,j} = (-1)^{i+j}\n    using the discrete Laplacian symbol in Fourier space.\n\n    Returns:\n        p: computed pressure field (nx x ny)\n        Ap: numerical checkerboard amplitude via projection onto (-1)^{i+j}\n    \"\"\"\n    dx = L / nx\n    # Manufactured source s = (-1)^{i+j}\n    i = np.arange(nx)[:, None]\n    j = np.arange(ny)[None, :]\n    s = ((-1.0) ** (i + j)).astype(np.float64)\n\n    # FFT of source\n    s_hat = np.fft.fft2(s)\n\n    # Discrete Laplacian symbol\n    lam = discrete_laplacian_symbol(nx, ny, dx)\n\n    # Avoid division by zero: source has zero mean, so lam[0,0] won't be used\n    # Construct p_hat = s_hat / lam\n    # Use where to handle potential zeros robustly (though s_hat[0,0]==0)\n    p_hat = np.zeros_like(s_hat, dtype=np.complex128)\n    mask = lam != 0.0\n    p_hat[mask] = s_hat[mask] / lam[mask]\n\n    # Inverse FFT to get p\n    p = np.real(np.fft.ifft2(p_hat))\n\n    # Compute checkerboard amplitude Ap = mean(p * (-1)^{i+j})\n    pattern = ((-1.0) ** (i + j)).astype(np.float64)\n    Ap = np.sum(p * pattern) / (nx * ny)\n\n    return p, Ap, dx\n\ndef colocated_face_gradient_rms(p, dx):\n    \"\"\"\n    Compute co-located center gradients via central differences and then\n    naive face gradients by averaging adjacent center gradients.\n    Return RMS magnitude over all faces.\n    \"\"\"\n    nx, ny = p.shape\n\n    # Periodic shifts\n    p_ip = np.roll(p, -1, axis=0)\n    p_im = np.roll(p,  1, axis=0)\n    p_jp = np.roll(p, -1, axis=1)\n    p_jm = np.roll(p,  1, axis=1)\n\n    # Center gradients (central difference)\n    gx_c = (p_ip - p_im) / (2.0 * dx)\n    gy_c = (p_jp - p_jm) / (2.0 * dx)  # dx == dy\n\n    # Face gradients: average adjacent center gradients to faces\n    # x-faces at (i+1/2, j): average gx_c[i,j] and gx_c[i+1,j]\n    gx_face = 0.5 * (gx_c + np.roll(gx_c, -1, axis=0))\n    # y-faces at (i, j+1/2): average gy_c[i,j] and gy_c[i,j+1]\n    gy_face = 0.5 * (gy_c + np.roll(gy_c, -1, axis=1))\n\n    # RMS over all faces (both directions)\n    # Number of faces: 2 * nx * ny\n    rms = np.sqrt((np.sum(gx_face**2) + np.sum(gy_face**2)) / (2.0 * nx * ny))\n    return rms\n\ndef mac_face_gradient_rms(p, dx):\n    \"\"\"\n    Compute MAC face gradients directly from adjacent center pressures.\n    Return RMS magnitude over all faces.\n    \"\"\"\n    nx, ny = p.shape\n\n    # x-face gradient: (p_{i+1,j} - p_{i,j}) / dx\n    p_ip = np.roll(p, -1, axis=0)\n    gx_face = (p_ip - p) / dx\n\n    # y-face gradient: (p_{i,j+1} - p_{i,j}) / dx\n    p_jp = np.roll(p, -1, axis=1)\n    gy_face = (p_jp - p) / dx\n\n    rms = np.sqrt((np.sum(gx_face**2) + np.sum(gy_face**2)) / (2.0 * nx * ny))\n    return rms\n\ndef run_test_case(nx):\n    ny = nx\n    p, Ap, dx = solve_poisson_checkerboard(nx, ny, L=1.0)\n    rms_col = colocated_face_gradient_rms(p, dx)\n    rms_mac = mac_face_gradient_rms(p, dx)\n    return (Ap, rms_col, rms_mac)\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [8, 16, 32, 64]\n\n    results = []\n    for nx in test_cases:\n        Ap, rms_col, rms_mac = run_test_case(nx)\n        # Format each tuple with reasonable precision\n        results.append(f\"({Ap:.10f},{rms_col:.10e},{rms_mac:.10e})\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "3365597"}, {"introduction": "Having established why stabilization is necessary, we now examine the most common solution for co-located grids: the Rhie-Chow interpolation. This technique prevents decoupling by modifying how mass fluxes are computed at control volume faces, ensuring that the face velocity is sensitive to the pressure difference between adjacent cells. This practice guides you through the essential algebraic steps to see how this interpolation directly constructs the pressure-correction equation, which lies at the heart of SIMPLE-family algorithms ([@problem_id:3302122]). By deriving the coefficients yourself, you will gain a concrete understanding of the mechanism that couples the pressure and velocity fields to produce a physically realistic and smooth solution.", "problem": "Consider a two-dimensional, incompressible, constant-density flow solved on a co-located finite volume grid, where all primitive variables are stored at cell centers. The grid is uniform with spacings $\\Delta x$ and $\\Delta y$, so the control volume for any interior cell $P$ has volume $\\Delta V = \\Delta x \\Delta y$, and the face areas are $A_{e} = \\Delta y$, $A_{w} = \\Delta y$, $A_{n} = \\Delta x$, and $A_{s} = \\Delta x$. The time integration is implicit Euler with time-step size $\\Delta t$. To avoid pressure–velocity decoupling on the co-located arrangement, the face mass fluxes are constructed using the Rhie–Chow interpolation, where the face-normal velocity correction depends on a face-effective inverse diagonal of the momentum equation obtained by central interpolation of the reciprocal of cell-center diagonal coefficients.\n\nAssume that in the discretized momentum equations for the horizontal velocity component $u$ and the vertical velocity component $v$, the diagonal coefficients at all cells are exactly $a_{P}^{u} = a_{P}^{v} = \\rho \\Delta V / \\Delta t$, where $\\rho$ is the constant density. Using this assumption and central interpolation of the reciprocal of the diagonal to compute the face-effective diagonal for each face, derive and explicitly assemble the coefficients of the linear pressure-correction equation for the interior cell $P$,\n$$\na_{P}^{p'} \\, p'_{P} \\;=\\; a_{E}^{p'} \\, p'_{E} \\;+\\; a_{W}^{p'} \\, p'_{W} \\;+\\; a_{N}^{p'} \\, p'_{N} \\;+\\; a_{S}^{p'} \\, p'_{S} \\;+\\; b_{P}^{p'} \\,,\n$$\nwhere $p'$ denotes the pressure correction, and $b_{P}^{p'}$ is the correction source term arising from mass-flux imbalance of the predicted (uncorrected) fluxes. Express the assembled coefficients $a_{W}^{p'}$, $a_{E}^{p'}$, $a_{S}^{p'}$, $a_{N}^{p'}$, and the diagonal $a_{P}^{p'}$ in terms of $\\Delta x$, $\\Delta y$, $\\rho$, and $\\Delta t$. Provide the final answers in the order $a_{W}^{p'}$, $a_{E}^{p'}$, $a_{S}^{p'}$, $a_{N}^{p'}$, $a_{P}^{p'}$ as a single row. No numerical evaluation is required.", "solution": "The pressure-correction equation is derived by enforcing mass conservation for the corrected velocity field. For a two-dimensional, incompressible flow on a uniform Cartesian grid, the discretized continuity equation for a control volume $P$ is:\n$$\n(\\rho u A)_{e} - (\\rho u A)_{w} + (\\rho v A)_{n} - (\\rho v A)_{s} = 0\n$$\nwhere $u$ and $v$ are the velocity components at the cell faces, and $A$ is the face area. Within the SIMPLE algorithm framework, the velocity and pressure fields are decomposed into a predicted part (denoted by $*$) and a correction part (denoted by $'$):\n$$\np = p^* + p' \\quad, \\quad u = u^* + u' \\quad, \\quad v = v^* + v'\n$$\nThe predicted velocities $u^*$ and $v^*$ do not generally satisfy continuity, resulting in a mass flux imbalance for cell $P$. The corrected velocities must satisfy continuity. Substituting the decompositions into the continuity equation and rearranging yields an equation for the corrections:\n$$\n(\\rho u' A)_{e} - (\\rho u' A)_{w} + (\\rho v' A)_{n} - (\\rho v' A)_{s} = - [(\\rho u^* A)_{e} - (\\rho u^* A)_{w} + (\\rho v^* A)_{n} - (\\rho v^* A)_{s}]\n$$\nThe right-hand side is the negative of the mass flux imbalance from the predictor step, which is defined as the source term $b_{P}^{p'}$. Our goal is to express the face-flux corrections on the left-hand side in terms of the pressure correction $p'$.\n\nThe velocity corrections are linked to the pressure correction gradient. From the simplified momentum equation, the cell-centered velocity correction can be approximated as $u'_P \\approx - (\\Delta V / a_P^u) \\nabla p'$. In the Rhie-Chow spirit, the face velocity correction $u'_e$ uses an interpolated form of this relationship:\n$$\nu'_e \\approx - \\overline{(\\Delta V/a^u)}_e \\frac{p'_E-p'_P}{\\Delta x}\n$$\nThe term $d = \\Delta V / a^u$ is the key coefficient. Given $a_P^u = \\rho \\Delta V / \\Delta t$, we find $d_P = \\frac{\\Delta V}{\\rho \\Delta V / \\Delta t} = \\frac{\\Delta t}{\\rho}$. Since this is constant for all cells, the interpolated value at the face $e$ is also $\\overline{d}_e = \\Delta t / \\rho$. Substituting this into the expression for $u'_e$:\n$$\nu'_{e} = - \\frac{\\Delta t}{\\rho} \\frac{p'_{E} - p'_{P}}{\\Delta x}\n$$\nThe mass flux correction at face $e$, $(\\rho u' A)_e$, is then:\n$$\n(\\rho u' A)_{e} = \\rho A_{e} u'_{e} = \\rho (\\Delta y) \\left( - \\frac{\\Delta t}{\\rho} \\frac{p'_{E} - p'_{P}}{\\Delta x} \\right) = - \\frac{\\Delta t \\Delta y}{\\Delta x} (p'_{E} - p'_{P})\n$$\nBy symmetry, we can derive the flux corrections for the other faces:\n- **West face (w):** The velocity correction is $u'_{w} = - \\frac{\\Delta t}{\\rho} \\frac{p'_{P} - p'_{W}}{\\Delta x}$. The flux correction is:\n$$\n(\\rho u' A)_{w} = \\rho A_{w} u'_{w} = \\rho (\\Delta y) \\left( - \\frac{\\Delta t}{\\rho} \\frac{p'_{P} - p'_{W}}{\\Delta x} \\right) = - \\frac{\\Delta t \\Delta y}{\\Delta x} (p'_{P} - p'_{W})\n$$\n- **North face (n):** Here we use the vertical velocity $v$ and its diagonal coefficient $a^v$. Since $a_{P}^{v}=a_{N}^{v}=\\frac{\\rho \\Delta V}{\\Delta t}$, the derivation is analogous. The velocity correction is $v'_{n} = - \\frac{\\Delta t}{\\rho} \\frac{p'_{N} - p'_{P}}{\\Delta y}$. The flux correction is:\n$$\n(\\rho v' A)_{n} = \\rho A_{n} v'_{n} = \\rho (\\Delta x) \\left( - \\frac{\\Delta t}{\\rho} \\frac{p'_{N} - p'_{P}}{\\Delta y} \\right) = - \\frac{\\Delta t \\Delta x}{\\Delta y} (p'_{N} - p'_{P})\n$$\n- **South face (s):** The velocity correction is $v'_{s} = - \\frac{\\Delta t}{\\rho} \\frac{p'_{P} - p'_{S}}{\\Delta y}$. The flux correction is:\n$$\n(\\rho v' A)_{s} = \\rho A_{s} v'_{s} = \\rho (\\Delta x) \\left( - \\frac{\\Delta t}{\\rho} \\frac{p'_{P} - p'_{S}}{\\Delta y} \\right) = - \\frac{\\Delta t \\Delta x}{\\Delta y} (p'_{P} - p'_{S})\n$$\nNow, we substitute these flux corrections into the continuity equation for the correction fields:\n$$\n(\\rho u' A)_{e} - (\\rho u' A)_{w} + (\\rho v' A)_{n} - (\\rho v' A)_{s} = b_{P}^{p'}\n$$\n$$\n\\left( - \\frac{\\Delta t \\Delta y}{\\Delta x} (p'_{E} - p'_{P}) \\right) - \\left( - \\frac{\\Delta t \\Delta y}{\\Delta x} (p'_{P} - p'_{W}) \\right) + \\left( - \\frac{\\Delta t \\Delta x}{\\Delta y} (p'_{N} - p'_{P}) \\right) - \\left( - \\frac{\\Delta t \\Delta x}{\\Delta y} (p'_{P} - p'_{S}) \\right) = b_{P}^{p'}\n$$\nExpanding and grouping terms:\n$$\n\\left( \\frac{\\Delta t \\Delta y}{\\Delta x} p'_{P} - \\frac{\\Delta t \\Delta y}{\\Delta x} p'_{E} \\right) + \\left( \\frac{\\Delta t \\Delta y}{\\Delta x} p'_{P} - \\frac{\\Delta t \\Delta y}{\\Delta x} p'_{W} \\right) + \\left( \\frac{\\Delta t \\Delta x}{\\Delta y} p'_{P} - \\frac{\\Delta t \\Delta x}{\\Delta y} p'_{N} \\right) + \\left( \\frac{\\Delta t \\Delta x}{\\Delta y} p'_{P} - \\frac{\\Delta t \\Delta x}{\\Delta y} p'_{S} \\right) = b_{P}^{p'}\n$$\nWe collect all terms with $p'_{P}$ on the left side and move all other terms to the right side to match the requested format $a_{P}^{p'} \\, p'_{P} = \\sum a_{nb}^{p'} \\, p'_{nb} + b_{P}^{p'}$.\n$$\np'_{P} \\left( \\frac{\\Delta t \\Delta y}{\\Delta x} + \\frac{\\Delta t \\Delta y}{\\Delta x} + \\frac{\\Delta t \\Delta x}{\\Delta y} + \\frac{\\Delta t \\Delta x}{\\Delta y} \\right) = \\left( \\frac{\\Delta t \\Delta y}{\\Delta x} \\right) p'_{E} + \\left( \\frac{\\Delta t \\Delta y}{\\Delta x} \\right) p'_{W} + \\left( \\frac{\\Delta t \\Delta x}{\\Delta y} \\right) p'_{N} + \\left( \\frac{\\Delta t \\Delta x}{\\Delta y} \\right) p'_{S} + b_{P}^{p'}\n$$\nFrom this final form, we can identify the coefficients:\n$$\na_{E}^{p'} = \\frac{\\Delta t \\Delta y}{\\Delta x}\n$$\n$$\na_{W}^{p'} = \\frac{\\Delta t \\Delta y}{\\Delta x}\n$$\n$$\na_{N}^{p'} = \\frac{\\Delta t \\Delta x}{\\Delta y}\n$$\n$$\na_{S}^{p'} = \\frac{\\Delta t \\Delta x}{\\Delta y}\n$$\nThe diagonal coefficient $a_{P}^{p'}$ is the sum of the neighbor coefficients:\n$$\na_{P}^{p'} = a_{E}^{p'} + a_{W}^{p'} + a_{N}^{p'} + a_{S}^{p'} = 2 \\frac{\\Delta t \\Delta y}{\\Delta x} + 2 \\frac{\\Delta t \\Delta x}{\\Delta y} = 2 \\Delta t \\left( \\frac{\\Delta y}{\\Delta x} + \\frac{\\Delta x}{\\Delta y} \\right)\n$$\nThe problem asks for the coefficients in the order $a_{W}^{p'}$, $a_{E}^{p'}$, $a_{S}^{p'}$, $a_{N}^{p'}$, $a_{P}^{p'}$.", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{\\Delta t \\Delta y}{\\Delta x} & \\frac{\\Delta t \\Delta y}{\\Delta x} & \\frac{\\Delta t \\Delta x}{\\Delta y} & \\frac{\\Delta t \\Delta x}{\\Delta y} & 2 \\Delta t \\left(\\frac{\\Delta y}{\\Delta x} + \\frac{\\Delta x}{\\Delta y}\\right) \\end{pmatrix}}\n$$", "id": "3302122"}, {"introduction": "While the standard Rhie-Chow interpolation effectively suppresses oscillations, the stabilization it provides also introduces a numerical truncation error, potentially reducing the overall accuracy of the simulation. A more sophisticated approach is to make the stabilization adaptive, applying it strongly only where needed (e.g., in regions of high convection) and weakly elsewhere. This advanced practice challenges you to design such an adaptive scheme based on local flow physics, specifically the cell Peclet number ([@problem_id:3302125]). You will derive the analytical relationship between stabilization strength and truncation error, revealing the fundamental trade-off between robustness and accuracy, and implement a model that embodies this intelligent compromise.", "problem": "Consider a uniform one-dimensional co-located grid for an incompressible flow in Computational Fluid Dynamics (CFD), with grid spacing $\\Delta x$ nondimensionalized to $\\Delta x = 1$. Face-normal velocities are constructed from cell-centered velocities and pressures using Rhie–Chow (RC) interpolation to suppress pressure–velocity decoupling. Let the continuity equation at cell index $i$ be discretized as $(u_{i+1/2} - u_{i-1/2})/\\Delta x = 0$. The RC face velocity is formed by a linear average of neighboring cell velocities and a pressure-difference correction scaled by a dimensionless coefficient $\\beta$ divided by a dimensionless representation of the momentum diagonal $a_m^*$. Assume the momentum diagonal scales with the local cell Reynolds number $Re_c$ as $a_m^* = 2 + |Re_c|$, reflecting the combination of diffusive and convective contributions in a one-dimensional central-difference discretization. Let the local cell Peclet number be $Pe_c = |u| \\Delta x/\\Gamma$, and let $s_0 \\in (0,1)$ be a user-specified upper bound for stabilization strength.\n\nStarting from the discrete continuity equation and the standard RC construction principle (pressure-difference-based stabilizing correction added to linearly interpolated face velocity), and using a von Neumann Fourier analysis on a uniform grid:\n\n- Derive the contribution of the RC correction to the discrete divergence operator at cell $i$ and show how it acts as a discrete Laplacian of the pressure scaled by $\\beta/a_m^*$.\n- Define a rigorously dimensionless stabilization strength $S_{\\max}$ as the amplitude of the RC-induced divergence for the highest resolvable wavenumber (Nyquist), and then derive $S_{\\max}$ in terms of $\\beta$ and $a_m^*$.\n- Using a Taylor expansion of the discrete Laplacian, identify the leading-order truncation error induced by the RC term and define a dimensionless truncation-error coefficient $T$ as the coefficient multiplying the leading higher-derivative term in the modified equation.\n\nDesign an adaptive law $\\beta(Re_c, Pe_c)$ by imposing that the stabilization strength saturates to a user-defined target curve that depends on the local cell Peclet number,\n$$\nS_{\\mathrm{des}}(|Pe_c|) = s_0 \\frac{Pe_c^2}{1 + Pe_c^2},\n$$\nso that stabilization is negligible in diffusion-dominated regions and approaches $s_0$ in strongly convection-dominated regions. That is, choose $\\beta(Re_c,Pe_c)$ so that $S_{\\max} = S_{\\mathrm{des}}(|Pe_c|)$ for each cell.\n\nYour tasks:\n\n- From first principles and the definitions above, derive explicit formulas for $S_{\\max}$ and $T$ in terms of $\\beta$ and $a_m^*$.\n- Using the requirement $S_{\\max} = S_{\\mathrm{des}}(|Pe_c|)$, derive an explicit closed-form expression for $\\beta(Re_c, Pe_c)$ and express $S_{\\max}(Re_c,Pe_c)$ and $T(Re_c,Pe_c)$ solely in terms of $Re_c$, $Pe_c$, and $s_0$.\n- Analyze the trade-off curve $T$ versus $S_{\\max}$ implied by your adaptive law. Characterize its slope and whether it depends on $Re_c$.\n\nAll quantities are nondimensional, so no physical units are required. Angles, if any appear in your derivation, must be in radians, but your final formulas should be angle-free.\n\nTest suite and required program output:\n\n- Implement your derived formulas in a program that, for each parameter triple $(Re_c, Pe_c, s_0)$, returns the triplet $[\\beta, S_{\\max}, T]$.\n- Use the following test suite of parameter triples:\n  - $(Re_c, Pe_c, s_0) = (0.0, 0.0, 0.8)$\n  - $(Re_c, Pe_c, s_0) = (0.1, 0.1, 0.8)$\n  - $(Re_c, Pe_c, s_0) = (10.0, 10.0, 0.8)$\n  - $(Re_c, Pe_c, s_0) = (50.0, 1.0, 0.8)$\n  - $(Re_c, Pe_c, s_0) = (10^6, 10^6, 0.8)$\n  - $(Re_c, Pe_c, s_0) = (100.0, 0.0, 0.8)$\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each result is itself a list of three floating-point numbers $[\\beta, S_{\\max}, T]$ rounded to $6$ decimal places, for example: $[[\\beta_1,S_1,T_1],[\\beta_2,S_2,T_2],\\dots]$.\n\nThe final answer must be a complete, runnable program that computes and prints these results exactly in the specified format.", "solution": "The problem requires the derivation and analysis of an adaptive Rhie–Chow (RC) interpolation scheme for a one-dimensional co-located grid in the context of computational fluid dynamics. The analysis will be performed using Fourier analysis and Taylor series expansion to derive key properties of the numerical scheme, namely its stabilization strength and truncation error. Subsequently, an adaptive law for the RC coefficient $\\beta$ will be derived to meet a specified stabilization target.\n\n**1. Rhie–Chow Contribution to the Discrete Divergence**\n\nThe discrete continuity equation at a cell with index $i$ on a uniform grid with spacing $\\Delta x=1$ is given as:\n$$ u_{i+1/2} - u_{i-1/2} = 0 $$\nThe problem describes the Rhie–Chow face velocity $u_{i+1/2}$ as being formed by a linear average of neighboring cell-centered velocities ($u_i$, $u_{i+1}$) and a pressure-difference correction. This corresponds to the standard RC formula:\n$$ u_{i+1/2} = \\frac{u_i + u_{i+1}}{2} - \\frac{\\beta}{a_m^*} (p_{i+1} - p_i) $$\nwhere we have used the given grid spacing $\\Delta x = 1$. The quantities $\\beta$ and $a_m^*$ are the dimensionless RC coefficient and momentum equation diagonal, respectively, which are treated as locally constant for this analysis.\n\nThe velocity at the left face of the cell, $u_{i-1/2}$, is analogously defined:\n$$ u_{i-1/2} = \\frac{u_{i-1} + u_i}{2} - \\frac{\\beta}{a_m^*} (p_i - p_{i-1}) $$\nSubstituting these expressions for the face velocities into the discrete continuity equation yields:\n$$ \\left( \\frac{u_i + u_{i+1}}{2} - \\frac{\\beta}{a_m^*} (p_{i+1} - p_i) \\right) - \\left( \\frac{u_{i-1} + u_i}{2} - \\frac{\\beta}{a_m^*} (p_i - p_{i-1}) \\right) = 0 $$\nCombining and rearranging terms, we separate the velocity and pressure contributions:\n$$ \\frac{u_{i+1} - u_{i-1}}{2} - \\frac{\\beta}{a_m^*} \\left[ (p_{i+1} - p_i) - (p_i - p_{i-1}) \\right] = 0 $$\nThis can be written as:\n$$ \\frac{u_{i+1} - u_{i-1}}{2} - \\frac{\\beta}{a_m^*} (p_{i+1} - 2p_i + p_{i-1}) = 0 $$\nThe first term, $\\frac{u_{i+1} - u_{i-1}}{2\\Delta x}$ with $\\Delta x=1$, represents the standard central-difference approximation of the velocity divergence $\\nabla \\cdot \\mathbf{u}$ at cell $i$. The second term is the contribution from the RC interpolation, which we denote as $D_{RC}(p)_i$:\n$$ D_{RC}(p)_i = - \\frac{\\beta}{a_m^*} (p_{i+1} - 2p_i + p_{i-1}) $$\nThe expression $(p_{i+1} - 2p_i + p_{i-1})$ is the standard, second-order finite difference approximation of the one-dimensional Laplacian operator $\\frac{d^2p}{dx^2}$ scaled by $\\Delta x^2$. Since $\\Delta x=1$, this term is precisely the discrete Laplacian of pressure at cell $i$. Therefore, the RC correction introduces a term into the continuity equation that acts as a discrete Laplacian of the pressure field, scaled by the factor $-\\beta/a_m^*$.\n\n**2. Stabilization Strength ($S_{\\max}$)**\n\nTo analyze the properties of the RC-induced stabilization term, we perform a von Neumann (Fourier) analysis. We consider the effect of the operator on a single Fourier mode of pressure, $p_j = \\hat{p} e^{I k x_j}$, where $x_j = j\\Delta x = j$, $k$ is the wavenumber, and $I = \\sqrt{-1}$. Applying the discrete Laplacian operator to this mode gives:\n$$ p_{j+1} - 2p_j + p_{j-1} = \\hat{p}e^{Ikj}(e^{Ik} - 2 + e^{-Ik}) = \\hat{p}e^{Ikj}(2\\cos(k) - 2) $$\nThe Fourier symbol of the discrete Laplacian operator is thus $2(\\cos(k)-1)$. The Fourier symbol of the entire RC contribution $D_{RC}(p)$ is:\n$$ \\widehat{D_{RC}(p)} = - \\frac{\\beta}{a_m^*} [2(\\cos(k)-1)] = \\frac{2\\beta}{a_m^*}(1 - \\cos(k)) $$\nThe stabilization strength $S(k)$ is defined as the amplitude of this operator in Fourier space. Assuming $\\beta > 0$ and $a_m^* > 0$:\n$$ S(k) = \\frac{2\\beta}{a_m^*} (1 - \\cos(k)) $$\nThe maximum stabilization strength, $S_{\\max}$, occurs at the highest resolvable wavenumber on the grid, which is the Nyquist frequency $k = \\pi / \\Delta x = \\pi$. At this wavenumber, corresponding to the highest-frequency \"checkerboard\" mode, we have:\n$$ S_{\\max} = S(\\pi) = \\frac{2\\beta}{a_m^*} (1 - \\cos(\\pi)) = \\frac{2\\beta}{a_m^*} (1 - (-1)) = \\frac{4\\beta}{a_m^*} $$\n\n**3. Truncation Error Coefficient ($T$)**\n\nThe truncation error is determined by comparing the discrete operator to its continuous counterpart using Taylor series expansions. Expanding $p(x_i \\pm \\Delta x)$ around $x_i$:\n$$ p_{i\\pm1} = p_i \\pm p'_i \\Delta x + \\frac{p''_i}{2} \\Delta x^2 \\pm \\frac{p'''_i}{6} \\Delta x^3 + \\frac{p''''_i}{24} \\Delta x^4 + O(\\Delta x^5) $$\nSubstituting these into the discrete Laplacian expression (with $\\Delta x=1$):\n$$ p_{i+1} - 2p_i + p_{i-1} = \\left(p_i'' + \\frac{p''''_i}{12} + O(\\Delta x^4)\\right) \\Delta x^2 = \\frac{d^2p}{dx^2} + \\frac{1}{12}\\frac{d^4p}{dx^4} + O(\\Delta x^4) $$\nThe RC contribution $D_{RC}(p)_i$ can thus be written as a differential operator plus higher-order terms:\n$$ D_{RC}(p)_i = - \\frac{\\beta}{a_m^*} \\left( \\frac{d^2p}{dx^2} + \\frac{1}{12}\\frac{d^4p}{dx^4} + \\dots \\right) $$\nThe leading-order truncation error is the first term in the expansion beyond the intended continuous operator. Here, it is the term involving the fourth derivative:\n$$ \\text{Truncation Error} = - \\frac{\\beta}{12 a_m^*} \\frac{d^4p}{dx^4} $$\nThe dimensionless truncation-error coefficient $T$ is defined as the absolute value of the coefficient of this leading higher-derivative term:\n$$ T = \\left| - \\frac{\\beta}{12 a_m^*} \\right| = \\frac{\\beta}{12 a_m^*} $$\n\n**4. Adaptive Law and Derived Formulas**\n\nThe problem specifies an adaptive law for $\\beta$ by requiring the maximum stabilization strength $S_{\\max}$ to match a desired target curve $S_{\\mathrm{des}}(|Pe_c|)$:\n$$ S_{\\max} = S_{\\mathrm{des}}(|Pe_c|) = s_0 \\frac{Pe_c^2}{1 + Pe_c^2} $$\nUsing our derived formula for $S_{\\max}$ and the given expression for the momentum diagonal $a_m^* = 2 + |Re_c|$, we can solve for $\\beta$. Since $Re_c$ is a non-negative parameter, we use $Re_c$ for $|Re_c|$.\n$$ \\frac{4\\beta}{2 + Re_c} = s_0 \\frac{Pe_c^2}{1 + Pe_c^2} $$\nSolving for $\\beta(Re_c, Pe_c)$:\n$$ \\beta(Re_c, Pe_c) = \\frac{s_0 (2 + Re_c)}{4} \\frac{Pe_c^2}{1 + Pe_c^2} $$\nThis is the closed-form expression for the adaptive RC coefficient.\n\nWith this law, $S_{\\max}$ is by definition equal to $S_{\\mathrm{des}}$:\n$$ S_{\\max}(Re_c, Pe_c) = s_0 \\frac{Pe_c^2}{1 + Pe_c^2} $$\nTo find the truncation error coefficient $T$ under this adaptive law, we substitute the expressions for $\\beta$ and $a_m^*$ into the formula for $T$:\n$$ T = \\frac{\\beta}{12 a_m^*} = \\frac{1}{12(2 + Re_c)} \\left( \\frac{s_0 (2 + Re_c)}{4} \\frac{Pe_c^2}{1 + Pe_c^2} \\right) $$\nThe term $(2 + Re_c)$ cancels, yielding:\n$$ T(Re_c, Pe_c) = \\frac{s_0}{48} \\frac{Pe_c^2}{1 + Pe_c^2} $$\n\n**5. Analysis of the $T$ vs. $S_{\\max}$ Trade-off**\n\nFrom the derived expressions for $S_{\\max}$ and $T$, we can establish a direct relationship between them:\n$$ S_{\\max} = s_0 \\frac{Pe_c^2}{1 + Pe_c^2} \\quad \\implies \\quad \\frac{Pe_c^2}{1 + Pe_c^2} = \\frac{S_{\\max}}{s_0} $$\nSubstituting this into the expression for $T$:\n$$ T = \\frac{s_0}{48} \\left( \\frac{S_{\\max}}{s_0} \\right) = \\frac{S_{\\max}}{48} $$\nThis result, $T = S_{\\max}/48$, reveals a fundamental trade-off inherent in this numerical scheme. The relationship is linear, meaning the amount of fourth-order truncation error introduced is directly proportional to the amount of stabilization applied. The slope of the trade-off curve, $dT/dS_{\\max}$, is a constant:\n$$ \\frac{dT}{dS_{\\max}} = \\frac{1}{48} $$\nThis slope is independent of the physical parameters $Re_c$ and $Pe_c$, and also of the user-defined parameter $s_0$. This fixed relationship is a structural property of the chosen second-order central difference stencil for the pressure Laplacian in the RC formulation.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the adaptive Rhie-Chow coefficient (beta), maximum stabilization\n    strength (S_max), and truncation error coefficient (T) for a set of\n    test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (0.0, 0.0, 0.8),\n        (0.1, 0.1, 0.8),\n        (10.0, 10.0, 0.8),\n        (50.0, 1.0, 0.8),\n        (1e6, 1e6, 0.8),\n        (100.0, 0.0, 0.8),\n    ]\n\n    results = []\n    for case in test_cases:\n        Rec, Pec, s0 = case\n\n        # The Peclet number term appears in all calculations.\n        # Handle the case Pec = 0 to avoid division by zero, although\n        # Pec**2 / (1 + Pec**2) is well-behaved.\n        if Pec == 0.0:\n            pec_term = 0.0\n        else:\n            pec_term = Pec**2 / (1.0 + Pec**2)\n\n        # 1. Calculate S_max(Rec, Pec)\n        # S_max = s0 * (Pec^2 / (1 + Pec^2))\n        S_max = s0 * pec_term\n\n        # 2. Calculate beta(Rec, Pec)\n        # beta = (s0 * (2 + Rec) / 4) * (Pec^2 / (1 + Pec^2))\n        beta = (s0 * (2.0 + Rec) / 4.0) * pec_term\n\n        # 3. Calculate T(Rec, Pec)\n        # T = S_max / 48\n        T = S_max / 48.0\n        \n        # Round results to 6 decimal places as required.\n        # Note: round() provides standard rounding, which might differ from\n        # simple truncation, but is the appropriate function.\n        # The representation of 0.8 is exact in binary for a power of 2 denominator.\n        # Adding a small epsilon for values like 200000.4 to ensure correct rounding\n        # due to finite precision might be needed for some languages, but Python's\n        # float precision is generally sufficient here.\n        \n        rounded_beta = round(beta, 6)\n        rounded_S_max = round(S_max, 6)\n        rounded_T = round(T, 6)\n\n        results.append([rounded_beta, rounded_S_max, rounded_T])\n\n    # Final print statement in the exact required format.\n    # The format is a string representation of a list of lists.\n    # Ex: '[[beta1,S1,T1],[beta2,S2,T2],...]'\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3302125"}]}