{"hands_on_practices": [{"introduction": "The primary goal of the QZ algorithm is to transform a general matrix pair $(A,B)$ into a much simpler form, the generalized Schur form $(S,T)$, without changing the problem's underlying eigenvalues. This exercise begins at the end of that process, providing you with the resulting $(S,T)$ pair. By working backward to extract the eigenvalues from this simplified form, you will solidify your understanding of why this decomposition is so powerful and what the algorithm ultimately aims to achieve. [@problem_id:3594724]", "problem": "Consider the generalized eigenvalue problem for matrices $\\mathbf{A} \\in \\mathbb{R}^{n \\times n}$ and $\\mathbf{B} \\in \\mathbb{R}^{n \\times n}$, defined by the roots $\\lambda \\in \\mathbb{C}$ of the equation $\\det(\\mathbf{A} - \\lambda \\mathbf{B}) = 0$. The generalized Schur (QZ) algorithm produces orthogonal matrices $\\mathbf{Q}$ and $\\mathbf{Z}$ such that $\\mathbf{Q}^{\\top} \\mathbf{A} \\mathbf{Z} = \\mathbf{S}$ and $\\mathbf{Q}^{\\top} \\mathbf{B} \\mathbf{Z} = \\mathbf{T}$, where $\\mathbf{S}$ is upper quasi-triangular and $\\mathbf{T}$ is upper triangular. Using only these foundational facts, extract the generalized eigenvalues from a given $(\\mathbf{S}, \\mathbf{T})$ pair by solving $\\det(\\mathbf{S}_{ii} - \\lambda \\mathbf{T}_{ii}) = 0$ on the diagonal blocks $\\mathbf{S}_{ii}, \\mathbf{T}_{ii}$. Then, verify by direct computation that $\\det(\\mathbf{A} - \\lambda \\mathbf{B})$ vanishes at those values (within rounding error).\n\nFor this task, you are given the generalized Schur form\n$$\n\\mathbf{S} = \\begin{pmatrix}\n2  3  0 \\\\\n1  4  0 \\\\\n0  0  5\n\\end{pmatrix}, \n\\quad\n\\mathbf{T} = \\begin{pmatrix}\n1  0  0 \\\\\n0  1  0 \\\\\n0  0  2\n\\end{pmatrix}.\n$$\nFor the purpose of the verification step, take $\\mathbf{Q} = \\mathbf{I}$ and $\\mathbf{Z} = \\mathbf{I}$, so that $\\mathbf{A} = \\mathbf{S}$ and $\\mathbf{B} = \\mathbf{T}$.\n\nCompute the generalized eigenvalues from $(\\mathbf{S}, \\mathbf{T})$, verify that $\\det(\\mathbf{A} - \\lambda \\mathbf{B})$ evaluates to zero at each of these values by direct evaluation, and report the sum of the generalized eigenvalues. Express your final answer as an exact number (no rounding required).", "solution": "The problem is valid as it is scientifically grounded in numerical linear algebra, well-posed, objective, and fully specified. All premises are factually correct and internally consistent.\n\nThe problem asks for the computation of generalized eigenvalues for a given pair of matrices $(\\mathbf{S}, \\mathbf{T})$ in generalized Schur form, verification of these eigenvalues, and their sum. The generalized eigenvalue problem is defined by the equation $\\det(\\mathbf{A} - \\lambda \\mathbf{B}) = 0$. The QZ algorithm provides a decomposition such that $\\mathbf{Q}^{\\top} \\mathbf{A} \\mathbf{Z} = \\mathbf{S}$ and $\\mathbf{Q}^{\\top} \\mathbf{B} \\mathbf{Z} = \\mathbf{T}$, where $\\mathbf{Q}$ and $\\mathbf{Z}$ are orthogonal matrices. A key property of this decomposition is that the generalized eigenvalues of the pair $(\\mathbf{A}, \\mathbf{B})$ are the same as those of the pair $(\\mathbf{S}, \\mathbf{T})$. This is because $\\det(\\mathbf{Q})$ and $\\det(\\mathbf{Z})$ are non-zero (specifically, $\\pm 1$).\n$$\n\\det(\\mathbf{A} - \\lambda \\mathbf{B}) = 0 \\iff \\det(\\mathbf{Q}^{\\top}(\\mathbf{A} - \\lambda \\mathbf{B})\\mathbf{Z}) = 0\n$$\n$$\n\\iff \\det(\\mathbf{Q}^{\\top}\\mathbf{A}\\mathbf{Z} - \\lambda \\mathbf{Q}^{\\top}\\mathbf{B}\\mathbf{Z}) = 0 \\iff \\det(\\mathbf{S} - \\lambda \\mathbf{T}) = 0\n$$\nThe problem provides the matrices $\\mathbf{S}$ and $\\mathbf{T}$ in generalized Schur form:\n$$\n\\mathbf{S} = \\begin{pmatrix}\n2  3  0 \\\\\n1  4  0 \\\\\n0  0  5\n\\end{pmatrix}, \n\\quad\n\\mathbf{T} = \\begin{pmatrix}\n1  0  0 \\\\\n0  1  0 \\\\\n0  0  2\n\\end{pmatrix}\n$$\nThe matrix $\\mathbf{S}$ is upper quasi-triangular, which means it is block upper triangular with $1 \\times 1$ or $2 \\times 2$ diagonal blocks. The matrix $\\mathbf{T}$ is upper triangular. In this case, $\\mathbf{S}$ is block upper triangular and $\\mathbf{T}$ is block diagonal (which is a special case of block upper triangular with the same block structure). The determinant of a block triangular matrix is the product of the determinants of its diagonal blocks. Thus, the generalized eigenvalues can be extracted by solving $\\det(\\mathbf{S}_{ii} - \\lambda \\mathbf{T}_{ii}) = 0$ for each diagonal block pair $(\\mathbf{S}_{ii}, \\mathbf{T}_{ii})$.\n\nThe diagonal blocks of $\\mathbf{S}$ and $\\mathbf{T}$ are:\nA $2 \\times 2$ block:\n$$\n\\mathbf{S}_{11} = \\begin{pmatrix} 2  3 \\\\ 1  4 \\end{pmatrix}, \\quad \\mathbf{T}_{11} = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix}\n$$\nAnd a $1 \\times 1$ block:\n$$\n\\mathbf{S}_{22} = (5), \\quad \\mathbf{T}_{22} = (2)\n$$\n\nFirst, we find the eigenvalues from the $2 \\times 2$ block by solving $\\det(\\mathbf{S}_{11} - \\lambda \\mathbf{T}_{11}) = 0$.\n$$\n\\mathbf{S}_{11} - \\lambda \\mathbf{T}_{11} = \\begin{pmatrix} 2  3 \\\\ 1  4 \\end{pmatrix} - \\lambda \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} 2-\\lambda  3 \\\\ 1  4-\\lambda \\end{pmatrix}\n$$\nThe determinant is:\n$$\n\\det(\\mathbf{S}_{11} - \\lambda \\mathbf{T}_{11}) = (2-\\lambda)(4-\\lambda) - (3)(1) = 8 - 4\\lambda - 2\\lambda + \\lambda^2 - 3 = \\lambda^2 - 6\\lambda + 5\n$$\nSetting the determinant to zero:\n$$\n\\lambda^2 - 6\\lambda + 5 = 0\n$$\nFactoring the quadratic equation gives $(\\lambda - 1)(\\lambda - 5) = 0$. The roots are $\\lambda_1 = 1$ and $\\lambda_2 = 5$.\n\nNext, we find the eigenvalue from the $1 \\times 1$ block by solving $\\det(\\mathbf{S}_{22} - \\lambda \\mathbf{T}_{22}) = 0$.\n$$\n\\mathbf{S}_{22} - \\lambda \\mathbf{T}_{22} = (5) - \\lambda(2) = (5 - 2\\lambda)\n$$\nThe determinant is simply $5 - 2\\lambda$. Setting this to zero gives:\n$$\n5 - 2\\lambda = 0 \\implies \\lambda_3 = \\frac{5}{2}\n$$\nThe set of generalized eigenvalues is $\\{\\lambda_1, \\lambda_2, \\lambda_3\\} = \\{1, 5, \\frac{5}{2}\\}$.\n\nFor the verification, we are instructed to set $\\mathbf{A} = \\mathbf{S}$ and $\\mathbf{B} = \\mathbf{T}$ and show that $\\det(\\mathbf{A} - \\lambda \\mathbf{B})$ vanishes for each eigenvalue. We compute $\\det(\\mathbf{S} - \\lambda \\mathbf{T})$ directly.\n$$\n\\mathbf{S} - \\lambda \\mathbf{T} = \\begin{pmatrix}\n2-\\lambda  3  0 \\\\\n1  4-\\lambda  0 \\\\\n0  0  5-2\\lambda\n\\end{pmatrix}\n$$\nThe determinant of this block-structured matrix is:\n$$\n\\det(\\mathbf{S} - \\lambda \\mathbf{T}) = \\left( \\det \\begin{pmatrix} 2-\\lambda  3 \\\\ 1  4-\\lambda \\end{pmatrix} \\right) \\cdot (5-2\\lambda)\n$$\n$$\n\\det(\\mathbf{S} - \\lambda \\mathbf{T}) = ( (2-\\lambda)(4-\\lambda) - 3 ) \\cdot (5-2\\lambda) = (\\lambda^2 - 6\\lambda + 5)(5-2\\lambda) = (\\lambda-1)(\\lambda-5)(5-2\\lambda)\n$$\nLet's name this characteristic polynomial $p(\\lambda) = \\det(\\mathbf{S} - \\lambda \\mathbf{T})$. We verify by direct evaluation that $p(\\lambda) = 0$ for each computed eigenvalue:\nFor $\\lambda_1 = 1$:\n$$\np(1) = (1-1)(1-5)(5 - 2 \\cdot 1) = (0)(-4)(3) = 0\n$$\nFor $\\lambda_2 = 5$:\n$$\np(5) = (5-1)(5-5)(5 - 2 \\cdot 5) = (4)(0)(-5) = 0\n$$\nFor $\\lambda_3 = \\frac{5}{2}$:\n$$\np\\left(\\frac{5}{2}\\right) = \\left(\\frac{5}{2}-1\\right)\\left(\\frac{5}{2}-5\\right)\\left(5 - 2 \\cdot \\frac{5}{2}\\right) = \\left(\\frac{3}{2}\\right)\\left(-\\frac{5}{2}\\right)(5-5) = \\left(\\frac{3}{2}\\right)\\left(-\\frac{5}{2}\\right)(0) = 0\n$$\nThe verification is successful. All computed eigenvalues are correct.\n\nFinally, we compute the sum of the generalized eigenvalues:\n$$\n\\sum_{i=1}^{3} \\lambda_i = \\lambda_1 + \\lambda_2 + \\lambda_3 = 1 + 5 + \\frac{5}{2} = 6 + \\frac{5}{2} = \\frac{12}{2} + \\frac{5}{2} = \\frac{17}{2}\n$$\nThe sum of the generalized eigenvalues is $\\frac{17}{2}$.", "answer": "$$\n\\boxed{\\frac{17}{2}}\n$$", "id": "3594724"}, {"introduction": "The QZ algorithm iteratively refines the matrix pair using a sequence of orthogonal transformations in a process known as \"bulge chasing.\" This hands-on practice demystifies this core mechanism by guiding you through a single, complete step of the algorithm. By explicitly calculating the sequence of Givens rotations needed to introduce a perturbation and then chase it down the diagonal, you will gain a concrete, mechanical intuition for how the algorithm maintains the essential Hessenberg-triangular structure while progressing toward the final Schur form. [@problem_id:3594787]", "problem": "Consider the generalized eigenproblem for a real pair of matrices $(A,B)$, where $A \\in \\mathbb{R}^{5 \\times 5}$ is upper Hessenberg and $B \\in \\mathbb{R}^{5 \\times 5}$ is upper triangular. A single implicit-shift step of the generalized Schur (QZ) algorithm applies a sequence of orthogonal plane rotations to $(A,B)$ so that, after the step, $(A,B)$ is again an upper Hessenbergâ€“triangular pair with the chase of the initially introduced bulge completed. A Givens rotation is a $2 \\times 2$ orthogonal matrix of the form\n$$G(c,s) \\;=\\; \\begin{pmatrix} c  s \\\\ -s  c \\end{pmatrix},$$\nwith $c^{2}+s^{2}=1$, used to act on consecutive rows (from the left) or on consecutive columns (from the right). In a single-shift QZ sweep, one chooses the shift $\\mu = a_{55}/b_{55}$, introduces a bulge at the top via a left rotation based on the first two entries of the vector $(A - \\mu B)e_{1}$, restores upper triangularity of $B$ via a right rotation, and then chases the bulge down with alternating left and right Givens rotations on successive $2 \\times 2$ row/column windows.\n\nLet\n$$\nA \\;=\\;\n\\begin{pmatrix}\n4  2  0  0  0 \\\\\n1  5  3  0  0 \\\\\n0  0  6  0  0 \\\\\n0  0  0  7  5 \\\\\n0  0  0  0  8\n\\end{pmatrix},\n\\qquad\nB \\;=\\;\n\\begin{pmatrix}\n2  0  0  0  0 \\\\\n0  3  0  0  0 \\\\\n0  0  4  0  0 \\\\\n0  0  0  5  0 \\\\\n0  0  0  0  6\n\\end{pmatrix}.\n$$\nPerform one implicit single-shift QZ sweep with the shift $\\mu = a_{55}/b_{55}$. Use the following fundamental definitions and facts:\n\n- The generalized eigenproblem seeks $\\lambda \\in \\mathbb{R}$ and $x \\neq 0$ such that $Ax = \\lambda Bx$.\n- An upper Hessenberg matrix has zeros below the first subdiagonal.\n- An upper triangular matrix has zeros below the diagonal.\n- A left Givens rotation $G(c,s)$ acts on rows $i,i+1$, and a right Givens rotation acts on columns $j,j+1$.\n- Given a 2-vector $(\\alpha,\\beta)^T$, the Givens parameters may be chosen as $c = \\alpha/\\sqrt{\\alpha^{2}+\\beta^{2}}$, $s = \\beta/\\sqrt{\\alpha^{2}+\\beta^{2}}$ to zero the second entry when applied from the left; and, when acting on columns to zero the first component of a row 2-vector $(\\gamma,\\delta)$, one may take $c = \\delta/\\sqrt{\\gamma^{2}+\\delta^{2}}$, $s = -\\gamma/\\sqrt{\\gamma^{2}+\\delta^{2}}$.\n\nExplicitly determine the ordered sequence of Givens rotations that annihilates all introduced bulge elements in this sweep:\n\n1. The first left rotation $G(c_{1},s_{1})$ on rows $1$ and $2$ derived from the first two entries of $(A - \\mu B)e_{1}$.\n2. The first right rotation $G(c_{2},s_{2})$ on columns $1$ and $2$ that restores upper triangularity of $B$ by annihilating the entry at position $(2,1)$.\n3. Continue the bulge chase with alternating left rotations on rows $(2,3)$, $(3,4)$, $(4,5)$ and right rotations on columns $(2,3)$, $(3,4)$, $(4,5)$, writing each rotation as $G(c_{k},s_{k})$ with its specific parameters. Where the structure of $(A,B)$ implies no bulge is present, include the corresponding identity rotation $G(1,0)$ explicitly.\n\nProvide your final answer as a single row matrix containing the $16$ scalars\n$$\nc_{1}, s_{1}, c_{2}, s_{2}, c_{3}, s_{3}, c_{4}, s_{4}, c_{5}, s_{5}, c_{6}, s_{6}, c_{7}, s_{7}, c_{8}, s_{8}.\n$$\nNo rounding is required; give exact expressions. The final answer must be dimensionless and expressed in analytic form only, with no units.", "solution": "The user wants me to perform a single step of the implicit-shift QZ algorithm for a given pair of matrices $(A, B)$.\n\n### Step 0: Problem Setup and Shift Calculation\nThe given matrices are:\n$$ A = A_0 = \\begin{pmatrix} 4  2  0  0  0 \\\\ 1  5  3  0  0 \\\\ 0  0  6  0  0 \\\\ 0  0  0  7  5 \\\\ 0  0  0  0  8 \\end{pmatrix}, \\quad B = B_0 = \\begin{pmatrix} 2  0  0  0  0 \\\\ 0  3  0  0  0 \\\\ 0  0  4  0  0 \\\\ 0  0  0  5  0 \\\\ 0  0  0  0  6 \\end{pmatrix} $$\nMatrix $A$ is upper Hessenberg and matrix $B$ is upper triangular (in fact, diagonal).\nThe shift for the implicit QZ step is given by $\\mu = a_{55}/b_{55}$.\n$$ \\mu = \\frac{8}{6} = \\frac{4}{3} $$\n\nThe QZ sweep consists of a sequence of left and right Givens rotations. A rotation is denoted by $G(c,s) = \\begin{pmatrix} c  s \\\\ -s  c \\end{pmatrix}$. We will determine the parameters $(c_k, s_k)$ for each rotation $G_k$.\n\n### Step 1: First Left Rotation, $G_1(c_1, s_1)$\nThis rotation is applied to rows $1$ and $2$ of $A$ and $B$. It is constructed to zero the second element of the vector $v = (A - \\mu B)e_1$. The first column of $A-\\mu B$ is:\n$$ (A - \\mu B)e_1 = \\begin{pmatrix} a_{11} - \\mu b_{11} \\\\ a_{21} - \\mu b_{21} \\\\ \\vdots \\end{pmatrix} = \\begin{pmatrix} 4 - \\frac{4}{3}(2) \\\\ 1 - \\frac{4}{3}(0) \\\\ \\vdots \\end{pmatrix} = \\begin{pmatrix} 4 - \\frac{8}{3} \\\\ 1 \\\\ \\vdots \\end{pmatrix} = \\begin{pmatrix} \\frac{4}{3} \\\\ 1 \\\\ \\vdots \\end{pmatrix} $$\nWe consider the $2$-vector $(\\alpha, \\beta)^T = (4/3, 1)^T$. The problem provides the formula to calculate the Givens parameters $(c,s)$ to zero the second entry: $c = \\alpha/\\sqrt{\\alpha^2+\\beta^2}$ and $s = \\beta/\\sqrt{\\alpha^2+\\beta^2}$.\nFirst, we compute the norm:\n$$ \\sqrt{\\alpha^2 + \\beta^2} = \\sqrt{\\left(\\frac{4}{3}\\right)^2 + 1^2} = \\sqrt{\\frac{16}{9} + 1} = \\sqrt{\\frac{25}{9}} = \\frac{5}{3} $$\nThe parameters for the first rotation $G_1$ are:\n$$ c_1 = \\frac{4/3}{5/3} = \\frac{4}{5}, \\quad s_1 = \\frac{1}{5/3} = \\frac{3}{5} $$\nSo, $G_1 = G(4/5, 3/5)$. Let the corresponding $5 \\times 5$ rotation matrix be $Q_1$. Applying this to $B_0$ from the left gives $B_1 = Q_1 B_0$. The new rows 1 and 2 of $B_1$ are:\n$B_{1, \\text{row } 1} = c_1 B_{0, \\text{row } 1} + s_1 B_{0, \\text{row } 2} = \\frac{4}{5}(2,0,\\dots) + \\frac{3}{5}(0,3,\\dots) = (\\frac{8}{5}, \\frac{9}{5}, 0, 0, 0)$.\n$B_{1, \\text{row } 2} = -s_1 B_{0, \\text{row } 1} + c_1 B_{0, \\text{row } 2} = -\\frac{3}{5}(2,0,\\dots) + \\frac{4}{5}(0,3,\\dots) = (-\\frac{6}{5}, \\frac{12}{5}, 0, 0, 0)$.\n$B_1$ now has a non-zero element at position $(2,1)$, which is $b_{21} = -6/5$.\n\n### Step 2: First Right Rotation, $G_2(c_2, s_2)$\nThis rotation is applied to columns $1$ and $2$ of $A_1=Q_1 A_0$ and $B_1=Q_1 B_0$ to restore $B$ to upper triangular form by annihilating the element $b_{21}$.\nWe need to zero the first component of the row vector $(b_{21}, b_{22}) = (-6/5, 12/5)$. Let this vector be $(\\gamma, \\delta)$.\nThe problem provides the formula $c = \\delta/\\sqrt{\\gamma^2+\\delta^2}$ and $s = -\\gamma/\\sqrt{\\gamma^2+\\delta^2}$.\nFirst, the norm:\n$$ \\sqrt{\\gamma^2 + \\delta^2} = \\sqrt{\\left(-\\frac{6}{5}\\right)^2 + \\left(\\frac{12}{5}\\right)^2} = \\frac{1}{5}\\sqrt{36 + 144} = \\frac{1}{5}\\sqrt{180} = \\frac{1}{5}\\sqrt{36 \\times 5} = \\frac{6\\sqrt{5}}{5} $$\nThe parameters for the second rotation $G_2$ are:\n$$ c_2 = \\frac{12/5}{6\\sqrt{5}/5} = \\frac{12}{6\\sqrt{5}} = \\frac{2}{\\sqrt{5}}, \\quad s_2 = - \\frac{-6/5}{6\\sqrt{5}/5} = \\frac{6}{6\\sqrt{5}} = \\frac{1}{\\sqrt{5}} $$\nSo, $G_2 = G(2/\\sqrt{5}, 1/\\sqrt{5})$. Let the corresponding right rotation matrix be $Z_1$. We have $A_2 = A_1 Z_1$ and $B_2 = B_1 Z_1$.\n\n### Step 3: Chasing the Bulge\nThe rest of the sweep consists of alternating left and right rotations to chase the bulge down the subdiagonal of $A$ and $B$.\n\n**Rotation $G_3(c_3, s_3)$ (Left, rows 2-3):**\nThis rotation $Q_2$ must annihilate the bulge element $a_{31}$ created by the previous right rotation $Z_1$. Let's compute this element in the current matrix $A_2$.\nThe matrix $A_1 = Q_1 A_0$ has its third row unchanged from $A_0$ because $Q_1$ acts only on rows 1 and 2. The third row of $A_0$ is $(0, 0, 6, 0, 0)$. Applying the right rotation $Z_1$ (which acts on columns 1 and 2) to $A_1$ to get $A_2$:\n$A_2(3,1) = A_1(3,1) c_2 - A_1(3,2) s_2 = (0) c_2 - (0) s_2 = 0$.\nThe bulge element to be annihilated is already zero. The problem states that in this case we should use the identity rotation $G(1,0)$.\n$$ c_3 = 1, \\quad s_3 = 0 $$\n\n**Rotation $G_4(c_4, s_4)$ (Right, cols 2-3):**\nThis rotation $Z_2$ must annihilate the bulge element $b_{32}$ created by the left rotation $Q_2$. Since $Q_2$ is the identity transformation ($c_3=1, s_3=0$), it does not create any bulge. The element $b_{32}$ in the matrix $Q_2 B_2$ is the same as in $B_2$. Let's check $B_2(3,2)$.\n$B_1$'s third row is $(0,0,4,0,0)$ (from $B_0$). $Z_1$ acts on cols 1 and 2. So $B_2(3,2) = B_1(3,1)s_2 + B_1(3,2)c_2 = (0)s_2 + (0)c_2 = 0$.\nThe bulge element is zero. Therefore, we use the identity rotation.\n$$ c_4 = 1, \\quad s_4 = 0 $$\n\n**Subsequent Rotations:**\nThe specific sparse structure of $A$ and the diagonal form of $B$ cause all subsequent bulge elements to be zero before the application of the corresponding rotation. This pattern continues.\n\n**Rotation $G_5(c_5, s_5)$ (Left, rows 3-4):** Annihilates the bulge at $A(4,2)$. This element is zero due to the structure of $A_0$ and the fact that rotations so far have not introduced non-zeros in this position.\n$$ c_5 = 1, \\quad s_5 = 0 $$\n\n**Rotation $G_6(c_6, s_6)$ (Right, cols 3-4):** Annihilates the bulge at $B(4,3)$. This element is zero due to the structure of $B_0$ and the rotations.\n$$ c_6 = 1, \\quad s_6 = 0 $$\n\n**Rotation $G_7(c_7, s_7)$ (Left, rows 4-5):** Annihilates the bulge at $A(5,3)$. This element is zero.\n$$ c_7 = 1, \\quad s_7 = 0 $$\n\n**Rotation $G_8(c_8, s_8)$ (Right, cols 4-5):** Annihilates the bulge at $B(5,4)$. This element is zero.\n$$ c_8 = 1, \\quad s_8 = 0 $$\n\n### Summary of Rotation Parameters\nThe sequence of parameters for the 8 Givens rotations is:\n- $G_1(c_1,s_1): c_1 = 4/5, s_1 = 3/5$\n- $G_2(c_2,s_2): c_2 = 2/\\sqrt{5}, s_2 = 1/\\sqrt{5}$\n- $G_3(c_3,s_3): c_3 = 1, s_3 = 0$\n- $G_4(c_4,s_4): c_4 = 1, s_4 = 0$\n- $G_5(c_5,s_5): c_5 = 1, s_5 = 0$\n- $G_6(c_6,s_6): c_6 = 1, s_6 = 0$\n- $G_7(c_7,s_7): c_7 = 1, s_7 = 0$\n- $G_8(c_8,s_8): c_8 = 1, s_8 = 0$\n\nThe final answer is presented as a single row matrix of these 16 scalars.", "answer": "$$ \\boxed{\\begin{pmatrix} \\frac{4}{5}  \\frac{3}{5}  \\frac{2}{\\sqrt{5}}  \\frac{1}{\\sqrt{5}}  1  0  1  0  1  0  1  0  1  0  1  0 \\end{pmatrix}} $$", "id": "3594787"}, {"introduction": "A hallmark of a robust numerical algorithm is its ability to handle edge cases and extreme values gracefully. The generalized eigenvalue problem can produce infinite eigenvalues or require calculations involving numbers that risk floating-point overflow or underflow. This exercise explores how the QZ algorithm's design confronts this challenge by representing eigenvalues as a pair of scalars, $(\\alpha_i, \\beta_i)$, thereby avoiding the perilous division $\\lambda_i = \\alpha_i / \\beta_i$ until it is absolutely necessary. [@problem_id:3594698]", "problem": "Consider the generalized eigenproblem $A x = \\lambda B x$ and its reduction by the $QZ$ algorithm (generalized Schur decomposition) to an upper triangular pair $(S,T)$ satisfying $Q^{\\top} A Z = S$ and $Q^{\\top} B Z = T$, where $Q$ and $Z$ are orthogonal and $S$ and $T$ are upper triangular. The generalized eigenvalues of the pencil $S - \\lambda T$ are defined by the roots of $\\det(S - \\lambda T) = 0$, with the convention that if a diagonal entry $t_{ii}$ of $T$ is zero while the corresponding $s_{ii} \\neq 0$, then the associated eigenvalue is infinite.\n\nLet\n$$\nS = \\begin{pmatrix}\n5  9 \\times 10^{150} \\\\\n0  3 \\times 10^{-200}\n\\end{pmatrix},\\quad\nT = \\begin{pmatrix}\n0  7 \\times 10^{150} \\\\\n0  2 \\times 10^{-200}\n\\end{pmatrix}.\n$$\nBoth $S$ and $T$ are upper triangular, and $t_{11} = 0$.\n\nUsing only core definitions and properties of the generalized Schur form, (i) determine the generalized eigenvalues of the pencil $S - \\lambda T$, identifying which one is infinite and which one is finite, and (ii) explain, from first principles, a scaling strategy that the $QZ$ algorithm conceptually employs to avoid numerical underflow or overflow when reporting eigenvalues as pairs $(\\alpha_i, \\beta_i)$ with $\\lambda_i = \\alpha_i / \\beta_i$. Then, compute the finite eigenvalue numerically from the given $S$ and $T$ and provide it as your final reported value. Round your final reported value to six significant figures.", "solution": "The problem requires finding the generalized eigenvalues of the pencil $S - \\lambda T$ for the given upper triangular matrices $S$ and $T$, explaining the numerical scaling strategy used in the $QZ$ algorithm, and computing the finite eigenvalue.\n\n### Part (i): Determination of Generalized Eigenvalues\n\nThe generalized eigenvalues $\\lambda$ of the pencil $S - \\lambda T$ are the values that satisfy the characteristic equation $\\det(S - \\lambda T) = 0$. The matrices are given as:\n$$\nS = \\begin{pmatrix}\n5  9 \\times 10^{150} \\\\\n0  3 \\times 10^{-200}\n\\end{pmatrix},\\quad\nT = \\begin{pmatrix}\n0  7 \\times 10^{150} \\\\\n0  2 \\times 10^{-200}\n\\endpmatrix}\n$$\nThe pencil $S - \\lambda T$ is:\n$$\nS - \\lambda T = \\begin{pmatrix}\n5 - \\lambda(0)  (9 \\times 10^{150}) - \\lambda(7 \\times 10^{150}) \\\\\n0 - \\lambda(0)  (3 \\times 10^{-200}) - \\lambda(2 \\times 10^{-200})\n\\end{pmatrix}\n$$\nSince $S - \\lambda T$ is an upper triangular matrix, its determinant is the product of its diagonal elements:\n$$\n\\det(S - \\lambda T) = (s_{11} - \\lambda t_{11})(s_{22} - \\lambda t_{22}) = 0\n$$\nThis equation implies that the generalized eigenvalues are given by the solutions to $s_{ii} - \\lambda t_{ii} = 0$ for $i=1, 2$.\n\nFor the first diagonal pair, with $i=1$:\nWe have $s_{11} = 5$ and $t_{11} = 0$. The equation is $5 - \\lambda \\cdot 0 = 0$, which simplifies to $5 = 0$. This is a contradiction, indicating a special case. As defined in the problem statement, \"if a diagonal entry $t_{ii}$ is zero while the corresponding $s_{ii} \\neq 0$, then the associated eigenvalue is infinite.\" Since $t_{11}=0$ and $s_{11}=5 \\neq 0$, the first generalized eigenvalue, $\\lambda_1$, is infinite.\n\nFor the second diagonal pair, with $i=2$:\nWe have $s_{22} = 3 \\times 10^{-200}$ and $t_{22} = 2 \\times 10^{-200}$. The equation is:\n$$\ns_{22} - \\lambda_2 t_{22} = 0\n$$\nGiven that $t_{22} = 2 \\times 10^{-200} \\neq 0$, we can solve for the finite eigenvalue $\\lambda_2$:\n$$\n\\lambda_2 = \\frac{s_{22}}{t_{22}} = \\frac{3 \\times 10^{-200}}{2 \\times 10^{-200}} = \\frac{3}{2} = 1.5\n$$\nThus, the finite eigenvalue is $\\lambda_2 = 1.5$.\n\n### Part (ii): Explanation of the Scaling Strategy\n\nDirectly computing generalized eigenvalues as the ratio $\\lambda_i = s_{ii} / t_{ii}$ is numerically unstable in floating-point arithmetic. The given matrices illustrate this perfectly.\n\n1.  **Risk of Overflow and Underflow:** The division $s_{ii} / t_{ii}$ can result in values outside the representable range of floating-point numbers. For example, if $s_{ii}$ is very large and $t_{ii}$ is very small, their ratio could cause an overflow. Conversely, a very small $s_{ii}$ and a very large $t_{ii}$ could lead to underflow, where the result is rounded to zero, causing a loss of information. In the given problem, the values $s_{22} = 3 \\times 10^{-200}$ and $t_{22} = 2 \\times 10^{-200}$ are so small that they would underflow to $0$ in standard double-precision arithmetic (which has a minimum positive normal value of approximately $2.2 \\times 10^{-308}$, but the range for single precision is much smaller). If both were treated as $0$, their ratio becomes the indeterminate form $0/0$, even though the true ratio is the well-behaved number $1.5$.\n\n2.  **First-Principles Strategy:** To avoid these numerical hazards, robust implementations of the $QZ$ algorithm (such as those in LAPACK) do not compute the ratio $\\lambda_i = s_{ii} / t_{ii}$ explicitly. Instead, they represent each generalized eigenvalue as a pair of numbers, $(\\alpha_i, \\beta_i)$, such that $\\lambda_i = \\alpha_i / \\beta_i$. The natural choice for these pairs, derived from the generalized Schur form $(S, T)$, is $(\\alpha_i, \\beta_i) = (s_{ii}, t_{ii})$.\n\nThis $(\\alpha_i, \\beta_i)$ representation is a core feature that ensures numerical stability from first principles:\n- It **avoids the division operation** that could cause overflow or underflow exceptions, deferring it to the user who can perform it with appropriate care if needed.\n- It provides a **natural and unified way to handle infinite and zero eigenvalues**.\n    - An infinite eigenvalue corresponds to a pair $(\\alpha_i, \\beta_i)$ where $\\beta_i = t_{ii} = 0$ and $\\alpha_i = s_{ii} \\neq 0$. For our problem, this is the pair $(5, 0)$.\n    - A zero eigenvalue corresponds to a pair where $\\alpha_i = s_{ii} = 0$ and $\\beta_i = t_{ii} \\neq 0$.\n- It **preserves information**. By storing the pair $(s_{ii}, t_{ii})$, the algorithm maintains the magnitudes of the original diagonal entries, preventing the loss of information that would occur if values underflowed to zero before division. For instance, the pair $(3 \\times 10^{-200}, 2 \\times 10^{-200})$ correctly encodes the eigenvalue $1.5$, whereas computing with the underflowed values $(0, 0)$ would fail.\n\nIn summary, by reporting eigenvalues as pairs $(\\alpha_i, \\beta_i) = (s_{ii}, t_{ii})$, the $QZ$ algorithm avoids the numerical pitfalls of direct division and provides a robust representation for all types of generalized eigenvalues (finite, infinite, and zero).\n\n### Final Computation\n\nThe problem asks for the numerical value of the finite eigenvalue, rounded to six significant figures. As calculated above, the finite eigenvalue is:\n$$\n\\lambda_2 = \\frac{s_{22}}{t_{22}} = 1.5\n$$\nExpressing $1.5$ with six significant figures gives $1.50000$.", "answer": "$$\\boxed{1.50000}$$", "id": "3594698"}]}