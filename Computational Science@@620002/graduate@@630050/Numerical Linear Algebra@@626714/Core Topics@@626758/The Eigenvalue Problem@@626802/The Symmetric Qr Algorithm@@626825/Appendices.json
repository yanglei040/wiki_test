{"hands_on_practices": [{"introduction": "The symmetric QR algorithm is a powerful iterative process, but at its heart lies a single, fundamental operation: the QR factorization. Before we can run the full algorithm, we must master the mechanics of decomposing a matrix $A$ into an orthogonal matrix $Q$ and an upper triangular matrix $R$. This exercise provides concrete practice in this essential skill, guiding you through the use of Givens rotations to systematically eliminate the subdiagonal entries of a symmetric tridiagonal matrix, laying the groundwork for the more complex steps to follow. [@problem_id:3597852]", "problem": "Let $A \\in \\mathbb{R}^{3 \\times 3}$ be the real symmetric tridiagonal matrix\n$$\nA \\;=\\;\n\\begin{pmatrix}\n5  2  0 \\\\\n2  4  3 \\\\\n0  3  1\n\\end{pmatrix}.\n$$\nThe orthogonal-triangular (QR) factorization of a real matrix $A$ is a representation $A = Q R$ with $Q$ orthogonal (i.e., $Q^{\\top} Q = I$) and $R$ upper triangular. For symmetric tridiagonal matrices, the symmetric QR algorithm applies a sequence of plane Givens rotations to annihilate subdiagonal entries, preserving orthogonality while maintaining upper triangular structure in the transformed matrix.\n\nStarting from the foundational definitions of orthogonality and Givens rotations, construct explicitly the sequence of two Givens rotations that, when left-multiplying $A$, annihilate its subdiagonal entries in columns $1$ and $2$. Denote these rotations by $G_{1}$ (acting on rows $1$ and $2$) and $G_{2}$ (acting on rows $2$ and $3$). Verify from first principles that the resulting matrix $R = G_{2} G_{1} A$ is upper triangular and that the orthogonal factor satisfies $Q = G_{1}^{\\top} G_{2}^{\\top}$. Provide all intermediate quantities symbolically (do not substitute decimal approximations), and use only exact algebraic operations justified by core definitions.\n\nYour final task is to report the exact closed-form value of the $(2,3)$ entry of the upper triangular factor $R$ obtained by this process. Express the final answer as a single analytic expression. No rounding is required.", "solution": "The problem is subjected to validation.\n\n### Step 1: Extract Givens\nThe givens are:\n- A real symmetric tridiagonal matrix $A \\in \\mathbb{R}^{3 \\times 3}$:\n$$\nA \\;=\\;\n\\begin{pmatrix}\n5  2  0 \\\\\n2  4  3 \\\\\n0  3  1\n\\end{pmatrix}\n$$\n- The QR factorization is defined as $A = Q R$, where $Q$ is an orthogonal matrix ($Q^{\\top} Q = I$) and $R$ is an upper triangular matrix.\n- The process involves a sequence of two Givens rotations, $G_{1}$ and $G_{2}$, applied via left-multiplication.\n- $G_{1}$ acts on rows $1$ and $2$ to annihilate the subdiagonal entry in column $1$.\n- $G_{2}$ acts on rows $2$ and $3$ to annihilate the subdiagonal entry in column $2$.\n- The resulting upper triangular matrix is $R = G_{2} G_{1} A$.\n- The orthogonal factor is $Q = G_{1}^{\\top} G_{2}^{\\top}$.\n- The task is to find the exact value of the $(2,3)$ entry of $R$.\n\n### Step 2: Validate Using Extracted Givens\n1.  **Scientifically Grounded:** The problem describes a standard procedure in numerical linear algebra, specifically the first step of QR decomposition using Givens rotations for a tridiagonal matrix. All concepts are well-established within mathematics.\n2.  **Well-Posed:** The problem is clearly stated. The matrix $A$ is given, the procedure is defined, and the final required value is specified. There is sufficient information to find a unique solution.\n3.  **Objective:** The problem uses precise mathematical language and is free of any subjective or ambiguous statements.\n4.  **Completeness and Consistency:** The givens are self-consistent. The definitions of Givens rotations, orthogonality, and the QR algorithm are standard. The problem does not contain contradictory constraints.\n\n### Step 3: Verdict and Action\nThe problem is deemed **valid**. A full solution will be provided.\n\n***\n\nThe objective is to compute the $(2,3)$ entry of the matrix $R$, where $R = G_{2} G_{1} A$. This process involves two steps of annihilation using Givens rotations.\n\nA general $2 \\times 2$ Givens rotation matrix has the form:\n$$\nG(\\theta) = \\begin{pmatrix} \\cos(\\theta)  -\\sin(\\theta) \\\\ \\sin(\\theta)  \\cos(\\theta) \\end{pmatrix} = \\begin{pmatrix} c  -s \\\\ s  c \\end{pmatrix}\n$$\nwhere $c^2 + s^2 = 1$. When applied to a vector $\\begin{pmatrix} x_1 \\\\ x_2 \\end{pmatrix}$, the result is $\\begin{pmatrix} cx_1 - sx_2 \\\\ sx_1 + cx_2 \\end{pmatrix}$. To annihilate the second component, we require $sx_1 + cx_2 = 0$. A standard choice that satisfies this and $c^2+s^2=1$ is $c = \\frac{x_1}{\\sqrt{x_1^2 + x_2^2}}$ and $s = \\frac{-x_2}{\\sqrt{x_1^2 + x_2^2}}$.\n\n**Step 1: Annihilate the $(2,1)$ entry of $A$**\n\nWe apply a Givens rotation $G_1$ to rows $1$ and $2$ of $A$ to annihilate the entry $A_{21}=2$. The relevant entries are from the first column: $x_1 = A_{11} = 5$ and $x_2 = A_{21} = 2$.\n\nThe parameters $c_1$ and $s_1$ for the rotation are calculated as follows:\n$$\nr_1 = \\sqrt{x_1^2 + x_2^2} = \\sqrt{5^2 + 2^2} = \\sqrt{25 + 4} = \\sqrt{29}\n$$\n$$\nc_1 = \\frac{x_1}{r_1} = \\frac{5}{\\sqrt{29}}, \\quad s_1 = \\frac{-x_2}{r_1} = \\frac{-2}{\\sqrt{29}}\n$$\nThe Givens rotation matrix $G_1$ acts on the plane of the first and second coordinates and is the identity elsewhere.\n$$\nG_1 = \\begin{pmatrix} c_1  -s_1  0 \\\\ s_1  c_1  0 \\\\ 0  0  1 \\end{pmatrix} = \\begin{pmatrix} \\frac{5}{\\sqrt{29}}  \\frac{2}{\\sqrt{29}}  0 \\\\ \\frac{-2}{\\sqrt{29}}  \\frac{5}{\\sqrt{29}}  0 \\\\ 0  0  1 \\end{pmatrix}\n$$\nWe now compute the intermediate matrix $A' = G_1 A$:\n$$\nA' = \\begin{pmatrix} \\frac{5}{\\sqrt{29}}  \\frac{2}{\\sqrt{29}}  0 \\\\ \\frac{-2}{\\sqrt{29}}  \\frac{5}{\\sqrt{29}}  0 \\\\ 0  0  1 \\end{pmatrix} \\begin{pmatrix} 5  2  0 \\\\ 2  4  3 \\\\ 0  3  1 \\end{pmatrix}\n$$\nThe rows of $A'$ are:\n- Row $1$: $(\\frac{5}{\\sqrt{29}})\\begin{pmatrix} 5  2  0 \\end{pmatrix} + (\\frac{2}{\\sqrt{29}})\\begin{pmatrix} 2  4  3 \\end{pmatrix} = \\frac{1}{\\sqrt{29}}\\begin{pmatrix} 25+4  10+8  0+6 \\end{pmatrix} = \\begin{pmatrix} \\frac{29}{\\sqrt{29}}  \\frac{18}{\\sqrt{29}}  \\frac{6}{\\sqrt{29}} \\end{pmatrix} = \\begin{pmatrix} \\sqrt{29}  \\frac{18}{\\sqrt{29}}  \\frac{6}{\\sqrt{29}} \\end{pmatrix}$\n- Row $2$: $(\\frac{-2}{\\sqrt{29}})\\begin{pmatrix} 5  2  0 \\end{pmatrix} + (\\frac{5}{\\sqrt{29}})\\begin{pmatrix} 2  4  3 \\end{pmatrix} = \\frac{1}{\\sqrt{29}}\\begin{pmatrix} -10+10  -4+20  0+15 \\end{pmatrix} = \\begin{pmatrix} 0  \\frac{16}{\\sqrt{29}}  \\frac{15}{\\sqrt{29}} \\end{pmatrix}$\n- Row $3$: This row is unchanged: $\\begin{pmatrix} 0  3  1 \\end{pmatrix}$.\n\nSo, the intermediate matrix is:\n$$\nA' = \\begin{pmatrix} \\sqrt{29}  \\frac{18}{\\sqrt{29}}  \\frac{6}{\\sqrt{29}} \\\\ 0  \\frac{16}{\\sqrt{29}}  \\frac{15}{\\sqrt{29}} \\\\ 0  3  1 \\end{pmatrix}\n$$\nAs required, the $(2,1)$ entry has been annihilated.\n\n**Step 2: Annihilate the $(3,2)$ entry of $A'$**\n\nNext, we apply a Givens rotation $G_2$ to rows $2$ and $3$ of $A'$ to annihilate the entry $A'_{32}=3$. The relevant entries are from the second column of $A'$: $x_1' = A'_{22} = \\frac{16}{\\sqrt{29}}$ and $x_2' = A'_{32} = 3$.\n\nThe parameters $c_2$ and $s_2$ for this rotation are:\n$$\nr_2 = \\sqrt{(x_1')^2 + (x_2')^2} = \\sqrt{\\left(\\frac{16}{\\sqrt{29}}\\right)^2 + 3^2} = \\sqrt{\\frac{256}{29} + 9} = \\sqrt{\\frac{256 + 9 \\cdot 29}{29}} = \\sqrt{\\frac{256 + 261}{29}} = \\sqrt{\\frac{517}{29}}\n$$\n$$\nc_2 = \\frac{x_1'}{r_2} = \\frac{16/\\sqrt{29}}{\\sqrt{517/29}} = \\frac{16}{\\sqrt{517}}, \\quad s_2 = \\frac{-x_2'}{r_2} = \\frac{-3}{\\sqrt{517/29}} = \\frac{-3\\sqrt{29}}{\\sqrt{517}}\n$$\nThe Givens rotation matrix $G_2$ acts on the plane of the second and third coordinates:\n$$\nG_2 = \\begin{pmatrix} 1  0  0 \\\\ 0  c_2  -s_2 \\\\ 0  s_2  c_2 \\end{pmatrix} = \\begin{pmatrix} 1  0  0 \\\\ 0  \\frac{16}{\\sqrt{517}}  \\frac{3\\sqrt{29}}{\\sqrt{517}} \\\\ 0  \\frac{-3\\sqrt{29}}{\\sqrt{517}}  \\frac{16}{\\sqrt{517}} \\end{pmatrix}\n$$\n\n**Step 3: Compute the $(2,3)$ entry of $R = G_2 A'$**\n\nThe final upper triangular matrix is $R = G_2 A'$. We are asked for the entry $R_{23}$. This entry is the dot product of the second row of $G_2$ and the third column of $A'$.\n$$\nR_{23} = (G_2)_{21}A'_{13} + (G_2)_{22}A'_{23} + (G_2)_{23}A'_{33}\n$$\nSubstituting the values:\n$$\nR_{23} = (0)A'_{13} + (c_2)A'_{23} + (-s_2)A'_{33} = c_2 A'_{23} - s_2 A'_{33}\n$$\nWe have $A'_{23} = \\frac{15}{\\sqrt{29}}$ and $A'_{33} = 1$. Substituting the values of $c_2$ and $s_2$:\n$$\nR_{23} = \\left(\\frac{16}{\\sqrt{517}}\\right) \\left(\\frac{15}{\\sqrt{29}}\\right) - \\left(\\frac{-3\\sqrt{29}}{\\sqrt{517}}\\right) (1)\n$$\n$$\nR_{23} = \\frac{16 \\cdot 15}{\\sqrt{517}\\sqrt{29}} + \\frac{3\\sqrt{29}}{\\sqrt{517}}\n$$\nTo combine these terms, we find a common denominator, which is $\\sqrt{517}\\sqrt{29} = \\sqrt{517 \\cdot 29} = \\sqrt{14993}$.\n$$\nR_{23} = \\frac{240}{\\sqrt{14993}} + \\frac{3\\sqrt{29} \\cdot \\sqrt{29}}{\\sqrt{517}\\sqrt{29}} = \\frac{240}{\\sqrt{14993}} + \\frac{3 \\cdot 29}{\\sqrt{14993}}\n$$\n$$\nR_{23} = \\frac{240 + 87}{\\sqrt{14993}} = \\frac{327}{\\sqrt{14993}}\n$$\n\n**Verification of Properties**\n\nAs requested, we briefly verify the properties of the decomposition.\n1.  **Orthogonality of $Q$**: The orthogonal factor is $Q=G_1^\\top G_2^\\top$. Since Givens rotations are orthogonal matrices ($G_1^\\top G_1 = I$, $G_2^\\top G_2 = I$), their transposes are also orthogonal. The product of orthogonal matrices is orthogonal. We can verify this directly:\n    $$\n    Q^\\top Q = (G_1^\\top G_2^\\top)^\\top (G_1^\\top G_2^\\top) = (G_2 G_1) (G_1^\\top G_2^\\top) = G_2 (G_1 G_1^\\top) G_2^\\top = G_2 I G_2^\\top = G_2 G_2^\\top = I\n    $$\n2.  **Upper-triangular structure of $R$**: The matrix $R=G_2 G_1 A = G_2 A'$.\n    - $A'_{21}$ and $A'_{31}$ are zero. Applying $G_2$ does not alter these, as $G_2$ only mixes rows $2$ and $3$. Thus $R_{21}=0$ and $R_{31}=0$.\n    - The entry $R_{32}$ is computed from the third row of $G_2$ and the second column of $A'$.\n      $$\n      R_{32} = s_2 A'_{22} + c_2 A'_{32} = (\\frac{-3\\sqrt{29}}{\\sqrt{517}})(\\frac{16}{\\sqrt{29}}) + (\\frac{16}{\\sqrt{517}})(3) = \\frac{-48}{\\sqrt{517}} + \\frac{48}{\\sqrt{517}} = 0\n      $$\n    This confirms that $R$ is indeed an upper triangular matrix.\n\nThe final derived value for $R_{23}$ is analytically exact and based on first principles.", "answer": "$$\\boxed{\\frac{327}{\\sqrt{14993}}}$$", "id": "3597852"}, {"introduction": "While explicit QR factorization is the conceptual basis, modern implementations of the symmetric QR algorithm use a more elegant and efficient technique known as the implicit shifted QR step. Instead of forming the shifted matrix $T - \\mu I$ and then factoring it, the algorithm performs a series of carefully chosen similarity transformations that have the same effect without the computational overhead. This exercise peels back the curtain on this process, allowing you to perform the first few \"bulge-chasing\" rotations that are central to the algorithm's practical success. [@problem_id:3597848]", "problem": "Consider the symmetric tridiagonal matrix $T \\in \\mathbb{R}^{5 \\times 5}$ with diagonal entries $a_1=6$, $a_2=5$, $a_3=4$, $a_4=5$, $a_5=6$ and off-diagonal entries $b_1=1$, $b_2=2$, $b_3=2$, $b_4=1$, that is,\n$$\nT \\;=\\;\n\\begin{pmatrix}\n6  1  0  0  0 \\\\\n1  5  2  0  0 \\\\\n0  2  4  2  0 \\\\\n0  0  2  5  1 \\\\\n0  0  0  1  6\n\\end{pmatrix}.\n$$\nPerform the first two bulge-chasing Givens rotations of one implicit shifted orthogonal-triangular (QR) step with the shift $\\mu=5$ as follows:\n\n1. Construct a Givens rotation $G_1$ acting on indices $(1,2)$ so that $G_1^{\\top} (T - \\mu I) e_1$ is a scalar multiple of $e_1$, and update $T^{(1)} = G_1^{\\top} T G_1$.\n\n2. Then construct a Givens rotation $G_2$ acting on indices $(2,3)$ so that premultiplication by $G_2^{\\top}$ annihilates the $(3,1)$ entry of $T^{(1)}$, and update $T^{(2)} = G_2^{\\top} T^{(1)} G_2$.\n\nStarting only from the definitions of orthogonal similarity, Givens rotations, and the implicit shift construction, carry out these two rotations explicitly and compute the updated tridiagonal entries that are affected in the leading $3 \\times 3$ block. Report the single real value of the updated off-diagonal entry between rows $2$ and $3$ after these two rotations, namely $b_2^{(2)} = T^{(2)}_{2,3}$. Give your answer in exact, closed form. Do not round.", "solution": "The user wants me to critically validate the provided problem statement and, if valid, provide a complete, reasoned solution.\n\n### Step 1: Extract Givens\n\nThe problem provides the following information:\n- A symmetric tridiagonal matrix $T \\in \\mathbb{R}^{5 \\times 5}$:\n$$\nT \\;=\\;\n\\begin{pmatrix}\n6  1  0  0  0 \\\\\n1  5  2  0  0 \\\\\n0  2  4  2  0 \\\\\n0  0  2  5  1 \\\\\n0  0  0  1  6\n\\end{pmatrix}\n$$\nThe diagonal entries are $a_1=6$, $a_2=5$, $a_3=4$, $a_4=5$, $a_5=6$. The off-diagonal entries are $b_1=1$, $b_2=2$, $b_3=2$, $b_4=1$. Note that $T_{i,i} = a_i$ and $T_{i,i+1} = T_{i+1,i} = b_i$.\n- A shift value $\\mu = 5$.\n- A two-step procedure is prescribed:\n    1. Construct a Givens rotation $G_1$ acting on indices $(1,2)$ such that $G_1^{\\top} (T - \\mu I) e_1$ is a scalar multiple of $e_1$. Then compute the updated matrix $T^{(1)} = G_1^{\\top} T G_1$.\n    2. Construct a Givens rotation $G_2$ acting on indices $(2,3)$ such that premultiplication by $G_2^{\\top}$ annihilates the $(3,1)$ entry of $T^{(1)}$. Then compute the updated matrix $T^{(2)} = G_2^{\\top} T^{(1)} G_2$.\n- The final objective is to compute the value of the updated off-diagonal entry between rows $2$ and $3$ after these two rotations, which is denoted as $b_2^{(2)} = T^{(2)}_{2,3}$.\n\n### Step 2: Validate Using Extracted Givens\n\n- **Scientifically Grounded:** The problem describes the first two steps of a bulge-chasing procedure in an implicit QR algorithm for a symmetric matrix. This is a fundamental and standard technique in numerical linear algebra for computing eigenvalues. The problem is scientifically sound.\n- **Well-Posed:** All necessary data ($T$, $\\mu$) and the required steps are explicitly and unambiguously defined. The task leads to a unique, computable value.\n- **Objective:** The problem is stated in precise mathematical language, free from any subjectivity or bias.\n\nThe problem does not violate any of the invalidity criteria. It is a well-defined exercise in numerical linear algebra.\n\n### Step 3: Verdict and Action\n\nThe problem statement is **valid**. We proceed to the solution.\n\n### Solution\n\nThe process consists of two stages of similarity transformations using Givens rotations.\n\n**Stage 1: First Givens rotation to create the bulge**\n\nThe first step of an implicit QR iteration with shift $\\mu$ is to apply a rotation $G_1$ that would introduce a zero in the first column of the shifted matrix $T - \\mu I$ if we were to compute it explicitly. The first column of $T - \\mu I$ is given by:\n$$\nx = (T - \\mu I)e_1 = (T - 5I)e_1 =\n\\begin{pmatrix}\n6-5 \\\\ 1 \\\\ 0 \\\\ 0 \\\\ 0\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n1 \\\\ 1 \\\\ 0 \\\\ 0 \\\\ 0\n\\end{pmatrix}\n$$\nWe need to find a Givens rotation $G_1$ acting on the $(1,2)$ plane that zeros out the second component of this vector $x$. A Givens rotation matrix $G(i,j,c,s)$ is typically defined such that its transpose $G(i,j,c,s)^{\\top}$ rotates the vector. Let the rotation be defined by $c = \\cos(\\theta)$ and $s = \\sin(\\theta)$. The matrix $G_1^{\\top}$ acting on the $(1,2)$ plane has the form:\n$$\nG_1^{\\top} =\n\\begin{pmatrix}\nc  s  0  0  0 \\\\\n-s  c  0  0  0 \\\\\n0  0  1  0  0 \\\\\n0  0  0  1  0 \\\\\n0  0  0  0  1\n\\end{pmatrix}\n$$\nTo zero out the second component of $x=(1,1,0,0,0)^{\\top}$, we set $c = \\frac{x_1}{r}$ and $s = \\frac{x_2}{r}$, where $r = \\sqrt{x_1^2 + x_2^2}$.\nWith $x_1=1$ and $x_2=1$:\n$$\nr = \\sqrt{1^2 + 1^2} = \\sqrt{2}\n$$\n$$\nc = \\frac{1}{\\sqrt{2}}, \\quad s = \\frac{1}{\\sqrt{2}}\n$$\nThe implicit QR method applies this rotation to the matrix $T$ itself via a similarity transformation: $T^{(1)} = G_1^{\\top} T G_1$. This transformation only affects rows and columns $1$ and $2$.\n$G_1 = (G_1^{\\top})^{\\top} = \\begin{pmatrix}\nc  -s  0  \\dots \\\\\ns  c  0  \\dots \\\\\n0  0  1  \\dots \\\\\n\\vdots    \\ddots\n\\end{pmatrix}$.\nThe transformation is $T^{(1)} = G_1^{\\top} T G_1$. This creates a non-zero entry at position $(1,3)$ and $(3,1)$, which is the \"bulge\". Let's compute the entries of $T^{(1)}$ that are relevant for the next step.\nThe change is confined to a sub-problem. Let's consider the top-left $3 \\times 3$ block of $T$:\n$$\nT_{1:3,1:3} = \\begin{pmatrix} 6  1  0 \\\\ 1  5  2 \\\\ 0  2  4 \\end{pmatrix}\n$$\nThe transformation on this block is:\n$$\nT^{(1)}_{1:3,1:3} = \\begin{pmatrix} c  s  0 \\\\ -s  c  0 \\\\ 0  0  1 \\end{pmatrix} \\begin{pmatrix} 6  1  0 \\\\ 1  5  2 \\\\ 0  2  4 \\end{pmatrix} \\begin{pmatrix} c  -s  0 \\\\ s  c  0 \\\\ 0  0  1 \\end{pmatrix}\n$$\nLet's compute the elements of $T^{(1)}$.\n$T^{(1)}_{22}$: This is part of a $2 \\times 2$ similarity transformation on the leading principal submatrix of $T$. Using the formula for a symmetric similarity update: $A'_{22} = s^2 A_{11} - 2cs A_{12} + c^2 A_{22}$.\n$T^{(1)}_{22} = s^2 T_{11} - 2cs T_{12} + c^2 T_{22} = (\\frac{1}{\\sqrt{2}})^2(6) - 2(\\frac{1}{\\sqrt{2}})(\\frac{1}{\\sqrt{2}})(1) + (\\frac{1}{\\sqrt{2}})^2(5) = \\frac{1}{2}(6) - 1 + \\frac{1}{2}(5) = 3 - 1 + 2.5 = 4.5 = \\frac{9}{2}$.\n$T^{(1)}_{33}$: The rotation does not involve row/column $3$, so the diagonal element $T_{33}$ is unchanged by this first rotation. $T^{(1)}_{33} = T_{33} = 4$.\n$T^{(1)}_{23}$: This term couples the rotated block with the rest of the matrix. $T^{(1)}_{23} = (G_1^\\top T G_1)_{23} = \\sum_{k,l} (G_1^\\top)_{2k} T_{kl} (G_1)_{l3}$. Since $(G_1)_{l3}=\\delta_{l3}$ for $l=1,2,3$:\n$T^{(1)}_{23} = \\sum_{k} (G_1^\\top)_{2k} T_{k3} = -s \\cdot T_{13} + c \\cdot T_{23} = -(\\frac{1}{\\sqrt{2}})(0) + (\\frac{1}{\\sqrt{2}})(2) = \\frac{2}{\\sqrt{2}} = \\sqrt{2}$.\n\nThis first rotation also creates a bulge at $T^{(1)}_{13} = T^{(1)}_{31}$:\n$T^{(1)}_{31} = (G_1^\\top T G_1)_{31} = \\sum_{k,l} (G_1^\\top)_{3k} T_{kl} (G_1)_{l1} = T_{32}(G_1)_{21} = (2)(s) = \\frac{2}{\\sqrt{2}} = \\sqrt{2}$.\n\nSo, after the first step, we have for the relevant entries of $T^{(1)}$:\n$T^{(1)}_{22} = \\frac{9}{2}$, $T^{(1)}_{33} = 4$, $T^{(1)}_{23} = \\sqrt{2}$, and the bulge $T^{(1)}_{31} = \\sqrt{2}$.\n\n**Stage 2: Second Givens rotation to chase the bulge**\n\nThe next step is to \"chase\" the bulge down the diagonal. We apply a second Givens rotation, $G_2$, acting on the $(2,3)$ plane to eliminate the new non-zero entry $T^{(1)}_{31} = \\sqrt{2}$. This is done by left-multiplication with $G_2^\\top$, which rotates rows $2$ and $3$ of $T^{(1)}$. To zero out the $(3,1)$ element, we must zero out the 3rd component of the 1st column of $T^{(1)}$, using its 2nd component.\nThe first column of $T^{(1)}$ is:\n$$\nT^{(1)}e_1 = \\begin{pmatrix} T^{(1)}_{11} \\\\ T^{(1)}_{21} \\\\ T^{(1)}_{31} \\\\ \\vdots \\end{pmatrix} = \\begin{pmatrix} c T_{11} + s T_{21} \\\\ -s T_{11} + c T_{21} \\\\ s T_{32} \\\\ \\vdots \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{\\sqrt{2}}(6) + \\frac{1}{\\sqrt{2}}(1) \\\\ -\\frac{1}{\\sqrt{2}}(6) + \\frac{1}{\\sqrt{2}}(1) \\\\ \\frac{1}{\\sqrt{2}}(2) \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 7/\\sqrt{2} \\\\ -5/\\sqrt{2} \\\\ \\sqrt{2} \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\nWe need to rotate the vector $\\begin{pmatrix} -5/\\sqrt{2} \\\\ \\sqrt{2} \\end{pmatrix}$ to zero out the second component. Let the new rotation parameters be $c'$ and $s'$.\n$x'_2 = -5/\\sqrt{2}$ and $x'_3 = \\sqrt{2}$.\n$r' = \\sqrt{(x'_2)^2 + (x'_3)^2} = \\sqrt{(-\\frac{5}{\\sqrt{2}})^2 + (\\sqrt{2})^2} = \\sqrt{\\frac{25}{2} + 2} = \\sqrt{\\frac{29}{2}}$.\nThe solution text has a flawed derivation for the first column of $T^{(1)}$, let's compute it properly:\n$T^{(1)}_{1:3, 1:3} = \\begin{pmatrix} 13/2  -1/2  \\sqrt{2} \\\\ -1/2  9/2  \\sqrt{2} \\\\ \\sqrt{2}  \\sqrt{2}  4 \\end{pmatrix}$. The first column is $(13/2, -1/2, \\sqrt{2})^T$.\nThe rotation $G_2$ will act on plane $(2,3)$ to zero out $T^{(1)}_{31}=\\sqrt{2}$ using $T^{(1)}_{21}=-1/2$. The relevant components are $x'_2 = -1/2$ and $x'_3 = \\sqrt{2}$.\n$r' = \\sqrt{(x'_2)^2 + (x'_3)^2} = \\sqrt{(-\\frac{1}{2})^2 + (\\sqrt{2})^2} = \\sqrt{\\frac{1}{4} + 2} = \\sqrt{\\frac{9}{4}} = \\frac{3}{2}$.\nThe new rotation parameters are:\n$c' = \\frac{x'_2}{r'} = \\frac{-1/2}{3/2} = -\\frac{1}{3}$.\n$s' = \\frac{x'_3}{r'} = \\frac{\\sqrt{2}}{3/2} = \\frac{2\\sqrt{2}}{3}$.\n\nNow we compute $T^{(2)} = G_2^{\\top} T^{(1)} G_2$. We are interested in the entry $T^{(2)}_{2,3}$. The rotation $G_2$ acts on rows/columns $2$ and $3$. We can find the element $T^{(2)}_{2,3}$ by considering the similarity transformation on the submatrix $T^{(1)}_{2:3, 2:3}$.\nLet $A = T^{(1)}_{2:3, 2:3} = \\begin{pmatrix} T^{(1)}_{22}  T^{(1)}_{23} \\\\ T^{(1)}_{32}  T^{(1)}_{33} \\end{pmatrix} = \\begin{pmatrix} 9/2  \\sqrt{2} \\\\ \\sqrt{2}  4 \\end{pmatrix}$.\nThe updated submatrix is $A' = G'^{\\top} A G'$, where $G' = \\begin{pmatrix} c'  -s' \\\\ s'  c' \\end{pmatrix}$.\nThe $(1,2)$ entry of $A'$ corresponds to $T^{(2)}_{2,3}$.\n$A'_{12} = (c'^2 - s'^2)A_{12} + c's'(A_{22} - A_{11})$.\nWe have the values:\n$c' = -1/3 \\implies c'^2 = 1/9$.\n$s' = 2\\sqrt{2}/3 \\implies s'^2 = 8/9$.\n$A_{11} = T^{(1)}_{22} = 9/2$.\n$A_{12} = T^{(1)}_{23} = \\sqrt{2}$.\n$A_{22} = T^{(1)}_{33} = 4$.\n\nSubstituting these into the formula for $A'_{12}$:\n$T^{(2)}_{2,3} = \\left(\\frac{1}{9} - \\frac{8}{9}\\right)(\\sqrt{2}) + \\left(-\\frac{1}{3}\\right)\\left(\\frac{2\\sqrt{2}}{3}\\right)\\left(4 - \\frac{9}{2}\\right)$.\n$T^{(2)}_{2,3} = \\left(-\\frac{7}{9}\\right)(\\sqrt{2}) + \\left(-\\frac{2\\sqrt{2}}{9}\\right)\\left(\\frac{8}{2} - \\frac{9}{2}\\right)$.\n$T^{(2)}_{2,3} = -\\frac{7\\sqrt{2}}{9} + \\left(-\\frac{2\\sqrt{2}}{9}\\right)\\left(-\\frac{1}{2}\\right)$.\n$T^{(2)}_{2,3} = -\\frac{7\\sqrt{2}}{9} + \\frac{2\\sqrt{2}}{18}$.\n$T^{(2)}_{2,3} = -\\frac{7\\sqrt{2}}{9} + \\frac{\\sqrt{2}}{9}$.\n$T^{(2)}_{2,3} = -\\frac{6\\sqrt{2}}{9} = -\\frac{2\\sqrt{2}}{3}$.\n\nThe value of the updated off-diagonal entry $b_2^{(2)}$ is $T^{(2)}_{2,3}$.", "answer": "$$\n\\boxed{-\\frac{2\\sqrt{2}}{3}}\n$$", "id": "3597848"}, {"introduction": "An iterative algorithm is only as useful as its stopping condition. In the finite-precision world of computers, how do we know when an off-diagonal element is \"small enough\" to be treated as zero, allowing us to declare an eigenvalue found? This process, called deflation, is critical for the algorithm's efficiency. This practice problem moves from pure mechanics to practical implementation, asking you to apply a standard, backward-error-justified deflation test to determine if a matrix can be split into smaller, independent problems. [@problem_id:3597821]", "problem": "Consider the symmetric tridiagonal matrix $T \\in \\mathbb{R}^{5 \\times 5}$,\n$$\nT \\;=\\;\n\\begin{pmatrix}\n4  0.8  0  0  0 \\\\\n0.8  6  0.3  0  0 \\\\\n0  0.3  5  0.4  0 \\\\\n0  0  0.4  7  1.0 \\times 10^{-16} \\\\\n0  0  0  1.0 \\times 10^{-16}  9\n\\end{pmatrix}.\n$$\nA single step of the orthogonal-triangular (QR) algorithm with a Wilkinson shift applied to a symmetric tridiagonal matrix performs an orthogonal similarity transformation that preserves symmetry and tridiagonal structure. In floating-point arithmetic following the standard rounding model $\\operatorname{fl}(x \\,\\circ\\, y) = (x \\,\\circ\\, y)(1 + \\delta)$ with $|\\delta| \\leq u$ (where $u$ is the unit roundoff), the computed step is backward stable in the sense that it is exact for a slightly perturbed matrix. Assume the machine model is Institute of Electrical and Electronics Engineers (IEEE) double precision with unit roundoff $u = 2^{-53}$.\n\nStarting from the backward error viewpoint for orthogonal similarity transformations on symmetric tridiagonals and the invariance of eigenvalues under orthogonal similarity, derive a practically justified deflation test for a subdiagonal entry $b_{k}$ at index $k$ that ensures any enforced zero $b_{k} \\leftarrow 0$ is within the backward error of a computed QR step. Apply your derived test to the trailing subdiagonal entry of $T$ and decide whether deflation should be performed at that index. If deflation is performed, write down the resulting block diagonal structure that will be used in subsequent iterations. Your final reported quantity must be the deflation index $k$ where the split occurs. If no deflation is warranted, report $k = 0$.\n\nProvide your final answer as a single integer. No rounding is required. No physical units are involved.", "solution": "The problem requires the derivation of a practically justified deflation test for the symmetric QR algorithm and its application to a specific symmetric tridiagonal matrix $T$.\n\nFirst, we validate the problem statement.\nThe givens are:\nThe matrix $T \\in \\mathbb{R}^{5 \\times 5}$:\n$$\nT \\;=\\;\n\\begin{pmatrix}\n4  0.8  0  0  0 \\\\\n0.8  6  0.3  0  0 \\\\\n0  0.3  5  0.4  0 \\\\\n0  0  0.4  7  1.0 \\times 10^{-16} \\\\\n0  0  0  1.0 \\times 10^{-16}  9\n\\end{pmatrix}\n$$\nThe floating-point arithmetic model is $\\operatorname{fl}(x \\,\\circ\\, y) = (x \\,\\circ\\, y)(1 + \\delta)$ with $|\\delta| \\leq u$.\nThe unit roundoff is $u = 2^{-53}$ for IEEE double precision.\nThe context is a single step of the symmetric QR algorithm with a Wilkinson shift. The computed step is backward stable.\n\nThe problem is scientifically grounded in the well-established field of numerical linear algebra, specifically the error analysis of eigenvalue algorithms. It is well-posed, objective, and contains sufficient information for a unique solution. Therefore, the problem is valid.\n\nWe proceed to derive the deflation test. Let $T$ be a symmetric tridiagonal matrix of size $n \\times n$ with diagonal entries $a_1, \\dots, a_n$ and subdiagonal entries $b_1, \\dots, b_{n-1}$.\n$$\nT \\;=\\;\n\\begin{pmatrix}\na_1  b_1     \\\\\nb_1  a_2  b_2    \\\\\n \\ddots  \\ddots  \\ddots   \\\\\n  b_{n-2}  a_{n-1}  b_{n-1} \\\\\n   b_{n-1}  a_n\n\\end{pmatrix}\n$$\nThe core principle of the QR algorithm is to generate a sequence of orthogonally similar matrices $T_s$ that converges to a diagonal matrix of eigenvalues. Due to floating-point arithmetic, the computed iterate $\\hat{T}_{s+1}$ is not exactly orthogonally similar to the previous iterate $T_s$. However, backward error analysis, pioneered by J.H. Wilkinson, shows that $\\hat{T}_{s+1}$ is exactly orthogonally similar to a perturbed matrix $T_s + E_s$, where $E_s$ is a symmetric perturbation matrix. The elements of $E_s$ are small, on the order of $u \\|T_s\\|$, where $u$ is the unit roundoff.\n\nDeflation is the process of setting a sufficiently small subdiagonal entry $b_k$ to zero. This decouples the matrix into two smaller, independent tridiagonal blocks, $T(1:k, 1:k)$ and $T(k+1:n, k+1:n)$. The overall eigenvalue problem is then reduced to two smaller subproblems. This strategy is essential for the efficiency and convergence of the algorithm.\n\nThe justification for setting $b_k=0$ comes from the backward error perspective. Setting $b_k$ to zero introduces a perturbation $\\Delta T_k$ to the matrix $T$, where the only non-zero entries are $(\\Delta T_k)_{k, k+1} = (\\Delta T_k)_{k+1, k} = -b_k$. The eigenvalues of the modified matrix $T - \\Delta T_k$ are the union of the eigenvalues of the two resulting blocks. By the Bauer-Fike theorem for symmetric matrices, the perturbation in the eigenvalues is bounded by the spectral norm of the change, $\\|\\Delta T_k\\|_2 = |b_k|$.\n\nThe crucial step is to determine when this perturbation $|b_k|$ is \"acceptably small\". A perturbation is acceptable if it is on the same order of magnitude as the inherent uncertainty in the matrix entries due to round-off errors accumulated from previous computations. The computed diagonal entries $a_k$ and $a_{k+1}$ are not exact; they carry an uncertainty of roughly $u|a_k|$ and $u|a_{k+1}|$, respectively.\n\nA practical and widely used deflation criterion is to declare $b_k$ negligible if its magnitude is on the order of the machine precision relative to the magnitudes of its adjacent diagonal entries. This ensures that the effect of zeroing out $b_k$ is lost in the \"noise\" of the floating-point representation of $a_k$ and $a_{k+1}$. The specific test is:\n$$|b_k| \\le u (|a_k| + |a_{k+1}|)$$\nIf this condition holds, we can set $b_k \\leftarrow 0$ without introducing a significant error beyond the backward error inherent in one step of the QR algorithm. This is the practically justified deflation test we will use.\n\nNow, we apply this test to the given matrix $T$. The matrix entries are:\nDiagonal entries: $a_1=4$, $a_2=6$, $a_3=5$, $a_4=7$, $a_5=9$.\nSubdiagonal entries: $b_1=0.8$, $b_2=0.3$, $b_3=0.4$, $b_4=1.0 \\times 10^{-16}$.\n\nThe problem asks to test the trailing subdiagonal entry, which is $b_4$. Thus, we set $k=4$. The relevant entries are:\n$b_4 = 1.0 \\times 10^{-16}$\n$a_4 = 7$\n$a_5 = 9$\nThe unit roundoff is given as $u = 2^{-53}$.\n\nWe substitute these values into the deflation inequality:\n$$|b_4| \\le u (|a_4| + |a_5|)$$\n$$1.0 \\times 10^{-16} \\le 2^{-53} (|7| + |9|)$$\n$$1.0 \\times 10^{-16} \\le 2^{-53} (16)$$\n$$1.0 \\times 10^{-16} \\le 2^{-53} \\cdot 2^4$$\n$$1.0 \\times 10^{-16} \\le 2^{-49}$$\nTo verify this inequality without a calculator, we can compare the logarithms of both sides. For instance, using base 10:\n$\\log_{10}(1.0 \\times 10^{-16}) = -16$.\n$\\log_{10}(2^{-49}) = -49 \\log_{10}(2)$.\nUsing the approximation $\\log_{10}(2) \\approx 0.30103$:\n$-49 \\times 0.30103 = -14.75047$.\nThe inequality becomes $-16 \\le -14.75047$, which is true.\nTherefore, the deflation condition is satisfied for $b_4$.\n\nSince the condition $|b_4| \\le u(|a_4| + |a_5|)$ holds, deflation should be performed by setting $b_4$ to $0$. This means the matrix $T$ is split between the $4$-th and $5$-th rows and columns. The index at which the split occurs is $k=4$.\nThe resulting matrix has a block diagonal structure:\n$$\nT' \\;=\\;\n\\begin{pmatrix}\n4  0.8  0  0  0 \\\\\n0.8  6  0.3  0  0 \\\\\n0  0.3  5  0.4  0 \\\\\n0  0  0.4  7  0 \\\\\n0  0  0  0  9\n\\end{pmatrix}\n$$\nThe problem is now split into finding the eigenvalues of the leading $4 \\times 4$ submatrix and the trailing $1 \\times 1$ submatrix. The latter immediately yields an eigenvalue of $\\lambda=9$. The algorithm would then proceed on the $4 \\times 4$ subproblem.\n\nThe deflation index $k$ where the split occurs is the index of the subdiagonal entry that is set to zero. In this case, that is $k=4$.", "answer": "$$\\boxed{4}$$", "id": "3597821"}]}