{"hands_on_practices": [{"introduction": "The Jordan canonical form provides a complete description of a matrix's linear transformation properties, but how can we determine this structure from the matrix itself? This exercise grounds the abstract theory by connecting the number and sizes of Jordan blocks to the ranks of powers of the matrix $N = A - \\lambda I$. By constructing a matrix with a specific Jordan structure and then verifying it through rank calculations, you will gain a concrete understanding of how the geometry of generalized eigenspaces is encoded in these numerical invariants [@problem_id:3553184].", "problem": "Let $A \\in \\mathbb{R}^{4 \\times 4}$ be a real matrix. The characteristic polynomial of $A$ is defined by $p_{A}(x) = \\det(x I - A)$, where $I$ is the identity matrix. A Jordan block of size $m$ associated with an eigenvalue $\\lambda \\in \\mathbb{C}$ is the $m \\times m$ matrix $J_{m}(\\lambda)$ having $\\lambda$ on the diagonal, ones on the superdiagonal, and zeros elsewhere. A matrix is called defective if its geometric multiplicity (the dimension of the eigenspace) is strictly smaller than its algebraic multiplicity (the multiplicity of the eigenvalue in the characteristic polynomial). The rank-nullity theorem states that for any linear map on a finite-dimensional vector space, $\\operatorname{rank}(M) + \\operatorname{nullity}(M) = n$, where $n$ is the dimension.\n\nConstruct explicitly a matrix $A \\in \\mathbb{R}^{4 \\times 4}$ with characteristic polynomial $p_{A}(x) = (x-1)^{4}$ that has exactly two Jordan blocks. Using only the foundational definitions above and direct computation, determine the ranks $r_{j} = \\operatorname{rank}\\big((A - I)^{j}\\big)$ for $j \\in \\{1,2,3\\}$, and use these ranks to certify that $A$ is defective by interpreting the nullities of $(A-I)^{j}$ in terms of eigenspaces and generalized eigenspaces. Briefly explain, from first principles, why matrices with nontrivial Jordan blocks are numerically unstable under small perturbations in the sense that their eigen-structure is highly sensitive.\n\nProvide, as your final answer, the row matrix $(r_{1}, r_{2}, r_{3})$. No rounding is required.", "solution": "The user wants me to solve a problem about the Jordan canonical form and its numerical properties.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n-   $A \\in \\mathbb{R}^{4 \\times 4}$ is a real matrix.\n-   The characteristic polynomial of $A$ is $p_{A}(x) = (x-1)^{4}$.\n-   $A$ must have exactly two Jordan blocks.\n-   Definitions are provided for: characteristic polynomial, Jordan block, defective matrix, and the rank-nullity theorem.\n-   Task 1: Construct a matrix $A$ satisfying these properties.\n-   Task 2: Determine the ranks $r_{j} = \\operatorname{rank}\\big((A - I)^{j}\\big)$ for $j \\in \\{1,2,3\\}$, where $I$ is the identity matrix.\n-   Task 3: Use these ranks to certify that $A$ is defective.\n-   Task 4: Explain why matrices with nontrivial Jordan blocks are numerically unstable.\n-   The final answer must be the row matrix $(r_1, r_2, r_3)$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is well-posed and scientifically grounded within the domain of linear algebra and numerical analysis.\n-   **Scientific Soundness**: All concepts (Jordan form, characteristic polynomial, rank, nullity, numerical stability) are standard and correct.\n-   **Well-Posedness**: The characteristic polynomial $p_{A}(x) = (x-1)^{4}$ implies that the only eigenvalue is $\\lambda = 1$ with algebraic multiplicity $4$. For a $4 \\times 4$ matrix, having two Jordan blocks means their sizes must sum to $4$. The possible partitions of $4$ into two integers are $3+1$ and $2+2$. The problem asks for the construction of *a* matrix, so selecting either partition is valid. The request to compute ranks for $j \\in \\{1,2,3\\}$ suggests that the maximal Jordan block size is at least $3$, making the $3+1$ partition a more illustrative choice. The tasks are specific and lead to a unique solution for the ranks once a matrix is constructed.\n-   **Objectivity**: The problem is stated using precise, unambiguous mathematical terminology.\n-   **Completeness**: The problem provides all necessary information and definitions to proceed. It is self-contained.\n\n**Step 3: Verdict and Action**\nThe problem is valid. I will proceed with the solution.\n\n### Solution\n\n**Part 1: Construction of Matrix A**\n\nThe characteristic polynomial is given as $p_{A}(x) = (x-1)^{4}$. This implies that the matrix $A$ has a single eigenvalue $\\lambda = 1$ with algebraic multiplicity $m_a = 4$.\nThe matrix $A$ is specified to have exactly two Jordan blocks. The sum of the sizes of the Jordan blocks must equal the dimension of the matrix, which is $4$. The possible partitions of the integer $4$ into two parts are $3+1$ and $2+2$.\nWe choose the partition $3+1$. This structure implies that the Jordan canonical form $J$ of $A$ consists of one Jordan block of size $3$ and one Jordan block of size $1$, both associated with the eigenvalue $\\lambda=1$.\nThe Jordan form is:\n$$ J = \\begin{pmatrix} J_{3}(1) & 0 \\\\ 0 & J_{1}(1) \\end{pmatrix} = \\begin{pmatrix} 1 & 1 & 0 & 0 \\\\ 0 & 1 & 1 & 0 \\\\ 0 & 0 & 1 & 0 \\\\ 0 & 0 & 0 & 1 \\end{pmatrix} $$\nTo construct the matrix $A$, we can choose $A$ to be its own Jordan form, as this is the simplest representative of the similarity class of matrices with this Jordan structure. Let $A = J$. This matrix is in $\\mathbb{R}^{4 \\times 4}$, its characteristic polynomial is indeed $(x-1)^4$ (since it is upper triangular with diagonal entries all equal to $1$), and it has two Jordan blocks by construction.\n\n**Part 2: Determination of Ranks**\n\nWe need to compute the ranks $r_j = \\operatorname{rank}((A-I)^j)$ for $j \\in \\{1, 2, 3\\}$. Let $N = A - I$.\n$$ N = A - I = \\begin{pmatrix} 1 & 1 & 0 & 0 \\\\ 0 & 1 & 1 & 0 \\\\ 0 & 0 & 1 & 0 \\\\ 0 & 0 & 0 & 1 \\end{pmatrix} - \\begin{pmatrix} 1 & 0 & 0 & 0 \\\\ 0 & 1 & 0 & 0 \\\\ 0 & 0 & 1 & 0 \\\\ 0 & 0 & 0 & 1 \\end{pmatrix} = \\begin{pmatrix} 0 & 1 & 0 & 0 \\\\ 0 & 0 & 1 & 0 \\\\ 0 & 0 & 0 & 0 \\\\ 0 & 0 & 0 & 0 \\end{pmatrix} $$\n-   For $j=1$: We compute $r_1 = \\operatorname{rank}(N)$. The matrix $N$ has two linearly independent column vectors (the second and third columns are $(1,0,0,0)^T$ and $(0,1,0,0)^T$ respectively). Thus, its rank is $2$.\n    $r_1 = 2$.\n-   For $j=2$: We compute $r_2 = \\operatorname{rank}(N^2)$.\n    $$ N^2 = \\begin{pmatrix} 0 & 1 & 0 & 0 \\\\ 0 & 0 & 1 & 0 \\\\ 0 & 0 & 0 & 0 \\\\ 0 & 0 & 0 & 0 \\end{pmatrix} \\begin{pmatrix} 0 & 1 & 0 & 0 \\\\ 0 & 0 & 1 & 0 \\\\ 0 & 0 & 0 & 0 \\\\ 0 & 0 & 0 & 0 \\end{pmatrix} = \\begin{pmatrix} 0 & 0 & 1 & 0 \\\\ 0 & 0 & 0 & 0 \\\\ 0 & 0 & 0 & 0 \\\\ 0 & 0 & 0 & 0 \\end{pmatrix} $$\n    The matrix $N^2$ has only one non-zero column. Its rank is $1$.\n    $r_2 = 1$.\n-   For $j=3$: We compute $r_3 = \\operatorname{rank}(N^3)$.\n    $$ N^3 = N^2 \\cdot N = \\begin{pmatrix} 0 & 0 & 1 & 0 \\\\ 0 & 0 & 0 & 0 \\\\ 0 & 0 & 0 & 0 \\\\ 0 & 0 & 0 & 0 \\end{pmatrix} \\begin{pmatrix} 0 & 1 & 0 & 0 \\\\ 0 & 0 & 1 & 0 \\\\ 0 & 0 & 0 & 0 \\\\ 0 & 0 & 0 & 0 \\end{pmatrix} = \\begin{pmatrix} 0 & 0 & 0 & 0 \\\\ 0 & 0 & 0 & 0 \\\\ 0 & 0 & 0 & 0 \\\\ 0 & 0 & 0 & 0 \\end{pmatrix} $$\n    The matrix $N^3$ is the zero matrix. Its rank is $0$.\n    $r_3 = 0$.\n\nThe sequence of ranks is $(r_1, r_2, r_3) = (2, 1, 0)$.\n\n**Part 3: Certification of Defectiveness**\n\nA matrix is defective if, for at least one eigenvalue, its geometric multiplicity is strictly less than its algebraic multiplicity.\nThe algebraic multiplicity of the eigenvalue $\\lambda=1$ is $m_a = 4$, as given by the characteristic polynomial $p_A(x)=(x-1)^4$.\nThe geometric multiplicity $m_g$ of $\\lambda=1$ is the dimension of the eigenspace $E_1 = \\ker(A - 1 \\cdot I)$. By the rank-nullity theorem applied to the matrix $A-I$ on $\\mathbb{R}^4$:\n$$ \\operatorname{rank}(A-I) + \\operatorname{nullity}(A-I) = 4 $$\nThe nullity is the geometric multiplicity: $m_g = \\operatorname{nullity}(A-I)$.\n$$ m_g = 4 - \\operatorname{rank}(A-I) = 4 - r_1 $$\nUsing our computed value $r_1=2$, we find the geometric multiplicity:\n$$ m_g = 4 - 2 = 2 $$\nComparing the multiplicities, we have $m_g = 2 < m_a = 4$. Since the geometric multiplicity is strictly smaller than the algebraic multiplicity, the matrix $A$ is defective.\n\nThe nullities of the powers of $(A-I)$ relate to the structure of the generalized eigenspaces. Let $k_j = \\operatorname{nullity}((A-I)^j) = 4-r_j$.\n-   $k_1 = 4-r_1 = 4-2=2$. This is the dimension of the eigenspace, equal to the number of Jordan blocks.\n-   $k_2 = 4-r_2 = 4-1=3$. This is the dimension of the kernel of $(A-I)^2$.\n-   $k_3 = 4-r_3 = 4-0=4$. This is the dimension of the kernel of $(A-I)^3$.\nThe number of Jordan blocks of size at least $j$ is given by the difference $k_j - k_{j-1}$ (with $k_0 = 0$).\n-   Number of blocks $\\ge 1$: $k_1 - k_0 = 2-0=2$.\n-   Number of blocks $\\ge 2$: $k_2 - k_1 = 3-2=1$.\n-   Number of blocks $\\ge 3$: $k_3 - k_2 = 4-3=1$.\nThis confirms the existence of one block of size $3$ and one block of size $1$, consistent with our construction.\n\n**Part 4: Explanation of Numerical Instability**\n\nMatrices with nontrivial Jordan blocks (i.e., blocks of size $m>1$) are defective, meaning they have repeated eigenvalues whose geometric multiplicity is less than their algebraic multiplicity. The calculation of eigenvalues for such matrices is an ill-conditioned problem. This means that small perturbations in the matrix entries can lead to large changes in the computed eigenvalues.\n\nFrom first principles, consider a simple $2 \\times 2$ Jordan block associated with an eigenvalue $\\lambda$:\n$$ J = \\begin{pmatrix} \\lambda & 1 \\\\ 0 & \\lambda \\end{pmatrix} $$\nIts characteristic polynomial is $(x-\\lambda)^2=0$, yielding one eigenvalue $x=\\lambda$ with algebraic multiplicity $2$ and geometric multiplicity $1$.\n\nNow, introduce a small perturbation $\\epsilon$ to the $(2,1)$ entry, creating the matrix $J'$:\n$$ J' = \\begin{pmatrix} \\lambda & 1 \\\\ \\epsilon & \\lambda \\end{pmatrix} $$\nThe characteristic polynomial of $J'$ is $\\det(xI - J') = (x-\\lambda)^2 - \\epsilon = 0$. The roots are given by $x - \\lambda = \\pm\\sqrt{\\epsilon}$, which means the new eigenvalues are:\n$$ x_{1,2} = \\lambda \\pm \\sqrt{\\epsilon} $$\nA perturbation of size $|\\epsilon|$ in a matrix entry has caused a perturbation of size $|\\sqrt{\\epsilon}|$ in the eigenvalues. For small $\\epsilon$ (e.g., $\\epsilon = 10^{-16}$), the perturbation to the eigenvalues ($\\sqrt{\\epsilon} = 10^{-8}$) is many orders of magnitude larger. This disproportionate response signifies numerical instability.\n\nFurthermore, for any non-zero $\\epsilon$, the two eigenvalues $\\lambda + \\sqrt{\\epsilon}$ and $\\lambda - \\sqrt{\\epsilon}$ are distinct. This means the perturbed matrix $J'$ is no longer defective; it is diagonalizable and has a full set of two linearly independent eigenvectors. The fundamental eigen-structure of the matrix changes drastically from defective to diagonalizable due to an arbitrarily small perturbation. In floating-point arithmetic, distinguishing between a truly defective matrix and a diagonalizable matrix that is merely close to a defective one is impossible, making the Jordan form a numerically unstable representation.", "answer": "$$\n\\boxed{\\begin{pmatrix} 2 & 1 & 0 \\end{pmatrix}}\n$$", "id": "3553184"}, {"introduction": "While the Jordan form is theoretically elegant, it is numerically fragile, a fact that makes it unsuitable for practical computation. This practice provides a quantitative look at this instability by examining a simple $2 \\times 2$ perturbed Jordan block. You will see how a tiny perturbation not only splits the repeated eigenvalue but also pushes the corresponding eigenvectors towards being linearly dependent, causing the condition number of the eigenvector matrix to diverge [@problem_id:3553151]. This calculation vividly illustrates why the eigenbasis of a nearly defective matrix is an unreliable tool for computation.", "problem": "Consider the $2\\times 2$ Jordan block $J_2(0)$ for eigenvalue $0$, defined by $J_2(0) = \\begin{pmatrix}0  1\\\\ 0  0\\end{pmatrix}$. Let $A(\\epsilon) = J_2(0) + \\epsilon\\begin{pmatrix}0  0\\\\ 1  0\\end{pmatrix} = \\begin{pmatrix}0  1\\\\ \\epsilon  0\\end{pmatrix}$ for a real parameter $\\epsilon > 0$ that is sufficiently small. Starting from the core definitions of eigenvalues and eigenvectors and the definition of the matrix condition number in the spectral norm, perform the following tasks:\n\n- Derive the eigenvalues of $A(\\epsilon)$ to leading order in $\\epsilon$ by forming its characteristic polynomial and solving for its roots.\n- Derive, to leading order in $\\epsilon$, a corresponding set of eigenvectors and assemble the eigenvector matrix $V(\\epsilon)$ whose columns are the eigenvectors of $A(\\epsilon)$, using the normalization that the first component of each eigenvector is $1$.\n- Using the definition of the matrix condition number in the $2$-norm (spectral norm), namely $\\kappa_2(V)=\\|V\\|_2\\,\\|V^{-1}\\|_2$, analyze how $\\kappa_2(V(\\epsilon))$ behaves as $\\epsilon \\to 0^{+}$. You may use that the spectral norm $\\|\\cdot\\|_2$ equals the largest singular value and that $\\|V^{-1}\\|_2$ equals the reciprocal of the smallest singular value.\n- Explain why the behavior you find reflects the numerical instability of the Jordan canonical form near a defective matrix.\n\nReport as your final answer the leading-order asymptotic expression, in terms of $\\epsilon$, for $\\kappa_2(V(\\epsilon))$ as $\\epsilon \\to 0^{+}$. No rounding is required, and no physical units apply.", "solution": "The problem is valid as it is a well-posed and standard exercise in numerical linear algebra, based on established mathematical principles.\n\nWe are given the matrix $A(\\epsilon) = \\begin{bmatrix}01\\\\ \\epsilon0\\end{bmatrix}$ for a small real parameter $\\epsilon  0$. This matrix is a perturbation of the Jordan block $J_2(0)=\\begin{bmatrix}01\\\\ 00\\end{bmatrix}$. We are to analyze the properties of $A(\\epsilon)$ as $\\epsilon \\to 0^{+}$.\n\nFirst, we derive the eigenvalues of $A(\\epsilon)$. The characteristic equation is given by $\\det(A(\\epsilon) - \\lambda I) = 0$, where $I$ is the $2 \\times 2$ identity matrix.\n$$\n\\det\\left(\\begin{bmatrix}01\\\\ \\epsilon0\\end{bmatrix} - \\lambda\\begin{bmatrix}10\\\\ 01\\end{bmatrix}\\right) = \\det\\begin{pmatrix}-\\lambda  1 \\\\ \\epsilon  -\\lambda\\end{pmatrix} = 0\n$$\nEvaluating the determinant gives $(-\\lambda)(-\\lambda) - (1)(\\epsilon) = \\lambda^2 - \\epsilon = 0$.\nSince $\\epsilon  0$, the roots of this equation, which are the eigenvalues of $A(\\epsilon)$, are real and distinct:\n$$\n\\lambda_1 = \\sqrt{\\epsilon} \\quad \\text{and} \\quad \\lambda_2 = -\\sqrt{\\epsilon}\n$$\nThe unperturbed matrix $J_2(0)$ has a double eigenvalue at $0$. A perturbation of magnitude $O(\\epsilon)$ in a single entry of the matrix has led to a change in the eigenvalues of magnitude $O(\\sqrt{\\epsilon})$, which is significantly larger for small $\\epsilon$. This indicates a high sensitivity of the eigenvalues.\n\nNext, we derive the corresponding eigenvectors. For an eigenvector $v = \\begin{pmatrix}x \\\\ y\\end{pmatrix}$, we solve the equation $(A(\\epsilon) - \\lambda I)v = 0$.\n\nFor the eigenvalue $\\lambda_1 = \\sqrt{\\epsilon}$:\n$$\n(A(\\epsilon) - \\lambda_1 I)v_1 = \\begin{pmatrix}-\\sqrt{\\epsilon}  1 \\\\ \\epsilon  -\\sqrt{\\epsilon}\\end{pmatrix}\\begin{pmatrix}x_1 \\\\ y_1\\end{pmatrix} = \\begin{pmatrix}0 \\\\ 0\\end{pmatrix}\n$$\nThis yields the equation $-\\sqrt{\\epsilon}x_1 + y_1 = 0$, or $y_1 = \\sqrt{\\epsilon}x_1$. The second row yields $\\epsilon x_1 - \\sqrt{\\epsilon} y_1 = 0$, which is equivalent. Using the specified normalization that the first component of the eigenvector is $1$, we set $x_1=1$, which gives $y_1=\\sqrt{\\epsilon}$. The eigenvector is $v_1 = \\begin{pmatrix}1 \\\\ \\sqrt{\\epsilon}\\end{pmatrix}$.\n\nFor the eigenvalue $\\lambda_2 = -\\sqrt{\\epsilon}$:\n$$\n(A(\\epsilon) - \\lambda_2 I)v_2 = \\begin{pmatrix}\\sqrt{\\epsilon}  1 \\\\ \\epsilon  \\sqrt{\\epsilon}\\end{pmatrix}\\begin{pmatrix}x_2 \\\\ y_2\\end{pmatrix} = \\begin{pmatrix}0 \\\\ 0\\end{pmatrix}\n$$\nThis yields the equation $\\sqrt{\\epsilon}x_2 + y_2 = 0$, or $y_2 = -\\sqrt{\\epsilon}x_2$. Setting $x_2=1$ gives $y_2=-\\sqrt{\\epsilon}$. The eigenvector is $v_2 = \\begin{pmatrix}1 \\\\ -\\sqrt{\\epsilon}\\end{pmatrix}$.\n\nThe matrix of eigenvectors $V(\\epsilon)$ is formed by taking these eigenvectors as columns:\n$$\nV(\\epsilon) = \\begin{bmatrix}v_1  v_2\\end{bmatrix} = \\begin{pmatrix}1  1 \\\\ \\sqrt{\\epsilon}  -\\sqrt{\\epsilon}\\end{pmatrix}\n$$\n\nNow, we analyze the condition number of $V(\\epsilon)$ in the spectral norm ($2$-norm), $\\kappa_2(V(\\epsilon)) = \\|V(\\epsilon)\\|_2 \\|V(\\epsilon)^{-1}\\|_2$. The spectral norm of a matrix is its largest singular value.\n\nFirst, we find the inverse of $V(\\epsilon)$. The determinant is $\\det(V(\\epsilon)) = (1)(-\\sqrt{\\epsilon}) - (1)(\\sqrt{\\epsilon}) = -2\\sqrt{\\epsilon}$.\n$$\nV(\\epsilon)^{-1} = \\frac{1}{-2\\sqrt{\\epsilon}}\\begin{pmatrix}-\\sqrt{\\epsilon}  -1 \\\\ -\\sqrt{\\epsilon}  1\\end{pmatrix} = \\begin{pmatrix}\\frac{1}{2}  \\frac{1}{2\\sqrt{\\epsilon}} \\\\ \\frac{1}{2}  -\\frac{1}{2\\sqrt{\\epsilon}}\\end{pmatrix}\n$$\nTo find $\\|V(\\epsilon)\\|_2$, we compute the eigenvalues of $V(\\epsilon)^T V(\\epsilon)$:\n$$\nV(\\epsilon)^T V(\\epsilon) = \\begin{pmatrix}1  \\sqrt{\\epsilon} \\\\ 1  -\\sqrt{\\epsilon}\\end{pmatrix}\\begin{pmatrix}1  1 \\\\ \\sqrt{\\epsilon}  -\\sqrt{\\epsilon}\\end{pmatrix} = \\begin{pmatrix}1+\\epsilon  1-\\epsilon \\\\ 1-\\epsilon  1+\\epsilon\\end{pmatrix}\n$$\nThe eigenvalues $\\mu$ of this matrix satisfy $\\det(V(\\epsilon)^T V(\\epsilon) - \\mu I) = (1+\\epsilon-\\mu)^2 - (1-\\epsilon)^2 = 0$. This gives $(1+\\epsilon-\\mu - (1-\\epsilon))(1+\\epsilon-\\mu + (1-\\epsilon))=0$, which simplifies to $(2\\epsilon-\\mu)(2-\\mu)=0$. The eigenvalues are $\\mu_1 = 2$ and $\\mu_2 = 2\\epsilon$.\nThese are the squares of the singular values of $V(\\epsilon)$. Since $\\epsilon$ is small, the largest eigenvalue is $2$.\nThe singular values of $V(\\epsilon)$ are $\\sigma_{\\max}(V(\\epsilon)) = \\sqrt{2}$ and $\\sigma_{\\min}(V(\\epsilon)) = \\sqrt{2\\epsilon}$.\nTherefore, the spectral norm is $\\|V(\\epsilon)\\|_2 = \\sigma_{\\max}(V(\\epsilon)) = \\sqrt{2}$.\n\nThe spectral norm of the inverse, $\\|V(\\epsilon)^{-1}\\|_2$, is the reciprocal of the smallest singular value of $V(\\epsilon)$:\n$$\n\\|V(\\epsilon)^{-1}\\|_2 = \\frac{1}{\\sigma_{\\min}(V(\\epsilon))} = \\frac{1}{\\sqrt{2\\epsilon}}\n$$\nThe condition number is the product of these norms:\n$$\n\\kappa_2(V(\\epsilon)) = \\|V(\\epsilon)\\|_2 \\|V(\\epsilon)^{-1}\\|_2 = \\sqrt{2} \\cdot \\frac{1}{\\sqrt{2\\epsilon}} = \\frac{1}{\\sqrt{\\epsilon}}\n$$\nAs $\\epsilon \\to 0^+$, the condition number $\\kappa_2(V(\\epsilon)) = \\frac{1}{\\sqrt{\\epsilon}}$ approaches infinity.\n\nThis behavior reflects the numerical instability associated with the Jordan canonical form. The matrix $A(0) = J_2(0)$ is defective; its eigenvalue $\\lambda=0$ has algebraic multiplicity $2$ but geometric multiplicity $1$. It does not possess a basis of eigenvectors and is thus not diagonalizable. For any $\\epsilon  0$, the perturbed matrix $A(\\epsilon)$ becomes diagonalizable, having two distinct eigenvalues. However, the matrix of eigenvectors $V(\\epsilon)$ becomes increasingly ill-conditioned as $\\epsilon \\to 0^+$. An ill-conditioned matrix is one that is close to being singular. Indeed, $\\det(V(\\epsilon)) = -2\\sqrt{\\epsilon} \\to 0$ as $\\epsilon \\to 0^+$.\nThe geometric interpretation is that the two eigenvectors $v_1=\\begin{pmatrix}1 \\\\ \\sqrt{\\epsilon}\\end{pmatrix}$ and $v_2=\\begin{pmatrix}1 \\\\ -\\sqrt{\\epsilon}\\end{pmatrix}$ become nearly parallel as $\\epsilon \\to 0^+$. In the limit, both collapse to the vector $\\begin{pmatrix}1 \\\\ 0\\end{pmatrix}$, which spans the one-dimensional eigenspace of the defective matrix $J_2(0)$. The angle $\\theta$ between $v_1$ and $v_2$ approaches $0$ as $\\epsilon \\to 0^+$.\nA very large condition number $\\kappa(V)$ in the diagonalization $A=VDV^{-1}$ implies that the eigenvalues of $A$ are highly sensitive to perturbations in $A$. The fact that $\\kappa_2(V(\\epsilon))$ diverges as $\\epsilon^{-1/2}$ quantifies the extreme ill-conditioning of the eigenproblem for matrices that are close to having a non-trivial Jordan structure. This is why numerical algorithms avoid using the Jordan canonical form and instead rely on stable factorizations like the Schur decomposition, which is always well-conditioned. The divergence of $\\kappa_2(V(\\epsilon))$ confirms that a matrix with a nearly repeated eigenvalue (and nearly collinear eigenvectors) is numerically challenging, making the Jordan form a poor basis for computation.", "answer": "$$\\boxed{\\frac{1}{\\sqrt{\\epsilon}}}$$", "id": "3553151"}, {"introduction": "The theoretical instabilities of the Jordan form have direct consequences in computational practice, where finite-precision arithmetic introduces unavoidable errors. This hands-on coding exercise demonstrates how these inherent round-off errors, acting as small random perturbations, prevent the exact representation of a defective matrix. You will write a program to observe how such perturbations split the single eigenvalue of a Jordan block into a cluster of distinct values, confirming why a numerically computed spectrum of a defective matrix almost never reveals its true Jordan structure [@problem_id:3553193].", "problem": "Consider the Jordan canonical form (JCF), which expresses a matrix as a block-diagonal matrix composed of Jordan blocks. A single Jordan block of size $m$ associated with eigenvalue $\\lambda \\in \\mathbb{C}$ is defined as the $m \\times m$ matrix $J_m(\\lambda)$ with $\\lambda$ on the diagonal and ones on the superdiagonal, and zeros elsewhere. In finite precision arithmetic, any input matrix is subject to unavoidable roundoff modeled as an additive perturbation. For matrices with nontrivial Jordan structure, such perturbations are known to cause eigenvalue splitting and, with probability one under continuous random perturbations, yield a diagonalizable matrix.\n\nStart from the following foundational base:\n- The characteristic polynomial of $J_m(\\lambda)$ is $(x - \\lambda)^m$ and thus has a single eigenvalue $\\lambda$ of algebraic multiplicity $m$ and geometric multiplicity $1$ when $m \\ge 2$.\n- In floating-point arithmetic, a matrix $A$ is effectively $A + \\Delta A$, with $\\|\\Delta A\\|$ on the order of machine epsilon scaled by the magnitudes of the entries in $A$.\n- The eigenvalues of perturbed polynomials generically undergo root splitting governed by the sizes of the newly introduced lower-degree coefficients.\n\nYour task is to design and implement a complete program that conducts numerical experiments to demonstrate and quantify the numerical instability of the Jordan canonical form with respect to eigenvalue computation. For each test case, construct the perturbed matrix\n$$\nA_\\delta = J_m(\\lambda) + \\delta E,\n$$\nwhere $E$ is a real-valued random matrix with independent entries sampled from a standard normal distribution, and $\\delta \\ge 0$ is a scalar controlling the perturbation magnitude. Use a fixed pseudorandom seed to ensure reproducibility for each test case.\n\nFor each constructed matrix $A_\\delta$, perform the following steps:\n1. Compute all eigenvalues $\\mu_1,\\dots,\\mu_m \\in \\mathbb{C}$ of $A_\\delta$.\n2. Using an absolute tolerance $\\tau = 10^{-12}$, compute the integer $k$ equal to the number of distinct eigenvalues, where two eigenvalues are considered identical if their absolute difference is less than or equal to $\\tau$.\n3. Compute the observed eigenvalue spread\n$$\nr = \\max_{1 \\le i \\le m} \\left| \\mu_i - \\lambda \\right|.\n$$\n4. Estimate the effective perturbation size via the defect-sensitive scaling law by\n$$\n\\widehat{\\varepsilon} = r^m.\n$$\nReport $k$ to numerically support the claim that, under generic perturbations, the computed spectrum is almost surely simple (and thus diagonalizable), and report $\\widehat{\\varepsilon}$ as an estimate of the magnitude of the underlying perturbation inferred from the eigenvalue spread.\n\nTest suite:\n- Case $1$: $(m,\\lambda,\\delta,\\text{seed}) = (1, 2, 10^{-12}, 0)$.\n- Case $2$: $(m,\\lambda,\\delta,\\text{seed}) = (2, 0, 2^{-52}, 1)$, where $2^{-52}$ is double-precision machine epsilon.\n- Case $3$: $(m,\\lambda,\\delta,\\text{seed}) = (3, 1, 10^{-8}, 2)$.\n- Case $4$: $(m,\\lambda,\\delta,\\text{seed}) = (4, 0.5, 0, 3)$.\n- Case $5$: $(m,\\lambda,\\delta,\\text{seed}) = (5, -3.2, 10^{-30}, 4)$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. For each test case, output two values in order: first the integer $k$, then the float $\\widehat{\\varepsilon}$. The outputs from all test cases should be flattened into a single list in the same order as the test suite. For example, the final output should have the form\n$$\n[k_1,\\widehat{\\varepsilon}_1,k_2,\\widehat{\\varepsilon}_2,k_3,\\widehat{\\varepsilon}_3,k_4,\\widehat{\\varepsilon}_4,k_5,\\widehat{\\varepsilon}_5].\n$$\nNo physical units or angles are involved. All numerical quantities should be reported as raw numbers. Implement the program in any modern language, adhering to the specified runtime environment in the final answer.", "solution": "The problem is subjected to validation prior to any attempt at a solution.\n\n### Step 1: Extract Givens\nThe verbatim givens from the problem statement are:\n- **Task**: Design and implement a program to demonstrate and quantify the numerical instability of the Jordan canonical form (JCF) with respect to eigenvalue computation.\n- **Matrix construction**: $A_\\delta = J_m(\\lambda) + \\delta E$.\n- **$J_m(\\lambda)$**: A Jordan block of size $m \\times m$ with eigenvalue $\\lambda$. It has $\\lambda$ on the diagonal, ones on the superdiagonal, and zeros elsewhere.\n- **$E$**: A real-valued random matrix with independent entries sampled from a standard normal distribution.\n- **$\\delta$**: A scalar perturbation magnitude, with $\\delta \\ge 0$.\n- **Reproducibility**: A fixed pseudorandom seed is used for each test case.\n- **Computational Steps**:\n    1. Compute all eigenvalues $\\mu_1, \\dots, \\mu_m \\in \\mathbb{C}$ of $A_\\delta$.\n    2. Compute the number of distinct eigenvalues, $k$, using an absolute tolerance $\\tau = 10^{-12}$. Two eigenvalues are considered identical if their absolute difference is less than or equal to $\\tau$.\n    3. Compute the observed eigenvalue spread $r = \\max_{1 \\le i \\le m} |\\mu_i - \\lambda|$.\n    4. Estimate the effective perturbation size $\\widehat{\\varepsilon} = r^m$.\n- **Test Suite**:\n    - Case 1: $(m, \\lambda, \\delta, \\text{seed}) = (1, 2, 10^{-12}, 0)$.\n    - Case 2: $(m, \\lambda, \\delta, \\text{seed}) = (2, 0, 2^{-52}, 1)$.\n    - Case 3: $(m, \\lambda, \\delta, \\text{seed}) = (3, 1, 10^{-8}, 2)$.\n    - Case 4: $(m, \\lambda, \\delta, \\text{seed}) = (4, 0.5, 0, 3)$.\n    - Case 5: $(m, \\lambda, \\delta, \\text{seed}) = (5, -3.2, 10^{-30}, 4)$.\n- **Output Format**: A single line of text: $[k_1,\\widehat{\\varepsilon}_1,k_2,\\widehat{\\varepsilon}_2,k_3,\\widehat{\\varepsilon}_3,k_4,\\widehat{\\varepsilon}_4,k_5,\\widehat{\\varepsilon}_5]$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem statement is evaluated against the established validation criteria.\n\n- **Scientific Grounding**: The problem is fundamentally sound. It addresses a canonical topic in numerical linear algebra: the sensitivity of eigenvalues of defective matrices. The characteristic polynomial of a Jordan block $J_m(\\lambda)$ is indeed $(x - \\lambda)^m$. A generic perturbation of such a matrix typically results in a diagonalizable matrix with $m$ distinct eigenvalues. The relationship between the perturbation magnitude $\\varepsilon$ and the resulting eigenvalue spread $r$ for a defective eigenvalue is given by the well-known result $r = O(\\varepsilon^{1/m})$. The proposed estimator $\\widehat{\\varepsilon} = r^m$ is a direct consequence of this scaling law, designed to recover an estimate of the perturbation magnitude from the observed spread. The entire premise is scientifically correct.\n- **Well-Posedness**: The problem is well-posed. For each test case, all necessary parameters ($m, \\lambda, \\delta, \\text{seed}$) are provided. The procedure for calculating the outputs ($k$ and $\\widehat{\\varepsilon}$) is explicitly defined, including the numerical tolerance $\\tau$ for distinguishing eigenvalues. The use of a fixed seed for the random number generator ensures that the experiment is deterministic and reproducible.\n- **Objectivity**: The problem is stated in precise, objective mathematical language, free from ambiguity or subjective claims.\n\nThe problem does not exhibit any of the listed invalidity flaws. It is scientifically sound, well-posed, objective, formalizable, complete, and non-trivial.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. A solution will be provided.\n\n### Solution\nThe objective is to conduct a numerical experiment to investigate the instability of eigenvalues of a Jordan block under small perturbations. For each test case specified by $(m, \\lambda, \\delta, \\text{seed})$, we will construct a perturbed matrix $A_\\delta$ and analyze its computed spectrum.\n\n**Theoretical Background**\nA Jordan block $J_m(\\lambda)$ is a defective matrix for $m \\ge 2$, meaning it has fewer linearly independent eigenvectors than its dimension. It possesses a single eigenvalue $\\lambda$ with algebraic multiplicity $m$ but a geometric multiplicity of only $1$. The eigenvalues of such a matrix are highly sensitive to perturbations. It can be shown from perturbation theory that a generic perturbation of magnitude $\\delta$ will split the single eigenvalue into $m$ distinct eigenvalues, $\\mu_i$, which lie in a disk of radius $O(\\delta^{1/m})$ centered at $\\lambda$ in the complex plane.\nThe perturbed characteristic polynomial can be approximated as:\n$$ \\det(xI - A_\\delta) = \\det(xI - J_m(\\lambda) - \\delta E) \\approx (x-\\lambda)^m - c \\delta = 0 $$\nwhere the constant $c$ depends on the entries of the perturbation matrix $E$, specifically $c \\approx (-1)^{m+1} E_{m,1}$ for $J_m(0)$. The roots of this polynomial are approximately $\\mu_j \\approx \\lambda + (c\\delta)^{1/m}$. The maximum distance from $\\lambda$ is the spread $r = \\max_j |\\mu_j - \\lambda|$, which scales as $r \\propto \\delta^{1/m}$. Consequently, we can estimate the perturbation's effective magnitude by inverting this relationship: $\\widehat{\\varepsilon} = r^m$, which should be on the order of $\\delta$.\n\n**Algorithmic Procedure**\nFor each test case $(m, \\lambda, \\delta, \\text{seed})$, the following steps are executed:\n\n1.  **Set Seed for Reproducibility**: The pseudorandom number generator's seed is fixed to the value specified in the test case. This ensures that the random matrix $E$ is identical upon every execution of the experiment.\n\n2.  **Construct Matrices**:\n    - A Jordan block $J_m(\\lambda)$ of size $m \\times m$ is created. This matrix has the value $\\lambda$ on its main diagonal and the value $1$ on its first superdiagonal.\n    - An $m \\times m$ perturbation matrix $E$ is generated, where each entry is an independent sample from the standard normal distribution $\\mathcal{N}(0, 1)$.\n    - The final perturbed matrix is computed as $A_\\delta = J_m(\\lambda) + \\delta E$.\n\n3.  **Compute Eigenvalues**: The eigenvalues $\\mu_1, \\dots, \\mu_m$ of the matrix $A_\\delta$ are computed using a standard numerical library function. These eigenvalues may be complex numbers even if $A_\\delta$ is real.\n\n4.  **Count Distinct Eigenvalues ($k$)**: The number of distinct eigenvalues is determined based on the given tolerance $\\tau = 10^{-12}$. An iterative algorithm is employed:\n    - Initialize an empty list of distinct eigenvalues.\n    - For each computed eigenvalue $\\mu_i$:\n        - Check if it is \"close\" to any of the eigenvalues already in the distinct list, i.e., if $|\\mu_i - \\mu_j| \\le \\tau$ for any $\\mu_j$ already in the list.\n        - If it is not close to any existing distinct eigenvalue, add it to the list.\n    - The count $k$ is the final size of this list of distinct eigenvalues.\n    For $\\delta  0$ and $m  1$, we expect $k=m$ with very high probability. For $\\delta=0$ or $m=1$, we expect $k=1$.\n\n5.  **Calculate Eigenvalue Spread ($r$)**: The maximum absolute deviation of the computed eigenvalues from the original eigenvalue $\\lambda$ is calculated:\n    $$ r = \\max_{1 \\le i \\le m} |\\mu_i - \\lambda| $$\n    where $|\\cdot|$ denotes the modulus for complex numbers.\n\n6.  **Estimate Effective Perturbation ($\\widehat{\\varepsilon}$)**: The effective perturbation size is estimated using the scaling law derived from perturbation theory:\n    $$ \\widehat{\\varepsilon} = r^m $$\n    This value provides an estimate of the perturbation magnitude inferred from its effect on the spectrum. For $\\delta  0$, we expect $\\widehat{\\varepsilon}$ to be on the order of $\\delta$.\n\nThe results ($k$ and $\\widehat{\\varepsilon}$) from each test case are collected and formatted into the required output string.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Conducts numerical experiments to demonstrate the instability of the\n    Jordan canonical form's eigenvalues under perturbation.\n    \"\"\"\n    # Test suite: (m, lambda, delta, seed)\n    test_cases = [\n        (1, 2.0, 1e-12, 0),\n        (2, 0.0, 2**-52, 1),\n        (3, 1.0, 1e-8, 2),\n        (4, 0.5, 0.0, 3),\n        (5, -3.2, 1e-30, 4),\n    ]\n\n    # Tolerance for distinguishing eigenvalues\n    tau = 1e-12\n    \n    results = []\n    \n    for m, lam, delta, seed in test_cases:\n        # 1. Set seed for reproducibility\n        np.random.seed(seed)\n        \n        # 2. Construct matrices\n        # Construct the Jordan block J_m(lambda)\n        J = np.diag(np.full(m, lam)) + np.diag(np.ones(m - 1), k=1)\n        \n        # Construct the random perturbation matrix E\n        E = np.random.standard_normal(size=(m, m))\n        \n        # Construct the perturbed matrix A_delta\n        A_delta = J + delta * E\n        \n        # 3. Compute eigenvalues\n        eigenvalues = np.linalg.eigvals(A_delta)\n        \n        # 4. Count distinct eigenvalues (k)\n        distinct_eigenvalues = []\n        for eig_val in eigenvalues:\n            is_new = True\n            for distinct_eig in distinct_eigenvalues:\n                if np.abs(eig_val - distinct_eig) = tau:\n                    is_new = False\n                    break\n            if is_new:\n                distinct_eigenvalues.append(eig_val)\n        k = len(distinct_eigenvalues)\n        \n        # 5. Calculate eigenvalue spread (r)\n        # Handle the edge case of m=0 for an empty eigenvalues array\n        if m  0:\n            r = np.max(np.abs(eigenvalues - lam))\n        else:\n            r = 0.0\n            \n        # 6. Estimate effective perturbation (widehat_epsilon)\n        widehat_epsilon = r**m\n        \n        results.append(k)\n        results.append(widehat_epsilon)\n        \n    # Format the final output as a single comma-separated string in brackets.\n    # Use a custom formatter to ensure sufficient precision for small numbers.\n    def format_number(n):\n        if isinstance(n, int):\n            return str(n)\n        # Use scientific notation for small floats to preserve precision.\n        return f\"{n:.16e}\"\n\n    print(f\"[{','.join(map(format_number, results))}]\")\n\nsolve()\n\n```", "id": "3553193"}]}