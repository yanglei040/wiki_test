{"hands_on_practices": [{"introduction": "A posteriori error estimators are typically driven by residuals, which quantify how poorly a numerical solution satisfies the governing equations. This first practice provides a foundational, step-by-step calculation of the two primary sources of error in a finite element solution: the element residual, which measures the failure to satisfy equilibrium within an element, and the jump residual, which measures the unphysical traction imbalance across element boundaries. By performing this concrete calculation [@problem_id:3499439], you will gain a tangible understanding of how an adaptive algorithm identifies regions of high error and decides where to refine the mesh.", "problem": "Consider two adjacent linear triangular finite elements in a two-dimensional small-strain linear elasticity model of a layered soil under vertical loading, analyzed in plane strain. Let the top element be denoted by $K$ (lying in the upper layer) and the bottom element by $K'$ (lying in the lower layer). The global coordinate system is $(x,y)$ with $y$ positive upward and the ground surface at $y=0$. The shared interior edge $e$ is horizontal at $y=-1$ from $(0,-1)$ to $(2,-1)$, and the unit normal on $e$ pointing from $K$ to $K'$ is $n_e=(0,-1)^{\\mathsf{T}}$.\n\nGeometry and kinematics:\n- Element $K$ has vertices $x_1=(0,-1)$, $x_2=(2,-1)$, $x_3=(0,0)$.\n- Element $K'$ has vertices $x_1'=(0,-1)$, $x_2'=(2,-1)$, $x_3'=(0,-2)$.\n- The conforming piecewise-linear displacement field $u_h=(u_{h,x},u_{h,y})^{\\mathsf{T}}$ is specified at the vertices as follows (units: meters):\n  - On $K$: $u_h(x_1)=(-1.0\\times 10^{-4},\\,-5.0\\times 10^{-4})$, $u_h(x_2)=(-1.2\\times 10^{-4},\\,-5.0\\times 10^{-4})$, $u_h(x_3)=(-0.8\\times 10^{-4},\\,0)$.\n  - On $K'$: $u_h(x_1')=(-1.0\\times 10^{-4},\\,-5.0\\times 10^{-4})$, $u_h(x_2')=(-1.2\\times 10^{-4},\\,-5.0\\times 10^{-4})$, $u_h(x_3')=(-1.3\\times 10^{-4},\\,-1.2\\times 10^{-3})$.\n\nConstitutive behavior and body force:\n- Upper layer (element $K$): Young’s modulus $E_1=5.0\\times 10^{7}$, Poisson’s ratio $\\nu_1=0.3$.\n- Lower layer (element $K'$): Young’s modulus $E_2=1.5\\times 10^{8}$, Poisson’s ratio $\\nu_2=0.25$.\n- Plane strain is assumed. The Cauchy stress is $\\sigma(u_h)=2\\mu\\,\\varepsilon(u_h)+\\lambda\\,\\mathrm{tr}(\\varepsilon(u_h))\\,I$, where $\\varepsilon(u_h)=\\tfrac{1}{2}\\left(\\nabla u_h+(\\nabla u_h)^{\\mathsf{T}}\\right)$, $\\mu=\\dfrac{E}{2(1+\\nu)}$, and $\\lambda=\\dfrac{E\\nu}{(1+\\nu)(1-2\\nu)}$ with $(E,\\nu)$ taken per element.\n- The body force inside $K$ is piecewise constant and represents self-weight: $f=(0,\\,-\\rho_1 g)^{\\mathsf{T}}$ with $\\rho_1=1800$ and $g=9.81$. Assume no body force variation within $K$ and no body force data are required from $K'$ for this computation.\n\nEquilibrium and residuals:\n- The strong form of equilibrium is $-\\nabla\\cdot\\sigma(u)=f$. The element residual on $K$ is defined as the $L^2$-norm $\\|f+\\nabla\\cdot\\sigma(u_h)\\|_{0,K}$, and the interior edge jump residual on $e$ is defined as $\\|[\\![\\sigma(u_h)n_e]\\!]\\|_{0,e}$ with $[\\![\\sigma(u_h)n_e]\\!]=\\left(\\sigma(u_h)\\big|_{K}-\\sigma(u_h)\\big|_{K'}\\right)n_e$.\n\nTasks:\n1) Starting from the kinematic relation for small strain and the plane-strain isotropic linear elastic law, compute $\\nabla u_h$ on $K$ and on $K'$, then $\\varepsilon(u_h)$ and $\\sigma(u_h)$ on each element. Use the specified nodal values to determine the constant gradients on each linear triangle.\n\n2) Using the equilibrium equation and the fact that $\\sigma(u_h)$ is constant over each linear triangle with constant coefficients, determine $f+\\nabla\\cdot\\sigma(u_h)$ on $K$ and compute the element residual norm $\\|f+\\nabla\\cdot\\sigma(u_h)\\|_{0,K}$.\n\n3) Compute the traction jump vector on $e$, $[\\![\\sigma(u_h)n_e]\\!]=\\left(\\sigma(u_h)\\big|_{K}-\\sigma(u_h)\\big|_{K'}\\right)n_e$, and then its $L^2$-norm $\\|[\\![\\sigma(u_h)n_e]\\!]\\|_{0,e}$.\n\n4) Let the element size parameter be $h_K$ defined as the length of the longest edge of $K$. Form the dimensionless ratio\n$$\nR \\;=\\; \\frac{h_K^{1/2}\\,\\|f+\\nabla\\cdot\\sigma(u_h)\\|_{0,K}}{\\|[\\![\\sigma(u_h)n_e]\\!]\\|_{0,e}}.\n$$\nCompute $R$ and round your final answer to four significant figures. Express $R$ as a dimensionless pure number.\n\n5) Briefly explain, based on your computed values and the physical setting of a layered soil under vertical loading, how the element residual and the jump residual would each drive mesh refinement in an adaptive algorithm.\n\nNote: Use International System of Units (SI) consistently. The final reported answer must be only the single rounded value of $R$ as a dimensionless number.", "solution": "The problem statement is critically validated before attempting a solution.\n\n### Step 1: Extract Givens\n-   **Elements**: Two adjacent linear triangular finite elements, $K$ (top) and $K'$ (bottom), in a 2D plane strain model.\n-   **Geometry**:\n    -   Shared edge $e$ is horizontal, from $(0, -1)$ to $(2, -1)$.\n    -   Unit normal on $e$ from $K$ to $K'$ is $n_e = (0, -1)^{\\mathsf{T}}$.\n    -   Vertices of $K$: $x_1=(0, -1)$, $x_2=(2, -1)$, $x_3=(0, 0)$.\n    -   Vertices of $K'$: $x_1'=(0, -1)$, $x_2'=(2, -1)$, $x_3'=(0, -2)$.\n-   **Displacement Field ($u_h$)**: Conforming piecewise-linear field with nodal values (in meters):\n    -   On $K$: $u_h(x_1)=(-1.0\\times 10^{-4}, -5.0\\times 10^{-4})$, $u_h(x_2)=(-1.2\\times 10^{-4}, -5.0\\times 10^{-4})$, $u_h(x_3)=(-0.8\\times 10^{-4}, 0)$.\n    -   On $K'$: $u_h(x_1')=(-1.0\\times 10^{-4}, -5.0\\times 10^{-4})$, $u_h(x_2')=(-1.2\\times 10^{-4}, -5.0\\times 10^{-4})$, $u_h(x_3')=(-1.3\\times 10^{-4}, -1.2\\times 10^{-3})$.\n-   **Material Properties**:\n    -   Layer $K$: Young’s modulus $E_1=5.0\\times 10^{7}$ Pa, Poisson’s ratio $\\nu_1=0.3$.\n    -   Layer $K'$: Young’s modulus $E_2=1.5\\times 10^{8}$ Pa, Poisson’s ratio $\\nu_2=0.25$.\n-   **Constitutive Law**: Plane strain linear elasticity, $\\sigma(u_h)=2\\mu\\,\\varepsilon(u_h)+\\lambda\\,\\mathrm{tr}(\\varepsilon(u_h))\\,I$, with strain $\\varepsilon(u_h)=\\tfrac{1}{2}\\left(\\nabla u_h+(\\nabla u_h)^{\\mathsf{T}}\\right)$ and Lamé parameters $\\mu=\\dfrac{E}{2(1+\\nu)}$, $\\lambda=\\dfrac{E\\nu}{(1+\\nu)(1-2\\nu)}$.\n-   **Body Force**: On $K$, $f=(0, -\\rho_1 g)^{\\mathsf{T}}$ with $\\rho_1=1800$ kg/m$^3$ and $g=9.81$ m/s$^2$.\n-   **Residual Definitions**:\n    -   Element residual on $K$: $\\|f+\\nabla\\cdot\\sigma(u_h)\\|_{0,K}$.\n    -   Jump residual on $e$: $\\|[\\![\\sigma(u_h)n_e]\\!]\\|_{0,e}$, where $[\\![\\sigma(u_h)n_e]\\!]=\\left(\\sigma(u_h)\\big|_{K}-\\sigma(u_h)\\big|_{K'}\\right)n_e$.\n-   **Task**: Compute the dimensionless ratio $R = \\frac{h_K^{1/2}\\,\\|f+\\nabla\\cdot\\sigma(u_h)\\|_{0,K}}{\\|[\\![\\sigma(u_h)n_e]\\!]\\|_{0,e}}$, where $h_K$ is the length of the longest edge of $K$.\n\n### Step 2: Validate Using Extracted Givens\n-   **Scientific Grounding**: The problem is well-grounded in the theory of linear elasticity and the finite element method, specifically using concepts of *a posteriori* error estimation in computational mechanics. The values for material properties and loads are physically realistic for a geomechanics context.\n-   **Well-Posed**: The problem is a sequence of direct calculations based on provided data and standard formulas from FEM. All necessary information is present to compute a unique numerical value for $R$.\n-   **Objective**: The problem is stated using precise, objective, and standard technical terminology.\n-   **Consistency and Completeness**: The geometric data for the elements are consistent. The displacement field is checked for continuity at the shared nodes $x_1$ and $x_2$, and the values match, confirming conformity as stated. All required constants and definitions are provided. The problem is self-contained.\n-   **Other Flaws**: The problem does not exhibit any other flaws like being trivial, metaphorical, or scientifically unverifiable.\n\n### Step 3: Verdict and Action\nThe problem is valid. A full solution is warranted.\n\n### Solution\nThe solution proceeds by following the five tasks outlined in the problem statement. All calculations are performed in SI units.\n\n**1) Computation of displacement gradient, strain, and stress on each element.**\n\nFor a linear triangular element, the gradient of the piecewise-linear displacement field $u_h$ is constant. The components of the gradient tensor, $\\nabla u_h$, can be computed using the formula $\\frac{\\partial u_\\alpha}{\\partial x_\\beta} = \\frac{1}{2A} \\sum_{i=1}^3 c_{i\\beta} u_{i\\alpha}$, where $A$ is the element area and the coefficients are derived from the nodal coordinates. For a more direct method, we use the standard formulation where the gradient components are $\\partial_x u_k = \\frac{1}{2A}\\sum_i b_i u_{ik}$ and $\\partial_y u_k = \\frac{1}{2A}\\sum_i c_i u_{ik}$, with $k \\in \\{x,y\\}$, $b_i = y_j - y_k$, and $c_i = x_k - x_j$ for nodes $(i, j, k)$ in cyclic order.\n\n_On element $K$ (vertices $x_1=(0,-1)$, $x_2=(2,-1)$, $x_3=(0,0)$):_\nThe area is $A_K = \\frac{1}{2} |(x_2-x_1)(y_3-y_1) - (x_3-x_1)(y_2-y_1)| = \\frac{1}{2} |(2)(1) - (0)(0)| = 1$.\nThe coefficients are:\n$b_1 = y_2 - y_3 = -1 - 0 = -1$, $c_1 = x_3 - x_2 = 0 - 2 = -2$.\n$b_2 = y_3 - y_1 = 0 - (-1) = 1$, $c_2 = x_1 - x_3 = 0 - 0 = 0$.\n$b_3 = y_1 - y_2 = -1 - (-1) = 0$, $c_3 = x_2 - x_1 = 2 - 0 = 2$.\nNodal displacements are $u_1=(-1, -5) \\times 10^{-4}$, $u_2=(-1.2, -5) \\times 10^{-4}$, $u_3=(-0.8, 0) \\times 10^{-4}$.\n\n$\\partial_x u_{h,x} = \\frac{1}{2(1)}[(-1)(-1.0) + (1)(-1.2) + (0)(-0.8)]\\times 10^{-4} = -0.1 \\times 10^{-4}$.\n$\\partial_y u_{h,x} = \\frac{1}{2(1)}[(-2)(-1.0) + (0)(-1.2) + (2)(-0.8)]\\times 10^{-4} = 0.2 \\times 10^{-4}$.\n$\\partial_x u_{h,y} = \\frac{1}{2(1)}[(-1)(-5.0) + (1)(-5.0) + (0)(0)]\\times 10^{-4} = 0$.\n$\\partial_y u_{h,y} = \\frac{1}{2(1)}[(-2)(-5.0) + (0)(-5.0) + (2)(0)]\\times 10^{-4} = 5.0 \\times 10^{-4}$.\nSo, $(\\nabla u_h)_K = \\begin{pmatrix} -0.1 & 0.2 \\\\ 0 & 5.0 \\end{pmatrix} \\times 10^{-4}$.\n\nThe strain tensor is $\\varepsilon_K = \\frac{1}{2}((\\nabla u_h)_K + (\\nabla u_h)_K^{\\mathsf{T}}) = \\begin{pmatrix} -0.1 & 0.1 \\\\ 0.1 & 5.0 \\end{pmatrix} \\times 10^{-4}$.\nThe trace is $\\mathrm{tr}(\\varepsilon_K) = (-0.1 + 5.0) \\times 10^{-4} = 4.9 \\times 10^{-4}$.\nMaterial properties for $K$: $E_1=5.0\\times 10^{7}$, $\\nu_1=0.3$.\n$\\mu_1 = \\frac{5.0 \\times 10^7}{2(1+0.3)} = \\frac{25}{13}\\times 10^7$.\n$\\lambda_1 = \\frac{(5.0 \\times 10^7)(0.3)}{(1+0.3)(1-2 \\times 0.3)} = \\frac{75}{26}\\times 10^7$.\nThe stress tensor is $\\sigma_K = 2\\mu_1\\varepsilon_K + \\lambda_1\\mathrm{tr}(\\varepsilon_K)I$:\n$\\sigma_{xx,K} = 2(\\frac{25}{13}\\times 10^7)(-0.1\\times 10^{-4}) + (\\frac{75}{26}\\times 10^7)(4.9\\times 10^{-4}) = 13750$ Pa.\n$\\sigma_{yy,K} = 2(\\frac{25}{13}\\times 10^7)(5.0\\times 10^{-4}) + (\\frac{75}{26}\\times 10^7)(4.9\\times 10^{-4}) = \\frac{867500}{26} \\approx 33365.38$ Pa.\n$\\sigma_{xy,K} = 2(\\frac{25}{13}\\times 10^7)(0.1\\times 10^{-4}) = \\frac{5000}{13} \\approx 384.62$ Pa.\nThus, $\\sigma_K \\approx \\begin{pmatrix} 13750 & 384.62 \\\\ 384.62 & 33365.38 \\end{pmatrix}$ Pa.\n\n_On element $K'$ (vertices $x_1'=(0,-1)$, $x_2'=(2,-1)$, $x_3'=(0,-2)$):_\nThe area is $A_{K'} = \\frac{1}{2} |(2)(-1) - (0)(0)| = 1$.\nThe coefficients are:\n$b_1' = y_2' - y_3' = -1 - (-2) = 1$, $c_1' = x_3' - x_2' = 0 - 2 = -2$.\n$b_2' = y_3' - y_1' = -2 - (-1) = -1$, $c_2' = x_1' - x_3' = 0 - 0 = 0$.\n$b_3' = y_1' - y_2' = -1 - (-1) = 0$, $c_3' = x_2' - x_1' = 2 - 0 = 2$.\nNodal displacements $u_1'=(-1, -5) \\times 10^{-4}$, $u_2'=(-1.2, -5) \\times 10^{-4}$, $u_3'=(-1.3, -12) \\times 10^{-4}$.\n$(\\nabla u_h)_{K'} = \\begin{pmatrix} 0.1 & -0.3 \\\\ 0 & -7.0 \\end{pmatrix} \\times 10^{-4}$.\n\nThe strain tensor is $\\varepsilon_{K'} = \\begin{pmatrix} 0.1 & -0.15 \\\\ -0.15 & -7.0 \\end{pmatrix} \\times 10^{-4}$.\nThe trace is $\\mathrm{tr}(\\varepsilon_{K'}) = (0.1 - 7.0) \\times 10^{-4} = -6.9 \\times 10^{-4}$.\nMaterial properties for $K'$: $E_2=1.5\\times 10^8$, $\\nu_2=0.25$.\n$\\mu_2 = \\frac{1.5 \\times 10^8}{2(1+0.25)} = 6.0\\times 10^7$.\n$\\lambda_2 = \\frac{(1.5 \\times 10^8)(0.25)}{(1+0.25)(1-2 \\times 0.25)} = 6.0\\times 10^7$.\nThe stress tensor is $\\sigma_{K'} = 2\\mu_2\\varepsilon_{K'} + \\lambda_2\\mathrm{tr}(\\varepsilon_{K'})I$:\n$\\sigma_{xx,K'} = 2(6\\times 10^7)(0.1\\times 10^{-4}) + (6\\times 10^7)(-6.9\\times 10^{-4}) = -40200$ Pa.\n$\\sigma_{yy,K'} = 2(6\\times 10^7)(-7.0\\times 10^{-4}) + (6\\times 10^7)(-6.9\\times 10^{-4}) = -125400$ Pa.\n$\\sigma_{xy,K'} = 2(6\\times 10^7)(-0.15\\times 10^{-4}) = -1800$ Pa.\nThus, $\\sigma_{K'} = \\begin{pmatrix} -40200 & -1800 \\\\ -1800 & -125400 \\end{pmatrix}$ Pa.\n\n**2) Computation of the element residual norm on $K$.**\nThe element residual is $r_K = f + \\nabla \\cdot \\sigma(u_h)$. For a linear triangular element, the computed stress tensor $\\sigma(u_h)$ is constant throughout the element. Therefore, its divergence is zero: $\\nabla \\cdot \\sigma(u_h) = 0$. The residual reduces to the body force term, $r_K = f$.\nThe body force is $f = (0, -\\rho_1 g)^{\\mathsf{T}} = (0, -1800 \\times 9.81)^{\\mathsf{T}} = (0, -17658)^{\\mathsf{T}}$ N/m$^3$.\nThe $L^2$-norm of the residual is $\\|f+\\nabla\\cdot\\sigma(u_h)\\|_{0,K} = \\|f\\|_{0,K} = \\left(\\int_K |f|^2 dA\\right)^{1/2}$.\nSince $f$ is constant, this simplifies to $|f| \\sqrt{A_K}$.\n$\\|f\\|_{0,K} = \\sqrt{0^2 + (-17658)^2} \\times \\sqrt{1} = 17658$. The units are N/m$^2$.\n\n**3) Computation of the jump residual norm on $e$.**\nThe jump vector is $J = [\\![\\sigma(u_h)n_e]\\!] = (\\sigma_K - \\sigma_{K'})n_e$. The normal vector is $n_e = (0, -1)^{\\mathsf{T}}$.\nFirst, we find the difference in stress tensors:\n$\\Delta\\sigma = \\sigma_K - \\sigma_{K'} = \\begin{pmatrix} 13750 - (-40200) & \\frac{5000}{13} - (-1800) \\\\ \\frac{5000}{13} - (-1800) & \\frac{867500}{26} - (-125400) \\end{pmatrix} = \\begin{pmatrix} 53950 & \\frac{28400}{13} \\\\ \\frac{28400}{13} & \\frac{2063950}{13} \\end{pmatrix}$ Pa.\nThe jump vector is $J = \\Delta\\sigma n_e = \\begin{pmatrix} 53950 & \\frac{28400}{13} \\\\ \\frac{28400}{13} & \\frac{2063950}{13} \\end{pmatrix} \\begin{pmatrix} 0 \\\\ -1 \\end{pmatrix} = \\begin{pmatrix} -\\frac{28400}{13} \\\\ -\\frac{2063950}{13} \\end{pmatrix}$ Pa.\n$J \\approx (-2184.62, -158765.38)^{\\mathsf{T}}$ Pa.\nThe $L^2$-norm is $\\|J\\|_{0,e} = \\left(\\int_e |J|^2 ds\\right)^{1/2}$. Since $J$ is constant along edge $e$, this becomes $|J|\\sqrt{L_e}$, where $L_e$ is the length of $e$.\nThe edge $e$ connects $(0, -1)$ and $(2, -1)$, so its length is $L_e = 2$ m.\n$|J|^2 = \\left(-\\frac{28400}{13}\\right)^2 + \\left(-\\frac{2063950}{13}\\right)^2 = \\frac{1}{169}(28400^2 + 2063950^2) = \\frac{4260878582500}{169}$.\n$\\|J\\|_{0,e} = \\sqrt{2 \\times \\frac{4260878582500}{169}} = \\frac{\\sqrt{8521757165000}}{13} \\approx 224553.8$. The units are N/m$^{3/2}$.\n\n**4) Computation of the dimensionless ratio $R$.**\nThe ratio is $R = \\frac{h_K^{1/2}\\,\\|f+\\nabla\\cdot\\sigma(u_h)\\|_{0,K}}{\\|[\\![\\sigma(u_h)n_e]\\!]\\|_{0,e}}$.\nFirst, determine $h_K$, the length of the longest edge of $K$. The edge lengths of $K$ are:\n$L_{12} = \\sqrt{(2-0)^2 + (-1-(-1))^2} = 2$.\n$L_{23} = \\sqrt{(0-2)^2 + (0-(-1))^2} = \\sqrt{4+1} = \\sqrt{5}$.\n$L_{31} = \\sqrt{(0-0)^2 + (-1-0)^2} = 1$.\nThe longest edge is $h_K = \\sqrt{5}$ m.\nNow, we compute $R$:\n$R = \\frac{(\\sqrt{5})^{1/2} \\times 17658}{224553.8} = \\frac{5^{1/4} \\times 17658}{224553.8}$.\n$5^{1/4} \\approx 1.49534878$.\n$R \\approx \\frac{1.49534878 \\times 17658}{224553.8} \\approx \\frac{26405.303}{224553.8} \\approx 0.1175908$.\nRounding to four significant figures gives $R=0.1176$.\n\n**5) Physical interpretation for adaptive mesh refinement.**\nThe two residuals quantify different aspects of the error in the numerical solution.\nThe **element residual**, $\\|f+\\nabla\\cdot\\sigma(u_h)\\|_{0,K}$, measures the failure to satisfy equilibrium within an element. For linear elements, this term simplifies to $\\|f\\|_{0,K}$, indicating that constant stress cannot balance a non-zero body force. This residual drives mesh refinement in regions where forcing terms necessitate a more complex (e.g., non-constant) stress field.\nThe **jump residual**, $\\|[\\![\\sigma(u_h)n_e]\\!]\\|_{0,e}$, measures the violation of traction continuity across element boundaries, which is a requirement of equilibrium (Newton's third law). A large jump indicates a large, unphysical force imbalance between adjacent elements. This is often the dominant error source at material interfaces, where stiffness discontinuities cause sharp stress gradients that are poorly approximated by the piecewise-polynomial stress field.\nIn this problem, the ratio $R \\approx 0.1176$ is small, indicating that the jump residual term is significantly larger than the element residual term when appropriately scaled. This implies that the primary source of error is the large traction imbalance across the material interface, rather than the inability to balance self-weight within the element. An adaptive algorithm would therefore prioritize refining the mesh along the boundary between the two soil layers (edge $e$) to better resolve the stress concentration at the interface.", "answer": "$$\\boxed{0.1176}$$", "id": "3499439"}, {"introduction": "Building upon the calculation of residuals, we now turn to the concept of equilibrated stress reconstructions, which are central to some of the most reliable error estimators. This exercise [@problem_id:3499358] guides you through solving a local \"patch problem\" to determine an unknown traction on an internal edge by enforcing the principle of static equilibrium. This practice demonstrates how fundamental physical laws, applied at the element level, are used to construct the statically admissible stress fields that form the basis of advanced, robust error estimation techniques.", "problem": "Consider a plane-strain geomechanics benchmark in which an equilibrated stress reconstruction is used to drive adaptive mesh refinement via an error estimator. The objective is to recover a stress field $\\hat{\\sigma}_{h}$ that is globally equilibrated and lies in the Sobolev space of square-integrable divergence, $\\mathrm{H}(\\mathrm{div})$, by enforcing continuity of the edge traction vector $\\hat{\\sigma}_{h}\\boldsymbol{n}$ across internal edges and incorporating the given traction boundary data.\n\nStart from the strong form of static equilibrium for a linear elastic body with negligible inertia,\n$$\n\\nabla \\cdot \\sigma + \\boldsymbol{f} = \\boldsymbol{0} \\quad \\text{in } \\Omega, \\qquad \\sigma \\boldsymbol{n} = \\boldsymbol{t} \\quad \\text{on } \\Gamma_{t},\n$$\nwhere $\\Omega \\subset \\mathbb{R}^{2}$ is the domain, $\\sigma$ is the Cauchy stress tensor, $\\boldsymbol{f}$ is the body force per unit volume, $\\Gamma_{t} \\subset \\partial \\Omega$ is the traction boundary, and $\\boldsymbol{n}$ is the outward unit normal to the boundary.\n\nYou are given the domain $\\Omega = (0,1) \\times (0,1)$ discretized into two triangular finite elements by the diagonal from $(0,0)$ to $(1,1)$. Denote the elements by $K_{1}$ with vertices $\\{(0,0),(1,0),(1,1)\\}$ and $K_{2}$ with vertices $\\{(0,0),(0,1),(1,1)\\}$. The internal edge is $E_{d}$ between $(0,0)$ and $(1,1)$, of length $|E_{d}|=\\sqrt{2}$. Let the outward unit normals for $K_{1}$ be $\\boldsymbol{n}_{r}=(1,0)$ on the right edge, $\\boldsymbol{n}_{b}=(0,-1)$ on the bottom edge, and $\\boldsymbol{n}_{d}^{(1)}=\\frac{1}{\\sqrt{2}}(-1,1)$ on the diagonal. For $K_{2}$, let the outward unit normals be $\\boldsymbol{n}_{l}=(-1,0)$ on the left edge, $\\boldsymbol{n}_{t}=(0,1)$ on the top edge, and $\\boldsymbol{n}_{d}^{(2)}=\\frac{1}{\\sqrt{2}}(1,-1)$ on the diagonal. Assume zero body force, $\\boldsymbol{f}=\\boldsymbol{0}$.\n\nThe traction boundary data are prescribed as follows: on the right boundary, $\\boldsymbol{t}=(T,0)$; on the left boundary, $\\boldsymbol{t}=(-T,0)$; on the top and bottom boundaries, $\\boldsymbol{t}=\\boldsymbol{0}$. These data satisfy global equilibrium of the boundary loads. The stress reconstruction targets a piecewise constant, symmetric tensor $\\hat{\\sigma}_{h}$ over each element that is equilibrated and enforces continuity of the edge traction vector $\\hat{\\sigma}_{h}\\boldsymbol{n}$ across the internal edge $E_{d}$.\n\nFormulate the local patch problems on each element $K$ by imposing the element-level equilibrium\n$$\n\\int_{\\partial K} \\hat{\\sigma}_{h}\\boldsymbol{n}\\, \\mathrm{d}s = \\boldsymbol{0},\n$$\nand the edge traction constraints\n$$\n\\hat{\\sigma}_{h}\\boldsymbol{n} = \\boldsymbol{q}_{E} \\quad \\text{constant on each edge } E \\subset \\partial K,\n$$\nwith $\\boldsymbol{q}_{E}$ single-valued on internal edges (ensuring continuity of $\\hat{\\sigma}_{h}\\boldsymbol{n}$ across $E$) and equal to the given boundary traction $\\boldsymbol{t}$ on boundary edges. For the specific mesh and load described above, determine the unique constant vector $\\boldsymbol{q}_{d}$ associated to the internal diagonal edge $E_{d}$ that enforces global equilibrium and continuity of $\\hat{\\sigma}_{h}\\boldsymbol{n}$ across $E_{d}$. Express your final answer for $\\boldsymbol{q}_{d}$ in terms of $T$.\n\nYour final answer must be a single analytical expression and should be given as a row vector. No rounding is required. Do not include units in your final expression.", "solution": "The user has provided a valid problem statement from the field of computational geomechanics. The problem is scientifically grounded, well-posed, objective, and contains sufficient information to determine a unique solution. I will proceed with a detailed derivation.\n\nThe governing principle for the local patch problem on each element $K$ is the integral form of static equilibrium with zero body forces, $\\boldsymbol{f}=\\boldsymbol{0}$. Given that the reconstructed stress tensor $\\hat{\\sigma}_{h}$ is constant within each element, the condition $\\nabla \\cdot \\hat{\\sigma}_h = \\boldsymbol{0}$ is trivially satisfied inside the element. The equilibrium constraint is expressed over the element boundary $\\partial K$ as:\n$$\n\\int_{\\partial K} \\hat{\\sigma}_{h}\\boldsymbol{n}\\, \\mathrm{d}s = \\boldsymbol{0}\n$$\nwhere $\\boldsymbol{n}$ is the outward unit normal to the boundary of the element. The problem states that the traction vector $\\hat{\\sigma}_{h}\\boldsymbol{n}$ is constant on each edge $E \\subset \\partial K$, denoted by $\\boldsymbol{q}_{E}$. Thus, the integral equilibrium equation simplifies to an algebraic sum over the edges of the element:\n$$\n\\sum_{E \\subset \\partial K} \\boldsymbol{q}_{E} |E| = \\boldsymbol{0}\n$$\nwhere $|E|$ is the length of edge $E$.\n\nThe domain $\\Omega = (0,1) \\times (0,1)$ is divided into two triangular elements: $K_{1}$ with vertices $\\{(0,0),(1,0),(1,1)\\}$ and $K_{2}$ with vertices $\\{(0,0),(0,1),(1,1)\\}$. The internal edge $E_d$ is the diagonal connecting $(0,0)$ and $(1,1)$, with length $|E_d| = \\sqrt{(1-0)^2 + (1-0)^2} = \\sqrt{2}$. The external edges of the domain are of length $1$.\n\nThe problem requires determining the unique traction vector $\\boldsymbol{q}_d$ on the internal edge $E_d$ that satisfies equilibrium. According to Newton's third law (action-reaction), the traction across this shared edge must be equal and opposite for the two adjacent elements. Let's define $\\boldsymbol{q}_d$ as the traction vector associated with edge $E_d$ when considering the equilibrium of element $K_2$. The contribution to the equilibrium sum for $K_2$ is $\\boldsymbol{q}_d |E_d|$. Consequently, the contribution to the equilibrium sum for element $K_1$ from the same edge is $-\\boldsymbol{q}_d |E_d|$.\n\nNow, we can apply the algebraic equilibrium equation to either element to solve for $\\boldsymbol{q}_d$.\n\nLet's consider element $K_{2}$ (vertices $\\{(0,0),(0,1),(1,1)\\}$). Its boundary consists of the left edge ($E_l$), the top edge ($E_t$), and the diagonal edge ($E_d$).\nThe lengths of the edges are $|E_l|=1$, $|E_t|=1$, and $|E_d|=\\sqrt{2}$.\nThe tractions on the external edges are given by the boundary data:\n- On the left edge: $\\boldsymbol{q}_{l} = \\boldsymbol{t} = (-T,0)$.\n- On the top edge: $\\boldsymbol{q}_{t} = \\boldsymbol{t} = \\boldsymbol{0} = (0,0)$.\nThe traction on the internal edge $E_d$ is $\\boldsymbol{q}_d$.\n\nThe equilibrium equation for $K_2$ is:\n$$\n\\boldsymbol{q}_{l}|E_l| + \\boldsymbol{q}_{t}|E_t| + \\boldsymbol{q}_{d}|E_d| = \\boldsymbol{0}\n$$\nSubstituting the known values:\n$$\n(-T,0) \\cdot 1 + (0,0) \\cdot 1 + \\boldsymbol{q}_{d} \\cdot \\sqrt{2} = \\boldsymbol{0}\n$$\n$$\n(-T,0) + \\sqrt{2}\\boldsymbol{q}_{d} = \\boldsymbol{0}\n$$\nSolving for $\\boldsymbol{q}_{d}$:\n$$\n\\sqrt{2}\\boldsymbol{q}_{d} = (T,0)\n$$\n$$\n\\boldsymbol{q}_{d} = \\left(\\frac{T}{\\sqrt{2}}, 0\\right)\n$$\n\nTo verify the consistency of our interpretation, we can perform the same calculation for element $K_1$ (vertices $\\{(0,0),(1,0),(1,1)\\}$). Its boundary consists of the bottom edge ($E_b$), the right edge ($E_r$), and the diagonal edge ($E_d$).\nThe lengths are $|E_b|=1$, $|E_r|=1$, and $|E_d|=\\sqrt{2}$.\nThe tractions on the external edges are:\n- On the bottom edge: $\\boldsymbol{q}_{b} = \\boldsymbol{t} = \\boldsymbol{0} = (0,0)$.\n- On the right edge: $\\boldsymbol{q}_{r} = \\boldsymbol{t} = (T,0)$.\nThe traction on the internal edge $E_d$ for $K_1$ is $-\\boldsymbol{q}_d$.\n\nThe equilibrium equation for $K_1$ is:\n$$\n\\boldsymbol{q}_{b}|E_b| + \\boldsymbol{q}_{r}|E_r| + (-\\boldsymbol{q}_{d})|E_d| = \\boldsymbol{0}\n$$\nSubstituting the known values:\n$$\n(0,0) \\cdot 1 + (T,0) \\cdot 1 - \\boldsymbol{q}_{d}\\sqrt{2} = \\boldsymbol{0}\n$$\n$$\n(T,0) - \\sqrt{2}\\boldsymbol{q}_{d} = \\boldsymbol{0}\n$$\nSolving for $\\boldsymbol{q}_{d}$:\n$$\n\\sqrt{2}\\boldsymbol{q}_{d} = (T,0)\n$$\n$$\n\\boldsymbol{q}_{d} = \\left(\\frac{T}{\\sqrt{2}}, 0\\right)\n$$\nBoth calculations yield the same unique vector for $\\boldsymbol{q}_d$, which confirms that the problem is well-posed and our interpretation is correct. The unique constant vector associated with the internal diagonal edge is $\\boldsymbol{q}_d = (\\frac{T}{\\sqrt{2}}, 0)$.\n\nThe final answer is requested as a row vector.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{T}{\\sqrt{2}} & 0\n\\end{pmatrix}\n}\n$$", "id": "3499358"}, {"introduction": "Our final practice delves into a more advanced and powerful method for quantifying error by measuring it directly in the energy, or compliance, norm. This problem [@problem_id:3499389] asks you to derive and apply an equilibrated a posteriori error estimator, connecting the error in the stress field to a physically meaningful energy measure. The exercise culminates in explaining a crucial advantage of this approach: its robustness in the nearly incompressible limit (as Poisson's ratio approaches $0.5$), a common and numerically challenging scenario in geomechanical modeling of undrained soils and rocks.", "problem": "Consider the quasi-static small-strain linear elasticity problem in two spatial dimensions for a porous geomaterial under plane strain on a convex polygonal domain $\\Omega \\subset \\mathbb{R}^{2}$ with boundary $\\partial \\Omega$. Let the body force be $\\boldsymbol{b} = \\boldsymbol{0}$ and the boundary traction be $\\boldsymbol{g}=\\boldsymbol{0}$. The strong form of equilibrium is given by $\\nabla \\cdot \\boldsymbol{\\sigma} + \\boldsymbol{b} = \\boldsymbol{0}$ in $\\Omega$ and $\\boldsymbol{\\sigma}\\boldsymbol{n} = \\boldsymbol{g}$ on $\\partial \\Omega$, where $\\boldsymbol{\\sigma}$ is the Cauchy stress tensor and $\\boldsymbol{n}$ is the outward unit normal on $\\partial \\Omega$. The constitutive relation is the isotropic law $\\boldsymbol{\\sigma} = 2\\mu \\boldsymbol{\\varepsilon}(\\boldsymbol{u}) + \\lambda \\operatorname{tr}(\\boldsymbol{\\varepsilon}(\\boldsymbol{u})) \\boldsymbol{I}$, with Lamé parameters $\\lambda > 0$, $\\mu > 0$, displacement $\\boldsymbol{u}$, strain $\\boldsymbol{\\varepsilon}(\\boldsymbol{u}) = \\frac{1}{2}\\left(\\nabla \\boldsymbol{u} + (\\nabla \\boldsymbol{u})^{\\top}\\right)$, identity tensor $\\boldsymbol{I}$, and $\\operatorname{tr}(\\cdot)$ denoting the trace. Assume unit thickness.\n\nA Hybridized $H(\\operatorname{div})$-conforming stress-displacement formulation yields a discrete stress field $\\boldsymbol{\\sigma}_{h}$ in a symmetric tensor-valued $H(\\operatorname{div})$ space and hybridized displacement unknowns on the mesh skeleton. An equilibrated a posteriori estimator seeks a reconstructed stress $\\boldsymbol{\\sigma}^{\\star}$ that is statically admissible (elementwise divergence-free with the given body force and with normal continuity of the traction across interfaces) and measures the stress error using the material compliance.\n\nStarting from the equilibrium law and the compliance operator for isotropic linear elasticity, derive an equilibrated a posteriori error estimator that:\n- uses a stress reconstruction $\\boldsymbol{\\sigma}^{\\star}$ satisfying $\\nabla \\cdot \\boldsymbol{\\sigma}^{\\star} + \\boldsymbol{b} = \\boldsymbol{0}$ in each element and continuous normal traction $\\boldsymbol{\\sigma}^{\\star}\\boldsymbol{n}$ across interior faces,\n- measures the error in the compliance norm through the double contraction $\\boldsymbol{\\tau} : \\boldsymbol{\\eta} = \\sum_{i,j} \\tau_{ij} \\eta_{ij}$.\n\nThen, for the following specific two-triangle mesh on the square domain $\\Omega = (0,1) \\times (0,1)$ partitioned by the diagonal from $(0,0)$ to $(1,1)$ (thus two elements $K_{1}$ and $K_{2}$ of area $|K_{1}|=|K_{2}|=\\frac{1}{2}$), with the discrete stress field\n$$\n\\boldsymbol{\\sigma}_{h}\\big|_{K_{1}} =\n\\begin{pmatrix}\n2.0 \\times 10^{6} & 1.0 \\times 10^{6} \\\\\n1.0 \\times 10^{6} & 0\n\\end{pmatrix},\\qquad\n\\boldsymbol{\\sigma}_{h}\\big|_{K_{2}} =\n\\begin{pmatrix}\n1.5 \\times 10^{6} & 0.8 \\times 10^{6} \\\\\n0.8 \\times 10^{6} & 0.2 \\times 10^{6}\n\\end{pmatrix},\n$$\nchoose the equilibrated reconstruction $\\boldsymbol{\\sigma}^{\\star}=\\boldsymbol{0}$ (which satisfies $\\nabla \\cdot \\boldsymbol{\\sigma}^{\\star}=\\boldsymbol{0}$ and $\\boldsymbol{\\sigma}^{\\star}\\boldsymbol{n}=\\boldsymbol{0}$). Assume Lamé parameters $\\mu = 1.0 \\times 10^{8}$ and $\\lambda = 1.0 \\times 10^{10}$, and use the standard Frobenius double contraction and tensor decomposition into deviatoric and volumetric parts in two dimensions.\n\nExpress the squared equilibrated estimator as\n$$\n\\eta^{2} = \\sum_{K \\in \\{K_{1},K_{2}\\}} \\int_{K} \\left(\\boldsymbol{\\sigma}_{h} - \\boldsymbol{\\sigma}^{\\star}\\right) : \\boldsymbol{S} : \\left(\\boldsymbol{\\sigma}_{h} - \\boldsymbol{\\sigma}^{\\star}\\right)\\, \\mathrm{d}x,\n$$\nwhere $\\boldsymbol{S}$ is the compliance tensor. Compute the numerical value of $\\eta^{2}$ for the given data. Round your final numerical value of $\\eta^{2}$ to four significant figures. Express the final result in Joules.\n\nFinally, explain, based on your derivation, why such a stress-equilibrated estimator has advantages over displacement-based residual estimators in the limit of incompressibility (large $\\lambda$), with reference to how the compliance separates deviatoric and volumetric contributions and how normal traction continuity contributes to robustness.\n\nNote: Use $n=2$ (two-dimensional) in all trace and deviatoric decompositions, i.e., $\\operatorname{dev}(\\boldsymbol{\\sigma}) = \\boldsymbol{\\sigma} - \\frac{1}{2}\\operatorname{tr}(\\boldsymbol{\\sigma}) \\boldsymbol{I}$, and the compliance mapping $\\boldsymbol{\\varepsilon} = \\boldsymbol{S} : \\boldsymbol{\\sigma}$ appropriate to isotropic linear elasticity in two dimensions. Use unit thickness throughout.", "solution": "The problem is first validated against the specified criteria.\n\n**Step 1: Extraction of Givens**\n- **Problem:** Quasi-static small-strain linear elasticity in two spatial dimensions ($2$D) under plane strain.\n- **Domain:** Convex polygonal domain $\\Omega \\subset \\mathbb{R}^{2}$ with boundary $\\partial \\Omega$.\n- **Loading:** Body force $\\boldsymbol{b} = \\boldsymbol{0}$, boundary traction $\\boldsymbol{g} = \\boldsymbol{0}$.\n- **Equilibrium:** $\\nabla \\cdot \\boldsymbol{\\sigma} + \\boldsymbol{b} = \\boldsymbol{0}$ in $\\Omega$ and $\\boldsymbol{\\sigma}\\boldsymbol{n} = \\boldsymbol{g}$ on $\\partial \\Omega$.\n- **Constitutive Law:** $\\boldsymbol{\\sigma} = 2\\mu \\boldsymbol{\\varepsilon}(\\boldsymbol{u}) + \\lambda \\operatorname{tr}(\\boldsymbol{\\varepsilon}(\\boldsymbol{u})) \\boldsymbol{I}$, with Lamé parameters $\\lambda > 0$, $\\mu > 0$.\n- **Kinematics:** $\\boldsymbol{\\varepsilon}(\\boldsymbol{u}) = \\frac{1}{2}\\left(\\nabla \\boldsymbol{u} + (\\nabla \\boldsymbol{u})^{\\top}\\right)$.\n- **Estimator:** Equilibrated a posteriori estimator for stress error measured in the compliance norm.\n- **Reconstructed Stress:** $\\boldsymbol{\\sigma}^{\\star}$ satisfies $\\nabla \\cdot \\boldsymbol{\\sigma}^{\\star} + \\boldsymbol{b} = \\boldsymbol{0}$ in each element and continuous normal traction $\\boldsymbol{\\sigma}^{\\star}\\boldsymbol{n}$ across interior faces.\n- **Error Estimator Formula:** $\\eta^{2} = \\sum_{K} \\int_{K} \\left(\\boldsymbol{\\sigma}_{h} - \\boldsymbol{\\sigma}^{\\star}\\right) : \\boldsymbol{S} : \\left(\\boldsymbol{\\sigma}_{h} - \\boldsymbol{\\sigma}^{\\star}\\right)\\, \\mathrm{d}x$.\n- **Specific Geometry:** Domain $\\Omega = (0,1) \\times (0,1)$, partitioned into two triangles $K_{1}$ and $K_{2}$ by the diagonal from $(0,0)$ to $(1,1)$. Area $|K_{1}|=|K_{2}|=\\frac{1}{2}$.\n- **Discrete Stress Field:**\n$$\n\\boldsymbol{\\sigma}_{h}\\big|_{K_{1}} =\n\\begin{pmatrix}\n2.0 \\times 10^{6} & 1.0 \\times 10^{6} \\\\\n1.0 \\times 10^{6} & 0\n\\end{pmatrix},\\qquad\n\\boldsymbol{\\sigma}_{h}\\big|_{K_{2}} =\n\\begin{pmatrix}\n1.5 \\times 10^{6} & 0.8 \\times 10^{6} \\\\\n0.8 \\times 10^{6} & 0.2 \\times 10^{6}\n\\end{pmatrix}\n$$\n- **Specific Reconstructed Stress:** $\\boldsymbol{\\sigma}^{\\star} = \\boldsymbol{0}$.\n- **Material Parameters:** $\\mu = 1.0 \\times 10^{8}$, $\\lambda = 1.0 \\times 10^{10}$.\n- **Definitions:** Dimension $n=2$, deviatoric decomposition $\\operatorname{dev}(\\boldsymbol{\\sigma}) = \\boldsymbol{\\sigma} - \\frac{1}{2}\\operatorname{tr}(\\boldsymbol{\\sigma}) \\boldsymbol{I}$, compliance mapping $\\boldsymbol{\\varepsilon} = \\boldsymbol{S} : \\boldsymbol{\\sigma}$. Unit thickness.\n- **Tasks:**\n  1. Compute the numerical value of $\\eta^{2}$ and round to four significant figures, in Joules.\n  2. Explain the advantages of this estimator in the incompressible limit.\n\n**Step 2: Validation of Problem Statement**\nThe problem is scientifically grounded in the theory of linear elasticity and a posteriori error estimation for finite element methods, both well-established fields. All terms are defined according to standard conventions in continuum mechanics and computational engineering. The provided data, including material properties and stress fields, are internally consistent and physically plausible. The choice of $\\boldsymbol{\\sigma}^{\\star} = \\boldsymbol{0}$ is a valid, though simple, equilibrated stress field, as it satisfies $\\nabla \\cdot \\boldsymbol{0} + \\boldsymbol{0} = \\boldsymbol{0}$ and has zero normal tractions, ensuring continuity. The problem is well-posed, providing all necessary information for the required calculations and theoretical explanation. It does not violate any of the invalidity criteria.\n\n**Step 3: Verdict and Action**\nThe problem is deemed valid. A complete solution will be provided.\n\n**Derivation of the Error Estimator Integrand**\nThe squared error estimator is given by\n$$ \\eta^{2} = \\sum_{K} \\int_{K} (\\boldsymbol{\\sigma}_{h} - \\boldsymbol{\\sigma}^{\\star}) : \\boldsymbol{S} : (\\boldsymbol{\\sigma}_{h} - \\boldsymbol{\\sigma}^{\\star}) \\, \\mathrm{d}x $$\nLet $\\boldsymbol{\\tau} = \\boldsymbol{\\sigma}_{h} - \\boldsymbol{\\sigma}^{\\star}$. The integrand is $\\boldsymbol{\\tau} : \\boldsymbol{S} : \\boldsymbol{\\tau}$. We first need to derive the compliance tensor $\\boldsymbol{S}$ for the $2$D plane strain case, which inverts the given constitutive relation $\\boldsymbol{\\sigma} = 2\\mu \\boldsymbol{\\varepsilon} + \\lambda \\operatorname{tr}(\\boldsymbol{\\varepsilon}) \\boldsymbol{I}$.\n\nTaking the trace of the constitutive equation in $2$D:\n$$ \\operatorname{tr}(\\boldsymbol{\\sigma}) = \\operatorname{tr}(2\\mu \\boldsymbol{\\varepsilon} + \\lambda \\operatorname{tr}(\\boldsymbol{\\varepsilon}) \\boldsymbol{I}) = 2\\mu \\operatorname{tr}(\\boldsymbol{\\varepsilon}) + \\lambda \\operatorname{tr}(\\boldsymbol{\\varepsilon}) \\operatorname{tr}(\\boldsymbol{I}) $$\nIn $2$D, $\\operatorname{tr}(\\boldsymbol{I}) = 1+1=2$.\n$$ \\operatorname{tr}(\\boldsymbol{\\sigma}) = (2\\mu + 2\\lambda) \\operatorname{tr}(\\boldsymbol{\\varepsilon}) \\implies \\operatorname{tr}(\\boldsymbol{\\varepsilon}) = \\frac{1}{2(\\mu+\\lambda)} \\operatorname{tr}(\\boldsymbol{\\sigma}) $$\nSubstitute this back into the constitutive law to solve for $\\boldsymbol{\\varepsilon}$:\n$$ \\boldsymbol{\\sigma} = 2\\mu \\boldsymbol{\\varepsilon} + \\lambda \\left(\\frac{1}{2(\\mu+\\lambda)} \\operatorname{tr}(\\boldsymbol{\\sigma})\\right) \\boldsymbol{I} $$\n$$ 2\\mu \\boldsymbol{\\varepsilon} = \\boldsymbol{\\sigma} - \\frac{\\lambda}{2(\\mu+\\lambda)} \\operatorname{tr}(\\boldsymbol{\\sigma}) \\boldsymbol{I} $$\n$$ \\boldsymbol{\\varepsilon} = \\frac{1}{2\\mu} \\boldsymbol{\\sigma} - \\frac{\\lambda}{4\\mu(\\mu+\\lambda)} \\operatorname{tr}(\\boldsymbol{\\sigma}) \\boldsymbol{I} $$\nThis expression defines the action of the compliance tensor $\\boldsymbol{S}$, i.e., $\\boldsymbol{\\varepsilon} = \\boldsymbol{S} : \\boldsymbol{\\sigma}$.\n\nTo simplify the integrand, we decompose the stress tensor $\\boldsymbol{\\tau}$ into its deviatoric and spherical parts: $\\boldsymbol{\\tau} = \\operatorname{dev}(\\boldsymbol{\\tau}) + \\frac{1}{2}\\operatorname{tr}(\\boldsymbol{\\tau})\\boldsymbol{I}$.\nThe strain energy density can be written as $\\boldsymbol{\\tau} : \\boldsymbol{\\varepsilon} = \\boldsymbol{\\tau} : (\\boldsymbol{S} : \\boldsymbol{\\tau})$. Let's substitute the expression for $\\boldsymbol{\\varepsilon}$:\n$$ \\boldsymbol{\\tau} : (\\boldsymbol{S} : \\boldsymbol{\\tau}) = \\boldsymbol{\\tau} : \\left( \\frac{1}{2\\mu} \\boldsymbol{\\tau} - \\frac{\\lambda}{4\\mu(\\mu+\\lambda)} \\operatorname{tr}(\\boldsymbol{\\tau}) \\boldsymbol{I} \\right) = \\frac{1}{2\\mu} (\\boldsymbol{\\tau} : \\boldsymbol{\\tau}) - \\frac{\\lambda}{4\\mu(\\mu+\\lambda)} (\\operatorname{tr}(\\boldsymbol{\\tau})) (\\boldsymbol{\\tau} : \\boldsymbol{I}) $$\nSince $\\boldsymbol{\\tau}:\\boldsymbol{I} = \\operatorname{tr}(\\boldsymbol{\\tau})$, we have:\n$$ \\boldsymbol{\\tau} : (\\boldsymbol{S} : \\boldsymbol{\\tau}) = \\frac{1}{2\\mu} ||\\boldsymbol{\\tau}||_F^2 - \\frac{\\lambda}{4\\mu(\\mu+\\lambda)} (\\operatorname{tr}(\\boldsymbol{\\tau}))^2 $$\nwhere $||\\cdot||_F$ is the Frobenius norm. We can express this in terms of the deviatoric and spherical parts. Recall $||\\boldsymbol{\\tau}||_F^2 = ||\\operatorname{dev}(\\boldsymbol{\\tau})||_F^2 + ||\\frac{1}{2}\\operatorname{tr}(\\boldsymbol{\\tau})\\boldsymbol{I}||_F^2 = ||\\operatorname{dev}(\\boldsymbol{\\tau})||_F^2 + \\frac{1}{4}(\\operatorname{tr}(\\boldsymbol{\\tau}))^2 (\\boldsymbol{I}:\\boldsymbol{I}) = ||\\operatorname{dev}(\\boldsymbol{\\tau})||_F^2 + \\frac{1}{2}(\\operatorname{tr}(\\boldsymbol{\\tau}))^2$.\nSubstituting this into the expression for energy density:\n$$ \\boldsymbol{\\tau} : (\\boldsymbol{S} : \\boldsymbol{\\tau}) = \\frac{1}{2\\mu} \\left(||\\operatorname{dev}(\\boldsymbol{\\tau})||_F^2 + \\frac{1}{2}(\\operatorname{tr}(\\boldsymbol{\\tau}))^2\\right) - \\frac{\\lambda}{4\\mu(\\mu+\\lambda)} (\\operatorname{tr}(\\boldsymbol{\\tau}))^2 $$\n$$ = \\frac{1}{2\\mu} ||\\operatorname{dev}(\\boldsymbol{\\tau})||_F^2 + \\left(\\frac{1}{4\\mu} - \\frac{\\lambda}{4\\mu(\\mu+\\lambda)} \\right) (\\operatorname{tr}(\\boldsymbol{\\tau}))^2 $$\n$$ = \\frac{1}{2\\mu} ||\\operatorname{dev}(\\boldsymbol{\\tau})||_F^2 + \\left(\\frac{\\mu+\\lambda-\\lambda}{4\\mu(\\mu+\\lambda)} \\right) (\\operatorname{tr}(\\boldsymbol{\\tau}))^2 $$\n$$ = \\frac{1}{2\\mu} ||\\operatorname{dev}(\\boldsymbol{\\tau})||_F^2 + \\frac{1}{4(\\mu+\\lambda)} (\\operatorname{tr}(\\boldsymbol{\\tau}))^2 $$\nThis is the final form of the integrand.\n\n**Numerical Computation of $\\eta^2$**\nGiven $\\boldsymbol{\\sigma}^{\\star}=\\boldsymbol{0}$, we have $\\boldsymbol{\\tau} = \\boldsymbol{\\sigma}_h$. The discrete stress $\\boldsymbol{\\sigma}_h$ is constant on each element $K_1$ and $K_2$. Therefore, the integral over an element $K$ is the value of the integrand multiplied by the element's area $|K|$.\n$$ \\eta^2 = \\sum_{K \\in \\{K_1, K_2\\}} |K| \\left[ \\frac{1}{2\\mu} ||\\operatorname{dev}(\\boldsymbol{\\sigma}_h|_K)||_F^2 + \\frac{1}{4(\\mu+\\lambda)} (\\operatorname{tr}(\\boldsymbol{\\sigma}_h|_K))^2 \\right] $$\nThe material parameters are $\\mu = 1.0 \\times 10^8$ and $\\lambda = 1.0 \\times 10^{10}$. The element areas are $|K_1|=|K_2|=\\frac{1}{2}$.\nThus, $2\\mu = 2.0 \\times 10^8$ and $4(\\mu+\\lambda) = 4(1.0 \\times 10^8 + 1.0 \\times 10^{10}) = 4(1.01 \\times 10^{10}) = 4.04 \\times 10^{10}$.\n\nFor element $K_1$:\n$\\boldsymbol{\\sigma}_1 = \\boldsymbol{\\sigma}_{h}\\big|_{K_{1}} = \\begin{pmatrix} 2.0 \\times 10^{6} & 1.0 \\times 10^{6} \\\\ 1.0 \\times 10^{6} & 0 \\end{pmatrix}$.\n$\\operatorname{tr}(\\boldsymbol{\\sigma}_1) = (2.0 + 0) \\times 10^{6} = 2.0 \\times 10^{6}$.\n$(\\operatorname{tr}(\\boldsymbol{\\sigma}_1))^2 = (2.0 \\times 10^{6})^2 = 4.0 \\times 10^{12}$.\n$\\operatorname{dev}(\\boldsymbol{\\sigma}_1) = \\boldsymbol{\\sigma}_1 - \\frac{1}{2}\\operatorname{tr}(\\boldsymbol{\\sigma}_1)\\boldsymbol{I} = \\begin{pmatrix} 2.0 & 1.0 \\\\ 1.0 & 0 \\end{pmatrix} \\times 10^6 - \\frac{1}{2}(2.0 \\times 10^6) \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix} = \\begin{pmatrix} 1.0 & 1.0 \\\\ 1.0 & -1.0 \\end{pmatrix} \\times 10^6$.\n$||\\operatorname{dev}(\\boldsymbol{\\sigma}_1)||_F^2 = (1.0^2 + 1.0^2 + 1.0^2 + (-1.0)^2) \\times (10^6)^2 = 4.0 \\times 10^{12}$.\nThe contribution from $K_1$, denoted $\\eta_1^2$, is:\n$$ \\eta_1^2 = \\frac{1}{2} \\left[ \\frac{4.0 \\times 10^{12}}{2.0 \\times 10^8} + \\frac{4.0 \\times 10^{12}}{4.04 \\times 10^{10}} \\right] = \\frac{1}{2} [2.0 \\times 10^4 + 0.990099 \\times 10^2] = \\frac{1}{2}[20000 + 99.0099] = 10049.505 $$\n\nFor element $K_2$:\n$\\boldsymbol{\\sigma}_2 = \\boldsymbol{\\sigma}_{h}\\big|_{K_{2}} = \\begin{pmatrix} 1.5 \\times 10^{6} & 0.8 \\times 10^{6} \\\\ 0.8 \\times 10^{6} & 0.2 \\times 10^{6} \\end{pmatrix}$.\n$\\operatorname{tr}(\\boldsymbol{\\sigma}_2) = (1.5 + 0.2) \\times 10^{6} = 1.7 \\times 10^{6}$.\n$(\\operatorname{tr}(\\boldsymbol{\\sigma}_2))^2 = (1.7 \\times 10^6)^2 = 2.89 \\times 10^{12}$.\n$\\operatorname{dev}(\\boldsymbol{\\sigma}_2) = \\boldsymbol{\\sigma}_2 - \\frac{1}{2}\\operatorname{tr}(\\boldsymbol{\\sigma}_2)\\boldsymbol{I} = \\begin{pmatrix} 1.5 & 0.8 \\\\ 0.8 & 0.2 \\end{pmatrix} \\times 10^{6} - \\frac{1}{2}(1.7 \\times 10^6) \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix} = \\begin{pmatrix} 0.65 & 0.8 \\\\ 0.8 & -0.65 \\end{pmatrix} \\times 10^6$.\n$||\\operatorname{dev}(\\boldsymbol{\\sigma}_2)||_F^2 = (0.65^2 + 0.8^2 + 0.8^2 + (-0.65)^2) \\times (10^6)^2 = (2 \\times 0.4225 + 2 \\times 0.64) \\times 10^{12} = 2.125 \\times 10^{12}$.\nThe contribution from $K_2$, denoted $\\eta_2^2$, is:\n$$ \\eta_2^2 = \\frac{1}{2} \\left[ \\frac{2.125 \\times 10^{12}}{2.0 \\times 10^8} + \\frac{2.89 \\times 10^{12}}{4.04 \\times 10^{10}} \\right] = \\frac{1}{2} [1.0625 \\times 10^4 + 0.715346 \\times 10^2] = \\frac{1}{2}[10625 + 71.5346] = 5348.267 $$\n\nThe total squared estimator value is:\n$$ \\eta^2 = \\eta_1^2 + \\eta_2^2 = 10049.505 + 5348.267 = 15397.772 $$\nThe units are Joules, as the integral of energy density (Pa) over volume (m$^3$, assuming unit thickness in meters) is energy (J).\nRounding to four significant figures, $\\eta^2 = 1.540 \\times 10^4$.\n\n**Explanation of Advantages in the Incompressible Limit**\nThe advantage of the equilibrated stress-based a posteriori error estimator over standard displacement-based residual estimators becomes paramount in the nearly incompressible limit, i.e., when $\\lambda \\to \\infty$.\n\n1.  **Robustness with respect to Incompressibility:**\n    The derived expression for the error measure is $\\eta^2 = \\sum_K \\int_K \\left( \\frac{1}{2\\mu} ||\\operatorname{dev}(\\boldsymbol{\\sigma}_{err})||_F^2 + \\frac{1}{4(\\mu+\\lambda)} (\\operatorname{tr}(\\boldsymbol{\\sigma}_{err}))^2 \\right) \\mathrm{d}x$, where $\\boldsymbol{\\sigma}_{err} = \\boldsymbol{\\sigma}_h - \\boldsymbol{\\sigma}^{\\star}$. As $\\lambda \\to \\infty$, the coefficient of the volumetric (pressure-related) term, $\\frac{1}{4(\\mu+\\lambda)}$, tends to zero. Consequently, the estimator's value becomes asymptotically independent of the volumetric stress error:\n    $$ \\lim_{\\lambda\\to\\infty} \\eta^2 = \\sum_K \\int_K \\frac{1}{2\\mu} ||\\operatorname{dev}(\\boldsymbol{\\sigma}_{err})||_F^2 \\, \\mathrm{d}x $$\n    This means the estimator's value is controlled by the deviatoric (shear) part of the stress error, which is scaled by the shear modulus $\\mu$. The estimator does not \"lock\" or degrade in performance as the material becomes incompressible. In contrast, standard displacement-based residual estimators, which often involve terms like $||\\nabla \\cdot \\boldsymbol{\\sigma}_h||^2$, become unreliable. In the incompressible limit, the pressure term in $\\boldsymbol{\\sigma}_h$ (computed from displacements) can exhibit large, non-physical oscillations, causing the residual to be a poor indicator of the actual displacement error.\n\n2.  **Focus on Equilibrium:**\n    The core of this estimator is the construction of a statically admissible stress field $\\boldsymbol{\\sigma}^{\\star}$ that satisfies pointwise equilibrium ($\\nabla \\cdot \\boldsymbol{\\sigma}^{\\star} = -\\boldsymbol{b}$) and continuity of normal tractions across element faces. The true stress field $\\boldsymbol{\\sigma}$ also satisfies these conditions. The numerical stress $\\boldsymbol{\\sigma}_h$ (especially from hybridized or mixed methods) is designed to satisfy equilibrium inside elements but typically exhibits jumps in normal tractions across inter-element faces. The error measure $\\boldsymbol{\\sigma}_h - \\boldsymbol{\\sigma}^{\\star}$ thus directly accounts for this lack of inter-element traction continuity, which is a primary source of error. By focusing on equilibrium, the method circumvents the numerical difficulties associated with enforcing the kinematic constraint $\\operatorname{tr}(\\boldsymbol{\\varepsilon}) \\approx 0$ that plagues displacement-based formulations and their corresponding estimators in the incompressible limit. The equilibrated reconstruction provides a stable, physically meaningful reference for error measurement that remains valid regardless of the value of $\\lambda$.\n\nIn summary, the separation of the compliance into deviatoric and volumetric parts ensures the estimator's magnitude is not polluted by the locking phenomenon, while the requirement of a stress reconstruction satisfying equilibrium and traction continuity provides a robust mechanism to measure the error, making it superior to displacement-based residuals for nearly incompressible materials.", "answer": "$$\n\\boxed{1.540 \\times 10^{4}}\n$$", "id": "3499389"}]}