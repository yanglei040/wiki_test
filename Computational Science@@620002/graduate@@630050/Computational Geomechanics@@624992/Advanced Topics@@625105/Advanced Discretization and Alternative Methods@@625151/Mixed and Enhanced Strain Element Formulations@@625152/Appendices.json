{"hands_on_practices": [{"introduction": "This first practice provides a concrete, analytical understanding of volumetric locking. By calculating the spurious strain energy stored in a standard element under a specific deformation, you will see exactly how this numerical pathology arises in nearly incompressible materials. This exercise solidifies the fundamental motivation for using the advanced formulations explored in this article, such as mixed or enhanced strain methods [@problem_id:3543469].", "problem": "Consider a two-dimensional bilinear quadrilateral finite element occupying the square region $\\{(x,y)\\,|\\,0 \\le x \\le L,\\,0 \\le y \\le L\\}$ under the plane strain assumption. The material is isotropic, linear elastic, and nearly incompressible, characterized by the Lamé parameters $\\lambda$ and $\\mu$ with small-strain kinematics. A displacement field consistent with the element’s bilinear interpolation is imposed:\n$$u_{x}(x,y) = \\gamma x y,\\qquad u_{y}(x,y) = -\\gamma x y,$$\nwhere $\\gamma$ is a constant amplitude. This kinematic mode has spatially varying dilatation that integrates to zero over the element, a situation in which a purely displacement-based formulation is known to exhibit volumetric locking while a mixed or enhanced strain formulation mitigates it.\n\nStarting from the fundamental definitions of small-strain kinematics and the linear elastic constitutive law, and using the strain energy density definition $W$ derived from these principles, compute the element-level volumetric internal energy difference $\\Delta E_{\\mathrm{vol}}$ between:\n- the standard displacement-based formulation (which penalizes the pointwise volumetric strain), and\n- the volumetric mitigation obtained by the Enhanced Assumed Strain (EAS) or $\\bar{B}$ method (which replaces the volumetric strain by its element-wise average before forming the volumetric contribution to $W$).\n\nAssume the mitigation modifies only the volumetric part of $W$ and leaves the deviatoric part unchanged. Express $\\Delta E_{\\mathrm{vol}}$ as a single closed-form analytic expression in terms of $\\lambda$, $\\gamma$, and $L$. Do not include units in your final answer. No numerical evaluation or rounding is required.", "solution": "The user wants to compute the difference in volumetric internal energy, $\\Delta E_{vol}$, between a standard displacement-based formulation and a mixed formulation ($\\bar{B}$ or EAS) for a specific case.\n\n### Step 1: Extract Givens\n- **Element Geometry**: A two-dimensional bilinear quadrilateral finite element occupying the square region $\\{(x,y)\\,|\\,0 \\le x \\le L,\\,0 \\le y \\le L\\}$.\n- **Physical Assumption**: Plane strain.\n- **Material Properties**: Isotropic, linear elastic, and nearly incompressible, characterized by Lamé parameters $\\lambda$ and $\\mu$.\n- **Kinematics**: Small-strain.\n- **Displacement Field**: $u_{x}(x,y) = \\gamma x y$, $u_{y}(x,y) = -\\gamma x y$, where $\\gamma$ is a constant.\n- **Formulation Definitions**:\n    - **Standard Displacement-Based Formulation**: Penalizes the pointwise volumetric strain.\n    - **Mitigated Formulation (EAS/$\\bar{B}$)**: Replaces the volumetric strain with its element-wise average. This modification applies only to the volumetric part of the strain energy density, $W$.\n- **Quantity to Compute**: The element-level volumetric internal energy difference, $\\Delta E_{\\mathrm{vol}}$, between the two formulations, expressed in terms of $\\lambda$, $\\gamma$, and $L$.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded**: The problem is well-grounded in the theory of solid mechanics and the finite element method. It addresses the well-known phenomenon of volumetric locking in nearly incompressible materials and standard mitigation techniques like the $\\bar{B}$ method or Enhanced Assumed Strain (EAS) methods. All concepts (plane strain, Lamé parameters, strain energy, bilinear elements) are standard in the field.\n- **Well-Posed**: The problem is well-posed. The geometry, material behavior, and kinematic field are explicitly defined. The quantities to be calculated are clearly specified, and a unique solution can be determined from the given information.\n- **Objective**: The problem statement is written in precise, objective, and formal language, free of any subjectivity or ambiguity.\n\n### Step 3: Verdict and Action\nThe problem is valid. It is a standard, solvable problem in computational mechanics. I will proceed with the solution.\n\n***\n\nThe solution proceeds by first deriving the strain field from the given displacement field. Then, the volumetric strain energy is computed for both the standard and the mitigated formulations. The difference between these two energies provides the final answer.\n\n**1. Strain Field Computation**\n\nThe small-strain tensor components, $\\epsilon_{ij}$, are derived from the given displacement field $\\mathbf{u} = (u_x, u_y)$. For a 2D problem, the relevant components are:\n$$ \\epsilon_{xx} = \\frac{\\partial u_x}{\\partial x} $$\n$$ \\epsilon_{yy} = \\frac{\\partial u_y}{\\partial y} $$\n$$ \\gamma_{xy} = 2\\epsilon_{xy} = \\frac{\\partial u_x}{\\partial y} + \\frac{\\partial u_y}{\\partial x} $$\n\nSubstituting the given displacement field, $u_{x}(x,y) = \\gamma x y$ and $u_{y}(x,y) = -\\gamma x y$:\n$$ \\epsilon_{xx}(x,y) = \\frac{\\partial}{\\partial x}(\\gamma x y) = \\gamma y $$\n$$ \\epsilon_{yy}(x,y) = \\frac{\\partial}{\\partial y}(-\\gamma x y) = -\\gamma x $$\n$$ \\gamma_{xy}(x,y) = \\frac{\\partial}{\\partial y}(\\gamma x y) + \\frac{\\partial}{\\partial x}(-\\gamma x y) = \\gamma x - \\gamma y = \\gamma(x - y) $$\n\nThe volumetric strain, or dilatation, $\\epsilon_v$, is the trace of the strain tensor. For a 2D plane strain case, this is defined as:\n$$ \\epsilon_v(x,y) = \\epsilon_{xx}(x,y) + \\epsilon_{yy}(x,y) = \\gamma y - \\gamma x = \\gamma(y-x) $$\nThis shows that the volumetric strain varies linearly across the element.\n\n**2. Volumetric Strain Energy in the Standard Formulation**\n\nFor an isotropic linear elastic material, the strain energy density, $W$, can be decomposed into volumetric and deviatoric parts. The volumetric part, which is penalized in the standard formulation for nearly incompressible materials, is given by:\n$$ W_{\\mathrm{vol}} = \\frac{1}{2} \\lambda \\epsilon_v^2 $$\nwhere $\\lambda$ is the Lamé first parameter, which becomes very large for nearly incompressible materials, thus penalizing non-zero volumetric strains.\n\nThe total volumetric internal energy for the standard formulation, $E_{\\mathrm{vol}}^{\\mathrm{std}}$, is the integral of the volumetric strain energy density over the element's area, $A$:\n$$ E_{\\mathrm{vol}}^{\\mathrm{std}} = \\int_A W_{\\mathrm{vol}}(x,y) \\,dA = \\int_0^L \\int_0^L \\frac{1}{2} \\lambda [\\epsilon_v(x,y)]^2 \\,dx\\,dy $$\nSubstituting $\\epsilon_v(x,y) = \\gamma(y-x)$:\n$$ E_{\\mathrm{vol}}^{\\mathrm{std}} = \\frac{1}{2} \\lambda \\gamma^2 \\int_0^L \\int_0^L (y-x)^2 \\,dx\\,dy $$\nWe evaluate the double integral:\n$$ \\int_0^L \\int_0^L (y-x)^2 \\,dx\\,dy = \\int_0^L \\int_0^L (y^2 - 2xy + x^2) \\,dx\\,dy $$\nFirst, integrate with respect to $x$:\n$$ \\int_0^L (y^2 - 2xy + x^2) \\,dx = \\left[ y^2x - x^2y + \\frac{x^3}{3} \\right]_0^L = Ly^2 - L^2y + \\frac{L^3}{3} $$\nNext, integrate the result with respect to $y$:\n$$ \\int_0^L \\left( Ly^2 - L^2y + \\frac{L^3}{3} \\right) \\,dy = \\left[ \\frac{Ly^3}{3} - \\frac{L^2y^2}{2} + \\frac{L^3y}{3} \\right]_0^L = \\frac{L^4}{3} - \\frac{L^4}{2} + \\frac{L^4}{3} = \\frac{2L^4}{3} - \\frac{L^4}{2} = \\frac{L^4}{6} $$\nSubstituting this result back into the expression for $E_{\\mathrm{vol}}^{\\mathrm{std}}$:\n$$ E_{\\mathrm{vol}}^{\\mathrm{std}} = \\frac{1}{2} \\lambda \\gamma^2 \\left( \\frac{L^4}{6} \\right) = \\frac{\\lambda\\gamma^2L^4}{12} $$\n\n**3. Volumetric Strain Energy in the Mitigated Formulation**\n\nThe EAS or $\\bar{B}$ method mitigates volumetric locking by replacing the pointwise volumetric strain $\\epsilon_v$ with its element-wise average, $\\bar{\\epsilon}_v$, in the energy calculation.\n$$ \\bar{\\epsilon}_v = \\frac{1}{A} \\int_A \\epsilon_v(x,y) \\,dA $$\nThe area of the element is $A = L \\times L = L^2$.\n$$ \\bar{\\epsilon}_v = \\frac{1}{L^2} \\int_0^L \\int_0^L \\gamma(y-x) \\,dx\\,dy $$\nWe evaluate this integral:\n$$ \\int_0^L \\int_0^L \\gamma(y-x) \\,dx\\,dy = \\gamma \\int_0^L \\left[ yx - \\frac{x^2}{2} \\right]_0^L \\,dy = \\gamma \\int_0^L \\left( Ly - \\frac{L^2}{2} \\right) \\,dy $$\n$$ = \\gamma \\left[ \\frac{Ly^2}{2} - \\frac{L^2y}{2} \\right]_0^L = \\gamma \\left( \\frac{L^3}{2} - \\frac{L^3}{2} \\right) = 0 $$\nTherefore, the average volumetric strain for this specific deformation mode is zero:\n$$ \\bar{\\epsilon}_v = 0 $$\nThe volumetric strain energy density in the mitigated formulation is $W_{\\mathrm{vol}}^{\\mathrm{mit}} = \\frac{1}{2} \\lambda \\bar{\\epsilon}_v^2$. Since $\\bar{\\epsilon}_v = 0$, $W_{\\mathrm{vol}}^{\\mathrm{mit}} = 0$ throughout the element.\n\nThe total volumetric internal energy for the mitigated formulation, $E_{\\mathrm{vol}}^{\\mathrm{mit}}$, is:\n$$ E_{\\mathrm{vol}}^{\\mathrm{mit}} = \\int_A W_{\\mathrm{vol}}^{\\mathrm{mit}} \\,dA = \\int_A 0 \\,dA = 0 $$\n\n**4. Energy Difference Calculation**\n\nThe problem asks for the difference $\\Delta E_{\\mathrm{vol}}$ between the standard and mitigated volumetric internal energies.\n$$ \\Delta E_{\\mathrm{vol}} = E_{\\mathrm{vol}}^{\\mathrm{std}} - E_{\\mathrm{vol}}^{\\mathrm{mit}} $$\n$$ \\Delta E_{\\mathrm{vol}} = \\frac{\\lambda\\gamma^2L^4}{12} - 0 = \\frac{\\lambda\\gamma^2L^4}{12} $$\nThis result represents the spurious energy penalty that the standard displacement-based formulation assigns to a valid, zero-volume-change deformation mode, a characteristic symptom of volumetric locking. The mitigated formulation correctly assigns zero energy to this mode, thus avoiding locking.", "answer": "$$\\boxed{\\frac{\\lambda\\gamma^{2}L^{4}}{12}}$$", "id": "3543469"}, {"introduction": "Having established why standard elements can fail, the next step is to explore the cure. This practice contrasts two primary strategies for enforcing near-incompressibility: the mixed method using a Lagrange multiplier and the penalty method. By implementing a solution for a simplified model that includes an Enhanced Assumed Strain (EAS) mode, you will quantitatively evaluate the trade-offs between how accurately the incompressibility constraint is met and the numerical conditioning of the resulting system matrices [@problem_id:3543495].", "problem": "Consider a single constant-volumetric-strain two-dimensional quadrilateral finite element under plane strain with an Enhanced Assumed Strain (EAS) volumetric mode. Let the geometric volumetric strain induced by nodal displacements be represented by a single scalar degree of freedom $\\epsilon$, and let the EAS volumetric mode be represented by a single internal scalar parameter $\\alpha$. Under the small-strain volumetric approximation, the Jacobian determinant of the deformation gradient satisfies $J \\approx 1 + \\epsilon + \\alpha$. Near-incompressibility is enforced either by a pressure Lagrange multiplier (mixed method) or by a penalty term. You will compare the weak enforcement of incompressibility via a pressure Lagrange multiplier with a penalty $\\frac{\\lambda}{2}(J-1)^2$, both in the presence of a volumetric EAS mode, and quantify differences in $J$ and in the condition numbers of the element-level tangent matrices.\n\nFundamental base:\n- The incompressibility constraint for finite strain is $\\det(\\mathbf{F}) = 1$. In the small-strain volumetric approximation appropriate for near-incompressible response with a constant volumetric mode, this is represented as $J - 1 \\approx \\epsilon + \\alpha$.\n- The stationary condition of the total potential energy yields the algebraic equilibrium (first-order optimality) conditions. The tangent matrices are the Hessians of the total potential with respect to the discrete unknowns.\n- Enhanced Assumed Strain (EAS) augments the strain field with internal parameters to improve stability and alleviate locking; here it is represented as a single internal mode $\\alpha$ with stabilization stiffness $k_{\\text{eas}}$.\n\nModel:\n- Let a volumetric load be imposed through a quadratic penalty on the deviation of the geometric volumetric strain $\\epsilon$ from a target $\\epsilon_0$, with stiffness $k_u > 0$: total energy contribution $\\frac{k_u}{2}(\\epsilon - \\epsilon_0)^2$.\n- Let the EAS mode be stabilized by $\\frac{k_{\\text{eas}}}{2}\\alpha^2$ with $k_{\\text{eas}} > 0$.\n- Mixed formulation (pressure Lagrange multiplier): enforce $J-1 \\approx \\epsilon + \\alpha = 0$ via a pressure-like Lagrange multiplier $p$. The total energy is $\\Pi_{\\text{mix}}(\\epsilon,\\alpha,p) = \\frac{k_u}{2}(\\epsilon - \\epsilon_0)^2 + \\frac{k_{\\text{eas}}}{2}\\alpha^2 + p(\\epsilon + \\alpha)$. The algebraic tangent matrix is the Hessian\n$$\n\\mathbf{K}_{\\text{mix}} = \n\\begin{bmatrix}\nk_u & 0 & 1 \\\\\n0 & k_{\\text{eas}} & 1 \\\\\n1 & 1 & 0\n\\end{bmatrix}\n$$\nwith respect to the ordering $[\\epsilon,\\alpha,p]$.\n- Penalty formulation: replace the Lagrange multiplier by a penalty term $\\frac{\\lambda}{2}(J-1)^2 \\approx \\frac{\\lambda}{2}(\\epsilon + \\alpha)^2$, with $\\lambda > 0$. The total energy is $\\Pi_{\\text{pen}}(\\epsilon,\\alpha) = \\frac{k_u}{2}(\\epsilon - \\epsilon_0)^2 + \\frac{k_{\\text{eas}}}{2}\\alpha^2 + \\frac{\\lambda}{2}(\\epsilon + \\alpha)^2$. The algebraic tangent matrix (Hessian) is\n$$\n\\mathbf{K}_{\\text{pen}} =\n\\begin{bmatrix}\nk_u + \\lambda & \\lambda \\\\\n\\lambda & k_{\\text{eas}} + \\lambda\n\\end{bmatrix}\n$$\nwith respect to the ordering $[\\epsilon,\\alpha]$.\n\nTasks:\n- For each specified parameter set $(\\epsilon_0,k_u,k_{\\text{eas}},\\lambda)$, compute:\n    1. The mixed solution $(\\epsilon_{\\text{mix}},\\alpha_{\\text{mix}},p_{\\text{mix}})$ by solving the first-order optimality conditions of $\\Pi_{\\text{mix}}$. Then compute $J_{\\text{mix}} \\approx 1 + \\epsilon_{\\text{mix}} + \\alpha_{\\text{mix}}$.\n    2. The penalty solution $(\\epsilon_{\\text{pen}},\\alpha_{\\text{pen}})$ by solving the first-order optimality conditions of $\\Pi_{\\text{pen}}$. Then compute $J_{\\text{pen}} \\approx 1 + \\epsilon_{\\text{pen}} + \\alpha_{\\text{pen}}$.\n    3. The absolute difference $|J_{\\text{pen}} - J_{\\text{mix}}|$.\n    4. The condition number (in the spectral $2$-norm) of $\\mathbf{K}_{\\text{pen}}$ and of $\\mathbf{K}_{\\text{mix}}$. Use singular-value-based condition numbers to handle indefiniteness in the mixed matrix. Both condition numbers are dimensionless.\n\n- Express all results as dimensionless floats. Angles are not involved.\n\nTest suite:\n- Case $1$: $(\\epsilon_0,k_u,k_{\\text{eas}},\\lambda) = (0.02, 1000, 10, 10000)$.\n- Case $2$: $(\\epsilon_0,k_u,k_{\\text{eas}},\\lambda) = (0.05, 500, 1000, 100)$.\n- Case $3$: $(\\epsilon_0,k_u,k_{\\text{eas}},\\lambda) = (0.0, 200, 5, 1000000)$.\n- Case $4$: $(\\epsilon_0,k_u,k_{\\text{eas}},\\lambda) = (-0.03, 1500, 50, 100000)$.\n- Case $5$: $(\\epsilon_0,k_u,k_{\\text{eas}},\\lambda) = (0.02, 1000, 10000, 1)$.\n\nOutput specification:\n- Your program should produce a single line of output containing the results aggregated across all test cases as a comma-separated flat list enclosed in square brackets. For each test case, append the three floats in the order $[|J_{\\text{pen}} - J_{\\text{mix}}|,\\ \\text{cond}(\\mathbf{K}_{\\text{pen}}),\\ \\text{cond}(\\mathbf{K}_{\\text{mix}})]$ to the output list. For example, the overall output format for $N$ cases is $[d_1,c_{\\text{pen},1},c_{\\text{mix},1},\\dots,d_N,c_{\\text{pen},N},c_{\\text{mix},N}]$.", "solution": "The problem requires a comparative analysis of two common methods for enforcing near-incompressibility in a simplified finite element context: a mixed formulation using a Lagrange multiplier and a penalty formulation. The analysis focuses on the resulting change in volume and the conditioning of the associated element-level tangent matrices. We will first derive the analytical solutions for the state variables for each formulation and then establish the expressions for the quantities to be computed.\n\nFirst, we analyze the mixed formulation. The total potential energy for the mixed formulation is given by\n$$\n\\Pi_{\\text{mix}}(\\epsilon,\\alpha,p) = \\frac{k_u}{2}(\\epsilon - \\epsilon_0)^2 + \\frac{k_{\\text{eas}}}{2}\\alpha^2 + p(\\epsilon + \\alpha)\n$$\nwhere $\\epsilon$ is the geometric volumetric strain, $\\alpha$ is the enhanced assumed strain (EAS) mode, and $p$ is the pressure-like Lagrange multiplier. The parameters $k_u$ and $k_{\\text{eas}}$ are stiffness coefficients for the volumetric loading and EAS stabilization, respectively, and $\\epsilon_0$ is a target volumetric strain.\n\nThe equilibrium state $(\\epsilon_{\\text{mix}}, \\alpha_{\\text{mix}}, p_{\\text{mix}})$ is found at the stationary point of $\\Pi_{\\text{mix}}$, where the first partial derivatives with respect to all variables are zero.\n$$\n\\frac{\\partial \\Pi_{\\text{mix}}}{\\partial \\epsilon} = k_u(\\epsilon - \\epsilon_0) + p = 0\n$$\n$$\n\\frac{\\partial \\Pi_{\\text{mix}}}{\\partial \\alpha} = k_{\\text{eas}}\\alpha + p = 0\n$$\n$$\n\\frac{\\partial \\Pi_{\\text{mix}}}{\\partial p} = \\epsilon + \\alpha = 0\n$$\nThis system of linear equations can be written in matrix form as:\n$$\n\\begin{bmatrix}\nk_u & 0 & 1 \\\\\n0 & k_{\\text{eas}} & 1 \\\\\n1 & 1 & 0\n\\end{bmatrix}\n\\begin{bmatrix}\n\\epsilon \\\\\n\\alpha \\\\\np\n\\end{bmatrix}\n=\n\\begin{bmatrix}\nk_u \\epsilon_0 \\\\\n0 \\\\\n0\n\\end{bmatrix}\n$$\nFrom the third equation, we have $\\alpha = -\\epsilon$. Substituting this into the second equation yields $p = k_{\\text{eas}}\\epsilon$. Substituting both relations into the first equation gives:\n$$\nk_u(\\epsilon - \\epsilon_0) + k_{\\text{eas}}\\epsilon = 0 \\implies (k_u + k_{\\text{eas}})\\epsilon = k_u \\epsilon_0\n$$\nSolving for $\\epsilon_{\\text{mix}}$, $\\alpha_{\\text{mix}}$, and $p_{\\text{mix}}$ yields:\n$$\n\\epsilon_{\\text{mix}} = \\frac{k_u}{k_u + k_{\\text{eas}}} \\epsilon_0\n$$\n$$\n\\alpha_{\\text{mix}} = -\\epsilon_{\\text{mix}} = -\\frac{k_u}{k_u + k_{\\text{eas}}} \\epsilon_0\n$$\n$$\np_{\\text{mix}} = k_{\\text{eas}}\\epsilon_{\\text{mix}} = \\frac{k_u k_{\\text{eas}}}{k_u + k_{\\text{eas}}} \\epsilon_0\n$$\nThe Jacobian determinant approximation for the mixed formulation is $J_{\\text{mix}} \\approx 1 + \\epsilon_{\\text{mix}} + \\alpha_{\\text{mix}}$. Since $\\epsilon_{\\text{mix}} + \\alpha_{\\text{mix}} = 0$, the constraint is satisfied exactly, and thus $J_{\\text{mix}} = 1$. The tangent matrix is the Hessian, which for this linear system is the matrix of coefficients:\n$$\n\\mathbf{K}_{\\text{mix}} =\n\\begin{bmatrix}\nk_u & 0 & 1 \\\\\n0 & k_{\\text{eas}} & 1 \\\\\n1 & 1 & 0\n\\end{bmatrix}\n$$\n\nNext, we analyze the penalty formulation. The total potential energy is\n$$\n\\Pi_{\\text{pen}}(\\epsilon,\\alpha) = \\frac{k_u}{2}(\\epsilon - \\epsilon_0)^2 + \\frac{k_{\\text{eas}}}{2}\\alpha^2 + \\frac{\\lambda}{2}(\\epsilon + \\alpha)^2\n$$\nwhere $\\lambda$ is the penalty parameter. The equilibrium state $(\\epsilon_{\\text{pen}}, \\alpha_{\\text{pen}})$ is found at the stationary point of $\\Pi_{\\text{pen}}$.\n$$\n\\frac{\\partial \\Pi_{\\text{pen}}}{\\partial \\epsilon} = k_u(\\epsilon - \\epsilon_0) + \\lambda(\\epsilon + \\alpha) = (k_u + \\lambda)\\epsilon + \\lambda\\alpha - k_u\\epsilon_0 = 0\n$$\n$$\n\\frac{\\partial \\Pi_{\\text{pen}}}{\\partial \\alpha} = k_{\\text{eas}}\\alpha + \\lambda(\\epsilon + \\alpha) = \\lambda\\epsilon + (k_{\\text{eas}} + \\lambda)\\alpha = 0\n$$\nThis system of equations is:\n$$\n\\begin{bmatrix}\nk_u + \\lambda & \\lambda \\\\\n\\lambda & k_{\\text{eas}} + \\lambda\n\\end{bmatrix}\n\\begin{bmatrix}\n\\epsilon \\\\\n\\alpha\n\\end{bmatrix}\n=\n\\begin{bmatrix}\nk_u \\epsilon_0 \\\\\n0\n\\end{bmatrix}\n$$\nSolving this $2 \\times 2$ system, for instance by inverting the matrix, yields the solution. The determinant of the matrix is $D = (k_u + \\lambda)(k_{\\text{eas}} + \\lambda) - \\lambda^2 = k_u k_{\\text{eas}} + \\lambda(k_u + k_{\\text{eas}})$. The solution is:\n$$\n\\begin{bmatrix}\n\\epsilon_{\\text{pen}} \\\\\n\\alpha_{\\text{pen}}\n\\end{bmatrix}\n= \\frac{1}{D}\n\\begin{bmatrix}\nk_{\\text{eas}} + \\lambda & -\\lambda \\\\\n-\\lambda & k_u + \\lambda\n\\end{bmatrix}\n\\begin{bmatrix}\nk_u \\epsilon_0 \\\\\n0\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n\\frac{k_u(k_{\\text{eas}} + \\lambda)}{k_u k_{\\text{eas}} + \\lambda(k_u + k_{\\text{eas}})} \\epsilon_0 \\\\\n\\frac{-k_u \\lambda}{k_u k_{\\text{eas}} + \\lambda(k_u + k_{\\text{eas}})} \\epsilon_0\n\\end{bmatrix}\n$$\nThe volumetric strain term in the Jacobian for the penalty method is:\n$$\n\\epsilon_{\\text{pen}} + \\alpha_{\\text{pen}} = \\frac{k_u(k_{\\text{eas}} + \\lambda) - k_u \\lambda}{k_u k_{\\text{eas}} + \\lambda(k_u + k_{\\text{eas}})} \\epsilon_0 = \\frac{k_u k_{\\text{eas}}}{k_u k_{\\text{eas}} + \\lambda(k_u + k_{\\text{eas}})} \\epsilon_0\n$$\nThe Jacobian determinant approximation is then $J_{\\text{pen}} \\approx 1 + \\epsilon_{\\text{pen}} + \\alpha_{\\text{pen}}$, so\n$$\nJ_{\\text{pen}} = 1 + \\frac{k_u k_{\\text{eas}}}{k_u k_{\\text{eas}} + \\lambda(k_u + k_{\\text{eas}})} \\epsilon_0\n$$\nThe tangent matrix for the penalty formulation is the Hessian of $\\Pi_{\\text{pen}}$:\n$$\n\\mathbf{K}_{\\text{pen}} =\n\\begin{bmatrix}\nk_u + \\lambda & \\lambda \\\\\n\\lambda & k_{\\text{eas}} + \\lambda\n\\end{bmatrix}\n$$\n\nWe can now define the quantities to be computed for each parameter set $(\\epsilon_0, k_u, k_{\\text{eas}}, \\lambda)$.\n$1$. The absolute difference in the Jacobian determinants is:\n$$\n|J_{\\text{pen}} - J_{\\text{mix}}| = \\left| \\left(1 + \\frac{k_u k_{\\text{eas}}}{k_u k_{\\text{eas}} + \\lambda(k_u + k_{\\text{eas}})} \\epsilon_0 \\right) - 1 \\right| = \\left| \\frac{k_u k_{\\text{eas}}}{k_u k_{\\text{eas}} + \\lambda(k_u + k_{\\text{eas}})} \\epsilon_0 \\right|\n$$\n$2$. The condition number of $\\mathbf{K}_{\\text{pen}}$, denoted $\\text{cond}(\\mathbf{K}_{\\text{pen}})$, is computed using the spectral $2$-norm. As $\\mathbf{K}_{\\text{pen}}$ is symmetric positive-definite, this equals the ratio of its largest to its smallest eigenvalue, $\\lambda_{\\text{max}}/\\lambda_{\\text{min}}$.\n$3$. The condition number of $\\mathbf{K}_{\\text{mix}}$, denoted $\\text{cond}(\\mathbf{K}_{\\text{mix}})$, is computed based on its singular values as $\\sigma_{\\text{max}}/\\sigma_{\\text{min}}$, which is appropriate for the indefinite symmetric matrix $\\mathbf{K}_{\\text{mix}}$.\nThese quantities will be calculated programmatically for each test case.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the computational geomechanics problem for a set of test cases.\n\n    For each case, it compares a mixed formulation and a penalty formulation\n    for enforcing near-incompressibility in a simplified finite element model.\n    It calculates the difference in the resulting volume change (Jacobian) and\n    the condition numbers of the respective tangent matrices.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (epsilon_0, k_u, k_eas, lambda)\n        (0.02, 1000, 10, 10000),      # Case 1\n        (0.05, 500, 1000, 100),       # Case 2\n        (0.0, 200, 5, 1000000),      # Case 3\n        (-0.03, 1500, 50, 100000),    # Case 4\n        (0.02, 1000, 10000, 1),       # Case 5\n    ]\n\n    results = []\n    for case in test_cases:\n        epsilon_0, k_u, k_eas, lambd = case\n\n        # --- Mixed Formulation ---\n        # The Jacobian for the mixed formulation is exactly 1, as the constraint\n        # epsilon_mix + alpha_mix = 0 is enforced strongly by the Lagrange multiplier.\n        J_mix = 1.0\n\n        # --- Penalty Formulation ---\n        # Analytically derived solution for J_pen = 1 + epsilon_pen + alpha_pen\n        # This avoids numerical errors from solving the linear system.\n        vol_strain_pen_numerator = k_u * k_eas * epsilon_0\n        vol_strain_pen_denominator = k_u * k_eas + lambd * (k_u + k_eas)\n        \n        # Handle the case where the denominator might be zero, although constraints\n        # k_u > 0, k_eas > 0, lambda > 0 prevent this.\n        if vol_strain_pen_denominator == 0:\n            # This case is not expected under problem constraints\n            vol_strain_pen = 0.0\n        else:\n            vol_strain_pen = vol_strain_pen_numerator / vol_strain_pen_denominator\n            \n        J_pen = 1.0 + vol_strain_pen\n\n        # --- Task 1: Absolute difference in Jacobian ---\n        diff_J = np.abs(J_pen - J_mix)\n\n        # --- Task 2  3: Condition numbers ----\n        \n        # Tangent matrix for the mixed formulation\n        K_mix = np.array([\n            [k_u, 0.0, 1.0],\n            [0.0, k_eas, 1.0],\n            [1.0, 1.0, 0.0]\n        ], dtype=float)\n\n        # Tangent matrix for the penalty formulation\n        K_pen = np.array([\n            [k_u + lambd, lambd],\n            [lambd, k_eas + lambd]\n        ], dtype=float)\n\n        # Compute condition numbers using the 2-norm (spectral norm).\n        # np.linalg.cond uses SVD, which is appropriate for both matrices\n        # as per the problem description.\n        cond_mix = np.linalg.cond(K_mix)\n        cond_pen = np.linalg.cond(K_pen)\n        \n        # Append results for the current case\n        results.extend([diff_J, cond_pen, cond_mix])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3543495"}, {"introduction": "The final step in developing a robust element is to ensure its stability. This advanced practice introduces a powerful technique used in professional finite element development: analyzing the condensed element stiffness matrix for spurious zero-energy modes. By implementing an algorithm based on static condensation and eigenanalysis, you will learn how to diagnose and filter out non-physical deformations like hourglassing, a critical skill for creating reliable custom elements for complex simulations [@problem_id:3543530].", "problem": "You are asked to analyze spurious zero-energy enhanced strain modes in mixed and enhanced strain finite element formulations by performing a local eigenanalysis of the element-level condensed stiffness. Begin from a principled base that is appropriate for computational geomechanics: the principle of minimum potential energy and the concept of linearized stability. Consider a single finite element whose linearized incremental potential energy around an equilibrium state is well-approximated by a quadratic form in the nodal displacement vector and internal enhanced strain parameters. Let $u \\in \\mathbb{R}^m$ denote the nodal displacement vector and let $a \\in \\mathbb{R}^n$ denote the internal parameters associated with enhanced strain modes (denoted $\\tilde{\\varepsilon}$). Under linearization, the element energy can be represented as\n$$\n\\Pi(u,a) = \\tfrac{1}{2}\n\\begin{bmatrix}\nu \\\\ a\n\\end{bmatrix}^{\\!\\top}\n\\begin{bmatrix}\nK_{uu}  K_{ua} \\\\\nK_{au}  K_{aa}\n\\end{bmatrix}\n\\begin{bmatrix}\nu \\\\ a\n\\end{bmatrix},\n$$\nwhere $K_{uu} \\in \\mathbb{R}^{m \\times m}$, $K_{ua} \\in \\mathbb{R}^{m \\times n}$, $K_{au} = K_{ua}^\\top \\in \\mathbb{R}^{n \\times m}$, and $K_{aa} \\in \\mathbb{R}^{n \\times n}$ form a symmetric Hessian. Assume $K_{aa}$ is invertible. Static condensation of $a$ yields the condensed Hessian with respect to $u$:\n$$\nH = K_{uu} - K_{ua} K_{aa}^{-1} K_{au}.\n$$\nIn robust mixed and enhanced strain formulations, spurious zero-energy $\\tilde{\\varepsilon}$ modes manifest locally as near-null eigenvalues in the condensed Hessian $H$, and stability requires that $H$ be Symmetric Positive Definite (SPD). Your tasks are:\n\n1. Starting only from the principle of minimum potential energy and the definition of quadratic energy forms, derive the condensed Hessian $H$ and explain why the presence of near-zero eigenvalues in $H$ corresponds to spurious zero-energy $\\tilde{\\varepsilon}$ modes. Propose a numerical criterion for identifying and filtering these modes based on the positive definiteness of $H$.\n\n2. Implement an algorithm that, for a given set of element matrices $(K_{uu}, K_{ua}, K_{aa})$, performs the following steps:\n   - Compute the condensed Hessian $H$ using the Schur complement $H = K_{uu} - K_{ua}K_{aa}^{-1}K_{au}$.\n   - Perform symmetric eigenanalysis of $H$ to obtain eigenpairs $\\{(\\lambda_i, v_i)\\}$.\n   - Define a tolerance\n     $$\n     \\tau = \\gamma \\cdot \\max\\!\\big(1, \\|H\\|_2\\big)\\cdot \\sqrt{\\epsilon},\n     $$\n     where $\\gamma  0$ is a user-specified scaling, $\\|H\\|_2$ is the spectral norm (largest singular value, equal to the largest absolute eigenvalue for symmetric $H$), and $\\epsilon$ is the machine precision of double-precision floating point arithmetic. Classify as spurious any mode whose eigenvalue satisfies $|\\lambda_i| \\le \\tau$.\n   - Construct a filter that removes the identified spurious modes by projecting onto the subspace spanned by eigenvectors whose eigenvalues satisfy $\\lambda_i  \\tau$. The filtered condensed Hessian can be written as\n     $$\n     H_{\\text{filtered}} = Q_+ \\,\\mathrm{diag}(\\lambda_i : \\lambda_i  \\tau)\\, Q_+^\\top,\n     $$\n     where the columns of $Q_+$ are the eigenvectors with $\\lambda_i  \\tau$.\n   - Determine whether the original $H$ is positive definite under the tolerance, meaning check whether $\\min_i \\lambda_i  \\tau$.\n\n3. Use the following test suite of element block matrices. Each test case is independent and self-contained, and all matrices are dimensionally consistent and symmetric where required. For all test cases use $\\gamma = 10$.\n\n   Test case 1 (happy path, $m=3$, $n=2$):\n   - $K_{uu} = \\begin{bmatrix}\n   12  2  0 \\\\\n   2  8  1 \\\\\n   0  1  5\n   \\end{bmatrix}$,\n   - $K_{aa} = \\begin{bmatrix}\n   6  1 \\\\\n   1  4\n   \\end{bmatrix}$,\n   - $K_{ua} = \\begin{bmatrix}\n   1  0.2 \\\\\n   0.3  0.1 \\\\\n   0.0  0.5\n   \\end{bmatrix}$.\n\n   Test case 2 (exact singular due to full coupling, $m=3$, $n=3$):\n   - $K_{uu}$ is the same as in Test case 1,\n   - Let $L$ be the lower-triangular Cholesky factor of $K_{uu}$, i.e., $L L^\\top = K_{uu}$,\n   - $K_{aa} = I_3$,\n   - $K_{ua} = L$.\n\n   Test case 3 (near-singular, small positive eigenvalues, $m=3$, $n=3$):\n   - $K_{uu}$ is the same as in Test case 1,\n   - $L$ is as defined in Test case 2,\n   - $K_{aa} = I_3$,\n   - $K_{ua} = 0.99\\, L$.\n\n   Test case 4 (indefinite condensed Hessian, $m=3$, $n=3$):\n   - $K_{uu}$ is the same as in Test case 1,\n   - $L$ is as defined in Test case 2,\n   - $K_{aa} = I_3$,\n   - $K_{ua} = 1.2\\, L$.\n\n4. Your program must process the above test suite and produce, for each test case, a pair consisting of:\n   - The integer count of spurious modes identified (the number of eigenvalues of $H$ with $|\\lambda_i| \\le \\tau$),\n   - A boolean stating whether $H$ is positive definite under the tolerance (true if $\\min_i \\lambda_i  \\tau$, otherwise false).\n   The final output must be a single line containing a comma-separated list of these pairs enclosed in square brackets, where each pair is itself a list of the form $[s, \\text{pd}]$. For example, the format must be like\n   $$\n   [ [s_1, \\text{pd}_1], [s_2, \\text{pd}_2], [s_3, \\text{pd}_3], [s_4, \\text{pd}_4] ].\n   $$\n   No physical units apply to this problem, and angles are not involved; all outputs are unitless. The program must be fully self-contained and require no user input.\n\nYour derivation and implementation must rely only on foundational principles (quadratic energies, symmetric Hessians, Schur complements, and eigenanalysis) without using or stating any specialized shortcut formulas beyond what is derivable from these bases. Ensure scientific realism, including symmetric consistency and positive definiteness assumptions where appropriate. The algorithm must be robust to numerical precision, and the tolerance definition must be used exactly as stated.", "solution": "The problem concerns the analysis of stability in mixed and enhanced strain finite element formulations, a topic of central importance in computational geomechanics. A spurious zero-energy mode corresponds to a non-physical deformation of a finite element that stores little to no strain energy, leading to numerical instabilities. These modes are identified by analyzing the eigenvalues of the element's condensed stiffness matrix.\n\n### 1. Derivation and Interpretation of the Condensed Hessian\n\nThe derivation begins with the principle of minimum potential energy applied to the linearized incremental potential energy, $\\Pi$, of a single finite element. The energy is given as a quadratic form in the nodal displacements, $u \\in \\mathbb{R}^m$, and the internal enhanced strain parameters, $a \\in \\mathbb{R}^n$:\n$$\n\\Pi(u,a) = \\tfrac{1}{2}\n\\begin{bmatrix}\nu \\\\ a\n\\end{bmatrix}^{\\!\\top}\n\\begin{bmatrix}\nK_{uu}  K_{ua} \\\\\nK_{au}  K_{aa}\n\\end{bmatrix}\n\\begin{bmatrix}\nu \\\\ a\n\\end{bmatrix}\n$$\nExpanding this expression, and using the fact that the full Hessian matrix is symmetric ($K_{au} = K_{ua}^\\top$), we obtain:\n$$\n\\Pi(u,a) = \\frac{1}{2} (u^\\top K_{uu} u + u^\\top K_{ua} a + a^\\top K_{au} u + a^\\top K_{aa} a) = \\frac{1}{2} (u^\\top K_{uu} u + 2u^\\top K_{ua} a + a^\\top K_{aa} a)\n$$\nFor a given nodal displacement vector $u$, the internal parameters $a$ locally equilibrate to a state that minimizes the potential energy $\\Pi$. This equilibrium condition is found by setting the gradient of $\\Pi$ with respect to $a$ to zero:\n$$\n\\frac{\\partial \\Pi}{\\partial a} = K_{au} u + K_{aa} a = 0\n$$\nThe problem statement assumes that the matrix $K_{aa}$ is invertible. This is a crucial assumption for the stability of the enhanced strain field itself; it ensures that for any given set of displacements, there is a unique set of enhanced strain parameters. Solving for $a$ yields:\n$$\na(u) = -K_{aa}^{-1} K_{au} u\n$$\nThis relationship shows that the internal parameters are linearly dependent on the nodal displacements. Substituting this expression back into the potential energy functional $\\Pi(u,a)$ eliminates the internal parameters $a$ and yields the condensed potential energy, $\\Pi_{\\text{cond}}(u)$, which is a function of only the nodal displacements $u$:\n$$\n\\Pi_{\\text{cond}}(u) = \\Pi(u, a(u)) = \\frac{1}{2} \\left[ u^\\top K_{uu} u + 2u^\\top K_{ua} (-K_{aa}^{-1} K_{au} u) + (-K_{aa}^{-1} K_{au} u)^\\top K_{aa} (-K_{aa}^{-1} K_{au} u) \\right]\n$$\nUsing the identity $(ABC)^\\top = C^\\top B^\\top A^\\top$ and the symmetry of $K_{aa}$ (which implies the symmetry of its inverse, $(K_{aa}^{-1})^\\top = K_{aa}^{-1}$), the third term simplifies:\n$$\nu^\\top K_{au}^\\top (K_{aa}^{-1})^\\top K_{aa} K_{aa}^{-1} K_{au} u = u^\\top K_{ua} K_{aa}^{-1} I K_{au} u = u^\\top K_{ua} K_{aa}^{-1} K_{au} u\n$$\nSubstituting this back into the expression for $\\Pi_{\\text{cond}}(u)$:\n$$\n\\Pi_{\\text{cond}}(u) = \\frac{1}{2} \\left[ u^\\top K_{uu} u - 2u^\\top K_{ua} K_{aa}^{-1} K_{au} u + u^\\top K_{ua} K_{aa}^{-1} K_{au} u \\right]\n$$\n$$\n\\Pi_{\\text{cond}}(u) = \\frac{1}{2} \\left[ u^\\top K_{uu} u - u^\\top K_{ua} K_{aa}^{-1} K_{au} u \\right] = \\frac{1}{2} u^\\top (K_{uu} - K_{ua} K_{aa}^{-1} K_{au}) u\n$$\nThis is a quadratic form $\\Pi_{\\text{cond}}(u) = \\frac{1}{2} u^\\top H u$, where the matrix $H$ is the condensed Hessian, also known as the Schur complement of $K_{aa}$ in the full system matrix:\n$$\nH = K_{uu} - K_{ua} K_{aa}^{-1} K_{au}\n$$\nThis matrix $H$ represents the effective stiffness of the finite element with respect to its nodal degrees of freedom after the internal enhanced strain modes have been optimally chosen to minimize energy for any given displacement.\n\nFor an element to be stable, any non-rigid-body deformation must store a positive amount of strain energy. In terms of the condensed energy form, this means $\\Pi_{\\text{cond}}(u) = \\frac{1}{2} u^\\top H u > 0$ for all non-zero displacement vectors $u$ that do not represent rigid-body motion. If we disregard rigid-body modes (which have zero energy by definition), stability requires the condensed Hessian $H$ to be a symmetric positive definite (SPD) matrix.\n\nA spurious zero-energy mode is a non-rigid-body displacement mode $v$ for which the strain energy is zero or near-zero. From the spectral properties of $H$, the energy associated with an eigenmode $v_i$ is $\\frac{1}{2} v_i^\\top H v_i = \\frac{1}{2} \\lambda_i \\|v_i\\|^2$, where $(\\lambda_i, v_i)$ is an eigenpair of $H$. Therefore, a spurious mode corresponds to an eigenvector $v_i$ whose eigenvalue $\\lambda_i$ is zero or close to zero. The existence of such an eigenvalue indicates a rank deficiency in the condensed stiffness matrix, a hallmark of an unstable finite element formulation.\n\n### 2. Numerical Criterion for Spurious Modes\n\nIn numerical computations with finite-precision arithmetic, eigenvalues that should be exactly zero are often computed as small non-zero numbers. A robust numerical criterion is therefore necessary to distinguish physically meaningful small eigenvalues from spurious ones that are artifacts of numerical noise or formulation instability.\n\nThe problem provides a well-defined tolerance, $\\tau$, for this purpose:\n$$\n\\tau = \\gamma \\cdot \\max\\!\\big(1, \\|H\\|_2\\big)\\cdot \\sqrt{\\epsilon}\n$$\nThe components of this tolerance are:\n- $\\epsilon$: The machine precision (e.g., for double-precision, $\\epsilon \\approx 2.22 \\times 10^{-16}$), which sets a fundamental limit on numerical accuracy. The square root, $\\sqrt{\\epsilon}$, is appropriate because eigenvalues are related to the square of frequencies and energies.\n- $\\|H\\|_2$: The spectral norm of $H$, which is its largest absolute eigenvalue $|\\lambda_{\\max}|$. Scaling the tolerance by this norm makes the check relative to the overall magnitude of stiffness in the element. This prevents a fixed absolute tolerance from being too strict for a very \"soft\" element or too lenient for a very \"stiff\" one. The use of $\\max(1, \\|H\\|_2)$ provides a floor for the tolerance, ensuring it remains meaningful even if $H$ itself is close to the zero matrix.\n- $\\gamma$: A user-defined scaling factor (given as $10$) that allows for adjustment of the strictness of the criterion.\n\nUsing this tolerance, we establish the following numerical criteria:\n- **Spurious Mode Identification**: An eigenmode $(\\lambda_i, v_i)$ is classified as spurious if its eigenvalue falls within the numerical noise threshold, i.e., $|\\lambda_i| \\le \\tau$. The number of such modes is the count of spurious modes.\n- **Positive Definiteness Check**: The matrix $H$ is considered numerically positive definite if its smallest eigenvalue is not only positive but also clears this numerical noise threshold. The condition is $\\min_i \\lambda_i > \\tau$. An eigenvalue that is positive but smaller than $\\tau$ indicates that the matrix is positive semi-definite at best, and numerically unstable.\n\nThe identified spurious modes can be filtered out by reconstructing the Hessian from its spectral decomposition, excluding the components associated with the spurious modes. If $H = Q \\Lambda Q^\\top = \\sum_i \\lambda_i v_i v_i^\\top$ is the eigendecomposition, the filtered Hessian is:\n$$\nH_{\\text{filtered}} = \\sum_{\\lambda_i > \\tau} \\lambda_i v_i v_i^\\top = Q_+ \\,\\mathrm{diag}(\\lambda_i \\mid \\lambda_i > \\tau)\\, Q_+^\\top\n$$\nwhere the columns of $Q_+$ are the eigenvectors corresponding to eigenvalues $\\lambda_i > \\tau$. This operation projects the element stiffness onto the stable subspace, effectively removing the unstable modes of deformation.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Analyzes spurious modes in mixed/enhanced strain finite element formulations\n    for a given suite of test cases.\n    \"\"\"\n\n    # --- Problem Parameters ---\n    gamma = 10.0\n    machine_eps = np.finfo(float).eps\n\n    # --- Test Suite Definition ---\n\n    # Common K_uu matrix for all test cases\n    K_uu = np.array([\n        [12.0, 2.0, 0.0],\n        [2.0, 8.0, 1.0],\n        [0.0, 1.0, 5.0]\n    ])\n\n    test_cases = []\n\n    # Test Case 1: Happy path\n    test_cases.append({\n        \"K_uu\": K_uu,\n        \"K_aa\": np.array([[6.0, 1.0], [1.0, 4.0]]),\n        \"K_ua\": np.array([[1.0, 0.2], [0.3, 0.1], [0.0, 0.5]])\n    })\n\n    # For cases 2, 3, 4, we need the Cholesky factor of K_uu.\n    # K_uu is symmetric positive definite, so Cholesky decomposition exists.\n    try:\n        L = np.linalg.cholesky(K_uu)\n    except np.linalg.LinAlgError:\n        # This part should not be reached as K_uu is SPD.\n        print(\"Error: K_uu must be positive definite for Cholesky decomposition.\")\n        return\n\n    # Test Case 2: Exact singular condensed Hessian\n    test_cases.append({\n        \"K_uu\": K_uu,\n        \"K_aa\": np.identity(3),\n        \"K_ua\": L\n    })\n\n    # Test Case 3: Near-singular condensed Hessian (small positive eigenvalues)\n    test_cases.append({\n        \"K_uu\": K_uu,\n        \"K_aa\": np.identity(3),\n        \"K_ua\": 0.99 * L\n    })\n\n    # Test Case 4: Indefinite condensed Hessian (negative eigenvalues)\n    test_cases.append({\n        \"K_uu\": K_uu,\n        \"K_aa\": np.identity(3),\n        \"K_ua\": 1.2 * L\n    })\n\n    results = []\n\n    for case in test_cases:\n        k_uu = case[\"K_uu\"]\n        k_ua = case[\"K_ua\"]\n        k_aa = case[\"K_aa\"]\n\n        k_au = k_ua.T\n\n        # Step 1: Compute the condensed Hessian H (Schur complement)\n        try:\n            k_aa_inv = np.linalg.inv(k_aa)\n            H = k_uu - k_ua @ k_aa_inv @ k_au\n        except np.linalg.LinAlgError:\n            # Handle cases where k_aa might be singular, though not expected\n            # in this problem's setup.\n            results.append([\"Error\", \"Error\"])\n            continue\n\n        # Step 2: Perform symmetric eigenanalysis of H\n        # np.linalg.eigh is for symmetric/Hermitian matrices.\n        # It returns eigenvalues in ascending order.\n        eigenvalues, eigenvectors = np.linalg.eigh(H)\n\n        # Step 3: Define the tolerance tau\n        # For a symmetric matrix, the spectral norm (2-norm) is the largest\n        # absolute eigenvalue.\n        H_norm_2 = np.max(np.abs(eigenvalues))\n        tau = gamma * np.max([1.0, H_norm_2]) * np.sqrt(machine_eps)\n\n        # Step 4: Classify spurious modes\n        spurious_count = np.sum(np.abs(eigenvalues) = tau)\n\n        # Step 5: Check for positive definiteness under the tolerance\n        # The smallest eigenvalue must be greater than the tolerance.\n        min_eigenvalue = eigenvalues[0] if len(eigenvalues) > 0 else 0.0\n        is_pd = min_eigenvalue > tau\n\n        results.append([int(spurious_count), is_pd])\n\n    # Format the final output string as specified\n    # The str() representation of a Python list is '[item1, item2, ...]'\n    # which matches the required format including spaces.\n    output_str = f\"[{','.join(map(str, results))}]\"\n    print(output_str)\n\nif __name__ == '__main__':\n    solve()\n```", "id": "3543530"}]}