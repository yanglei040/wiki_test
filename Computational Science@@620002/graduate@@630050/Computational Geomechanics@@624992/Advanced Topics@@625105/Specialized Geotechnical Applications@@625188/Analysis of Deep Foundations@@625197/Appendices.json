{"hands_on_practices": [{"introduction": "Understanding the behavior of a deep foundation begins with analyzing its most basic element: the single pile. This first practice focuses on calculating the axial settlement of an end-bearing pile by applying the principle of superposition [@problem_id:3499728]. You will learn to decompose the total settlement into two distinct components—the elastic compression of the pile structure and the deformation of the soil mass at the pile tip—providing a foundational grasp of pile-soil interaction.", "problem": "A slender cylindrical pile is driven vertically into a homogeneous, isotropic, linear elastic soil that occupies a semi-infinite half-space. The pile is subjected to an axial compressive load, and side resistance along the shaft is neglected to isolate tip response effects. The pile is modeled as a one-dimensional elastic bar whose axial force does not vary along its length. The soil is modeled as a classical elastic half-space. The pile tip is planar and circular, and its contact with the soil is modeled as frictionless, consistent with a rigid circular punch on an elastic half-space.\n\nStarting from fundamental laws and core definitions in linear elasticity and solid mechanics, derive the governing relations needed to compute the pile head settlement under a given axial load. Use one-dimensional axial bar theory for the pile and elastic half-space theory for the tip-soil contact. Do not use any shortcut formulas or pre-derived expressions without justification from basic principles.\n\nYour task is to write a complete, runnable program that, given a set of parameters, computes the pile head settlement in meters. The bar elongation must be computed from first principles using Hooke's law and axial equilibrium. The tip compliance must be computed from the elastic half-space solution for a rigid circular punch. The total pile head settlement is the sum of the bar elongation and the tip compression. The following definitions and physical quantities must be used consistently:\n\n- Pile axial load $P$ in newtons.\n- Pile length $L$ in meters.\n- Pile cross-sectional area $A$ in square meters.\n- Pile Young's modulus $E_\\mathrm{p}$ in pascals.\n- Soil Young's modulus $E_\\mathrm{s}$ in pascals.\n- Soil Poisson's ratio $\\nu_\\mathrm{s}$ (dimensionless).\n- Pile tip radius $a$ in meters.\n- Soil shear modulus $G_\\mathrm{s}$ defined as $G_\\mathrm{s} = \\dfrac{E_\\mathrm{s}}{2\\left(1+\\nu_\\mathrm{s}\\right)}$.\n\nYour program must compute the following quantities for each test case:\n1. The axial bar elongation $\\,\\delta_\\mathrm{bar}\\,$ in meters.\n2. The tip compression $\\,\\delta_\\mathrm{tip}\\,$ in meters based on the elastic half-space response under the pile tip load.\n3. The total pile head settlement $\\,s\\,$ in meters, defined as $\\,s = \\delta_\\mathrm{bar} + \\delta_\\mathrm{tip}\\,$.\n\nExpress all settlements in meters as floating-point numbers.\n\nTest Suite:\nUse the following parameter sets, each tuple ordered as $\\left(P, L, A, E_\\mathrm{p}, a, E_\\mathrm{s}, \\nu_\\mathrm{s}\\right)$ with the units and definitions as specified above.\n\n- Case 1 (general): $\\left(2.0\\times10^6,\\; 12.0,\\; 0.25,\\; 3.0\\times10^{10},\\; 0.40,\\; 1.0\\times10^8,\\; 0.30\\right)$.\n- Case 2 (stiff pile): $\\left(2.0\\times10^6,\\; 12.0,\\; 0.25,\\; 2.0\\times10^{11},\\; 0.40,\\; 1.0\\times10^8,\\; 0.30\\right)$.\n- Case 3 (large tip radius and stiffer soil): $\\left(3.0\\times10^6,\\; 20.0,\\; 0.25,\\; 3.0\\times10^{10},\\; 0.75,\\; 1.5\\times10^8,\\; 0.35\\right)$.\n- Case 4 (near-incompressible soil): $\\left(2.0\\times10^6,\\; 12.0,\\; 0.25,\\; 3.0\\times10^{10},\\; 0.40,\\; 1.0\\times10^9,\\; 0.49\\right)$.\n- Case 5 (long pile): $\\left(2.0\\times10^6,\\; 80.0,\\; 0.25,\\; 3.0\\times10^{10},\\; 0.40,\\; 1.0\\times10^8,\\; 0.30\\right)$.\n\nFinal Output Format:\nYour program should produce a single line of output containing the total pile head settlements for the above test cases, in meters, as a comma-separated list enclosed in square brackets. For example: \"[$s_1,s_2,s_3,s_4,s_5$]\". Every settlement must be expressed in meters. No additional text should be printed.", "solution": "The problem requires the calculation of the total settlement, $s$, of a vertically loaded pile. The total settlement is the sum of two distinct physical phenomena: the elastic compression of the pile itself, $\\delta_{\\mathrm{bar}}$, and the settlement of the soil mass beneath the pile tip, $\\delta_{\\mathrm{tip}}$. The problem specifies a simplified model where shaft friction along the pile is neglected, which implies that the entire axial load, $P$, applied at the pile head is transferred to the pile tip. The system is thus decomposed into two sub-problems that can be analyzed independently using fundamental principles of solid mechanics. The total settlement is expressed as:\n$$ s = \\delta_{\\mathrm{bar}} + \\delta_{\\mathrm{tip}} $$\n\nFirst, we derive the expression for the pile's elastic compression, $\\delta_{\\mathrm{bar}}$.\nThe pile is modeled as a one-dimensional elastic bar of length $L$, constant cross-sectional area $A$, and Young's modulus $E_{\\mathrm{p}}$. According to the problem statement and the principles of static equilibrium, the axial force is constant along the pile's length. This is a direct consequence of neglecting side resistance. Therefore, the internal axial force at any cross-section is equal to the applied load, $P$.\n\nThe axial stress, $\\sigma$, is defined as the force per unit area. Since the internal force is uniform, the stress is also uniform along the pile:\n$$ \\sigma = \\frac{P}{A} $$\nThe axial strain, $\\epsilon$, is defined as the deformation per unit length. For a linear elastic material under uniaxial loading, Hooke's Law states that stress is directly proportional to strain:\n$$ \\sigma = E_{\\mathrm{p}} \\epsilon $$\nwhere $E_{\\mathrm{p}}$ is the Young's modulus of the pile material. By combining these two fundamental equations, we solve for the strain in the pile:\n$$ \\epsilon = \\frac{\\sigma}{E_{\\mathrm{p}}} = \\frac{P}{A E_{\\mathrm{p}}} $$\nStrain represents the local rate of change of displacement along the pile axis. The total compression of the pile, $\\delta_{\\mathrm{bar}}$, is found by integrating the strain over the entire length, $L$, of the pile:\n$$ \\delta_{\\mathrm{bar}} = \\int_{0}^{L} \\epsilon \\, dz $$\nSince the material is homogeneous and the cross-section and force are constant, the strain $\\epsilon$ is also constant. The integral thus simplifies to:\n$$ \\delta_{\\mathrm{bar}} = \\epsilon L $$\nSubstituting the expression for $\\epsilon$, we obtain the final formula for the pile's compression:\n$$ \\delta_{\\mathrm{bar}} = \\frac{P L}{A E_{\\mathrm{p}}} $$\n\nNext, we derive the expression for the settlement of the soil at the pile tip, $\\delta_{\\mathrm{tip}}$.\nThe problem states that the soil is a homogeneous, isotropic, linear elastic half-space. The pile tip is modeled as a rigid, planar, circular punch of radius $a$ that imposes a load $P$ onto the soil surface. The contact is considered frictionless. The settlement of a rigid circular punch on an elastic half-space is a canonical solution in the theory of elasticity, derived from the Boussinesq solution for a point load. While a full derivation from the governing differential equations of elasticity (Navier-Cauchy equations) is extensive, the established result is a fundamental principle for this specific boundary-value problem. The uniform vertical displacement (settlement) under the punch, $\\delta_{\\mathrm{tip}}$, is given by the well-established formula:\n$$ \\delta_{\\mathrm{tip}} = \\frac{P (1 - \\nu_{\\mathrm{s}}^2)}{2 a E_{\\mathrm{s}}} $$\nwhere $P$ is the total load transmitted by the tip, $a$ is the radius of the circular tip, and $E_{\\mathrm{s}}$ and $\\nu_{\\mathrm{s}}$ are the Young's modulus and Poisson's ratio of the elastic half-space (the soil), respectively. The problem also provides a definition for the soil shear modulus, $G_{\\mathrm{s}} = \\dfrac{E_{\\mathrm{s}}}{2\\left(1+\\nu_{\\mathrm{s}}\\right)}$, which allows for an alternative expression. By substituting $E_{\\mathrm{s}} = 2 G_{\\mathrm{s}} (1+\\nu_{\\mathrm{s}})$ into the settlement formula, we can verify its equivalence:\n$$ \\delta_{\\mathrm{tip}} = \\frac{P (1 - \\nu_{\\mathrm{s}})(1 + \\nu_{\\mathrm{s}})}{2 a \\cdot 2G_{\\mathrm{s}}(1+\\nu_{\\mathrm{s}})} = \\frac{P(1-\\nu_{\\mathrm{s}})}{4 a G_{\\mathrm{s}}} $$\nFor computation, the formula using $E_{\\mathrm{s}}$ and $\\nu_{\\mathrm{s}}$ is more direct as these are the parameters provided in the test suite.\n\nFinally, the total pile head settlement, $s$, is the linear superposition of the pile's structural compression and the soil's deformation at the tip:\n$$ s = \\delta_{\\mathrm{bar}} + \\delta_{\\mathrm{tip}} = \\frac{P L}{A E_{\\mathrm{p}}} + \\frac{P (1 - \\nu_{\\mathrm{s}}^2)}{2 a E_{\\mathrm{s}}} $$\nThis equation synthesizes the two parts of the model and will be implemented to compute the total settlement for each of the given test cases. All parameters are provided in consistent SI units, ensuring the resulting settlement $s$ is in meters.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the total settlement of an axially loaded pile based on a composite model.\n\n    The total settlement is the sum of the pile's elastic compression and the tip \n    settlement on an elastic half-space.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Each tuple is ordered as (P, L, A, E_p, a, E_s, nu_s) with SI units.\n    # P: Pile axial load (N)\n    # L: Pile length (m)\n    # A: Pile cross-sectional area (m^2)\n    # E_p: Pile Young's modulus (Pa)\n    # a: Pile tip radius (m)\n    # E_s: Soil Young's modulus (Pa)\n    # nu_s: Soil Poisson's ratio (dimensionless)\n    test_cases = [\n        (2.0e6, 12.0, 0.25, 3.0e10, 0.40, 1.0e8, 0.30),\n        (2.0e6, 12.0, 0.25, 2.0e11, 0.40, 1.0e8, 0.30),\n        (3.0e6, 20.0, 0.25, 3.0e10, 0.75, 1.5e8, 0.35),\n        (2.0e6, 12.0, 0.25, 3.0e10, 0.40, 1.0e9, 0.49),\n        (2.0e6, 80.0, 0.25, 3.0e10, 0.40, 1.0e8, 0.30)\n    ]\n\n    results = []\n    for case in test_cases:\n        P, L, A, E_p, a, E_s, nu_s = case\n        \n        # 1. Compute axial bar elongation (compression)\n        # Formula: delta_bar = (P * L) / (A * E_p)\n        delta_bar = (P * L) / (A * E_p)\n        \n        # 2. Compute tip compression (settlement)\n        # Formula: delta_tip = (P * (1 - nu_s^2)) / (2 * a * E_s)\n        delta_tip = (P * (1 - nu_s**2)) / (2 * a * E_s)\n        \n        # 3. Compute total pile head settlement\n        # Formula: s = delta_bar + delta_tip\n        total_settlement = delta_bar + delta_tip\n        \n        results.append(total_settlement)\n\n    # Final print statement in the exact required format.\n    # The output is a comma-separated list of floating-point numbers in a string.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```", "id": "3499728"}, {"introduction": "Building on the analysis of a single pile, we now scale up to a more complex and common foundation system: the piled raft. This practice explores how a piled raft distributes an applied load between the raft-soil contact area and the pile group, a key concept in modern foundation design [@problem_id:3499751]. By assembling a total system stiffness from individual component stiffnesses, you will solve for the overall settlement and understand the critical mechanism of load sharing in a hybrid foundation.", "problem": "A rigid piled raft foundation is idealized as a single vertical degree-of-freedom system in which a rigid raft is connected in parallel to a set of vertical pile-head springs embedded in an elastic ground. The ground beneath the raft surface is represented by a continuous, linearly elastic reaction characterized by a distributed subgrade modulus. The pile group is represented by a symmetric interaction stiffness matrix that captures both the axial head stiffness of individual piles and the elastic interaction among pile heads through the surrounding soil. Assume small strains, linear elasticity, and quasi-static conditions. The raft is sufficiently stiff in bending that its vertical displacement is spatially uniform.\n\nStarting from the following fundamental bases: (i) linear momentum balance (static equilibrium) stating that the sum of reactions equals the applied load, (ii) kinematic compatibility for the rigid raft that all pile heads and the raft undergo the same vertical displacement, and (iii) linear elastic constitutive relations for springs, derive a computational procedure that determines the uniform settlement and the load distribution between the raft-soil contact and the pile group.\n\nModeling definitions to be used:\n- The raft-soil contact is modeled as a distributed linear spring with subgrade modulus per unit area $k_s$ in $\\mathrm{MN/m^3}$. For a raft plan area $A$ in $\\mathrm{m^2}$, the equivalent raft-soil vertical stiffness is $K_r = k_s \\times 10^6 \\times A$ in $\\mathrm{N/m}$.\n- The pile group of $n$ piles is modeled by a symmetric interaction stiffness matrix $K_p \\in \\mathbb{R}^{n \\times n}$ given in $\\mathrm{GN/m}$; convert each entry to $\\mathrm{N/m}$ by multiplying by $10^9$. The diagonal entries represent the isolated pile-head axial stiffnesses, and the off-diagonal entries represent pairwise interaction terms.\n- The total applied vertical load is $Q$ in $\\mathrm{kN}$; convert to $\\mathrm{N}$ by multiplying by $10^3$.\n- Each pile $i$ has an allowable capacity $C_i$ in $\\mathrm{kN}$.\n\nYour program must:\n- Use only equilibrium and compatibility to obtain expressions for the uniform settlement $u$ in $\\mathrm{m}$, the raft reaction $Q_r$ in $\\mathrm{N}$, and the pile load vector $\\mathbf{q}$ in $\\mathrm{N}$.\n- Convert and report the following for each test case: the settlement in $\\mathrm{mm}$ rounded to three decimal places, the raft load share in $\\mathrm{kN}$ rounded to two decimal places, the list of pile loads in $\\mathrm{kN}$ rounded to two decimal places, and a boolean indicating whether all piles satisfy $q_i \\le C_i$ (use the same unit for both, $\\mathrm{kN}$). If there are no piles, treat the pile loads list as empty and the boolean as true.\n- Ensure internal unit consistency using the specified conversions.\n\nAngle units do not apply. Express all requested physical quantities in the specified units.\n\nTest suite (each case is independent). For each case, the inputs are provided as $(Q,\\;A,\\;k_s,\\;K_p,\\;\\{C_i\\})$ with the units specified above:\n- Case $1$ (happy path, moderate interaction, four piles):\n  - $Q = 60000$\n  - $A = 400$\n  - $k_s = 30$\n  - $K_p$ (in $\\mathrm{GN/m}$):\n    - $4 \\times 4$ matrix with diagonal entries $0.8$ and off-diagonal entries $0.16$\n  - Capacities $\\{C_i\\}$ (in $\\mathrm{kN}$): $\\{6000, 6000, 6000, 6000\\}$\n- Case $2$ (boundary case, no piles):\n  - $Q = 20000$\n  - $A = 300$\n  - $k_s = 15$\n  - $K_p$: empty (no piles)\n  - Capacities: empty\n- Case $3$ (heterogeneous group and strong pile share):\n  - $Q = 50000$\n  - $A = 200$\n  - $k_s = 5$\n  - $K_p$ (in $\\mathrm{GN/m}$):\n    - $\n      \\begin{bmatrix}\n      1.5 & 0.25 & 0.15 \\\\\n      0.25 & 1.2 & 0.20 \\\\\n      0.15 & 0.20 & 0.9\n      \\end{bmatrix}\n      $\n  - Capacities $\\{C_i\\}$ (in $\\mathrm{kN}$): $\\{17000, 14000, 9500\\}$\n- Case $4$ (high interaction, two piles):\n  - $Q = 10000$\n  - $A = 250$\n  - $k_s = 10$\n  - $K_p$ (in $\\mathrm{GN/m}$):\n    - $\n      \\begin{bmatrix}\n      0.6 & 0.54 \\\\\n      0.54 & 0.6\n      \\end{bmatrix}\n      $\n  - Capacities $\\{C_i\\}$ (in $\\mathrm{kN}$): $\\{2500, 2500\\}$\n\nFinal output format requirement:\n- Your program should produce a single line of output containing the results for all test cases as a comma-separated list enclosed in square brackets. Each test case result must itself be a list of the form $[u_{\\mathrm{mm}},\\;Q_{r,\\mathrm{kN}},\\;[q_{1,\\mathrm{kN}},\\dots,q_{n,\\mathrm{kN}}],\\;\\text{safe}]$, where $u_{\\mathrm{mm}}$ is the settlement in $\\mathrm{mm}$, $Q_{r,\\mathrm{kN}}$ is the raft load in $\\mathrm{kN}$, the inner list contains the pile loads in $\\mathrm{kN}$, and $\\text{safe}$ is the boolean safety indicator. For example, the overall output must look like $[[\\cdot,\\cdot,[\\cdot],\\cdot],[\\cdot,\\cdot,[\\cdot],\\cdot],\\dots]$ with no additional text.", "solution": "The user-provided problem is assessed to be **valid**. It is scientifically sound, well-posed, objective, and contains all necessary information for a unique solution. The problem is a standard exercise in computational geomechanics, specifically the linear elastic analysis of a piled raft foundation. We will now proceed with a formal derivation of the solution, followed by the implementation of a computational procedure.\n\nThe derivation is based on three fundamental principles as specified: (i) static equilibrium, (ii) kinematic compatibility, and (iii) linear elastic constitutive relations. All quantities are expressed in base SI units (Newtons, meters) during the derivation.\n\nLet $u$ be the uniform vertical settlement of the rigid raft in meters [$\\mathrm{m}$].\nLet $Q$ be the total applied vertical load in Newtons [$\\mathrm{N}$].\nLet $A$ be the raft plan area in square meters [$\\mathrm{m}^2$].\nLet $k_s$ be the subgrade modulus in Pascals per meter [$\\mathrm{N/m^3}$].\nLet $K_r$ be the equivalent vertical stiffness of the raft-soil contact in Newtons per meter [$\\mathrm{N/m}$].\nLet $n$ be the number of piles. For $n>0$, let $K_p \\in \\mathbb{R}^{n \\times n}$ be the pile group interaction stiffness matrix in Newtons per meter [$\\mathrm{N/m}$].\n\nThe problem is to find the settlement $u$, the load carried by the raft-soil contact $Q_r$, and the load vector for the piles $\\mathbf{q} = [q_1, q_2, \\dots, q_n]^T$.\n\n**1. Kinematic Compatibility**\nThe problem states that the raft is rigid and undergoes a uniform vertical displacement $u$. Since the piles are connected to the raft, all pile heads must experience the same settlement. Let $\\mathbf{u}_p$ be the vector of pile-head displacements.\nThen,\n$$ \\mathbf{u}_p = \\begin{bmatrix} u \\\\ u \\\\ \\vdots \\\\ u \\end{bmatrix} = u \\cdot \\mathbf{1} $$\nwhere $\\mathbf{1}$ is a column vector of size $n$ with all entries equal to $1$.\n\n**2. Constitutive Relations**\nThe system components are modeled as linear elastic springs.\n- **Raft-Soil Contact**: The reactive force from the soil beneath the raft, $Q_r$, is proportional to the settlement $u$.\n  Per the problem definition, the equivalent raft-soil stiffness is $K_r = k_s \\cdot A$. The constitutive law is:\n  $$ Q_r = K_r \\cdot u $$\n\n- **Pile Group**: The vector of pile-head forces, $\\mathbf{q}$, is related to the vector of pile-head displacements, $\\mathbf{u}_p$, by the pile group stiffness matrix $K_p$.\n  $$ \\mathbf{q} = K_p \\mathbf{u}_p $$\n  Substituting the compatibility condition $\\mathbf{u}_p = u \\cdot \\mathbf{1}$ into this relation gives:\n  $$ \\mathbf{q} = K_p (u \\cdot \\mathbf{1}) = u (K_p \\mathbf{1}) $$\n  This equation provides the load $q_i$ on each individual pile $i$ as a function of the unknown settlement $u$. The term $K_p \\mathbf{1}$ is a vector whose $i$-th element is the sum of all stiffness coefficients in the $i$-th row of $K_p$, i.e., $\\sum_{j=1}^{n} K_{p,ij}$.\n\nThe total load carried by the entire pile group, $Q_p$, is the sum of the individual pile loads:\n$$ Q_p = \\sum_{i=1}^{n} q_i = \\mathbf{1}^T \\mathbf{q} $$\nSubstituting the expression for $\\mathbf{q}$:\n$$ Q_p = \\mathbf{1}^T (u K_p \\mathbf{1}) = u (\\mathbf{1}^T K_p \\mathbf{1}) $$\nThe scalar quantity $K_{p,group} = \\mathbf{1}^T K_p \\mathbf{1} = \\sum_{i=1}^{n} \\sum_{j=1}^{n} K_{p,ij}$ represents the overall stiffness of the pile group when subjected to a uniform displacement. It is calculated by summing all elements of the matrix $K_p$. The total pile group load is thus:\n$$ Q_p = K_{p,group} \\cdot u $$\nIf there are no piles ($n=0$), then $K_{p,group}=0$ and $Q_p=0$.\n\n**3. Static Equilibrium**\nFor the piled raft system to be in static equilibrium, the total applied load $Q$ must be balanced by the sum of all upward reactions from the foundation. These reactions are the raft-soil contact force $Q_r$ and the total pile group force $Q_p$.\n$$ Q = Q_r + Q_p $$\nSubstituting the constitutive relations for $Q_r$ and $Q_p$ into the equilibrium equation:\n$$ Q = (K_r \\cdot u) + (K_{p,group} \\cdot u) $$\nFactoring out the settlement $u$:\n$$ Q = (K_r + K_{p,group}) \\cdot u $$\nThis is the governing equation for the single-degree-of-freedom system. The term $K_{total} = K_r + K_{p,group}$ is the total stiffness of the piled raft foundation.\n\n**4. Computational Algorithm**\nBased on the derivation, the computational procedure is as follows:\n\n- **Step 1: Unit Conversion and Stiffness Calculation.**\n  - Convert all input parameters to base SI units (N, m).\n    - $Q\\;[\\mathrm{N}] = Q\\;[\\mathrm{kN}] \\times 10^3$\n    - $k_s\\;[\\mathrm{N/m^3}] = k_s\\;[\\mathrm{MN/m^3}] \\times 10^6$\n    - $K_p\\;[\\mathrm{N/m}] = K_p\\;[\\mathrm{GN/m}] \\times 10^9$\n  - Calculate raft stiffness: $K_r = k_s \\cdot A$.\n  - Calculate pile group stiffness: If $n > 0$, $K_{p,group} = \\sum_{i,j} K_{p,ij}$. If $n=0$, $K_{p,group} = 0$.\n  - Calculate total system stiffness: $K_{total} = K_r + K_{p,group}$.\n\n- **Step 2: Solve for Settlement.**\n  - The uniform settlement $u$ is calculated from the governing equilibrium equation:\n    $$ u = \\frac{Q}{K_{total}} $$\n\n- **Step 3: Determine Load Distribution.**\n  - Raft-soil contact load: $Q_r = K_r \\cdot u$.\n  - Pile loads: If $n > 0$, the vector of pile loads $\\mathbf{q}$ is calculated as $\\mathbf{q} = u (K_p \\mathbf{1})$. If $n=0$, the pile load vector is empty.\n\n- **Step 4: Perform Safety Check.**\n  - For each pile $i$, compare its calculated load $q_i$ to its allowable capacity $C_i$. Note that both must be in the same units (e.g., $\\mathrm{kN}$) for a valid comparison.\n  - The foundation is deemed 'safe' if $q_i \\le C_i$ for all piles. For a foundation with no piles, this condition is vacuously true.\n\n- **Step 5: Format Output.**\n  - Convert the calculated settlement $u$ to millimeters ($u \\times 1000$), raft load $Q_r$ to kiloNewtons ($Q_r / 1000$), and pile loads $q_i$ to kiloNewtons ($q_i / 1000$).\n  - Round the values to the specified number of decimal places.\n  - Assemble the results into the required list format.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print the final output.\n    \"\"\"\n    \n    # Test suite definition\n    test_cases = [\n        # Case 1: (Q, A, k_s, K_p, {C_i})\n        (60000, 400, 30, \n         [[0.8, 0.16, 0.16, 0.16], \n          [0.16, 0.8, 0.16, 0.16], \n          [0.16, 0.16, 0.8, 0.16], \n          [0.16, 0.16, 0.16, 0.8]], \n         [6000, 6000, 6000, 6000]),\n        # Case 2: No piles\n        (20000, 300, 15, [], []),\n        # Case 3: Heterogeneous group\n        (50000, 200, 5, \n         [[1.5, 0.25, 0.15], \n          [0.25, 1.2, 0.20], \n          [0.15, 0.20, 0.9]], \n         [17000, 14000, 9500]),\n        # Case 4: High interaction\n        (10000, 250, 10, \n         [[0.6, 0.54], \n          [0.54, 0.6]], \n         [2500, 2500])\n    ]\n\n    results = []\n    for case in test_cases:\n        result = calculate_case(*case)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    # The str() representation of a list of lists is the desired format.\n    print(f\"{results}\".replace(\"'\", \"\").replace(\" \", \"\"))\n\ndef calculate_case(Q_kN, A_m2, ks_MN_m3, Kp_GN_m, C_kN):\n    \"\"\"\n    Calculates settlement and load distribution for a single piled raft case.\n\n    Args:\n        Q_kN (float): Total applied load in kN.\n        A_m2 (float): Raft plan area in m^2.\n        ks_MN_m3 (float): Subgrade modulus in MN/m^3.\n        Kp_GN_m (list of lists): Pile group stiffness matrix in GN/m.\n        C_kN (list of float): Pile capacities in kN.\n\n    Returns:\n        list: [settlement_mm, raft_load_kN, pile_loads_kN_list, is_safe_boolean]\n    \"\"\"\n    # Unit conversions to base SI units (N, m)\n    Q_N = Q_kN * 1e3\n    ks_N_m3 = ks_MN_m3 * 1e6\n\n    # Step 1: Calculate Stiffnesses\n    # Raft-soil contact stiffness\n    Kr_N_m = ks_N_m3 * A_m2\n\n    # Pile group stiffness\n    if not Kp_GN_m:\n        n_piles = 0\n        Kp_group_N_m = 0.0\n        Kp_N_m = np.array([])\n    else:\n        Kp_GN_m_np = np.array(Kp_GN_m)\n        n_piles = Kp_GN_m_np.shape[0]\n        Kp_N_m = Kp_GN_m_np * 1e9\n        # Equivalent group stiffness is the sum of all elements in the matrix\n        Kp_group_N_m = np.sum(Kp_N_m)\n    \n    # Total system stiffness\n    K_total_N_m = Kr_N_m + Kp_group_N_m\n\n    # Step 2: Calculate Settlement\n    # Safeguard against non-positive stiffness, though physically not expected\n    if K_total_N_m = 0:\n        return [0.0, 0.0, [], False]\n\n    u_m = Q_N / K_total_N_m\n    u_mm = u_m * 1e3\n\n    # Step 3: Determine Load Distribution\n    # Raft-soil contact load\n    Qr_N = Kr_N_m * u_m\n    Qr_kN = Qr_N / 1e3\n\n    # Pile loads\n    q_kN_list = []\n    is_safe = True\n    if n_piles > 0:\n        # q = u * (K_p * 1), where K_p*1 is a vector of row sums\n        row_sums_N_m = np.sum(Kp_N_m, axis=1)\n        q_N_vector = u_m * row_sums_N_m\n        q_kN_vector = q_N_vector / 1e3\n        \n        q_kN_list = [round(q, 2) for q in q_kN_vector]\n        \n        # Step 4: Perform Safety Check\n        C_kN_np = np.array(C_kN)\n        # Using a small tolerance for floating point comparisons\n        is_safe = np.all(q_kN_vector = C_kN_np + 1e-9)\n    else: # n_piles == 0\n        is_safe = True\n        q_kN_list = []\n\n    # Step 5: Format Output\n    u_mm_rounded = round(u_mm, 3)\n    Qr_kN_rounded = round(Qr_kN, 2)\n    \n    return [u_mm_rounded, Qr_kN_rounded, q_kN_list, is_safe]\n\n\nsolve()\n```", "id": "3499751"}, {"introduction": "Advanced computational analysis of deep foundations relies on accurate models for the non-linear interaction at the pile-soil interface. This practice moves from system-level analysis to the core of numerical implementation, tasking you with developing a constitutive routine for a frictional contact interface [@problem_id:3499747]. You will implement an elasto-plastic model with a return mapping algorithm and derive the consistent tangent matrix, providing essential skills for developing or using sophisticated finite element software.", "problem": "You are tasked with implementing a constitutive integration and consistent tangent operator for a two-dimensional interface model representative of the interaction between a pile and surrounding soil. The interface kinematics are idealized by a displacement jump vector $\\boldsymbol{w} = [w_n, w_t]^T$ between the pile surface and the adjacent soil, decomposed into a normal component $w_n$ and a tangential component $w_t$. The corresponding traction vector is $\\boldsymbol{t} = [t_n, t_t]^T$, with $t_n$ the normal traction (compression positive) and $t_t$ the tangential traction. Use a penalty regularization in the normal and tangential directions with elastic stiffnesses $k_n^e$ and $k_t^e$ respectively, and Coulomb friction with cohesion parameter $c$ under compression. Opening (tension) contact carries no traction.\n\nStart from the following fundamental principles and definitions:\n- The interface enforces unilateral contact in the normal direction and Coulomb friction in tangential direction. This is modeled by a normal traction $t_n$ that opposes interpenetration and vanishes in tension, and a tangential traction $t_t$ limited by a friction bound under compression.\n- The elastic trial state follows from penalty elasticity: $t_n^{\\text{trial}} = -k_n^e w_n$ and $t_t^{\\text{trial}} = k_t^e w_t$.\n- Contact opening rule: for $w_n \\ge 0$ (opening, tension), the interface carries no traction, i.e., $t_n = 0$ and $t_t = 0$.\n- Contact compression rule: for $w_n  0$, the normal traction is compressive and given by $t_n = -k_n^e w_n  0$.\n- Frictional limit with cohesion under compression: when $w_n  0$, the admissible tangential traction is bounded by $|t_t| \\le \\mu t_n + c$, where $\\mu$ is the friction coefficient and $c$ is the cohesion. If $|t_t^{\\text{trial}}| \\le \\mu t_n + c$, the response in the tangential direction is elastic-sticking; if $|t_t^{\\text{trial}}|  \\mu t_n + c$, sliding occurs and the updated tangential traction is $t_t = \\operatorname{sign}(t_t^{\\text{trial}})\\,(\\mu t_n + c)$.\n\nYour program must:\n1. Implement the constitutive integration that maps a given displacement jump $\\boldsymbol{w}$ to interface traction $\\boldsymbol{t}$ by applying the described elastic predictor, contact opening rule, and frictional return mapping under compression.\n2. Compute the consistent algorithmic tangent matrix $\\boldsymbol{K} = \\partial \\boldsymbol{t} / \\partial \\boldsymbol{w}$, a $2 \\times 2$ matrix with components $K_{nn} = \\partial t_n / \\partial w_n$, $K_{nt} = \\partial t_n / \\partial w_t$, $K_{tn} = \\partial t_t / \\partial w_n$, and $K_{tt} = \\partial t_t / \\partial w_t$, derived from the same constitutive model. Under opening ($w_n \\ge 0$), set $\\boldsymbol{K} = \\boldsymbol{0}$. Under compression ($w_n  0$), for elastic-sticking, set $K_{nn} = -k_n^e$, $K_{tt} = k_t^e$, and $K_{nt} = K_{tn} = 0$. Under sliding, set $K_{nn} = -k_n^e$, $K_{tt} = 0$, $K_{nt} = 0$, and $K_{tn} = \\operatorname{sign}(w_t)\\,\\mu\\,(-k_n^e)$.\n\nPhysical units and output requirements:\n- The stiffnesses $k_n^e$ and $k_t^e$ are given in $\\text{Pa}/\\text{m}$.\n- The friction coefficient $\\mu$ is dimensionless, and the cohesion $c$ is in $\\text{Pa}$.\n- The displacement jumps $w_n$ and $w_t$ are in $\\text{m}$.\n- Express $t_n$ and $t_t$ in $\\text{Pa}$, and the tangent matrix entries in $\\text{Pa}/\\text{m}$.\n\nYour program should process the following test suite of parameter sets and displacement jumps, with fixed material parameters $k_n^e = 10^9\\,\\text{Pa}/\\text{m}$, $k_t^e = 5 \\times 10^8\\,\\text{Pa}/\\text{m}$, $\\mu = 0.4$, and $c = 5 \\times 10^4\\,\\text{Pa}$:\n- Test case 1 (compression, sticking): $w_n = -1\\times 10^{-4}\\,\\text{m}$, $w_t = 1\\times 10^{-4}\\,\\text{m}$.\n- Test case 2 (compression, sliding): $w_n = -1\\times 10^{-4}\\,\\text{m}$, $w_t = 3\\times 10^{-4}\\,\\text{m}$.\n- Test case 3 (opening, no traction): $w_n = +1\\times 10^{-4}\\,\\text{m}$, $w_t = 2\\times 10^{-4}\\,\\text{m}$.\n- Test case 4 (compression, sliding with negative tangential jump): $w_n = -2\\times 10^{-4}\\,\\text{m}$, $w_t = -1\\times 10^{-3}\\,\\text{m}$.\n- Test case 5 (boundary case at friction limit, treat as sticking): $w_n = -1\\times 10^{-4}\\,\\text{m}$, $w_t = 1.8\\times 10^{-4}\\,\\text{m}$.\n\nFor each test case, compute the list $[t_n, t_t, K_{nn}, K_{nt}, K_{tn}, K_{tt}]$ in the specified units. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element corresponds to one test case and is itself a list in the form $[t_n, t_t, K_{nn}, K_{nt}, K_{tn}, K_{tt}]$ using Python list notation. All numerical outputs must be floating-point numbers.", "solution": "The problem requires the implementation of a constitutive integration algorithm for a two-dimensional pile-soil interface model. This algorithm must compute the interface traction vector $\\boldsymbol{t} = [t_n, t_t]^T$ and the corresponding consistent algorithmic tangent matrix $\\boldsymbol{K} = \\partial \\boldsymbol{t} / \\partial \\boldsymbol{w}$ for a given displacement jump vector $\\boldsymbol{w} = [w_n, w_t]^T$. The model incorporates unilateral contact in the normal direction and Coulomb friction with cohesion in the tangential direction.\n\nThe algorithm proceeds by analyzing the state of contact based on the normal displacement jump $w_n$. The logic is divided into two primary cases: contact opening ($w_n \\ge 0$) and contact compression ($w_n  0$).\n\n**Case 1: Contact Opening ($w_n \\ge 0$)**\n\nAccording to the specified opening rule, an interface in tension ($w_n  0$) or at the point of zero normal displacement ($w_n = 0$) cannot sustain any traction.\n\n- **Traction Update**: The normal and tangential tractions are both zero.\n$$\nt_n = 0\n$$\n$$\nt_t = 0\n$$\n- **Consistent Tangent Update**: Since the tractions are constant (zero) in this entire regime, their derivatives with respect to the displacement jumps are zero. The consistent tangent matrix is the zero matrix.\n$$\n\\boldsymbol{K} = \\frac{\\partial \\boldsymbol{t}}{\\partial \\boldsymbol{w}} = \\begin{pmatrix} 0  0 \\\\ 0  0 \\end{pmatrix}\n$$\n\n**Case 2: Contact Compression ($w_n  0$)**\n\nWhen the interface is in compression, a more complex elasto-plastic framework is activated. The process follows a standard predictor-corrector scheme.\n\n**Step 2.1: Elastic Predictor (Trial State)**\n\nFirst, we assume a purely elastic response to compute a trial state.\n- **Normal Traction**: The normal traction is compressive and is determined by the penalty stiffness $k_n^e$. The positive sign convention for compression and negative $w_n$ for interpenetration leads to:\n$$\nt_n = -k_n^e w_n\n$$\nNote that since $w_n  0$ and $k_n^e  0$, the normal traction $t_n$ is positive, consistent with the definition of compression. This relation holds for both sticking and sliding under compression.\n\n- **Trial Tangential Traction**: The trial tangential traction is computed elastically using the tangential penalty stiffness $k_t^e$:\n$$\nt_t^{\\text{trial}} = k_t^e w_t\n$$\n\n**Step 2.2: Frictional Yield Check**\n\nThe trial tangential traction must be checked against the friction criterion. The maximum admissible magnitude for the tangential traction is defined by the Coulomb friction law with cohesion, which depends on the current normal traction $t_n$:\n$$\n\\Phi_{\\text{limit}} = \\mu t_n + c\n$$\nThe condition for remaining in the elastic (sticking) regime is:\n$$\n|t_t^{\\text{trial}}| \\le \\Phi_{\\text{limit}}\n$$\nIf this inequality is violated, plastic slip (sliding) occurs.\n\n**Step 2.3: State Determination and Update**\n\nBased on the yield check, the final tractions and the consistent tangent are determined.\n\n**Sub-case 2.3.a: Elastic-Sticking ($|t_t^{\\text{trial}}| \\le \\Phi_{\\text{limit}}$)**\n\nThe trial state is admissible. The response is elastic.\n\n- **Traction Update**: The final tangential traction is equal to its trial value.\n$$\nt_t = t_t^{\\text{trial}} = k_t^e w_t\n$$\n- **Consistent Tangent Update**: The tangent matrix is derived by differentiating the elastic constitutive relations $t_n = -k_n^e w_n$ and $t_t = k_t^e w_t$. The response is uncoupled.\n$$\nK_{nn} = \\frac{\\partial t_n}{\\partial w_n} = -k_n^e\n$$\n$$\nK_{nt} = \\frac{\\partial t_n}{\\partial w_t} = 0\n$$\n$$\nK_{tn} = \\frac{\\partial t_t}{\\partial w_n} = 0\n$$\n$$\nK_{tt} = \\frac{\\partial t_t}{\\partial w_t} = k_t^e\n$$\nThe tangent matrix is diagonal: $\\boldsymbol{K}^{\\text{stick}} = \\begin{pmatrix} -k_n^e  0 \\\\ 0  k_t^e \\end{pmatrix}$.\n\n**Sub-case 2.3.b: Sliding ($|t_t^{\\text{trial}}|  \\Phi_{\\text{limit}}$)**\n\nThe trial state is inadmissible. A plastic corrector, or return mapping, is applied to enforce the yield condition.\n\n- **Traction Update**: The tangential traction is returned to the yield surface, preserving the direction of the trial step.\n$$\nt_t = \\operatorname{sign}(t_t^{\\text{trial}}) \\Phi_{\\text{limit}} = \\operatorname{sign}(k_t^e w_t) (\\mu t_n + c)\n$$\nSince $k_t^e  0$, this simplifies to:\n$$\nt_t = \\operatorname{sign}(w_t) (\\mu (-k_n^e w_n) + c)\n$$\n- **Consistent Tangent Update**: The tangent matrix is derived from the active constitutive relations for the sliding state. A non-zero off-diagonal term $K_{tn}$ appears, indicating coupling.\n$$\nK_{nn} = \\frac{\\partial t_n}{\\partial w_n} = -k_n^e\n$$\n$$\nK_{nt} = \\frac{\\partial t_n}{\\partial w_t} = 0\n$$\n$$\nK_{tn} = \\frac{\\partial t_t}{\\partial w_n} = \\frac{\\partial}{\\partial w_n} \\left[ \\operatorname{sign}(w_t) (\\mu (-k_n^e w_n) + c) \\right] = \\operatorname{sign}(w_t) \\mu (-k_n^e)\n$$\n$$\nK_{tt} = \\frac{\\partial t_t}{\\partial w_t} = \\frac{\\partial}{\\partial w_t} \\left[ \\operatorname{sign}(w_t) (\\mu (-k_n^e w_n) + c) \\right] = 0\n$$\nThe derivative of $\\operatorname{sign}(w_t)$ is zero for $w_t \\ne 0$. The tangent matrix is non-symmetric: $\\boldsymbol{K}^{\\text{slide}} = \\begin{pmatrix} -k_n^e  0 \\\\ \\operatorname{sign}(w_t) \\mu (-k_n^e)  0 \\end{pmatrix}$.\n\nThe implementation will apply this logic to each test case, using the provided material parameters, to compute the list $[t_n, t_t, K_{nn}, K_{nt}, K_{tn}, K_{tt}]$ for each.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef calculate_interface_response(wn: float, wt: float, kn_e: float, kt_e: float, mu: float, c: float) -> list[float]:\n    \"\"\"\n    Computes the interface traction and consistent tangent matrix for a given displacement jump.\n\n    Args:\n        wn: Normal displacement jump (m).\n        wt: Tangential displacement jump (m).\n        kn_e: Normal elastic stiffness (Pa/m).\n        kt_e: Tangential elastic stiffness (Pa/m).\n        mu: Friction coefficient (dimensionless).\n        c: Cohesion (Pa).\n\n    Returns:\n        A list containing [tn, tt, Knn, Knt, Ktn, Ktt].\n    \"\"\"\n    tn, tt = 0.0, 0.0\n    Knn, Knt, Ktn, Ktt = 0.0, 0.0, 0.0, 0.0\n\n    # Case 1: Contact Opening (wn >= 0)\n    if wn >= 0:\n        # Tractions and tangent matrix are zero.\n        # Initial values are already correct.\n        pass\n    # Case 2: Contact Compression (wn  0)\n    else:\n        # Normal traction (always elastic in compression)\n        tn = -kn_e * wn\n\n        # Trial tangential traction (elastic predictor)\n        tt_trial = kt_e * wt\n\n        # Frictional limit\n        phi_limit = mu * tn + c\n\n        # Check for sticking vs. sliding\n        if abs(tt_trial) = phi_limit:\n            # Sub-case 2.3.a: Elastic-Sticking\n            tt = tt_trial\n            Knn = -kn_e\n            Ktt = kt_e\n            # Knt and Ktn remain 0.0\n        else:\n            # Sub-case 2.3.b: Sliding (return mapping)\n            sign_wt = np.sign(wt)\n            tt = sign_wt * phi_limit\n            \n            Knn = -kn_e\n            Ktn = sign_wt * mu * (-kn_e)\n            # Knt and Ktt remain 0.0\n\n    return [tn, tt, Knn, Knt, Ktn, Ktt]\n\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the given test suite.\n    \"\"\"\n    # Fixed material parameters\n    kn_e = 1e9    # Pa/m\n    kt_e = 5e8    # Pa/m\n    mu = 0.4      # dimensionless\n    c = 5e4       # Pa\n\n    # Test suite: list of tuples (wn, wt) in meters\n    test_cases = [\n        # Test case 1 (compression, sticking)\n        (-1e-4, 1e-4),\n        # Test case 2 (compression, sliding)\n        (-1e-4, 3e-4),\n        # Test case 3 (opening, no traction)\n        (1e-4, 2e-4),\n        # Test case 4 (compression, sliding with negative tangential jump)\n        (-2e-4, -1e-3),\n        # Test case 5 (boundary case at friction limit, treat as sticking)\n        (-1e-4, 1.8e-4),\n    ]\n\n    all_results = []\n    for wn, wt in test_cases:\n        result_vector = calculate_interface_response(wn, wt, kn_e, kt_e, mu, c)\n        # Convert the list to its string representation for the final output format\n        all_results.append(str(result_vector))\n\n    # The final print must be a single line containing a list of lists.\n    # Joining the string representations of each list achieves this.\n    print(f\"[{','.join(all_results)}]\")\n\n\nsolve()\n```", "id": "3499747"}]}