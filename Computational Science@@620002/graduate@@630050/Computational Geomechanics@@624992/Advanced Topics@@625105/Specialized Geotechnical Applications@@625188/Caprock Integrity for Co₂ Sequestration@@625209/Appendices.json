{"hands_on_practices": [{"introduction": "The first step in assessing caprock integrity is understanding how the pressure increase from CO₂ injection propagates from the reservoir into the overlying sealing layer. This process is not instantaneous; it is governed by pressure diffusion, a fundamental concept rooted in mass conservation and Darcy's law. This exercise guides you through the derivation of the governing pressure diffusion equation to determine the characteristic timescale for this process, a critical parameter for any safety assessment [@problem_id:3505776].", "problem": "A deep saline reservoir is being used for geological storage of carbon dioxide ($\\text{CO}_2$). Injection induces an overpressure at the reservoir-caprock interface. The caprock is clay-rich, laterally extensive, and transversely isotropic with vertical intrinsic permeability $k_v$ much smaller than horizontal permeability. Treat the caprock as a homogeneous, linearly deformable porous medium saturated with a slightly compressible brine, and consider small perturbations about an initial hydrostatic state. Assume isothermal conditions and neglect gravitational, capillary, and chemical effects.\n\nStarting from the local conservation of mass for a single-phase fluid in a deformable porous medium and Darcy’s law for laminar flow in porous media, derive the governing pressure evolution equation in the caprock for small perturbations. Clearly state the assumptions that allow reduction to a scalar pressure diffusion form and identify the diffusion coefficient in terms of the vertical intrinsic permeability $k_v$, the dynamic viscosity $\\mu$, and the total compressibility $c_t$ of the fluid–solid system. Here, you may define $c_t$ in terms of fluid compressibility and pore-volume (matrix) compressibility, but do not assume any specific constitutive model beyond linearity and small perturbations.\n\nThen, considering one-dimensional vertical pressure propagation across the caprock thickness $H$ from the reservoir-caprock interface to the caprock top, use dimensional analysis or nondimensionalization to obtain the characteristic timescale for pressure diffusion across the thickness $H$. Express your final timescale in seconds as a closed-form analytic expression in terms of $H$, $\\mu$, $c_t$, and $k_v$. Do not include units in the final boxed answer.", "solution": "The problem is first validated to ensure it is scientifically sound, well-posed, and objective.\n\n### Step 1: Extract Givens\n- **System**: A clay-rich, laterally extensive, transversely isotropic caprock overlying a deep saline reservoir used for $\\text{CO}_2$ storage.\n- **Medium Properties**:\n    - The caprock is a homogeneous, linearly deformable porous medium.\n    - It is saturated with a slightly compressible brine (single-phase fluid).\n    - It has vertical intrinsic permeability $k_v$ and horizontal permeability $k_h$, with $k_v \\ll k_h$.\n    - Other relevant properties are dynamic viscosity $\\mu$, total compressibility $c_t$, and thickness $H$.\n- **Process**: $\\text{CO}_2$ injection causes an overpressure at the reservoir-caprock interface. We are to model the pressure evolution in the caprock.\n- **Initial State**: Small perturbations about an initial hydrostatic state.\n- **Assumptions**:\n    - Isothermal conditions.\n    - Gravitational, capillary, and chemical effects are neglected.\n- **Task 1**: Starting from local mass conservation and Darcy's law, derive the governing pressure evolution equation, state the assumptions for its reduction to a scalar diffusion form, and identify the diffusion coefficient in terms of $k_v$, $\\mu$, and $c_t$.\n- **Task 2**: For 1D vertical propagation, use dimensional analysis or nondimensionalization to find the characteristic timescale for pressure diffusion across the thickness $H$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, rooted in the well-established theory of fluid flow in porous media (poroelasticity and hydrogeology). The application to $\\text{CO}_2$ sequestration is a critical topic in contemporary geomechanics. The problem is well-posed, providing a clear path from fundamental principles to a specific result (a governing equation and a timescale). The terminology is objective and standard. The assumptions, such as small perturbations, isothermal conditions, and neglecting gravity, are common and appropriate for deriving a linearized diffusion model. The setup is self-contained and internally consistent. The transition from a transversely isotropic medium to a 1D vertical problem is logical for analyzing pressure diffusion across a caprock's thickness. The problem is non-trivial and requires a formal derivation.\n\n### Step 3: Verdict and Action\nThe problem is valid. A full, reasoned solution will be provided.\n\n### Derivation of the Governing Equation\n\nThe derivation begins by combining the principles of mass conservation and momentum conservation (via Darcy's law) for a single-phase fluid in a deformable porous medium.\n\n1.  **Mass Conservation**: The local conservation of mass for the fluid phase within a fixed control volume states that the rate of change of fluid mass is equal to the net rate of mass influx.\n    $$\n    \\frac{\\partial (\\phi \\rho_f)}{\\partial t} + \\nabla \\cdot (\\rho_f \\mathbf{v}) = 0\n    $$\n    Here, $\\phi$ is the porosity, $\\rho_f$ is the fluid density, $t$ is time, and $\\mathbf{v}$ is the Darcy velocity (specific discharge).\n\n2.  **Darcy's Law**: For laminar flow in a porous medium, and neglecting gravitational effects as stipulated, Darcy's law relates the fluid velocity to the pressure gradient.\n    $$\n    \\mathbf{v} = -\\frac{\\mathbf{k}}{\\mu} \\nabla p\n    $$\n    where $\\mathbf{k}$ is the intrinsic permeability tensor, $\\mu$ is the fluid's dynamic viscosity, and $p$ is the fluid pressure.\n\n3.  **Combining Equations**: Substituting Darcy's law into the mass conservation equation yields:\n    $$\n    \\frac{\\partial (\\phi \\rho_f)}{\\partial t} - \\nabla \\cdot \\left( \\rho_f \\frac{\\mathbf{k}}{\\mu} \\nabla p \\right) = 0\n    $$\n\n4.  **Constitutive Relations and Linearization**: The time-derivative term, known as the storage term, must be expressed in terms of the rate of change of pressure. We use the chain rule:\n    $$\n    \\frac{\\partial (\\phi \\rho_f)}{\\partial t} = \\rho_f \\frac{\\partial \\phi}{\\partial t} + \\phi \\frac{\\partial \\rho_f}{\\partial t}\n    $$\n    We linearize the relationships for small perturbations. The fluid density change is related to the pressure change via the fluid compressibility, $c_f$:\n    $$\n    c_f = \\frac{1}{\\rho_f} \\frac{d\\rho_f}{dp} \\implies \\frac{\\partial \\rho_f}{\\partial t} = \\frac{d\\rho_f}{dp} \\frac{\\partial p}{\\partial t} = \\rho_f c_f \\frac{\\partial p}{\\partial t}\n    $$\n    The porosity change is due to the deformation of the solid matrix under a change in effective stress. For a linearly deformable medium under conditions of constant total stress (a reasonable assumption for perturbations deep underground), a change in pore pressure $dp$ leads to a change in effective stress $d\\sigma' = -dp$. The change in porosity is related to the uniaxial compressibility of the porous matrix, $c_m$, which is defined under the condition of zero lateral strain. Assuming incompressible solid grains, the change in porosity is given by:\n    $$\n    \\frac{d\\phi}{dp} = (1-\\phi) c_m\n    $$\n    Therefore, the rate of change of porosity is:\n    $$\n    \\frac{\\partial \\phi}{\\partial t} = (1-\\phi) c_m \\frac{\\partial p}{\\partial t}\n    $$\n    Substituting these expressions into the storage term expansion:\n    $$\n    \\frac{\\partial (\\phi \\rho_f)}{\\partial t} = \\rho_f \\left( (1-\\phi) c_m \\frac{\\partial p}{\\partial t} \\right) + \\phi \\left( \\rho_f c_f \\frac{\\partial p}{\\partial t} \\right) = \\rho_f \\left[ \\phi c_f + (1-\\phi)c_m \\right] \\frac{\\partial p}{\\partial t}\n    $$\n    We define the total compressibility of the fluid-solid system, $c_t$, as the term in the brackets. This definition correctly accounts for storage due to both fluid expansion and pore volume compression.\n    $$\n    c_t = \\phi c_f + (1-\\phi)c_m\n    $$\n    Thus, the storage term simplifies to:\n    $$\n    \\frac{\\partial (\\phi \\rho_f)}{\\partial t} = \\rho_f c_t \\frac{\\partial p}{\\partial t}\n    $$\n\n5.  **Assembling the Full Equation**: Substituting the simplified storage term back into the combined equation:\n    $$\n    \\rho_f c_t \\frac{\\partial p}{\\partial t} - \\nabla \\cdot \\left( \\rho_f \\frac{\\mathbf{k}}{\\mu} \\nabla p \\right) = 0\n    $$\n    For small perturbations, variations in $\\rho_f$ and $\\mu$ are negligible, so they can be treated as constants and taken out of the divergence operator. Dividing by the constant $\\rho_f$:\n    $$\n    c_t \\frac{\\partial p}{\\partial t} - \\frac{1}{\\mu} \\nabla \\cdot (\\mathbf{k} \\nabla p) = 0\n    $$\n    Since the caprock is homogeneous, the permeability tensor $\\mathbf{k}$ is constant in space, so $\\nabla \\cdot (\\mathbf{k} \\nabla p) = \\sum_{i,j} k_{ij} \\frac{\\partial^2 p}{\\partial x_i \\partial x_j}$. The medium is transversely isotropic with vertical permeability $k_v$ and horizontal permeability $k_h$. In a coordinate system where $z$ is the vertical direction, the equation becomes:\n    $$\n    c_t \\frac{\\partial p}{\\partial t} - \\frac{1}{\\mu} \\left( k_h \\frac{\\partial^2 p}{\\partial x^2} + k_h \\frac{\\partial^2 p}{\\partial y^2} + k_v \\frac{\\partial^2 p}{\\partial z^2} \\right) = 0\n    $$\n    This is the governing equation for anisotropic pressure diffusion.\n\n6.  **Reduction to Scalar Diffusion Form**: To reduce this to a scalar (1D) diffusion equation, we must assume that the pressure propagation is predominantly in one direction. The problem considers pressure propagation vertically across the caprock. This corresponds to the physical situation of a laterally extensive, uniform overpressure at the reservoir-caprock interface, leading to negligible horizontal pressure gradients.\n    The key assumption is: $\\frac{\\partial p}{\\partial x} \\approx 0$ and $\\frac{\\partial p}{\\partial y} \\approx 0$.\n    Under this assumption, the equation simplifies to:\n    $$\n    c_t \\frac{\\partial p}{\\partial t} - \\frac{k_v}{\\mu} \\frac{\\partial^2 p}{\\partial z^2} = 0\n    $$\n    Rearranging this into the standard form of a diffusion equation:\n    $$\n    \\frac{\\partial p}{\\partial t} = \\left( \\frac{k_v}{\\mu c_t} \\right) \\frac{\\partial^2 p}{\\partial z^2}\n    $$\n    This is the desired scalar pressure diffusion equation. The term in parenthesis is the vertical pressure diffusion coefficient.\n\n7.  **Identification of the Diffusion Coefficient**: Comparing the derived 1D equation to the generic form $\\frac{\\partial p}{\\partial t} = C \\frac{\\partial^2 p}{\\partial z^2}$, we identify the vertical diffusion coefficient, $C_v$, as:\n    $$\n    C_v = \\frac{k_v}{\\mu c_t}\n    $$\n    The units of this coefficient are $[L^2 T^{-1}]$, as expected for a diffusivity.\n\n### Derivation of the Characteristic Timescale\n\nWe use nondimensionalization to determine the characteristic timescale, $\\tau$, for pressure diffusion across the caprock thickness $H$. We define the following dimensionless variables, denoted with a prime ($'$):\n-   Dimensionless time: $t' = t/\\tau$\n-   Dimensionless length: $z' = z/H$\n-   Dimensionless pressure: $p' = (p - p_{initial}) / \\Delta p_{max}$, where $\\Delta p_{max}$ is a characteristic pressure change.\n\nWe express the derivatives in the 1D diffusion equation in terms of these dimensionless variables:\n$$\n\\frac{\\partial p}{\\partial t} = \\frac{\\partial (\\Delta p_{max} p')}{\\partial t} = \\Delta p_{max} \\frac{\\partial p'}{\\partial t'} \\frac{dt'}{dt} = \\frac{\\Delta p_{max}}{\\tau} \\frac{\\partial p'}{\\partial t'}\n$$\n$$\n\\frac{\\partial^2 p}{\\partial z^2} = \\frac{\\partial^2 (\\Delta p_{max} p')}{\\partial z^2} = \\Delta p_{max} \\frac{\\partial^2 p'}{\\partial (z')^2} \\left(\\frac{dz'}{dz}\\right)^2 = \\frac{\\Delta p_{max}}{H^2} \\frac{\\partial^2 p'}{\\partial (z')^2}\n$$\nSubstituting these into the 1D diffusion equation:\n$$\n\\frac{\\Delta p_{max}}{\\tau} \\frac{\\partial p'}{\\partial t'} = C_v \\frac{\\Delta p_{max}}{H^2} \\frac{\\partial^2 p'}{\\partial (z')^2}\n$$\nDividing by $\\Delta p_{max}$ and rearranging gives the dimensionless equation:\n$$\n\\frac{\\partial p'}{\\partial t'} = \\left( \\frac{C_v \\tau}{H^2} \\right) \\frac{\\partial^2 p'}{\\partial (z')^2}\n$$\nFor a problem to be properly scaled, the coefficients in the dimensionless equation should be of order 1. We choose the characteristic timescale $\\tau$ to satisfy this condition, which means setting the dimensionless group in the parenthesis to 1:\n$$\n\\frac{C_v \\tau}{H^2} = 1\n$$\nSolving for $\\tau$ gives the characteristic timescale for diffusion:\n$$\n\\tau = \\frac{H^2}{C_v}\n$$\nFinally, substituting the expression for the vertical diffusion coefficient, $C_v = k_v/(\\mu c_t)$, we obtain the characteristic timescale in terms of the given physical parameters:\n$$\n\\tau = \\frac{H^2}{k_v / (\\mu c_t)} = \\frac{H^2 \\mu c_t}{k_v}\n$$\nThis expression represents the time required for a pressure transient to propagate across the characteristic length scale $H$ of the caprock.", "answer": "$$\n\\boxed{\\frac{H^2 \\mu c_t}{k_v}}\n$$", "id": "3505776"}, {"introduction": "Once the pore pressure in the caprock increases, it alters the state of stress within the rock matrix, potentially reactivating pre-existing fractures. This practice applies the effective stress principle and stress transformation rules to quantify how a uniform pore pressure increase translates into changes in normal and shear stress on a plane of arbitrary orientation. Mastering this calculation is essential for performing a slip-tendency analysis, which evaluates the risk of a fault or fracture becoming unstable [@problem_id:3505769].", "problem": "A laterally extensive saline aquifer is being used for Carbon Dioxide ($\\text{CO}_2$) injection beneath a shale caprock. Consider a point in the caprock immediately above the reservoir. A rapid increase of reservoir pore pressure produces an overpressure increment of $\\Delta p$ that induces a poroelastic total stress increment in the caprock at that point. Assume the caprock is linear elastic and, at the scale of interest, the induced total stress increment is spatially uniform and diagonal in the geographic Cartesian basis $(x,y,z)$ with $z$ vertical upward. Adopt the geomechanics sign convention that compressive stress is positive. The total stress increment tensor is approximated as\n$$\n\\Delta \\boldsymbol{\\sigma} = \\mathrm{diag}\\!\\left(c_h\\,\\Delta p,\\; c_h\\,\\Delta p,\\; c_v\\,\\Delta p\\right),\n$$\nwhere $c_h$ and $c_v$ are dimensionless coefficients characterizing the horizontal and vertical poroelastic stress coupling in the caprock near the reservoir-caprock interface.\n\nLet the caprock Biot effective stress coefficient be $\\alpha$, and use the effective stress definition $\\boldsymbol{\\sigma}'=\\boldsymbol{\\sigma}-\\alpha p\\,\\mathbf{I}$, where $\\mathbf{I}$ is the second-order identity. Consider a plane through the point whose unit normal $\\mathbf{n}$ is specified by spherical angles $(\\theta,\\phi)$ measured from the $z$-axis (polar) and from the $x$-axis within the $x$-$y$ plane (azimuth), respectively, with\n$$\n\\mathbf{n} = \\begin{pmatrix} \\sin\\theta \\cos\\phi \\\\ \\sin\\theta \\sin\\phi \\\\ \\cos\\theta \\end{pmatrix}.\n$$\n\nUsing Cauchy’s traction law and the effective stress principle, compute:\n- the change in effective normal stress on the plane, $\\Delta \\sigma'_{n}$, and\n- the magnitude of the change in effective shear traction on the plane, $\\Delta \\tau'$,\n\nresulting solely from the overpressure increment $\\Delta p$.\n\nUse the data: $\\Delta p = 12$ MPa, $c_h = 0.35$, $c_v = 0.15$, $\\alpha = 0.85$, $\\theta = 58^\\circ$, $\\phi = 22^\\circ$. Treat angles in degrees. Express your final answers in MPa, and round to four significant figures. Provide the final result as a two-entry row matrix $\\begin{pmatrix} \\Delta \\sigma'_{n} & \\Delta \\tau' \\end{pmatrix}$.", "solution": "The problem is validated as scientifically grounded, well-posed, objective, and complete. There is a minor ambiguity regarding the pore pressure change in the caprock; however, it is reasonably resolved by assuming the pore pressure increment at the point of interest, which is \"immediately above the reservoir,\" is equal to the reservoir pressure increment $\\Delta p$. This implies hydraulic continuity at the interface for the purpose of this analysis. We may now proceed with the solution.\n\nThe problem requires the computation of the change in effective normal stress, $\\Delta \\sigma'_{n}$, and the magnitude of the change in effective shear traction, $\\Delta \\tau'$, on a specific plane within the caprock. The analysis is based on the principles of poroelasticity and continuum mechanics.\n\nFirst, we establish the change in the effective stress tensor, $\\Delta \\boldsymbol{\\sigma}'$. The effective stress principle, in its incremental form, relates the change in effective stress $\\Delta \\boldsymbol{\\sigma}'$ to the change in total stress $\\Delta \\boldsymbol{\\sigma}$ and the change in pore pressure $\\Delta p_c$ at the point of interest:\n$$\n\\Delta \\boldsymbol{\\sigma}' = \\Delta \\boldsymbol{\\sigma} - \\alpha \\Delta p_c \\mathbf{I}\n$$\nwhere $\\alpha$ is the Biot effective stress coefficient and $\\mathbf{I}$ is the second-order identity tensor. As reasoned during validation, we take the pore pressure increment in the caprock at the interface, $\\Delta p_c$, to be equal to the specified reservoir overpressure increment, $\\Delta p$.\n$$\n\\Delta \\boldsymbol{\\sigma}' = \\Delta \\boldsymbol{\\sigma} - \\alpha \\Delta p \\mathbf{I}\n$$\nThe problem provides the total stress increment tensor as:\n$$\n\\Delta \\boldsymbol{\\sigma} = \\mathrm{diag}\\!\\left(c_h\\,\\Delta p,\\; c_h\\,\\Delta p,\\; c_v\\,\\Delta p\\right) = \\Delta p \\begin{pmatrix} c_h & 0 & 0 \\\\ 0 & c_h & 0 \\\\ 0 & 0 & c_v \\end{pmatrix}\n$$\nSubstituting this into the equation for $\\Delta \\boldsymbol{\\sigma}'$:\n$$\n\\Delta \\boldsymbol{\\sigma}' = \\Delta p \\begin{pmatrix} c_h & 0 & 0 \\\\ 0 & c_h & 0 \\\\ 0 & 0 & c_v \\end{pmatrix} - \\alpha \\Delta p \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} = \\Delta p \\begin{pmatrix} c_h - \\alpha & 0 & 0 \\\\ 0 & c_h - \\alpha & 0 \\\\ 0 & 0 & c_v - \\alpha \\end{pmatrix}\n$$\nNext, we use Cauchy’s traction law to find the effective traction vector increment, $\\Delta \\mathbf{t}'$, on the plane defined by the unit normal vector $\\mathbf{n}$.\n$$\n\\Delta \\mathbf{t}' = \\Delta \\boldsymbol{\\sigma}' \\mathbf{n}\n$$\nThe unit normal vector $\\mathbf{n}$ is given in spherical coordinates $(\\theta, \\phi)$:\n$$\n\\mathbf{n} = \\begin{pmatrix} n_x \\\\ n_y \\\\ n_z \\end{pmatrix} = \\begin{pmatrix} \\sin\\theta \\cos\\phi \\\\ \\sin\\theta \\sin\\phi \\\\ \\cos\\theta \\end{pmatrix}\n$$\nPerforming the matrix-vector multiplication:\n$$\n\\Delta \\mathbf{t}' = \\Delta p \\begin{pmatrix} c_h - \\alpha & 0 & 0 \\\\ 0 & c_h - \\alpha & 0 \\\\ 0 & 0 & c_v - \\alpha \\end{pmatrix} \\begin{pmatrix} \\sin\\theta \\cos\\phi \\\\ \\sin\\theta \\sin\\phi \\\\ \\cos\\theta \\end{pmatrix} = \\Delta p \\begin{pmatrix} (c_h - \\alpha) \\sin\\theta \\cos\\phi \\\\ (c_h - \\alpha) \\sin\\theta \\sin\\phi \\\\ (c_v - \\alpha) \\cos\\theta \\end{pmatrix}\n$$\nThe change in effective normal stress, $\\Delta \\sigma'_{n}$, is the component of the traction vector $\\Delta \\mathbf{t}'$ parallel to the normal vector $\\mathbf{n}$. This is obtained by the dot product $\\Delta \\mathbf{t}' \\cdot \\mathbf{n}$:\n$$\n\\Delta \\sigma'_{n} = \\Delta \\mathbf{t}' \\cdot \\mathbf{n} = (\\Delta \\mathbf{t}')^T \\mathbf{n}\n$$\n$$\n\\Delta \\sigma'_{n} = \\Delta p \\left[ (c_h - \\alpha) \\sin^2\\theta \\cos^2\\phi + (c_h - \\alpha) \\sin^2\\theta \\sin^2\\phi + (c_v - \\alpha) \\cos^2\\theta \\right]\n$$\nUsing the trigonometric identity $\\cos^2\\phi + \\sin^2\\phi = 1$:\n$$\n\\Delta \\sigma'_{n} = \\Delta p \\left[ (c_h - \\alpha) \\sin^2\\theta (\\cos^2\\phi + \\sin^2\\phi) + (c_v - \\alpha) \\cos^2\\theta \\right]\n$$\n$$\n\\Delta \\sigma'_{n} = \\Delta p \\left[ (c_h - \\alpha) \\sin^2\\theta + (c_v - \\alpha) \\cos^2\\theta \\right]\n$$\nThe magnitude of the change in effective shear traction, $\\Delta \\tau'$, is found using the relationship $|\\Delta \\mathbf{t}'|^2 = (\\Delta \\sigma'_{n})^2 + (\\Delta \\tau')^2$. Thus, $(\\Delta \\tau')^2 = |\\Delta \\mathbf{t}'|^2 - (\\Delta \\sigma'_{n})^2$. First, we compute the squared magnitude of the traction vector, $|\\Delta \\mathbf{t}'|^2 = \\Delta \\mathbf{t}' \\cdot \\Delta \\mathbf{t}'$:\n$$\n|\\Delta \\mathbf{t}'|^2 = (\\Delta p)^2 \\left[ (c_h - \\alpha)^2 \\sin^2\\theta \\cos^2\\phi + (c_h - \\alpha)^2 \\sin^2\\theta \\sin^2\\phi + (c_v - \\alpha)^2 \\cos^2\\theta \\right]\n$$\n$$\n|\\Delta \\mathbf{t}'|^2 = (\\Delta p)^2 \\left[ (c_h - \\alpha)^2 \\sin^2\\theta + (c_v - \\alpha)^2 \\cos^2\\theta \\right]\n$$\nNow we compute $(\\Delta \\tau')^2$:\n$$\n(\\Delta \\tau')^2 = (\\Delta p)^2 \\left[ (c_h - \\alpha)^2 \\sin^2\\theta + (c_v - \\alpha)^2 \\cos^2\\theta \\right] - \\left( \\Delta p \\left[ (c_h - \\alpha) \\sin^2\\theta + (c_v - \\alpha) \\cos^2\\theta \\right] \\right)^2\n$$\nLet $A = c_h - \\alpha$ and $B = c_v - \\alpha$. Let $S^2 = \\sin^2\\theta$ and $C^2 = \\cos^2\\theta$.\n$$\n\\frac{(\\Delta \\tau')^2}{(\\Delta p)^2} = (A^2 S^2 + B^2 C^2) - (A S^2 + B C^2)^2 = A^2 S^2 + B^2 C^2 - (A^2 S^4 + B^2 C^4 + 2AB S^2 C^2)\n$$\n$$\n= A^2 S^2(1 - S^2) + B^2 C^2(1 - C^2) - 2AB S^2 C^2 = A^2 S^2 C^2 + B^2 C^2 S^2 - 2AB S^2 C^2\n$$\n$$\n= (A^2 - 2AB + B^2) S^2 C^2 = (A-B)^2 S^2 C^2\n$$\nSubstituting back $A$, $B$, $S^2$, and $C^2$:\n$$\n(\\Delta \\tau')^2 = (\\Delta p)^2 ((c_h - \\alpha) - (c_v - \\alpha))^2 \\sin^2\\theta \\cos^2\\theta = (\\Delta p)^2 (c_h - c_v)^2 \\sin^2\\theta \\cos^2\\theta\n$$\nTaking the square root for the magnitude, which must be non-negative:\n$$\n\\Delta \\tau' = \\left| \\Delta p (c_h - c_v) \\sin\\theta \\cos\\theta \\right|\n$$\nUsing the identity $\\sin(2\\theta) = 2\\sin\\theta\\cos\\theta$:\n$$\n\\Delta \\tau' = \\frac{1}{2} \\left| \\Delta p (c_h - c_v) \\sin(2\\theta) \\right|\n$$\nNow, we substitute the given numerical values: $\\Delta p = 12$ MPa, $c_h = 0.35$, $c_v = 0.15$, $\\alpha = 0.85$, and $\\theta = 58^\\circ$. Note that the results are independent of $\\phi$ due to the transverse isotropy of the stress state.\n\nFor $\\Delta \\sigma'_{n}$:\n$$\n\\Delta \\sigma'_{n} = 12 \\left[ (0.35 - 0.85) \\sin^2(58^\\circ) + (0.15 - 0.85) \\cos^2(58^\\circ) \\right]\n$$\n$$\n\\Delta \\sigma'_{n} = 12 \\left[ (-0.50) \\sin^2(58^\\circ) - 0.70 \\cos^2(58^\\circ) \\right]\n$$\n$$\n\\Delta \\sigma'_{n} \\approx 12 \\left[ (-0.50)(0.719186) - (0.70)(0.280814) \\right]\n$$\n$$\n\\Delta \\sigma'_{n} \\approx 12 \\left[ -0.359593 - 0.196570 \\right] = 12(-0.556163) \\approx -6.673956 \\text{ MPa}\n$$\nRounding to four significant figures, $\\Delta \\sigma'_{n} \\approx -6.674$ MPa. A negative value indicates a decrease in compressive normal stress (i.e., a tensile change).\n\nFor $\\Delta \\tau'$:\nGiven $\\Delta p > 0$ and $\\theta \\in (0, 90^\\circ)$, the terms inside the absolute value are positive, so we can drop the absolute value signs.\n$$\n\\Delta \\tau' = 12 \\times |0.35 - 0.15| \\times \\sin(58^\\circ) \\cos(58^\\circ)\n$$\n$$\n\\Delta \\tau' = 12 \\times 0.20 \\times \\sin(58^\\circ) \\cos(58^\\circ)\n$$\n$$\n\\Delta \\tau' \\approx 2.4 \\times (0.848048) \\times (0.529919) \\approx 1.07853 \\text{ MPa}\n$$\nRounding to four significant figures, $\\Delta \\tau' \\approx 1.079$ MPa.\n\nThe final answer is the two-entry row matrix $\\begin{pmatrix} \\Delta \\sigma'_{n} & \\Delta \\tau' \\end{pmatrix}$.\n$$\n\\begin{pmatrix} -6.674 & 1.079 \\end{pmatrix}\n$$", "answer": "$$\n\\boxed{\\begin{pmatrix} -6.674 & 1.079 \\end{pmatrix}}\n$$", "id": "3505769"}, {"introduction": "Beyond pressure increases, the injection of CO₂—which is typically much colder than the deep reservoir—introduces significant thermal stresses that can compromise caprock integrity. This advanced exercise integrates linear thermoelasticity with the effective stress principle in a practical inverse problem, a common task in modern computational geomechanics [@problem_id:3505757]. You will learn how to use monitoring data, such as temperature and pressure transients, to infer key material properties and then use these calibrated parameters to build a predictive model for assessing tensile failure risk.", "problem": "You are tasked with formulating and solving a physics-based inverse problem relevant to caprock integrity during early Carbon Dioxide ($\\text{CO}_2$) injection. Early injection of cold CO₂ cools the reservoir-caprock interface, producing temperature transients detectable by Distributed Temperature Sensing (DTS). Concurrently, the thermoelastic response of the caprock creates stress changes that can be linearly coupled to wellhead pressure transients in a first-order approximation of the reservoir–wellbore–caprock system.\n\nStarting from first principles, use the following bases without shortcut formulas:\n- The one-dimensional heat conduction equation and its role in governing transient temperature in a semi-infinite solid: $\\partial T / \\partial t = \\kappa \\, \\partial^2 T / \\partial x^2$.\n- Linear thermoelasticity for small deformations in isotropic solids, including thermal strain defined by the coefficient of linear thermal expansion $\\alpha$ and elastic moduli $(E,\\nu)$, under a plane-strain constraint at the interface.\n- The effective stress principle for fluid-saturated porous media (Terzaghi–Biot), with Biot coefficient $b$ and pore pressure $p$, where the effective normal stress is $\\sigma'_n = \\sigma_n - b\\,p$.\n\nAssume a linear compliance $S_{\\mathrm{th}}$ (dimensionless) connecting the caprock thermoelastic normal stress change to the wellhead pressure change for small perturbations: changes in caprock thermoelastic stress are linearly mapped to wellhead pressure transients through $S_{\\mathrm{th}}$. Use this relationship consistently across all time steps.\n\nYour program must implement an inversion for the caprock thermal expansion coefficient $\\alpha$ using the provided DTS-derived interface temperature change time series $\\Delta T_s(t_i)$ and wellhead pressure change time series $\\Delta P_w(t_i)$, together with known elastic and coupling parameters $(E,\\nu,S_{\\mathrm{th}})$. Then, use the inverted $\\alpha$ to compute the thermoelastic stress evolution $\\Delta \\sigma_{\\mathrm{th}}(t_i)$ at the interface and assess the caprock’s tensile risk using the effective stress criterion with the given Biot coefficient $b$ and tensile strength threshold $T_0$.\n\nDefinitions and units:\n- Distributed Temperature Sensing (DTS): fiber-optic distributed measurements of temperature along the well trajectory.\n- $\\alpha$: coefficient of linear thermal expansion in $\\mathrm{K}^{-1}$.\n- $E$: Young’s modulus in $\\mathrm{Pa}$.\n- $\\nu$: Poisson’s ratio (dimensionless).\n- $S_{\\mathrm{th}}$: linear compliance mapping stress to pressure (dimensionless).\n- $b$: Biot coefficient (dimensionless).\n- $\\Delta T_s(t_i)$: interface temperature change relative to pre-injection, in $\\mathrm{K}$.\n- $\\Delta P_w(t_i)$: wellhead pressure change relative to pre-injection, in $\\mathrm{MPa}$.\n- $\\Delta \\sigma_{\\mathrm{th}}(t_i)$: thermoelastic normal stress change in the caprock, expressed in $\\mathrm{MPa}$ for output.\n- $\\sigma'_n(t_i)$: effective normal stress change at the interface, expressed in $\\mathrm{MPa}$ for output.\n- $T_0$: tensile strength threshold, in $\\mathrm{MPa}$.\n\nInverse problem and outputs:\n- Estimate $\\alpha$ by minimizing the sum of squared residuals between measured $\\Delta P_w(t_i)$ and predicted $\\Delta P_w(t_i)$ from a physically consistent thermoelastic model under plane strain, using the linear mapping with $S_{\\mathrm{th}}$.\n- Using the inverted $\\alpha$, compute $\\Delta \\sigma_{\\mathrm{th}}(t_i)$ in $\\mathrm{MPa}$ for each time step.\n- Compute $\\sigma'_n(t_i)$ in $\\mathrm{MPa}$ using the given $b$ and measured $\\Delta P_w(t_i)$.\n- Report, for each test case: the inverted $\\alpha$, the final-time thermoelastic stress $\\Delta \\sigma_{\\mathrm{th}}(t_{\\mathrm{final}})$, the most tensile (minimum) effective normal stress $\\min_i \\sigma'_n(t_i)$, and a boolean risk flag indicating whether $\\sigma'_n(t_i) < -T_0$ at any time (true means tensile risk).\n\nAngle units do not apply. Express all outputs in the specified physical units. Do not include units in the printed output; ensure your program’s numerical outputs adhere to the units specified above.\n\nTest suite:\nFor each case, you are given time stamps $t_i$ (in $\\mathrm{s}$), DTS-derived interface temperature changes $\\Delta T_s(t_i)$ (in $\\mathrm{K}$), and wellhead pressure changes $\\Delta P_w(t_i)$ (in $\\mathrm{MPa}$), together with $(E,\\nu,S_{\\mathrm{th}},b,T_0)$.\n\n- Case 1 (general early-cooling response):\n  - $t_i = [\\,0,30,60,120,240,480\\,]$ $\\mathrm{s}$.\n  - $\\Delta T_s(t_i) = [\\,0.0,-2.211992,-3.934693,-6.321206,-8.646647,-9.816844\\,]$ $\\mathrm{K}$.\n  - $\\Delta P_w(t_i) = [\\,0.0,0.221199,0.393469,0.632121,0.864665,0.981684\\,]$ $\\mathrm{MPa}$.\n  - $E = 2.5\\times 10^{10}$ $\\mathrm{Pa}$, $\\nu = 0.25$, $S_{\\mathrm{th}} = -0.5$, $b=0.8$, $T_0 = 2.5$ $\\mathrm{MPa}$.\n\n- Case 2 (boundary-like small cooling):\n  - $t_i = [\\,0,30,60,120,240,480\\,]$ $\\mathrm{s}$.\n  - $\\Delta T_s(t_i) = [\\,0.0,-0.196735,-0.316060,-0.432332,-0.490842,-0.499832\\,]$ $\\mathrm{K}$.\n  - $\\Delta P_w(t_i) = [\\,0.0,0.026999,0.043331,0.059620,0.067643,0.068539\\,]$ $\\mathrm{MPa}$.\n  - $E = 3.0\\times 10^{10}$ $\\mathrm{Pa}$, $\\nu = 0.30$, $S_{\\mathrm{th}} = -0.4$, $b=0.85$, $T_0 = 5.0$ $\\mathrm{MPa}$.\n\n- Case 3 (stiff caprock, stronger coupling):\n  - $t_i = [\\,0,30,60,120,240,480\\,]$ $\\mathrm{s}$.\n  - $\\Delta T_s(t_i) = [\\,0.0,-2.302774,-4.252030,-7.298743,-11.046043,-13.957748\\,]$ $\\mathrm{K}$.\n  - $\\Delta P_w(t_i) = [\\,0.0,0.575694,1.063007,1.824686,2.761511,3.489437\\,]$ $\\mathrm{MPa}$.\n  - $E = 5.0\\times 10^{10}$ $\\mathrm{Pa}$, $\\nu = 0.20$, $S_{\\mathrm{th}} = -1.0$, $b=0.9$, $T_0 = 3.5$ $\\mathrm{MPa}$.\n\nRequired final output format:\nYour program should produce a single line of output containing the results for the three test cases as a comma-separated list enclosed in square brackets. Each test-case result must itself be a list in the order $[\\,\\alpha,\\,\\Delta \\sigma_{\\mathrm{th}}(t_{\\mathrm{final}}),\\,\\min_i \\sigma'_n(t_i),\\,\\text{risk}\\,]$. For example, your program must print a single line like:\n$[\\,[\\alpha_1,\\Delta \\sigma_{\\mathrm{th},1},\\min \\sigma'_{n,1},\\text{True or False}],[\\alpha_2,\\Delta \\sigma_{\\mathrm{th},2},\\min \\sigma'_{n,2},\\text{True or False}],[\\alpha_3,\\Delta \\sigma_{\\mathrm{th},3},\\min \\sigma'_{n,3},\\text{True or False}]\\,]$.", "solution": "The user-provided problem is validated as being scientifically grounded, self-contained, and well-posed, contingent upon a physically consistent interpretation of the provided terms within the established principles of geomechanics. The problem requires the formulation and solution of an inverse problem to determine a material property ($\\alpha$) from transient field data, followed by a forward calculation to assess mechanical risk.\n\nThe solution is structured as follows:\n1.  Derivation of the thermoelastic forward model.\n2.  Formulation and solution of the inverse problem for the thermal expansion coefficient, $\\alpha$.\n3.  Calculation of the thermoelastic and effective stress evolution.\n4.  Assessment of tensile failure risk.\n\nA geomechanics sign convention is adopted where compressive stress is positive and tensile stress is negative. All stress and pressure quantities are expressed in megapascals ($\\mathrm{MPa}$), except where specified otherwise.\n\n**1. Thermoelastic Forward Model**\n\nThe problem states that cooling at the reservoir-caprock interface induces a thermoelastic response. We model the caprock as a semi-infinite solid, with the interface being a plane of large lateral extent. The cooling is uniform across this plane. The \"plane-strain constraint at the interface\" implies that the caprock is prevented from deforming in the plane of the interface (i.e., laterally). Let the direction normal to the interface be $z$ and the lateral directions be $x$ and $y$. The plane-strain condition is $\\varepsilon_x = \\varepsilon_y = 0$.\n\nFor an isotropic, linear elastic material, a change in temperature, $\\Delta T$, induces a thermal strain $\\varepsilon_{\\mathrm{th}} = \\alpha \\Delta T$. The constitutive relationship connecting stress $\\sigma$ and strain $\\varepsilon$ is given by Hooke's Law, modified for thermal effects. For the in-plane horizontal stress components, under plane strain ($\\varepsilon_x = \\varepsilon_y = 0$), the relationship simplifies. The induced change in horizontal stress, $\\Delta \\sigma_h = \\Delta \\sigma_x = \\Delta \\sigma_y$, is a direct consequence of the thermal contraction being constrained. This stress change is given by:\n$$\n\\Delta \\sigma_h = \\frac{E \\alpha \\Delta T}{1-\\nu}\n$$\nHere, $E$ is Young's modulus and $\\nu$ is Poisson's ratio. We identify this quantity as the \"thermoelastic normal stress change\" referenced in the problem, $\\Delta \\sigma_{\\mathrm{th}}$. With our sign convention (compression positive), cooling ($\\Delta T < 0$) induces tensile stress ($\\Delta \\sigma_{\\mathrm{th}} < 0$), which is consistent with this formula.\n\nThe problem states a linear compliance, $S_{\\mathrm{th}}$, maps this stress change to the wellhead pressure change, $\\Delta P_w$. We formalize this as:\n$$\n\\Delta P_w(t_i) = S_{\\mathrm{th}} \\Delta \\sigma_{\\mathrm{th}}(t_i)\n$$\nSubstituting the expression for $\\Delta \\sigma_{\\mathrm{th}}$ and using the measured interface temperature change $\\Delta T_s(t_i)$, we obtain the forward model predicting the wellhead pressure change:\n$$\n\\Delta P_{w, \\text{predicted}}(t_i) = S_{\\mathrm{th}} \\left( \\frac{E \\alpha \\Delta T_s(t_i)}{1-\\nu} \\right)\n$$\n\n**2. Inverse Problem for $\\alpha$**\n\nThe inverse problem is to find the value of $\\alpha$ that best explains the observed data. We achieve this by minimizing the sum of squared residuals between the measured pressure changes, $\\Delta P_{w, \\text{measured}}(t_i)$, and the pressure changes predicted by our model. The objective function to minimize is:\n$$\nJ(\\alpha) = \\sum_{i=1}^{N} \\left( \\Delta P_{w, \\text{measured}}(t_i) - \\Delta P_{w, \\text{predicted}}(t_i) \\right)^2\n$$\nSubstituting the forward model, we can write:\n$$\nJ(\\alpha) = \\sum_{i=1}^{N} \\left( \\Delta P_{w, \\text{measured}}(t_i) - \\alpha \\left[ \\frac{S_{\\mathrm{th}} E}{1-\\nu} \\right] \\Delta T_s(t_i) \\right)^2\n$$\nThis is a linear least-squares problem of the form $y_i = m x_i$, where $y_i = \\Delta P_{w, \\text{measured}}(t_i)$, $x_i = \\Delta T_s(t_i)$, and the slope $m$ is $\\alpha \\left( \\frac{S_{\\mathrm{th}} E}{1-\\nu} \\right)$. The value of $m$ that minimizes the sum of squares is given by:\n$$\nm = \\frac{\\sum_{i=1}^{N} x_i y_i}{\\sum_{i=1}^{N} x_i^2} = \\frac{\\sum_{i=1}^{N} \\Delta T_s(t_i) \\Delta P_{w, \\text{measured}}(t_i)}{\\sum_{i=1}^{N} (\\Delta T_s(t_i))^2}\n$$\nFrom this, we can solve for $\\alpha$:\n$$\n\\alpha = m \\left( \\frac{S_{\\mathrm{th}} E}{1-\\nu} \\right)^{-1} = \\frac{\\sum_{i=1}^{N} \\Delta T_s(t_i) \\Delta P_{w, \\text{measured}}(t_i)}{\\sum_{i=1}^{N} (\\Delta T_s(t_i))^2} \\frac{1-\\nu}{S_{\\mathrm{th}} E}\n$$\nTo ensure consistent units, $E$ (in $\\mathrm{Pa}$) is converted to $\\mathrm{MPa}$ by multiplying by $10^{-6}$, as $\\Delta P_w$ is given in $\\mathrm{MPa}$.\n\n**3. Stress Evolution Calculation**\n\nWith the inverted value of $\\alpha$, we can now compute the time series of the thermoelastic stress change using the measured temperature data:\n$$\n\\Delta \\sigma_{\\mathrm{th}}(t_i) = \\frac{(E \\cdot 10^{-6}) \\alpha \\Delta T_s(t_i)}{1-\\nu} \\quad [\\text{in MPa}]\n$$\nThe problem requires reporting the final-time value, $\\Delta \\sigma_{\\mathrm{th}}(t_{\\mathrm{final}})$.\n\nNext, we calculate the change in effective normal stress, $\\sigma'_n(t_i)$, using the Terzaghi–Biot principle: $\\sigma'_n = \\sigma_n - b p$. In terms of changes, this is $\\Delta\\sigma'_n = \\Delta\\sigma_n - b \\Delta p$. The relevant total stress change $\\Delta \\sigma_n$ is the thermoelastic stress $\\Delta \\sigma_{\\mathrm{th}}(t_i)$ we just calculated. The pore pressure change at the interface, $\\Delta p$, is assumed to be represented by the measured wellhead pressure change $\\Delta P_{w, \\text{measured}}(t_i)$. Thus:\n$$\n\\sigma'_n(t_i) = \\Delta \\sigma_{\\mathrm{th}}(t_i) - b \\cdot \\Delta P_{w, \\text{measured}}(t_i)\n$$\nThe problem asks for the most tensile (minimum) value in this time series, $\\min_i \\sigma'_n(t_i)$.\n\n**4. Tensile Risk Assessment**\n\nTensile failure of the caprock is assumed to occur if the effective normal stress becomes more tensile than the rock's tensile strength, $T_0$. Since tension is negative in our convention, the failure criterion is:\n$$\n\\sigma'_n(t_i) < -T_0\n$$\nwhere $T_0$ is given as a positive value in $\\mathrm{MPa}$. A boolean risk flag is set to `True` if this condition is met for any time step $t_i$, and `False` otherwise. This completes the set of required calculations for each test case.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the inverse problem for caprock integrity assessment for three test cases.\n    \"\"\"\n\n    test_cases = [\n        {\n            \"t\": np.array([0, 30, 60, 120, 240, 480]), # s\n            \"delta_T_s\": np.array([0.0, -2.211992, -3.934693, -6.321206, -8.646647, -9.816844]), # K\n            \"delta_P_w\": np.array([0.0, 0.221199, 0.393469, 0.632121, 0.864665, 0.981684]), # MPa\n            \"E\": 2.5e10, # Pa\n            \"nu\": 0.25,\n            \"S_th\": -0.5,\n            \"b\": 0.8,\n            \"T0\": 2.5, # MPa\n        },\n        {\n            \"t\": np.array([0, 30, 60, 120, 240, 480]), # s\n            \"delta_T_s\": np.array([0.0, -0.196735, -0.316060, -0.432332, -0.490842, -0.499832]), # K\n            \"delta_P_w\": np.array([0.0, 0.026999, 0.043331, 0.059620, 0.067643, 0.068539]), # MPa\n            \"E\": 3.0e10, # Pa\n            \"nu\": 0.30,\n            \"S_th\": -0.4,\n            \"b\": 0.85,\n            \"T0\": 5.0, # MPa\n        },\n        {\n            \"t\": np.array([0, 30, 60, 120, 240, 480]), # s\n            \"delta_T_s\": np.array([0.0, -2.302774, -4.252030, -7.298743, -11.046043, -13.957748]), # K\n            \"delta_P_w\": np.array([0.0, 0.575694, 1.063007, 1.824686, 2.761511, 3.489437]), # MPa\n            \"E\": 5.0e10, # Pa\n            \"nu\": 0.20,\n            \"S_th\": -1.0,\n            \"b\": 0.9,\n            \"T0\": 3.5, # MPa\n        }\n    ]\n\n    results = []\n\n    for case in test_cases:\n        # Extract data for the current case\n        delta_T_s = case[\"delta_T_s\"]\n        delta_P_w = case[\"delta_P_w\"]\n        E_Pa = case[\"E\"]\n        nu = case[\"nu\"]\n        S_th = case[\"S_th\"]\n        b = case[\"b\"]\n        T0 = case[\"T0\"]\n        \n        # Convert Young's modulus from Pa to MPa for unit consistency\n        E_MPa = E_Pa * 1e-6\n\n        # Step 1: Invert for alpha using linear least squares\n        # The model is delta_P_w = m * delta_T_s, where m is a slope containing alpha.\n        # We solve for m first, then for alpha.\n        # Use data points where delta_T_s is not zero to avoid division by zero.\n        valid_indices = np.where(delta_T_s != 0)\n        \n        sum_xy = np.sum(delta_T_s[valid_indices] * delta_P_w[valid_indices])\n        sum_xx = np.sum(delta_T_s[valid_indices]**2)\n        \n        # This check is for robustness, though not strictly needed for given cases\n        if sum_xx == 0: \n            # If no non-zero temperature change, alpha cannot be determined.\n            # This scenario is not expected based on the problem description.\n            # For this problem, we can assume sum_xx will be non-zero.\n            pass\n        \n        model_slope_m = sum_xy / sum_xx\n\n        # The slope m = alpha * (S_th * E_MPa) / (1 - nu)\n        # Solve for alpha\n        alpha = model_slope_m * (1 - nu) / (S_th * E_MPa)\n\n        # Step 2: Compute thermoelastic stress evolution using the inverted alpha\n        # delta_sigma_th = (E_MPa * alpha * delta_T_s) / (1 - nu)\n        delta_sigma_th = (E_MPa * alpha / (1 - nu)) * delta_T_s\n        \n        # Get the final-time thermoelastic stress\n        delta_sigma_th_final = delta_sigma_th[-1]\n\n        # Step 3: Compute effective normal stress change\n        # sigma_prime_n = delta_sigma_th - b * delta_P_w (measured)\n        sigma_prime_n = delta_sigma_th - b * delta_P_w\n\n        # Find the most tensile (minimum) effective normal stress\n        min_sigma_prime_n = np.min(sigma_prime_n)\n\n        # Step 4: Assess tensile risk\n        # Risk exists if sigma_prime_n falls below the tensile strength threshold -T0\n        risk_flag = bool(np.any(sigma_prime_n  -T0))\n\n        # Store results for this case\n        results.append(\n            [alpha, delta_sigma_th_final, min_sigma_prime_n, risk_flag]\n        )\n\n    # Format the final output string as specified\n    def format_list(lst):\n        items = []\n        for item in lst:\n            if isinstance(item, (np.floating, float)):\n                # Use a general but high-precision format for floats\n                items.append(f\"{item:.7g}\")\n            elif isinstance(item, bool):\n                items.append(str(item))\n            else:\n                items.append(str(item))\n        return f\"[{','.join(items)}]\"\n    \n    output_str = f\"[{','.join(map(format_list, results))}]\"\n\n    print(output_str)\n\nsolve()\n```", "id": "3505757"}]}