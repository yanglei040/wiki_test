{"hands_on_practices": [{"introduction": "A key motivation for adopting gradient-enhanced models is to resolve the pathological mesh sensitivity that plagues simulations of material softening using standard local continuum theories. This exercise [@problem_id:3528900] uses the powerful method of manufactured solutions to provide a clear, quantitative benchmark. By comparing the numerical solution of both a local and a gradient-enhanced model against a known analytical solution, you will directly observe the failure of the local model to converge and the robust, mesh-objective behavior of the gradient model.", "problem": "Consider a one-dimensional bar of length $L$ and cross-sectional area $A$ subjected to small-strain quasi-static tensile loading with prescribed uniform total strain $\\varepsilon_0$. The bar exhibits elastoplastic softening behavior. In a standard local plasticity description, the equivalent plastic strain $p(x)$ evolves pointwise, which leads to pathological mesh sensitivity in the presence of softening. A gradient-enhanced plasticity model introduces an intrinsic internal length scale $\\ell$ to regularize the response, producing mesh-objective fields and energetics. Assume small deformations so that the axial stress is given by $\\sigma(x) = E\\left(\\varepsilon(x) - p(x)\\right)$, where $E$ is the Young's modulus and $\\varepsilon(x)$ is the axial strain. For uniform displacement-controlled loading, assume $\\varepsilon(x) \\equiv \\varepsilon_0$.\n\nUse a manufactured solution paradigm to benchmark the models. Specifically, assume the exact nonlocal equivalent plastic strain field is prescribed by\n$$\np_m(x) = p_0 \\exp\\left(-\\frac{\\left(x - \\frac{L}{2}\\right)^2}{2\\ell^2}\\right), \\quad x \\in [0,L],\n$$\nfor some amplitude $p_0 > 0$. In a linear Helmholtz-type Aifantis gradient formulation that relates the nonlocal measure $p(x)$ to a local measure $\\bar{p}(x)$,\n$$\np(x) - \\ell^2 \\frac{d^2 p(x)}{dx^2} = \\bar{p}(x),\n$$\nwith natural (zero micro-traction) boundary conditions $\\frac{d p}{dx}(0) = 0$ and $\\frac{d p}{dx}(L) = 0$, the prescribed $p_m(x)$ induces the corresponding local measure\n$$\n\\bar{p}(x) = p_m(x) - \\ell^2 \\frac{d^2 p_m(x)}{dx^2}.\n$$\nFor the chosen Gaussian $p_m(x)$, compute analytically\n$$\n\\frac{d^2 p_m}{dx^2}(x) = p_0 \\left(\\frac{\\left(x-\\frac{L}{2}\\right)^2}{\\ell^4} - \\frac{1}{\\ell^2} \\right) \\exp\\left(-\\frac{\\left(x - \\frac{L}{2}\\right)^2}{2\\ell^2}\\right),\n$$\nand thus\n$$\n\\bar{p}(x) = p_0 \\left(2 - \\frac{\\left(x-\\frac{L}{2}\\right)^2}{\\ell^2}\\right) \\exp\\left(-\\frac{\\left(x - \\frac{L}{2}\\right)^2}{2\\ell^2}\\right).\n$$\n\nDiscretize the interval $[0,L]$ using a uniform mesh of $N$ nodes with spacing $h = \\frac{L}{N-1}$, so that the element size to internal length ratio is $r = \\frac{h}{\\ell}$. Implement two discrete models:\n\n- Local model: set $p_{\\text{local}}(x_i) = \\bar{p}(x_i)$ pointwise at nodes $x_i$.\n- Gradient model: solve the discrete Helmholtz problem\n$$\np - \\ell^2 \\, D^{(2)} p = \\bar{p},\n$$\nwhere $D^{(2)}$ is the standard second-derivative finite difference operator with homogeneous Neumann boundary conditions. For interior nodes $i=1,\\dots,N-2$,\n$$\n\\left(D^{(2)} p\\right)_i = \\frac{p_{i-1} - 2 p_i + p_{i+1}}{h^2},\n$$\nand at boundaries $i=0$ and $i=N-1$ (using ghost points with $\\frac{dp}{dx}=0$),\n$$\n\\left(D^{(2)} p\\right)_0 = \\frac{-2 p_0 + 2 p_1}{h^2}, \\quad \\left(D^{(2)} p\\right)_{N-1} = \\frac{2 p_{N-2} - 2 p_{N-1}}{h^2}.\n$$\n\nBenchmark accuracy and mesh-objectivity using the manufactured solution. For each $r$:\n\n1. Construct the mesh and evaluate $p_m(x_i)$ and $\\bar{p}(x_i)$ at nodes.\n2. Assemble and solve the linear system for the gradient model to obtain $p_{\\text{grad}}(x_i)$.\n3. Compute the relative $L^2$ errors with respect to $p_m(x)$:\n$$\ne_{\\text{grad}} = \\frac{\\left\\|p_{\\text{grad}} - p_m\\right\\|_{L^2}}{\\left\\|p_m\\right\\|_{L^2}}, \\quad e_{\\text{local}} = \\frac{\\left\\|p_{\\text{local}} - p_m\\right\\|_{L^2}}{\\left\\|p_m\\right\\|_{L^2}},\n$$\napproximating the $L^2$ norm by the trapezoidal rule over the grid.\n4. Compute the nominal stress for each model under the uniform total strain $\\varepsilon_0$:\n$$\n\\Sigma_{\\text{grad}} = E \\left(\\varepsilon_0 - \\frac{1}{L} \\int_0^L p_{\\text{grad}}(x)\\, dx \\right), \\quad \\Sigma_{\\text{local}} = E \\left(\\varepsilon_0 - \\frac{1}{L} \\int_0^L p_{\\text{local}}(x)\\, dx \\right),\n$$\nwith integrals approximated by the trapezoidal rule.\n\nUse the following physically consistent parameters:\n- $E = 3.0 \\times 10^{10}$ (Pascals),\n- $\\ell = 5.0 \\times 10^{-2}$ (meters),\n- $L = 40\\,\\ell$ (meters),\n- $p_0 = 1.0 \\times 10^{-3}$ (dimensionless),\n- $\\varepsilon_0 = 2.0 \\times 10^{-3}$ (dimensionless).\n\nNo angle units are involved. All stress outputs must be expressed in Pascals (Pa). Error outputs are dimensionless.\n\nTest suite of element size ratios $r = h/\\ell$:\n- $r = 0.1$ (fine mesh),\n- $r = 0.5$ (moderately fine),\n- $r = 1.0$ (internal length resolved),\n- $r = 2.5$ (coarse mesh),\n- $r = 10.0$ (very coarse mesh).\n\nFor each $r$ in the test suite, the program must compute and report the tuple $[e_{\\text{grad}}, e_{\\text{local}}, \\Sigma_{\\text{grad}}, \\Sigma_{\\text{local}}]$, where the errors are floats and the stresses are floats in Pascals. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each entry corresponds to one $r$ and is itself a list in the specified order (for example, $[[e_{\\text{grad}},e_{\\text{local}},\\Sigma_{\\text{grad}},\\Sigma_{\\text{local}}],\\dots]$).", "solution": "The user-provided problem has been rigorously validated and is determined to be a well-posed and scientifically sound exercise in computational mechanics. All parameters, equations, and boundary conditions are specified, and the methodology leverages standard, verifiable techniques. The manufactured solution $p_m(x)$ does not strictly satisfy the homogeneous Neumann boundary conditions in an analytical sense; however, for the given parameter $L=40\\ell$, the value of the derivative at the boundaries is of the order $10^{-86}$, which is numerically zero. This discrepancy is characteristic of using unbounded domain functions (like a Gaussian) on a finite domain and does not invalidate the problem's utility as a benchmark.\n\nThe problem asks for a comparison between a local and a gradient-enhanced plasticity model using the method of manufactured solutions. This method provides a powerful verification tool, allowing us to quantify the accuracy of our numerical schemes against a known, exact solution. The core physical issue being addressed is the pathological mesh-dependence of numerical solutions for materials that exhibit softening, a phenomenon where material strength degrades with increasing strain. Standard local continuum models fail in this regime, as they lack an intrinsic length scale, leading to localization of deformation into a zone of zero width, which is physically unrealistic and numerically intractable. Gradient-enhanced models, such as the one presented, introduce an internal length scale, $\\ell$, to regularize the problem, ensuring that the zone of deformation has a finite, physically meaningful width, thereby restoring mesh-objectivity to the numerical simulations.\n\nThe problem is centered on a one-dimensional bar of length $L$ with Young's modulus $E$. The axial stress $\\sigma$ is related to the total strain $\\varepsilon$ and the plastic strain $p$ by the small-strain relation $\\sigma(x) = E(\\varepsilon(x) - p(x))$. For the specified loading, the total strain is uniform, $\\varepsilon(x) = \\varepsilon_0$.\n\nThe gradient-enhancement is introduced via a linear Helmholtz-type equation, which relates the nonlocal plastic strain $p(x)$ (the field that enters the stress equation) to an underlying local-like variable $\\bar{p}(x)$:\n$$\np(x) - \\ell^2 \\frac{d^2 p(x)}{dx^2} = \\bar{p}(x)\n$$\nThis equation is solved over the domain $x \\in [0, L]$ with homogeneous Neumann (zero flux) boundary conditions, $\\frac{dp}{dx}(0) = \\frac{dp}{dx}(L) = 0$.\n\nIn the manufactured solution approach, we postulate an exact form for the nonlocal plastic strain, $p_m(x)$, and use the governing equation to derive the necessary \"source\" term, $\\bar{p}(x)$, that produces this solution.\nThe prescribed manufactured solution is a Gaussian function:\n$$\np_m(x) = p_0 \\exp\\left(-\\frac{\\left(x - \\frac{L}{2}\\right)^2}{2\\ell^2}\\right)\n$$\nSubstituting $p_m(x)$ into the Helmholtz equation yields the corresponding source term $\\bar{p}(x)$:\n$$\n\\bar{p}(x) = p_m(x) - \\ell^2 \\frac{d^2 p_m(x)}{dx^2} = p_0 \\left(2 - \\frac{\\left(x-\\frac{L}{2}\\right)^2}{\\ell^2}\\right) \\exp\\left(-\\frac{\\left(x - \\frac{L}{2}\\right)^2}{2\\ell^2}\\right)\n$$\n\nThe task is to compare two discrete models for a series of mesh resolutions, defined by the ratio $r=h/\\ell$, where $h$ is the mesh spacing.\n\n1.  **Local Model**: This model incorrectly assumes that the physical plastic strain at a point is simply the local source term, i.e., $p_{\\text{local}}(x_i) = \\bar{p}(x_i)$ at each node $x_i$. This approach entirely neglects the regularizing effect of the spatial gradient term and is expected to yield inaccurate results for the plastic strain field and consequently the overall structural response.\n\n2.  **Gradient Model**: This model correctly solves the discretized version of the Helmholtz equation to find the nonlocal plastic strain field $p_{\\text{grad}}(x_i)$. The domain $[0, L]$ is discretized into $N$ nodes with spacing $h = L/(N-1)$. Using a second-order finite difference approximation for the second derivative, we obtain a system of linear algebraic equations:\n    $$\n    \\mathbf{p}_{\\text{grad}} - \\ell^2 \\mathbf{D}^{(2)} \\mathbf{p}_{\\text{grad}} = \\bar{\\mathbf{p}}\n    $$\n    where $\\mathbf{p}_{\\text{grad}}$ and $\\bar{\\mathbf{p}}$ are vectors of nodal values and $\\mathbf{D}^{(2)}$ is the matrix representation of the second derivative operator including the Neumann boundary conditions. This can be written as a linear system $\\mathbf{A} \\mathbf{p}_{\\text{grad}} = \\bar{\\mathbf{p}}$, where $\\mathbf{A} = \\mathbf{I} - \\ell^2 \\mathbf{D}^{(2)}$ is a symmetric, tridiagonal, and positive-definite matrix, guaranteeing a unique solution. Let $\\alpha = \\ell^2/h^2 = 1/r^2$. The non-zero entries of the matrix $\\mathbf{A}$ are:\n    $$\n    \\begin{cases}\n    A_{i,i-1} = -\\alpha, \\quad A_{i,i} = 1+2\\alpha, \\quad A_{i,i+1} = -\\alpha & \\text{for } i \\in \\{1, \\dots, N-2\\} \\\\\n    A_{0,0} = 1+2\\alpha, \\quad A_{0,1} = -2\\alpha & \\text{for } i=0 \\\\\n    A_{N-1,N-2} = -2\\alpha, \\quad A_{N-1,N-1} = 1+2\\alpha & \\text{for } i=N-1\n    \\end{cases}\n    $$\n\nFollowing the assembly and solution of this system, we assess the accuracy of both models by computing the relative $L^2$ error with respect to the exact solution $p_m(x)$. The $L^2$ norm, $\\|f\\|_{L^2} = \\sqrt{\\int_0^L f(x)^2 dx}$, is approximated numerically using the trapezoidal rule on the discrete nodal values.\n$$\ne_{\\text{grad}} = \\frac{\\|p_{\\text{grad}} - p_m\\|_{L^2}}{\\|p_m\\|_{L^2}}, \\quad e_{\\text{local}} = \\frac{\\|p_{\\text{local}} - p_m\\|_{L^2}}{\\|p_m\\|_{L^2}}\n$$\nAs the mesh is refined (i.e., as $r$ decreases), $e_{\\text{grad}}$ is expected to decrease, demonstrating convergence to the exact solution. Conversely, $e_{\\text{local}}$ will remain large, as the local model is fundamentally incorrect.\n\nFinally, we compute the macroscopic engineering response, the nominal stress $\\Sigma$, for both models. This requires averaging the respective plastic strain fields over the bar's length $L$:\n$$\n\\Sigma = E \\left(\\varepsilon_0 - \\frac{1}{L} \\int_0^L p(x)\\, dx \\right)\n$$\nThe integral is again computed using the trapezoidal rule. The comparison of $\\Sigma_{\\text{grad}}$ and $\\Sigma_{\\text{local}}$ demonstrates the impact of model choice on predicting global structural behavior.\n\nThe implementation will loop through the specified ratios $r \\in \\{0.1, 0.5, 1.0, 2.5, 10.0\\}$, and for each, it will:\n1.  Define the mesh based on $L$, $\\ell$, and $r$.\n2.  Evaluate the manufactured fields $p_m(x_i)$ and $\\bar{p}(x_i)$ at the nodes.\n3.  Set $p_{\\text{local},i} = \\bar{p}(x_i)$.\n4.  Assemble and solve the linear system $\\mathbf{A} \\mathbf{p}_{\\text{grad}} = \\bar{\\mathbf{p}}$ to find $p_{\\text{grad},i}$.\n5.  Calculate the four requested metrics: $e_{\\text{grad}}, e_{\\text{local}}, \\Sigma_{\\text{grad}}, \\Sigma_{\\text{local}}$.\n\nThis procedure will quantitatively demonstrate the superiority and mesh-objectivity of the gradient-enhanced formulation.", "answer": "```python\nimport numpy as np\nimport scipy  # Specified in environment, though not directly used in this implementation\n\ndef solve():\n    \"\"\"\n    Solves the gradient-enhanced plasticity benchmark problem for a suite of mesh sizes.\n    \"\"\"\n    # Physical and model parameters\n    E = 3.0e10        # Young's modulus in Pascals\n    l_scale = 5.0e-2  # Internal length scale in meters\n    L = 40.0 * l_scale # Bar length in meters\n    p_0 = 1.0e-3      # Amplitude of plastic strain (dimensionless)\n    eps_0 = 2.0e-3    # Prescribed total strain (dimensionless)\n\n    # Test suite of element size to internal length ratios\n    r_values = [0.1, 0.5, 1.0, 2.5, 10.0]\n\n    # --- Analytical Functions for Manufactured Solution ---\n    def p_m_func(x, L_val, l_val, p0_val):\n        \"\"\"Manufactured solution for nonlocal plastic strain p(x).\"\"\"\n        term = (x - L_val / 2.0)**2 / (2.0 * l_val**2)\n        return p0_val * np.exp(-term)\n\n    def p_bar_func(x, L_val, l_val, p0_val):\n        \"\"\"Induced local measure p_bar(x) corresponding to p_m(x).\"\"\"\n        term1 = (x - L_val / 2.0)**2 / l_val**2\n        exp_term = np.exp(-term1 / 2.0)\n        return p0_val * (2.0 - term1) * exp_term\n\n    def compute_metrics(r, E_val, l_val, L_val, p0_val, eps0_val):\n        \"\"\"\n        Computes errors and stresses for a given mesh size ratio 'r'.\n        \"\"\"\n        # 1. Construct the mesh\n        h = r * l_val\n        # Ensure N is an integer, rounding handles potential floating point issues\n        N = int(round(L_val / h)) + 1\n        x_nodes = np.linspace(0, L_val, N)\n\n        # Evaluate the manufactured fields at the mesh nodes\n        p_m_nodes = p_m_func(x_nodes, L_val, l_val, p0_val)\n        p_bar_nodes = p_bar_func(x_nodes, L_val, l_val, p0_val)\n\n        # 2. Local model solution (trivial assignment)\n        p_local_nodes = p_bar_nodes\n\n        # 3. Gradient model: assemble and solve the linear system\n        # A * p_grad = p_bar, where A = I - l^2 * D^(2)\n        A = np.zeros((N, N))\n        alpha = (l_val / h)**2  # alpha = 1/r^2\n\n        # Fill the interior rows of the matrix A\n        for i in range(1, N - 1):\n            A[i, i - 1] = -alpha\n            A[i, i] = 1.0 + 2.0 * alpha\n            A[i, i + 1] = -alpha\n\n        # Fill the boundary rows (homogeneous Neumann BCs)\n        A[0, 0] = 1.0 + 2.0 * alpha\n        A[0, 1] = -2.0 * alpha\n        A[N - 1, N - 2] = -2.0 * alpha\n        A[N - 1, N - 1] = 1.0 + 2.0 * alpha\n\n        # Solve for the gradient-enhanced plastic strain field\n        p_grad_nodes = np.linalg.solve(A, p_bar_nodes)\n\n        # 4. Compute relative L2 errors\n        # The L2 norm is computed using the trapezoidal rule.\n        # ||f||^2 = integral(f^2 dx)\n        norm_p_m_sq = np.trapz(p_m_nodes**2, x_nodes)\n        \n        # Avoid division by zero if p_m is zero everywhere (not the case here)\n        norm_p_m = np.sqrt(norm_p_m_sq) if norm_p_m_sq > 0 else 1.0\n\n        # Error for the gradient model\n        err_grad_sq = np.trapz((p_grad_nodes - p_m_nodes)**2, x_nodes)\n        e_grad = np.sqrt(err_grad_sq) / norm_p_m\n\n        # Error for the local model\n        err_local_sq = np.trapz((p_local_nodes - p_m_nodes)**2, x_nodes)\n        e_local = np.sqrt(err_local_sq) / norm_p_m\n\n        # 5. Compute nominal stresses\n        # Stress = E * (total_strain - average_plastic_strain)\n        # Average plastic strain = (1/L) * integral(p(x) dx)\n        avg_p_grad = np.trapz(p_grad_nodes, x_nodes) / L_val\n        sigma_grad = E_val * (eps0_val - avg_p_grad)\n\n        avg_p_local = np.trapz(p_local_nodes, x_nodes) / L_val\n        sigma_local = E_val * (eps0_val - avg_p_local)\n        \n        return [e_grad, e_local, sigma_grad, sigma_local]\n\n    # --- Main Execution Loop ---\n    all_results = []\n    for r in r_values:\n        result_tuple = compute_metrics(r, E, l_scale, L, p_0, eps_0)\n        all_results.append(result_tuple)\n\n    # Format the final output string exactly as required\n    output_str = \"[\" + \",\".join([str(res) for res in all_results]) + \"]\"\n\n    print(output_str)\n\nsolve()\n```", "id": "3528900"}, {"introduction": "Gradient-enhanced models regularize strain localization by introducing an intrinsic length scale, $\\ell$, which governs the width of phenomena like shear bands. This width is not only dependent on material parameters but also on the boundary conditions imposed on the plastic field. This thought experiment [@problem_id:3528896] invites you to explore this relationship by analyzing the stability of a plastic strain field near a notch, comparing how a 'micro-clamp' (Dirichlet) condition versus a 'micro-free' (Neumann) condition quantitatively impacts the predicted localization width.", "problem": "Consider a $1$-dimensional semi-infinite bar occupying $x \\ge 0$, with a geometric notch at $x=0$, subjected to monotonic simple shear under small strains. Let the scalar plastic strain be $\\varepsilon^{p}(x)$. Adopt an energetic gradient plasticity model with free energy per unit reference volume\n$$\n\\psi(\\gamma,\\varepsilon^{p},\\varepsilon^{p}_{,x})=\\tfrac{1}{2}\\,G\\,(\\gamma-\\varepsilon^{p})^{2}+\\tfrac{1}{2}\\,K\\,(\\varepsilon^{p})^{2}+\\tfrac{1}{2}\\,g\\,\\ell^{2}\\,(\\varepsilon^{p}_{,x})^{2},\n$$\nwhere $G>0$ is the shear modulus, $K<0$ is the (softening) tangent modulus in the post-peak regime, $g>0$ is the energetic gradient modulus, and $\\ell>0$ is the internal length scale. Assume quasi-static conditions and investigate the onset of localization from a homogeneous state near peak load by linear stability of the plastic strain field. Using the second variation of the total potential energy, show that a nontrivial plastic-strain perturbation $\\delta \\varepsilon^{p}(x)$ in a localized plastic zone satisfies a linear ordinary differential equation of the Sturm–Liouville type on an interval $x\\in[0,w]$.\n\nAt the notch, two admissible boundary conditions for the plastic strain gradient theory are considered:\n- Dirichlet-type anchoring: $\\varepsilon^{p}(0)=0$, which implies $\\delta \\varepsilon^{p}(0)=0$.\n- Neumann-type micro-free condition: $\\boldsymbol{n}\\cdot\\nabla \\varepsilon^{p}(0)=0$ with outward unit normal $\\boldsymbol{n}$, which in one dimension implies $\\varepsilon^{p}_{,x}(0)=0$ and hence $\\delta \\varepsilon^{p}_{,x}(0)=0$.\n\nTo define a shear band width that is comparable across boundary conditions, let $w$ be the smallest positive $x$ at which the perturbation first attains a stationary point, i.e., $\\delta \\varepsilon^{p}_{,x}(w)=0$. Starting from the free energy above and without introducing any additional phenomenological formulas, derive the governing eigenvalue problem for $\\delta \\varepsilon^{p}(x)$ and apply the boundary conditions at $x=0$ and $x=w$ as specified to obtain the lowest-mode band width $w$ for each notch condition. The band width scales as $w\\sim c\\,\\ell$, where $c$ is a dimensionless constant that depends on the boundary condition and on the modulus ratio.\n\nLet $w_{\\mathrm{D}}$ be the lowest-mode width for the Dirichlet notch condition and $w_{\\mathrm{N}}$ for the Neumann notch condition. Compute the exact value of the ratio $r=w_{\\mathrm{N}}/w_{\\mathrm{D}}$ as a single number (dimensionless). No rounding is required. Express the final answer without units.", "solution": "The user wants to find the ratio of shear band widths for two different boundary conditions, based on a gradient-enhanced plasticity model.\n\n### Step 1: Problem Validation\nThe problem statement provides a well-defined model from computational geomechanics, specifically an energetic gradient plasticity model for a 1D bar.\n- **Givens**: The free energy functional $\\psi(\\gamma,\\varepsilon^{p},\\varepsilon^{p}_{,x})=\\tfrac{1}{2}\\,G\\,(\\gamma-\\varepsilon^{p})^{2}+\\tfrac{1}{2}\\,K\\,(\\varepsilon^{p})^{2}+\\tfrac{1}{2}\\,g\\,\\ell^{2}\\,(\\varepsilon^{p}_{,x})^{2}$ is given, along with the definitions of all parameters ($G>0$, $K<0$, $g>0$, $\\ell>0$). The analysis method is specified as a linear stability analysis via the second variation of total potential energy at the onset of localization. The boundary conditions for the perturbation $\\delta\\varepsilon^p$ at the notch ($x=0$) are given for two cases (Dirichlet and Neumann). The definition of the band width $w$ as the first stationary point of the perturbation, $\\delta\\varepsilon^p_{,x}(w)=0$, is also provided.\n- **Scientific Soundness**: The problem is scientifically sound. Gradient plasticity models are a standard and necessary extension of classical plasticity to regularize the mathematical problem of strain localization, which otherwise leads to physically unrealistic solutions with zero width. The use of a second variation of energy to assess stability is a fundamental technique in mechanics.\n- **Well-Posedness and Objectivity**: The problem is mathematically well-posed and stated in objective, unambiguous technical language. It provides all the necessary information to derive a unique solution for the requested ratio.\n\nThe problem is valid. We proceed to the solution.\n\n### Step 2: Derivation of the Governing Equation for the Perturbation\nThe total potential energy of the bar is given by the integral of the free energy density $\\psi$:\n$$\n\\Pi[\\varepsilon^p] = \\int_0^\\infty \\psi(\\gamma, \\varepsilon^p, \\varepsilon^p_{,x}) \\, dx = \\int_0^\\infty \\left( \\frac{1}{2} G (\\gamma - \\varepsilon^p)^2 + \\frac{1}{2} K (\\varepsilon^p)^2 + \\frac{1}{2} g \\ell^2 (\\varepsilon^p_{,x})^2 \\right) dx.\n$$\nWe analyze the stability of a homogeneous state $\\varepsilon^p_0$ by considering a small perturbation $\\delta\\varepsilon^p(x)$, such that $\\varepsilon^p(x) = \\varepsilon^p_0 + \\delta\\varepsilon^p(x)$. The onset of localization corresponds to a bifurcation from the homogeneous solution, which occurs when the second variation of the total potential energy, $\\delta^2\\Pi$, ceases to be positive definite for a non-trivial perturbation. The critical condition for the emergence of a patterned state (localization) is $\\delta^2\\Pi = 0$.\n\nThe second variation of $\\Pi$ is found by taking the second Gâteaux derivative of the functional $\\Pi$. The integrand of $\\delta^2\\Pi$ is a quadratic form in the perturbation variables $(\\delta\\varepsilon^p, \\delta\\varepsilon^p_{,x})$:\n$$\n\\delta^2\\Pi = \\frac{1}{2} \\int_0^\\infty \\left( \\frac{\\partial^2\\psi}{\\partial(\\varepsilon^p)^2} (\\delta\\varepsilon^p)^2 + 2 \\frac{\\partial^2\\psi}{\\partial\\varepsilon^p \\partial\\varepsilon^p_{,x}} \\delta\\varepsilon^p \\delta\\varepsilon^p_{,x} + \\frac{\\partial^2\\psi}{\\partial(\\varepsilon^p_{,x})^2} (\\delta\\varepsilon^p_{,x})^2 \\right) dx.\n$$\nThe derivatives are evaluated at the homogeneous state ($\\varepsilon^p = \\varepsilon^p_0$, $\\varepsilon^p_{,x}=0$):\n$$\n\\frac{\\partial^2\\psi}{\\partial(\\varepsilon^p)^2} = G + K\n$$\n$$\n\\frac{\\partial^2\\psi}{\\partial\\varepsilon^p \\partial\\varepsilon^p_{,x}} = 0\n$$\n$$\n\\frac{\\partial^2\\psi}{\\partial(\\varepsilon^p_{,x})^2} = g\\ell^2\n$$\nSubstituting these into the expression for $\\delta^2\\Pi$, we obtain:\n$$\n\\delta^2\\Pi = \\frac{1}{2} \\int_0^\\infty \\left( (G+K)(\\delta\\varepsilon^p)^2 + g\\ell^2 (\\delta\\varepsilon^p_{,x})^2 \\right) dx.\n$$\nThe problem considers a perturbation in a localized zone of width $w$, so we can restrict the integration to the interval $[0, w]$. The condition for a non-trivial mode at the onset of instability is $\\delta^2\\Pi = 0$. This is a variational problem. The Euler-Lagrange equation for the functional $\\delta^2\\Pi[\\delta\\varepsilon^p]$ gives the governing differential equation for the perturbation $\\delta\\varepsilon^p(x)$. Let $\\mathcal{L} = (G+K)(\\delta\\varepsilon^p)^2 + g\\ell^2 (\\delta\\varepsilon^p_{,x})^2$. The Euler-Lagrange equation is:\n$$\n\\frac{\\partial\\mathcal{L}}{\\partial(\\delta\\varepsilon^p)} - \\frac{d}{dx}\\left(\\frac{\\partial\\mathcal{L}}{\\partial(\\delta\\varepsilon^p_{,x})}\\right) = 0\n$$\n$$\n2(G+K)\\delta\\varepsilon^p - \\frac{d}{dx}\\left(2g\\ell^2\\delta\\varepsilon^p_{,x}\\right) = 0\n$$\nThis simplifies to:\n$$\ng\\ell^2 \\delta\\varepsilon^p_{,xx} - (G+K)\\delta\\varepsilon^p = 0.\n$$\nThis is a linear ordinary differential equation of the Sturm-Liouville type, as requested. For localization to occur, a spatially varying solution must be possible. This requires $G+K < 0$ (softening regime), as otherwise the only bounded solutions on a semi-infinite domain are decaying exponentials, which lead to trivial solutions under the given boundary conditions.\nLet us define a positive constant $\\lambda^2$:\n$$\n\\lambda^2 = -\\frac{G+K}{g\\ell^2}.\n$$\nThe governing ODE becomes:\n$$\n\\delta\\varepsilon^p_{,xx} + \\lambda^2 \\delta\\varepsilon^p = 0.\n$$\nThis is the equation of a simple harmonic oscillator. Its general solution is:\n$$\n\\delta\\varepsilon^p(x) = A \\cos(\\lambda x) + B \\sin(\\lambda x),\n$$\nwhere $A$ and $B$ are constants. The derivative is:\n$$\n\\delta\\varepsilon^p_{,x}(x) = -A\\lambda \\sin(\\lambda x) + B\\lambda \\cos(\\lambda x).\n$$\n\n### Step 3: Application of Boundary Conditions and Calculation of Band Widths\n\nWe now apply the specified boundary conditions for the two cases to determine the lowest-mode band widths, $w_D$ and $w_N$. The band width $w$ is defined as the smallest positive $x$ where $\\delta\\varepsilon^p_{,x}(w) = 0$.\n\n**Case 1: Dirichlet-type notch condition ($w=w_D$)**\nThe boundary conditions are:\n1.  $\\delta\\varepsilon^p(0) = 0$\n2.  $\\delta\\varepsilon^p_{,x}(w_D) = 0$\n\nApplying the first condition to the general solution for $\\delta\\varepsilon^p(x)$:\n$$\n\\delta\\varepsilon^p(0) = A\\cos(0) + B\\sin(0) = A = 0.\n$$\nThe solution simplifies to $\\delta\\varepsilon^p(x) = B\\sin(\\lambda x)$ for a non-trivial perturbation ($B \\neq 0$). The derivative is $\\delta\\varepsilon^p_{,x}(x) = B\\lambda\\cos(\\lambda x)$.\nApplying the second condition at $x=w_D$:\n$$\n\\delta\\varepsilon^p_{,x}(w_D) = B\\lambda\\cos(\\lambda w_D) = 0.\n$$\nSince $B \\neq 0$ and $\\lambda \\neq 0$, we must have $\\cos(\\lambda w_D) = 0$. The smallest positive value for $\\lambda w_D$ that satisfies this is $\\frac{\\pi}{2}$.\n$$\n\\lambda w_D = \\frac{\\pi}{2} \\implies w_D = \\frac{\\pi}{2\\lambda}.\n$$\nThis is the lowest-mode band width for the Dirichlet condition. The mode shape is a quarter sine wave.\n\n**Case 2: Neumann-type notch condition ($w=w_N$)**\nThe boundary conditions are:\n1.  $\\delta\\varepsilon^p_{,x}(0) = 0$\n2.  $\\delta\\varepsilon^p_{,x}(w_N) = 0$\n\nApplying the first condition to the general solution for $\\delta\\varepsilon^p_{,x}(x)$:\n$$\n\\delta\\varepsilon^p_{,x}(0) = -A\\lambda\\sin(0) + B\\lambda\\cos(0) = B\\lambda = 0.\n$$\nSince $\\lambda \\neq 0$, this implies $B=0$. The solution simplifies to $\\delta\\varepsilon^p(x) = A\\cos(\\lambda x)$ for a non-trivial perturbation ($A \\neq 0$). The derivative is $\\delta\\varepsilon^p_{,x}(x) = -A\\lambda\\sin(\\lambda x)$.\nApplying the second condition at $x=w_N$:\n$$\n\\delta\\varepsilon^p_{,x}(w_N) = -A\\lambda\\sin(\\lambda w_N) = 0.\n$$\nSince $A \\neq 0$ and $\\lambda \\neq 0$, we must have $\\sin(\\lambda w_N) = 0$. The smallest positive value for $\\lambda w_N$ that satisfies this is $\\pi$. A value of $0$ would imply $w_N=0$, which is not a physical band width.\n$$\n\\lambda w_N = \\pi \\implies w_N = \\frac{\\pi}{\\lambda}.\n$$\nThis is the lowest-mode band width for the Neumann condition. The mode shape is a half cosine wave.\n\n### Step 4: Calculation of the Ratio\nThe problem asks for the ratio $r = w_N/w_D$. Using the expressions derived above:\n$$\nr = \\frac{w_N}{w_D} = \\frac{\\pi/\\lambda}{\\pi/(2\\lambda)} = \\frac{\\pi}{\\lambda} \\cdot \\frac{2\\lambda}{\\pi} = 2.\n$$\nThe ratio of the band widths is exactly $2$. This result is independent of the material parameters $G$, $K$, $g$, and $\\ell$, as they are all encapsulated in the term $\\lambda$.", "answer": "$$\n\\boxed{2}\n$$", "id": "3528896"}, {"introduction": "Transitioning from continuum theory to a working finite element simulation requires a systematic discretization of the governing equations. This practice [@problem_id:3528869] guides you through this fundamental process for an energetic gradient plasticity model. Starting from the Helmholtz free energy and the principle of stationary potential energy, you will derive the coupled weak form and discretize it to construct the element tangent matrix, numerically verifying its essential symmetry property.", "problem": "Consider a straight, prismatic, one-dimensional bar of length $L$ and constant cross-sectional area $A$, modeled with an energetic gradient-enhanced plasticity formulation in small strain. The total strain is given by $\\varepsilon = u'$, where $u$ is the displacement field, and the internal scalar field $\\kappa$ represents an equivalent plastic strain-like variable. The Helmholtz free energy per unit reference length is assumed to be quadratic and given by\n$$\n\\psi(u,\\kappa) = \\tfrac{1}{2} E A \\left(u' - \\kappa\\right)^2 + \\tfrac{1}{2} A H \\kappa^2 + \\tfrac{1}{2} A \\ell^2 \\left(\\kappa'\\right)^2,\n$$\nwhere $E$ is the Young's modulus, $H$ is a constant energetic hardening/softening modulus (which may be negative in softening but such that $E+H$ remains positive to ensure stability of the internal variable), and $\\ell$ is a material length scale. Neglect external body forces and tractions so that only the internal energy contributes to the incremental potential. Assume quasi-static conditions with no inertia.\n\nTask A (derivation): Starting from the stationary condition of the total potential energy (first variation equal to zero), derive the coupled weak form for the unknown fields $u$ and $\\kappa$ using the Galerkin method with equal-order interpolation. Both $u$ and $\\kappa$ are discretized with the same linear Lagrange shape functions over two-node elements on a uniform mesh. Use isoparametric mapping in the physical coordinate $x$ so that derivatives are taken with respect to $x$.\n\nTask B (discretization): From the weak form, write down the consistent element-level tangent submatrices for a two-node element of length $h$ using linear shape functions for both $u$ and $\\kappa$. Clearly identify the blocks that couple $u$ and $\\kappa$.\n\nTask C (implementation and symmetry demonstration): Implement a program that:\n- Assembles the global tangent matrix for a uniform mesh with $n$ elements, using the element matrices from Task B.\n- Orders the global degrees of freedom as $[u_0, u_1, \\dots, u_n, \\kappa_0, \\kappa_1, \\dots, \\kappa_n]$.\n- Enforces the essential boundary condition $u(0)=0$ by symmetric row-and-column elimination to preserve symmetry on the reduced system. Do not prescribe any essential boundary condition on $\\kappa$.\n- Computes a symmetry indicator defined as the normalized Frobenius norm\n$$\n\\eta = \\frac{\\left\\|K - K^\\top\\right\\|_F}{\\max\\left(1, \\left\\|K\\right\\|_F\\right)},\n$$\nwhere $K$ is the reduced global tangent matrix after applying essential boundary conditions, and $\\|\\cdot\\|_F$ denotes the Frobenius norm. The symmetry indicator $\\eta$ is dimensionless and equals zero for an exactly symmetric matrix (up to roundoff).\n\nScientific base and modeling assumptions to use:\n- Small-strain kinematics and the principle of minimum potential energy applied to the stated Helmholtz free energy.\n- Standard two-node linear Lagrange shape functions on each element for both $u$ and $\\kappa$.\n- Uniform mesh with element length $h = L/n$.\n- Galerkin finite element discretization and consistent linearization to form the global tangent.\n\nTest suite:\nCompute the symmetry indicator $\\eta$ for each of the following parameter sets $(L, n, E, A, H, \\ell)$:\n- Case $1$: $(1.0, 4, 30\\times 10^9, 0.01, 5\\times 10^9, 0.05)$.\n- Case $2$: $(1.0, 4, 30\\times 10^9, 0.01, 0.0, 0.05)$.\n- Case $3$: $(1.0, 4, 30\\times 10^9, 0.01, 5\\times 10^9, 0.0)$.\n- Case $4$: $(1.0, 1, 210\\times 10^9, 0.02, 10\\times 10^9, 0.1)$.\n- Case $5$: $(1.5, 3, 25\\times 10^9, 0.015, -2\\times 10^9, 0.08)$.\n\nAll quantities are in the International System of Units: $L$ and $\\ell$ in meters, $E$ and $H$ in pascals, $A$ in square meters. The output $\\eta$ is a dimensionless real number. Your program must compute the list $[\\eta_1, \\eta_2, \\eta_3, \\eta_4, \\eta_5]$ corresponding to the five cases.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[r_1,r_2,r_3,r_4,r_5]$), where each $r_i$ is the floating-point value of $\\eta$ for case $i$.", "solution": "The problem requires the derivation, discretization, and implementation of a gradient-enhanced plasticity model for a one-dimensional bar to verify the symmetry of the resulting tangent stiffness matrix. The solution is presented in three parts, following the tasks specified.\n\n### Task A: Derivation of the Coupled Weak Form\n\nThe starting point is the principle of minimum potential energy, which states that for a system in stable equilibrium, the total potential energy is stationary. For this quasi-static problem with no external forces, the total potential energy $\\Pi$ is the integral of the Helmholtz free energy density $\\psi$ over the domain of the bar, from $x=0$ to $x=L$.\n\nThe given Helmholtz free energy per unit reference length is:\n$$\n\\psi(u', \\kappa, \\kappa') = \\tfrac{1}{2} E A (u' - \\kappa)^2 + \\tfrac{1}{2} A H \\kappa^2 + \\tfrac{1}{2} A \\ell^2 (\\kappa')^2\n$$\nThe total potential energy is:\n$$\n\\Pi[u, \\kappa] = \\int_0^L \\psi(u', \\kappa, \\kappa') dx = \\int_0^L \\left[ \\tfrac{1}{2} E A (u' - \\kappa)^2 + \\tfrac{1}{2} A H \\kappa^2 + \\tfrac{1}{2} A \\ell^2 (\\kappa')^2 \\right] dx\n$$\nThe stationary condition requires that the first variation of $\\Pi$ with respect to the independent fields $u$ and $\\kappa$ vanishes for all admissible variations $\\delta u$ and $\\delta \\kappa$. An admissible variation is one that is kinematically compatible with the constraints; here, the essential boundary condition $u(0)=0$ implies that the corresponding variation must satisfy $\\delta u(0)=0$.\n\nThe first variation (or Gâteaux derivative) is:\n$$\n\\delta \\Pi = \\int_0^L \\left[ \\frac{\\partial \\psi}{\\partial u'} \\delta(u') + \\frac{\\partial \\psi}{\\partial \\kappa} \\delta \\kappa + \\frac{\\partial \\psi}{\\partial \\kappa'} \\delta(\\kappa') \\right] dx = 0\n$$\nSince variation and differentiation are linear operators, we have $\\delta(u') = (\\delta u)'$ and $\\delta(\\kappa') = (\\delta \\kappa)'$. The partial derivatives of $\\psi$ are:\n$$\n\\frac{\\partial \\psi}{\\partial u'} = E A (u' - \\kappa)\n$$\n$$\n\\frac{\\partial \\psi}{\\partial \\kappa} = -E A (u' - \\kappa) + A H \\kappa\n$$\n$$\n\\frac{\\partial \\psi}{\\partial \\kappa'} = A \\ell^2 \\kappa'\n$$\nSubstituting these into the variational statement gives:\n$$\n\\delta \\Pi = \\int_0^L \\left[ E A (u' - \\kappa) (\\delta u)' + (-E A (u' - \\kappa) + A H \\kappa) \\delta \\kappa + (A \\ell^2 \\kappa') (\\delta \\kappa)' \\right] dx = 0\n$$\nIn the Galerkin method, the variations $\\delta u$ and $\\delta \\kappa$ are replaced by arbitrary weighting functions, $w_u$ and $w_\\kappa$, from the same function space as $u$ and $\\kappa$. Since this equation must hold for any choice of $w_u$ and $w_\\kappa$, we can separate it into two independent equations. This constitutes the coupled weak form of the problem.\n\nThe first equation, governing the mechanical equilibrium (associated with $u$):\n$$\nG_u(u, \\kappa; w_u) = \\int_0^L E A (u' - \\kappa) w_u' \\,dx = 0 \\quad \\forall w_u \\text{ with } w_u(0)=0\n$$\nThe second equation, governing the evolution of the internal variable (associated with $\\kappa$):\n$$\nG_\\kappa(u, \\kappa; w_\\kappa) = \\int_0^L \\left[ -E A (u' - \\kappa) w_\\kappa + A H \\kappa w_\\kappa + A \\ell^2 \\kappa' w_\\kappa' \\right] dx = 0 \\quad \\forall w_\\kappa\n$$\nThese two integral equations form the coupled weak form. They must be solved simultaneously for the displacement field $u(x)$ and the internal variable field $\\kappa(x)$.\n\n### Task B: Element-Level Tangent Submatrices\n\nTo solve the weak form numerically, we employ the finite element method. We discretize the domain $L$ into $n$ two-node linear elements, each of length $h = L/n$. Within each element, the unknown fields $u$ and $\\kappa$ are approximated using linear Lagrange shape functions $\\mathbf{N} = [N_1, N_2]$:\n$$\nu^h(x) = \\mathbf{N}(x) \\mathbf{u}_e, \\quad \\kappa^h(x) = \\mathbf{N}(x) \\boldsymbol{\\kappa}_e\n$$\nwhere $\\mathbf{u}_e = [u_1, u_2]^\\top$ and $\\boldsymbol{\\kappa}_e = [\\kappa_1, \\kappa_2]^\\top$ are the nodal values for the element. The derivatives are approximated as:\n$$\n(u^h)'(x) = \\mathbf{B}(x) \\mathbf{u}_e, \\quad (\\kappa^h)'(x) = \\mathbf{B}(x) \\boldsymbol{\\kappa}_e\n$$\nwhere $\\mathbf{B} = d\\mathbf{N}/dx$. For a linear element of length $h$, the shape function derivatives are constant: $\\mathbf{B} = [-1/h, 1/h]$. The test functions are discretized identically.\n\nSince the governing weak form equations are linear in $u$ and $\\kappa$, their discretization leads to a system of linear algebraic equations $\\mathbf{K}_{global} \\mathbf{d} = \\mathbf{f}$. The matrix $\\mathbf{K}_{global}$ is the global tangent stiffness matrix. We derive it by first finding the element tangent matrix $\\mathbf{K}_e$. The tangent is the derivative of the residual vector with respect to the nodal degrees of freedom. For this linear problem, this is equivalent to substituting the finite element approximations into the bilinear form underlying the weak form. The element tangent matrix is a $4 \\times 4$ matrix composed of four $2 \\times 2$ submatrices:\n$$\n\\mathbf{K}_e = \\begin{pmatrix} \\mathbf{K}_{e,uu} & \\mathbf{K}_{e,u\\kappa} \\\\ \\mathbf{K}_{e,\\kappa u} & \\mathbf{K}_{e,\\kappa\\kappa} \\end{pmatrix}\n$$\nThese submatrices are derived by integrating the corresponding terms from the weak form over the element length $h$:\n$$\n\\mathbf{K}_{e,uu} = E A \\int_0^h \\mathbf{B}^\\top \\mathbf{B} \\,dx = E A \\frac{1}{h} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}\n$$\n$$\n\\mathbf{K}_{e,u\\kappa} = -E A \\int_0^h \\mathbf{B}^\\top \\mathbf{N} \\,dx = -E A \\begin{pmatrix} -1/2 & -1/2 \\\\ 1/2 & 1/2 \\end{pmatrix} = E A \\begin{pmatrix} 1/2 & 1/2 \\\\ -1/2 & -1/2 \\end{pmatrix}\n$$\n$$\n\\mathbf{K}_{e,\\kappa u} = -E A \\int_0^h \\mathbf{N}^\\top \\mathbf{B} \\,dx = -E A \\begin{pmatrix} -1/2 & 1/2 \\\\ -1/2 & 1/2 \\end{pmatrix} = E A \\begin{pmatrix} 1/2 & -1/2 \\\\ 1/2 & -1/2 \\end{pmatrix}\n$$\n$$\n\\mathbf{K}_{e,\\kappa\\kappa} = (E+H) A \\int_0^h \\mathbf{N}^\\top \\mathbf{N} \\,dx + A \\ell^2 \\int_0^h \\mathbf{B}^\\top \\mathbf{B} \\,dx = (E+H) A \\frac{h}{6} \\begin{pmatrix} 2 & 1 \\\\ 1 & 2 \\end{pmatrix} + A \\ell^2 \\frac{1}{h} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}\n$$\nThe integrals $\\int \\mathbf{N}^\\top\\mathbf{N}\\,dx$ and $\\int \\mathbf{B}^\\top\\mathbf{N}\\,dx$ are standard results for linear finite elements. The matrices $\\mathbf{K}_{e,u\\kappa}$ and $\\mathbf{K}_{e,\\kappa u}$ are the coupling blocks. As expected from a potential-based formulation, the element tangent matrix is symmetric, since $\\mathbf{K}_{e,\\kappa u} = \\mathbf{K}_{e,u\\kappa}^\\top$.\n\n### Task C: Implementation and Symmetry Demonstration\n\nThe implementation involves assembling the global tangent matrix from the element matrices and then computing a symmetry indicator.\n\n1.  **Assembly**: We initialize a global tangent matrix $\\mathbf{K}_{global}$ of size $(2(n+1) \\times 2(n+1))$ with zeros. We then iterate through each of the $n$ elements. For each element $i$ (connecting nodes $i$ and $i+1$), we compute its $4 \\times 4$ element tangent matrix $\\mathbf{K}_e$. The entries of $\\mathbf{K}_e$ are then added to the corresponding positions in $\\mathbf{K}_{global}$. The mapping from local to global degrees of freedom respects the specified ordering $[u_0, \\dots, u_n, \\kappa_0, \\dots, \\kappa_n]$. For element $i$, the nodal degrees of freedom map to global indices as follows: $u_i \\rightarrow i$, $u_{i+1} \\rightarrow i+1$, $\\kappa_i \\rightarrow (n+1)+i$, and $\\kappa_{i+1} \\rightarrow (n+1)+i+1$. This standard assembly procedure, known as the direct stiffness method, constructs the full global matrix.\n\n2.  **Boundary Conditions**: The essential boundary condition $u(0)=0$ fixes the degree of freedom $u_0$, which corresponds to index $0$ in our global system. To obtain the reduced system for the unknown DOFs, we apply symmetric elimination. This involves removing the row and column corresponding to the constrained DOF from the global matrix. The resulting reduced matrix, $K$, will be of size $(2n+1) \\times (2n+1)$. This operation preserves the symmetry of the original matrix.\n\n3.  **Symmetry Indicator**: Finally, to numerically verify the symmetry of the reduced matrix $K$, we compute the symmetry indicator $\\eta$:\n    $$\n    \\eta = \\frac{\\left\\|K - K^\\top\\right\\|_F}{\\max\\left(1, \\left\\|K\\right\\|_F\\right)}\n    $$\n    where $\\|\\cdot\\|_F$ is the Frobenius norm. The term $\\|K - K^\\top\\|_F$ will be zero if $K$ is perfectly symmetric. Due to finite-precision floating-point arithmetic, this norm will be a very small number close to machine epsilon. The normalization by $\\|K\\|_F$ makes the indicator dimensionless and robust to the magnitude of the matrix entries. For a correctly implemented symmetric formulation, $\\eta$ should be effectively zero for all test cases. The provided program implements this entire procedure.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_element_matrix(h, E, A, H, l):\n    \"\"\"\n    Computes the 4x4 element tangent matrix for a two-node element.\n\n    The local degrees of freedom are ordered as [u1, u2, k1, k2].\n    \"\"\"\n    # K_uu = E*A/h * [[1, -1], [-1, 1]]\n    k_uu = (E * A / h) * np.array([[1, -1], [-1, 1]])\n\n    # K_uk = E*A * [[1/2, 1/2], [-1/2, -1/2]]\n    k_uk = (E * A / 2.0) * np.array([[1, 1], [-1, -1]])\n\n    # K_ku = E*A * [[1/2, -1/2], [1/2, -1/2]]\n    k_ku = (E * A / 2.0) * np.array([[1, -1], [1, -1]])\n    # Note: k_ku should be the transpose of k_uk for symmetry.\n    # As a check: k_uk.T = (E*A/2) * [[1, -1], [1, -1]] == k_ku. Correct.\n\n    # K_kk = (E+H)*A*h/6 * [[2, 1], [1, 2]] + A*l^2/h * [[1, -1], [-1, 1]]\n    term1 = ((E + H) * A * h / 6.0) * np.array([[2, 1], [1, 2]])\n    term2 = (A * l**2 / h) * np.array([[1, -1], [-1, 1]])\n    k_kk = term1 + term2\n\n    # Assemble the 4x4 element matrix using blocks\n    K_e = np.block([[k_uu, k_uk], [k_ku, k_kk]])\n    \n    return K_e\n\ndef assemble_global_matrix(n, K_e):\n    \"\"\"\n    Assembles the global tangent matrix from element matrices.\n    \n    DOF ordering: [u_0, ..., u_n, k_0, ..., k_n]\n    \"\"\"\n    num_nodes = n + 1\n    total_dofs = 2 * num_nodes\n    K_global = np.zeros((total_dofs, total_dofs))\n\n    for i in range(n):\n        # Global indices for element 'i' (connecting nodes i and i+1)\n        # Local DOFs: u_i, u_{i+1}, k_i, k_{i+1}\n        # Global DOF map for the element\n        dof_map = [\n            i,          # u_i\n            i + 1,      # u_{i+1}\n            num_nodes + i,  # k_i\n            num_nodes + i + 1   # k_{i+1}\n        ]\n        \n        # Add element matrix to global matrix\n        K_global[np.ix_(dof_map, dof_map)] += K_e\n        \n    return K_global\n\ndef compute_symmetry_indicator(L, n, E, A, H, l):\n    \"\"\"\n    Computes the symmetry indicator for the given set of parameters.\n    \"\"\"\n    # 1. Calculate element properties\n    h = L / n\n    \n    # 2. Compute the element tangent matrix\n    K_e = compute_element_matrix(h, E, A, H, l)\n    \n    # 3. Assemble the global tangent matrix\n    K_global = assemble_global_matrix(n, K_e)\n    \n    # 4. Apply essential boundary condition u(0)=0 by symmetric elimination\n    # The DOF for u(0) is at index 0. We remove the first row and column.\n    K_reduced = np.delete(K_global, 0, axis=0)\n    K_reduced = np.delete(K_reduced, 0, axis=1)\n\n    # 5. Compute the symmetry indicator eta\n    K_transpose = K_reduced.T\n    diff_norm = np.linalg.norm(K_reduced - K_transpose, 'fro')\n    K_norm = np.linalg.norm(K_reduced, 'fro')\n    \n    eta = diff_norm / max(1.0, K_norm)\n    \n    return eta\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    # Test suite: (L, n, E, A, H, l)\n    test_cases = [\n        (1.0, 4, 30e9, 0.01, 5e9, 0.05),\n        (1.0, 4, 30e9, 0.01, 0.0, 0.05),\n        (1.0, 4, 30e9, 0.01, 5e9, 0.0),\n        (1.0, 1, 210e9, 0.02, 10e9, 0.1),\n        (1.5, 3, 25e9, 0.015, -2e9, 0.08),\n    ]\n\n    results = []\n    for case in test_cases:\n        L, n, E, A, H, l = case\n        eta = compute_symmetry_indicator(L, n, E, A, H, l)\n        results.append(eta)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\n# Execute the solver\nsolve()\n```", "id": "3528869"}]}