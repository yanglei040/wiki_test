{"hands_on_practices": [{"introduction": "The stress intensity factor, $K$, characterizes the singular stress field at a crack tip, while the energy release rate, $G$, quantifies the energy available for crack propagation. This exercise explores the fundamental relationship between these two critical fracture parameters. By analyzing how out-of-plane constraint dictates whether a plane stress or plane strain condition prevails, you will solidify your understanding of how specimen geometry influences a material's resistance to fracture, a key concept in applying fracture mechanics to real-world geomechanical structures [@problem_id:3526160].", "problem": "A family of geometrically similar single-edge-notched prismatic specimens of a saturated sandstone are tested in tension under drained conditions at quasi-static loading. The crack is through-thickness and centrally located relative to the ligament, with straight crack fronts. The material follows linear elasticity up to fracture and the inelastic (process) zone is small compared to specimen dimensions. Consider two members of this family that are identical in all in-plane dimensions and loading but differ in thickness: a thin specimen with thickness $B_{1} = 8\\,\\mathrm{mm}$ and a thick specimen with thickness $B_{2} = 200\\,\\mathrm{mm}$. The drained Young’s modulus is $E = 25\\,\\mathrm{GPa}$ and the drained Poisson’s ratio is $\\nu = 0.25$. At a given load level for which the Mode I stress intensity factor is $K_{I} = 2.5\\,\\mathrm{MPa}\\sqrt{\\mathrm{m}}$ for both specimens, assume that the thin specimen is governed by a plane stress state at the crack mid-plane and the thick specimen is governed by a plane strain state at the crack mid-plane due to out-of-plane constraint.\n\nStarting from the definition of the energy release rate $G$ as the negative derivative of the total potential energy with respect to crack area, and the path-independence of the $J$-integral in linear elastic fracture mechanics, use the near-tip asymptotic fields in isotropic linear elasticity to relate $G$ to the stress intensity factor $K_{I}$ via an effective modulus $E'$ that depends on the out-of-plane constraint. Identify $E'$ appropriate to plane stress and to plane strain, and then compute the numerical change in energy release rate\n$$\\Delta G = G_{\\text{plane stress}} - G_{\\text{plane strain}}$$\nat the prescribed $K_{I}$ as the thickness increases from $B_{1}$ to $B_{2}$.\n\nExpress the final answer as a single number in $\\mathrm{J/m^2}$ and round your answer to four significant figures.", "solution": "The problem statement is evaluated and found to be valid. It is scientifically grounded in the principles of linear elastic fracture mechanics (LEFM), well-posed with all necessary information provided, and objective in its formulation. The assumptions, such as linear elasticity, small-scale yielding, and the application of plane stress and plane strain conditions to specimens of differing thickness, are standard and appropriate for this context. The provided material properties and stress intensity factor are physically realistic for a geomaterial like sandstone.\n\nThe core of the problem is to determine the relationship between the energy release rate, $G$, and the Mode I stress intensity factor, $K_I$, under plane stress and plane strain conditions, and then to calculate the difference in $G$ for a given $K_I$.\n\nThe energy release rate, $G$, is defined as the rate of change of potential energy, $\\Pi$, with respect to the crack area, $A$. For a crack of length $a$ in a body of thickness $B$, the crack area is $A = aB$. The energy release rate is thus given by:\n$$G = -\\frac{d\\Pi}{dA} = -\\frac{1}{B}\\frac{d\\Pi}{da}$$\nIn linear elastic fracture mechanics, the energy release rate $G$ is equivalent to the $J$-integral, a path-independent integral evaluated on a contour $\\Gamma$ that encloses the crack tip. The $J$-integral is defined as:\n$$J = \\int_{\\Gamma} \\left( W n_1 - T_i \\frac{\\partial u_i}{\\partial x_1} \\right) d\\Gamma$$\nwhere $W$ is the strain energy density, $n_1$ is the component of the unit outward normal to the contour $\\Gamma$ in the direction of crack propagation ($x_1$-direction), $T_i = \\sigma_{ij}n_j$ are the components of the traction vector on the contour, and $u_i$ are the displacement vector components.\n\nThe path-independence of the $J$-integral allows its evaluation using the near-tip asymptotic fields for stress and displacement. For a Mode I crack in an isotropic, linear elastic material, these fields are given in a polar coordinate system $(r, \\theta)$ centered at the crack tip:\n$$\\sigma_{ij}(r, \\theta) = \\frac{K_I}{\\sqrt{2\\pi r}} f_{ij}(\\theta) + \\text{higher order terms}$$\n$$u_i(r, \\theta) = \\frac{K_I}{2\\mu} \\sqrt{\\frac{r}{2\\pi}} g_i(\\theta) + \\text{higher order terms}$$\nwhere $\\mu = \\frac{E}{2(1+\\nu)}$ is the shear modulus and $f_{ij}$ and $g_i$ are dimensionless functions of $\\theta$. The strain energy density $W = \\frac{1}{2}\\sigma_{ij}\\varepsilon_{ij}$ will have a leading term proportional to $r^{-1}$. Evaluating the $J$-integral on an infinitesimal circular path of radius $r$ around the crack tip leads to a result that is independent of $r$ and relates $J$ (and thus $G$) to $K_I$. The result of this well-established derivation is of the form:\n$$G = J = \\frac{K_I^2}{E'}$$\nwhere $E'$ is an effective Young's modulus that depends on the out-of-plane constraint, i.e., whether the state is plane stress or plane strain.\n\nFor the thin specimen ($B_1 = 8\\,\\mathrm{mm}$), a state of plane stress is assumed to prevail at the mid-plane. The defining condition for plane stress is $\\sigma_{zz} = \\sigma_{xz} = \\sigma_{yz} = 0$. The in-plane stress-strain relations are not modified from their standard three-dimensional form when written in terms of $E$ and $\\nu$. The energy release rate is directly related to the Young's modulus $E$.\nFor plane stress:\n$$G_{\\text{plane stress}} = \\frac{K_I^2}{E}$$\nThus, the effective modulus for plane stress is $E'_{\\text{pl. stress}} = E$.\n\nFor the thick specimen ($B_2 = 200\\,\\mathrm{mm}$), a state of plane strain is assumed at the mid-plane due to the high out-of-plane constraint. The defining condition for plane strain is $\\varepsilon_{zz} = \\varepsilon_{xz} = \\varepsilon_{yz} = 0$. The constraint $\\varepsilon_{zz} = 0$ implies a non-zero stress in the thickness direction, $\\sigma_{zz} = \\nu(\\sigma_{xx} + \\sigma_{yy})$. This stiffens the material's response in the $xy$-plane. The in-plane stress-strain relations are modified, and the resulting energy release rate is:\nFor plane strain:\n$$G_{\\text{plane strain}} = \\frac{(1-\\nu^2)K_I^2}{E}$$\nThus, the effective modulus for plane strain is $E'_{\\text{pl. strain}} = \\frac{E}{1-\\nu^2}$.\n\nThe problem requires the computation of the change in energy release rate, $\\Delta G$, as the condition changes from plane stress (thin specimen) to plane strain (thick specimen), at the same level of stress intensity factor $K_I = 2.5\\,\\mathrm{MPa}\\sqrt{\\mathrm{m}}$.\n$$\\Delta G = G_{\\text{plane stress}} - G_{\\text{plane strain}}$$\nSubstituting the expressions for $G$ in terms of $K_I$:\n$$\\Delta G = \\frac{K_I^2}{E} - \\frac{(1-\\nu^2)K_I^2}{E}$$\nFactoring out common terms:\n$$\\Delta G = \\frac{K_I^2}{E} \\left( 1 - (1-\\nu^2) \\right) = \\frac{K_I^2}{E} (1 - 1 + \\nu^2) = \\frac{\\nu^2 K_I^2}{E}$$\nNow, we substitute the given numerical values into this expression. It is crucial to use a consistent set of units (SI units: Pascals, meters).\nThe given values are:\n$K_I = 2.5\\,\\mathrm{MPa}\\sqrt{\\mathrm{m}} = 2.5 \\times 10^6\\,\\mathrm{Pa}\\sqrt{\\mathrm{m}}$\n$E = 25\\,\\mathrm{GPa} = 25 \\times 10^9\\,\\mathrm{Pa}$\n$\\nu = 0.25$\n\nSubstituting these values into the equation for $\\Delta G$:\n$$\\Delta G = \\frac{(0.25)^2 \\times (2.5 \\times 10^6\\,\\mathrm{Pa}\\sqrt{\\mathrm{m}})^2}{25 \\times 10^9\\,\\mathrm{Pa}}$$\n$$\\Delta G = \\frac{0.0625 \\times 6.25 \\times 10^{12}\\,\\mathrm{Pa}^2\\cdot\\mathrm{m}}{25 \\times 10^9\\,\\mathrm{Pa}}$$\n$$\\Delta G = \\frac{0.390625 \\times 10^{12}}{25 \\times 10^9}\\,\\mathrm{Pa}\\cdot\\mathrm{m}$$\n$$\\Delta G = 0.015625 \\times 10^3\\,\\mathrm{Pa}\\cdot\\mathrm{m}$$\n$$\\Delta G = 15.625\\,\\mathrm{Pa}\\cdot\\mathrm{m}$$\nSince $1\\,\\mathrm{Pa} = 1\\,\\mathrm{N/m^2}$, the units are $(\\mathrm{N/m^2})\\cdot\\mathrm{m} = \\mathrm{N/m}$. Furthermore, since $1\\,\\mathrm{J} = 1\\,\\mathrm{N}\\cdot\\mathrm{m}$, we can write $\\mathrm{N/m} = (\\mathrm{N}\\cdot\\mathrm{m})/\\mathrm{m}^2 = \\mathrm{J/m^2}$, which are the correct units for energy release rate.\nSo, $\\Delta G = 15.625\\,\\mathrm{J/m^2}$.\n\nThe problem requests the answer to be rounded to four significant figures.\n$$\\Delta G \\approx 15.63\\,\\mathrm{J/m^2}$$\nThis positive value indicates that for a given stress intensity factor $K_I$, more energy per unit crack extension is released under plane stress conditions than under plane strain conditions. This is physically consistent, as the plane strain state is stiffer.", "answer": "$$ \\boxed{15.63} $$", "id": "3526160"}, {"introduction": "A cornerstone of computational science is the validation of numerical methods against known analytical solutions. This practice guides you through the process of building a numerical benchmark from first principles, moving you from a user of theory to an implementer. By coding the $J$-integral using its fundamental contour definition and the asymptotic near-tip fields, you will directly verify its path-independence and its equivalence to the energy release rate, building a deep, practical understanding of how this powerful theoretical tool is translated into a reliable computational result [@problem_id:3526090].", "problem": "You are to design, analyze, and implement a computational benchmark for a center-cracked plate in uniform tension to validate numerical evaluation of the Mode I stress intensity factor and the path-independent $J$-integral used in the Finite Element Method (FEM) and the eXtended Finite Element Method (XFEM). The benchmark must be grounded in linear elastic fracture mechanics under small-strain assumptions for an isotropic, homogeneous material. The fundamental base you may use includes the laws of linear elasticity, definitions of strain energy density, and the definition of the path-independent $J$-integral as a line integral of energetic terms around the crack tip. No further shortcut formulas should be assumed in advance. All angles must be treated in radians. All physical quantities must be in the International System of Units (SI): stress in Pascal ($\\text{Pa}$), elastic modulus in Pascal ($\\text{Pa}$), crack lengths in meters ($\\text{m}$), and the $J$-integral in Newton per meter ($\\text{N/m}$).\n\nThe configuration is a center-cracked infinite plate of half-crack length $a$ subjected to a uniform remote tensile stress $\\sigma$ normal to the crack plane. The exact Mode I stress intensity factor for this geometry is given by $K_I = \\sigma \\sqrt{\\pi a}$. You must verify that a contour integration based on the path-independent definition of $J$ around the crack tip, applied to the leading-order near-tip displacement field for Mode I loading, reproduces the energy release rate and is path independent. Then, using appropriate constitutive relations, transform the numerically obtained $J$ to a numerical estimate of $K$ and compare it to the exact $K_I$ above.\n\nYour program must implement the following steps and checks:\n1. Starting from the definitions of strain, stress, and strain energy density, and the path-independent integral for $J$ around a closed contour encircling the crack tip, assemble a numerical contour integral for $J$ over a circular path of radius $R$ centered at the crack tip. The integral must be expressed in terms of the strain energy density $W$, the Cauchy stress tensor $\\boldsymbol{\\sigma}$, the displacement gradient $\\partial u_i / \\partial x_1$, and the outward unit normal $\\boldsymbol{n}$ along the contour.\n2. Use the leading-order asymptotic displacement field for a Mode I crack tip in an isotropic linear elastic solid under small strain to provide the required displacement gradients and, by linear elasticity, the stresses and strain energy density. Explicitly implement the required plane stress and plane strain constitutive relationships.\n3. Numerically approximate the line integral for $J$ using uniform angular sampling over $\\theta \\in [0, 2\\pi)$ on the circular path. Demonstrate path independence by using two distinct radii $R_1$ and $R_2$ with $R_1 \\neq R_2$.\n4. For each configuration, transform the computed $J$ to a numerical estimate of $K$ using standard linear elastic relationships between $J$ and $K$ that you must derive from the fundamentals you are allowed to use. Then compare the numerically obtained $K$ to the exact $K_I$ given above.\n5. Prescribe and enforce convergence criteria with respect to angular sampling resolution and path independence. Specifically, for $N \\in \\{64, 128, 256, 512\\}$ angular points, require:\n   - The relative error in $J$ with respect to the exact $J$ decreases monotonically as $N$ increases.\n   - The final relative error at $N=512$ satisfies a tolerance $|J_{\\text{num}} - J_{\\text{exact}}|/J_{\\text{exact}} \\leq 10^{-3}$.\n   - The reconstructed $K$ from $J$ at $N=512$ satisfies $|K_{\\text{num}} - K_I|/K_I \\leq 10^{-3}$.\n   - The path independence at $N=512$ measured by $|J(R_1) - J(R_2)|/J_{\\text{exact}} \\leq 10^{-3}$ for $R_1 = 0.01 a$ and $R_2 = 0.03 a$.\n\nImplement the benchmark as a single program that evaluates the following test suite of independent cases, each specified by $(\\sigma, a, E, \\nu, \\text{plane})$ with $\\text{plane} \\in \\{\\text{plane\\_strain}, \\text{plane\\_stress}\\}$:\n- Case 1 (happy path, stiff material, moderate crack): $(\\sigma = 50 \\times 10^{6}\\ \\text{Pa},\\ a = 0.05\\ \\text{m},\\ E = 210 \\times 10^{9}\\ \\text{Pa},\\ \\nu = 0.30,\\ \\text{plane\\_strain})$.\n- Case 2 (softer material, larger crack, plane stress): $(\\sigma = 12 \\times 10^{6}\\ \\text{Pa},\\ a = 0.5\\ \\text{m},\\ E = 30 \\times 10^{9}\\ \\text{Pa},\\ \\nu = 0.25,\\ \\text{plane\\_stress})$.\n- Case 3 (small crack, high $E$): $(\\sigma = 3 \\times 10^{6}\\ \\text{Pa},\\ a = 0.005\\ \\text{m},\\ E = 70 \\times 10^{9}\\ \\text{Pa},\\ \\nu = 0.33,\\ \\text{plane\\_strain})$.\n- Case 4 (higher stress, larger crack, plane stress): $(\\sigma = 80 \\times 10^{6}\\ \\text{Pa},\\ a = 0.2\\ \\text{m},\\ E = 100 \\times 10^{9}\\ \\text{Pa},\\ \\nu = 0.20,\\ \\text{plane\\_stress})$.\n\nFor each case, compute the exact $K_I = \\sigma \\sqrt{\\pi a}$ and the exact $J$ based on linear elasticity, and then run the numerical contour integration for $J$ with $R_1 = 0.01 a$ and $R_2 = 0.03 a$ and $N \\in \\{64, 128, 256, 512\\}$. For each case, report a boolean indicating whether all four criteria listed above are satisfied.\n\nFinal output format: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example, \"[True,False,True,True]\". Each entry corresponds to one test case in the same order as listed above. Angles must be in radians. All physical inputs must be in SI units as specified, and any intermediate or final energetic quantities must be in $\\text{N/m}$.", "solution": "We start from linear elasticity and the definition of the path-independent $J$-integral. Let $\\boldsymbol{u}$ denote the displacement vector, $\\boldsymbol{\\varepsilon}$ the small-strain tensor with components $\\varepsilon_{ij} = \\tfrac{1}{2}(\\partial u_i/\\partial x_j + \\partial u_j/\\partial x_i)$, and $\\boldsymbol{\\sigma}$ the Cauchy stress tensor related to $\\boldsymbol{\\varepsilon}$ via linear isotropic constitutive laws. The strain energy density is defined as $W = \\tfrac{1}{2} \\sigma_{ij} \\varepsilon_{ij}$. For a crack lying along the $x$-axis with the tip at the origin and crack extension direction along $x_1 \\equiv x$, the path-independent integral is\n$$\nJ = \\int_{\\Gamma} \\left( W n_1 - \\sigma_{ij} n_j \\frac{\\partial u_i}{\\partial x_1} \\right) \\,\\mathrm{d}s,\n$$\nwhere $\\Gamma$ is any counterclockwise contour around the crack tip, $\\boldsymbol{n}$ is the outward unit normal, and $\\mathrm{d}s$ is the line element along $\\Gamma$.\n\nFor a circular contour of radius $R$ centered at the crack tip, parameterized by the polar angle $\\theta \\in [0,2\\pi)$, the outward normal is $\\boldsymbol{n} = \\boldsymbol{e}_r = (\\cos\\theta,\\sin\\theta)$, and $\\mathrm{d}s = R\\,\\mathrm{d}\\theta$. The integrand is evaluated from local near-tip fields.\n\nFor the leading-order asymptotic Mode I crack-tip field in an isotropic linear elastic material under small strain, the displacements in polar coordinates $(r,\\theta)$ are well known from the Williams expansion. Introducing the shear modulus $ \\mu = E/(2(1+\\nu))$ and the parameter $\\kappa$ defined by\n$$\n\\kappa = \n\\begin{cases}\n3 - 4\\nu, & \\text{plane strain},\\\\\n\\dfrac{3 - \\nu}{1 + \\nu}, & \\text{plane stress},\n\\end{cases}\n$$\nthe radial and circumferential displacements are given by\n$$\nu_r(r,\\theta) = \\frac{K}{2\\mu}\\sqrt{\\frac{r}{2\\pi}} \\cos\\left(\\frac{\\theta}{2}\\right) \\left( \\kappa - \\cos\\theta \\right),\n\\qquad\nu_\\theta(r,\\theta) = \\frac{K}{2\\mu}\\sqrt{\\frac{r}{2\\pi}} \\sin\\left(\\frac{\\theta}{2}\\right) \\left( \\kappa - 2 + \\cos\\theta \\right).\n$$\nThese provide the near-tip field up to $O\\!\\left(r^{3/2}\\right)$ corrections. The Cartesian displacements are obtained by the rotation\n$$\nu_x = u_r \\cos\\theta - u_\\theta \\sin\\theta, \\qquad u_y = u_r \\sin\\theta + u_\\theta \\cos\\theta.\n$$\nTo evaluate the $J$-integral, we need the displacement gradients $\\partial u_i/\\partial x_j$, which we obtain by the chain rule in polar coordinates. For any scalar field $f(r,\\theta)$,\n$$\n\\frac{\\partial f}{\\partial x} = \\cos\\theta \\frac{\\partial f}{\\partial r} - \\frac{\\sin\\theta}{r}\\frac{\\partial f}{\\partial \\theta}, \n\\qquad\n\\frac{\\partial f}{\\partial y} = \\sin\\theta \\frac{\\partial f}{\\partial r} + \\frac{\\cos\\theta}{r}\\frac{\\partial f}{\\partial \\theta}.\n$$\nWe first compute $\\partial u_r/\\partial r$, $\\partial u_r/\\partial \\theta$, $\\partial u_\\theta/\\partial r$, and $\\partial u_\\theta/\\partial \\theta$. Introducing $A(r) = \\dfrac{K}{2\\mu}\\sqrt{\\dfrac{r}{2\\pi}}$, we have $\\dfrac{\\mathrm{d}A}{\\mathrm{d}r} = \\dfrac{A}{2r}$. Thus,\n$$\n\\frac{\\partial u_r}{\\partial r} = \\frac{A}{2r} \\cos\\left(\\frac{\\theta}{2}\\right)\\left(\\kappa - \\cos\\theta\\right),\n$$\n$$\n\\frac{\\partial u_r}{\\partial \\theta} = A\\left[ -\\frac{1}{2}\\sin\\left(\\frac{\\theta}{2}\\right)\\left(\\kappa - \\cos\\theta\\right) + \\cos\\left(\\frac{\\theta}{2}\\right)\\sin\\theta \\right],\n$$\n$$\n\\frac{\\partial u_\\theta}{\\partial r} = \\frac{A}{2r} \\sin\\left(\\frac{\\theta}{2}\\right)\\left(\\kappa - 2 + \\cos\\theta\\right),\n$$\n$$\n\\frac{\\partial u_\\theta}{\\partial \\theta} = A\\left[ \\frac{1}{2}\\cos\\left(\\frac{\\theta}{2}\\right)\\left(\\kappa - 2 + \\cos\\theta\\right) - \\sin\\left(\\frac{\\theta}{2}\\right)\\sin\\theta \\right].\n$$\nWe then obtain $\\dfrac{\\partial u_x}{\\partial r}$, $\\dfrac{\\partial u_x}{\\partial \\theta}$, $\\dfrac{\\partial u_y}{\\partial r}$, and $\\dfrac{\\partial u_y}{\\partial \\theta}$ by direct differentiation of $u_x$ and $u_y$:\n$$\n\\frac{\\partial u_x}{\\partial r} = \\frac{\\partial u_r}{\\partial r}\\cos\\theta - \\frac{\\partial u_\\theta}{\\partial r}\\sin\\theta,\n$$\n$$\n\\frac{\\partial u_x}{\\partial \\theta} = \\frac{\\partial u_r}{\\partial \\theta}\\cos\\theta - u_r \\sin\\theta - \\frac{\\partial u_\\theta}{\\partial \\theta}\\sin\\theta - u_\\theta \\cos\\theta,\n$$\n$$\n\\frac{\\partial u_y}{\\partial r} = \\frac{\\partial u_r}{\\partial r}\\sin\\theta + \\frac{\\partial u_\\theta}{\\partial r}\\cos\\theta,\n$$\n$$\n\\frac{\\partial u_y}{\\partial \\theta} = \\frac{\\partial u_r}{\\partial \\theta}\\sin\\theta + u_r \\cos\\theta + \\frac{\\partial u_\\theta}{\\partial \\theta}\\cos\\theta - u_\\theta \\sin\\theta.\n$$\nWith these, the Cartesian gradients follow from the chain rule:\n$$\n\\frac{\\partial u_x}{\\partial x} = \\cos\\theta \\frac{\\partial u_x}{\\partial r} - \\frac{\\sin\\theta}{r}\\frac{\\partial u_x}{\\partial \\theta}, \\qquad\n\\frac{\\partial u_x}{\\partial y} = \\sin\\theta \\frac{\\partial u_x}{\\partial r} + \\frac{\\cos\\theta}{r}\\frac{\\partial u_x}{\\partial \\theta},\n$$\n$$\n\\frac{\\partial u_y}{\\partial x} = \\cos\\theta \\frac{\\partial u_y}{\\partial r} - \\frac{\\sin\\theta}{r}\\frac{\\partial u_y}{\\partial \\theta}, \\qquad\n\\frac{\\partial u_y}{\\partial y} = \\sin\\theta \\frac{\\partial u_y}{\\partial r} + \\frac{\\cos\\theta}{r}\\frac{\\partial u_y}{\\partial \\theta}.\n$$\nThe small strains are then\n$$\n\\varepsilon_{xx} = \\frac{\\partial u_x}{\\partial x}, \\qquad \\varepsilon_{yy} = \\frac{\\partial u_y}{\\partial y}, \\qquad \\varepsilon_{xy} = \\frac{1}{2}\\left( \\frac{\\partial u_x}{\\partial y} + \\frac{\\partial u_y}{\\partial x} \\right).\n$$\nThe stresses depend on the plane condition. For plane stress,\n$$\n\\sigma_{xx} = \\frac{E}{1-\\nu^2}\\left(\\varepsilon_{xx} + \\nu \\varepsilon_{yy}\\right), \\quad\n\\sigma_{yy} = \\frac{E}{1-\\nu^2}\\left(\\varepsilon_{yy} + \\nu \\varepsilon_{xx}\\right), \\quad\n\\sigma_{xy} = 2\\mu \\varepsilon_{xy}.\n$$\nFor plane strain, defining $\\lambda = \\dfrac{E\\nu}{(1+\\nu)(1-2\\nu)}$ and $\\mu = \\dfrac{E}{2(1+\\nu)}$,\n$$\n\\sigma_{xx} = 2\\mu \\varepsilon_{xx} + \\lambda (\\varepsilon_{xx} + \\varepsilon_{yy}), \\quad\n\\sigma_{yy} = 2\\mu \\varepsilon_{yy} + \\lambda (\\varepsilon_{xx} + \\varepsilon_{yy}), \\quad\n\\sigma_{xy} = 2\\mu \\varepsilon_{xy}.\n$$\nThe strain energy density is $W = \\tfrac{1}{2}(\\sigma_{xx}\\varepsilon_{xx} + \\sigma_{yy}\\varepsilon_{yy} + 2\\sigma_{xy}\\varepsilon_{xy})$. Along the circular contour, the outward unit normal is $\\boldsymbol{n} = (\\cos\\theta, \\sin\\theta)$. The line integral for $J$ reduces to\n$$\nJ = \\int_{0}^{2\\pi} \\left[ W n_x - \\sigma_{xj} n_j \\frac{\\partial u_x}{\\partial x} - \\sigma_{yj} n_j \\frac{\\partial u_y}{\\partial x} \\right] R \\,\\mathrm{d}\\theta,\n$$\nwith $n_x = \\cos\\theta$, $n_y = \\sin\\theta$, and $j \\in \\{x,y\\}$. The tensor contractions are $\\sigma_{xj} n_j = \\sigma_{xx} n_x + \\sigma_{xy} n_y$ and $\\sigma_{yj} n_j = \\sigma_{xy} n_x + \\sigma_{yy} n_y$. This integral is evaluated numerically using uniform angular sampling, with the composite rectangle or trapezoidal rule over $\\theta \\in [0,2\\pi)$.\n\nTo compare to the exact benchmark for a center-cracked plate in uniform tension, the exact Mode I stress intensity factor is\n$$\nK_I = \\sigma \\sqrt{\\pi a}.\n$$\nIn linear elasticity, the energy release rate equals the $J$-integral, and for isotropic materials there is a classical equivalence between $J$ and $K$ derived from the asymptotic fields and constitutive relations:\n$$\nJ = \\frac{K^2}{E'},\n$$\nwhere\n$$\nE' = \n\\begin{cases}\nE, & \\text{plane stress},\\\\\n\\dfrac{E}{1-\\nu^2}, & \\text{plane strain}.\n\\end{cases}\n$$\nThis relation follows from equating the elastic energy flow through a contour encircling the crack tip, obtained from the asymptotic displacement and stress fields, with the surface traction and displacement gradient work terms in the $J$-integral, and then using the constitutive law to express the energy density in terms of $K$. Therefore, the exact $J$ for the benchmark is\n$$\nJ_{\\text{exact}} = \\frac{K_I^2}{E'} = \\frac{\\sigma^2 \\pi a}{E'}.\n$$\nThe numerical algorithm is as follows. For each test case:\n1. Compute $K_I = \\sigma \\sqrt{\\pi a}$ and $E'$ based on the plane condition. Set $J_{\\text{exact}} = K_I^2 / E'$.\n2. For $N \\in \\{64, 128, 256, 512\\}$ and $R \\in \\{0.01 a, 0.03 a\\}$, evaluate the near-tip displacements $(u_r, u_\\theta)$ at radius $R$ for $K = K_I$ and the given $(E,\\nu,\\text{plane})$. Compute the displacement gradients, strains, stresses, and $W$, then assemble the integrand and approximate the integral for $J$ over $\\theta \\in [0,2\\pi)$.\n3. For each $N$, compute the relative error $|J_{\\text{num}}(R_1,N) - J_{\\text{exact}}| / J_{\\text{exact}}$, and check that it is monotonically non-increasing with increasing $N$.\n4. At $N=512$, verify that the absolute relative error in $J$ at $R_1$ is at most $10^{-3}$ and that the path independence criterion $|J(R_1) - J(R_2)|/J_{\\text{exact}} \\le 10^{-3}$ holds. Also compute $K_{\\text{num}} = \\sqrt{E' J_{\\text{num}}(R_1)}$ and verify $|K_{\\text{num}} - K_I| / K_I \\le 10^{-3}$.\n5. The case passes if and only if all criteria are met.\n\nTest suite and output. The program must evaluate:\n- Case 1: $(\\sigma = 50 \\times 10^{6}\\ \\text{Pa},\\ a = 0.05\\ \\text{m},\\ E = 210 \\times 10^{9}\\ \\text{Pa},\\ \\nu = 0.30,\\ \\text{plane\\_strain})$.\n- Case 2: $(\\sigma = 12 \\times 10^{6}\\ \\text{Pa},\\ a = 0.5\\ \\text{m},\\ E = 30 \\times 10^{9}\\ \\text{Pa},\\ \\nu = 0.25,\\ \\text{plane\\_stress})$.\n- Case 3: $(\\sigma = 3 \\times 10^{6}\\ \\text{Pa},\\ a = 0.005\\ \\text{m},\\ E = 70 \\times 10^{9}\\ \\text{Pa},\\ \\nu = 0.33,\\ \\text{plane\\_strain})$.\n- Case 4: $(\\sigma = 80 \\times 10^{6}\\ \\text{Pa},\\ a = 0.2\\ \\text{m},\\ E = 100 \\times 10^{9}\\ \\text{Pa},\\ \\nu = 0.20,\\ \\text{plane\\_stress})$.\n\nFor each case, output a boolean indicating whether all criteria are satisfied. The final program output must be a single line containing these booleans in a list, e.g., \"[True,False,True,True]\".", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef j_integral_mode_I(K, E, nu, plane, R, N):\n    \"\"\"\n    Compute the J-integral for Mode I using near-tip asymptotic fields\n    along a circular contour of radius R with N angular points.\n\n    Inputs:\n        K: Mode I stress intensity factor (Pa * sqrt(m))\n        E: Young's modulus (Pa)\n        nu: Poisson's ratio (-)\n        plane: 'plane_strain' or 'plane_stress'\n        R: contour radius (m)\n        N: number of angular points\n\n    Returns:\n        J: computed J-integral (N/m)\n    \"\"\"\n    # Material parameters\n    mu = E / (2.0 * (1.0 + nu))\n    if plane == 'plane_strain':\n        kappa = 3.0 - 4.0 * nu\n        lam = E * nu / ((1.0 + nu) * (1.0 - 2.0 * nu))\n        Eprime = E / (1.0 - nu**2)\n    elif plane == 'plane_stress':\n        kappa = (3.0 - nu) / (1.0 + nu)\n        lam = 0.0  # Not used in plane stress stiffness directly\n        Eprime = E\n    else:\n        raise ValueError(\"Unknown plane condition\")\n\n    # Angular sampling\n    theta = 2.0 * np.pi * np.arange(N) / N\n    c = np.cos(theta)\n    s = np.sin(theta)\n    c2 = np.cos(theta / 2.0)\n    s2 = np.sin(theta / 2.0)\n\n    # Near-tip displacement amplitude\n    A = (K / (2.0 * mu)) * np.sqrt(R / (2.0 * np.pi))  # scalar\n\n    # u_r and u_theta\n    ur = A * c2 * (kappa - np.cos(theta))\n    ut = A * s2 * (kappa - 2.0 + np.cos(theta))\n\n    # Derivatives wrt r\n    ur_r = (A / (2.0 * R)) * c2 * (kappa - np.cos(theta))\n    ut_r = (A / (2.0 * R)) * s2 * (kappa - 2.0 + np.cos(theta))\n\n    # Derivatives wrt theta\n    ur_t = A * (-0.5 * s2 * (kappa - np.cos(theta)) + c2 * np.sin(theta))\n    ut_t = A * (0.5 * c2 * (kappa - 2.0 + np.cos(theta)) - s2 * np.sin(theta))\n\n    # Convert to Cartesian components u_x, u_y\n    ux = ur * c - ut * s\n    uy = ur * s + ut * c\n\n    # Derivatives of u_x and u_y wrt r\n    ux_r = ur_r * c - ut_r * s\n    uy_r = ur_r * s + ut_r * c\n\n    # Derivatives wrt theta\n    ux_t = ur_t * c - ur * s - ut_t * s - ut * c\n    uy_t = ur_t * s + ur * c + ut_t * c - ut * s\n\n    # Chain rule to get Cartesian gradients\n    # du/dx = cos(theta)*du/dr - (sin(theta)/r)*du/dtheta\n    # du/dy = sin(theta)*du/dr + (cos(theta)/r)*du/dtheta\n    invR = 1.0 / R\n    ux_x = c * ux_r - s * invR * ux_t\n    ux_y = s * ux_r + c * invR * ux_t\n    uy_x = c * uy_r - s * invR * uy_t\n    uy_y = s * uy_r + c * invR * uy_t\n\n    # Small strains\n    exx = ux_x\n    eyy = uy_y\n    exy = 0.5 * (ux_y + uy_x)\n\n    # Stresses\n    if plane == 'plane_stress':\n        cE = E / (1.0 - nu**2)\n        sxx = cE * (exx + nu * eyy)\n        syy = cE * (eyy + nu * exx)\n        sxy = 2.0 * mu * exy\n    else:  # plane strain\n        tr = exx + eyy\n        sxx = 2.0 * mu * exx + lam * tr\n        syy = 2.0 * mu * eyy + lam * tr\n        sxy = 2.0 * mu * exy\n\n    # Strain energy density\n    W = 0.5 * (sxx * exx + syy * eyy + 2.0 * sxy * exy)\n\n    # Normal vector on the circle\n    nx = c\n    ny = s\n\n    # Contractions with normal\n    sig_xn = sxx * nx + sxy * ny\n    sig_yn = sxy * nx + syy * ny\n\n    # J-integrand: f(theta) = W * n_x - sigma_ij n_j * du_i/dx\n    # where i in {x,y} and du_i/dx = {ux_x, uy_x}\n    integrand = W * nx - (sig_xn * ux_x + sig_yn * uy_x)\n\n    # Numerical integration over theta\n    dtheta = 2.0 * np.pi / N\n    J = np.sum(integrand) * R * dtheta\n    return J\n\ndef run_case(sigma, a, E, nu, plane):\n    # Exact K_I and J_exact\n    KI = sigma * np.sqrt(np.pi * a)\n    Eprime = E / (1.0 - nu**2) if plane == 'plane_strain' else E\n    J_exact = KI**2 / Eprime\n\n    # Radii and angular resolutions\n    R1 = 0.01 * a\n    R2 = 0.03 * a\n    N_list = [64, 128, 256, 512]\n\n    # Compute J over N_list at R1 and path independence at final N\n    J_errors = []\n    prev_err = None\n    monotonic = True\n    for N in N_list:\n        JN = j_integral_mode_I(KI, E, nu, plane, R1, N)\n        err = abs(JN - J_exact) / J_exact\n        J_errors.append(err)\n        if prev_err is not None and err > prev_err + 1e-14:\n            monotonic = False\n        prev_err = err\n\n    # Final resolution checks at N=512\n    N_final = N_list[-1]\n    J_R1 = j_integral_mode_I(KI, E, nu, plane, R1, N_final)\n    J_R2 = j_integral_mode_I(KI, E, nu, plane, R2, N_final)\n    rel_err_J_final = abs(J_R1 - J_exact) / J_exact\n    path_rel = abs(J_R1 - J_R2) / J_exact\n\n    # Recovered K from J\n    K_num = np.sqrt(Eprime * J_R1)\n    rel_err_K = abs(K_num - KI) / KI\n\n    # Tolerances\n    tol_J = 1e-3\n    tol_path = 1e-3\n    tol_K = 1e-3\n\n    all_good = (monotonic and (rel_err_J_final <= tol_J) and (path_rel <= tol_path) and (rel_err_K <= tol_K))\n    return all_good\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case: (sigma [Pa], a [m], E [Pa], nu [-], plane)\n    test_cases = [\n        (50e6, 0.05, 210e9, 0.30, 'plane_strain'),\n        (12e6, 0.5, 30e9, 0.25, 'plane_stress'),\n        (3e6, 0.005, 70e9, 0.33, 'plane_strain'),\n        (80e6, 0.2, 100e9, 0.20, 'plane_stress'),\n    ]\n\n    results = []\n    for case in test_cases:\n        sigma, a, E, nu, plane = case\n        result = run_case(sigma, a, E, nu, plane)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    # Convert booleans to 'True'/'False' strings automatically by map(str, ...)\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "3526090"}, {"introduction": "Modern finite element codes often employ the domain integral formulation as a robust and accurate method for computing the $J$-integral, especially in complex meshes. This method, however, requires careful implementation to maintain its theoretical path-independence, particularly in geomechanical problems involving body forces or pore pressure. This exercise challenges you to critically evaluate the numerical strategies that ensure the integrity of the domain $J$-integral, honing your ability to diagnose and control errors in advanced computational fracture analyses [@problem_id:3526121].", "problem": "A two-dimensional ($2\\text{D}$) plane strain finite element model of a saturated rock specimen with a straight crack is analyzed under quasi-static loading, including gravity as a body force and pore pressure. The energy release rate $G$ is defined from first principles by $G = -\\,\\mathrm{d}\\Pi/\\mathrm{d}A$, where $\\Pi$ is the total potential energy and $A$ is crack area. In linear elastic materials, the Rice $J$-integral equals $G$ and is path independent provided the governing fields are conservative and appropriate source terms are accounted for. In the domain formulation of the $J$-integral, a smooth scalar weight function $q(\\mathbf{x})$ that equals $1$ in a neighborhood of the crack tip and vanishes at an outer boundary is used alongside the divergence theorem to convert a contour integral around the crack tip to a domain integral involving gradients of $q(\\mathbf{x})$ and the energy-momentum balance. In computational geomechanics, path independence can degrade numerically due to finite element discretization, stress oscillations, body forces, pore pressure contributions, and the placement and regularity of $q(\\mathbf{x})$.\n\nAn analyst seeks to maintain approximate path independence of the domain $J$-integral across mesh refinements for this geomechanical problem. Several candidate numerical strategies are proposed:\n\nA. Use a piecewise constant weight function $q$ that jumps from $1$ inside the chosen subdomain to $0$ outside, aligned such that the subdomain boundary coincides with the external boundary, and omit body force and pore pressure terms to simplify the computation.\n\nB. Choose a continuously differentiable weight function $q$ with $q=1$ in a neighborhood of the crack tip, $q=0$ on the outer boundary, and $\\nabla q = \\mathbf{0}$ on the outer boundary; select the subdomain so that the transition region where $\\nabla q \\neq \\mathbf{0}$ lies away from crack-tip singular elements; and include body force and pore pressure work consistently in the energy balance.\n\nC. Enlarge the subdomain until it encompasses the entire specimen to maximize numerical averaging effects over the whole mesh.\n\nD. Place the transition region of $q$ (where $\\nabla q \\neq \\mathbf{0}$) inside the crack-tip ring of singular elements to more strongly weight the near-tip fields.\n\nE. Perform stress and strain smoothing by projecting the finite element field to a $C^0$ or $C^1$-continuous recovered field prior to integration, and employ sufficiently high-order Gaussian quadrature within the transition region of $q$.\n\nWhich options are correct strategies to maintain path independence of the domain $J$-integral in this setting? Choose all that apply.", "solution": "The user requires an evaluation of numerical strategies for computing the domain $J$-integral in a computational geomechanics context, specifically aiming to maintain path independence.\n\nThe problem statement is first validated for scientific soundness, clarity, and completeness.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n-   **Model:** A two-dimensional ($2\\text{D}$) plane strain finite element model of a saturated rock specimen with a straight crack.\n-   **Physics:** Quasi-static loading, gravity as a body force, and pore pressure are included.\n-   **Definitions:**\n    -   Energy Release Rate: $G = -\\,\\mathrm{d}\\Pi/\\mathrm{d}A$, where $\\Pi$ is total potential energy and $A$ is crack area.\n    -   $J$-integral: In linear elastic materials, $J = G$. It is path independent if governing fields are conservative and source terms are accounted for.\n-   **Methodology:** The domain formulation of the $J$-integral is used, which employs a smooth scalar weight function $q(\\mathbf{x})$ (with $q=1$ near the crack tip and $q=0$ on an outer boundary) and the divergence theorem to convert a contour integral into a domain integral.\n-   **Numerical Challenges:** Path independence can be degraded by finite element discretization, stress oscillations, body forces, pore pressure, and the properties/placement of $q(\\mathbf{x})$.\n-   **Objective:** To identify correct numerical strategies to maintain approximate path independence of the domain $J$-integral across mesh refinements.\n\n**Step 2: Validate Using Extracted Givens**\n-   **Scientific Grounding:** The problem is firmly grounded in the established theory of fracture mechanics and its numerical implementation via the finite element method. The concepts of the energy release rate $G$, the Rice $J$-integral, the domain integral formulation (also known as the virtual crack extension method), and the necessary inclusion of body force and other source terms (like pore pressure effects) are all standard parts of computational fracture mechanics. The mentioned numerical challenges are authentic and well-documented in the literature.\n-   **Well-Posedness:** The problem presents a clear objective—maintaining path independence—and asks for an evaluation of specific, proposed strategies. The correctness of these strategies can be determined based on the theoretical underpinnings of the domain $J$-integral method.\n-   **Objectivity:** The problem is stated using precise, technical terminology (\"plane strain\", \"quasi-static\", \"continuously differentiable\", \"singular elements\") and is free from subjective or ambiguous language.\n\n**Step 3: Verdict and Action**\nThe problem statement is scientifically sound, well-posed, and objective. It contains no invalidating flaws. Therefore, a full analysis of the options is warranted.\n\n### Solution Derivation\n\nThe domain formulation of the $J$-integral computes the energy release rate by evaluating an integral over a finite area (or volume in $3\\text{D}$) surrounding the crack tip. For a crack aligned with the $x_1$-axis, the formulation, accounting for body forces $b_i$, is:\n$$ J = \\int_V \\left( \\sigma_{ij} u_{i,1} - W \\delta_{1j} \\right) q_{,j} \\, dV - \\int_V b_i u_{i,1} q \\, dV $$\nwhere $\\sigma_{ij}$ is the stress tensor, $u_i$ is the displacement vector, $W$ is the strain energy density, and $q$ is the weighting function. The term $u_{i,1}$ represents $\\partial u_i / \\partial x_1$. To properly account for pore pressure $p$ in a poromechanical framework, an additional term related to the work done by pore pressure gradients must be included, or the formulation must be based on an energy-momentum tensor that correctly incorporates poromechanical coupling. For simplicity, we consider these effects as source terms that must be consistently included, as implied by the problem statement.\n\nThe accuracy and path independence (i.e., independence from the choice of the domain defined by $q$) of the numerically computed $J$ depend on:\n1.  **Correctness of the Formulation:** All relevant physical effects contributing to the energy balance (body forces, pore pressure work) must be included in the integral expression.\n2.  **Regularity of the Weight Function:** The function $q(\\mathbf{x})$ must be sufficiently smooth for the application of the divergence theorem, which underpins the method. A continuous function with piecewise continuous derivatives ($C^0$) is a minimum requirement.\n3.  **Accuracy of Field Variables:** The accuracy of the computed $J$ is limited by the accuracy of the finite element solution for stresses $\\sigma_{ij}$ and displacement gradients $u_{i,j}$.\n4.  **Placement of the Integration Domain:** The region where $\\nabla q \\neq \\mathbf{0}$ should be located where the FE solution is accurate, avoiding both the immediate vicinity of the crack-tip singularity and regions with coarse meshing or boundary condition effects.\n5.  **Numerical Quadrature:** The domain integral must be evaluated with a sufficiently high-order numerical quadrature scheme.\n\nWith these principles, we evaluate each option.\n\n**Option A Evaluation:**\n> A. Use a piecewise constant weight function $q$ that jumps from $1$ inside the chosen subdomain to $0$ outside, aligned such that the subdomain boundary coincides with the external boundary, and omit body force and pore pressure terms to simplify the computation.\n\nThis strategy has two critical flaws. First, using a piecewise constant function $q$ makes its gradient, $q_{,j}$, a Dirac delta function located at the discontinuity. This converts the domain integral back into a contour integral, defeating the purpose of the domain method which is to \"smear\" the integral over a region to average out numerical errors. The derivation of the domain integral relies on a sufficiently smooth $q$. Second, omitting body force and pore pressure terms is a violation of the energy balance principle. The $J$-integral is equal to the energy release rate $G$ only when all work and energy terms are accounted for. Omitting these terms means the computed quantity is not $G$ and will not be path independent.\n**Verdict: Incorrect.**\n\n**Option B Evaluation:**\n> B. Choose a continuously differentiable weight function $q$ with $q=1$ in a neighborhood of the crack tip, $q=0$ on the outer boundary, and $\\nabla q = \\mathbf{0}$ on the outer boundary; select the subdomain so that the transition region where $\\nabla q \\neq \\mathbf{0}$ lies away from crack-tip singular elements; and include body force and pore pressure work consistently in the energy balance.\n\nThis option describes the canonical \"best practice\" for implementing the domain $J$-integral method.\n-   A smooth, continuously differentiable $q$ satisfies the theoretical requirements. The conditions $q=1$ at the tip and $q=0$ (along with $\\nabla q = \\mathbf{0}$) at the outer boundary of the integration domain properly define the virtual crack extension.\n-   Placing the transition region (where $\\nabla q \\neq \\mathbf{0}$) away from the singular elements avoids relying on the least accurate part of the FE solution near the singularity, thereby improving accuracy and mesh stability.\n-   Consistently including body force and pore pressure terms ensures that the computed integral corresponds to the true energy release rate, which is a prerequisite for path independence.\n**Verdict: Correct.**\n\n**Option C Evaluation:**\n> C. Enlarge the subdomain until it encompasses the entire specimen to maximize numerical averaging effects over the whole mesh.\n\nThis strategy is ill-advised. While the theoretical $J$-integral is path-independent, the numerical one is not. Integrating over the entire domain means including errors from all elements, including those in coarsely meshed regions far from the crack. Furthermore, this approach can introduce significant errors from the model's external boundaries, where tractions and displacement constraints are applied. The standard formulation of the domain $J$-integral assumes the outer boundary of the integration domain is in a region free from external tractions. Including the entire specimen complicates the formulation and incorporates errors from regions irrelevant to the near-tip fields. The optimal domain is typically one that is large enough to move away from the crack-tip singularity but small enough to reside within a well-refined mesh region.\n**Verdict: Incorrect.**\n\n**Option D Evaluation:**\n> D. Place the transition region of $q$ (where $\\nabla q \\neq \\mathbf{0}$) inside the crack-tip ring of singular elements to more strongly weight the near-tip fields.\n\nThis is the opposite of the correct approach. The region immediately surrounding the crack tip, even when modeled with singular elements, is where the FE approximation of the stress and strain fields is poorest due to the mathematical singularity. Placing the transition region there, where the integrand is non-zero, makes the calculation of $J$ highly sensitive to the most error-prone part of the solution. This leads to poor accuracy and strong mesh-dependence, undermining the goal of achieving path independence. The integration domain should be moved *away* from this zone.\n**Verdict: Incorrect.**\n\n**Option E Evaluation:**\n> E. Perform stress and strain smoothing by projecting the finite element field to a $C^0$ or $C^1$-continuous recovered field prior to integration, and employ sufficiently high-order Gaussian quadrature within the transition region of $q$.\n\nThis option describes two powerful techniques for improving numerical accuracy.\n-   Standard FE stress/strain fields are discontinuous across elements. Stress smoothing or recovery techniques (like Superconvergent Patch Recovery) generate a continuous and more accurate representation of these fields. Since the $J$-integral integrand is a function of stress and strain, using a higher-quality, smoothed field as input directly improves the accuracy of the final $J$-value.\n-   The integrand can be a complex function. Using a high-order Gaussian quadrature rule ensures that the integral over the domain is computed with minimal numerical integration error.\nBoth strategies reduce numerical errors that contribute to path dependence, thus helping to maintain it.\n**Verdict: Correct.**\n\nIn summary, options B and E describe correct and effective strategies for maintaining the path independence of the domain $J$-integral an a numerical setting.", "answer": "$$\\boxed{BE}$$", "id": "3526121"}]}