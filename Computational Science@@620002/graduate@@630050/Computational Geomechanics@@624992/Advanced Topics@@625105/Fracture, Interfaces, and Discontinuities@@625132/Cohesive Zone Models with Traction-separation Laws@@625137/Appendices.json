{"hands_on_practices": [{"introduction": "A cornerstone of the Finite Element Method is the translation of continuous constitutive laws into discrete algebraic equations. This practice guides you through the fundamental process of deriving the stiffness matrix for a cohesive interface element. By starting from the principle of virtual work and applying bilinear shape functions, you will see how a traction-separation law is transformed into a tangible numerical component ready for assembly into a global system [@problem_id:3506922].", "problem": "Consider a two-dimensional zero-thickness cohesive interface discretized by a four-node bilinear interface element. The element has two nodes on the upper surface (nodes $1$ and $2$) and two nodes on the lower surface (nodes $3$ and $4$). Each node carries two Degrees of Freedom (DOF), the global Cartesian components of displacement $(u_x,u_y)$. The local interface axes are defined by the unit normal $\\boldsymbol{n}$ and the unit tangent $\\boldsymbol{m}$ to the interface line. Under pure mode I loading, the traction-separation law is linear elastic prior to softening and given by $t_n = k_n \\, \\delta_n$, where $t_n$ is the normal cohesive traction, $k_n$ is the normal stiffness, and $\\delta_n$ is the normal displacement jump across the interface.\n\nAssume:\n- The out-of-plane thickness (width) is $b$, and the interface length is $L$; the parametric coordinate along the interface is $\\xi \\in [-1,1]$, with line Jacobian $J = L/2$.\n- The element uses standard bilinear shape functions on each surface, $N_1(\\xi) = (1-\\xi)/2$ and $N_2(\\xi) = (1+\\xi)/2$, with the upper surface interpolated by $N_1,N_2$ at nodes $1,2$ and the lower surface by the same $N_1,N_2$ at nodes $3,4$.\n- The local-to-global rotation per node is defined by $\\boldsymbol{R} = [\\boldsymbol{n} \\ \\boldsymbol{m}]$, with $\\boldsymbol{n} = [\\cos\\theta,\\ \\sin\\theta]^{\\mathsf{T}}$ and $\\boldsymbol{m} = [-\\sin\\theta,\\ \\cos\\theta]^{\\mathsf{T}}$. Angles are measured in radians.\n\nStarting from the principle of virtual work and the linear elastic traction-separation law, derive the consistent linearization to obtain:\n1. The element stiffness matrix in the local $(n,m)$ coordinates, $K^{\\text{loc}}$, using the bilinear interpolation and integration along the interface length.\n2. The transformation of $K^{\\text{loc}}$ to the global $(x,y)$ coordinates, $K^{\\text{glob}}$, through the appropriate per-node rotation.\n\nTake the following numerical values:\n- $k_n = 6.0 \\times 10^{10} \\ \\mathrm{N/m^3}$,\n- $b = 0.5 \\ \\mathrm{m}$,\n- $L = 0.6 \\ \\mathrm{m}$,\n- $\\cos\\theta = \\frac{4}{5}$ and $\\sin\\theta = \\frac{3}{5}$ (so $\\theta = \\arctan(3/4)$ in radians).\n\nReport the final global element stiffness matrix $K^{\\text{glob}}$ as an $8 \\times 8$ matrix ordered by the DOFs $(u_{1x},u_{1y},u_{2x},u_{2y},u_{3x},u_{3y},u_{4x},u_{4y})$. Express the entries in $\\mathrm{N/m}$ and round your answer to four significant figures.", "solution": "The problem is validated as scientifically grounded, well-posed, and objective. It describes a standard procedure in computational mechanics for deriving the stiffness matrix of a cohesive element. A minor ambiguity regarding the shear stiffness is resolved by adopting the standard assumption that it is zero, as is common when it is not specified.\n\nThe element stiffness matrix, $K^{\\text{glob}}$, is derived from the principle of virtual work, which states that the internal virtual work equals the external virtual work. For the cohesive element, the internal virtual work is done by the cohesive tractions over the virtual displacement jumps. The linearized form relates the nodal forces to nodal displacements via the stiffness matrix.\n\nThe internal virtual work, $\\delta W_{\\text{int}}$, is given by the integral of the traction vector, $\\boldsymbol{t}$, dotted with the virtual separation vector, $\\delta \\boldsymbol{\\delta}$, over the cohesive surface area $A$:\n$$ \\delta W_{\\text{int}} = \\int_A (\\delta \\boldsymbol{\\delta})^{\\mathsf{T}} \\boldsymbol{t} \\, dA $$\nThe area element is $dA = b \\, dS$, where $b$ is the out-of-plane thickness and $dS$ is the arc length along the interface. Using the parametric coordinate $\\xi \\in [-1, 1]$, we have $dS = J \\, d\\xi$, with Jacobian $J = L/2$.\n\nThe derivation proceeds in two main steps: first, we derive the stiffness matrix in the local coordinate system $(n, m)$ aligned with the interface, denoted $K^{\\text{loc}}$. Second, we transform this matrix to the global Cartesian coordinate system $(x,y)$, yielding $K^{\\text{glob}}$.\n\n**1. Element Kinematics and Local Stiffness Matrix ($K^{\\text{loc}}$)**\n\nThe element has $8$ degrees of freedom (DOFs). Let the nodal displacements in the local system be $\\boldsymbol{d}^{\\text{loc}} = [u_{1n}, u_{1m}, u_{2n}, u_{2m}, u_{3n}, u_{3m}, u_{4n}, u_{4m}]^{\\mathsf{T}}$. The displacement jump (separation) vector in local coordinates, $\\boldsymbol{\\delta} = [\\delta_n, \\delta_m]^{\\mathsf{T}}$, is interpolated from the nodal displacements.\nThe displacement field on the upper surface (nodes $1,2$) is $\\boldsymbol{u}^{+,\\text{loc}}(\\xi) = N_1(\\xi)\\boldsymbol{u}_1^{\\text{loc}} + N_2(\\xi)\\boldsymbol{u}_2^{\\text{loc}}$.\nThe displacement field on the lower surface (nodes $3,4$) is $\\boldsymbol{u}^{-,\\text{loc}}(\\xi) = N_1(\\xi)\\boldsymbol{u}_3^{\\text{loc}} + N_2(\\xi)\\boldsymbol{u}_4^{\\text{loc}}$.\nThe shape functions are $N_1(\\xi) = (1-\\xi)/2$ and $N_2(\\xi) = (1+\\xi)/2$.\nThe separation is the difference: $\\boldsymbol{\\delta}(\\xi) = \\boldsymbol{u}^{+,\\text{loc}}(\\xi) - \\boldsymbol{u}^{-,\\text{loc}}(\\xi)$. This can be written as $\\boldsymbol{\\delta}(\\xi) = \\boldsymbol{B}(\\xi) \\boldsymbol{d}^{\\text{loc}}$, where $\\boldsymbol{B}(\\xi)$ is the $2 \\times 8$ strain-displacement matrix:\n$$ \\boldsymbol{B}(\\xi) = \\begin{pmatrix} N_1(\\xi) & 0 & N_2(\\xi) & 0 & -N_1(\\xi) & 0 & -N_2(\\xi) & 0 \\\\ 0 & N_1(\\xi) & 0 & N_2(\\xi) & 0 & -N_1(\\xi) & 0 & -N_2(\\xi) \\end{pmatrix} $$\nThe traction-separation law is given as $t_n = k_n \\delta_n$. The problem does not specify the shear traction $t_m$. We assume an uncoupled law and, as no shear stiffness $k_m$ is provided, we take $k_m = 0$. The constitutive relation $\\boldsymbol{t} = \\boldsymbol{C} \\boldsymbol{\\delta}$ is thus defined by the matrix:\n$$ \\boldsymbol{C} = \\begin{pmatrix} k_n & 0 \\\\ 0 & k_m \\end{pmatrix} = \\begin{pmatrix} k_n & 0 \\\\ 0 & 0 \\end{pmatrix} $$\nSubstituting these relations into the virtual work principle:\n$$ \\delta W_{\\text{int}} = \\int_{-1}^{1} (\\delta(\\boldsymbol{B}\\boldsymbol{d}^{\\text{loc}}))^{\\mathsf{T}} (\\boldsymbol{C} \\boldsymbol{B} \\boldsymbol{d}^{\\text{loc}}) b J \\, d\\xi = (\\delta\\boldsymbol{d}^{\\text{loc}})^{\\mathsf{T}} \\left( b J \\int_{-1}^{1} \\boldsymbol{B}^{\\mathsf{T}}\\boldsymbol{C}\\boldsymbol{B} \\, d\\xi \\right) \\boldsymbol{d}^{\\text{loc}} $$\nThe term in the parenthesis is the local stiffness matrix $K^{\\text{loc}}$:\n$$ K^{\\text{loc}} = b J \\int_{-1}^{1} \\boldsymbol{B}(\\xi)^{\\mathsf{T}} \\boldsymbol{C} \\boldsymbol{B}(\\xi) \\, d\\xi $$\nThe integrand is $\\boldsymbol{B}^{\\mathsf{T}}\\boldsymbol{C}\\boldsymbol{B} = k_n \\begin{pmatrix} N_1^2 & 0 & N_1N_2 & \\dots \\\\ 0 & 0 & 0 & \\dots \\\\ N_1N_2 & 0 & N_2^2 & \\dots \\\\ \\vdots & & & \\ddots \\end{pmatrix}$. Only the entries corresponding to normal DOFs ($1,3,5,7$) are non-zero.\nWe require the integrals of the shape function products:\n$$ \\int_{-1}^{1} N_1^2 \\,d\\xi = \\frac{2}{3}, \\quad \\int_{-1}^{1} N_2^2 \\,d\\xi = \\frac{2}{3}, \\quad \\int_{-1}^{1} N_1 N_2 \\,d\\xi = \\frac{1}{3} $$\nThe constant pre-factor is $b J k_n = (0.5 \\, \\mathrm{m}) (\\frac{0.6 \\, \\mathrm{m}}{2}) (6.0 \\times 10^{10} \\, \\mathrm{N/m^3}) = 9.0 \\times 10^9 \\, \\mathrm{N/m}$.\nLet's define a $4 \\times 4$ matrix $K_{nn}$ for the normal DOFs $(u_{1n}, u_{2n}, u_{3n}, u_{4n})$:\n$$ K_{nn} = b J k_n \\int_{-1}^{1} \\begin{pmatrix} N_1 \\\\ N_2 \\\\ -N_1 \\\\ -N_2 \\end{pmatrix} \\begin{pmatrix} N_1 & N_2 & -N_1 & -N_2 \\end{pmatrix} d\\xi = b J k_n \\begin{pmatrix} \\int N_1^2 & \\int N_1N_2 & -\\int N_1^2 & -\\int N_1N_2 \\\\ \\int N_1N_2 & \\int N_2^2 & -\\int N_1N_2 & -\\int N_2^2 \\\\ -\\int N_1^2 & -\\int N_1N_2 & \\int N_1^2 & \\int N_1N_2 \\\\ -\\int N_1N_2 & -\\int N_2^2 & \\int N_1N_2 & \\int N_2^2 \\end{pmatrix} d\\xi $$\n$$ K_{nn} = (9.0 \\times 10^9) \\begin{pmatrix} 2/3 & 1/3 & -2/3 & -1/3 \\\\ 1/3 & 2/3 & -1/3 & -2/3 \\\\ -2/3 & -1/3 & 2/3 & 1/3 \\\\ -1/3 & -2/3 & 1/3 & 2/3 \\end{pmatrix} = 3.0 \\times 10^9 \\begin{pmatrix} 2 & 1 & -2 & -1 \\\\ 1 & 2 & -1 & -2 \\\\ -2 & -1 & 2 & 1 \\\\ -1 & -2 & 1 & 2 \\end{pmatrix} $$\nThe full $8 \\times 8$ local stiffness matrix $K^{\\text{loc}}$ is formed by placing the entries of $K_{nn}$ into the rows and columns corresponding to normal DOFs.\n\n**2. Transformation to Global Coordinates**\n\nThe transformation from local to global coordinates for the nodal displacement vector is $\\boldsymbol{d}^{\\text{glob}} = \\boldsymbol{T} \\boldsymbol{d}^{\\text{loc}}$, where $\\boldsymbol{T}$ is a block-diagonal matrix of rotation matrices $\\boldsymbol{R}$:\n$$ \\boldsymbol{T} = \\begin{pmatrix} \\boldsymbol{R} & \\boldsymbol{0} & \\boldsymbol{0} & \\boldsymbol{0} \\\\ \\boldsymbol{0} & \\boldsymbol{R} & \\boldsymbol{0} & \\boldsymbol{0} \\\\ \\boldsymbol{0} & \\boldsymbol{0} & \\boldsymbol{R} & \\boldsymbol{0} \\\\ \\boldsymbol{0} & \\boldsymbol{0} & \\boldsymbol{0} & \\boldsymbol{R} \\end{pmatrix}, \\quad \\boldsymbol{R} = [\\boldsymbol{n} \\ \\boldsymbol{m}] = \\begin{pmatrix} \\cos\\theta & -\\sin\\theta \\\\ \\sin\\theta & \\cos\\theta \\end{pmatrix} $$\nThe global stiffness matrix is obtained by the standard transformation $K^{\\text{glob}} = \\boldsymbol{T} K^{\\text{loc}} \\boldsymbol{T}^{\\mathsf{T}}$. This operation can be performed on the $2 \\times 2$ sub-blocks. Each $2 \\times 2$ block $K_{ij}^{\\text{loc}}$ in $K^{\\text{loc}}$ is transformed as $K_{ij}^{\\text{glob}} = \\boldsymbol{R} K_{ij}^{\\text{loc}} \\boldsymbol{R}^{\\mathsf{T}}$.\nThe blocks in $K^{\\text{loc}}$ have the form $K_{ij}^{\\text{loc}} = (K_{nn})_{ij} \\begin{pmatrix} 1 & 0 \\\\ 0 & 0 \\end{pmatrix}$.\nThe transformation on the matrix part is:\n$$ \\boldsymbol{R} \\begin{pmatrix} 1 & 0 \\\\ 0 & 0 \\end{pmatrix} \\boldsymbol{R}^{\\mathsf{T}} = \\begin{pmatrix} \\cos\\theta & -\\sin\\theta \\\\ \\sin\\theta & \\cos\\theta \\end{pmatrix} \\begin{pmatrix} 1 & 0 \\\\ 0 & 0 \\end{pmatrix} \\begin{pmatrix} \\cos\\theta & \\sin\\theta \\\\ -\\sin\\theta & \\cos\\theta \\end{pmatrix} = \\begin{pmatrix} \\cos^2\\theta & \\cos\\theta\\sin\\theta \\\\ \\cos\\theta\\sin\\theta & \\sin^2\\theta \\end{pmatrix} = \\boldsymbol{n}\\boldsymbol{n}^{\\mathsf{T}} $$\nThus, the global stiffness matrix is the Kronecker product of the normal stiffness matrix $K_{nn}$ and the rank-one matrix $\\boldsymbol{n}\\boldsymbol{n}^{\\mathsf{T}}$: $K^{\\text{glob}} = K_{nn} \\otimes (\\boldsymbol{n}\\boldsymbol{n}^{\\mathsf{T}})$.\n\n**3. Numerical Evaluation**\n\nGiven $\\cos\\theta = 4/5 = 0.8$ and $\\sin\\theta = 3/5 = 0.6$:\n$$ \\boldsymbol{n}\\boldsymbol{n}^{\\mathsf{T}} = \\begin{pmatrix} (0.8)^2 & (0.8)(0.6) \\\\ (0.8)(0.6) & (0.6)^2 \\end{pmatrix} = \\begin{pmatrix} 0.64 & 0.48 \\\\ 0.48 & 0.36 \\end{pmatrix} $$\nThe aforementioned $4 \\times 4$ matrix $K_{nn}$ is:\n$$ K_{nn} = 10^9 \\begin{pmatrix} 6 & 3 & -6 & -3 \\\\ 3 & 6 & -3 & -6 \\\\ -6 & -3 & 6 & 3 \\\\ -3 & -6 & 3 & 6 \\end{pmatrix} \\, \\mathrm{N/m} $$\nThe final $8 \\times 8$ global stiffness matrix $K^{\\text{glob}}$ is constructed by multiplying each entry of $K_{nn}$ by the $2 \\times 2$ matrix $\\boldsymbol{n}\\boldsymbol{n}^{\\mathsf{T}}$.\nFor example, the top-left $2 \\times 2$ block is $(K_{nn})_{11} (\\boldsymbol{n}\\boldsymbol{n}^{\\mathsf{T}})$:\n$$ K^{\\text{glob}}_{11} = (6.0 \\times 10^9) \\begin{pmatrix} 0.64 & 0.48 \\\\ 0.48 & 0.36 \\end{pmatrix} = \\begin{pmatrix} 3.84 \\times 10^9 & 2.88 \\times 10^9 \\\\ 2.88 \\times 10^9 & 2.16 \\times 10^9 \\end{pmatrix} \\, \\mathrm{N/m} $$\nThe block for nodes $1$ and $2$ is $(K_{nn})_{12} (\\boldsymbol{n}\\boldsymbol{n}^{\\mathsf{T}})$:\n$$ K^{\\text{glob}}_{12} = (3.0 \\times 10^9) \\begin{pmatrix} 0.64 & 0.48 \\\\ 0.48 & 0.36 \\end{pmatrix} = \\begin{pmatrix} 1.92 \\times 10^9 & 1.44 \\times 10^9 \\\\ 1.44 \\times 10^9 & 1.08 \\times 10^9 \\end{pmatrix} \\, \\mathrm{N/m} $$\nFilling all blocks and rounding to four significant figures yields the final matrix. Note that the calculated values are exact, so we simply add trailing zeros to meet the precision requirement. For example, $3.84 \\times 10^9$ becomes $3.840 \\times 10^9$.", "answer": "$$ \\boxed{\n\\begin{pmatrix}\n 3.840 &  2.880 &  1.920 &  1.440 & -3.840 & -2.880 & -1.920 & -1.440 \\\\\n 2.880 &  2.160 &  1.440 &  1.080 & -2.880 & -2.160 & -1.440 & -1.080 \\\\\n 1.920 &  1.440 &  3.840 &  2.880 & -1.920 & -1.440 & -3.840 & -2.880 \\\\\n 1.440 &  1.080 &  2.880 &  2.160 & -1.440 & -1.080 & -2.880 & -2.160 \\\\\n-3.840 & -2.880 & -1.920 & -1.440 &  3.840 &  2.880 &  1.920 &  1.440 \\\\\n-2.880 & -2.160 & -1.440 & -1.080 &  2.880 &  2.160 &  1.440 &  1.080 \\\\\n-1.920 & -1.440 & -3.840 & -2.880 &  1.920 &  1.440 &  3.840 &  2.880 \\\\\n-1.440 & -1.080 & -2.880 & -2.160 &  1.440 &  1.080 &  2.880 &  2.160\n\\end{pmatrix} \\times 10^9\n} $$", "id": "3506922"}, {"introduction": "Cohesive zone models introduce material softening, a feature that can lead to complex structural responses not seen in purely elastic systems. This exercise explores the crucial concept of structural stability by analyzing a simple one-dimensional bar containing a cohesive crack [@problem_id:3506892]. By examining the interplay between the bar's elastic compliance and the interface's softening law, you will derive the condition for snapback instability, a phenomenon of great importance in both physical testing and numerical simulation.", "problem": "A straight, prismatic one-dimensional bar of length $L$, uniform cross-sectional area $A$, and Young’s modulus $E$ contains a single pre-existing cohesive interface located at midspan. The bar is subjected to quasi-static, tensile end displacement control. The interface obeys a linear softening traction–separation law\n$$\nt(\\delta) \\;=\\; T_c \\,\\max\\!\\left(0,\\,1-\\frac{\\delta}{\\delta_c}\\right),\n$$\nwhere $t(\\delta)$ is the traction transmitted across the interface, $\\delta$ is the scalar separation (opening) of the interface, $T_c$ is the peak traction (damage initiation traction), and $\\delta_c$ is the critical separation at which $t=0$. Assume small strains, linear elasticity in the bulk, and that the bar away from the interface carries uniform stress under the imposed displacement. Neglect any pre-peak elastic stiffness of the interface so that the admissible loading path on the cohesive law is the descending branch beginning at $\\delta=0$.\n\nStarting only from force equilibrium and kinematic compatibility for series components, and using the constitutive relations for the bar and the cohesive interface, do the following:\n\n1) Derive the global force–displacement response $F(\\Delta)$ during the softening regime, where $\\Delta$ is the imposed end-to-end displacement, explicitly in terms of $E$, $A$, $L$, $T_c$, and $\\delta_c$. State clearly the range of $\\Delta$ over which this softening branch is traversed under monotonic displacement control when it is accessible.\n\n2) Using an incremental (tangent) stiffness argument for two elements in series (the elastic bar and the softening cohesive interface), determine the condition that separates a monotonic descending global force–displacement response from snapback. Identify the corresponding critical bar length $L_{\\mathrm{cr}}$ in terms of $E$, $T_c$, and $\\delta_c$.\n\nProvide your final reported answer as a single closed-form analytic expression for the critical bar length $L_{\\mathrm{cr}}$. Express $L_{\\mathrm{cr}}$ in meters. No numerical values are to be substituted.", "solution": "The problem statement is first validated against the required criteria.\n\n### Step 1: Extract Givens\n- A one-dimensional prismatic bar of length $L$, cross-sectional area $A$, and Young’s modulus $E$.\n- A single cohesive interface is located at midspan.\n- The bar is under quasi-static, tensile end displacement control, with total displacement $\\Delta$.\n- The cohesive interface obeys a linear softening traction–separation law: $t(\\delta) = T_c \\max(0, 1-\\frac{\\delta}{\\delta_c})$.\n- $t(\\delta)$ is the traction across the interface.\n- $\\delta$ is the separation (opening) of the interface.\n- $T_c$ is the peak traction (damage initiation traction).\n- $\\delta_c$ is the critical separation at which traction becomes zero.\n- Assumptions:\n    - Small strains.\n    - Linear elasticity in the bulk material.\n    - Uniform stress in the bar away from the interface.\n    - Negligible pre-peak elastic stiffness of the interface; the loading path is the descending branch starting from $\\delta=0$.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded:** The problem is a standard application of cohesive zone models to analyze the stability of fracture in a quasi-brittle material. The linear traction-separation law is a common, simplified model used in fracture mechanics. The setup represents a classic one-dimensional problem for studying structural stability. The problem is firmly grounded in the principles of continuum mechanics and fracture mechanics.\n- **Well-Posed:** The problem provides all necessary material parameters ($E, T_c, \\delta_c$), geometric parameters ($L, A$), and constitutive laws to derive the requested quantities. The objectives are clearly stated and a unique solution is attainable.\n- **Objective:** The problem is stated in precise, objective, and standard scientific language, free from ambiguity or subjective claims.\n\n### Step 3: Verdict and Action\nThe problem is scientifically sound, well-posed, and objective. It is deemed **valid**. The solution will now be derived.\n\nThe system can be modeled as two components in series: the elastic bar and the cohesive interface. The total response is governed by force equilibrium and kinematic compatibility.\n\n**1) Derivation of the Global Force–Displacement Response $F(\\Delta)$**\n\nLet $F$ be the tensile force acting on the bar and $\\Delta$ be the total end-to-end displacement.\n\n**Force Equilibrium:** The force is uniform throughout the series system.\n$$F = F_{\\text{bar}} = F_{\\text{interface}}$$\n\n**Kinematic Compatibility:** The total displacement $\\Delta$ is the sum of the elastic elongation of the bar, $\\Delta_{\\text{bar}}$, and the opening of the cohesive interface, $\\delta$.\n$$ \\Delta = \\Delta_{\\text{bar}} + \\delta $$\n\n**Constitutive Relations:**\n- For the linear elastic bar, the elongation is given by Hooke's law:\n$$ \\Delta_{\\text{bar}} = \\frac{F L}{A E} $$\n- For the cohesive interface, the force is the traction multiplied by the area. Using the given linear softening law:\n$$ F = A \\cdot t(\\delta) = A T_c \\left(1 - \\frac{\\delta}{\\delta_c}\\right) $$\nThis relation is valid for the softening regime, where $0 \\le \\delta \\le \\delta_c$.\n\nTo find the global response $F(\\Delta)$, we must eliminate the internal variable $\\delta$. It is convenient to first express $\\Delta$ as a function of $F$ and then invert the relationship.\nFrom the interface constitutive law, we can express $\\delta$ as a function of $F$:\n$$ \\frac{F}{A T_c} = 1 - \\frac{\\delta}{\\delta_c} \\implies \\frac{\\delta}{\\delta_c} = 1 - \\frac{F}{A T_c} \\implies \\delta(F) = \\delta_c \\left(1 - \\frac{F}{A T_c}\\right) $$\nThis is valid for $F$ decreasing from a peak of $A T_c$ (at $\\delta=0$) to $0$ (at $\\delta=\\delta_c$).\n\nNow, substitute the expressions for $\\Delta_{\\text{bar}}(F)$ and $\\delta(F)$ into the kinematic compatibility equation:\n$$ \\Delta(F) = \\frac{F L}{A E} + \\delta_c \\left(1 - \\frac{F}{A T_c}\\right) $$\nRearranging the terms to group the coefficients of $F$:\n$$ \\Delta(F) = \\delta_c + F \\left(\\frac{L}{A E} - \\frac{\\delta_c}{A T_c}\\right) $$\nTo obtain $F(\\Delta)$, we solve for $F$:\n$$ \\Delta - \\delta_c = F \\left(\\frac{L}{A E} - \\frac{\\delta_c}{A T_c}\\right) $$\n$$ F(\\Delta) = \\frac{A E T_c (\\Delta - \\delta_c)}{L T_c - E \\delta_c} $$\nThis is the global force-displacement response during the softening regime.\n\nThe range of $\\Delta$ for this softening branch is determined by the range of $\\delta$, i.e., from $\\delta=0$ to $\\delta=\\delta_c$.\n- At the start of softening ($\\delta=0$):\n  The force is at its peak, $F_{\\text{peak}} = A T_c(1-0) = A T_c$.\n  The corresponding total displacement is $\\Delta_{\\text{start}} = \\Delta(F=A T_c) = \\frac{(A T_c) L}{A E} + 0 = \\frac{T_c L}{E}$.\n- At the end of softening ($\\delta=\\delta_c$):\n  The force is zero, $F_{\\text{fail}} = A T_c(1 - \\delta_c/\\delta_c) = 0$.\n  The corresponding total displacement is $\\Delta_{\\text{end}} = \\Delta(F=0) = \\frac{0 \\cdot L}{A E} + \\delta_c = \\delta_c$.\n\nThe softening branch is accessible under monotonic displacement control if the response is stable, which means that as $\\Delta$ increases, $F$ decreases. This requires $\\Delta_{\\text{start}} < \\Delta_{\\text{end}}$, or $\\frac{T_c L}{E} < \\delta_c$. If this condition holds, the softening branch is traversed for $\\Delta$ in the range:\n$$ \\Delta \\in \\left[\\frac{T_c L}{E}, \\delta_c\\right] $$\n\n**2) Determination of the Critical Bar Length $L_{\\mathrm{cr}}$**\n\nSnapback instability occurs when the system's total stiffness becomes insufficient to ensure a stable, monotonic softening path under displacement control. We can determine the stability condition by examining the tangent stiffness of the whole system. The system stiffness $K_{\\text{sys}}$ for two components in series is given by:\n$$ \\frac{1}{K_{\\text{sys}}} = \\frac{1}{K_{\\text{bar}}} + \\frac{1}{K_{\\text{int}}} $$\nwhere $K_{\\text{bar}}$ and $K_{\\text{int}}$ are the tangent stiffnesses of the bar and the interface, respectively.\n\nThe tangent stiffness of a component is the derivative of the force with respect to its own local displacement.\n- For the bar: $F = (\\frac{AE}{L}) \\Delta_{\\text{bar}}$. The stiffness is constant and positive.\n$$ K_{\\text{bar}} = \\frac{dF}{d\\Delta_{\\text{bar}}} = \\frac{A E}{L} $$\n- For the interface: $F = A T_c (1 - \\frac{\\delta}{\\delta_c})$. The tangent stiffness is constant and negative during softening.\n$$ K_{\\text{int}} = \\frac{dF}{d\\delta} = -\\frac{A T_c}{\\delta_c} $$\nThe total system tangent stiffness, $K_{\\text{total}} = \\frac{dF}{d\\Delta}$, is then:\n$$ \\frac{1}{K_{\\text{total}}} = \\frac{L}{A E} + \\frac{1}{-A T_c / \\delta_c} = \\frac{L}{A E} - \\frac{\\delta_c}{A T_c} $$\nA stable, monotonic descending response requires that an increase in total displacement $\\Delta$ results in a decrease in force $F$, meaning $K_{\\text{total}} = \\frac{dF}{d\\Delta} \\le 0$.\nConversely, snapback occurs if the equilibrium path requires a decrease in $\\Delta$ to follow a decrease in $F$. In the $F$-$\\Delta$ plane, this corresponds to a positive slope, $K_{\\text{total}} > 0$.\n\nThe sign of $K_{\\text{total}}$ is determined by the sign of its reciprocal, $1/K_{\\text{total}}$.\n$$ \\frac{1}{K_{\\text{total}}} = \\frac{L T_c - E \\delta_c}{A E T_c} $$\nSince $A$, $E$, and $T_c$ are positive, the sign of $1/K_{\\text{total}}$ is the same as the sign of $(L T_c - E \\delta_c)$.\n- **Stable Softening:** $K_{\\text{total}} < 0 \\implies 1/K_{\\text{total}} < 0 \\implies L T_c - E \\delta_c < 0 \\implies L < \\frac{E \\delta_c}{T_c}$.\n- **Snapback Instability:** $K_{\\text{total}} > 0 \\implies 1/K_{\\text{total}} > 0 \\implies L T_c - E \\delta_c > 0 \\implies L > \\frac{E \\delta_c}{T_c}$.\n\nThe critical condition separates these two behaviors. It occurs when the total stiffness changes sign, which, in this case, corresponds to $K_{\\text{total}} \\to \\infty$ or $1/K_{\\text{total}} = 0$. This represents an instantaneous, vertical drop in load at constant displacement.\n$$ \\frac{L_{\\mathrm{cr}}}{A E} - \\frac{\\delta_c}{A T_c} = 0 $$\nSolving for the critical length $L_{\\mathrm{cr}}$:\n$$ \\frac{L_{\\mathrm{cr}}}{A E} = \\frac{\\delta_c}{A T_c} $$\n$$ L_{\\mathrm{cr}} = \\frac{A E \\delta_c}{A T_c} = \\frac{E \\delta_c}{T_c} $$\nThis critical length marks the boundary: for bar lengths $L < L_{\\mathrm{cr}}$, the global response is a stable, monotonic softening curve. For $L > L_{\\mathrm{cr}}$, the response exhibits snapback instability. The problem asks for this critical length.", "answer": "$$\\boxed{\\frac{E \\delta_c}{T_c}}$$", "id": "3506892"}, {"introduction": "Advanced simulations in geomechanics require robust numerical implementation of complex constitutive behaviors at the integration-point level. This practice delves into the heart of a computational mechanics code by asking you to derive and implement a return-mapping algorithm for a cohesive interface that combines tensile damage with Coulomb friction [@problem_id:3506902]. Mastering this technique is essential for developing and understanding finite element models that can accurately capture coupled failure mechanisms like shear-slip on a degrading fracture.", "problem": "You are asked to derive and implement a return-mapping algorithm for the tangential traction of a cohesive interface element under rate-independent Coulomb friction, in the presence of normal tensile cohesive softening. The interface is assumed to have one tangential direction and one normal direction. The tangential response is linear elastic with stiffness $k_t$ up to the Coulomb limit, while the normal response undergoes linear softening in tension governed by a scalar damage variable. The algorithm must include stick and slip updates, and compute the consistent algorithmic tangent entries needed for Newton-type solvers.\n\nThe derivation must begin from fundamental laws and well-tested definitions:\n- Interface traction-separation laws define the relationship between the mechanical tractions and the relative displacements (separations) across an interface.\n- The rate-independent Coulomb friction law defines the tangential traction bound by a friction threshold proportional to the compressive normal traction.\n- In damage mechanics, a scalar damage variable $D$ reduces the tensile stiffness according to a prescribed evolution driven by the maximum normal tensile separation.\n\nDefine the following quantities for an interface point:\n- Tangential separation $s_t$ (in meters).\n- Normal separation $s_n$ (in meters), with tension taken as $s_n \\ge 0$ and compression as $s_n < 0$.\n- Tangential stiffness $k_t$ (in Pascal per meter).\n- Normal stiffness $k_n$ (in Pascal per meter).\n- Friction coefficient $\\mu$ (dimensionless).\n- Critical normal separation for complete tensile decohesion $\\delta_c$ (in meters).\n- Normal traction $T_n$ (in Pascal).\n- Tangential traction $T_t$ (in Pascal).\n- Tangential slip internal variable $\\gamma$ (in meters).\n- History variable for tensile separation $\\kappa$ (in meters), tracking the maximum attained $s_n$ in tension.\n- Scalar damage $D \\in [0,1]$ (dimensionless).\n\nThe normal traction-separation law is defined by linear elastic behavior in compression and linear softening in tension:\n1. In tension ($s_n \\ge 0$), $T_n = (1 - D)\\,k_n\\,s_n$, with $D = \\min\\left(1, \\dfrac{\\kappa}{\\delta_c}\\right)$ and $\\kappa = \\max(\\kappa_{\\text{old}}, s_n)$.\n2. In compression ($s_n < 0$), $T_n = k_n\\,s_n$, with no damage evolution ($\\kappa = \\kappa_{\\text{old}}$).\n\nThe Coulomb friction threshold $\\tau_{\\text{lim}}$ depends on the compressive normal traction only:\n$$\n\\tau_{\\text{lim}} = \\mu\\,\\max(0, -T_n).\n$$\n\nThe tangential traction is governed by an elastic law with an internal slip variable:\n$$\nT_t = k_t\\,(s_t - \\gamma).\n$$\n\nA rate-independent return-mapping algorithm must be constructed based on the following conditions:\n- Trial state: $T_t^{\\text{trial}} = k_t\\,(s_t - \\gamma_{\\text{old}})$.\n- Yield function: $\\phi = |T_t^{\\text{trial}}| - \\tau_{\\text{lim}}$.\n- Kuhn–Tucker conditions for stick/slip: If $\\phi \\le 0$ then stick; if $\\phi > 0$ then slip.\n\nIn the slip case, impose $|T_t| = \\tau_{\\text{lim}}$ and update $\\gamma$ to enforce the consistency condition. Derive explicit formulas for the updated $T_t$, $\\gamma$, and the consistent algorithmic tangents for Newton-type iteration:\n- $K_{tt} = \\dfrac{\\partial T_t}{\\partial s_t}$,\n- $K_{tn} = \\dfrac{\\partial T_t}{\\partial s_n}$.\n\nYour program must implement this algorithm and produce the following outputs for each test case:\n- The updated tangential traction $T_t$ (in Pascal).\n- The consistent tangents $K_{tt}$ and $K_{tn}$ (in Pascal per meter).\n- The updated internal variables $\\gamma$ and $\\kappa$ (in meters).\n- The updated damage $D$ (dimensionless).\n- The updated normal traction $T_n$ (in Pascal).\n\nUse the International System of Units (SI). All tractions must be expressed in Pascal (Pa), and stiffnesses in Pascal per meter (Pa/m), separations and internal variables in meters (m). Angles do not appear. Output all final quantities as floating-point numbers. Your program should round nothing explicitly.\n\nTest suite:\n- Case 1 (compression stick): $k_t = 5.0 \\times 10^8$ Pa/m, $k_n = 1.0 \\times 10^9$ Pa/m, $\\mu = 0.6$, $s_t = 1.0 \\times 10^{-5}$ m, $s_n = -1.0 \\times 10^{-5}$ m, $\\delta_c = 1.0 \\times 10^{-5}$ m, $\\kappa_{\\text{old}} = 0.0$ m, $\\gamma_{\\text{old}} = 0.0$ m.\n- Case 2 (compression slip): $k_t = 5.0 \\times 10^8$ Pa/m, $k_n = 1.0 \\times 10^9$ Pa/m, $\\mu = 0.6$, $s_t = 2.0 \\times 10^{-5}$ m, $s_n = -1.0 \\times 10^{-5}$ m, $\\delta_c = 1.0 \\times 10^{-5}$ m, $\\kappa_{\\text{old}} = 0.0$ m, $\\gamma_{\\text{old}} = 0.0$ m.\n- Case 3 (tension with partial damage): $k_t = 5.0 \\times 10^8$ Pa/m, $k_n = 1.0 \\times 10^9$ Pa/m, $\\mu = 0.6$, $s_t = 3.0 \\times 10^{-5}$ m, $s_n = 2.0 \\times 10^{-6}$ m, $\\delta_c = 1.0 \\times 10^{-5}$ m, $\\kappa_{\\text{old}} = 1.0 \\times 10^{-6}$ m, $\\gamma_{\\text{old}} = 0.0$ m.\n- Case 4 (compression at yield boundary): $k_t = 5.0 \\times 10^8$ Pa/m, $k_n = 1.0 \\times 10^9$ Pa/m, $\\mu = 0.6$, $s_t = 1.2 \\times 10^{-5}$ m, $s_n = -1.0 \\times 10^{-5}$ m, $\\delta_c = 1.0 \\times 10^{-5}$ m, $\\kappa_{\\text{old}} = 0.0$ m, $\\gamma_{\\text{old}} = 0.0$ m.\n- Case 5 (tension with full decohesion): $k_t = 5.0 \\times 10^8$ Pa/m, $k_n = 1.0 \\times 10^9$ Pa/m, $\\mu = 0.6$, $s_t = 1.0 \\times 10^{-4}$ m, $s_n = 1.2 \\times 10^{-5}$ m, $\\delta_c = 1.0 \\times 10^{-5}$ m, $\\kappa_{\\text{old}} = 8.0 \\times 10^{-6}$ m, $\\gamma_{\\text{old}} = 0.0$ m.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case result is itself a list in the following order:\n$[T_t, K_{tt}, K_{tn}, \\gamma, \\kappa, D, T_n]$.\nFor example:\n$[[\\dots],[\\dots],[\\dots],[\\dots],[\\dots]]$.", "solution": "The problem requires the derivation and implementation of a return-mapping algorithm for a cohesive interface model. The model incorporates linear elasticity in compression, tensile softening governed by a scalar damage variable, and a rate-independent Coulomb friction law for the tangential response. The derivation will proceed from the fundamental constitutive relations provided.\n\nLet the state of the interface at the beginning of a time/load step be defined by the history variables $\\kappa_{\\text{old}}$ (maximum tensile separation) and $\\gamma_{\\text{old}}$ (accumulated tangential slip). The current state is defined by the separations $s_t$ and $s_n$. The objective is to compute the updated tractions $T_t$, $T_n$, internal variables $\\gamma$, $\\kappa$, damage $D$, and the consistent algorithmic tangents $K_{tt} = \\frac{\\partial T_t}{\\partial s_t}$ and $K_{tn} = \\frac{\\partial T_t}{\\partial s_n}$.\n\nThe constitutive laws are defined as follows:\n- Normal traction in tension ($s_n \\ge 0$): $T_n = (1 - D)\\,k_n\\,s_n$, with the damage variable $D = \\min\\left(1, \\frac{\\kappa}{\\delta_c}\\right)$ and the history variable $\\kappa = \\max(\\kappa_{\\text{old}}, s_n)$.\n- Normal traction in compression ($s_n < 0$): $T_n = k_n\\,s_n$. The history variable $\\kappa$ is not updated, i.e., $\\kappa=\\kappa_{\\text{old}}$.\n- Tangential traction: $T_t = k_t\\,(s_t - \\gamma)$.\n- Coulomb friction limit: $\\tau_{\\text{lim}} = \\mu\\,\\max(0, -T_n)$.\n\nThe algorithm proceeds in two main parts: updating the normal response and then updating the tangential response.\n\n**1. Normal Response Update**\n\nThe normal traction $T_n$ and the damage history variable $\\kappa$ depend solely on the normal separation $s_n$ and its history $\\kappa_{\\text{old}}$. We evaluate these first as they are required for the tangential part (via $\\tau_{\\text{lim}}$).\n\n- **Case 1: Compression ($s_n < 0$)**\n  The interface is in compression. No damage evolution occurs.\n  The history variable for tensile separation remains unchanged:\n  $$ \\kappa = \\kappa_{\\text{old}} $$\n  The damage variable $D$ is calculated based on the prior maximum tensile separation:\n  $$ D = \\min\\left(1, \\frac{\\kappa_{\\text{old}}}{\\delta_c}\\right) $$\n  The normal traction is given by the linear elastic law, unaffected by damage:\n  $$ T_n = k_n\\,s_n $$\n\n- **Case 2: Tension ($s_n \\ge 0$)**\n  The interface is in tension. The history variable $\\kappa$ must be updated to track the maximum experienced tensile separation:\n  $$ \\kappa = \\max(\\kappa_{\\text{old}}, s_n) $$\n  The damage variable $D$ evolves with $\\kappa$:\n  $$ D = \\min\\left(1, \\frac{\\kappa}{\\delta_c}\\right) $$\n  The normal traction is reduced by the damage factor:\n  $$ T_n = (1 - D)\\,k_n\\,s_n $$\n\n**2. Tangential Response Update (Return-Mapping Algorithm)**\n\nThe update for the tangential traction $T_t$ and slip $\\gamma$ follows a standard elastic-predictor, plastic-corrector (return-mapping) scheme.\n\n- **Step A: Elastic Trial State**\n  First, we assume the increment is purely elastic (stick condition). The slip variable does not change, $\\gamma = \\gamma_{\\text{old}}$. The trial tangential traction is:\n  $$ T_t^{\\text{trial}} = k_t\\,(s_t - \\gamma_{\\text{old}}) $$\n\n- **Step B: Check Yield Condition**\n  We define a yield function $\\phi$ to check if the trial traction exceeds the friction limit. The friction limit $\\tau_{\\text{lim}} = \\mu\\,\\max(0, -T_n)$ is computed using the updated normal traction $T_n$ from step 1.\n  $$ \\phi = |T_t^{\\text{trial}}| - \\tau_{\\text{lim}} $$\n  The subsequent action depends on the sign of $\\phi$.\n\n- **Step C: Stick/Slip Update**\n\n  - **If $\\phi \\le 0$ (Stick Condition):**\n    The elastic trial state is valid. The interface does not slip.\n    The final tangential traction is the trial traction:\n    $$ T_t = T_t^{\\text{trial}} $$\n    The slip variable is unchanged:\n    $$ \\gamma = \\gamma_{\\text{old}} $$\n\n  - **If $\\phi > 0$ (Slip Condition):**\n    The trial traction is outside the elastic domain and must be \"returned\" to the yield surface. This is a plastic (slip) step.\n    The magnitude of the final tangential traction is equal to the friction limit:\n    $$ |T_t| = \\tau_{\\text{lim}} $$\n    The direction of the final traction is collinear with the trial traction. Let $\\text{sgn}(x)$ be the signum function.\n    $$ T_t = \\tau_{\\text{lim}} \\cdot \\text{sgn}(T_t^{\\text{trial}}) $$\n    The updated slip variable $\\gamma$ is determined by inverting the tangential constitutive law, $T_t = k_t(s_t - \\gamma)$:\n    $$ \\gamma = s_t - \\frac{T_t}{k_t} = s_t - \\frac{\\tau_{\\text{lim}}}{k_t} \\text{sgn}(T_t^{\\text{trial}}) $$\n\n**3. Derivation of Consistent Algorithmic Tangents**\n\nThe consistent algorithmic tangent moduli, $K_{tt} = \\frac{\\partial T_t}{\\partial s_t}$ and $K_{tn} = \\frac{\\partial T_t}{\\partial s_n}$, are essential for Newton-Raphson solvers. Their derivation depends on whether the final state is stick or slip.\n\n- **Stick Case ($\\phi \\le 0$):**\n  In this case, the final traction is $T_t = k_t(s_t - \\gamma_{\\text{old}})$.\n  The derivatives are straightforward:\n  $$ K_{tt} = \\frac{\\partial T_t}{\\partial s_t} = k_t $$\n  The tangential traction does not depend on $s_n$:\n  $$ K_{tn} = \\frac{\\partial T_t}{\\partial s_n} = 0 $$\n\n- **Slip Case ($\\phi > 0$):**\n  The final traction is $T_t = \\text{sgn}(T_t^{\\text{trial}}) \\cdot \\tau_{\\text{lim}}$. Since $T_t^{\\text{trial}}$ depends on $s_t$ and not $s_n$, the term $\\text{sgn}(T_t^{\\text{trial}})$ can be treated as a constant with respect to infinitesimal variations of $s_t$ and $s_n$ around the final state.\n  The friction limit is $\\tau_{\\text{lim}} = \\mu\\,\\max(0, -T_n)$.\n  Thus, $T_t = \\text{sgn}(T_t^{\\text{trial}}) \\cdot \\mu \\cdot \\max(0, -T_n)$.\n  \n  - **Derivative with respect to $s_t$:**\n    The normal traction $T_n$ is independent of $s_t$, so $\\tau_{\\text{lim}}$ is also independent of $s_t$.\n    $$ K_{tt} = \\frac{\\partial T_t}{\\partial s_t} = 0 $$\n    \n  - **Derivative with respect to $s_n$:**\n    $$ K_{tn} = \\frac{\\partial T_t}{\\partial s_n} = \\text{sgn}(T_t^{\\text{trial}}) \\cdot \\mu \\cdot \\frac{\\partial}{\\partial s_n}\\max(0, -T_n) $$\n    The derivative depends on whether the interface is in tension or compression.\n    \n    *   **If $s_n \\ge 0$ (Tension):** The normal traction is $T_n \\ge 0$. Therefore, $-T_n \\le 0$, and $\\max(0, -T_n) = 0$. In this regime, $\\tau_{\\text{lim}} = 0$ and $T_t = 0$. The derivative is zero.\n        $$ K_{tn} = 0 $$\n    \n    *   **If $s_n < 0$ (Compression):** The normal traction is $T_n = k_n s_n < 0$. Therefore, $-T_n > 0$, and $\\max(0, -T_n) = -T_n = -k_n s_n$. The derivative is:\n        $$ \\frac{\\partial}{\\partial s_n}\\max(0, -T_n) = \\frac{\\partial}{\\partial s_n}(-k_n s_n) = -k_n $$\n        Substituting this into the expression for $K_{tn}$:\n        $$ K_{tn} = -\\text{sgn}(T_t^{\\text{trial}}) \\cdot \\mu \\cdot k_n $$\n\nThis completes the derivation of the update algorithm and the consistent tangents. The following implementation is based on this formulation.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run test cases and print results.\n    \"\"\"\n\n    test_cases = [\n        # Case 1 (compression stick)\n        {'kt': 5.0e8, 'kn': 1.0e9, 'mu': 0.6, 'st': 1.0e-5, 'sn': -1.0e-5,\n         'delta_c': 1.0e-5, 'kappa_old': 0.0, 'gamma_old': 0.0},\n        # Case 2 (compression slip)\n        {'kt': 5.0e8, 'kn': 1.0e9, 'mu': 0.6, 'st': 2.0e-5, 'sn': -1.0e-5,\n         'delta_c': 1.0e-5, 'kappa_old': 0.0, 'gamma_old': 0.0},\n        # Case 3 (tension with partial damage)\n        {'kt': 5.0e8, 'kn': 1.0e9, 'mu': 0.6, 'st': 3.0e-5, 'sn': 2.0e-6,\n         'delta_c': 1.0e-5, 'kappa_old': 1.0e-6, 'gamma_old': 0.0},\n        # Case 4 (compression at yield boundary)\n        {'kt': 5.0e8, 'kn': 1.0e9, 'mu': 0.6, 'st': 1.2e-5, 'sn': -1.0e-5,\n         'delta_c': 1.0e-5, 'kappa_old': 0.0, 'gamma_old': 0.0},\n        # Case 5 (tension with full decohesion)\n        {'kt': 5.0e8, 'kn': 1.0e9, 'mu': 0.6, 'st': 1.0e-4, 'sn': 1.2e-5,\n         'delta_c': 1.0e-5, 'kappa_old': 8.0e-6, 'gamma_old': 0.0},\n    ]\n\n    results = []\n    for params in test_cases:\n        result = compute_interface_response(**params)\n        results.append(result)\n\n    # Format output string as per requirements\n    # [[res1_val1,res1_val2,...],[res2_val1,res2_val2,...],...]\n    output_str = f\"[{','.join([f'[{\",\".join(map(str, res))}]' for res in results])}]\"\n    print(output_str)\n\ndef compute_interface_response(kt, kn, mu, st, sn, delta_c, kappa_old, gamma_old):\n    \"\"\"\n    Implements the return-mapping algorithm for the cohesive interface model.\n\n    Args:\n        kt (float): Tangential stiffness (Pa/m).\n        kn (float): Normal stiffness (Pa/m).\n        mu (float): Friction coefficient.\n        st (float): Current tangential separation (m).\n        sn (float): Current normal separation (m).\n        delta_c (float): Critical normal separation for decohesion (m).\n        kappa_old (float): Previous maximum tensile separation (m).\n        gamma_old (float): Previous tangential slip (m).\n\n    Returns:\n        list: A list containing [Tt, Ktt, Ktn, gamma, kappa, D, Tn].\n    \"\"\"\n\n    # 1. Update Normal Response\n    if sn < 0:  # Compression\n        kappa = kappa_old\n        D = min(1.0, kappa / delta_c) if delta_c > 0 else 1.0\n        Tn = kn * sn\n    else:  # Tension (sn >= 0)\n        kappa = max(kappa_old, sn)\n        D = min(1.0, kappa / delta_c) if delta_c > 0 else 1.0\n        Tn = (1.0 - D) * kn * sn\n\n    # 2. Tangential Response - Return Mapping\n    # Elastic trial state\n    Tt_trial = kt * (st - gamma_old)\n    \n    # Friction limit\n    tau_lim = mu * max(0.0, -Tn)\n\n    # Yield function\n    phi = abs(Tt_trial) - tau_lim\n\n    if phi <= 0:  # Stick condition\n        Tt = Tt_trial\n        gamma = gamma_old\n        Ktt = kt\n        Ktn = 0.0\n    else:  # Slip condition\n        sgn_slip = np.sign(Tt_trial)\n        # If Tt_trial is exactly 0, phi > 0 is impossible unless tau_lim is negative,\n        # which it cannot be. So sgn_slip will be -1 or 1.\n        \n        Tt = sgn_slip * tau_lim\n        gamma = st - Tt / kt\n        \n        # Consistent tangents for slip\n        Ktt = 0.0\n        if sn < 0: # Slip in compression\n            Ktn = -sgn_slip * mu * kn\n        else: # Slip in tension (tau_lim = 0)\n            Ktn = 0.0\n\n    return [Tt, Ktt, Ktn, gamma, kappa, D, Tn]\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "3506902"}]}