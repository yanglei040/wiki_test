{"hands_on_practices": [{"introduction": "A crucial first step in applying any peridynamic model is establishing a connection between its micro-scale parameters and the macro-scale mechanical properties measured in a laboratory, such as Young's modulus $E$. This process, known as correspondence, ensures the model's elastic response is physically meaningful. This foundational exercise guides you through a first-principles derivation to determine the micromodulus constant $c_0$ required for a bond-based model to reproduce a target Young's modulus, revealing the model's inherent constraints along the way [@problem_id:3549641].", "problem": "A homogeneous, isotropic, brittle geomaterial is modeled using the bond-based linear microelastic formulation of Peridynamics (PD) in three-dimensional ($3$D) space. The interaction neighborhood of each material point is a sphere of radius $\\delta$ (the peridynamic horizon). The micromodulus function is assumed constant over the horizon, i.e., $c(r) = c_0$ for $0 \\le r \\le \\delta$, and zero otherwise, where $r = |\\boldsymbol{y} - \\boldsymbol{x}|$ and $\\boldsymbol{e} = (\\boldsymbol{y} - \\boldsymbol{x})/r$. The pairwise force density is given by $\\boldsymbol{f}(\\boldsymbol{x},\\boldsymbol{y}) = c(r)\\,s\\,\\boldsymbol{e}$, where the bond stretch for small deformations is $s = \\frac{(\\boldsymbol{u}(\\boldsymbol{y}) - \\boldsymbol{u}(\\boldsymbol{x}))\\cdot \\boldsymbol{e}}{r}$. The pairwise microelastic potential per bond is $w = \\frac{1}{2} c(r)\\,s^{2}\\,r$. The macroscopic Cauchy stress corresponding to a state of uniform deformation is obtained by the virial relation $\\boldsymbol{\\sigma}(\\boldsymbol{x}) = \\frac{1}{2} \\int_{H_{\\boldsymbol{x}}} (\\boldsymbol{y}-\\boldsymbol{x}) \\otimes \\boldsymbol{f}(\\boldsymbol{x},\\boldsymbol{y}) \\, dV_{\\boldsymbol{y}}$. The local elastic response to a uniform strain $\\boldsymbol{\\varepsilon}$ is governed by linear isotropic elasticity with Young’s modulus $E$, Poisson’s ratio $\\nu$, bulk modulus $K$, and Lamé parameters $\\lambda$ and $\\mu$ satisfying $\\boldsymbol{\\sigma} = \\lambda \\operatorname{tr}(\\boldsymbol{\\varepsilon}) \\mathbf{I} + 2 \\mu \\boldsymbol{\\varepsilon}$, $K = \\lambda + \\frac{2}{3}\\mu$, and $K = \\frac{E}{3(1 - 2\\nu)}$. In bond-based PD, the pairwise interaction imposes the constraint $\\nu = \\frac{1}{4}$.\n\nConsider a uniform hydrostatic strain $\\boldsymbol{\\varepsilon} = \\alpha \\mathbf{I}$ with $\\alpha$ a constant. Derive, from first principles, the scalar constant $c_0$ such that the bond-based PD model reproduces the target Young’s modulus $E$ under the inherent constraint $\\nu = \\frac{1}{4}$. Express your final $c_0$ as a closed-form symbolic expression in terms of $E$, $\\delta$, and fundamental constants. Report $c_0$ in base International System of Units (SI) as $\\mathrm{N\\,m^{-6}}$. No rounding is required.", "solution": "We begin from the linear microelastic bond-based peridynamic model and the local linear isotropic elasticity under a uniform deformation. For small deformations, the displacement is approximated by $\\boldsymbol{u}(\\boldsymbol{x}) = \\boldsymbol{\\varepsilon} \\cdot \\boldsymbol{x}$, so for two points $\\boldsymbol{x}$ and $\\boldsymbol{y}$ we have\n$$\n\\boldsymbol{u}(\\boldsymbol{y}) - \\boldsymbol{u}(\\boldsymbol{x}) = \\boldsymbol{\\varepsilon} \\cdot (\\boldsymbol{y} - \\boldsymbol{x}) = \\boldsymbol{\\varepsilon} \\cdot (r \\boldsymbol{e}) .\n$$\nProjecting along the bond direction $\\boldsymbol{e}$ and dividing by $r$ yields the bond stretch\n$$\ns = \\frac{(\\boldsymbol{u}(\\boldsymbol{y}) - \\boldsymbol{u}(\\boldsymbol{x})) \\cdot \\boldsymbol{e}}{r} = \\frac{(r \\boldsymbol{\\varepsilon} \\cdot \\boldsymbol{e}) \\cdot \\boldsymbol{e}}{r} = \\boldsymbol{e} \\cdot (\\boldsymbol{\\varepsilon} \\cdot \\boldsymbol{e}) = \\boldsymbol{\\varepsilon} : (\\boldsymbol{e} \\otimes \\boldsymbol{e}) .\n$$\nFor a uniform hydrostatic strain, $\\boldsymbol{\\varepsilon} = \\alpha \\mathbf{I}$, where $\\mathbf{I}$ is the identity tensor, such that\n$$\ns = \\alpha\\, \\boldsymbol{e} \\cdot (\\mathbf{I} \\cdot \\boldsymbol{e}) = \\alpha .\n$$\nThus, under pure volumetric strain, every bond has the same stretch $s = \\alpha$, independent of $r$ and direction.\n\nThe pairwise force density is $\\boldsymbol{f}(\\boldsymbol{x},\\boldsymbol{y}) = c(r)\\, s\\, \\boldsymbol{e}$. With the constant micromodulus, $c(r) = c_0$, this becomes\n$$\n\\boldsymbol{f}(\\boldsymbol{x},\\boldsymbol{y}) = c_0 \\alpha \\boldsymbol{e} .\n$$\nThe macroscopic Cauchy stress for a uniform deformation is obtained via the virial relation\n$$\n\\boldsymbol{\\sigma}(\\boldsymbol{x}) = \\frac{1}{2} \\int_{H_{\\boldsymbol{x}}} (\\boldsymbol{y} - \\boldsymbol{x}) \\otimes \\boldsymbol{f}(\\boldsymbol{x},\\boldsymbol{y}) \\, dV_{\\boldsymbol{y}} = \\frac{1}{2} \\int_{H_{\\boldsymbol{x}}} r \\boldsymbol{e} \\otimes \\left( c_0 \\alpha \\boldsymbol{e} \\right) \\, dV_{\\boldsymbol{y}} = \\frac{c_0 \\alpha}{2} \\int_{H_{\\boldsymbol{x}}} r\\, \\boldsymbol{e} \\otimes \\boldsymbol{e} \\, dV_{\\boldsymbol{y}} .\n$$\nThe horizon $H_{\\boldsymbol{x}}$ is a sphere of radius $\\delta$. Using spherical coordinates with $dV_{\\boldsymbol{y}} = r^{2} dr \\, d\\Omega$, we separate the angular and radial integrals:\n$$\n\\int_{H_{\\boldsymbol{x}}} r\\, \\boldsymbol{e} \\otimes \\boldsymbol{e} \\, dV_{\\boldsymbol{y}} = \\left( \\int_{0}^{\\delta} r^{3} dr \\right) \\left( \\int_{S^{2}} \\boldsymbol{e} \\otimes \\boldsymbol{e} \\, d\\Omega \\right) .\n$$\nThe angular integral over all directions on the unit sphere satisfies the well-known identity\n$$\n\\int_{S^{2}} \\boldsymbol{e} \\otimes \\boldsymbol{e} \\, d\\Omega = \\frac{4\\pi}{3} \\mathbf{I} ,\n$$\nand the radial integral is\n$$\n\\int_{0}^{\\delta} r^{3} dr = \\frac{\\delta^{4}}{4} .\n$$\nThus,\n$$\n\\int_{H_{\\boldsymbol{x}}} r\\, \\boldsymbol{e} \\otimes \\boldsymbol{e} \\, dV_{\\boldsymbol{y}} = \\frac{\\delta^{4}}{4} \\cdot \\frac{4\\pi}{3} \\mathbf{I} = \\frac{\\pi \\delta^{4}}{3} \\mathbf{I} .\n$$\nSubstituting back into the virial stress relation gives\n$$\n\\boldsymbol{\\sigma}(\\boldsymbol{x}) = \\frac{c_0 \\alpha}{2} \\cdot \\frac{\\pi \\delta^{4}}{3} \\mathbf{I} = \\frac{c_0 \\pi \\delta^{4}}{6} \\alpha \\mathbf{I} .\n$$\nOn the other hand, the local isotropic linear elastic response under hydrostatic strain $\\boldsymbol{\\varepsilon} = \\alpha \\mathbf{I}$ is\n$$\n\\boldsymbol{\\sigma} = \\lambda \\operatorname{tr}(\\boldsymbol{\\varepsilon}) \\mathbf{I} + 2 \\mu \\boldsymbol{\\varepsilon} = \\lambda (3\\alpha) \\mathbf{I} + 2 \\mu \\alpha \\mathbf{I} = (3\\lambda + 2\\mu)\\, \\alpha \\mathbf{I} .\n$$\nUsing the bulk modulus $K = \\lambda + \\frac{2}{3}\\mu$, we have $3\\lambda + 2\\mu = 3K$, hence\n$$\n\\boldsymbol{\\sigma} = 3K \\alpha \\mathbf{I} .\n$$\nMatching the peridynamic and continuum stresses under the same uniform hydrostatic strain, we equate the two expressions:\n$$\n\\frac{c_0 \\pi \\delta^{4}}{6} \\alpha \\mathbf{I} = 3K \\alpha \\mathbf{I} \\quad \\Rightarrow \\quad c_0 = \\frac{18 K}{\\pi \\delta^{4}} .\n$$\nIn bond-based PD, the Poisson’s ratio is constrained to $\\nu = \\frac{1}{4}$. The bulk modulus in terms of Young’s modulus and Poisson’s ratio is\n$$\nK = \\frac{E}{3(1 - 2\\nu)} .\n$$\nSubstituting $\\nu = \\frac{1}{4}$ gives\n$$\nK = \\frac{E}{3\\left(1 - \\frac{1}{2}\\right)} = \\frac{E}{3 \\cdot \\frac{1}{2}} = \\frac{2E}{3} .\n$$\nTherefore,\n$$\nc_0 = \\frac{18}{\\pi \\delta^{4}} \\cdot \\frac{2E}{3} = \\frac{12E}{\\pi \\delta^{4}} .\n$$\nFinally, we confirm the units. Young’s modulus $E$ has units $\\mathrm{N\\,m^{-2}}$, and $\\delta^{4}$ has units $\\mathrm{m^{4}}$, so $c_0$ has units\n$$\n\\frac{\\mathrm{N\\,m^{-2}}}{\\mathrm{m^{4}}} = \\mathrm{N\\,m^{-6}} ,\n$$\nas required.", "answer": "$$\\boxed{\\frac{12 E}{\\pi \\delta^{4}}}$$", "id": "3549641"}, {"introduction": "With a method to calibrate elastic stiffness, we must next ask if the simplest peridynamic model is always sufficient, particularly for the complex stress states encountered in geomechanics. This practice challenges you to think critically about model selection by comparing the predictive capabilities of bond-based (BB-PD) and ordinary state-based (OSB-PD) peridynamics in a thought experiment involving a confined Brazilian test [@problem_id:3549657]. By analyzing how each model handles pressure-dependent failure, you will develop the critical intuition needed to choose the right computational tool for capturing the physics of brittle fracture under confinement.", "problem": "A circular disk specimen of a brittle geomaterial of radius $R$ and thickness $t$ is subjected to a standard Brazilian indirect tensile test with diametral line loads of total magnitude $P$ applied at the top and bottom. In addition, the disk boundary is pressurized uniformly with a confining pressure $p$ so that the material experiences a combined diametral compression and hydrostatic compression. Consider two nonlocal models within the framework of Peridynamics (PD): (i) a linear Bond-Based Peridynamics (BB-PD) formulation in which the pairwise force between material points is collinear with the bond and depends only on the bond stretch, and failure is governed by a critical bond stretch $s_c$; and (ii) an Ordinary State-Based Peridynamics (OSB-PD) formulation with a force state that depends on the dilatational (volumetric) and deviatoric (shear) parts of the deformation state, characterized by independent bulk modulus $K$ and shear modulus $G$, in which failure is assessed through a nonlocal brittle-frictional indicator combining normal and tangential tractions on planes, consistent with a Mohr–Coulomb type pressure-dependent strength envelope.\n\nAssume small strains, linear elasticity, isotropy, and that the geomaterial has a finite internal friction angle $\\phi$ and low tensile strength typical of brittle rocks. The disk and loading are perfectly axisymmetric about the vertical loading axis. The horizon radius in PD is much smaller than $R$, and the loading produces mixed-mode conditions at the disk center as $p$ increases. Using first principles of nonlocal force transmission and brittle failure under pressure-dependent strength, analyze how the confining pressure $p$ affects the crack initiation angle $\\theta$ (measured from the loading axis at the disk center) and the subsequent crack path predicted by BB-PD versus OSB-PD. Specifically, determine which of the following statements best describes the qualitative trend of $\\theta$ with increasing $p$ and the crack path morphology in each formulation.\n\nA. BB-PD predicts an axial split with crack initiation angle $\\theta \\approx 0^\\circ$ that is largely insensitive to $p$, and a straight-through path along the loading axis; OSB-PD predicts a nonzero initiation angle $\\theta>0$ that increases with $p$, with a curved, shear-dominated path that kinks off-axis and arcs toward the loading points.\n\nB. Both BB-PD and OSB-PD predict identical crack initiation angles and paths due to specimen symmetry, and confining pressure $p$ influences only the peak load without affecting crack orientation.\n\nC. BB-PD predicts an oblique initiation angle $\\theta>0$ that increases with $p$ due to enhanced shear sensitivity of the pairwise bond force, while OSB-PD predicts $\\theta \\approx 0^\\circ$ independent of $p$.\n\nD. BB-PD predicts circumferential ring cracking at $\\theta \\approx 90^\\circ$ under high $p$ due to hoop tension, whereas OSB-PD predicts persistent axial splitting along the loading axis regardless of $p$.\n\nSelect the option that is most consistent with the governing mechanics and nonlocal failure criteria of the two PD formulations under the described mixed-mode conditions.", "solution": "### Derivation and Analysis\n\nLet the vertical axis be the $y$-axis and the horizontal axis be the $x$-axis, with the origin at the disk center. The diametral load $P$ is applied along the $y$-axis.\n\n**Local Stress State at the Disk Center:**\nBased on the classical theory of elasticity for a Brazilian disk test, the stresses at the center ($x=0, y=0$) due to the line load $P$ are:\n$$ \\sigma_{xx} = \\frac{P}{\\pi R t} \\quad (\\text{tensile}) $$\n$$ \\sigma_{yy} = -\\frac{3P}{\\pi R t} \\quad (\\text{compressive}) $$\n$$ \\tau_{xy} = 0 $$\nThe uniform confining pressure $p$ superimposes a hydrostatic stress state:\n$$ \\sigma_{xx, conf} = \\sigma_{yy, conf} = -p $$\nThe total stress components at the center are:\n$$ \\sigma_{1} = \\sigma_{xx, total} = \\frac{P}{\\pi R t} - p $$\n$$ \\sigma_{2} = \\sigma_{yy, total} = -\\frac{3P}{\\pi R t} - p $$\nNote that $\\sigma_{1}$ and $\\sigma_{2}$ are the principal stresses at the center.\n\n**Analysis of the Bond-Based Peridynamics (BB-PD) Model:**\n1.  **Governing Mechanics:** BB-PD is based on a central force potential. The force between two material points is collinear with the bond connecting them and depends solely on their relative stretch, $s$. A key and well-known limitation of this formulation is that it cannot independently model the bulk and shear response of a material, which results in a fixed Poisson's ratio (e.g., $\\nu=1/4$ in 3D, $\\nu=1/3$ in 2D plane stress/strain).\n2.  **Failure Criterion:** Failure is governed by a critical bond stretch, $s_c$. A bond breaks if its stretch $s$ exceeds $s_c$. This criterion is purely extensional and is insensitive to compression or shear. Failure occurs when and where bonds are stretched the most.\n3.  **Prediction:** The strain components are related to the stresses. The strain in the horizontal direction, $\\epsilon_{xx}$, determines the stretch of horizontally-oriented bonds. At the center, the stress $\\sigma_{xx, total}$ is always algebraically greater than $\\sigma_{yy, total}$ (i.e., more tensile or less compressive). Consequently, the extensional strain will be maximal in the horizontal direction. Therefore, horizontally oriented bonds will be the first to reach the critical stretch $s_c$.\n    The breaking of horizontal bonds corresponds to a crack opening in the vertical direction and propagating along the vertical ($y$-) axis. This is a classic axial split. The initiation angle is $\\theta \\approx 0^\\circ$.\n    Increasing the confining pressure $p$ makes the entire stress state more compressive. This means a larger load $P$ is required to achieve the critical stretch $s_c$. However, the *direction* of maximum stretch remains horizontal because the stress difference $\\sigma_{xx, total} - \\sigma_{yy, total} = 4P/(\\pi R t)$ is independent of $p$. Since the failure mechanism is tied only to the maximum stretch, the failure mode (axial splitting) and initiation angle ($\\theta \\approx 0^\\circ$) will not change with $p$. The predicted crack path is a straight line along the loading diameter.\n\n**Analysis of the Ordinary State-Based Peridynamics (OSB-PD) Model:**\n1.  **Governing Mechanics:** OSB-PD is a more general formulation where the force state accounts for the collective deformation of a point's neighborhood. It can be parameterized with independent bulk modulus $K$ and shear modulus $G$, allowing it to correctly represent any Poisson's ratio and to distinguish between volumetric (dilatational) and shear (deviatoric) deformation.\n2.  **Failure Criterion:** The problem specifies a nonlocal, pressure-dependent criterion consistent with a Mohr-Coulomb strength envelope. Such a criterion for a material with cohesion $c$ and friction angle $\\phi$ takes the form $\\tau_{crit} = c - \\sigma_n \\tan\\phi$, where failure occurs if the shear stress $\\tau$ on a given plane exceeds the critical shear strength $\\tau_{crit}$, which depends on the normal stress $\\sigma_n$ on that plane (compression is negative).\n3.  **Prediction:**\n    - At low or zero confinement ($p \\approx 0$), the principal stress $\\sigma_{xx, total}$ can be tensile. Since the material has low tensile strength, failure is dominated by Mode I tensile fracture. This occurs when $\\sigma_{xx, total}$ exceeds the material's tensile strength, leading to an axial split, similar to BB-PD. Thus, for low $p$, $\\theta \\approx 0^\\circ$.\n    - As confinement $p$ increases, a point is reached where $p > P/(\\pi R t)$, and both principal stresses at the center, $\\sigma_1$ and $\\sigma_2$, become compressive. In this compressive regime, tensile failure is suppressed. Failure is now governed by the shear criterion of the Mohr-Coulomb model. Shear failure classically occurs on planes oblique to the principal stress directions.\n    - The orientation of the shear failure plane relative to the major principal stress direction ($\\sigma_1$, here along the $x$-axis) is typically $45^\\circ + \\phi/2$. The crack initiation angle $\\theta$ is measured from the loading axis ($y$-axis), which is the direction of the minor principal stress $\\sigma_2$. The angle of the shear plane with respect to the $\\sigma_2$ direction is $90^\\circ - (45^\\circ + \\phi/2) = 45^\\circ - \\phi/2$. Since $\\phi > 0$ for a geomaterial, the initiation angle $\\theta$ will be non-zero and positive ($\\theta = 45^\\circ - \\phi/2 > 0$).\n    - The transition from tensile to shear failure as $p$ increases means that OSB-PD predicts a change in failure mode and initiation angle. The crack path resulting from shear failure under a compressive stress field is typically not straight; it initiates at an oblique angle and tends to curve, often arcing towards the loading points as it propagates through the complex stress field away from the center. The statement that $\\theta$ *increases* with $p$ is a plausible consequence of the complex interaction between the evolving stress field and the nonlocal failure criterion, where higher confinement pushes the failure mechanism deeper into the shear-dominated regime.\n\n### Option-by-Option Analysis\n\n**A. BB-PD predicts an axial split with crack initiation angle $\\theta \\approx 0^\\circ$ that is largely insensitive to $p$, and a straight-through path along the loading axis; OSB-PD predicts a nonzero initiation angle $\\theta>0$ that increases with $p$, with a curved, shear-dominated path that kinks off-axis and arcs toward the loading points.**\n- This statement accurately describes the predicted behavior for both models based on their fundamental mechanics. The BB-PD prediction correctly identifies its insensitivity to pressure-dependent shear failure, always defaulting to tensile (stretch-based) splitting. The OSB-PD prediction correctly identifies its ability to capture the transition to pressure-dependent shear failure, resulting in an oblique, curved fracture path under confinement.\n- **Verdict: Correct**\n\n**B. Both BB-PD and OSB-PD predict identical crack initiation angles and paths due to specimen symmetry, and confining pressure $p$ influences only the peak load without affecting crack orientation.**\n- This statement is incorrect. The central thesis of the problem is to contrast the two models, which have fundamentally different constitutive laws and failure criteria. OSB-PD is explicitly designed to overcome the limitations of BB-PD, particularly in capturing pressure-dependent shear failure. They will not predict identical paths under varying confinement.\n- **Verdict: Incorrect**\n\n**C. BB-PD predicts an oblique initiation angle $\\theta>0$ that increases with $p$ due to enhanced shear sensitivity of the pairwise bond force, while OSB-PD predicts $\\theta \\approx 0^\\circ$ independent of $p$.**\n- This statement inverts the capabilities of the two models. BB-PD is not sensitive to shear in its failure criterion, and its central forces have limited ability to model shear resistance correctly. It would predict $\\theta \\approx 0^\\circ$. OSB-PD, with its Mohr-Coulomb criterion, is specifically designed to be pressure-sensitive and predict shear failure, leading to $\\theta > 0$ under confinement.\n- **Verdict: Incorrect**\n\n**D. BB-PD predicts circumferential ring cracking at $\\theta \\approx 90^\\circ$ under high $p$ due to hoop tension, whereas OSB-PD predicts persistent axial splitting along the loading axis regardless of $p$.**\n- This statement is incorrect. For BB-PD, ring cracking ($\\theta \\approx 90^\\circ$) would imply failure of the most compressed bonds, which is impossible for a stretch-based criterion. It also gets the OSB-PD behavior wrong; it's the BB-PD model that predicts persistent axial splitting.\n- **Verdict: Incorrect**", "answer": "$$\\boxed{A}$$", "id": "3549657"}, {"introduction": "This final practice moves from theoretical derivations and conceptual comparisons to the practical, data-driven world of model calibration and validation. You will implement a complete Bayesian inverse analysis to identify the key parameters of a peridynamic model—micromodulus $c$, critical stretch $s_c$, and horizon $\\delta$—using synthetic experimental data from a notched bar test [@problem_id:3549656]. This comprehensive exercise represents a true hands-on challenge, integrating the construction of a forward model with damage, the formulation of a statistical inverse problem, and the quantification of parameter uncertainty, mirroring the advanced workflows used in modern computational science.", "problem": "You are to implement a complete, runnable program that performs Bayesian inverse identification of the peridynamic parameters micro-modulus, critical stretch, and horizon using synthetic Digital Image Correlation (DIC) displacement data from a one-dimensional notched bar test, with parameter identifiability quantified. The forward model is a static, bond-based micro-elastic peridynamic model in one spatial dimension with an internal notch, subject to a known terminal traction. Use a discretized formulation that is self-consistent and sufficiently accurate for the purpose of inference. All computations are to be carried out in a non-dimensionalized setting, so no physical units are required in the output.\n\nStart from first principles, specifically: (i) Newton’s second law of motion, which in the static limit reduces to the balance of internal and external forces, and (ii) the definition of bond-based micro-elastic peridynamics where material points interact via pairwise forces within a finite horizon. For a uniform grid on a one-dimensional domain of length $L$, consider $N$ nodes at positions $x_i = i\\,\\Delta x$ for $i \\in \\{0,\\dots,N-1\\}$ with $\\Delta x = L/(N-1)$, displacement field $u_i = u(x_i)$, micro-modulus parameter $c>0$, critical stretch $s_c>0$, and horizon $\\delta>0$. Assume a smooth, non-increasing pairwise influence function $w(r,\\delta)$ depending on distance $r$ and horizon $\\delta$, and use a linear micro-elastic pairwise force law. Take the static equilibrium equation on node $i$ as the sum of pairwise internal forces plus external forces equal to zero for all free nodes. Model a notch located at $x_n = L/2$ by reducing the stiffness of every bond whose endpoints lie on opposite sides of $x_n$ by a factor $\\alpha \\in (0,1)$, and model brittle damage by irreversibly removing any bond whose stretch, defined as the absolute displacement difference divided by its rest length, exceeds the critical stretch $s_c$.\n\nYou must implement the following discrete ingredients without using any pre-provided formula for the final answer:\n- Discretize the pairwise internal force contributions into a symmetric stiffness matrix $K(c,\\delta,\\text{bonds})$ assembled by summing the stiffness contributions of all active bonds. Use a smooth influence function of the form $w(r,\\delta) = \\max\\{0, 1 - r/\\delta\\}$ and include a uniform volume weight factor proportional to $\\Delta x$ for each bond contribution. Introduce the notch by scaling the stiffness of bonds that cross $x_n$ by factor $\\alpha$.\n- Enforce a Dirichlet boundary condition $u_0 = 0$ at $x_0 = 0$ and apply a known external terminal traction $T$ at $x_{N-1}=L$, represented as a concentrated nodal force on node $N-1$. Every other node is traction-free.\n- For damage, iterate the following until no new bonds are removed or a maximum number of iterations is reached: solve the linear system for $u$, compute bond stretches, remove bonds whose stretch exceeds $s_c$, and reassemble.\n- Generate synthetic DIC observations $\\mathbf{y}$ by evaluating the resulting displacement field on a specified subset of nodes and adding independent, zero-mean Gaussian noise with a given standard deviation.\n\nFormulate the Bayesian inverse problem for parameters $\\boldsymbol{\\theta} = [c, s_c, \\delta]^T$ as follows. Assume a Gaussian likelihood with known noise standard deviation $\\sigma$, and independent Gaussian priors on suitable, differentiable transformations of the parameters that respect their positivity and boundedness. Specifically, let $p_1 = \\log c$, $p_2 = \\mathrm{logit}\\!\\left(\\dfrac{s_c - s_{\\min}}{s_{\\max} - s_{\\min}}\\right)$ and $p_3 = \\mathrm{logit}\\!\\left(\\dfrac{\\delta - \\delta_{\\min}}{\\delta_{\\max} - \\delta_{\\min}}\\right)$, where $\\mathrm{logit}(z) = \\log\\!\\left(\\dfrac{z}{1-z}\\right)$ for $z \\in (0,1)$. Let the prior on $\\mathbf{p} = [p_1,p_2,p_3]^T$ be Gaussian with mean $\\boldsymbol{\\mu}$ and covariance $\\Sigma_p$. Compute the maximum a posteriori (MAP) estimate $\\widehat{\\mathbf{p}}$ by minimizing the negative log posterior composed of the least-squares data fidelity term and the quadratic prior term, using a Gauss-Newton or Levenberg-Marquardt type algorithm with numerical Jacobians obtained by finite differences in $\\mathbf{p}$. Transform back to obtain $\\widehat{\\boldsymbol{\\theta}}$ from $\\widehat{\\mathbf{p}}$. Quantify identifiability using:\n- The Fisher Information Matrix (FIM) approximation $F = J^T W J + \\Sigma_p^{-1}$ at $\\widehat{\\mathbf{p}}$, where $J$ is the Jacobian of the predicted observations with respect to $\\mathbf{p}$ and $W = \\sigma^{-2} I$.\n- Posterior covariance in $\\mathbf{p}$ given by $C_p = F^{-1}$ and its propagation to the original parameters using the Jacobian of the inverse transform at $\\widehat{\\mathbf{p}}$, leading to $C_\\theta$. Report the marginal posterior standard deviations as the square roots of the diagonal of $C_\\theta$.\n- A scalar condition number of $F$ defined as the ratio of its largest to smallest eigenvalues, regularized if necessary.\n- A coefficient of variation for each parameter, defined as the ratio of its posterior standard deviation to its MAP value.\n\nUse a fixed synthetic forward model and test suite as follows:\n- Geometry and discretization: $L = 1$, $N = 41$, $\\Delta x = 1/(N-1)$, notch location $x_n = 0.5$, notch weakening factor $\\alpha = 0.3$.\n- Influence function: $w(r,\\delta) = \\max\\{0,1-r/\\delta\\}$.\n- Bond set: include all pairs $(i,j)$ with $i<j$ and $r_{ij} = |x_j - x_i| \\le \\delta_{\\max}$, where $\\delta_{\\max} = 0.35$; bonds with $r_{ij} > \\delta$ contribute zero due to the influence function; bonds crossing the notch are scaled by $\\alpha$.\n- Damage update: remove bonds permanently if the bond stretch $s_{ij} = |u_j - u_i|/r_{ij}$ exceeds $s_c$.\n- Observation model: select observations every $k$ nodes starting from node index $1$ (exclude the fixed node at $0$), with stride $k$ specified per case.\n\nSynthetic ground truth and priors:\n- Parameter bounds: $s_{\\min} = 0.001$, $s_{\\max} = 0.02$, $\\delta_{\\min} = 0.08$, $\\delta_{\\max} = 0.30$.\n- True parameters for data generation: $c^\\star = 500.0$, $s_c^\\star = 0.0020$, $\\delta^\\star = 0.15$.\n- Prior on transformed parameters $\\mathbf{p}$: Gaussian with mean components $\\mu_1 = \\log 300.0$, $\\mu_2 = \\mathrm{logit}\\!\\left(\\dfrac{0.006 - s_{\\min}}{s_{\\max} - s_{\\min}}\\right)$, $\\mu_3 = \\mathrm{logit}\\!\\left(\\dfrac{0.18 - \\delta_{\\min}}{\\delta_{\\max} - \\delta_{\\min}}\\right)$ and diagonal covariance with standard deviations $\\sigma_{p_1} = 1.0$, $\\sigma_{p_2} = 0.75$, $\\sigma_{p_3} = 0.75$.\n\nProvide three test cases to probe identifiability under different conditions:\n- Case A (well-conditioned): terminal traction $T = 20.0$, observation noise standard deviation $\\sigma = 1.0\\times 10^{-4}$, observation stride $k = 1$.\n- Case B (noisier and sparser): terminal traction $T = 20.0$, observation noise standard deviation $\\sigma = 5.0\\times 10^{-4}$, observation stride $k = 4$.\n- Case C (low excitation, limited damage): terminal traction $T = 1.0$, observation noise standard deviation $\\sigma = 5.0\\times 10^{-4}$, observation stride $k = 2$.\n\nYour program must:\n- Generate synthetic DIC data $\\mathbf{y}$ for each case using the true parameters and the forward model, including the damage iteration.\n- Solve the Bayesian inverse problem to obtain $\\widehat{\\boldsymbol{\\theta}} = [\\widehat{c}, \\widehat{s_c}, \\widehat{\\delta}]^T$ for each case.\n- Compute the FIM condition number $\\kappa(F)$, and the coefficients of variation $\\mathrm{CV}_c$, $\\mathrm{CV}_{s_c}$, $\\mathrm{CV}_\\delta$ using posterior variances propagated to the original parameter space.\n- Aggregate results for all cases into a single line printed output formatted as a Python-like list of lists:\n  \"[[c_hat,s_c_hat,delta_hat,condFIM,CV_c,CV_s,CV_delta],[...caseB...],[...caseC...]]\"\nwhere each entry is a real number. All outputs are non-dimensional.\n\nTest suite definition to be hard-coded in the program:\n- Domain length $L = 1$, number of nodes $N = 41$, notch weakening $\\alpha = 0.3$, true parameters $[c^\\star, s_c^\\star, \\delta^\\star] = [500.0, 0.0020, 0.15]$, bounds $s_{\\min} = 0.001$, $s_{\\max} = 0.02$, $\\delta_{\\min} = 0.08$, $\\delta_{\\max} = 0.30$, prior mean and standard deviations as above, maximum damage iterations $I_{\\max} = 20$, finite difference step for transformed parameters $h = 0.01$, damping parameter initial value $\\lambda_0 = 1.0$ with multiplicative adjustment by factor $2.0$ as needed.\n\nYour program should produce a single line of output containing the results as a comma-separated list of three bracketed lists corresponding to the three test cases, for example:\n\"[[c_A,s_A,delta_A,condFIM_A,CV_c_A,CV_s_A,CV_delta_A],[c_B,s_B,delta_B,condFIM_B,CV_c_B,CV_s_B,CV_delta_B],[c_C,s_C,delta_C,condFIM_C,CV_c_C,CV_s_C,CV_delta_C]]\"", "solution": "The solution is implemented by developing a complete computational framework comprising a peridynamic forward model, a Bayesian inference scheme, and a method for quantifying parameter identifiability. The process is detailed in the following steps.\n\n### 1. Peridynamic Forward Model\n\nThe forward model simulates the mechanical response of a one-dimensional notched bar under a static tensile load.\n\n**Discretization and Equilibrium:**\nThe bar of length $L$ is discretized into $N$ material points (nodes) at positions $x_i = i \\cdot \\Delta x$ for $i \\in \\{0, \\dots, N-1\\}$, with uniform spacing $\\Delta x = L/(N-1)$. The displacement of node $i$ is denoted by $u_i$. In a static configuration, the net force on each node must be zero. For any free node $i$, the balance of forces is expressed as:\n$$\n\\mathbf{f}_{\\text{int},i} + \\mathbf{f}_{\\text{ext},i} = 0\n$$\nwhere $\\mathbf{f}_{\\text{int},i}$ is the total internal force exerted on node $i$ by all other nodes, and $\\mathbf{f}_{\\text{ext},i}$ is the external force applied at node $i$.\n\n**Internal Forces and Stiffness Matrix:**\nThe internal force is the sum of pairwise interactions between material points within a finite neighborhood called the horizon, $\\delta$. For a bond-based, linear micro-elastic material, the force between nodes $i$ and $j$ is proportional to the bond stretch, $s_{ij}$. The problem is formulated using a stiffness matrix approach, where the system of equilibrium equations is written as $K\\mathbf{u} = \\mathbf{f}_{\\text{ext}}$. The stiffness matrix $K$ is assembled from individual bond stiffness contributions.\n\nThe stiffness of a single bond between nodes $i$ and $j$ at a rest distance of $r_{ij} = |x_j - x_i|$ is defined as:\n$$\nk_{ij} = c \\cdot \\frac{w(r_{ij}, \\delta)}{r_{ij}} \\cdot \\alpha_{ij} \\cdot \\mu_{ij} \\cdot \\Delta x\n$$\nHere, $c$ is the micro-modulus, $w(r_{ij}, \\delta) = \\max\\{0, 1 - r_{ij}/\\delta\\}$ is the influence function, $\\alpha_{ij}$ is the notch weakening factor ($0 < \\alpha < 1$ if the bond crosses the notch at $x_n=L/2$, and $1$ otherwise), $\\mu_{ij}$ is a damage variable ($1$ for an intact bond, $0$ for a broken one), and $\\Delta x$ serves as the one-dimensional nodal volume. Note that a bond contributes to stiffness only if its length $r_{ij}$ is within the horizon $\\delta$.\n\nThe global stiffness matrix $K$ for the system of free nodes (nodes $1, \\dots, N-1$, since $u_0=0$) is assembled by summing these contributions. For a bond connecting two free nodes $i$ and $j$, its stiffness $k_{ij}$ is added to the diagonal entries $K_{i-1, i-1}$ and $K_{j-1, j-1}$, and subtracted from the off-diagonal entries $K_{i-1, j-1}$ and $K_{j-1, i-1}$. For a bond connecting the fixed node $0$ to a free node $j$, $k_{0j}$ is added only to the diagonal entry $K_{j-1, j-1}$.\n\n**Boundary Conditions and External Load:**\nA Dirichlet boundary condition is enforced at one end ($u_0 = 0$), and a Neumann boundary condition is applied at the other end in the form of a concentrated force $T$ on node $N-1$. Thus, the external force vector $\\mathbf{f}_{\\text{ext}}$ has only one non-zero component, at the index corresponding to node $N-1$.\n\n**Damage Evolution:**\nBrittle failure is modeled by irreversibly breaking bonds. The stretch of a bond $(i,j)$ is $s_{ij} = |u_j - u_i|/r_{ij}$. After solving for the displacement field $\\mathbf{u}$, any bond whose stretch $s_{ij}$ exceeds the critical stretch threshold $s_c$ is considered broken ($\\mu_{ij}$ is set to $0$). Since breaking a bond redistributes forces and may cause further failures, this process is iterated:\n1. Assemble the stiffness matrix $K$ based on the current set of intact bonds.\n2. Solve the linear system $K\\mathbf{u} = \\mathbf{f}_{\\text{ext}}$ for the displacement field $\\mathbf{u}$.\n3. Calculate all bond stretches and identify any new bonds for which $s_{ij} > s_c$.\n4. Update the set of intact bonds by removing the newly failed ones.\n5. Repeat from step 1 until no new bonds fail in an iteration, or a maximum number of iterations is reached.\n\nThis iterative procedure defines the complete forward model, a non-linear function $G(\\boldsymbol{\\theta})$ that maps the parameter vector $\\boldsymbol{\\theta} = [c, s_c, \\delta]^T$ to the final displacement field $\\mathbf{u}$.\n\n### 2. Bayesian Inverse Problem\n\nThe goal is to infer the parameters $\\boldsymbol{\\theta}$ from noisy displacement measurements $\\mathbf{y}$.\n\n**Likelihood and Prior:**\nThe observations are modeled as $\\mathbf{y} = G_{\\text{obs}}(\\boldsymbol{\\theta}) + \\boldsymbol{\\epsilon}$, where $G_{\\text{obs}}(\\boldsymbol{\\theta})$ are the model-predicted displacements at a subset of nodes, and $\\boldsymbol{\\epsilon}$ is zero-mean Gaussian noise with known standard deviation $\\sigma$, i.e., $\\boldsymbol{\\epsilon} \\sim \\mathcal{N}(0, \\sigma^2 I)$. The likelihood of observing the data $\\mathbf{y}$ given parameters $\\boldsymbol{\\theta}$ is:\n$$\np(\\mathbf{y}|\\boldsymbol{\\theta}) \\propto \\exp\\left(-\\frac{1}{2\\sigma^2} \\|\\mathbf{y} - G_{\\text{obs}}(\\boldsymbol{\\theta})\\|_2^2\\right)\n$$\nTo ensure positivity and handle bounds, the parameters are transformed: $p_1 = \\log c$, $p_2 = \\mathrm{logit}((s_c - s_{\\min})/(s_{\\max} - s_{\\min}))$, and $p_3 = \\mathrm{logit}((\\delta - \\delta_{\\min})/(\\delta_{\\max} - \\delta_{\\min}))$. The prior knowledge is specified as a multivariate Gaussian distribution on the transformed parameter vector $\\mathbf{p} = [p_1, p_2, p_3]^T$:\n$$\np(\\mathbf{p}) \\propto \\exp\\left(-\\frac{1}{2} (\\mathbf{p} - \\boldsymbol{\\mu})^T \\Sigma_p^{-1} (\\mathbf{p} - \\boldsymbol{\\mu})\\right)\n$$\nwhere $\\boldsymbol{\\mu}$ and $\\Sigma_p$ are the prior mean and covariance matrix.\n\n**Maximum a Posteriori (MAP) Estimation:**\nAccording to Bayes' theorem, the posterior distribution is $p(\\mathbf{p}|\\mathbf{y}) \\propto p(\\mathbf{y}|\\mathbf{p}) p(\\mathbf{p})$. The MAP estimate, $\\widehat{\\mathbf{p}}$, is found by maximizing this posterior, which is equivalent to minimizing its negative logarithm:\n$$\nJ(\\mathbf{p}) = \\frac{1}{2\\sigma^2} \\|\\mathbf{y} - G_{\\text{obs}}(\\boldsymbol{\\theta}(\\mathbf{p}))\\|_2^2 + \\frac{1}{2} (\\mathbf{p} - \\boldsymbol{\\mu})^T \\Sigma_p^{-1} (\\mathbf{p} - \\boldsymbol{\\mu})\n$$\nThis is a non-linear least squares problem, which is solved using a Levenberg-Marquardt algorithm. This iterative method requires the gradient of the objective function, $\\nabla J(\\mathbf{p})$, and an approximation to its Hessian. The update step $\\Delta\\mathbf{p}$ is found by solving:\n$$\n(J_{pred}^T W J_{pred} + \\Sigma_p^{-1} + \\lambda I) \\Delta\\mathbf{p} = -( -J_{pred}^T W \\mathbf{r} + \\Sigma_p^{-1}(\\mathbf{p}-\\boldsymbol{\\mu}))\n$$\nwhere $\\mathbf{r} = \\mathbf{y} - G_{\\text{obs}}$ is the residual, $J_{pred}$ is the Jacobian of the forward model predictions with respect to $\\mathbf{p}$ (computed via finite differences), $W=\\sigma^{-2}I$ is the data weighting matrix, and $\\lambda$ is a damping parameter that is adjusted at each iteration.\n\n### 3. Identifiability Analysis\n\nIdentifiability is quantified using the posterior distribution of the parameters, approximated as a Gaussian centered at the MAP estimate.\n\n**Fisher Information Matrix (FIM):**\nThe curvature of the negative log-posterior at the MAP estimate is given by the Hessian, which is approximated by the Fisher Information Matrix:\n$$\nF = J_{pred}(\\widehat{\\mathbf{p}})^T W J_{pred}(\\widehat{\\mathbf{p}}) + \\Sigma_p^{-1}\n$$\nThe condition number of the FIM, $\\kappa(F) = \\lambda_{\\max}/\\lambda_{\\min}$, measures the disparity in sensitivity of the posterior to different directions in parameter space. A large condition number suggests poor identifiability.\n\n**Posterior Covariance and Uncertainty Propagation:**\nThe posterior covariance matrix for the transformed parameters $\\mathbf{p}$ is approximated by the inverse of the FIM: $C_p = F^{-1}$. To find the uncertainty in the original parameters $\\boldsymbol{\\theta}$, this covariance is propagated through the inverse transformation $\\boldsymbol{\\theta} = T(\\mathbf{p})$ using a first-order approximation:\n$$\nC_\\theta \\approx J_T C_p J_T^T\n$$\nwhere $J_T$ is the Jacobian of the transformation $T(\\cdot)$ evaluated at $\\widehat{\\mathbf{p}}$. The diagonal elements of $C_\\theta$ provide the marginal posterior variances for each parameter in $\\boldsymbol{\\theta}$.\n\n**Coefficient of Variation (CV):**\nThe marginal posterior standard deviation for each parameter $\\theta_i$ is $\\sigma_{\\theta_i} = \\sqrt{(C_{\\theta})_{ii}}$. The coefficient of variation, $\\mathrm{CV}_i = \\sigma_{\\theta_i} / |\\widehat{\\theta}_i|$, provides a normalized, relative measure of uncertainty for each parameter estimate.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import logit, expit as logistic\n\ndef solve():\n    \"\"\"\n    Performs Bayesian inverse identification of peridynamic parameters\n    for a 1D notched bar test.\n    \"\"\"\n    #\n    # --- 1. Problem Definition and Constants ---\n    #\n    L = 1.0\n    N = 41\n    ALPHA = 0.3\n    TRUE_PARAMS = np.array([500.0, 0.0020, 0.15]) # c*, s_c*, delta*\n\n    # Parameter bounds\n    S_MIN, S_MAX = 0.001, 0.02\n    DELTA_MIN, DELTA_MAX = 0.08, 0.30\n    DELTA_HORIZON_MAX = 0.35 # Max horizon for pre-computing bonds\n\n    # Prior information\n    PRIOR_MEAN_THETA = np.array([300.0, 0.006, 0.18])\n    PRIOR_STD_P = np.array([1.0, 0.75, 0.75])\n\n    # Numerical settings\n    MAX_DAMAGE_ITER = 20\n    FD_STEP_H = 0.01\n    LM_LAMBDA_0 = 1.0\n    LM_LAMBDA_FACTOR = 2.0\n    LM_MAX_ITER = 15\n    LM_TOL = 1e-6\n\n    # Test case definitions\n    TEST_CASES = [\n        # T, sigma_noise, k_obs_stride\n        (20.0, 1.0e-4, 1), # Case A\n        (20.0, 5.0e-4, 4), # Case B\n        (1.0, 5.0e-4, 2)   # Case C\n    ]\n\n    # Derived constants\n    X_NODES = np.linspace(0, L, N)\n    DX = L / (N - 1)\n    NOTCH_X = L / 2\n    FREE_DOFS = N - 1\n    OBS_NODES_INDICES_BASE = np.arange(1, N)\n\n    np.random.seed(0) # for reproducible synthetic data\n\n    #\n    # --- 2. Helper Functions ---\n    #\n    def transform_params(theta):\n        c, s_c, delta = theta\n        p1 = np.log(c)\n        p2 = logit(np.clip((s_c - S_MIN) / (S_MAX - S_MIN), 1e-9, 1 - 1e-9))\n        p3 = logit(np.clip((delta - DELTA_MIN) / (DELTA_MAX - DELTA_MIN), 1e-9, 1 - 1e-9))\n        return np.array([p1, p2, p3])\n\n    def inv_transform_params(p):\n        p1, p2, p3 = p\n        c = np.exp(p1)\n        s_c = S_MIN + (S_MAX - S_MIN) * logistic(p2)\n        delta = DELTA_MIN + (DELTA_MAX - DELTA_MIN) * logistic(p3)\n        return np.array([c, s_c, delta])\n\n    PRIOR_MEAN_P = transform_params(PRIOR_MEAN_THETA)\n    PRIOR_COV_P_INV = np.diag(1 / (PRIOR_STD_P**2))\n\n    # Pre-calculate bond list for efficiency\n    BONDS = []\n    for i in range(N):\n        for j in range(i + 1, N):\n            r_ij = X_NODES[j] - X_NODES[i]\n            if r_ij = DELTA_HORIZON_MAX:\n                crosses_notch = (X_NODES[i]  NOTCH_X) and (X_NODES[j] > NOTCH_X)\n                alpha_ij = ALPHA if crosses_notch else 1.0\n                BONDS.append({'i': i, 'j': j, 'r_ij': r_ij, 'alpha_ij': alpha_ij})\n\n    #\n    # --- 3. Forward Model Implementation ---\n    #\n    def forward_model(p_in, T, obs_indices):\n        theta = inv_transform_params(p_in)\n        c, s_c, delta = theta\n\n        bond_broken = np.zeros(len(BONDS), dtype=bool)\n        u = np.zeros(N)\n\n        for _ in range(MAX_DAMAGE_ITER):\n            K = np.zeros((FREE_DOFS, FREE_DOFS))\n            \n            for bond_idx, bond in enumerate(BONDS):\n                if bond_broken[bond_idx]: continue\n                \n                i, j, r_ij, alpha_ij = bond['i'], bond['j'], bond['r_ij'], bond['alpha_ij']\n                \n                if r_ij > delta: continue\n\n                w_ij = 1.0 - r_ij / delta\n                k_ij = c * (w_ij / r_ij) * alpha_ij * DX\n\n                if i == 0:\n                    K[j - 1, j - 1] += k_ij\n                else:\n                    K[i - 1, i - 1] += k_ij\n                    K[j - 1, j - 1] += k_ij\n                    K[i - 1, j - 1] -= k_ij\n                    K[j - 1, i - 1] -= k_ij\n            \n            F_ext = np.zeros(FREE_DOFS)\n            F_ext[-1] = T\n            \n            try:\n                # Use a small regularization to prevent singular matrix for heavily damaged states\n                u_free = np.linalg.solve(K + np.eye(FREE_DOFS)*1e-9, F_ext)\n                u[1:] = u_free\n            except np.linalg.LinAlgError:\n                return np.full(len(obs_indices), 1e9) # Return large error signal\n                \n            newly_broken_count = 0\n            for bond_idx, bond in enumerate(BONDS):\n                if bond_broken[bond_idx]: continue\n                \n                i, j, r_ij = bond['i'], bond['j'], bond['r_ij']\n                stretch = np.abs(u[j] - u[i]) / r_ij\n                \n                if stretch > s_c:\n                    bond_broken[bond_idx] = True\n                    newly_broken_count += 1\n            \n            if newly_broken_count == 0: break\n                \n        return u[obs_indices]\n\n    #\n    # --- 4. Main Loop for Test Cases ---\n    #\n    final_results = []\n    for T, sigma_noise, k_obs_stride in TEST_CASES:\n        \n        # --- 4a. Generate Synthetic Data ---\n        obs_indices = OBS_NODES_INDICES_BASE[::k_obs_stride]\n        u_true = forward_model(transform_params(TRUE_PARAMS), T, obs_indices)\n        noise = np.random.normal(0, sigma_noise, size=u_true.shape)\n        y_obs = u_true + noise\n        \n        # --- 4b. Solve Inverse Problem (Levenberg-Marquardt) ---\n        p_current = np.copy(PRIOR_MEAN_P)\n        lm_lambda = LM_LAMBDA_0\n\n        def model_predictions(p):\n            return forward_model(p, T, obs_indices)\n\n        for _ in range(LM_MAX_ITER):\n            pred = model_predictions(p_current)\n            if np.any(np.abs(pred) > 1e8): # Check for divergence\n                lm_lambda = min(lm_lambda * LM_LAMBDA_FACTOR, 1e8)\n                p_current = p_current * 0.5 + PRIOR_MEAN_P * 0.5 # Move back toward prior\n                continue\n\n            residual = y_obs - pred\n            cost = 0.5 * np.sum(residual**2) / sigma_noise**2 + \\\n                   0.5 * (p_current - PRIOR_MEAN_P).T @ PRIOR_COV_P_INV @ (p_current - PRIOR_MEAN_P)\n\n            J_pred = np.zeros((len(y_obs), len(p_current)))\n            for j in range(len(p_current)):\n                p_pert = p_current.copy()\n                p_pert[j] += FD_STEP_H\n                J_pred[:, j] = (model_predictions(p_pert) - pred) / FD_STEP_H\n\n            W = np.eye(len(y_obs)) / sigma_noise**2\n            grad = -J_pred.T @ W @ residual + PRIOR_COV_P_INV @ (p_current - PRIOR_MEAN_P)\n            F_lm = J_pred.T @ W @ J_pred + PRIOR_COV_P_INV\n\n            try:\n                dp = np.linalg.solve(F_lm + lm_lambda * np.eye(len(p_current)), -grad)\n            except np.linalg.LinAlgError:\n                lm_lambda *= LM_LAMBDA_FACTOR\n                continue\n\n            p_trial = p_current + dp\n            pred_trial = model_predictions(p_trial)\n\n            if np.any(np.abs(pred_trial) > 1e8): cost_trial = np.inf\n            else:\n                cost_trial = 0.5 * np.sum((y_obs - pred_trial)**2) / sigma_noise**2 + \\\n                            0.5 * (p_trial - PRIOR_MEAN_P).T @ PRIOR_COV_P_INV @ (p_trial - PRIOR_MEAN_P)\n\n            if cost_trial  cost:\n                p_current = p_trial\n                lm_lambda /= LM_LAMBDA_FACTOR\n            else:\n                lm_lambda *= LM_LAMBDA_FACTOR\n\n            if np.linalg.norm(dp)  LM_TOL: break\n        \n        p_hat = p_current\n        theta_hat = inv_transform_params(p_hat)\n\n        # --- 4c. Identifiability Analysis ---\n        pred_hat = model_predictions(p_hat)\n        J_pred_hat = np.array([ (model_predictions(p_hat + FD_STEP_H * e_j) - pred_hat) / FD_STEP_H \n                                for e_j in np.eye(len(p_hat)) ]).T\n\n        W = np.eye(len(y_obs)) / sigma_noise**2\n        FIM = J_pred_hat.T @ W @ J_pred_hat + PRIOR_COV_P_INV\n\n        cond_FIM = np.linalg.cond(FIM)\n        C_p = np.linalg.inv(FIM)\n        \n        # Propagate uncertainty to theta-space\n        c_hat, s_c_hat, delta_hat = theta_hat\n        J_T = np.zeros((3, 3))\n        J_T[0, 0] = c_hat\n        z_s = (s_c_hat - S_MIN) / (S_MAX - S_MIN)\n        J_T[1, 1] = (S_MAX - S_MIN) * z_s * (1 - z_s) if 0  z_s  1 else 1e-9\n        z_delta = (delta_hat - DELTA_MIN) / (DELTA_MAX - DELTA_MIN)\n        J_T[2, 2] = (DELTA_MAX - DELTA_MIN) * z_delta * (1 - z_delta) if 0  z_delta  1 else 1e-9\n        \n        C_theta = J_T @ C_p @ J_T.T\n        \n        std_dev_theta = np.sqrt(np.maximum(0, np.diag(C_theta)))\n        cv_theta = std_dev_theta / np.abs(theta_hat)\n        \n        case_results = [theta_hat[0], theta_hat[1], theta_hat[2],\n                        cond_FIM, cv_theta[0], cv_theta[1], cv_theta[2]]\n        final_results.append(case_results)\n\n    # --- 5. Format and Print Final Output ---\n    result_str = \"[\" + \",\".join([\n        \"[\" + \",\".join(f\"{v:.6f}\" for v in r) + \"]\" for r in final_results\n    ]) + \"]\"\n    print(result_str)\n\nsolve()\n```", "id": "3549656"}]}