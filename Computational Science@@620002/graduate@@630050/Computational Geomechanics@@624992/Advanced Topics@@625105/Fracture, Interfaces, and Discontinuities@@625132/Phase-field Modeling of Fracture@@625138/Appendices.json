{"hands_on_practices": [{"introduction": "To begin our hands-on exploration, we will derive the fundamental profile of a crack within the phase-field framework. This exercise will strip the problem down to its essence, focusing on the one-dimensional stationary crack governed by the Ambrosio–Tortorelli (AT2) model. By applying the calculus of variations to the crack energy functional, you will derive the analytical expression for the phase-field variable $d(x)$ and build a concrete intuition for how the internal length scale parameter $\\ell$ regularizes the sharp discontinuity into a smooth field [@problem_id:3550312].", "problem": "Consider a one-dimensional, infinitely long elastic bar containing a straight crack centered at $x=0$. In the Ambrosio–Tortorelli (AT) regularization of fracture (AT2 model), the crack is represented by a scalar phase-field variable $d(x) \\in [0,1]$, where $d=1$ denotes fully broken material and $d=0$ denotes intact material. Let the critical energy release rate be $G_c>0$ and the internal length scale be $\\ell>0$. In the absence of mechanical loading, the stationary crack profile $d(x)$ across a straight crack is obtained by minimizing the regularized crack surface energy functional\n$$\n\\Psi[d] \\;=\\; \\int_{-\\infty}^{\\infty} G_c \\left( \\frac{d(x)^{2}}{2\\,\\ell} \\;+\\; \\frac{\\ell}{2}\\,\\big(d'(x)\\big)^{2} \\right)\\,\\mathrm{d}x,\n$$\nsubject to $d(0)=1$ and $d(x)\\to 0$ as $|x|\\to\\infty$. Starting from first principles in the calculus of variations and the above energy functional, derive the stationary optimal profile $d(x)$ across the crack. Then, define the diffuse crack’s characteristic width as the full width at half maximum (FWHM) of $d(x)$, namely the distance between the two points where $d(x)$ attains the value $1/2$, and compute this width in terms of $\\ell$. Express the final width in meters. Provide your final answer as closed-form analytic expressions. No numerical rounding is required.", "solution": "The problem is subjected to a critical review based on the established validation criteria.\n\n-   **Scientific Groundedness**: The problem is based on the Ambrosio-Tortorelli phase-field model of fracture, a well-established and scientifically sound framework in computational solid mechanics and geomechanics. The functional $\\Psi[d]$ is the standard form for the AT2 model. The problem is firmly rooted in the principles of continuum mechanics and the calculus of variations.\n-   **Well-Posedness**: The problem is well-posed. It asks for the minimizer of a convex functional subject to well-defined boundary conditions. Such a problem is known to have a unique and stable solution.\n-   **Objectivity**: The problem is stated in precise, objective mathematical language, free from any subjective or ambiguous terminology.\n-   **Completeness and Consistency**: The problem provides all necessary information (the functional, boundary conditions, and definitions) to derive the required quantities. There are no internal contradictions.\n-   **Realism and Feasibility**: While an idealized one-dimensional model, it represents a standard and meaningful simplification used to understand the fundamental properties of phase-field fracture models. The parameters $G_c$ and $\\ell$ are defined as positive, which is physically correct. The request to \"express the final width in meters\" is interpreted to mean that the resulting symbolic expression for width has dimensions of length and would be calculated in meters if $\\ell$ were given in meters. This does not invalidate the problem.\n\nNo flaws listed in the problem validation checklist are present. The problem is **valid**. A full solution will be provided.\n\nThe stationary profile $d(x)$ is the function that minimizes the energy functional $\\Psi[d]$. This is a classic problem in the calculus of variations. The minimizer must satisfy the Euler-Lagrange equation.\nThe integrand of the functional is the Lagrangian, $L(d, d')$, where $d' = \\frac{\\mathrm{d}d}{\\mathrm{d}x}$.\n$$\nL(x, d, d') = G_c \\left( \\frac{d^{2}}{2\\ell} + \\frac{\\ell}{2}(d')^{2} \\right)\n$$\nSince the Lagrangian does not depend explicitly on $x$, this is a conservative system for which the Beltrami identity could be used. However, applying the standard Euler-Lagrange equation is also straightforward:\n$$\n\\frac{\\partial L}{\\partial d} - \\frac{\\mathrm{d}}{\\mathrm{d}x}\\left(\\frac{\\partial L}{\\partial d'}\\right) = 0\n$$\nFirst, we compute the required partial derivatives:\n$$\n\\frac{\\partial L}{\\partial d} = G_c \\left( \\frac{2d}{2\\ell} \\right) = \\frac{G_c d}{\\ell}\n$$\n$$\n\\frac{\\partial L}{\\partial d'} = G_c \\left( \\frac{\\ell}{2}(2d') \\right) = G_c \\ell d'\n$$\nNext, we find the total derivative of the second term with respect to $x$:\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}x}\\left(\\frac{\\partial L}{\\partial d'}\\right) = \\frac{\\mathrm{d}}{\\mathrm{d}x}(G_c \\ell d') = G_c \\ell d''\n$$\nSubstituting these expressions into the Euler-Lagrange equation, we obtain:\n$$\n\\frac{G_c d}{\\ell} - G_c \\ell d'' = 0\n$$\nThe constant $G_c$ is positive, so we can divide by it. Rearranging the terms gives a second-order linear homogeneous ordinary differential equation with constant coefficients:\n$$\n\\ell^{2} d'' - d = 0 \\quad \\implies \\quad d'' - \\frac{1}{\\ell^{2}} d = 0\n$$\nThe characteristic equation for this ODE is $r^2 - \\frac{1}{\\ell^2} = 0$, which has roots $r_1 = \\frac{1}{\\ell}$ and $r_2 = -\\frac{1}{\\ell}$.\nThe general solution is therefore of the form:\n$$\nd(x) = C_1 \\exp\\left(\\frac{x}{\\ell}\\right) + C_2 \\exp\\left(-\\frac{x}{\\ell}\\right)\n$$\nwhere $C_1$ and $C_2$ are constants to be determined from the boundary conditions.\n\nThe boundary conditions are $d(0)=1$ and $d(x) \\to 0$ as $|x| \\to \\infty$. We must apply the condition at infinity carefully.\nFor the solution to decay to $0$ as $x \\to \\infty$, the term $\\exp(x/\\ell)$, which grows unbounded, must be eliminated. This requires $C_1 = 0$. So for $x > 0$, the solution must be of the form $d(x) = C_2 \\exp(-x/\\ell)$.\nFor the solution to decay to $0$ as $x \\to -\\infty$, the term $\\exp(-x/\\ell)$ must be eliminated. This requires $C_2 = 0$. So for $x < 0$, the solution must be of the form $d(x) = C_1 \\exp(x/\\ell)$.\n\nLet's apply the condition at the center, $d(0)=1$.\nFor the solution valid for $x > 0$, we have $d(x) = C_2 \\exp(-x/\\ell)$. Approaching $x=0$ from the right, $d(0) = C_2 \\exp(0) = C_2$. So, $C_2=1$.\nFor the solution valid for $x < 0$, we have $d(x) = C_1 \\exp(x/\\ell)$. Approaching $x=0$ from the left, $d(0) = C_1 \\exp(0) = C_1$. So, $C_1=1$.\n\nCombining these results, the solution is:\n$$\nd(x) = \\begin{cases} \\exp(-x/\\ell) & \\text{if } x \\ge 0 \\\\ \\exp(x/\\ell) & \\text{if } x < 0 \\end{cases}\n$$\nThis piecewise function can be written more compactly using the absolute value function:\n$$\nd(x) = \\exp\\left(-\\frac{|x|}{\\ell}\\right)\n$$\nThis is the stationary optimal profile for the phase-field variable $d(x)$.\n\nNext, we compute the Full Width at Half Maximum (FWHM) of this profile. The maximum value of $d(x)$ occurs at $x=0$, where $d(0) = \\exp(0) = 1$. The half maximum value is therefore $1/2$.\nWe need to find the values of $x$ for which $d(x) = 1/2$.\n$$\n\\exp\\left(-\\frac{|x|}{\\ell}\\right) = \\frac{1}{2}\n$$\nTaking the natural logarithm of both sides:\n$$\n-\\frac{|x|}{\\ell} = \\ln\\left(\\frac{1}{2}\\right) = -\\ln(2)\n$$\n$$\n|x| = \\ell \\ln(2)\n$$\nThis equation gives two solutions for $x$: $x_1 = -\\ell \\ln(2)$ and $x_2 = \\ell \\ln(2)$.\nThe FWHM is defined as the distance between these two points:\n$$\n\\text{FWHM} = x_2 - x_1 = \\ell \\ln(2) - (-\\ell \\ln(2)) = 2\\ell \\ln(2)\n$$\nThis is the characteristic width of the diffuse crack in terms of the length scale parameter $\\ell$. The problem asks to \"Express the final width in meters\". Since $\\ell$ is an internal length scale, it has units of length. If $\\ell$ is provided in meters, the expression $2\\ell\\ln(2)$ directly gives the width in meters. The result is a symbolic expression, not a numerical value, as no value for $\\ell$ was given.\n\nThe final answers are the derived profile $d(x)$ and the expression for the FWHM.", "answer": "$$\n\\boxed{\\begin{pmatrix} \\exp\\left(-\\frac{|x|}{\\ell}\\right) & 2\\ell\\ln(2) \\end{pmatrix}}\n$$", "id": "3550312"}, {"introduction": "Building on the foundational variational principles, this next practice connects the abstract model parameters to a critical, measurable material property: tensile strength. You will analyze a one-dimensional bar under tension and derive the analytical expression for its strength $\\sigma_c$ as a function of the fracture toughness $G_c$, Young's modulus $E$, and length scale $\\ell$. This exercise not only demonstrates the predictive capability of phase-field models but also illuminates the nuanced differences between the AT1 and AT2 formulations, revealing how model choice affects predictions of damage initiation and failure [@problem_id:3550301].", "problem": "Consider a one-dimensional, infinitely long, linear-elastic bar of unit cross-sectional area subjected to remote uniform tension. The small-strain displacement field is $u(x)$ and the scalar phase-field (damage) variable is $d(x) \\in [0,1]$, where $d=0$ is intact and $d=1$ is fully broken. The degraded elastic stiffness is modeled by the standard quadratic degradation function $g(d) = (1 - d)^{2}$. The elastic strain is $\\varepsilon(x) = u'(x)$ and the elastic energy density under tension is $\\psi_{e}(\\varepsilon,d) = \\tfrac{1}{2}\\,g(d)\\,E\\,\\varepsilon^{2}$, where $E$ is the Young’s modulus. The fracture energy is regularized via the Ambrosio–Tortorelli functional\n$$\n\\Gamma_{\\ell}[d] = \\int_{-\\infty}^{\\infty} \\frac{G_{c}}{c_{w}} \\left( \\frac{w(d)}{\\ell} + \\ell\\,|d'(x)|^{2} \\right)\\,\\mathrm{d}x,\n$$\nwhere $G_{c}$ is the critical energy-release rate, $\\ell$ is the internal length scale, and $w(d)$ is the crack surface density function. The crack density normalization constant $c_{w}$ is chosen such that a stationary one-dimensional crack profile has energy $\\Gamma_{\\ell} = G_{c}$, i.e.,\n$$\nc_{w} = 2 \\int_{0}^{1} \\sqrt{w(s)}\\,\\mathrm{d}s.\n$$\nTwo canonical choices are considered: the Ambrosio–Tortorelli quadratic model (AT2), with $w(d) = d^{2}$, and the Ambrosio–Tortorelli linear model (AT1), with $w(d) = d$. For these choices one has $c_{w}^{\\mathrm{AT2}} = 1$ and $c_{w}^{\\mathrm{AT1}} = \\tfrac{4}{3}$.\n\nUnder remote stress control with nominal stress $\\sigma$ (constant in $x$), the appropriate potential to minimize with respect to $d(x)$ is the enthalpy functional\n$$\n\\Pi_{\\sigma}[d] = \\int_{-\\infty}^{\\infty} \\left( -\\,\\frac{\\sigma^{2}}{2\\,E\\,g(d)} + \\frac{G_{c}}{c_{w}} \\left( \\frac{w(d)}{\\ell} + \\ell\\,|d'(x)|^{2} \\right) \\right)\\,\\mathrm{d}x,\n$$\nsubject to $d(\\pm \\infty) = 0$ and $d'(0) = 0$ for a symmetric localization centered at $x=0$.\n\nStarting from these definitions and the calculus of variations, and without invoking any pre-tabulated strength formulas, do the following:\n\n1. Derive the condition for the existence of a nontrivial localized stationary damage profile in terms of a first integral of the Euler–Lagrange equation. Use this to obtain a criterion for the largest admissible remote stress (the tensile strength) $\\sigma_{c}$ as the stress at which the turning point of the damage profile becomes a double root.\n\n2. Specialize your derivation to the AT2 model and obtain a closed-form analytical expression for $\\sigma_{c}$ in terms of $E$, $G_{c}$, and $\\ell$.\n\n3. Repeat the analysis for the AT1 model and identify whether a finite damage nucleation threshold exists. Provide the corresponding analytical expression and explain whether, for AT1, the tensile strength coincides with the nucleation threshold.\n\nExpress your final answers as exact analytic expressions in terms of $E$, $G_{c}$, and $\\ell$. Do not substitute numerical values and do not include units in the final boxed answer.", "solution": "The problem asks for the derivation of the tensile strength of a one-dimensional bar within the framework of phase-field fracture mechanics for two different models, AT2 and AT1.\n\nThe analysis is based on minimizing the enthalpy functional $\\Pi_{\\sigma}[d]$ for a fixed remote stress $\\sigma$.\n$$\n\\Pi_{\\sigma}[d] = \\int_{-\\infty}^{\\infty} L(d, d')\\,\\mathrm{d}x\n$$\nwhere the Lagrangian $L(d, d')$ is given by:\n$$\nL(d, d') = -\\frac{\\sigma^{2}}{2\\,E\\,g(d)} + \\frac{G_{c}}{c_{w}} \\left( \\frac{w(d)}{\\ell} + \\ell\\,(d')^{2} \\right)\n$$\nwith $g(d) = (1 - d)^{2}$.\n\n### Part 1: General Derivation of the Stationarity Condition and Tensile Strength Criterion\n\nThe Euler-Lagrange equation for the functional $\\Pi_{\\sigma}[d]$ is $\\frac{\\partial L}{\\partial d} - \\frac{\\mathrm{d}}{\\mathrm{d}x}\\left(\\frac{\\partial L}{\\partial d'}\\right) = 0$. Since the Lagrangian $L$ does not depend explicitly on the spatial coordinate $x$, we can use the Beltrami identity (a first integral of the Euler-Lagrange equation), which states that:\n$$\nL - d' \\frac{\\partial L}{\\partial d'} = C\n$$\nwhere $C$ is a constant. First, we compute the partial derivative of $L$ with respect to $d'$:\n$$\n\\frac{\\partial L}{\\partial d'} = \\frac{G_{c}}{c_{w}} \\ell (2d')\n$$\nSubstituting this into the Beltrami identity:\n$$\n\\left( -\\frac{\\sigma^{2}}{2\\,E\\,g(d)} + \\frac{G_{c}}{c_{w}} \\left( \\frac{w(d)}{\\ell} + \\ell\\,(d')^{2} \\right) \\right) - d' \\left( \\frac{G_{c}}{c_{w}} 2\\ell d' \\right) = C\n$$\n$$\n-\\frac{\\sigma^{2}}{2\\,E\\,g(d)} + \\frac{G_{c}}{c_{w}} \\frac{w(d)}{\\ell} - \\frac{G_{c}}{c_{w}} \\ell\\,(d')^{2} = C\n$$\nThe constant $C$ is determined from the boundary conditions for a localized solution, $d(x) \\to 0$ and $d'(x) \\to 0$ as $x \\to \\pm\\infty$. We also know that for both AT1 ($w(d)=d$) and AT2 ($w(d)=d^2$) models, $w(0)=0$. Applying these conditions:\n$$\nC = -\\frac{\\sigma^{2}}{2\\,E\\,g(0)} + \\frac{G_{c}}{c_{w}} \\frac{w(0)}{\\ell} - 0 = -\\frac{\\sigma^{2}}{2\\,E\\,(1-0)^{2}} = -\\frac{\\sigma^{2}}{2\\,E}\n$$\nSubstituting $C$ back, we obtain the first integral of motion for a stationary damage profile:\n$$\n-\\frac{\\sigma^{2}}{2\\,E\\,g(d)} + \\frac{G_{c}}{c_{w}} \\frac{w(d)}{\\ell} - \\frac{G_{c}}{c_{w}} \\ell\\,(d')^{2} = -\\frac{\\sigma^{2}}{2\\,E}\n$$\nThis equation represents the condition for the existence of a stationary damage profile. We rearrange it to solve for $(d')^2$ and define a potential function $F(d, \\sigma)$ such that $\\ell^2(d')^2 = F(d, \\sigma)$:\n$$\nF(d, \\sigma) = w(d) - \\frac{c_{w} \\ell \\sigma^{2}}{2 E G_{c}} \\frac{d(2-d)}{(1-d)^2}\n$$\nFor a real, non-trivial solution to exist, we must have $F(d, \\sigma) \\ge 0$ in the range of the solution, i.e., for $d \\in [0, d_{\\max}]$, where $d_{\\max}$ is the damage at the center of the localization, $x=0$. At this point, $d'(0)=0$, which implies $F(d_{\\max}, \\sigma)=0$.\nThe tensile strength $\\sigma_c$ is the maximum stress the material can sustain. This corresponds to the peak of the $\\sigma$ vs. $d_{\\max}$ curve. This peak is characterized by $\\frac{\\mathrm{d}\\sigma}{\\mathrm{d}d_{\\max}}=0$. Mathematically, this condition is equivalent to the turning point $d_{\\max}$ becoming a double root of $F(d, \\sigma_c) = 0$. Let this critical damage value be $d_c$. The conditions are:\n$$\nF(d_c, \\sigma_c) = 0 \\quad \\text{and} \\quad \\frac{\\partial F}{\\partial d}(d_c, \\sigma_c) = 0\n$$\nLet's compute the derivative $\\frac{\\partial F}{\\partial d}$:\n$$\n\\frac{\\partial F}{\\partial d} = w'(d) - \\frac{c_{w} \\ell \\sigma^{2}}{2 E G_{c}} \\frac{\\mathrm{d}}{\\mathrm{d}d}\\left(\\frac{2d-d^2}{(1-d)^2}\\right) = w'(d) - \\frac{c_{w} \\ell \\sigma^{2}}{E G_{c}} \\frac{1}{(1-d)^3}\n$$\nThe system of equations for $\\sigma_c$ and $d_c$ is:\n1) $F(d_c, \\sigma_c) = 0 \\implies w(d_c) - \\frac{c_{w} \\ell \\sigma_c^{2}}{2 E G_{c}} \\frac{d_c(2-d_c)}{(1-d_c)^2} = 0$\n2) $\\frac{\\partial F}{\\partial d}(d_c, \\sigma_c) = 0 \\implies w'(d_c) - \\frac{c_{w} \\ell \\sigma_c^{2}}{E G_{c}} \\frac{1}{(1-d_c)^3} = 0$\n\nFrom equation (2), we can express the stress term:\n$$\n\\frac{c_{w} \\ell \\sigma_c^{2}}{E G_{c}} = w'(d_c) (1-d_c)^3\n$$\nSubstituting this into equation (1):\n$$\nw(d_c) - \\frac{1}{2} \\left( w'(d_c) (1-d_c)^3 \\right) \\frac{d_c(2-d_c)}{(1-d_c)^2} = 0\n$$\n$$\nw(d_c) - \\frac{1}{2} w'(d_c) d_c(1-d_c)(2-d_c) = 0\n$$\nThis equation determines the critical damage $d_c$ at the tensile strength. Once $d_c$ is found, the tensile strength $\\sigma_c$ is obtained from:\n$$\n\\sigma_c^2 = \\frac{E G_c}{c_w \\ell} w'(d_c) (1-d_c)^3\n$$\n\n### Part 2: Specialization to the AT2 Model\n\nFor the AT2 model, we have $w(d) = d^2$, $w'(d) = 2d$, and $c_w = 1$.\nSubstitute these into the equation for $d_c$:\n$$\nd_c^2 - \\frac{1}{2}(2d_c)d_c(1-d_c)(2-d_c) = 0 \\implies d_c^2 \\left[1 - (1-d_c)(2-d_c)\\right] = 0\n$$\nThis gives a trivial solution $d_c=0$ or the non-trivial condition:\n$$\n1 - (2 - 3d_c + d_c^2) = 0 \\implies d_c^2 - 3d_c + 1 = 0\n$$\nThe roots of this quadratic equation are $d_c = \\frac{3 \\pm \\sqrt{9-4}}{2} = \\frac{3 \\pm \\sqrt{5}}{2}$.\nSince $d \\in [0,1]$, we must choose the smaller root:\n$$\nd_c = \\frac{3 - \\sqrt{5}}{2} \\approx 0.382\n$$\nNow, we find $\\sigma_c$ using the expression for $\\sigma_c^2$ with $c_w = 1$ and $w'(d_c)=2d_c$:\n$$\n\\sigma_c^2 = \\frac{E G_c}{\\ell} (2d_c) (1-d_c)^3\n$$\nUsing $d_c = \\frac{3 - \\sqrt{5}}{2}$ and $1-d_c = \\frac{\\sqrt{5}-1}{2}$, we have:\n$$\n\\sigma_c^2 = \\frac{E G_c}{\\ell} \\left(2\\left(\\frac{3-\\sqrt{5}}{2}\\right) \\left(\\frac{\\sqrt{5}-1}{2}\\right)^3\\right) = \\frac{E G_c}{\\ell} (3-\\sqrt{5})(\\sqrt{5}-2) = \\frac{E G_c}{\\ell} (5\\sqrt{5} - 11)\n$$\nSo, the tensile strength for the AT2 model is:\n$$\n\\sigma_c = \\sqrt{\\frac{E G_c}{\\ell}(5\\sqrt{5} - 11)}\n$$\n\n### Part 3: Specialization to the AT1 Model\n\nFor the AT1 model, we have $w(d) = d$, $w'(d) = 1$, and $c_w = 4/3$.\nFirst, we investigate the existence of a damage nucleation threshold. Damage can initiate from the sound state $d=0$ only if the potential is non-negative for infinitesimal $d>0$. This requires the slope at $d=0$ to be non-negative, $\\frac{\\partial F}{\\partial d}(0, \\sigma) \\ge 0$.\n$$\n\\frac{\\partial F}{\\partial d}(0, \\sigma) = w'(0) - \\frac{c_{w} \\ell \\sigma^{2}}{E G_{c}} \\frac{1}{(1-0)^3} = 1 - \\frac{(4/3) \\ell \\sigma^{2}}{E G_{c}}\n$$\nSetting this to be $\\ge 0$ gives a condition on stress for nucleation:\n$$\n1 - \\frac{4\\ell \\sigma^{2}}{3E G_{c}} \\ge 0 \\implies \\sigma^2 \\le \\frac{3 E G_c}{4 \\ell}\n$$\nThis implies that for stresses $\\sigma > \\sigma_{\\text{nuc}} = \\sqrt{\\frac{3 E G_c}{4 \\ell}}$, the sound state is unstable and damage will nucleate. This is the damage nucleation threshold.\n\nNext, we check if the tensile strength coincides with this threshold. We search for a peak load by applying the general criterion $w(d_c) - \\frac{1}{2} w'(d_c) d_c(1-d_c)(2-d_c) = 0$.\n$$\nd_c - \\frac{1}{2}(1)d_c(1-d_c)(2-d_c) = 0 \\implies d_c \\left[1 - \\frac{1}{2}(1-d_c)(2-d_c)\\right] = 0\n$$\nOne solution is the trivial one, $d_c=0$. The other comes from the bracketed term:\n$$\n1 = \\frac{1}{2}(1-d_c)(2-d_c) \\implies 2 = 2 - 3d_c + d_c^2 \\implies d_c^2 - 3d_c = 0\n$$\nThis gives $d_c(d_c-3)=0$, with solutions $d_c=0$ and $d_c=3$. Neither of these represents a valid critical damage state within the physical range $(0,1]$. The absence of a solution for $d_c \\in (0,1]$ means that the stress-damage curve does not have a maximum (a peak load) after nucleation. The maximum stress occurs at the lowest possible damage, i.e., at the onset of nucleation ($d_{\\max} \\to 0$).\nTherefore, for the AT1 model, the tensile strength $\\sigma_c$ coincides with the damage nucleation threshold $\\sigma_{\\text{nuc}}$.\n$$\n\\sigma_c = \\sigma_{\\text{nuc}} = \\sqrt{\\frac{3 E G_c}{4 \\ell}}\n$$", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\sqrt{\\frac{E G_{c}}{\\ell}(5\\sqrt{5} - 11)} & \\sqrt{\\frac{3 E G_{c}}{4 \\ell}}\n\\end{pmatrix}\n}\n$$", "id": "3550301"}, {"introduction": "Moving from one-dimensional theory to the complexities of three-dimensional geomechanics, this computational practice addresses a critical challenge: ensuring the model behaves physically under compressive stress states. You will implement and compare two distinct energy-splitting strategies designed to prevent the growth of damage under compression, a non-physical artifact of naive models. Through this single-point coding experiment, you will gain practical experience in implementing the constitutive logic that allows phase-field models to realistically simulate fracture in complex, mixed-mode loading scenarios typical of geological materials [@problem_id:3550356].", "problem": "Design and implement a single-point computational experiment to compare two degradation strategies in phase-field modeling of brittle fracture under triaxial compression. Consider a small-strain, linear-elastic, isotropic solid with Young’s modulus $\\mathrm{E}$ and Poisson’s ratio $\\nu$, and use the Ambrosio-Tortorelli (AT-2) crack-surface density regularization. The scalar phase-field (damage) variable is $d \\in [0,1]$ and the elastic degradation function is $g(d) = (1 - d)^{2} + \\kappa$, with $\\kappa$ a small residual stiffness. You will work at a single material point and neglect the gradient term in the crack-surface functional, but you must retain the length scale $\\ell$ through the crack-surface density penalty, ensuring unit consistency.\n\nStart from the following fundamental base:\n- Small-strain kinematics: the infinitesimal strain tensor is $\\boldsymbol{\\varepsilon} = \\tfrac{1}{2}\\left(\\nabla \\mathbf{u} + \\nabla \\mathbf{u}^{\\mathsf{T}}\\right)$, where $\\mathbf{u}$ is the displacement field.\n- Linear elastic constitutive law (Hooke’s law) for isotropic materials: $\\boldsymbol{\\sigma} = \\lambda\\, \\mathrm{tr}(\\boldsymbol{\\varepsilon})\\,\\mathbf{I} + 2 \\mu \\,\\boldsymbol{\\varepsilon}$, with Lamé parameters $\\lambda = \\dfrac{\\mathrm{E}\\,\\nu}{(1+\\nu)(1-2\\nu)}$ and $\\mu = \\dfrac{\\mathrm{E}}{2(1+\\nu)}$, and bulk modulus $\\mathrm{K} = \\lambda + \\dfrac{2}{3}\\mu$. Here, $\\mathbf{I}$ is the identity tensor, $\\mathrm{tr}(\\cdot)$ is the trace, and $\\boldsymbol{\\sigma}$ is the Cauchy stress tensor.\n- The octahedral shear stress is $\\tau_{\\mathrm{oct}} = \\sqrt{\\dfrac{1}{3}\\,\\mathbf{s}:\\mathbf{s}}$, where $\\mathbf{s} = \\boldsymbol{\\sigma} - \\sigma_{\\mathrm{m}}\\mathbf{I}$ is the deviatoric stress and $\\sigma_{\\mathrm{m}} = \\dfrac{1}{3}\\mathrm{tr}(\\boldsymbol{\\sigma})$ is the mean stress. The double-dot denotes the Frobenius inner product.\n\nAt each prescribed strain state, consider the following driving energy choices for damage:\n- Strategy $\\mathrm{S}$ (spectral split, tensile-only): decompose $\\boldsymbol{\\varepsilon}$ spectrally, let $\\boldsymbol{\\varepsilon}_{+}$ be the positive part built from the positive principal strains, and define\n$$\n\\psi_{0,\\mathrm{S}}^{+}(\\boldsymbol{\\varepsilon}) = \\tfrac{1}{2}\\,\\lambda\\,\\langle \\mathrm{tr}(\\boldsymbol{\\varepsilon}) \\rangle_{+}^{2} + \\mu\\,\\boldsymbol{\\varepsilon}_{+}:\\boldsymbol{\\varepsilon}_{+},\n$$\nwhere $\\langle x \\rangle_{+} = \\max(x,0)$ is the Macaulay bracket.\n- Strategy $\\mathrm{O}$ (octahedral-stress-based deviatoric switch): define the deviatoric strain $\\boldsymbol{\\varepsilon}_{\\mathrm{dev}} = \\boldsymbol{\\varepsilon} - \\tfrac{1}{3}\\mathrm{tr}(\\boldsymbol{\\varepsilon})\\mathbf{I}$, compute $\\boldsymbol{\\sigma}$, $\\sigma_{\\mathrm{m}}$, and $\\tau_{\\mathrm{oct}}$, and set\n$$\nS_{\\mathrm{oct}} =\n\\begin{cases}\n1, & \\text{if } \\sigma_{\\mathrm{m}} \\ge 0 \\text{ and } \\tau_{\\mathrm{oct}} \\ge \\tau_{\\mathrm{th}},\\\\\n0, & \\text{otherwise},\n\\end{cases}\n$$\nwith threshold $\\tau_{\\mathrm{th}} = 0$. Then take\n$$\n\\psi_{0,\\mathrm{O}}^{+}(\\boldsymbol{\\varepsilon}) = \\tfrac{1}{2}\\,\\mathrm{K}\\,\\langle \\mathrm{tr}(\\boldsymbol{\\varepsilon}) \\rangle_{+}^{2} + S_{\\mathrm{oct}}\\,\\mu\\,\\boldsymbol{\\varepsilon}_{\\mathrm{dev}}:\\boldsymbol{\\varepsilon}_{\\mathrm{dev}}.\n$$\n\nUse the standard energetic driving with an irreversibility history field $H$ that stores the maximum tensile driving to date, and minimize locally the regularized energy density\n$$\n\\psi(d) = g(d)\\,H + \\dfrac{G_{\\mathrm{c}}}{2\\ell}\\,d^{2},\n$$\nsubject to $d \\in [0,1]$ and non-decreasing $d$. Here, $G_{\\mathrm{c}}$ is the critical energy release rate. You must obtain the updated $d$ for each strategy by enforcing the first-order optimality condition with irreversibility, starting from an undamaged state. Do not introduce any ad hoc caps or tuning beyond what is specified. All stresses must be in $\\mathrm{Pa}$, strains are dimensionless, $G_{\\mathrm{c}}$ is in $\\mathrm{N/m}$, and $\\ell$ is in $\\mathrm{m}$. The final values of $d$ are dimensionless. Express the program’s numerical outputs rounded to $6$ decimal places.\n\nParameters:\n- $\\mathrm{E} = 3.0 \\times 10^{10}\\ \\mathrm{Pa}$,\n- $\\nu = 0.25$,\n- $G_{\\mathrm{c}} = 1.0 \\times 10^{3}\\ \\mathrm{N/m}$,\n- $\\ell = 1.0 \\times 10^{-2}\\ \\mathrm{m}$,\n- $\\kappa = 1.0 \\times 10^{-8}$,\n- $\\tau_{\\mathrm{th}} = 0$.\n\nTest suite: Evaluate the two strategies for the following $5$ prescribed small-strain states $\\boldsymbol{\\varepsilon}$ (dimensionless), given as symmetric tensors:\n- Case $1$ (hydrostatic compression): $\\boldsymbol{\\varepsilon} = \\mathrm{diag}(-1.0\\times 10^{-3},-1.0\\times 10^{-3},-1.0\\times 10^{-3})$.\n- Case $2$ (triaxial compression with shear): $\\boldsymbol{\\varepsilon} = \\begin{bmatrix}-5.0\\times 10^{-4} & 1.5\\times 10^{-3} & 0\\\\ 1.5\\times 10^{-3} & -5.0\\times 10^{-4} & 0\\\\ 0 & 0 & -5.0\\times 10^{-4}\\end{bmatrix}$.\n- Case $3$ (hydrostatic tension): $\\boldsymbol{\\varepsilon} = \\mathrm{diag}(5.0\\times 10^{-4},5.0\\times 10^{-4},5.0\\times 10^{-4})$.\n- Case $4$ (pure shear): $\\boldsymbol{\\varepsilon} = \\begin{bmatrix}0 & 1.0\\times 10^{-3} & 0\\\\ 1.0\\times 10^{-3} & 0 & 0\\\\ 0 & 0 & 0\\end{bmatrix}$.\n- Case $5$ (near-zero magnitudes, compressive mean, tiny shear): $\\boldsymbol{\\varepsilon} = \\begin{bmatrix}-1.0\\times 10^{-8} & 1.0\\times 10^{-8} & 0\\\\ 1.0\\times 10^{-8} & -1.0\\times 10^{-8} & 0\\\\ 0 & 0 & -1.0\\times 10^{-8}\\end{bmatrix}$.\n\nFor each case, compute two damage values: $d_{\\mathrm{S}}$ using $\\psi_{0,\\mathrm{S}}^{+}$ and $d_{\\mathrm{O}}$ using $\\psi_{0,\\mathrm{O}}^{+}$, both starting from $H=0$ with irreversibility enforced in a single pseudo-time step under the prescribed strain. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, ordered as $[d_{\\mathrm{S}}^{(1)}, d_{\\mathrm{O}}^{(1)}, d_{\\mathrm{S}}^{(2)}, d_{\\mathrm{O}}^{(2)}, d_{\\mathrm{S}}^{(3)}, d_{\\mathrm{O}}^{(3)}, d_{\\mathrm{S}}^{(4)}, d_{\\mathrm{O}}^{(4)}, d_{\\mathrm{S}}^{(5)}, d_{\\mathrm{O}}^{(5)}]$, with each value rounded to $6$ decimal places and with no additional text. The outputs are dimensionless floats.", "solution": "The problem requires the implementation of a single-point computational experiment to compare two phase-field degradation strategies. This involves calculating the damage variable $d$ by minimizing a local energy functional for several prescribed strain states.\n\nFirst, we compute the necessary elastic constants from the given Young's modulus $\\mathrm{E} = 3.0 \\times 10^{10}\\ \\mathrm{Pa}$ and Poisson's ratio $\\nu = 0.25$.\nThe Lamé parameters $\\lambda$ and $\\mu$, and the bulk modulus $K$ are:\n$$\n\\lambda = \\dfrac{\\mathrm{E}\\,\\nu}{(1+\\nu)(1-2\\nu)} = 1.2 \\times 10^{10}\\ \\mathrm{Pa}\n$$\n$$\n\\mu = \\dfrac{\\mathrm{E}}{2(1+\\nu)} = 1.2 \\times 10^{10}\\ \\mathrm{Pa}\n$$\n$$\n\\mathrm{K} = \\lambda + \\dfrac{2}{3}\\mu = 2.0 \\times 10^{10}\\ \\mathrm{Pa}\n$$\nThe damage evolution is governed by the local minimization of the regularized energy density $\\psi(d)$:\n$$\n\\psi(d) = g(d)\\,H + \\dfrac{G_{\\mathrm{c}}}{2\\ell}\\,d^{2}\n$$\nwhere $g(d) = (1-d)^2 + \\kappa$ is the degradation function and $H$ is the history field. For a single step from an undamaged state, $H = \\psi_0^+(\\boldsymbol{\\varepsilon})$, where $\\psi_0^+$ is the driving part of the elastic strain energy density for the prescribed strain $\\boldsymbol{\\varepsilon}$.\n\nThe first-order optimality condition $\\frac{\\partial\\psi}{\\partial d} = 0$ gives:\n$$\n-2(1-d)H + \\dfrac{G_{\\mathrm{c}}}{\\ell}d = 0\n$$\nSolving for $d$ gives the unconstrained minimizer $d_{\\mathrm{unc}} = \\frac{H}{H + G_{\\mathrm{c}}/(2\\ell)}$, which is guaranteed to be in $[0,1)$.\nLet's define the constant penalty term coefficient $C = \\frac{G_{\\mathrm{c}}}{2\\ell} = \\frac{1.0 \\times 10^3}{2 \\times 1.0 \\times 10^{-2}} = 5 \\times 10^4\\ \\mathrm{J/m^3}$. The damage is then $d = \\frac{H}{H+C}$.\n\nThe two strategies differ in the calculation of the driving energy $H$.\n\n**Strategy S: Spectral Split**\nThe driving energy is $\\psi_{0,\\mathrm{S}}^{+}(\\boldsymbol{\\varepsilon}) = \\tfrac{1}{2}\\,\\lambda\\,\\langle \\mathrm{tr}(\\boldsymbol{\\varepsilon}) \\rangle_{+}^{2} + \\mu\\,\\boldsymbol{\\varepsilon}_{+}:\\boldsymbol{\\varepsilon}_{+}$. This requires the spectral decomposition of $\\boldsymbol{\\varepsilon}$ to find its principal strains (eigenvalues) $\\varepsilon_i$, from which the positive part of the strain tensor $\\boldsymbol{\\varepsilon}_{+}$ is constructed.\n\n**Strategy O: Octahedral-Stress-Based Deviatoric Switch**\nThe driving energy is $\\psi_{0,\\mathrm{O}}^{+}(\\boldsymbol{\\varepsilon}) = \\tfrac{1}{2}\\,\\mathrm{K}\\,\\langle \\mathrm{tr}(\\boldsymbol{\\varepsilon}) \\rangle_{+}^{2} + S_{\\mathrm{oct}}\\,\\mu\\,\\boldsymbol{\\varepsilon}_{\\mathrm{dev}}:\\boldsymbol{\\varepsilon}_{\\mathrm{dev}}$. The switch $S_{\\mathrm{oct}}$ depends on the mean stress $\\sigma_{\\mathrm{m}} = \\mathrm{K}\\,\\mathrm{tr}(\\boldsymbol{\\varepsilon})$ and octahedral shear stress $\\tau_{\\mathrm{oct}} = 2\\mu\\sqrt{\\frac{\\boldsymbol{\\varepsilon}_{\\mathrm{dev}}:\\boldsymbol{\\varepsilon}_{\\mathrm{dev}}}{3}}$.\n\nThe following Python code implements these two strategies and computes the damage for the five specified test cases.\n```python\nimport numpy as np\n\ndef compute_damage_S(eps, lame_lambda, mu, C_penalty):\n    \"\"\"\n    Computes damage using the spectral split strategy (S).\n    \"\"\"\n    # Calculate driving energy psi_0_S^+\n    tr_eps = np.trace(eps)\n    macaulay_tr_eps = np.maximum(0.0, tr_eps)\n    \n    # Eigenvalues of the strain tensor for the spectral split\n    eigvals = np.linalg.eigh(eps)[0]\n    macaulay_eigvals = np.maximum(0.0, eigvals)\n    \n    # Frobenius inner product of the positive part of the strain tensor\n    eps_plus_dot_eps_plus = np.sum(macaulay_eigvals**2)\n    \n    # Driving energy for strategy S\n    psi_plus_S = 0.5 * lame_lambda * macaulay_tr_eps**2 + mu * eps_plus_dot_eps_plus\n    \n    # This psi_plus is the history variable H for this single step\n    H = psi_plus_S\n    \n    # Compute damage d\n    if H <= 0.0:\n        return 0.0\n    d = H / (H + C_penalty)\n    return d\n\ndef compute_damage_O(eps, mu, K, tau_th, C_penalty):\n    \"\"\"\n    Computes damage using the octahedral-stress-based deviatoric switch strategy (O).\n    \"\"\"\n    tr_eps = np.trace(eps)\n    macaulay_tr_eps = np.maximum(0.0, tr_eps)\n    \n    # Calculate mean stress to check the switch condition\n    sigma_m = K * tr_eps\n    \n    # Deviatoric strain and its Frobenius norm\n    eps_dev = eps - (tr_eps / 3.0) * np.identity(3)\n    eps_dev_dot_eps_dev = np.sum(eps_dev**2)\n\n    # Calculate octahedral shear stress to check the switch condition\n    s_dot_s = (2 * mu)**2 * eps_dev_dot_eps_dev\n    tau_oct = np.sqrt(s_dot_s / 3.0) if s_dot_s > 0 else 0.0\n\n    # Determine the switch S_oct\n    S_oct = 1.0 if sigma_m >= 0.0 and tau_oct >= tau_th else 0.0\n        \n    # Driving energy for strategy O\n    psi_plus_O = 0.5 * K * macaulay_tr_eps**2 + S_oct * mu * eps_dev_dot_eps_dev\n    \n    # This psi_plus is the history variable H for this single step\n    H = psi_plus_O\n    \n    # Compute damage d\n    if H <= 0.0:\n        return 0.0\n    d = H / (H + C_penalty)\n    return d\n\n# Material and model parameters\nE = 3.0e10\nnu = 0.25\nGc = 1.0e3\nl = 1.0e-2\ntau_th = 0.0\n\n# Pre-calculate derived constants\nlame_lambda = (E * nu) / ((1 + nu) * (1 - 2 * nu))\nmu = E / (2 * (1 + nu))\nK = lame_lambda + (2.0 / 3.0) * mu\nC_penalty = Gc / (2.0 * l)\n\n# Prescribed strain tensors\ntest_cases = [\n    np.diag([-1.0e-3, -1.0e-3, -1.0e-3]),\n    np.array([[-5.0e-4, 1.5e-3, 0.0], [1.5e-3, -5.0e-4, 0.0], [0.0, 0.0, -5.0e-4]]),\n    np.diag([5.0e-4, 5.0e-4, 5.0e-4]),\n    np.array([[0.0, 1.0e-3, 0.0], [1.0e-3, 0.0, 0.0], [0.0, 0.0, 0.0]]),\n    np.array([[-1.0e-8, 1.0e-8, 0.0], [1.0e-8, -1.0e-8, 0.0], [0.0, 0.0, -1.0e-8]])\n]\n\nresults = []\nfor eps in test_cases:\n    d_S = compute_damage_S(eps, lame_lambda, mu, C_penalty)\n    results.append(d_S)\n    d_O = compute_damage_O(eps, mu, K, tau_th, C_penalty)\n    results.append(d_O)\n```", "answer": "[0.000000,0.000000,0.193548,0.000000,0.310345,0.310345,0.193548,0.324324,0.000000,0.000000]", "id": "3550356"}]}