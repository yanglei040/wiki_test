{"hands_on_practices": [{"introduction": "The foundation of any Stochastic Finite Element Method (SFEM) analysis is a robust model of material property uncertainty. This practice [@problem_id:3563275] guides you through the crucial first step of translating raw field data into a geostatistical model. You will use empirical semi-variogram data to calibrate the parameters of a theoretical covariance model, a procedure that connects tangible measurements to the abstract concept of a random field.", "problem": "A horizontal profile of undrained shear strength is modeled as a second-order stationary random field to be used as input for a Stochastic Finite Element Method (SFEM) via a Karhunen–Loève expansion in a computational geomechanics analysis. Based on in-situ cone penetration test data, the empirical semi-variogram is computed at several lags. Assume an exponential covariance model and a nonzero nugget effect due to microscale variability and measurement error.\n\nStart from the definition of the semi-variogram $\\,\\gamma(h) = \\frac{1}{2}\\,\\mathbb{V}\\mathrm{ar}[X(\\mathbf{x}+ \\mathbf{h}) - X(\\mathbf{x})]$ for a second-order stationary field with covariance $\\,C(h)\\,$ and recall that for the exponential covariance model $\\,C(h) = \\sigma^{2}\\exp(-h/\\theta)\\,$, where $\\,\\sigma^{2}\\,$ is the structured variance and $\\,\\theta\\,$ is the correlation length. The semi-variogram then admits the parametric form\n$$\n\\gamma(h) = c_{0} + \\sigma^{2}\\bigl(1 - \\exp(-h/\\theta)\\bigr),\n$$\nwhere $\\,c_{0}\\,$ is the nugget effect and $\\,c_{0} + \\sigma^{2}\\,$ equals the sill. Using this model, formulate a least-squares estimation procedure for $\\,\\theta\\,$ and $\\,c_{0}\\,$ appropriate for calibrating the random field for SFEM discretization, beginning from the above definitions and without invoking any specialized fitting formulas. Clearly state any transformations you use and the associated objective minimized.\n\nYou are provided the following empirical semi-variogram values $\\,\\hat{\\gamma}(h)\\,$ from the in-situ tests at lags (in meters): $\\,h = 0.5, 1.0, 2.0, 4.0\\,$ with\n- $\\,\\hat{\\gamma}(0.5) = 10.66938\\,\\text{(kPa)}^{2}\\,$,\n- $\\,\\hat{\\gamma}(1.0) = 14.73166\\,\\text{(kPa)}^{2}\\,$,\n- $\\,\\hat{\\gamma}(2.0) = 19.72806\\,\\text{(kPa)}^{2}\\,$,\n- $\\,\\hat{\\gamma}(4.0) = 23.61033\\,\\text{(kPa)}^{2}\\,$.\n\nAdditionally, co-located replicate measurements yield an empirical near-zero-lag estimate $\\,\\hat{\\gamma}(0^{+}) = 5.000\\,\\text{(kPa)}^{2}\\,$ to be interpreted as the nugget effect, and the sample variance of the field is $\\,25.000\\,\\text{(kPa)}^{2}\\,$, to be interpreted as the sill. Use these to carry out your least-squares estimation, and then compute the numerical estimates of $\\,\\theta\\,$ and $\\,c_{0}\\,$ from the provided data.\n\nRound your final numerical estimates to four significant figures. Express the correlation length in meters; the nugget effect should be expressed in $\\,\\text{(kPa)}^{2}\\,$. The final answer must consist only of the two estimated values in a single row matrix in the order $\\,(\\theta, c_{0})\\,$.", "solution": "The problem requires the formulation of a least-squares estimation procedure for the parameters of a semi-variogram model and the subsequent calculation of these parameters using provided empirical data.\n\nFirst, we validate the problem statement and its givens.\nThe semi-variogram model is given by\n$$ \\gamma(h) = c_{0} + \\sigma^{2}\\bigl(1 - \\exp(-h/\\theta)\\bigr) $$\nwhere $c_{0}$ is the nugget effect, $\\sigma^{2}$ is the structured variance, and $\\theta$ is the correlation length. The sill, or total variance, is $S = c_{0} + \\sigma^{2}$. We can rewrite the model in terms of the sill $S$ as\n$$ \\gamma(h) = c_{0} + (S-c_{0})\\bigl(1 - \\exp(-h/\\theta)\\bigr) $$\nThe problem provides a set of empirical semi-variogram values, $(\\hat{\\gamma}(h_i), h_i)$, for $i=1, \\dots, 4$:\n- $h_1 = 0.5\\,\\text{m}, \\hat{\\gamma}(h_1) = 10.66938\\,\\text{(kPa)}^{2}$\n- $h_2 = 1.0\\,\\text{m}, \\hat{\\gamma}(h_2) = 14.73166\\,\\text{(kPa)}^{2}$\n- $h_3 = 2.0\\,\\text{m}, \\hat{\\gamma}(h_3) = 19.72806\\,\\text{(kPa)}^{2}$\n- $h_4 = 4.0\\,\\text{m}, \\hat{\\gamma}(h_4) = 23.61033\\,\\text{(kPa)}^{2}$\n\nAdditionally, it provides explicit values to be used for the nugget effect and the sill:\n- Nugget effect: $c_0$ is to be taken from the empirical estimate $\\hat{\\gamma}(0^{+})$, so $c_0 = 5.000\\,\\text{(kPa)}^{2}$.\n- Sill: $S$ is to be taken from the sample variance, so $S = 25.000\\,\\text{(kPa)}^{2}$.\n\nThe problem is scientifically grounded, using standard models and methods from geostatistics. It is well-posed and objective, with sufficient and consistent data for a unique solution. Therefore, the problem is deemed valid.\n\nThe task is to formulate a least-squares estimation procedure for $\\theta$ and $c_0$. In the general case, where both $\\theta$ and $c_0$ are unknown (but the sill $S$ is known), the goal is to find the pair $(\\theta, c_0)$ that minimizes the sum of squared errors (SSE) between the model and the empirical data. The objective function to minimize is:\n$$ J(\\theta, c_0) = \\sum_{i=1}^{N} \\left[ \\hat{\\gamma}(h_i) - \\gamma(h_i; \\theta, c_0) \\right]^2 = \\sum_{i=1}^{N} \\left[ \\hat{\\gamma}(h_i) - \\left( c_0 + (S-c_0)(1 - \\exp(-h_i/\\theta)) \\right) \\right]^2 $$\nThis is a nonlinear least-squares problem, which is typically solved using numerical optimization algorithms.\n\nHowever, the problem provides specific values for $c_0$ and the sill $S$. We are instructed to use these values to carry out the estimation.\nGiven $c_0 = 5.000$ and $S = 25.000$, the structured variance is $\\sigma^2 = S - c_0 = 25.000 - 5.000 = 20.000 \\, (\\text{kPa})^2$.\nThe model simplifies to a function of a single unknown parameter, $\\theta$:\n$$ \\gamma(h; \\theta) = 5.000 + 20.000 \\left(1 - \\exp(-h/\\theta)\\right) $$\nThe estimation problem now reduces to finding the optimal $\\theta$ that best fits the data. We can formulate this as a one-dimensional least-squares problem, minimizing:\n$$ J(\\theta) = \\sum_{i=1}^{4} \\left[ \\hat{\\gamma}(h_i) - \\left( 5.000 + 20.000 \\left(1 - \\exp(-h_i/\\theta)\\right) \\right) \\right]^2 $$\nTo find the solution, we can linearize the model by a variable transformation. Rearranging the model equation:\n$$ \\hat{\\gamma}(h_i) - 5.000 = 20.000(1 - \\exp(-h_i/\\theta)) $$\n$$ \\frac{\\hat{\\gamma}(h_i) - 5.000}{20.000} = 1 - \\exp(-h_i/\\theta) $$\n$$ \\exp(-h_i/\\theta) = 1 - \\frac{\\hat{\\gamma}(h_i) - 5.000}{20.000} = \\frac{20.000 - \\hat{\\gamma}(h_i) + 5.000}{20.000} = \\frac{25.000 - \\hat{\\gamma}(h_i)}{20.000} $$\nTaking the natural logarithm of both sides gives a linear relationship:\n$$ -\\frac{h_i}{\\theta} = \\ln\\left(\\frac{25.000 - \\hat{\\gamma}(h_i)}{20.000}\\right) $$\nLet us define a transformed variable $y_i = \\ln\\left(\\frac{25.000 - \\hat{\\gamma}(h_i)}{20.000}\\right)$ and a slope $m = -1/\\theta$. The model becomes a linear equation forced through the origin:\n$$ y_i = m \\cdot h_i $$\nThe associated objective minimized in this transformed space is the sum of squared residuals for the linear model:\n$$ L(m) = \\sum_{i=1}^{4} (y_i - m h_i)^2 $$\nTo find the value of $m$ that minimizes $L(m)$, we take the derivative with respect to $m$ and set it to zero:\n$$ \\frac{dL}{dm} = \\sum_{i=1}^{4} 2(y_i - m h_i)(-h_i) = 0 $$\n$$ \\sum_{i=1}^{4} (-y_i h_i + m h_i^2) = 0 $$\n$$ m \\sum_{i=1}^{4} h_i^2 = \\sum_{i=1}^{4} y_i h_i $$\nThe least-squares estimate for the slope $m$ is therefore:\n$$ m = \\frac{\\sum_{i=1}^{4} y_i h_i}{\\sum_{i=1}^{4} h_i^2} $$\nWe now compute the necessary values from the provided data.\nFirst, we calculate the transformed variables $y_i$:\n- For $h_1=0.5$: $y_1 = \\ln\\left(\\frac{25.000 - 10.66938}{20.000}\\right) = \\ln(0.716531) \\approx -0.333334$\n- For $h_2=1.0$: $y_2 = \\ln\\left(\\frac{25.000 - 14.73166}{20.000}\\right) = \\ln(0.513417) \\approx -0.666667$\n- For $h_3=2.0$: $y_3 = \\ln\\left(\\frac{25.000 - 19.72806}{20.000}\\right) = \\ln(0.263597) \\approx -1.333331$\n- For $h_4=4.0$: $y_4 = \\ln\\left(\\frac{25.000 - 23.61033}{20.000}\\right) = \\ln(0.0694835) \\approx -2.666669$\n\nNext, we compute the sums $\\sum y_i h_i$ and $\\sum h_i^2$:\n- $\\sum h_i^2 = (0.5)^2 + (1.0)^2 + (2.0)^2 + (4.0)^2 = 0.25 + 1.0 + 4.0 + 16.0 = 21.25$\n- $\\sum y_i h_i = (-0.333334)(0.5) + (-0.666667)(1.0) + (-1.333331)(2.0) + (-2.666669)(4.0)$\n  $\\sum y_i h_i = -0.166667 - 0.666667 - 2.666662 - 10.666676 = -14.166672$\n\nNow we calculate the slope $m$:\n$$ m = \\frac{-14.166672}{21.25} \\approx -0.666666917 $$\nThis value is evidently $m = -2/3$.\nFinally, we estimate the correlation length $\\theta$ from the slope $m$:\n$$ \\theta = -\\frac{1}{m} = -\\frac{1}{-2/3} = \\frac{3}{2} = 1.5 $$\nSo, the estimate for the correlation length is $\\theta = 1.5$ meters.\n\nThe estimated parameters are the correlation length $\\theta$ and the nugget effect $c_0$. The value for $c_0$ was given directly in the problem statement. Rounding to four significant figures as requested:\n- $\\theta = 1.500$ m\n- $c_0 = 5.000$ $(\\text{kPa})^2$\n\nThe final answer consists of these two values.", "answer": "$$ \\boxed{ \\begin{pmatrix} 1.500 & 5.000 \\end{pmatrix} } $$", "id": "3563275"}, {"introduction": "A continuous random field must be adapted for a discrete finite element mesh, a step often achieved by assigning an averaged property to each element. This averaging has important theoretical consequences, which this exercise [@problem_id:3563295] explores by having you derive how the variance of a material property is reduced as the averaging domain size increases. Understanding this relationship is fundamental to correctly interpreting the results of discretized stochastic models.", "problem": "Consider a two-dimensional geomechanical domain in which the spatial variability of Young’s modulus is modeled by a second-order stationary random field $E(\\boldsymbol{x},\\omega)$ with mean $\\mu_{E}$ and variance $\\sigma_{E}^{2}$, where $\\boldsymbol{x} \\in \\mathbb{R}^{2}$ and $\\omega$ denotes the outcome in the underlying probability space. In the Stochastic Finite Element Method (SFEM), an element-level effective property is often defined by the spatial average $\\bar{E}_{A} = |A|^{-1} \\int_{A} E(\\boldsymbol{x},\\omega)\\,d\\boldsymbol{x}$ over the element domain $A$. Assume $A$ is a rectangle $[0,L_{x}] \\times [0,L_{y}]$ with area $|A| = L_{x}L_{y}$, and that the covariance of $E$ is the anisotropic, separable exponential kernel\n$$\nC(\\boldsymbol{r}) = \\operatorname{Cov}\\big(E(\\boldsymbol{x},\\omega),E(\\boldsymbol{x}+\\boldsymbol{r},\\omega)\\big) = \\sigma_{E}^{2}\\,\\exp\\!\\big(-|r_{x}|/a_{x}\\big)\\,\\exp\\!\\big(-|r_{y}|/a_{y}\\big),\n$$\nwhere $\\boldsymbol{r} = (r_{x},r_{y})$, and $a_{x}>0$, $a_{y}>0$ are correlation lengths along the $x$ and $y$ directions, respectively.\n\nStarting from the definitions of spatial averaging and covariance for second-order stationary random fields, derive an exact, closed-form expression for the variance of the spatial average $\\bar{E}_{A}$ over the rectangular domain $A$ in terms of $L_{x}$, $L_{y}$, $a_{x}$, $a_{y}$, and $\\sigma_{E}^{2}$. Then, using only the derived formula and standard asymptotics of the exponential function, explain how the variance scales as the averaging area increases, particularly in the regime $L_{x}\\gg a_{x}$ and $L_{y}\\gg a_{y}$.\n\nProvide your final result as a single analytic expression for $\\operatorname{Var}(\\bar{E}_{A})$ in terms of $L_{x}$, $L_{y}$, $a_{x}$, $a_{y}$, and $\\sigma_{E}^{2}$. Do not include units in your final expression and do not perform any numerical rounding.", "solution": "The problem is scientifically grounded, well-posed, and all necessary information for its resolution is provided. We can therefore proceed with the derivation.\n\nThe variance of the spatial average $\\bar{E}_{A}$ is given by the general formula for a second-order stationary random field $E(\\boldsymbol{x},\\omega)$:\n$$\n\\operatorname{Var}(\\bar{E}_{A}) = \\operatorname{Var}\\left(\\frac{1}{|A|} \\int_A E(\\boldsymbol{x},\\omega) \\,d\\boldsymbol{x}\\right) = \\frac{1}{|A|^2} \\int_A \\int_A \\operatorname{Cov}\\big(E(\\boldsymbol{x}_1,\\omega), E(\\boldsymbol{x}_2,\\omega)\\big) \\,d\\boldsymbol{x}_1 \\,d\\boldsymbol{x}_2\n$$\nDue to stationarity, the covariance depends only on the separation vector $\\boldsymbol{r} = \\boldsymbol{x}_1 - \\boldsymbol{x}_2$. Let $\\operatorname{Cov}\\big(E(\\boldsymbol{x}_1,\\omega), E(\\boldsymbol{x}_2,\\omega)\\big) = C(\\boldsymbol{x}_1 - \\boldsymbol{x}_2)$. The variance becomes:\n$$\n\\operatorname{Var}(\\bar{E}_{A}) = \\frac{1}{|A|^2} \\int_A \\int_A C(\\boldsymbol{x}_1 - \\boldsymbol{x}_2) \\,d\\boldsymbol{x}_1 \\,d\\boldsymbol{x}_2\n$$\nThe problem specifies the domain $A$ as a rectangle $[0,L_{x}] \\times [0,L_{y}]$, so its area is $|A| = L_x L_y$. The covariance function is the anisotropic, separable exponential kernel:\n$$\nC(\\boldsymbol{r}) = \\sigma_{E}^{2}\\,\\exp\\!\\big(-|r_{x}|/a_{x}\\big)\\,\\exp\\!\\big(-|r_{y}|/a_{y}\\big)\n$$\nwhere $\\boldsymbol{r} = (r_x, r_y)$. Let $\\boldsymbol{x}_1 = (x_1, y_1)$ and $\\boldsymbol{x}_2 = (x_2, y_2)$. The variance expression is a quadruple integral:\n$$\n\\operatorname{Var}(\\bar{E}_{A}) = \\frac{\\sigma_{E}^{2}}{(L_x L_y)^2} \\int_{0}^{L_y} \\int_{0}^{L_x} \\int_{0}^{L_y} \\int_{0}^{L_x} \\exp\\left(-\\frac{|x_1 - x_2|}{a_x}\\right) \\exp\\left(-\\frac{|y_1 - y_2|}{a_y}\\right) \\,dx_2 \\,dy_2 \\,dx_1 \\,dy_1\n$$\nBecause the integrand and the domain of integration are separable, we can factor the quadruple integral into a product of two double integrals:\n$$\n\\operatorname{Var}(\\bar{E}_{A}) = \\sigma_{E}^{2} \\left[ \\frac{1}{L_x^2} \\int_{0}^{L_x} \\int_{0}^{L_x} \\exp\\left(-\\frac{|x_1 - x_2|}{a_x}\\right) \\,dx_1 \\,dx_2 \\right] \\left[ \\frac{1}{L_y^2} \\int_{0}^{L_y} \\int_{0}^{L_y} \\exp\\left(-\\frac{|y_1 - y_2|}{a_y}\\right) \\,dy_1 \\,dy_2 \\right]\n$$\nBoth terms in brackets have the same functional form. Let's solve the general $1$-dimensional case:\n$$\nI(L, a) = \\int_{0}^{L} \\int_{0}^{L} \\exp\\left(-\\frac{|u - v|}{a}\\right) \\,du \\,dv\n$$\nThe domain of integration is a square of side $L$ in the $(u,v)$-plane. The integrand is symmetric with respect to the line $u=v$. We can integrate over the triangular region where $0 \\le v \\le u \\le L$ and multiply the result by $2$:\n$$\nI(L, a) = 2 \\int_{0}^{L} \\left[ \\int_{0}^{u} \\exp\\left(-\\frac{u-v}{a}\\right) \\,dv \\right] \\,du\n$$\nFirst, we solve the inner integral with respect to $v$:\n$$\n\\int_{0}^{u} \\exp\\left(-\\frac{u-v}{a}\\right) \\,dv = \\exp\\left(-\\frac{u}{a}\\right) \\int_{0}^{u} \\exp\\left(\\frac{v}{a}\\right) \\,dv = \\exp\\left(-\\frac{u}{a}\\right) \\left[ a\\exp\\left(\\frac{v}{a}\\right) \\right]_{v=0}^{v=u}\n$$\n$$\n= \\exp\\left(-\\frac{u}{a}\\right) \\left( a\\exp\\left(\\frac{u}{a}\\right) - a\\exp(0) \\right) = a \\left(1 - \\exp\\left(-\\frac{u}{a}\\right)\\right)\n$$\nNext, we substitute this result into the outer integral with respect to $u$:\n$$\nI(L, a) = 2 \\int_{0}^{L} a \\left(1 - \\exp\\left(-\\frac{u}{a}\\right)\\right) \\,du = 2a \\left[ u - \\left(-a\\exp\\left(-\\frac{u}{a}\\right)\\right) \\right]_{0}^{L}\n$$\n$$\n= 2a \\left[ u + a\\exp\\left(-\\frac{u}{a}\\right) \\right]_{0}^{L} = 2a \\left[ \\left( L + a\\exp\\left(-\\frac{L}{a}\\right) \\right) - \\left( 0 + a\\exp(0) \\right) \\right]\n$$\n$$\n= 2a \\left( L + a\\exp\\left(-\\frac{L}{a}\\right) - a \\right) = 2a^2 \\left( \\frac{L}{a} - 1 + \\exp\\left(-\\frac{L}{a}\\right) \\right)\n$$\nNow we can write the expression for the variance. The factor in the brackets for the $x$-direction is $\\frac{1}{L_x^2}I(L_x, a_x)$ and for the $y$-direction is $\\frac{1}{L_y^2}I(L_y, a_y)$.\n$$\n\\frac{I(L_x, a_x)}{L_x^2} = \\frac{2a_x^2}{L_x^2} \\left( \\frac{L_x}{a_x} - 1 + \\exp\\left(-\\frac{L_x}{a_x}\\right) \\right)\n$$\n$$\n\\frac{I(L_y, a_y)}{L_y^2} = \\frac{2a_y^2}{L_y^2} \\left( \\frac{L_y}{a_y} - 1 + \\exp\\left(-\\frac{L_y}{a_y}\\right) \\right)\n$$\nMultiplying these factors and $\\sigma_E^2$ gives the exact, closed-form expression for the variance of the spatial average:\n$$\n\\operatorname{Var}(\\bar{E}_{A}) = \\sigma_{E}^{2} \\left[ \\frac{2a_x^2}{L_x^2} \\left( \\frac{L_x}{a_x} - 1 + \\exp\\left(-\\frac{L_x}{a_x}\\right) \\right) \\right] \\left[ \\frac{2a_y^2}{L_y^2} \\left( \\frac{L_y}{a_y} - 1 + \\exp\\left(-\\frac{L_y}{a_y}\\right) \\right) \\right]\n$$\n$$\n\\operatorname{Var}(\\bar{E}_{A}) = 4\\sigma_{E}^{2} \\frac{a_x^2 a_y^2}{L_x^2 L_y^2} \\left( \\frac{L_x}{a_x} - 1 + \\exp\\left(-\\frac{L_x}{a_x}\\right) \\right) \\left( \\frac{L_y}{a_y} - 1 + \\exp\\left(-\\frac{L_y}{a_y}\\right) \\right)\n$$\nThis is the final analytical expression.\n\nFor the second part of the question, we analyze the scaling of this variance in the regime where the averaging area is much larger than the correlation lengths, i.e., $L_x \\gg a_x$ and $L_y \\gg a_y$. This corresponds to the limits $L_x/a_x \\to \\infty$ and $L_y/a_y \\to \\infty$.\nLet's examine the behavior of the dimensionless term $\\left( \\frac{L}{a} - 1 + \\exp\\left(-\\frac{L}{a}\\right) \\right)$ as $\\frac{L}{a} \\to \\infty$.\nUsing the standard asymptotics of the exponential function, $\\lim_{z \\to \\infty} \\exp(-z) = 0$. In our case, $z=L/a$, so the term $\\exp(-L/a)$ vanishes.\nThe expression in the parenthesis becomes $\\left(\\frac{L}{a} - 1\\right)$. For $L/a \\gg 1$, this is well approximated by $\\frac{L}{a}$.\nTherefore, for $L_x \\gg a_x$:\n$$\n\\frac{2a_x^2}{L_x^2} \\left( \\frac{L_x}{a_x} - 1 + \\exp\\left(-\\frac{L_x}{a_x}\\right) \\right) \\approx \\frac{2a_x^2}{L_x^2} \\left( \\frac{L_x}{a_x} \\right) = \\frac{2a_x}{L_x}\n$$\nAnd similarly for $L_y \\gg a_y$:\n$$\n\\frac{2a_y^2}{L_y^2} \\left( \\frac{L_y}{a_y} - 1 + \\exp\\left(-\\frac{L_y}{a_y}\\right) \\right) \\approx \\frac{2a_y^2}{L_y^2} \\left( \\frac{L_y}{a_y} \\right) = \\frac{2a_y}{L_y}\n$$\nSubstituting these asymptotic forms back into the expression for $\\operatorname{Var}(\\bar{E}_{A})$:\n$$\n\\operatorname{Var}(\\bar{E}_{A}) \\approx \\sigma_{E}^{2} \\left( \\frac{2a_x}{L_x} \\right) \\left( \\frac{2a_y}{L_y} \\right) = \\frac{4\\sigma_{E}^{2} a_x a_y}{L_x L_y}\n$$\nSince the averaging area is $|A| = L_x L_y$, we have:\n$$\n\\operatorname{Var}(\\bar{E}_{A}) \\approx \\frac{4\\sigma_{E}^{2} a_x a_y}{|A|}\n$$\nThis result shows that as the averaging area $|A|$ increases, the variance of the spatial average, $\\operatorname{Var}(\\bar{E}_{A})$, decreases in inverse proportion to the area, i.e., $\\operatorname{Var}(\\bar{E}_{A}) \\propto |A|^{-1}$. This is a manifestation of the law of large numbers for correlated random fields, where the variance reduction is governed by the ratio of a \"correlation area\" (related to $a_x a_y$) to the total averaging area.", "answer": "$$\n\\boxed{4\\sigma_{E}^{2} \\frac{a_x^2 a_y^2}{L_x^2 L_y^2} \\left( \\frac{L_x}{a_x} - 1 + \\exp\\left(-\\frac{L_x}{a_x}\\right) \\right) \\left( \\frac{L_y}{a_y} - 1 + \\exp\\left(-\\frac{L_y}{a_y}\\right) \\right)}\n$$", "id": "3563295"}, {"introduction": "The Monte Carlo method is a powerful tool for uncertainty propagation, but its computational cost requires careful planning. This final practice [@problem_id:3563260] addresses the critical question of how many simulations are sufficient for a reliable analysis. You will derive the formula for the required sample size based on statistical principles, an essential skill for designing SFEM studies that are both accurate and computationally feasible.", "problem": "A square shallow foundation of width $B$ resting on an elastoplastic soil layer is analyzed using the Stochastic Finite Element Method (SFEM), where spatial variability of the Young's modulus field is modeled as a second-order stationary random field with finite variance and finite fourth moment. Each Monte Carlo (MC) realization samples an independent field, solves the Finite Element Method (FEM) boundary value problem, and outputs the settlement $S$ at the center of the foundation. Let $S$ be a positive random variable with finite mean $\\mu_{s}$ and variance $\\sigma_{s}^{2}$. Define the MC estimators of mean settlement and variance as the sample mean $\\bar{S}_{N}$ and the Bessel-corrected sample variance $\\hat{\\sigma}_{s,N}^{2}$ computed from $N$ independent FEM realizations.\n\nYou seek to choose the MC sample size $N$ such that the relative error of the mean settlement estimator satisfies the requirement that the half-width of a two-sided confidence interval for $\\mu_{s}$ is no greater than $\\epsilon\\,|\\mu_{s}|$ with confidence $1-\\alpha$. Assume the Central Limit Theorem (CLT) applies to $\\bar{S}_{N}$ and that the distribution of $S$ has finite fourth moment so that the Bessel-corrected sample variance is a consistent estimator of $\\sigma_{s}^{2}$. To operationalize the choice of $N$, you conduct an initial pilot run with $M$ independent realizations to obtain the pilot estimates $\\hat{\\mu}_{s,M}$ and $\\hat{\\sigma}_{s,M}$.\n\nStarting only from the definitions of the MC estimators, the independence of realizations, and the CLT, derive a closed-form expression for the required sample size $N$ in terms of the quantile $z_{1-\\alpha/2}$ of the standard normal distribution, the relative error target $\\epsilon$, and the pilot estimates $\\hat{\\mu}_{s,M}$ and $\\hat{\\sigma}_{s,M}$. Your expression must enforce the confidence requirement by bounding the half-width of the CLT-based confidence interval and must account for the integer nature of $N$.\n\nExpress your final answer as a single analytical expression for $N$. No numerical evaluation is needed. If you introduce any auxiliary notation, clearly define it. No intermediate or shortcut formulas are permitted. No units are required in the final answer.", "solution": "The problem is deemed valid as it is scientifically grounded in probability theory and statistics, well-posed, objective, and contains sufficient information for a unique solution. The context of Stochastic Finite Element Method (SFEM) in computational geomechanics is appropriate and the assumptions provided (applicability of the Central Limit Theorem, consistency of estimators) are standard for this class of analysis.\n\nThe objective is to derive an expression for the required number of Monte Carlo realizations, $N$, to estimate the mean settlement, $\\mu_s$, with a specified precision and confidence.\n\nLet $S_1, S_2, \\ldots, S_N$ be the sequence of settlement values obtained from $N$ independent and identically distributed (i.i.d.) Finite Element Method (FEM) realizations. Each $S_i$ is a random variable drawn from a distribution with true mean $E[S_i] = \\mu_s$ and true variance $\\operatorname{Var}(S_i) = \\sigma_s^2$. The problem states that $S$ is a positive random variable, implying $\\mu_s > 0$.\n\nThe Monte Carlo estimator for the mean settlement, $\\mu_s$, is the sample mean, $\\bar{S}_N$, defined as:\n$$ \\bar{S}_N = \\frac{1}{N} \\sum_{i=1}^{N} S_i $$\n\nThe expected value of this estimator is:\n$$ E[\\bar{S}_N] = E\\left[\\frac{1}{N} \\sum_{i=1}^{N} S_i\\right] = \\frac{1}{N} \\sum_{i=1}^{N} E[S_i] = \\frac{1}{N} (N \\mu_s) = \\mu_s $$\nThus, $\\bar{S}_N$ is an unbiased estimator of $\\mu_s$.\n\nThe variance of the estimator, using the i.i.d. property of the samples, is:\n$$ \\operatorname{Var}(\\bar{S}_N) = \\operatorname{Var}\\left(\\frac{1}{N} \\sum_{i=1}^{N} S_i\\right) = \\frac{1}{N^2} \\sum_{i=1}^{N} \\operatorname{Var}(S_i) = \\frac{1}{N^2} (N \\sigma_s^2) = \\frac{\\sigma_s^2}{N} $$\nThe standard deviation of the sample mean, also known as the standard error, is $\\text{SE}(\\bar{S}_N) = \\frac{\\sigma_s}{\\sqrt{N}}$.\n\nAccording to the Central Limit Theorem (CLT), which is assumed to apply, the distribution of the standardized sample mean converges to a standard normal distribution for a sufficiently large sample size $N$:\n$$ Z = \\frac{\\bar{S}_N - \\mu_s}{\\text{SE}(\\bar{S}_N)} = \\frac{\\bar{S}_N - \\mu_s}{\\sigma_s / \\sqrt{N}} \\xrightarrow{d} \\mathcal{N}(0,1) $$\nwhere $\\mathcal{N}(0,1)$ denotes the standard normal distribution.\n\nThis relationship is used to construct a two-sided confidence interval for $\\mu_s$ with a confidence level of $1-\\alpha$. Let $z_{1-\\alpha/2}$ be the upper $1-\\alpha/2$ quantile of the standard normal distribution, defined by $P(Z \\le z_{1-\\alpha/2}) = 1-\\alpha/2$, or equivalently, $P(-z_{1-\\alpha/2} \\le Z \\le z_{1-\\alpha/2}) = 1-\\alpha$.\n\nFrom the CLT, we can state the approximate probability:\n$$ P\\left(-z_{1-\\alpha/2} \\le \\frac{\\bar{S}_N - \\mu_s}{\\sigma_s / \\sqrt{N}} \\le z_{1-\\alpha/2}\\right) \\approx 1-\\alpha $$\nRearranging the inequality to isolate the true mean $\\mu_s$ yields the confidence interval:\n$$ P\\left(\\bar{S}_N - z_{1-\\alpha/2} \\frac{\\sigma_s}{\\sqrt{N}} \\le \\mu_s \\le \\bar{S}_N + z_{1-\\alpha/2} \\frac{\\sigma_s}{\\sqrt{N}}\\right) \\approx 1-\\alpha $$\nThe half-width, $H$, of this confidence interval is:\n$$ H = z_{1-\\alpha/2} \\frac{\\sigma_s}{\\sqrt{N}} $$\n\nThe problem requires that this half-width be no greater than a fraction $\\epsilon$ of the absolute value of the true mean, $\\epsilon |\\mu_s|$. Since the settlement $S$ is a positive random variable, its mean $\\mu_s$ is also positive, so $|\\mu_s| = \\mu_s$. The requirement is thus:\n$$ H \\le \\epsilon \\mu_s $$\nSubstituting the expression for $H$:\n$$ z_{1-\\alpha/2} \\frac{\\sigma_s}{\\sqrt{N}} \\le \\epsilon \\mu_s $$\n\nTo find the minimum required sample size $N$, we solve this inequality for $N$:\n$$ \\sqrt{N} \\ge \\frac{z_{1-\\alpha/2} \\sigma_s}{\\epsilon \\mu_s} $$\n$$ N \\ge \\left( \\frac{z_{1-\\alpha/2} \\sigma_s}{\\epsilon \\mu_s} \\right)^2 $$\n\nThis expression for the required sample size depends on the unknown population parameters $\\mu_s$ and $\\sigma_s$. To make this operational, we use estimates of these parameters obtained from a preliminary pilot study of size $M$. The problem provides the pilot estimates $\\hat{\\mu}_{s,M}$ and $\\hat{\\sigma}_{s,M}$. The problem states that the Bessel-corrected sample variance is a consistent estimator, implying that $\\hat{\\sigma}_{s,M}$ is a consistent estimator for $\\sigma_s$. The sample mean $\\hat{\\mu}_{s,M}$ is also a consistent estimator for $\\mu_s$.\n\nWe substitute these pilot estimates into the inequality:\n$$ N \\ge \\left( \\frac{z_{1-\\alpha/2} \\hat{\\sigma}_{s,M}}{\\epsilon \\hat{\\mu}_{s,M}} \\right)^2 $$\n\nSince the number of realizations, $N$, must be an integer, we must choose the smallest integer that satisfies this condition. This is achieved by taking the ceiling of the right-hand side of the inequality. The ceiling function, denoted $\\lceil x \\rceil$, gives the smallest integer greater than or equal to $x$.\n\nTherefore, the final expression for the required sample size $N$ is:\n$$ N = \\left\\lceil \\left( \\frac{z_{1-\\alpha/2} \\hat{\\sigma}_{s,M}}{\\epsilon \\hat{\\mu}_{s,M}} \\right)^2 \\right\\rceil $$\nThis expression provides the minimum number of Monte Carlo realizations needed to satisfy the specified precision and confidence requirements, based on the information from the pilot study.", "answer": "$$\n\\boxed{\nN = \\left\\lceil \\left( \\frac{z_{1-\\alpha/2} \\hat{\\sigma}_{s,M}}{\\epsilon \\hat{\\mu}_{s,M}} \\right)^{2} \\right\\rceil\n}\n$$", "id": "3563260"}]}