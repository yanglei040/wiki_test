{"hands_on_practices": [{"introduction": "This exercise grounds your understanding in the fundamental kinematics of finite deformation. By manually deriving the essential tensors for a simple shear case, you will build intuition for how material and spatial descriptions of strain differ and see how quantities used in Total and Updated Lagrangian formulations arise directly from the motion [@problem_id:3568060].", "problem": "Consider the finite simple shear mapping defined by $x_{1} = X_{1} + \\gamma X_{2}$, $x_{2} = X_{2}$, and $x_{3} = X_{3}$, where $\\gamma$ is a finite constant shear parameter, and $\\boldsymbol{x}$ and $\\boldsymbol{X}$ are the current and reference coordinates, respectively.\n\nStarting from standard continuum kinematics definitions, derive the deformation gradient $\\boldsymbol{F}$ associated with this motion. Then, using only tensorial kinematic definitions, derive the right Cauchy–Green deformation tensor $\\boldsymbol{C}$, the Green–Lagrange strain tensor $\\boldsymbol{E}$, the left Cauchy–Green deformation tensor $\\boldsymbol{b}$, and the Euler–Almansi strain tensor $\\boldsymbol{e}$, all expressed explicitly in terms of $\\gamma$.\n\nBriefly explain, in the context of the Total Lagrangian (TL) and Updated Lagrangian (UL) finite element formulations, which of these kinematic measures are naturally employed to evaluate strain measures for a finite $\\gamma$, and why.\n\nFinally, define the scalar\n$$\n\\Delta(\\gamma) := E_{22} - e_{22},\n$$\nwhere $E_{22}$ and $e_{22}$ denote the $\\left(2,2\\right)$ components of $\\boldsymbol{E}$ and $\\boldsymbol{e}$, respectively. Provide the exact closed-form expression for $\\Delta(\\gamma)$ in terms of $\\gamma$ only. Express your final answer as a symbolic expression with no units.", "solution": "First, we derive the deformation gradient tensor $\\boldsymbol{F}$, whose components are given by $F_{ij} = \\frac{\\partial x_i}{\\partial X_j}$. The provided motion is:\n$x_{1} = X_{1} + \\gamma X_{2}$\n$x_{2} = X_{2}$\n$x_{3} = X_{3}$\n\nThe components of $\\boldsymbol{F}$ are calculated as follows:\n$F_{11} = \\frac{\\partial x_1}{\\partial X_1} = 1$\n$F_{12} = \\frac{\\partial x_1}{\\partial X_2} = \\gamma$\n$F_{13} = \\frac{\\partial x_1}{\\partial X_3} = 0$\n$F_{21} = \\frac{\\partial x_2}{\\partial X_1} = 0$\n$F_{22} = \\frac{\\partial x_2}{\\partial X_2} = 1$\n$F_{23} = \\frac{\\partial x_2}{\\partial X_3} = 0$\n$F_{31} = \\frac{\\partial x_3}{\\partial X_1} = 0$\n$F_{32} = \\frac{\\partial x_3}{\\partial X_2} = 0$\n$F_{33} = \\frac{\\partial x_3}{\\partial X_3} = 1$\n\nExpressing $\\boldsymbol{F}$ in matrix form:\n$$\n\\boldsymbol{F} = \\begin{pmatrix} 1 & \\gamma & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}\n$$\n\nNext, we derive the right Cauchy–Green deformation tensor $\\boldsymbol{C}$ using its definition, $\\boldsymbol{C} = \\boldsymbol{F}^T \\boldsymbol{F}$.\n$$\n\\boldsymbol{C} = \\begin{pmatrix} 1 & 0 & 0 \\\\ \\gamma & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} \\begin{pmatrix} 1 & \\gamma & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} = \\begin{pmatrix} 1 & \\gamma & 0 \\\\ \\gamma & \\gamma^2 + 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}\n$$\n\nThe Green–Lagrange strain tensor $\\boldsymbol{E}$ is defined as $\\boldsymbol{E} = \\frac{1}{2}(\\boldsymbol{C} - \\boldsymbol{I})$, where $\\boldsymbol{I}$ is the second-order identity tensor.\n$$\n\\boldsymbol{E} = \\frac{1}{2} \\left( \\begin{pmatrix} 1 & \\gamma & 0 \\\\ \\gamma & \\gamma^2 + 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} - \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} \\right) = \\frac{1}{2} \\begin{pmatrix} 0 & \\gamma & 0 \\\\ \\gamma & \\gamma^2 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix}\n$$\n\nNow, we derive the left Cauchy–Green deformation tensor $\\boldsymbol{b}$, defined as $\\boldsymbol{b} = \\boldsymbol{F} \\boldsymbol{F}^T$.\n$$\n\\boldsymbol{b} = \\begin{pmatrix} 1 & \\gamma & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} \\begin{pmatrix} 1 & 0 & 0 \\\\ \\gamma & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} = \\begin{pmatrix} 1+\\gamma^2 & \\gamma & 0 \\\\ \\gamma & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}\n$$\n\nThe Euler–Almansi strain tensor $\\boldsymbol{e}$ is defined as $\\boldsymbol{e} = \\frac{1}{2}(\\boldsymbol{I} - \\boldsymbol{b}^{-1})$. First, we must find the inverse of $\\boldsymbol{b}$. The determinant is $\\det(\\boldsymbol{b}) = (1+\\gamma^2)(1) - (\\gamma)(\\gamma) = 1$. The inverse is:\n$$\n\\boldsymbol{b}^{-1} = \\frac{1}{\\det(\\boldsymbol{b})} \\begin{pmatrix} 1 & -\\gamma & 0 \\\\ -\\gamma & 1+\\gamma^2 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} = \\begin{pmatrix} 1 & -\\gamma & 0 \\\\ -\\gamma & 1+\\gamma^2 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}\n$$\nNow we can compute $\\boldsymbol{e}$:\n$$\n\\boldsymbol{e} = \\frac{1}{2} \\left( \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} - \\begin{pmatrix} 1 & -\\gamma & 0 \\\\ -\\gamma & 1+\\gamma^2 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} \\right) = \\frac{1}{2} \\begin{pmatrix} 0 & \\gamma & 0 \\\\ \\gamma & -\\gamma^2 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix}\n$$\n\nRegarding the Total Lagrangian (TL) and Updated Lagrangian (UL) formulations:\nIn the Total Lagrangian (TL) formulation, all balance laws and kinematic quantities are referred to the initial, undeformed reference configuration ($\\boldsymbol{X}$). The Green–Lagrange strain tensor $\\boldsymbol{E}$ is the natural measure of strain in this context because it is a material tensor, defined entirely with respect to the reference configuration. Physical vectors in the reference configuration are stretched and rotated into the current configuration, and $\\boldsymbol{E}$ precisely quantifies this strain relative to the initial state. The work-conjugate stress measure to $\\boldsymbol{E}$ is the 2nd Piola-Kirchhoff stress tensor $\\boldsymbol{S}$.\n\nIn the Updated Lagrangian (UL) formulation, all quantities are referred to the current, deformed configuration ($\\boldsymbol{x}$), which is continuously updated. The natural kinematic measure is the rate-of-deformation tensor $\\boldsymbol{d}$ (also denoted $\\boldsymbol{D}$), which is the symmetric part of the spatial velocity gradient. While the Euler–Almansi strain tensor $\\boldsymbol{e}$ is also defined on the current configuration, the UL formulation is typically implemented in a rate form. The rate of change of stress (e.g., the Jaumann rate of Cauchy stress) is related to the rate-of-deformation tensor $\\boldsymbol{d}$. Therefore, while $\\boldsymbol{e}$ and $\\boldsymbol{b}$ are conceptually associated with the current configuration (spatial description), the rate-of-deformation $\\boldsymbol{d}$ is the quantity directly employed in the incremental constitutive updates of a UL finite element code.\n\nFinally, we calculate $\\Delta(\\gamma) := E_{22} - e_{22}$.\nFrom our derivations, the $(2,2)$ component of the Green–Lagrange strain tensor is:\n$$\nE_{22} = \\frac{\\gamma^2}{2}\n$$\nAnd the $(2,2)$ component of the Euler–Almansi strain tensor is:\n$$\ne_{22} = -\\frac{\\gamma^2}{2}\n$$\nTherefore, the expression for $\\Delta(\\gamma)$ is:\n$$\n\\Delta(\\gamma) = E_{22} - e_{22} = \\frac{\\gamma^2}{2} - \\left(-\\frac{\\gamma^2}{2}\\right) = \\frac{\\gamma^2}{2} + \\frac{\\gamma^2}{2} = \\gamma^2\n$$\nThe exact closed-form expression for $\\Delta(\\gamma)$ is $\\gamma^2$.", "answer": "$$\n\\boxed{\\gamma^2}\n$$", "id": "3568060"}, {"introduction": "Building upon pure kinematics, this practice introduces a constitutive model to connect deformation with stress. You will compute the work-conjugate stress and strain pairs for both the Total Lagrangian ($\\boldsymbol{S}$ and $\\boldsymbol{E}$) and Updated Lagrangian ($\\boldsymbol{\\sigma}$ and $\\boldsymbol{e}$) descriptions, and verify their consistency through the push-forward operation, a cornerstone of large-deformation analysis [@problem_id:3568056].", "problem": "A homogeneous, isotropic, compressible Neo-Hookean solid undergoes a uniaxial stretch along the material axis $X_1$ such that the deformation gradient is $F=\\mathrm{diag}(\\lambda,1,1)$ with stretch ratio $\\lambda&gt;0$. Let the strain-energy density be specified in terms of the right Cauchy–Green deformation tensor $C=F^{\\mathsf{T}}F$ by\n$$\nW(C)=\\frac{\\mu}{2}\\left(I_1-3\\right)-\\mu\\ln J+\\frac{\\kappa}{2}\\left(\\ln J\\right)^2,\n$$\nwhere $\\mu$ is the shear modulus, $\\kappa$ is the bulk modulus, $I_1=\\mathrm{tr}\\,C$, and $J=\\det F$. Using the Total Lagrangian (TL) formulation, derive from first principles the Green–Lagrange strain $E$ and the Second Piola–Kirchhoff stress $S$ for this deformation. Then, using the Updated Lagrangian (UL) formulation for the same deformation state, derive the Euler–Almansi strain $e$ and the Cauchy stress $\\sigma$. Assume three-dimensional conditions and no body forces.\n\nStarting only from the kinematic definitions of the strain measures and the definition $S=2\\,\\partial W/\\partial C$, together with appropriate tensor push-forward relations between stress measures, derive the requested quantities and express your final results in terms of $\\lambda$, $\\mu$, and $\\kappa$. You must report the following six scalar quantities in the order\n$$\n\\left(E_{11},\\;S_{11},\\;S_{22},\\;\\sigma_{11},\\;\\sigma_{22},\\;e_{11}\\right).\n$$\n\nExpress your final answer as a single row matrix in closed form, as functions of $\\lambda$, $\\mu$, and $\\kappa$. No numerical substitution or rounding is required. Do not include physical units in the final reported row matrix.", "solution": "The deformation is homogeneous with $F=\\mathrm{diag}(\\lambda,1,1)$. The right Cauchy–Green deformation tensor is $C=F^{\\mathsf{T}}F=\\mathrm{diag}(\\lambda^2,1,1)$, and the Jacobian is $J=\\det F=\\lambda$. The left Cauchy–Green tensor is $b=F F^{\\mathsf{T}}=\\mathrm{diag}(\\lambda^2,1,1)$.\n\nBy definition, the Green–Lagrange strain in the Total Lagrangian (TL) formulation is\n$$\nE=\\frac{1}{2}\\left(C-I\\right),\n$$\nso for the given $C$,\n$$\nE=\\frac{1}{2}\\,\\mathrm{diag}\\left(\\lambda^2-1,\\,0,\\,0\\right),\n$$\nwhich yields the component\n$$\nE_{11}=\\frac{\\lambda^2-1}{2}.\n$$\n\nFor the compressible Neo-Hookean material with\n$$\nW(C)=\\frac{\\mu}{2}\\left(I_1-3\\right)-\\mu\\ln J+\\frac{\\kappa}{2}\\left(\\ln J\\right)^2,\n$$\nthe Second Piola–Kirchhoff stress is defined by\n$$\nS=2\\,\\frac{\\partial W}{\\partial C}.\n$$\nTo evaluate $\\partial W/\\partial C$, use the standard variations: $\\partial I_1/\\partial C=I$, and, since $J=\\det F$ and $\\det C=J^2$, one has $\\ln J=\\frac{1}{2}\\ln(\\det C)$ and\n$$\n\\frac{\\partial \\ln J}{\\partial C}=\\frac{1}{2}\\,C^{-1}.\n$$\nTherefore,\n$$\n\\frac{\\partial W}{\\partial C}=\\frac{\\mu}{2}\\,I-\\mu\\left(\\frac{1}{2}\\,C^{-1}\\right)+\\kappa\\left(\\ln J\\right)\\left(\\frac{1}{2}\\,C^{-1}\\right),\n$$\nand hence\n$$\nS=\\mu\\,I-\\mu\\,C^{-1}+\\kappa\\left(\\ln J\\right)C^{-1}.\n$$\nFor the present deformation, $C^{-1}=\\mathrm{diag}(\\lambda^{-2},1,1)$ and $\\ln J=\\ln\\lambda$, so\n$$\nS=\\mathrm{diag}\\!\\left(\\mu-\\mu\\lambda^{-2}+\\kappa\\lambda^{-2}\\ln\\lambda,\\;\\;\\kappa\\ln\\lambda,\\;\\;\\kappa\\ln\\lambda\\right).\n$$\nThus,\n$$\nS_{11}=\\mu\\left(1-\\lambda^{-2}\\right)+\\kappa\\,\\lambda^{-2}\\ln\\lambda,\\qquad S_{22}=\\kappa\\,\\ln\\lambda.\n$$\n\nTo obtain stresses in the Updated Lagrangian (UL) formulation, use the push-forward from $S$ to the Cauchy stress $\\sigma$:\n$$\n\\sigma=\\frac{1}{J}\\,F\\,S\\,F^{\\mathsf{T}}.\n$$\nWith diagonal $F$ and $S$, the Kirchhoff stress is $\\tau=F S F^{\\mathsf{T}}=\\mathrm{diag}\\!\\left(\\lambda^2 S_{11},\\,S_{22},\\,S_{33}\\right)$, and $\\sigma=\\tau/J$. Therefore,\n$$\n\\sigma_{11}=\\frac{\\lambda^2 S_{11}}{J}=\\frac{1}{\\lambda}\\left[\\mu\\left(\\lambda^2-1\\right)+\\kappa\\ln\\lambda\\right],\\qquad \\sigma_{22}=\\frac{S_{22}}{J}=\\frac{\\kappa\\ln\\lambda}{\\lambda}.\n$$\n\nIn the UL formulation, the Euler–Almansi strain is defined by\n$$\ne=\\frac{1}{2}\\left(I-b^{-1}\\right),\n$$\nand since $b=\\mathrm{diag}(\\lambda^2,1,1)$, one has $b^{-1}=\\mathrm{diag}(\\lambda^{-2},1,1)$, giving\n$$\ne=\\frac{1}{2}\\,\\mathrm{diag}\\left(1-\\lambda^{-2},\\,0,\\,0\\right),\n$$\nso\n$$\ne_{11}=\\frac{1-\\lambda^{-2}}{2}.\n$$\n\nCollecting the requested six scalar quantities in the specified order yields\n$$\n\\left(E_{11},\\;S_{11},\\;S_{22},\\;\\sigma_{11},\\;\\sigma_{22},\\;e_{11}\\right)\n=\n\\left(\\frac{\\lambda^2-1}{2},\\;\\mu\\left(1-\\lambda^{-2}\\right)+\\kappa\\,\\lambda^{-2}\\ln\\lambda,\\;\\kappa\\ln\\lambda,\\;\\frac{\\mu\\left(\\lambda^2-1\\right)+\\kappa\\ln\\lambda}{\\lambda},\\;\\frac{\\kappa\\ln\\lambda}{\\lambda},\\;\\frac{1-\\lambda^{-2}}{2}\\right).\n$$\n\nThis also demonstrates consistency between the Total Lagrangian and Updated Lagrangian predictions: the Second Piola–Kirchhoff stress $S$ pushes forward to the Cauchy stress $\\sigma$ via $\\sigma=J^{-1} F S F^{\\mathsf{T}}$, and the pair of strain measures $E$ and $e$ are related through their respective configurations for the same deformation state.", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{\\lambda^{2}-1}{2} & \\mu\\left(1-\\lambda^{-2}\\right)+\\kappa\\,\\lambda^{-2}\\ln\\lambda & \\kappa\\ln\\lambda & \\frac{\\mu\\left(\\lambda^{2}-1\\right)+\\kappa\\ln\\lambda}{\\lambda} & \\frac{\\kappa\\ln\\lambda}{\\lambda} & \\frac{1-\\lambda^{-2}}{2}\\end{pmatrix}}$$", "id": "3568056"}, {"introduction": "This computational exercise addresses a critical and subtle aspect of implementing UL formulations: the principle of material frame-indifference, or objectivity. You will programmatically verify that the TL formulation is inherently objective under rigid body rotation and explore why a UL formulation requires a corotational stress rate (like the Jaumann rate) to avoid producing spurious, non-physical stresses [@problem_id:3568053].", "problem": "Consider a homogeneous continuum body representing a triaxial specimen undergoing a prescribed rigid body rotation with constant angular velocity. The goal is to verify invariance of stress measures under rigid body motion using the Total Lagrangian (TL) and Updated Lagrangian (UL) formulations, and to assess the consequences of using an objective versus a non-objective stress rate. The derivation and implementation must start from fundamental kinematics and balance principles and must not rely on shortcut formulas beyond those defined from first principles.\n\nBegin with the kinematics of a continuum. Let the motion be described by the deformation gradient $F$, where $F = \\partial x / \\partial X$. For a rigid body rotation with no stretch, the polar decomposition reduces to $F = R$, where $R$ is a proper orthogonal rotation tensor satisfying $R^{\\mathsf{T}} R = I$ and $\\det R = +1$. The Green-Lagrange strain tensor is $E = \\tfrac{1}{2} \\left( C - I \\right)$, with $C = F^{\\mathsf{T}} F$. For a rigid rotation, $C = I$ and hence $E = 0$. In a Total Lagrangian formulation with a linear elastic constitutive law in the reference configuration, the second Piola-Kirchhoff stress $S$ satisfies $S = \\mathbb{C} : E$, where $\\mathbb{C}$ is the fourth-order elasticity tensor for an isotropic linear elastic material. The Cauchy stress $\\sigma$ follows from a push-forward, with $\\sigma = \\tfrac{1}{J} R S R^{\\mathsf{T}}$, and $J = \\det F$. For a rigid rotation, $J = 1$. Therefore, under a pure rigid rotation with no stretch, a correctly implemented Total Lagrangian update must yield $\\sigma = 0$ everywhere when starting from a stress-free state.\n\nIn an Updated Lagrangian setting, consider the spatial velocity gradient $L = \\dot{F} F^{-1}$ decomposed into the symmetric rate-of-deformation tensor $D = \\tfrac{1}{2} \\left( L + L^{\\mathsf{T}} \\right)$ and the skew-symmetric spin tensor $W = \\tfrac{1}{2} \\left( L - L^{\\mathsf{T}} \\right)$. For a rigid body rotation with angular velocity vector $\\omega$, $D = 0$ and $W$ represents the skew tensor associated with $\\omega$, i.e., $W v = \\omega \\times v$ for any vector $v$. Objectivity of stress rates requires that the constitutive rate form be defined in terms of an objective stress rate. For example, the Jaumann rate of the Cauchy stress is $\\sigma^{\\nabla \\mathrm{J}} = \\dot{\\sigma} - W \\sigma + \\sigma W$. For a rigid rotation with $D = 0$, an objective rate implies $\\sigma^{\\nabla \\mathrm{J}} = 0$ and hence the exact evolution in the spatial frame satisfies $\\dot{\\sigma} = W \\sigma - \\sigma W$, yielding $\\sigma(t) = R(t) \\, \\sigma(0) \\, R(t)^{\\mathsf{T}}$, where $R(t)$ solves $\\dot{R}(t) = W R(t)$ with $R(0) = I$. In contrast, a non-objective rate given by the simple material time derivative $\\dot{\\sigma}$ without the corotational terms fails to represent rigid rotation correctly when the initial stress is non-zero; it will not preserve the proper corotation of $\\sigma$ and thus introduces spurious stress components when assessed in the rotating body frame or when compared to the correct rotated stress.\n\nTasks:\n- Implement a program that performs the following verifications using the above principles for a body in three dimensions:\n  1. Total Lagrangian invariance test under a finite rigid rotation: construct $F = R$ for a finite rotation and compute the Green-Lagrange strain $E$. Using an isotropic linear elastic law in the reference configuration with Young’s modulus $E_{\\mathrm{Y}}$ and Poisson’s ratio $\\nu$, compute $S = \\mathbb{C} : E$ and push it forward to obtain $\\sigma = R S R^{\\mathsf{T}}$ (with $J = 1$). Report whether the Frobenius norm of $\\sigma$ is below a tolerance $T_{\\mathrm{tol}}$.\n  2. Updated Lagrangian invariance test with an objective rate (Jaumann): start from a specified initial Cauchy stress $\\sigma_0$ and integrate the stress evolution under a rigid rotation with constant spin tensor $W$ (equivalently constant angular velocity vector $\\omega$) for time $T$, using the exact corotational update $\\sigma_{n+1} = R(\\Delta t) \\, \\sigma_{n} \\, R(\\Delta t)^{\\mathsf{T}}$ at each step. Compare the numerical result to the exact $\\sigma_{\\mathrm{exact}}(T) = R(T) \\, \\sigma_0 \\, R(T)^{\\mathsf{T}}$ and report the Frobenius norm of the error. This implements the objective Jaumann rate for $D = 0$.\n  3. Updated Lagrangian failure with a non-objective rate: for the same rigid rotation, set $\\dot{\\sigma} = 0$ whenever $D = 0$ (i.e., ignore the corotational transport terms). Then $\\sigma(t) \\equiv \\sigma_0$. Compare this non-objective result to $\\sigma_{\\mathrm{exact}}(T)$ and report the Frobenius norm of the error, which quantifies spurious stresses.\n  4. Edge case with zero spin: verify that when $\\omega = 0$, the Jaumann-based update reproduces $\\sigma(t) = \\sigma_0$ exactly, yielding an error below tolerance $T_{\\mathrm{tol}}$.\n\nUse the following fundamental bases and parameter values (test suite):\n- Material parameters for the Total Lagrangian test: Young’s modulus $E_{\\mathrm{Y}} = 10000 \\, \\mathrm{kPa}$ and Poisson’s ratio $\\nu = 0.25$. These values define the isotropic elasticity tensor $\\mathbb{C}$ in the reference configuration for the relation $S = \\mathbb{C} : E$.\n- Rotation kinematics:\n  - For the Total Lagrangian test, use a finite rotation about the $z$-axis with angle $\\theta = \\pi / 3 \\, \\mathrm{rad}$, so that $F = R(\\theta)$ and $J = 1$.\n  - For the Updated Lagrangian tests, use a constant angular velocity vector $\\omega = \\left[ 0, 0, \\omega_z \\right]^{\\mathsf{T}}$ with $\\omega_z = \\pi \\, \\mathrm{rad}/\\mathrm{s}$, integrated over time $T = 0.5 \\, \\mathrm{s}$, so the total rotation angle is $\\theta = \\omega_z T = \\pi / 2 \\, \\mathrm{rad}$. Use a uniform time step $\\Delta t = 0.01 \\, \\mathrm{s}$ for the stepwise update in the Jaumann implementation. Angles must be treated in radians.\n- Initial Cauchy stress for the Updated Lagrangian tests: $\\sigma_0 = \\mathrm{diag}(120, 80, 60) \\, \\mathrm{kPa}$, which represents a general triaxial state with distinct principal values.\n- Tolerance: $T_{\\mathrm{tol}} = 10^{-10} \\, \\mathrm{kPa}$.\n\nPrecise computational requirements:\n- Compute the rotation matrix about the $z$-axis by angle $\\theta$ as\n$$\nR(\\theta) =\n\\begin{bmatrix}\n\\cos \\theta & - \\sin \\theta & 0 \\\\\n\\sin \\theta & \\cos \\theta & 0 \\\\\n0 & 0 & 1\n\\end{bmatrix}.\n$$\n- For the Total Lagrangian test, compute $E = \\tfrac{1}{2} \\left( R^{\\mathsf{T}} R - I \\right)$, then $S = \\mathbb{C} : E$, and finally $\\sigma = R S R^{\\mathsf{T}}$.\n- For the Updated Lagrangian test with the Jaumann rate and $D = 0$, implement the exact corotational update at each time step $\\Delta t$: $\\sigma_{n+1} = R(\\omega_z \\Delta t) \\, \\sigma_n \\, R(\\omega_z \\Delta t)^{\\mathsf{T}}$. After $N = T / \\Delta t$ steps, obtain the numerical $\\sigma_{\\mathrm{J}}(T)$ and compare to $\\sigma_{\\mathrm{exact}}(T) = R(\\omega_z T) \\, \\sigma_0 \\, R(\\omega_z T)^{\\mathsf{T}}$. Report the Frobenius norm $\\lVert \\sigma_{\\mathrm{J}}(T) - \\sigma_{\\mathrm{exact}}(T) \\rVert_{\\mathrm{F}}$ in $\\mathrm{kPa}$.\n- For the Updated Lagrangian non-objective test, set $\\sigma_{\\mathrm{NO}}(T) = \\sigma_0$. Report the Frobenius norm $\\lVert \\sigma_{\\mathrm{NO}}(T) - \\sigma_{\\mathrm{exact}}(T) \\rVert_{\\mathrm{F}}$ in $\\mathrm{kPa}$.\n- Edge case: set $\\omega_z = 0$ and $T = 0.5 \\, \\mathrm{s}$, and verify that the Jaumann-based update produces an error below $T_{\\mathrm{tol}}$.\n\nUnits and formatting:\n- All stresses must be in $\\mathrm{kPa}$, time in $\\mathrm{s}$, and angles in $\\mathrm{rad}$.\n- Your program must output a single line containing a list with four entries corresponding to:\n  - Entry $1$: a boolean for the Total Lagrangian invariance test, equal to $\\mathrm{True}$ if $\\lVert \\sigma \\rVert_{\\mathrm{F}} \\le T_{\\mathrm{tol}}$, otherwise $\\mathrm{False}$.\n  - Entry $2$: a floating-point number equal to $\\lVert \\sigma_{\\mathrm{J}}(T) - \\sigma_{\\mathrm{exact}}(T) \\rVert_{\\mathrm{F}}$ in $\\mathrm{kPa}$, for the Jaumann Updated Lagrangian test with $\\omega_z = \\pi \\, \\mathrm{rad}/\\mathrm{s}$ and $T = 0.5 \\, \\mathrm{s}$.\n  - Entry $3$: a floating-point number equal to $\\lVert \\sigma_{\\mathrm{NO}}(T) - \\sigma_{\\mathrm{exact}}(T) \\rVert_{\\mathrm{F}}$ in $\\mathrm{kPa}$, for the non-objective Updated Lagrangian test with the same $\\omega_z$ and $T$.\n  - Entry $4$: a boolean for the zero-spin edge case, equal to $\\mathrm{True}$ if the Jaumann-based error is $\\le T_{\\mathrm{tol}}$, otherwise $\\mathrm{False}$.\n- The program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example `[True, e_1, e_2, True]`, where $e_1$ and $e_2$ are floating-point numbers in $\\mathrm{kPa}$. Round floating-point outputs to 6 decimal places in the final printout.\n\nNo user input is allowed; all data must be embedded in the program. The solution must strictly follow the definitions and laws stated above, without introducing any shortcut formulas beyond these fundamentals.", "solution": "The problem requires verification of fundamental principles of continuum mechanics related to material frame-indifference, also known as objectivity, using Total Lagrangian (TL) and Updated Lagrangian (UL) formulations. We will analyze the stress response of a continuum body subjected to a pure rigid body rotation, where no real deformation occurs. An objective formulation must correctly predict zero stress generation in a stress-free body and the proper corotation of an existing stress field, without introducing spurious stresses.\n\nThe analysis is divided into four distinct computational tasks. We will address each one by first stating the underlying principle and then detailing the calculation.\n\n**1. Total Lagrangian (TL) Invariance Test**\n\nIn a Total Lagrangian formulation, all kinematic and mechanical variables are referred to the initial, undeformed reference configuration. The deformation is measured by the deformation gradient $F = \\partial x / \\partial X$, where $X$ are the material coordinates in the reference configuration and $x$ are the spatial coordinates in the current configuration.\n\nFor a pure rigid body rotation without any stretching, the deformation gradient is a proper orthogonal rotation tensor, $F = R$, where $R$ satisfies $R^{\\mathsf{T}} R = I$ and $\\det R = +1$.\n\nThe strain is quantified by the Green-Lagrange strain tensor $E$, defined as:\n$$E = \\frac{1}{2} (F^{\\mathsf{T}} F - I)$$\nSubstituting $F=R$ for the rigid rotation, we find:\n$$E = \\frac{1}{2} (R^{\\mathsf{T}} R - I) = \\frac{1}{2} (I - I) = 0$$\nThe strain tensor is exactly zero. The problem specifies a linear elastic constitutive law relating the second Piola-Kirchhoff stress $S$ to the Green-Lagrange strain $E$ via the fourth-order elasticity tensor $\\mathbb{C}$: $S = \\mathbb{C} : E$. Since $E$ is the zero tensor, the resulting stress $S$ must also be the zero tensor, $S=0$, regardless of the specific components of $\\mathbb{C}$ (which depend on Young's modulus $E_{\\mathrm{Y}}$ and Poisson's ratio $\\nu$).\n\nThe Cauchy stress $\\sigma$, which represents the true stress in the current (deformed) configuration, is obtained by a push-forward operation on $S$:\n$$\\sigma = \\frac{1}{J} R S R^{\\mathsf{T}}$$\nwhere $J = \\det F$. For a rigid rotation, $F=R$, so $J = \\det R = 1$. With $S=0$, the Cauchy stress is:\n$$\\sigma = R (0) R^{\\mathsf{T}} = 0$$\nThis demonstrates that a TL formulation inherently satisfies objectivity for this case; a rigid rotation of a stress-free body induces no stress. The first task is to verify this numerically. We compute $\\sigma$ based on a given rotation $R(\\theta = \\pi/3)$ and confirm that its Frobenius norm, $\\lVert \\sigma \\rVert_{\\mathrm{F}}$, is within a numerical tolerance $T_{\\mathrm{tol}} = 10^{-10} \\, \\mathrm{kPa}$ of zero.\n\n**2. Updated Lagrangian (UL) Formulations and Objective Stress Rates**\n\nIn an Updated Lagrangian formulation, the reference state is the current configuration, and we work with rates of quantities. A key challenge is defining a stress rate that is objective, i.e., indifferent to the observer's frame of reference. The simple material time derivative of Cauchy stress, $\\dot{\\sigma}$, is not objective. An objective stress rate must be used in the constitutive model. The problem considers the Jaumann rate, defined as:\n$$\\sigma^{\\nabla \\mathrm{J}} = \\dot{\\sigma} - W \\sigma + \\sigma W$$\nwhere $W$ is the spin tensor, the skew-symmetric part of the velocity gradient $L$. For a rigid body motion, the rate-of-deformation tensor $D$ (the symmetric part of $L$) is zero. An objective constitutive law must predict a zero objective stress rate when $D=0$. Thus, we set $\\sigma^{\\nabla \\mathrm{J}} = 0$, which leads to the following evolution equation for the Cauchy stress:\n$$\\dot{\\sigma} = W \\sigma - \\sigma W$$\nFor a constant angular velocity $\\omega$, the spin tensor $W$ is constant. The exact solution to this differential equation is:\n$$\\sigma(t) = R(t) \\sigma_0 R(t)^{\\mathsf{T}}$$\nwhere $\\sigma_0$ is the initial stress at $t=0$ and $R(t)$ is the rotation tensor corresponding to the motion, which solves $\\dot{R}(t) = W R(t)$ with $R(0) = I$.\n\n**2a. UL Invariance with an Objective (Jaumann) Rate**\n\nThe second task is to verify that a numerical scheme based on the objective Jaumann rate correctly handles rigid rotation. We start with an initial stress $\\sigma_0$ and integrate the stress evolution over a time $T$ using discrete time steps $\\Delta t$. The exact solution over a small time increment $\\Delta t$ is $\\sigma_{n+1} = R(\\Delta t) \\sigma_n R(\\Delta t)^{\\mathsf{T}}$, where $R(\\Delta t)$ is the incremental rotation. Applying this update for $N = T / \\Delta t$ steps, starting from $\\sigma_0$:\n$$\\sigma_N = R(\\Delta t) \\sigma_{N-1} R(\\Delta t)^{\\mathsf{T}} = \\dots = [R(\\Delta t)]^N \\sigma_0 ([R(\\Delta t)]^N)^{\\mathsf{T}}$$\nSince rotations about a fixed axis compose by adding angles, $[R(\\Delta t)]^N = R(N \\Delta t) = R(T)$. Therefore, the final numerically computed stress, $\\sigma_{\\mathrm{J}}(T)$, is:\n$$\\sigma_{\\mathrm{J}}(T) = R(T) \\sigma_0 R(T)^{\\mathsf{T}}$$\nThis is identical to the exact analytical solution, $\\sigma_{\\mathrm{exact}}(T)$. The numerical error, $\\lVert \\sigma_{\\mathrm{J}}(T) - \\sigma_{\\mathrm{exact}}(T) \\rVert_{\\mathrm{F}}$, is expected to be zero up to floating-point precision.\n\n**2b. UL Failure with a Non-Objective Rate**\n\nThe third task demonstrates the failure of a non-objective formulation. A naive approach might assume that if the deformation rate $D=0$, then the stress should not change, i.e., $\\dot{\\sigma}=0$. This incorrectly ignores the transport and rotation of the stress tensor with the material. This leads to the prediction $\\sigma_{\\mathrm{NO}}(T) = \\sigma_0$. The error committed by this non-objective formulation is the difference between this incorrect result and the true, rotated stress:\n$$\\mathrm{Error} = \\sigma_{\\mathrm{NO}}(T) - \\sigma_{\\mathrm{exact}}(T) = \\sigma_0 - R(T) \\sigma_0 R(T)^{\\mathsf{T}}$$\nThe Frobenius norm of this error, $\\lVert \\sigma_{\\mathrm{NO}}(T) - \\sigma_{\\mathrm{exact}}(T) \\rVert_{\\mathrm{F}}$, quantifies the spurious stresses generated. For a non-trivial rotation $R(T)$ and an initial stress $\\sigma_0$ that is not proportional to the identity matrix, this error will be non-zero.\n\n**2c. Edge Case with Zero Spin**\n\nThe final task verifies the behavior for a zero-spin case, where $\\omega=0$. Here, $W=0$ and $R(t)=I$ for all $t$.\nThe Jaumann evolution equation $\\dot{\\sigma} = W \\sigma - \\sigma W$ becomes $\\dot{\\sigma}=0$. The exact solution is $\\sigma_{\\mathrm{exact}}(T) = \\sigma_0$.\nThe numerical scheme with an incremental rotation $R(\\Delta t) = R(0) = I$ yields $\\sigma_{n+1} = I \\sigma_n I^{\\mathsf{T}} = \\sigma_n$, so the final numerical stress is also $\\sigma_{\\mathrm{J}}(T) = \\sigma_0$.\nThe error between the numerical and exact solutions is zero, confirming the formulation's consistency. The test is to check if this error norm is below the tolerance $T_{\\mathrm{tol}}$.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Performs verifications of Total and Updated Lagrangian formulations\n    under rigid body rotation as specified in the problem statement.\n    \"\"\"\n    # Define problem parameters\n    \n    # Material parameters (for conceptual completeness in TL, but not used in calculation)\n    # E_Y_val = 10000.0  # kPa\n    # nu_val = 0.25\n    \n    # Tolerance\n    T_tol = 1e-10  # kPa\n    \n    # Initial stress for UL tests\n    sigma_0_ul = np.diag([120.0, 80.0, 60.0])  # kPa\n\n    def get_R_z(theta_rad):\n        \"\"\"\n        Computes the 3D rotation matrix about the z-axis.\n        \n        Args:\n            theta_rad (float): Rotation angle in radians.\n            \n        Returns:\n            numpy.ndarray: The 3x3 rotation matrix.\n        \"\"\"\n        c = np.cos(theta_rad)\n        s = np.sin(theta_rad)\n        return np.array([\n            [c, -s, 0.0],\n            [s,  c, 0.0],\n            [0.0, 0.0, 1.0]\n        ])\n\n    results = []\n\n    # --- Task 1: Total Lagrangian Invariance Test ---\n    # A rigid rotation should induce no stress in a stress-free body.\n    theta_tl = np.pi / 3.0  # rad\n    R_tl = get_R_z(theta_tl)\n    \n    # Deformation gradient for rigid rotation\n    F_tl = R_tl\n    \n    # Right Cauchy-Green deformation tensor\n    C_tl = F_tl.T @ F_tl\n    \n    # Green-Lagrange strain tensor\n    I = np.identity(3)\n    E_tl = 0.5 * (C_tl - I)\n    \n    # Second Piola-Kirchhoff stress. Since E=0, S=C:E=0.\n    S_tl = np.zeros((3, 3))\n    \n    # Cauchy stress (push-forward). J = det(F) = det(R) = 1.\n    sigma_tl = R_tl @ S_tl @ R_tl.T\n    \n    # Check if the norm of the resulting stress is below tolerance\n    norm_sigma_tl = np.linalg.norm(sigma_tl)\n    results.append(norm_sigma_tl <= T_tol)\n\n    # --- UL Test Parameters ---\n    omega_z_ul = np.pi      # rad/s\n    T_ul = 0.5              # s\n    dt_ul = 0.01            # s\n\n    # --- Task 2: Updated Lagrangian Objective Rate Test (Jaumann) ---\n    # Integrate stress evolution using an objective corotational update.\n    num_steps = int(round(T_ul / dt_ul))\n    d_theta_ul = omega_z_ul * dt_ul\n    R_dt_ul = get_R_z(d_theta_ul)\n\n    sigma_j_numerical = np.copy(sigma_0_ul)\n    for _ in range(num_steps):\n        sigma_j_numerical = R_dt_ul @ sigma_j_numerical @ R_dt_ul.T\n\n    # Calculate the exact solution for comparison\n    theta_total_ul = omega_z_ul * T_ul\n    R_T_ul = get_R_z(theta_total_ul)\n    sigma_exact = R_T_ul @ sigma_0_ul @ R_T_ul.T\n\n    # Calculate the Frobenius norm of the error\n    error_j = sigma_j_numerical - sigma_exact\n    norm_error_j = np.linalg.norm(error_j)\n    results.append(norm_error_j)\n\n    # --- Task 3: Updated Lagrangian Non-Objective Rate Test ---\n    # Assume stress does not change (incorrect, non-objective formulation).\n    sigma_no = sigma_0_ul\n    \n    # Calculate the Frobenius norm of the error against the exact solution\n    error_no = sigma_no - sigma_exact\n    norm_error_no = np.linalg.norm(error_no)\n    results.append(norm_error_no)\n\n    # --- Task 4: Edge Case with Zero Spin ---\n    # Verify that the Jaumann update correctly handles the case of no rotation.\n    omega_z_zero = 0.0\n    \n    d_theta_zero = omega_z_zero * dt_ul  # This is 0\n    R_dt_zero = get_R_z(d_theta_zero)  # This is the identity matrix\n\n    sigma_j_zero_numerical = np.copy(sigma_0_ul)\n    for _ in range(num_steps): # This loop is for completeness, R is identity\n        sigma_j_zero_numerical = R_dt_zero @ sigma_j_zero_numerical @ R_dt_zero.T\n\n    # Exact solution for zero spin is the initial stress\n    sigma_exact_zero = np.copy(sigma_0_ul)\n\n    # Calculate the Frobenius norm of the error\n    error_j_zero = sigma_j_zero_numerical - sigma_exact_zero\n    norm_error_j_zero = np.linalg.norm(error_j_zero)\n    results.append(norm_error_j_zero <= T_tol)\n    \n    # Format and print the final output\n    formatted_results = [\n        str(results[0]),\n        f\"{results[1]:.6f}\",\n        f\"{results[2]:.6f}\",\n        str(results[3])\n    ]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "3568053"}]}