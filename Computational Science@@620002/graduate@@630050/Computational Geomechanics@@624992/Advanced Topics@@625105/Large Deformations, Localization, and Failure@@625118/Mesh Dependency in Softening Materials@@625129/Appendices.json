{"hands_on_practices": [{"introduction": "Understanding the pathological mesh dependency of softening models begins with analyzing the energy dissipated during fracture. This exercise provides a foundational look at how a simple, local strain-softening model predicts that the energy required to break a material spuriously vanishes as the mesh is refined. You will demonstrate this flaw analytically and then see how the crack band model corrects it by enforcing that the total dissipated energy remains a constant, physically meaningful material property—the fracture energy, $G_f$ [@problem_id:3542798].", "problem": "A prismatic one-dimensional bar of length $L$ and constant cross-sectional area $A$ is discretized for the Finite Element Method (FEM) into $N$ equal elements of length $h=L/N$. The bar is loaded in quasi-static, displacement-controlled tension such that after reaching peak stress, inelastic deformation localizes into a single element of length $h$ while the rest of the bar unloads elastically. The material exhibits linear elastic behavior up to a peak stress $\\sigma_{u}$ attained at strain $\\varepsilon_{u}$, followed by linear strain-softening down to zero stress at a failure strain $\\varepsilon_{f}(x)$, which may depend on the spatial coordinate $x$ in general. The dissipated energy is defined by\n$$\nW_{d}=\\int_{0}^{L}\\int_{\\varepsilon_{u}}^{\\varepsilon_{f}(x)}\\sigma(\\varepsilon)\\,d\\varepsilon\\,dx,\n$$\nwhere $\\sigma(\\varepsilon)$ is the uniaxial stress as a function of strain $\\varepsilon$ along the softening branch. Assume that localization occurs in exactly one element, that $\\varepsilon_{f}(x)=\\varepsilon_{u}$ everywhere except within the localized element of length $h$, and that the softening branch is strictly linear between $\\varepsilon_{u}$ and $\\varepsilon_{f}(x)$ in the localized element.\n\nStarting from the definitions above and the notion of fracture energy $G_{f}$, understood as the energy required to create a unit area of crack (work of the traction–separation law per unit area), and recognizing that in the crack band regularization the effective localization width is taken as the element size $h$, derive the dissipated energy $W_{d}$ for:\n- a purely local strain-softening material where $\\varepsilon_{f}(x)$ is a material constant independent of $h$, and\n- a crack band regularized material where $\\varepsilon_{f}(x)$ is chosen such that the energy dissipated in the localized element equals $G_{f}A$.\n\nCompute $W_{d}$ explicitly using the integral definition above in both cases and demonstrate how the regularization enforces mesh-objective dissipation. Provide the final answer as a single closed-form analytical expression for the regularized case. No numerical values are required, and no rounding is necessary. Express the final energy in Joules, but write the final boxed expression symbolically without units.", "solution": "The problem statement will be validated before a solution is attempted.\n\n### Step 1: Extract Givens\n- Geometry and Discretization: A one-dimensional bar of length $L$, constant cross-sectional area $A$, discretized into $N$ equal elements of length $h = L/N$.\n- Loading and Localization: Quasi-static, displacement-controlled tension. Deformation localizes into a single element of length $h$. The rest of the bar unloads elastically.\n- Constitutive Law: Linear elastic behavior up to peak stress $\\sigma_{u}$ at strain $\\varepsilon_{u}$. This is followed by a linear strain-softening branch down to zero stress at a failure strain $\\varepsilon_{f}(x)$.\n- Dissipated Energy Definition: $W_{d}=\\int_{0}^{L}\\int_{\\varepsilon_{u}}^{\\varepsilon_{f}(x)}\\sigma(\\varepsilon)\\,d\\varepsilon\\,dx$.\n- Assumptions:\n    1. Localization occurs in exactly one element.\n    2. $\\varepsilon_{f}(x)=\\varepsilon_{u}$ everywhere except within the localized element.\n    3. The softening branch is strictly linear between $(\\varepsilon_{u}, \\sigma_{u})$ and $(\\varepsilon_{f}, 0)$.\n- Fracture Energy $G_f$: Defined as the energy required to create a unit area of crack.\n- Regularization Tasks:\n    1. Derive dissipated energy $W_d$ for a local material where $\\varepsilon_f$ is a constant.\n    2. Derive dissipated energy $W_d$ for a regularized material where $\\varepsilon_f(x)$ is chosen such that the energy dissipated in the localized element equals $G_f A$.\n- Final Output Requirement: Provide a single closed-form analytical expression for the dissipated energy in the regularized case.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, well-posed, and objective. It addresses the classical issue of mesh dependency in computational modeling of strain-softening materials, a fundamental topic in computational mechanics. The concepts of linear softening, fracture energy $G_f$, and crack band regularization are standard and correctly described. The setup is self-contained and logical.\n\nHowever, there is a minor ambiguity in the definition of the dissipated energy, $W_d$. The provided integral, $W_{d}=\\int_{0}^{L}\\int_{\\varepsilon_{u}}^{\\varepsilon_{f}(x)}\\sigma(\\varepsilon)\\,d\\varepsilon\\,dx$, has units of energy per unit area ($J/m^2$), as $\\int\\sigma d\\varepsilon$ has units of stress (force/area) and the outer integral is over length. In contrast, the problem later refers to the energy dissipated in the localized element as $G_{f}A$, which has units of energy ($J$). Furthermore, it asks to express the final \"energy in Joules\". This strongly suggests that $W_d$ is intended to represent the total dissipated energy in the bar, which is an integral over the volume. The provided integral appears to be missing the cross-sectional area $A$. Assuming this is a notational oversight, the problem is solvable by using the physically consistent definition of total dissipated energy:\n$$ W_{d} = \\int_{V} \\left( \\int_{\\varepsilon_{u}}^{\\varepsilon_{f}(\\mathbf{x})} \\sigma(\\varepsilon) \\, d\\varepsilon \\right) dV = \\int_{0}^{L} A \\left( \\int_{\\varepsilon_{u}}^{\\varepsilon_{f}(x)} \\sigma(\\varepsilon) \\, d\\varepsilon \\right) dx $$\nThis interpretation renders the problem statement fully consistent. With this clarification, the problem is deemed valid.\n\n### Step 3: Verdict and Action\nThe problem is **valid**\n, with the clarification that $W_d$ represents the total dissipated energy. The solution will now be derived.\n\nThe solution proceeds by first deriving a general expression for the total dissipated energy, $W_d$. This expression will then be evaluated for the two specified material models.\n\nThe specific dissipated energy, or energy dissipated per unit volume, $w_d$, is the area under the stress-strain curve during softening. Given a linear softening branch from $(\\varepsilon_{u}, \\sigma_{u})$ to $(\\varepsilon_{f}, 0)$, this area is that of a triangle:\n$$ w_d = \\int_{\\varepsilon_{u}}^{\\varepsilon_{f}} \\sigma(\\varepsilon) \\, d\\varepsilon = \\frac{1}{2} (\\varepsilon_f - \\varepsilon_u) \\sigma_u $$\nThe problem states that inelastic deformation (and thus energy dissipation) is confined to a single element of length $h$. Outside this element, the material unloads elastically, so there is no energy dissipation. The volume of this single localized element is $V_{loc} = A \\cdot h$.\nThe total dissipated energy $W_d$ for the entire bar is the specific dissipated energy multiplied by the volume over which it occurs:\n$$ W_d = w_d \\cdot V_{loc} = \\left[ \\frac{1}{2} \\sigma_u (\\varepsilon_f - \\varepsilon_u) \\right] A h $$\nThis general expression forms the basis for analyzing the two cases.\n\n**Case 1: Purely Local Strain-Softening Material**\nIn a purely local constitutive model, the material properties are considered intrinsic and independent of the discretization. Thus, the failure strain $\\varepsilon_f$ is a constant material parameter, let's call it $\\varepsilon_{f,m}$. Substituting this into the general expression for $W_d$:\n$$ W_{d, \\text{local}} = \\frac{1}{2} \\sigma_u (\\varepsilon_{f,m} - \\varepsilon_u) A h $$\nThis result shows that the total dissipated energy is directly proportional to the element size, $h$. As the finite element mesh is refined, $h \\to 0$, and consequently $W_{d, \\text{local}} \\to 0$. This implies that with an infinitely fine mesh, the structure would require zero energy to fracture, a physically spurious result known as pathological mesh dependency.\n\n**Case 2: Crack Band Regularized Material**\nThe crack band model regularizes the problem by enforcing that the total energy dissipated in the localization band equals a mesh-independent material property. The problem specifies that this energy is $G_f A$, where $G_f$ is the fracture energy (energy per unit area of crack). Since dissipation only occurs in the localized element, the total dissipated energy for the bar, $W_d$, must equal this value.\n$$ W_{d, \\text{reg}} = G_f A $$\nThis is, by definition, the dissipated energy for the regularized case. To achieve this mesh-objective result, the material parameter $\\varepsilon_f$ can no longer be a constant. Instead, it must be adjusted based on the element size $h$. We enforce the condition by equating the general expression for $W_d$ with the target regularized energy:\n$$ \\left[ \\frac{1}{2} \\sigma_u (\\varepsilon_f - \\varepsilon_u) \\right] A h = G_f A $$\nWe can solve for the required failure strain $\\varepsilon_f$ as a function of $h$:\n$$ \\frac{1}{2} \\sigma_u (\\varepsilon_f - \\varepsilon_u) h = G_f $$\n$$ \\varepsilon_f - \\varepsilon_u = \\frac{2 G_f}{\\sigma_u h} $$\n$$ \\varepsilon_f(h) = \\varepsilon_u + \\frac{2 G_f}{\\sigma_u h} $$\nThis relationship shows that for the regularized model, the softening modulus of the material is not constant but is adapted to the element size $h$ to ensure that the work of fracture remains constant. As the mesh is refined ($h \\to 0$), the required failure strain $\\varepsilon_f \\to \\infty$, making the softening response more brittle in the stress-strain diagram, but ensuring the total energy dissipation remains constant and physically meaningful.\n\n**Demonstration of Mesh-Objective Dissipation**\nA comparison of the two cases demonstrates the effect of regularization:\n- For the local model, $W_{d, \\text{local}} = \\frac{1}{2} \\sigma_u (\\varepsilon_{f,m} - \\varepsilon_u) A h$. The dissipated energy depends on the mesh size $h$ and vanishes as $h \\to 0$.\n- For the regularized model, $W_{d, \\text{reg}} = G_f A$. The dissipated energy is a constant material property, independent of the mesh size $h$.\n\nBy making the constitutive law (specifically, the softening behavior) dependent on the element size, the crack band model ensures that the total energy consumed during fracture is a mesh-objective quantity, resolving the pathological dependency observed in the local model.\n\nThe final answer required is the single closed-form analytical expression for the total dissipated energy in the regularized case. As established by the definition of the regularization procedure given in the problem, this energy is $G_f A$.", "answer": "$$\n\\boxed{G_f A}\n$$", "id": "3542798"}, {"introduction": "The principle of fracture energy regularization is not just a theoretical concept; it is a practical tool for calibrating constitutive models to produce mesh-objective results. This practice bridges theory and application by asking you to calibrate a common exponential damage law. You will perform the necessary integration to derive an explicit relationship between the model's internal softening parameter, $\\beta$, the material's fracture energy, $G_f$, and the element's characteristic length, $l_c$ [@problem_id:3542867].", "problem": "Consider a one-dimensional tension test of a geomaterial represented in the Finite Element Method (FEM) by a single constant-strain element of length $l_{c}$. The material is modeled by an isotropic scalar damage formulation with Helmholtz free energy density per unit volume\n$$\\psi(\\varepsilon,d) = \\tfrac{1}{2}\\,(1-d)\\,E\\,\\varepsilon^{2},$$\nwhere $E$ is the Young’s modulus, $\\varepsilon$ is the axial strain, and $d \\in [0,1]$ is the scalar damage variable. The equivalent strain is taken as the axial strain, so that $\\kappa = \\varepsilon$ under uniaxial tension. Damage initiates when the axial stress first reaches the tensile strength $f_{t}$, which happens at the elastic limit strain\n$$\\varepsilon_{0}=\\frac{f_{t}}{E}.$$\nBeyond $\\varepsilon_{0}$, damage evolves according to the monotonic exponential law\n$$d(\\kappa)=1-\\exp\\!\\left(-\\frac{\\kappa-\\kappa_{0}}{\\beta}\\right)\\quad\\text{for}\\quad \\kappa\\ge\\kappa_{0},$$\nwith $d(\\kappa)=0$ for $\\kappa\\le\\kappa_{0}$, where $\\kappa_{0}=\\varepsilon_{0}$ and $\\beta>0$ is a dimensionless model parameter to be calibrated.\n\nUnder uniaxial tension, the Cauchy stress is $\\sigma(\\varepsilon)=(1-d)E\\varepsilon$. Assume that strain localizes within the single element, so that the dissipated energy per unit crack area (the fracture energy) equals the work per unit volume integrated along the softening branch, scaled by the characteristic length $l_{c}$. Impose the fracture energy matching condition\n$$G_{f}=l_{c}\\int_{\\varepsilon_{0}}^{\\infty}\\sigma(\\varepsilon)\\,\\mathrm{d}\\varepsilon.$$\n\nGiven $E=1.0\\times 10^{10}\\,\\mathrm{Pa}$, $f_{t}=2.0\\times 10^{6}\\,\\mathrm{Pa}$, $l_{c}=0.10\\,\\mathrm{m}$, and $G_{f}=30\\,\\mathrm{N/m}$, determine the calibrated value of $\\beta$ that enforces the above fracture energy condition and preserves mesh-objective dissipation. Express your final answer as a dimensionless number rounded to three significant figures.", "solution": "The problem statement is scientifically grounded, self-contained, and mathematically well-posed. It describes a standard procedure in computational mechanics for regularizing strain-softening models, known as the crack band model, to ensure mesh-objective energy dissipation during fracture. The task is to determine the value of the softening parameter $\\beta$ that satisfies the given fracture energy condition.\n\nThe fracture energy matching condition is given as:\n$$G_{f} = l_{c} \\int_{\\varepsilon_{0}}^{\\infty} \\sigma(\\varepsilon) \\, \\mathrm{d}\\varepsilon$$\nwhere $G_f$ is the fracture energy, $l_c$ is the characteristic length of the finite element, and the integral represents the energy dissipated per unit volume during the softening process. The integration starts from the elastic limit strain $\\varepsilon_{0}$, which corresponds to the onset of damage and softening.\n\nThe Cauchy stress $\\sigma$ is defined as $\\sigma(\\varepsilon) = (1-d)E\\varepsilon$, where $E$ is the Young's modulus, $\\varepsilon$ is the axial strain, and $d$ is the damage variable.\nFor the softening regime, where the strain $\\varepsilon \\ge \\varepsilon_{0}$, the problem states that the maximum experienced strain (the internal variable $\\kappa$) is equal to the current strain, so $\\kappa = \\varepsilon$. The damage evolution law for $\\kappa \\ge \\kappa_{0} = \\varepsilon_{0}$ is:\n$$d(\\kappa) = d(\\varepsilon) = 1 - \\exp\\left(-\\frac{\\varepsilon - \\varepsilon_{0}}{\\beta}\\right)$$\nSubstituting this expression for damage into the stress definition gives the stress-strain relationship along the softening branch:\n$$\\sigma(\\varepsilon) = \\left(1 - \\left[1 - \\exp\\left(-\\frac{\\varepsilon-\\varepsilon_{0}}{\\beta}\\right)\\right]\\right) E\\varepsilon$$\n$$\\sigma(\\varepsilon) = E \\varepsilon \\exp\\left(-\\frac{\\varepsilon-\\varepsilon_{0}}{\\beta}\\right)$$\nNow we can substitute this expression for $\\sigma(\\varepsilon)$ into the fracture energy integral:\n$$G_{f} = l_{c} \\int_{\\varepsilon_{0}}^{\\infty} E \\varepsilon \\exp\\left(-\\frac{\\varepsilon-\\varepsilon_{0}}{\\beta}\\right) \\mathrm{d}\\varepsilon$$\nTo solve this integral, we can factor out the constant terms and perform a change of variables. Let's rewrite the exponential term:\n$$G_{f} = l_{c} E \\exp\\left(\\frac{\\varepsilon_{0}}{\\beta}\\right) \\int_{\\varepsilon_{0}}^{\\infty} \\varepsilon \\exp\\left(-\\frac{\\varepsilon}{\\beta}\\right) \\mathrm{d}\\varepsilon$$\nThe integral can be solved using integration by parts, $\\int u\\,\\mathrm{d}v = uv - \\int v\\,\\mathrm{d}u$. Let:\n$u = \\varepsilon \\implies \\mathrm{d}u = \\mathrm{d}\\varepsilon$\n$\\mathrm{d}v = \\exp\\left(-\\frac{\\varepsilon}{\\beta}\\right) \\mathrm{d}\\varepsilon \\implies v = -\\beta \\exp\\left(-\\frac{\\varepsilon}{\\beta}\\right)$\n\nApplying this to the definite integral:\n$$\\int_{\\varepsilon_{0}}^{\\infty} \\varepsilon \\exp\\left(-\\frac{\\varepsilon}{\\beta}\\right) \\mathrm{d}\\varepsilon = \\left[-\\beta\\varepsilon\\exp\\left(-\\frac{\\varepsilon}{\\beta}\\right)\\right]_{\\varepsilon_{0}}^{\\infty} - \\int_{\\varepsilon_{0}}^{\\infty} \\left(-\\beta\\exp\\left(-\\frac{\\varepsilon}{\\beta}\\right)\\right) \\mathrm{d}\\varepsilon$$\n$$= \\left[-\\beta\\varepsilon\\exp\\left(-\\frac{\\varepsilon}{\\beta}\\right)\\right]_{\\varepsilon_{0}}^{\\infty} + \\beta \\left[-\\beta\\exp\\left(-\\frac{\\varepsilon}{\\beta}\\right)\\right]_{\\varepsilon_{0}}^{\\infty}$$\n$$= \\left[-\\beta\\varepsilon\\exp\\left(-\\frac{\\varepsilon}{\\beta}\\right) - \\beta^{2}\\exp\\left(-\\frac{\\varepsilon}{\\beta}\\right)\\right]_{\\varepsilon_{0}}^{\\infty}$$\nEvaluating at the limits:\nAs $\\varepsilon \\to \\infty$, both terms $\\varepsilon\\exp(-\\varepsilon/\\beta)$ and $\\exp(-\\varepsilon/\\beta)$ go to $0$, because the exponential decay is faster than the linear growth.\nAs $\\varepsilon = \\varepsilon_{0}$, the expression is $-\\beta\\varepsilon_{0}\\exp(-\\varepsilon_{0}/\\beta) - \\beta^{2}\\exp(-\\varepsilon_{0}/\\beta)$.\nSo, the value of the definite integral is:\n$$0 - \\left(-\\beta\\varepsilon_{0}\\exp\\left(-\\frac{\\varepsilon_{0}}{\\beta}\\right) - \\beta^{2}\\exp\\left(-\\frac{\\varepsilon_{0}}{\\beta}\\right)\\right) = (\\beta\\varepsilon_{0} + \\beta^{2})\\exp\\left(-\\frac{\\varepsilon_{0}}{\\beta}\\right)$$\nSubstituting this result back into the equation for $G_f$:\n$$G_{f} = l_{c} E \\exp\\left(\\frac{\\varepsilon_{0}}{\\beta}\\right) \\left[ (\\beta\\varepsilon_{0} + \\beta^{2})\\exp\\left(-\\frac{\\varepsilon_{0}}{\\beta}\\right) \\right]$$\nThe exponential terms cancel out, yielding a simple algebraic relationship:\n$$G_{f} = l_{c} E (\\beta\\varepsilon_{0} + \\beta^{2})$$\nThe problem provides that $\\varepsilon_{0} = f_{t}/E$. Substituting this into the equation:\n$$G_{f} = l_{c} E \\left(\\beta\\frac{f_{t}}{E} + \\beta^{2}\\right) = l_{c} f_{t} \\beta + l_{c} E \\beta^{2}$$\nThis is a quadratic equation for $\\beta$:\n$$(l_{c} E) \\beta^{2} + (l_{c} f_{t}) \\beta - G_{f} = 0$$\nWe solve for $\\beta$ using the quadratic formula, $\\beta = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$, with coefficients $a = l_{c}E$, $b = l_{c}f_{t}$, and $c = -G_{f}$.\n$$\\beta = \\frac{-(l_{c} f_{t}) \\pm \\sqrt{(l_{c} f_{t})^{2} - 4(l_{c} E)(-G_{f})}}{2 (l_{c} E)}$$\n$$\\beta = \\frac{-l_{c} f_{t} \\pm \\sqrt{(l_{c} f_{t})^{2} + 4 l_{c} E G_{f}}}{2 l_{c} E}$$\nSince $\\beta > 0$ is a model requirement, we must take the positive root:\n$$\\beta = \\frac{-l_{c} f_{t} + \\sqrt{(l_{c} f_{t})^{2} + 4 l_{c} E G_{f}}}{2 l_{c} E}$$\nNow, we substitute the given numerical values:\n$E = 1.0 \\times 10^{10}\\,\\mathrm{Pa}$\n$f_{t} = 2.0 \\times 10^{6}\\,\\mathrm{Pa}$\n$l_{c} = 0.10\\,\\mathrm{m}$\n$G_{f} = 30\\,\\mathrm{N/m}$\n\nLet's calculate the terms:\n$l_{c} E = (0.10\\,\\mathrm{m})(1.0 \\times 10^{10}\\,\\mathrm{N/m^{2}}) = 1.0 \\times 10^{9}\\,\\mathrm{N/m}$\n$l_{c} f_{t} = (0.10\\,\\mathrm{m})(2.0 \\times 10^{6}\\,\\mathrm{N/m^{2}}) = 2.0 \\times 10^{5}\\,\\mathrm{N/m}$\n$(l_{c} f_{t})^{2} = (2.0 \\times 10^{5}\\,\\mathrm{N/m})^{2} = 4.0 \\times 10^{10}\\,(\\mathrm{N/m})^{2}$\n$4 l_{c} E G_{f} = 4 (1.0 \\times 10^{9}\\,\\mathrm{N/m}) (30\\,\\mathrm{N/m}) = 120 \\times 10^{9}\\,(\\mathrm{N/m})^{2} = 1.2 \\times 10^{11}\\,(\\mathrm{N/m})^{2}$\n\nNow substitute these into the expression for $\\beta$:\n$$\\beta = \\frac{-2.0 \\times 10^{5} + \\sqrt{4.0 \\times 10^{10} + 1.2 \\times 10^{11}}}{2 (1.0 \\times 10^{9})}$$\n$$\\beta = \\frac{-2.0 \\times 10^{5} + \\sqrt{0.4 \\times 10^{11} + 1.2 \\times 10^{11}}}{2.0 \\times 10^{9}}$$\n$$\\beta = \\frac{-2.0 \\times 10^{5} + \\sqrt{1.6 \\times 10^{11}}}{2.0 \\times 10^{9}}$$\n$$\\beta = \\frac{-2.0 \\times 10^{5} + \\sqrt{16 \\times 10^{10}}}{2.0 \\times 10^{9}}$$\n$$\\beta = \\frac{-2.0 \\times 10^{5} + 4.0 \\times 10^{5}}{2.0 \\times 10^{9}}$$\n$$\\beta = \\frac{2.0 \\times 10^{5}}{2.0 \\times 10^{9}} = 1.0 \\times 10^{-4}$$\nThe problem asks for the answer to be rounded to three significant figures. Therefore, the value is $1.00 \\times 10^{-4}$.", "answer": "$$\\boxed{1.00 \\times 10^{-4}}$$", "id": "3542867"}, {"introduction": "The numerical origin of mesh dependency is intimately tied to how finite elements approximate continuum fields and how integrals are evaluated. This exercise delves into the behavior of unregularized models at the sub-element level, showing how strain localization collapses to the smallest available integration zone—the region associated with a single Gauss point. By comparing the apparent fracture energy computed with linear and quadratic elements, you will gain a deeper appreciation for how the choice of element formulation can drastically affect simulation outcomes and why regularization is essential [@problem_id:3542841].", "problem": "Consider a one-dimensional (1D) homogeneous bar of length $L$ and cross-sectional area $A$. The bar is discretized using the Finite Element (FE) method and is subjected to monotonic axial tensile loading. The material exhibits linear elasticity up to a peak stress followed by linear strain-softening to zero stress. The purpose of this problem is to formalize, compute, and compare how a purely local (non-regularized) strain-softening law induces mesh dependency through collapse of localization into the smallest available numerical integration zone, and to highlight the differences between linear and quadratic element types.\n\nStart from the following foundations:\n- Principle of virtual work in one dimension: internal work density is the product of stress and strain, integrated over the volume.\n- Gauss-Legendre (GL) quadrature over the parent domain $\\xi \\in [-1,1]$ is used for numerical integration in FE. For a two-node linear element, use one-point GL quadrature with point $\\xi_1 = 0$ and weight $w_1 = 2$. For a three-node quadratic element, use two-point GL quadrature with points $\\xi_1 = -1/\\sqrt{3}$, $\\xi_2 = +1/\\sqrt{3}$, and weights $w_1 = 1$, $w_2 = 1$.\n- The mapping from the parent domain to the physical coordinate is affine with Jacobian $J = L_e/2$, where $L_e$ is the physical length of the element. The physical integration weight associated with a Gauss point $i$ is $w_i J$.\n- The cross-sectional area is $A = 1\\,\\text{m}^2$ for all computations.\n\nThe constitutive behavior is defined by a linear elastic branch up to a peak stress $\\sigma_0$ at strain $\\varepsilon_0$, followed by linear softening to zero stress at strain $\\varepsilon_f > \\varepsilon_0$:\n- Linear elasticity: $\\sigma(\\varepsilon) = E\\,\\varepsilon$ for $0 \\le \\varepsilon \\le \\varepsilon_0$, with $\\varepsilon_0 = \\sigma_0/E$.\n- Linear softening: $\\sigma(\\varepsilon) = \\sigma_0 \\left( 1 - \\dfrac{\\varepsilon - \\varepsilon_0}{\\varepsilon_f - \\varepsilon_0} \\right)$ for $\\varepsilon_0 \\le \\varepsilon \\le \\varepsilon_f$, where $\\sigma(\\varepsilon_f) = 0$.\n\nAssume the following localization scenario, consistent with local strain-softening without any regularization: as the bar is loaded, the loss of ellipticity causes strain localization that collapses into a single Gauss point in the mesh. Consequently, only one Gauss point contributes to the irreversible softening work, and its spatial influence equals the physical integration weight $w_\\star J$ of that point. Because the FE quadrature partitions the element into integration zones, the smallest integration zone determines the localization length. For a linear element this zone spans the entire element ($w_1 J = L_e$), while for a quadratic element each Gauss point spans half the element ($w_i J = L_e/2$).\n\nDefine the volumetric softening work density as the area under the softening branch of the stress–strain curve,\n$$\ng_{\\text{soft}} = \\int_{\\varepsilon_0}^{\\varepsilon_f} \\sigma(\\varepsilon)\\,d\\varepsilon,\n$$\nand define the apparent fracture energy per unit area predicted by this local FE discretization as\n$$\nG_{\\text{app}} = g_{\\text{soft}} \\cdot l_{\\text{loc}},\n$$\nwhere $l_{\\text{loc}}$ is the localization length equal to the physical integration weight $w_\\star J$ of the single Gauss point that collapses the softening ($l_{\\text{loc}} = L_e$ for a linear element and $l_{\\text{loc}} = L_e/2$ for a quadratic element). The quantity $G_{\\text{app}}$ must be reported in $\\text{N/m}$.\n\nYour task is to implement a program that, for each test case, computes:\n- The apparent fracture energy per unit area for a mesh of linear elements, $G_{\\text{app}}^{\\text{lin}}$.\n- The apparent fracture energy per unit area for a mesh of quadratic elements, $G_{\\text{app}}^{\\text{quad}}$.\n- The ratio $r = G_{\\text{app}}^{\\text{lin}} / G_{\\text{app}}^{\\text{quad}}$. If both $G_{\\text{app}}^{\\text{lin}}$ and $G_{\\text{app}}^{\\text{quad}}$ are zero (i.e., no softening, $\\varepsilon_f \\le \\varepsilon_0$), define $r = 1$.\n\nAll inputs must be in International System of Units (SI units): $E$ in $\\text{Pa}$, $\\sigma_0$ in $\\text{Pa}$, $\\varepsilon_f$ dimensionless, $L_e$ in $\\text{m}$. All outputs for $G_{\\text{app}}$ must be in $\\text{N/m}$.\n\nUse the following test suite of parameter values $(L_e, E, \\sigma_0, \\varepsilon_f)$:\n- Case $1$ (general): $L_e = 0.5\\,\\text{m}$, $E = 3.0 \\times 10^{10}\\,\\text{Pa}$, $\\sigma_0 = 3.0 \\times 10^{7}\\,\\text{Pa}$, $\\varepsilon_f = 0.006$.\n- Case $2$ (general): $L_e = 0.25\\,\\text{m}$, $E = 2.0 \\times 10^{10}\\,\\text{Pa}$, $\\sigma_0 = 2.0 \\times 10^{7}\\,\\text{Pa}$, $\\varepsilon_f = 0.003$.\n- Case $3$ (boundary, no softening): $L_e = 1.0\\,\\text{m}$, $E = 4.0 \\times 10^{10}\\,\\text{Pa}$, $\\sigma_0 = 4.0 \\times 10^{7}\\,\\text{Pa}$, $\\varepsilon_f = 0.001$.\n- Case $4$ (edge, very small element): $L_e = 0.001\\,\\text{m}$, $E = 2.5 \\times 10^{10}\\,\\text{Pa}$, $\\sigma_0 = 2.5 \\times 10^{7}\\,\\text{Pa}$, $\\varepsilon_f = 0.005$.\n- Case $5$ (edge, large element): $L_e = 2.0\\,\\text{m}$, $E = 3.5 \\times 10^{10}\\,\\text{Pa}$, $\\sigma_0 = 2.8 \\times 10^{7}\\,\\text{Pa}$, $\\varepsilon_f = 0.007$.\n\nYour program should produce a single line of output containing, for each case, the list $[G_{\\text{app}}^{\\text{lin}}, G_{\\text{app}}^{\\text{quad}}, r]$ in $\\text{N/m}$ for energies and dimensionless for the ratio. Aggregate all five cases into a single outer list, and print it exactly as a comma-separated list enclosed in square brackets, for example:\n$[[G_{1}^{\\text{lin}}, G_{1}^{\\text{quad}}, r_1], [G_{2}^{\\text{lin}}, G_{2}^{\\text{quad}}, r_2], \\dots, [G_{5}^{\\text{lin}}, G_{5}^{\\text{quad}}, r_5]]$.", "solution": "The problem is valid as it is scientifically grounded in the principles of computational solid mechanics, specifically the Finite Element Method applied to materials with strain-softening. It is well-posed, objective, and contains all necessary information for a unique solution. The scenario described is a classic textbook example of pathological mesh dependency in local continuum damage models.\n\nThe solution requires the computation of the apparent fracture energy per unit area, $G_{\\text{app}}$, for two different finite element types: a 2-node linear element and a 3-node quadratic element. The core of the problem lies in understanding how the choice of element and its numerical integration scheme affects the calculated energy dissipation during strain localization.\n\nThe apparent fracture energy per unit area is defined as:\n$$\nG_{\\text{app}} = g_{\\text{soft}} \\cdot l_{\\text{loc}}\n$$\nwhere $g_{\\text{soft}}$ is the volumetric softening work density (energy per unit volume) and $l_{\\text{loc}}$ is the localization length, which is an artifact of the numerical discretization.\n\nFirst, we must determine the volumetric softening work density, $g_{\\text{soft}}$. This is defined as the area under the softening portion of the stress-strain curve, from the strain at peak stress, $\\varepsilon_0$, to the final strain, $\\varepsilon_f$, where the stress returns to zero.\n$$\ng_{\\text{soft}} = \\int_{\\varepsilon_0}^{\\varepsilon_f} \\sigma(\\varepsilon)\\,d\\varepsilon\n$$\nThe softening behavior is given as a linear function of strain:\n$$\n\\sigma(\\varepsilon) = \\sigma_0 \\left( 1 - \\dfrac{\\varepsilon - \\varepsilon_0}{\\varepsilon_f - \\varepsilon_0} \\right) \\quad \\text{for} \\quad \\varepsilon_0 \\le \\varepsilon \\le \\varepsilon_f\n$$\nThis describes a straight line from the point $(\\varepsilon_0, \\sigma_0)$ to $(\\varepsilon_f, 0)$. The integral for $g_{\\text{soft}}$ is therefore the area of a right-angled triangle with base $(\\varepsilon_f - \\varepsilon_0)$ and height $\\sigma_0$.\n$$\ng_{\\text{soft}} = \\frac{1}{2} \\cdot (\\text{base}) \\cdot (\\text{height}) = \\frac{1}{2} \\sigma_0 (\\varepsilon_f - \\varepsilon_0)\n$$\nThis calculation is valid only if softening occurs, which is the case when $\\varepsilon_f > \\varepsilon_0$. The strain at peak stress, $\\varepsilon_0$, is determined by the elastic properties: $\\varepsilon_0 = \\sigma_0 / E$. If $\\varepsilon_f \\le \\varepsilon_0$, the material does not enter the softening regime under monotonic loading, so no softening work is done, and $g_{\\text{soft}} = 0$. The units of $g_{\\text{soft}}$ are pressure ($\\text{Pa}$ or $\\text{N/m}^2$) times dimensionless strain, resulting in $\\text{N/m}^2$ or $\\text{J/m}^3$, which is energy per volume.\n\nNext, we address the localization length, $l_{\\text{loc}}$. The problem states that strain localization collapses into a single Gauss point. The physical \"volume\" (or length, in this 1D case) over which this Gauss point's material behavior is integrated contributes to the total energy dissipation. This localization length is given by the physical integration weight of the Gauss point, which is the product of its parent element weight, $w_\\star$, and the Jacobian of the mapping, $J$.\nThe Jacobian for an affine mapping from the parent element of length $2$ (from $\\xi=-1$ to $\\xi=1$) to a physical element of length $L_e$ is $J = L_e/2$.\n\nFor a 2-node linear element, a single Gauss-Legendre point at $\\xi_1 = 0$ with weight $w_1 = 2$ is used.\nThe localization length for the linear element is:\n$$\nl_{\\text{loc}}^{\\text{lin}} = w_1 \\cdot J = 2 \\cdot \\frac{L_e}{2} = L_e\n$$\nThis means the localization band width is equal to the entire element length.\n\nFor a 3-node quadratic element, two Gauss points are used: $\\xi_1 = -1/\\sqrt{3}$ and $\\xi_2 = +1/\\sqrt{3}$, each with weight $w_1 = w_2 = 1$. The localization is assumed to collapse into one of these points.\nThe localization length for the quadratic element is based on a single Gauss point:\n$$\nl_{\\text{loc}}^{\\text{quad}} = w_i \\cdot J = 1 \\cdot \\frac{L_e}{2} = \\frac{L_e}{2}\n$$\nHere, the localization band width is half the element length.\n\nNow we can write the expressions for the apparent fracture energy for both element types. The units are $(\\text{N}/\\text{m}^2) \\cdot \\text{m} = \\text{N}/\\text{m}$, as required.\n$$\nG_{\\text{app}}^{\\text{lin}} = g_{\\text{soft}} \\cdot l_{\\text{loc}}^{\\text{lin}} = \\frac{1}{2} \\sigma_0 (\\varepsilon_f - \\varepsilon_0) L_e\n$$\n$$\nG_{\\text{app}}^{\\text{quad}} = g_{\\text{soft}} \\cdot l_{\\text{loc}}^{\\text{quad}} = \\frac{1}{2} \\sigma_0 (\\varepsilon_f - \\varepsilon_0) \\frac{L_e}{2}\n$$\n\nFinally, we compute the ratio $r = G_{\\text{app}}^{\\text{lin}} / G_{\\text{app}}^{\\text{quad}}$.\nIf softening occurs ($\\varepsilon_f > \\varepsilon_0$), then $g_{\\text{soft}} > 0$. The ratio is:\n$$\nr = \\frac{g_{\\text{soft}} \\cdot L_e}{g_{\\text{soft}} \\cdot L_e/2} = 2\n$$\nThis shows that for a given element size $L_e$, the linear element predicts double the fracture energy of the quadratic element, a direct consequence of the different integration schemes affecting the numerical localization length.\nIf there is no softening ($\\varepsilon_f \\le \\varepsilon_0$), then $g_{\\text{soft}} = 0$, leading to $G_{\\text{app}}^{\\text{lin}} = 0$ and $G_{\\text{app}}^{\\text{quad}} = 0$. The problem specifies that in this case, the ratio is defined as $r=1$.\n\nThe computational procedure for each test case $(L_e, E, \\sigma_0, \\varepsilon_f)$ is as follows:\n$1$. Calculate the strain at peak stress: $\\varepsilon_0 = \\sigma_0 / E$.\n$2$. Check if $\\varepsilon_f > \\varepsilon_0$.\n$3$. If true (softening occurs):\n   a. Calculate $g_{\\text{soft}} = 0.5 \\cdot \\sigma_0 \\cdot (\\varepsilon_f - \\varepsilon_0)$.\n   b. Calculate $G_{\\text{app}}^{\\text{lin}} = g_{\\text{soft}} \\cdot L_e$.\n   c. Calculate $G_{\\text{app}}^{\\text{quad}} = g_{\\text{soft}} \\cdot L_e / 2.0$.\n   d. The ratio is $r = 2.0$.\n$4$. If false (no softening):\n   a. $G_{\\text{app}}^{\\text{lin}} = 0.0$.\n   b. $G_{\\text{app}}^{\\text{quad}} = 0.0$.\n   c. The ratio is $r = 1.0$.\n$5$. Return the results as a list $[G_{\\text{app}}^{\\text{lin}}, G_{\\text{app}}^{\\text{quad}}, r]$.\nThis procedure is applied to all provided test cases.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes apparent fracture energy for linear and quadratic elements\n    to demonstrate mesh dependency in strain-softening materials.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (L_e, E, sigma_0, epsilon_f)\n    # L_e: element length (m)\n    # E: Young's modulus (Pa)\n    # sigma_0: peak stress (Pa)\n    # epsilon_f: final strain (dimensionless)\n    test_cases = [\n        (0.5, 3.0e10, 3.0e7, 0.006),    # Case 1\n        (0.25, 2.0e10, 2.0e7, 0.003),   # Case 2\n        (1.0, 4.0e10, 4.0e7, 0.001),    # Case 3\n        (0.001, 2.5e10, 2.5e7, 0.005),  # Case 4\n        (2.0, 3.5e10, 2.8e7, 0.007)     # Case 5\n    ]\n\n    results = []\n    for case in test_cases:\n        L_e, E, sigma_0, epsilon_f = case\n\n        # Calculate the strain at peak stress\n        epsilon_0 = sigma_0 / E\n\n        # Check if softening occurs\n        if epsilon_f > epsilon_0:\n            # Calculate volumetric softening work density (area of softening triangle)\n            g_soft = 0.5 * sigma_0 * (epsilon_f - epsilon_0)\n\n            # Localization length for linear element is L_e\n            l_loc_lin = L_e\n            # Apparent fracture energy for linear element\n            G_app_lin = g_soft * l_loc_lin\n\n            # Localization length for quadratic element is L_e / 2\n            l_loc_quad = L_e / 2.0\n            # Apparent fracture energy for quadratic element\n            G_app_quad = g_soft * l_loc_quad\n            \n            # The ratio of apparent fracture energies\n            r = 2.0\n        else:\n            # No softening branch is activated\n            G_app_lin = 0.0\n            G_app_quad = 0.0\n            # Per problem statement, ratio is 1 if no softening\n            r = 1.0\n        \n        results.append([G_app_lin, G_app_quad, r])\n\n    # Final print statement in the exact required format.\n    # The default str() representation of a list of lists matches the example.\n    print(results)\n\nsolve()\n```", "id": "3542841"}]}