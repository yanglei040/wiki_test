{"hands_on_practices": [{"introduction": "To begin our practical exploration, we first need to master the fundamental definition of skyline storage and its core advantage. This exercise provides a concrete scenario to quantify the memory savings achieved by a skyline scheme compared to a naive storage of the full lower triangle. By working through this calculation, you will develop an intuition for how a matrix's sparsity pattern translates directly into computational efficiency [@problem_id:3559724].", "problem": "A linear, isotropic, small-strain $3$-dimensional elasticity problem is discretized using the Finite Element (FE) method on a structured mesh, leading to a global stiffness matrix $K \\in \\mathbb{R}^{n \\times n}$. Owing to the symmetry of the elastic energy bilinear form, $K$ is Symmetric Positive Definite (SPD). In a skyline storage scheme, the nonzero structure in each column $j$ is assumed to be contiguous from the diagonal entry in that column down to the first nonzero in that column. Let the skyline height $h_j$ denote, by definition, the count of stored entries in column $j$ in the lower triangular part, including the diagonal entry.\n\nConsider an ordering that yields the following skyline heights for $n=12$: $\\{h_j\\}_{j=1}^{12} = \\{1,\\,2,\\,4,\\,5,\\,6,\\,6,\\,5,\\,5,\\,4,\\,3,\\,2,\\,1\\}$. Using only the symmetry of $K$ and the definition of skyline storage, derive the exact total number of stored floating-point entries under skyline storage and contrast it with the count required to store the entire lower triangle of $K$.\n\nReport the storage reduction factor $R$, defined as the ratio of the skyline storage entry count to the full lower-triangular storage entry count, as a single exact simplified fraction. No rounding is required.", "solution": "The problem statement has been validated and is deemed sound. It is a well-posed, self-contained problem grounded in standard principles of computational mechanics and numerical linear algebra. We may proceed with the solution.\n\nThe problem requires us to compute the storage reduction factor $R$ for a given sparse matrix structure. This factor is defined as the ratio of the number of entries stored using a skyline scheme to the number of entries stored in a full lower-triangular representation. The matrix in question is the global stiffness matrix $K \\in \\mathbb{R}^{n \\times n}$, where $n=12$. The matrix $K$ is symmetric, which is the fundamental property that allows for storage-efficient schemes like skyline storage, where only the lower (or upper) triangle, including the diagonal, needs to be stored.\n\nFirst, let us calculate the total number of stored floating-point entries under the specified skyline storage scheme, which we denote by $N_{\\text{sky}}$. The problem defines the skyline height for each column $j$, denoted by $h_j$, as the number of stored entries in that column within the lower triangular part of the matrix, inclusive of the diagonal element $K_{jj}$. The total number of stored entries is therefore the sum of the skyline heights over all columns.\nGiven the dimension $n=12$ and the sequence of skyline heights $\\{h_j\\}_{j=1}^{12} = \\{1,\\,2,\\,4,\\,5,\\,6,\\,6,\\,5,\\,5,\\,4,\\,3,\\,2,\\,1\\}$, the total number of stored entries is:\n$$N_{\\text{sky}} = \\sum_{j=1}^{n} h_j$$\nSubstituting the given values:\n$$N_{\\text{sky}} = 1 + 2 + 4 + 5 + 6 + 6 + 5 + 5 + 4 + 3 + 2 + 1$$\nPerforming the summation:\n$$N_{\\text{sky}} = 44$$\nThus, the skyline storage scheme requires storing $44$ floating-point numbers.\n\nNext, we calculate the number of entries required to store the entire lower triangle of the matrix $K$, including the main diagonal. We denote this count by $N_{\\text{full}}$. For a general $n \\times n$ matrix, the number of elements in the lower triangle is the sum of the lengths of the columns from $j=1$ to $j=n$. The $j$-th column has $j$ elements in the lower triangle (from row $j$ down to row $1$, or, as conventionally indexed, from row $1$ to row $j$ ending at the diagonal $K_{jj}$, for storage purposes). This means we sum the integers from $1$ to $n$.\n$$N_{\\text{full}} = \\sum_{j=1}^{n} j$$\nThis is the sum of an arithmetic progression, given by the formula:\n$$N_{\\text{full}} = \\frac{n(n+1)}{2}$$\nFor the given matrix dimension $n=12$:\n$$N_{\\text{full}} = \\frac{12(12+1)}{2} = \\frac{12 \\times 13}{2} = 6 \\times 13 = 78$$\nSo, storing the full lower triangle of the $12 \\times 12$ matrix requires $78$ floating-point numbers.\n\nFinally, we compute the storage reduction factor $R$, which is defined as the ratio of the skyline storage count to the full lower-triangular storage count.\n$$R = \\frac{N_{\\text{sky}}}{N_{\\text{full}}}$$\nSubstituting the calculated values for $N_{\\text{sky}}$ and $N_{\\text{full}}$:\n$$R = \\frac{44}{78}$$\nTo provide the answer as an exact simplified fraction, we find the greatest common divisor of the numerator and the denominator. Both $44$ and $78$ are even numbers.\n$$R = \\frac{2 \\times 22}{2 \\times 39} = \\frac{22}{39}$$\nThe prime factorization of the numerator is $22 = 2 \\times 11$. The prime factorization of the denominator is $39 = 3 \\times 13$. Since there are no common prime factors, the fraction $\\frac{22}{39}$ is in its simplest form.\n\nThe storage reduction factor $R$ represents the efficiency of the skyline storage scheme for this specific matrix structure compared to a naive storage of the lower triangle. A value of $R < 1$ indicates a reduction in storage requirements. Here, $R = \\frac{22}{39} \\approx 0.564$, indicating that the skyline scheme uses approximately $56.4\\%$ of the storage that a full lower-triangular scheme would require.", "answer": "$$\\boxed{\\frac{22}{39}}$$", "id": "3559724"}, {"introduction": "Having understood how to quantify a given skyline profile, we now address a more fundamental question: how is this profile determined in the first place within a finite element code? This practice moves beyond simple calculation to algorithm design, challenging you to derive an efficient method for computing skyline heights directly from the element connectivity data. This task is central to practical FEM implementations, as it allows for the pre-allocation of memory for the stiffness matrix without ever forming an explicit adjacency graph [@problem_id:3559651].", "problem": "You are given a global, symmetric, positive definite stiffness matrix arising from a finite element discretization in computational geomechanics. The matrix is not provided explicitly. Instead, you are given only the element-to-global Degree of Freedom (DOF) connectivity. In skyline storage, for each column $j$ (using $1$-based indexing), one stores the diagonal entry and all entries from the lowest nonzero row $r_j$ up to row $j$. The skyline height for column $j$ is $h_j = j - r_j$. Your task is to design and implement an algorithm that computes the full array of skyline heights $\\{h_j\\}_{j=1}^N$ directly from the element connectivity, without first forming a graph adjacency matrix. Ground your algorithm and its correctness in the fundamental law of finite element assembly: each element stiffness matrix contributes nonzeros to the global matrix for all pairs of its local DOFs.\n\nStarting from the foundational fact that a typical finite element with local DOF index set $\\mathcal{G}_e \\subset \\{1,\\dots,N\\}$ contributes nonzero entries $K_{ij}$ for all $i \\in \\mathcal{G}_e$ and $j \\in \\mathcal{G}_e$ (by symmetry, the lower triangle is sufficient), derive a principle-based algorithm to compute $r_j$ for all $j \\in \\{1,\\dots,N\\}$ using only the element connectivity sets. Do not form an adjacency matrix or any explicit graph; reason directly from the assembly rule. Analyze the algorithmic complexity in terms of the number of elements $E$ and the local DOF counts $p_e = |\\mathcal{G}_e|$. Your analysis must include a comparison to a baseline approach that enumerates all element DOF pairs $(i,j)$ with $i \\le j$ to update $r_j$.\n\nYour program must implement the derived algorithm and also compute simple operation counts that reflect the asymptotic complexity. Use the following operation model to make the analysis concrete and testable:\n- Initialize an array of length $N$ for $r_j$ values and set each to $j$: count this as $N$ primitive operations.\n- For each element $e$, let $p_e$ be the number of local DOFs. Compute the minimum DOF $m_e = \\min \\mathcal{G}_e$ using a $p_e$-iteration scan: count this as $p_e$ primitive operations.\n- For each element $e$ and each $j \\in \\mathcal{G}_e$, attempt to update $r_j \\leftarrow \\min(r_j, m_e)$: count this as $p_e$ primitive operations (one per attempt), regardless of whether the value changes.\n- After all elements are processed, compute the skyline heights $h_j = j - r_j$ with a single pass: count this as $N$ primitive operations.\n- Compute the maximum height $\\max_j h_j$ with a single pass: count this as $N$ primitive operations.\n\nFor the baseline pair-enumeration approach, define its operation count as:\n- Initialize an array of length $N$ for $r_j$ values as above: $N$ operations.\n- For each element $e$ with $p_e$ local DOFs, enumerate all lower-triangular pairs $(i,j)$ with $i \\le j$, and perform $r_j \\leftarrow \\min(r_j, i)$: count this as $p_e(p_e+1)/2$ primitive operations.\n- Compute $\\{h_j\\}_{j=1}^N$ and $\\max_j h_j$ each with a pass: $N + N$ operations.\n\nYour program must, for each test case, compute:\n- The skyline heights $h_j$ for all $j \\in \\{1,\\dots,N\\}$.\n- The maximum skyline height $\\max_j h_j$.\n- The bandwidth, defined as $\\max_j h_j + 1$.\n- The total skyline storage length $L = \\sum_{j=1}^N (h_j + 1)$.\n- The measured primitive operation count for your algorithm as specified.\n- The baseline primitive operation count as specified.\n\nYour implementation must not form any adjacency matrix or global sparse matrix. It must compute the skyline heights only from the element connectivity, justified by finite element assembly.\n\nTest suite. Use the following four test cases. Each case is specified by $N$ and a list of element connectivity sets, each being a set of global DOF indices. All indices are $1$-based and lie in $\\{1,\\dots,N\\}$.\n\n- Case A (happy path, chain of overlapping elements): $N = 7$, elements $\\{\\{1,2,3\\},\\{3,4,5\\},\\{5,6,7\\}\\}$.\n- Case B (overlap with varying local sizes): $N = 10$, elements $\\{\\{2,3,5,7\\},\\{1,4,5\\},\\{5,8,9\\},\\{6,9,10\\}\\}$.\n- Case C (single large element, boundary case): $N = 6$, elements $\\{\\{1,2,3,4,5,6\\}\\}$.\n- Case D (disconnected DOFs present, edge case): $N = 8$, elements $\\{\\{2,3\\},\\{5,7\\}\\}$.\n\nFinal output format. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with no spaces. Each test case result must itself be a list of six integers in the following order:\n$[N,\\max_j h_j,\\max_j h_j + 1,L,\\text{measured},\\text{baseline}]$.\nTherefore the final printout must look like\n$[[\\cdot,\\cdot,\\cdot,\\cdot,\\cdot,\\cdot],[\\cdot,\\cdot,\\cdot,\\cdot,\\cdot,\\cdot],[\\cdot,\\cdot,\\cdot,\\cdot,\\cdot,\\cdot],[\\cdot,\\cdot,\\cdot,\\cdot,\\cdot,\\cdot]]$\nwith the four case results in the order A, B, C, D.", "solution": "The problem is valid as it is scientifically grounded in the principles of the Finite Element Method (FEM), is well-posed with a clear objective and sufficient data, and uses precise, objective language. We can thus proceed with the derivation and implementation of the solution.\n\n### Principle-Based Algorithm Derivation\n\nThe core of the problem is to determine the skyline profile of a global stiffness matrix $K$ directly from the element connectivity data. The matrix $K$ is an $N \\times N$ symmetric, positive definite matrix, where $N$ is the total number of Degrees of Freedom (DOFs).\n\nThe fundamental principle of FEM assembly states that the global stiffness matrix is formed by the summation of element stiffness matrices. A non-zero entry $K_{ij}$ exists in the global matrix if and only if there is at least one element $e$ that couples DOF $i$ and DOF $j$. For a standard element formulation, all DOFs within that element are coupled. Let $\\mathcal{G}_e \\subset \\{1, 2, \\dots, N\\}$ be the set of global DOF indices associated with element $e$. Then, for any two DOFs $i, j \\in \\mathcal{G}_e$, the entry $K_{ij}$ (and $K_{ji}$ by symmetry) receives a non-zero contribution from element $e$'s stiffness matrix. Consequently, $K_{ij} \\neq 0$ if and only if there exists an element $e$ such that $\\{i, j\\} \\subseteq \\mathcal{G}_e$.\n\nThe skyline storage scheme for a column $j$ requires storing all entries from the first non-zero row, $r_j$, up to the diagonal, $j$. The value $r_j$ is formally defined as:\n$$\nr_j = \\min \\{ i \\mid 1 \\le i \\le j \\text{ and } K_{ij} \\neq 0 \\}\n$$\nThe condition $K_{jj} \\neq 0$ (due to positive definiteness) ensures that $r_j$ is well-defined and $r_j \\le j$. Combining the definitions, we can express $r_j$ in terms of element connectivity:\n$$\nr_j = \\min \\left( \\{j\\} \\cup \\{ i \\mid 1 \\le i < j \\text{ and } \\exists e \\text{ s.t. } \\{i, j\\} \\subseteq \\mathcal{G}_e \\} \\right)\n$$\n\n**Baseline Algorithm Analysis**\n\nA straightforward interpretation of this definition leads to the baseline algorithm. We initialize an array for the row indices, let's call it $\\mathbf{r}$, such that $r_j = j$ for all $j \\in \\{1, \\dots, N\\}$. Then, for each element $e$, we iterate through all pairs of DOFs $(i, j) \\in \\mathcal{G}_e \\times \\mathcal{G}_e$ with $i \\le j$. For each such pair, we have a known non-zero entry $K_{ij}$, which implies the row index for column $j$ is at most $i$. We therefore perform the update:\n$$\nr_j \\leftarrow \\min(r_j, i)\n$$\nIf an element has $p_e = |\\mathcal{G}_e|$ DOFs, there are $p_e(p_e+1)/2$ such pairs $(i,j)$ with $i \\le j$. Summing over all $E$ elements, the total number of such updates is $\\sum_{e=1}^E p_e(p_e+1)/2$. The complexity of the core loop is $O(\\sum_e p_e^2)$. The total operation count as per the problem's model is $3N + \\sum_{e=1}^E \\frac{p_e(p_e+1)}{2}$.\n\n**Proposed Algorithm Derivation**\n\nWe can derive a more efficient algorithm by re-examining the update rule from a different perspective. For any given element $e$, it contributes non-zero stiffness terms for all pairs of its DOFs. This means that for any specific DOF $j \\in \\mathcal{G}_e$, it is connected to all other DOFs $i \\in \\mathcal{G}_e$.\n\nLet $m_e = \\min \\mathcal{G}_e$ be the minimum DOF index within element $e$. Since $m_e \\in \\mathcal{G}_e$, it is connected to every other DOF $j \\in \\mathcal{G}_e$. This implies that for each $j \\in \\mathcal{G}_e$, there exists a non-zero entry $K_{m_e, j}$ (assuming $m_e \\le j$) or $K_{j, m_e}$ (assuming $j \\le m_e$). When considering the lower triangle of the matrix for column $j$, the non-zero entry involving $m_e$ will be at row $\\min(j, m_e)$.\n\nCritically, for any column $j \\in \\mathcal{G}_e$, the smallest row index that element $e$ can *possibly* contribute is $m_e$. No other DOF $i \\in \\mathcal{G}_e$ can provide a smaller row index for column $j$, because by definition $m_e \\le i$. Therefore, for every $j \\in \\mathcal{G}_e$, we can update its minimum row index based *only* on the minimum DOF of its parent element:\n$$\nr_j \\leftarrow \\min(r_j, m_e)\n$$\nApplying this update for all $j \\in \\mathcal{G}_e$ and repeating for every element $e$ results in the correct final values for all $r_j$.\n\nThe resulting algorithm proceeds as follows:\n1. Initialize an array $\\mathbf{r}$ of length $N$ such that $r_j = j$ for $j=1, \\dots, N$.\n2. For each element $e=1, \\dots, E$:\n   a. Find the minimum DOF index in the element: $m_e = \\min \\mathcal{G}_e$.\n   b. For each DOF $j \\in \\mathcal{G}_e$, perform the update: $r_j \\leftarrow \\min(r_j, m_e)$.\n3. After processing all elements, compute the skyline heights: $h_j = j - r_j$.\n\n**Complexity Analysis of Proposed Algorithm**\n\nFor each element $e$, this algorithm performs two steps: finding the minimum of $p_e$ DOFs, and then performing $p_e$ updates. Both steps take $O(p_e)$ time. The total work over all $E$ elements is therefore $\\sum_{e=1}^E O(p_e) = O(\\sum_e p_e)$. The overall complexity, including initialization and final computations, is $O(N + \\sum_e p_e)$. The operation count as per the problem's model is $N$ (init) $+ \\sum_e (p_e + p_e)$ (loops) $+ N$ (heights) $+ N$ (max height) $= 3N + 2\\sum_{e=1}^E p_e$.\n\nThis is asymptotically superior to the baseline algorithm's $O(N + \\sum_e p_e^2)$ complexity. The proposed algorithm's cost is linear in the total number of elemental DOFs, whereas the baseline is quadratic in element size. This advantage is significant for high-order finite elements where $p_e$ is large.\n\n```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    # Test suite using 1-based indexing as given in the problem.\n    test_cases_1_based = [\n        {'N': 7, 'elements': [{1, 2, 3}, {3, 4, 5}, {5, 6, 7}]},\n        {'N': 10, 'elements': [{2, 3, 5, 7}, {1, 4, 5}, {5, 8, 9}, {6, 9, 10}]},\n        {'N': 6, 'elements': [{1, 2, 3, 4, 5, 6}]},\n        {'N': 8, 'elements': [{2, 3}, {5, 7}]}\n    ]\n\n    results = []\n    for case in test_cases_1_based:\n        N = case['N']\n        # Convert 1-based element DOFs to 0-based for numpy array indexing.\n        elements_0_based = [\n            [dof - 1 for dof in sorted(list(elem))] for elem in case['elements']\n        ]\n        result = compute_skyline_metrics(N, elements_0_based)\n        results.append(result)\n\n    # Format the final output as a single-line string with no spaces.\n    inner_strs = []\n    for res_list in results:\n        inner_strs.append(f\"[{','.join(map(str, res_list))}]\")\n    output_str = f\"[{','.join(inner_strs)}]\"\n    print(output_str)\n\ndef compute_skyline_metrics(N, elements):\n    \"\"\"\n    Computes skyline metrics for a single test case.\n\n    Args:\n        N (int): The total number of Degrees of Freedom (DOFs).\n        elements (list of list of int): A list of element connectivity sets,\n                                        using 0-based indexing.\n\n    Returns:\n        list: A list of integers [N, max_h, bandwidth, L, measured_ops, baseline_ops].\n    \"\"\"\n    if N == 0:\n        return [0, 0, 1, 0, 0, 0]\n\n    # --- Proposed Algorithm Implementation ---\n    \n    # Initialize r_j = j.\n    # In 0-based indexing, this corresponds to r[j] = j for j = 0 to N-1.\n    r = np.arange(N)\n    \n    # Per the problem's operation counting model:\n    # 1. Initialize 'r' array: N operations\n    measured_ops = N\n    \n    p_e_list = []\n    for elem_dofs in elements:\n        p_e = len(elem_dofs)\n        p_e_list.append(p_e)\n        if p_e == 0:\n            continue\n            \n        # 2a. Compute m_e = min(G_e): p_e operations\n        m_e = elem_dofs[0]  # Assumes elements are pre-sorted\n        measured_ops += p_e\n        \n        # 2b. Update r_j for each j in G_e: p_e operations\n        for j in elem_dofs:\n            r[j] = min(r[j], m_e)\n        measured_ops += p_e\n\n    # 3. Compute skyline heights h_j = j - r_j: N operations\n    h = np.arange(N) - r\n    measured_ops += N\n    \n    # 4. Compute max skyline height: N operations\n    if h.size > 0:\n        max_h = int(np.max(h))\n    else:\n        max_h = 0\n    measured_ops += N\n    \n    # --- Calculation of Other Metrics ---\n\n    # Bandwidth = max_h + 1\n    bandwidth = max_h + 1\n    \n    # Total skyline storage length L = sum(h_j + 1)\n    L = int(np.sum(h + 1))\n    \n    # --- Baseline Operation Count Calculation ---\n    \n    # Initialization: N ops\n    baseline_ops = N\n    # Loop over elements: sum(p_e * (p_e + 1) / 2) ops\n    for p_e in p_e_list:\n        baseline_ops += p_e * (p_e + 1) // 2\n    # Final steps: N + N ops\n    baseline_ops += N + N\n\n    return [N, max_h, bandwidth, L, int(measured_ops), int(baseline_ops)]\n\nif __name__ == \"__main__\":\n    solve()\n\n```", "answer": "[[7,2,3,16,39,39],[10,5,6,32,59,57],[6,5,6,21,30,39],[8,2,3,11,32,34]]", "id": "3559651"}, {"introduction": "The structure of a stiffness matrix is not merely an abstract mathematical property; it is a direct consequence of physical modeling choices. This final practice demonstrates this crucial link by examining how two different strategies for enforcing Dirichlet boundary conditions—elimination versus the penalty method—profoundly alter the skyline profile. By analyzing the resulting matrix bandwidth, you will see how engineering decisions made during model setup have tangible impacts on the computational cost and efficiency of the subsequent analysis [@problem_id:3559721].", "problem": "A two-dimensional plane strain elasticity model of a rectangular soil domain is discretized by a uniform mesh of four-node quadrilateral finite elements. Nodes are numbered row-wise from left-to-right and bottom-to-top. The mesh consists of $3 \\times 3$ nodes, generating $2 \\times 2$ elements. Each node carries two displacement degrees of freedom (DOFs), horizontal $u$ and vertical $v$. The element connectivity (in terms of nodal numbers) is\n- Element $1$: $\\{1,2,5,4\\}$\n- Element $2$: $\\{2,3,6,5\\}$\n- Element $3$: $\\{4,5,8,7\\}$\n- Element $4$: $\\{5,6,9,8\\}$\n\nAssume standard finite element assembly: the global symmetric stiffness matrix $K$ has a nonzero block corresponding to every pair of DOFs associated with nodes that appear together in at least one element. The base (unconstrained) DOF ordering is $[u_1,v_1,u_2,v_2,\\dots,u_9,v_9]$, so the total number of DOFs is $n=18$.\n\nEssential (Dirichlet) boundary conditions prescribe zero displacements on the left boundary nodes $\\{1,4,7\\}$ for both $u$ and $v$. Consider two enforcement strategies:\n\n1. Strong enforcement by elimination: Remove the constrained DOFs from the system by eliminating the corresponding rows and columns and renumber the remaining free DOFs in their original relative order to obtain a reduced system with the same assembly connectivity restricted to the free DOFs.\n\n2. Penalty coupling to a single ground DOF: Retain all original $n$ DOFs and introduce one additional scalar ground DOF $g$ with index $n+1$, appended after the original ordering. Enforce the essential boundary conditions by connecting each constrained DOF to $g$ with a large penalty stiffness $\\alpha$ (the magnitude of $\\alpha$ does not affect the sparsity pattern). This introduces nonzeros coupling $g$ only to the constrained DOFs and to itself; no other penalty terms are added.\n\nFor a symmetric matrix stored with the skyline storage scheme, define the skyline height of column $j$ as $h_j = j - r_j + 1$, where $r_j$ is the index of the first nonzero entry in column $j$ (including the diagonal), and define the matrix skyline height $H$ as $H = \\max_{1 \\leq j \\leq N} h_j$ for an $N \\times N$ matrix.\n\nUsing only the mesh connectivity and the two enforcement strategies above, determine the skyline height $H_{\\text{elim}}$ of the reduced system for strategy $1$ and the skyline height $H_{\\text{pen}}$ of the augmented system for strategy $2$. Then compute the bandwidth increase due to penalty coupling, defined as $\\Delta = H_{\\text{pen}} - H_{\\text{elim}}$.\n\nProvide $\\Delta$ as a single integer. No rounding is required. There are no physical units for $\\Delta$.", "solution": "The user wants to solve the problem, and the solution is provided below.\nThe problem is first validated to ensure it is scientifically grounded, well-posed, and objective.\n\n**Step 1: Problem Validation**\n\nThe givens are extracted verbatim:\n- A two-dimensional plane strain elasticity model of a rectangular soil domain is discretized by a uniform mesh of four-node quadrilateral finite elements.\n- Nodes are numbered row-wise from left-to-right and bottom-to-top.\n- The mesh consists of $3 \\times 3$ nodes, generating $2 \\times 2$ elements.\n- Each node carries two displacement degrees of freedom (DOFs), horizontal $u$ and vertical $v$.\n- Element connectivity (in terms of nodal numbers):\n  - Element $1$: $\\{1,2,5,4\\}$\n  - Element $2$: $\\{2,3,6,5\\}$\n  - Element $3$: $\\{4,5,8,7\\}$\n  - Element $4$: $\\{5,6,9,8\\}$\n- The global symmetric stiffness matrix $K$ has a nonzero block corresponding to every pair of DOFs associated with nodes that appear together in at least one element.\n- The base (unconstrained) DOF ordering is $[u_1,v_1,u_2,v_2,\\dots,u_9,v_9]$, so the total number of DOFs is $n=18$.\n- Essential (Dirichlet) boundary conditions prescribe zero displacements on the left boundary nodes $\\{1,4,7\\}$ for both $u$ and $v$.\n- Strategy 1 (Elimination): Remove the constrained DOFs from the system.\n- Strategy 2 (Penalty): Retain all original DOFs and add one additional scalar ground DOF $g$ with index $n+1=19$.\n- Skyline height of column $j$: $h_j = j - r_j + 1$, where $r_j$ is the index of the first nonzero entry in column $j$.\n- Matrix skyline height $H = \\max_{j} h_j$.\n- Task: Compute $\\Delta = H_{\\text{pen}} - H_{\\text{elim}}$.\n\nThe problem is reviewed against validation criteria:\n- **Scientific Grounding**: The problem is a standard application of the Finite Element Method (FEM) for linear elasticity, a cornerstone of computational geomechanics and structural engineering. All concepts used—stiffness matrix, element assembly, boundary condition enforcement via elimination and penalty methods, and skyline storage—are well-established and scientifically sound.\n- **Well-Posedness**: The problem provides a complete and unambiguous description of the mesh, connectivity, DOF ordering, and boundary conditions. The definitions for the two enforcement strategies and the skyline height are precise. This allows for a unique, computable solution.\n- **Objectivity**: The problem is stated in precise, formal language, free of any subjective or ambiguous terminology.\n\n**Verdict**: The problem is valid.\n\n**Step 2: Solution**\n\nThe objective is to compute the skyline heights of the stiffness matrices resulting from two different methods of enforcing essential boundary conditions and then find their difference.\n\nThe degrees of freedom (DOFs) are ordered such that for node $i$, the DOFs are $2i-1$ (horizontal, $u_i$) and $2i$ (vertical, $v_i$). The total number of DOFs is $n = 2 \\times 9 = 18$. The stiffness matrix $K$ is an $18 \\times 18$ symmetric matrix. An entry $K_{pq}$ is potentially nonzero if the nodes corresponding to DOFs $p$ and $q$ are within the same element.\n\nThe skyline height $H$ is the maximum of the column heights $h_j = j - r_j + 1$, where $r_j$ is the row index of the first nonzero entry in column $j$. Due to symmetry, the first nonzero in column $j$ corresponds to the first nonzero in row $j$. For a column $j$ associated with node $k$, the first nonzero row $r_j$ is determined by the node $i_{min}$ with the smallest index that shares an element with node $k$. Specifically, the first nonzero row will be $2 \\cdot i_{min} - 1$.\n\nFirst, we determine the minimum connected node index $i_{\\text{min}}(k)$ for each node $k \\in \\{1, \\dots, 9\\}$ based on the element connectivity:\n- E1: $\\{1,2,5,4\\}$, E2: $\\{2,3,6,5\\}$, E3: $\\{4,5,8,7\\}$, E4: $\\{5,6,9,8\\}$.\n- Node 1 connects to $\\{2,4,5\\}$. $i_{\\text{min}}(1)=1$.\n- Node 2 connects to $\\{1,3,4,5,6\\}$. $i_{\\text{min}}(2)=1$.\n- Node 3 connects to $\\{2,5,6\\}$. $i_{\\text{min}}(3)=2$.\n- Node 4 connects to $\\{1,2,5,7,8\\}$. $i_{\\text{min}}(4)=1$.\n- Node 5 connects to $\\{1,2,3,4,6,7,8,9\\}$. $i_{\\text{min}}(5)=1$.\n- Node 6 connects to $\\{2,3,5,8,9\\}$. $i_{\\text{min}}(6)=2$.\n- Node 7 connects to $\\{4,5,8\\}$. $i_{\\text{min}}(7)=4$.\n- Node 8 connects to $\\{4,5,6,7,9\\}$. $i_{\\text{min}}(8)=4$.\n- Node 9 connects to $\\{5,6,8\\}$. $i_{\\text{min}}(9)=5$.\n\n**Strategy 1: Elimination and calculation of $H_{\\text{elim}}$**\n\nThe essential boundary conditions are on nodes $\\{1,4,7\\}$. The corresponding DOFs are $\\{1,2\\}$, $\\{7,8\\}$, and $\\{13,14\\}$. These $6$ DOFs are eliminated.\nThe remaining free nodes are $\\{2,3,5,6,8,9\\}$. The free DOFs are $\\{3,4,5,6,9,10,11,12,15,16,17,18\\}$.\nThese $12$ free DOFs are renumbered sequentially from $1$ to $12$ to form a reduced $12 \\times 12$ system.\n- Old DOFs $\\{3,4\\}$ (node 2) $\\rightarrow$ New DOFs $\\{1,2\\}$\n- Old DOFs $\\{5,6\\}$ (node 3) $\\rightarrow$ New DOFs $\\{3,4\\}$\n- Old DOFs $\\{9,10\\}$ (node 5) $\\rightarrow$ New DOFs $\\{5,6\\}$\n- Old DOFs $\\{11,12\\}$ (node 6) $\\rightarrow$ New DOFs $\\{7,8\\}$\n- Old DOFs $\\{15,16\\}$ (node 8) $\\rightarrow$ New DOFs $\\{9,10\\}$\n- Old DOFs $\\{17,18\\}$ (node 9) $\\rightarrow$ New DOFs $\\{11,12\\}$\n\nTo find the skyline of the reduced matrix, we determine the minimum-indexed *free* node connected to each free node.\n- Free node 2 connects to free nodes $\\{3,5,6\\}$. Min free node connected to 2 is 2 itself.\n- Free node 3 connects to free nodes $\\{2,5,6\\}$. Min free node is 2.\n- Free node 5 connects to free nodes $\\{2,3,6,8,9\\}$. Min free node is 2.\n- Free node 6 connects to free nodes $\\{2,3,5,8,9\\}$. Min free node is 2.\n- Free node 8 connects to free nodes $\\{5,6,9\\}$. Min free node is 5.\n- Free node 9 connects to free nodes $\\{5,6,8\\}$. Min free node is 5.\n\nNow we find the first nonzero row $r'_j$ for each column $j$ in the new $12 \\times 12$ system.\n- For new cols $\\{1,2\\}$ (orig. node 2): Min connected free node is 2. Its new DOFs start at 1. So, $r'_1=1, r'_2=1$.\n- For new cols $\\{3,4\\}$ (orig. node 3): Min connected free node is 2. Its new DOFs start at 1. So, $r'_3=1, r'_4=1$.\n- For new cols $\\{5,6\\}$ (orig. node 5): Min connected free node is 2. Its new DOFs start at 1. So, $r'_5=1, r'_6=1$.\n- For new cols $\\{7,8\\}$ (orig. node 6): Min connected free node is 2. Its new DOFs start at 1. So, $r'_7=1, r'_8=1$.\n- For new cols $\\{9,10\\}$ (orig. node 8): Min connected free node is 5. Its new DOFs start at 5. So, $r'_9=5, r'_{10}=5$.\n- For new cols $\\{11,12\\}$ (orig. node 9): Min connected free node is 5. Its new DOFs start at 5. So, $r'_{11}=5, r'_{12}=5$.\n\nColumn heights $h'_j = j - r'_j + 1$:\n- $h'_1 = 1-1+1=1$, $h'_2=2-1+1=2$\n- $h'_3 = 3-1+1=3$, $h'_4=4-1+1=4$\n- $h'_5 = 5-1+1=5$, $h'_6=6-1+1=6$\n- $h'_7 = 7-1+1=7$, $h'_8=8-1+1=8$\n- $h'_9 = 9-5+1=5$, $h'_{10}=10-5+1=6$\n- $h'_{11} = 11-5+1=7$, $h'_{12}=12-5+1=8$\nThe maximum skyline height is $H_{\\text{elim}} = \\max(2,4,6,8,6,8) = 8$.\n\n**Strategy 2: Penalty Coupling and calculation of $H_{\\text{pen}}$**\n\nThe system is augmented with one DOF, yielding a $19 \\times 19$ matrix. The sparsity pattern of the original $18 \\times 18$ submatrix is preserved. The column heights for columns $j=1, \\dots, 18$ are determined by the unconstrained connectivity.\nFirst nonzero row $r_j$ for column $j$ associated with node $k$ is $r_j = 2 \\cdot i_{\\text{min}}(k) - 1$.\n- For $k=1$ (cols 1,2): $i_{\\text{min}}(1)=1 \\Rightarrow r_{1,2}=1$. $h_{1,2} = \\{1,2\\}$.\n- For $k=2$ (cols 3,4): $i_{\\text{min}}(2)=1 \\Rightarrow r_{3,4}=1$. $h_{3,4} = \\{3,4\\}$.\n- For $k=3$ (cols 5,6): $i_{\\text{min}}(3)=2 \\Rightarrow r_{5,6}=3$. $h_{5,6} = \\{3,4\\}$.\n- For $k=4$ (cols 7,8): $i_{\\text{min}}(4)=1 \\Rightarrow r_{7,8}=1$. $h_{7,8} = \\{7,8\\}$.\n- For $k=5$ (cols 9,10): $i_{\\text{min}}(5)=1 \\Rightarrow r_{9,10}=1$. $h_{9,10} = \\{9,10\\}$.\n- For $k=6$ (cols 11,12): $i_{\\text{min}}(6)=2 \\Rightarrow r_{11,12}=3$. $h_{11,12} = \\{9,10\\}$.\n- For $k=7$ (cols 13,14): $i_{\\text{min}}(7)=4 \\Rightarrow r_{13,14}=7$. $h_{13,14} = \\{7,8\\}$.\n- For $k=8$ (cols 15,16): $i_{\\text{min}}(8)=4 \\Rightarrow r_{15,16}=7$. $h_{15,16} = \\{9,10\\}$.\n- For $k=9$ (cols 17,18): $i_{\\text{min}}(9)=5 \\Rightarrow r_{17,18}=9$. $h_{17,18} = \\{9,10\\}$.\nThe maximum height for the first $18$ columns is $\\max(2,4,4,8,10,10,8,10,10) = 10$.\n\nNow, we analyze the added column $19$. This column contains nonzero entries that couple the ground DOF $g$ to the constrained DOFs and to itself. The constrained DOFs are $\\{1,2,7,8,13,14\\}$.\nThe entries in column $19$ are nonzero at rows $\\{1,2,7,8,13,14\\}$ and at row $19$.\nThe first nonzero row in column $19$ is $r_{19} = \\min(\\{1,2,7,8,13,14,19\\}) = 1$.\nThe skyline height for column $19$ is $h_{19} = 19 - r_{19} + 1 = 19 - 1 + 1 = 19$.\nThe overall skyline height for the penalty system is the maximum of all column heights:\n$H_{\\text{pen}} = \\max(10, 19) = 19$.\n\n**Final Calculation**\n\nThe bandwidth increase is the difference between the two skyline heights:\n$\\Delta = H_{\\text{pen}} - H_{\\text{elim}} = 19 - 8 = 11$.", "answer": "$$\\boxed{11}$$", "id": "3559721"}]}