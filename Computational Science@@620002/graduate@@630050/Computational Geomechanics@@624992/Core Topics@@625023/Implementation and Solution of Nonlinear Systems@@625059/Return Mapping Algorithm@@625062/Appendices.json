{"hands_on_practices": [{"introduction": "This first practice grounds our study in a concrete calculation. You will apply the fundamental two-step return mapping algorithm—an elastic predictor followed by a plastic corrector—to a classic von Mises material model with linear hardening [@problem_id:3556863]. Mastering this procedure is essential, as it forms the computational basis for nearly all elastoplastic simulations.", "problem": "A small-strain, isotropic, associative elastoplastic material obeys the von Mises yield condition and linear isotropic hardening. Consider a single implicit time step in which the total strain increment is purely shear. The constitutive ingredients are:\n- Linear isotropic elasticity with Young’s modulus $E$ and Poisson’s ratio $\\nu$, giving shear modulus $G=E/[2(1+\\nu)]$ and the deviatoric stress-strain relation $\\boldsymbol{s}=2G\\,\\boldsymbol{\\varepsilon}^{\\text{dev}}-2G\\,\\boldsymbol{\\varepsilon}^{p}$.\n- The von Mises yield function $f(\\boldsymbol{\\sigma},\\kappa)=\\|\\boldsymbol{s}\\|-\\sqrt{\\frac{2}{3}}\\,\\sigma_{y}(\\kappa)$ with $\\boldsymbol{s}=\\boldsymbol{\\sigma}-\\frac{1}{3}\\,\\text{tr}(\\boldsymbol{\\sigma})\\,\\boldsymbol{I}$ and $\\|\\boldsymbol{s}\\|=\\sqrt{\\boldsymbol{s}:\\boldsymbol{s}}$.\n- Associative plastic flow $\\Delta\\boldsymbol{\\varepsilon}^{p}=\\Delta\\lambda\\,\\frac{\\partial f}{\\partial\\boldsymbol{\\sigma}}$, and the hardening variable update $\\Delta\\kappa=\\sqrt{\\frac{2}{3}}\\,\\Delta\\lambda$ (equivalent plastic strain increment).\n- Linear isotropic hardening $\\sigma_{y}(\\kappa)=\\sigma_{y0}+H\\,\\kappa$.\n- Implicit closest point projection (return mapping algorithm), enforcing the consistency condition $f_{n+1}=0$ in the plastic corrector.\n\nLet the material parameters be $E=210\\times 10^{9}$, $\\nu=0.30$, $\\sigma_{y0}=0.45\\times 10^{9}$, and $H=2.5\\times 10^{9}$, all in Pascals. Assume the previous step is stress-free and plastically undeformed, i.e., $\\boldsymbol{\\sigma}_{n}=\\boldsymbol{0}$, $\\boldsymbol{\\varepsilon}^{p}_{n}=\\boldsymbol{0}$, and $\\kappa_{n}=0$. Apply a pure shear strain increment with the small-strain tensor having only one nonzero component $\\Delta\\varepsilon_{xy}=0.01$ (and by symmetry $\\Delta\\varepsilon_{yx}=\\Delta\\varepsilon_{xy}$), with all normal components of $\\Delta\\boldsymbol{\\varepsilon}$ equal to zero.\n\nStarting from these foundations and the definitions above, perform the elastic predictor and then the plastic corrector by closest point projection. Derive the plastic multiplier $\\Delta\\lambda$ from the consistency condition, compute the updated plastic strain increment $\\Delta\\boldsymbol{\\varepsilon}^{p}=\\Delta\\lambda\\,\\frac{\\partial f}{\\partial\\boldsymbol{\\sigma}}$, and compute the hardening increment $\\Delta\\kappa$. Verify that the updated yield function satisfies $f_{n+1}=0$.\n\nExpress your final answer as a single row matrix containing the four quantities $\\Delta\\lambda$, the single nonzero component $\\Delta\\varepsilon^{p}_{xy}$, $\\Delta\\kappa$, and $f_{n+1}$, in that order. All entries are dimensionless except $f_{n+1}$, which is in Pascals. Do not include units in the final boxed answer. No rounding is required; provide exact closed-form expressions whenever possible.", "solution": "The problem will be solved by following the standard two-step procedure of an implicit return mapping algorithm for elastoplasticity: the elastic predictor and the plastic corrector.\n\n### Step 1: Problem Validation\n\n**1.1. Extract Givens**\n-   **Constitutive Model**: Small-strain, isotropic, associative elastoplasticity with von Mises yield condition and linear isotropic hardening.\n-   **Elastic Properties**: Young's modulus $E=210\\times 10^{9}$ Pa, Poisson’s ratio $\\nu=0.30$.\n-   **Plastic Properties**: Initial yield stress $\\sigma_{y0}=0.45\\times 10^{9}$ Pa, hardening modulus $H=2.5\\times 10^{9}$ Pa.\n-   **Yield Function**: $f(\\boldsymbol{\\sigma},\\kappa)=\\|\\boldsymbol{s}\\|-\\sqrt{\\frac{2}{3}}\\,\\sigma_{y}(\\kappa)$, where $\\boldsymbol{s}=\\boldsymbol{\\sigma}-\\frac{1}{3}\\,\\text{tr}(\\boldsymbol{\\sigma})\\,\\boldsymbol{I}$ and $\\|\\boldsymbol{s}\\|=\\sqrt{\\boldsymbol{s}:\\boldsymbol{s}}$.\n-   **Hardening Law**: $\\sigma_{y}(\\kappa)=\\sigma_{y0}+H\\,\\kappa$.\n-   **Flow Rule**: Associative flow $\\Delta\\boldsymbol{\\varepsilon}^{p}=\\Delta\\lambda\\,\\frac{\\partial f}{\\partial\\boldsymbol{\\sigma}}$.\n-   **Hardening Variable Update**: $\\Delta\\kappa=\\sqrt{\\frac{2}{3}}\\,\\Delta\\lambda$.\n-   **Initial Conditions (at step n)**: $\\boldsymbol{\\sigma}_{n}=\\boldsymbol{0}$, $\\boldsymbol{\\varepsilon}^{p}_{n}=\\boldsymbol{0}$, and $\\kappa_{n}=0$.\n-   **Applied Strain Increment**: Pure shear strain, with $\\Delta\\varepsilon_{xy}=0.01$ being the only non-zero component of the small strain tensor $\\Delta\\boldsymbol{\\varepsilon}$ (and by symmetry, $\\Delta\\varepsilon_{yx}=\\Delta\\varepsilon_{xy}$).\n\n**1.2. Validate Using Extracted Givens**\nThe problem is scientifically grounded, well-posed, and objective.\n-   **Scientific Soundness**: The problem describes a classical J2 (von Mises) plasticity model with linear isotropic hardening, implemented with an implicit return mapping algorithm. This is a fundamental and standard topic in computational solid mechanics and geomechanics. All equations and concepts are based on established continuum mechanics principles.\n-   **Well-Posedness**: The problem provides all necessary material parameters, initial conditions, and the applied loading (strain increment). The structure is that of a typical time step in a finite element analysis, for which a unique solution is expected.\n-   **Objectivity**: The language is precise, and the quantities are defined formally. There are no subjective or ambiguous statements.\n-   **Relevance**: The problem is a direct application of the *return mapping algorithm (closest point projection)* for a standard geomechanical material model.\n\n**1.3. Verdict and Action**\nThe problem is valid. A complete solution will be provided.\n\n### Step 2: Solution Derivation\n\nFirst, we compute the necessary elastic constants. The shear modulus $G$ is given by:\n$$G = \\frac{E}{2(1+\\nu)} = \\frac{210 \\times 10^9}{2(1+0.30)} = \\frac{210 \\times 10^9}{2.6} = \\frac{1050}{13} \\times 10^9 \\, \\text{Pa}$$\n\nThe applied strain increment tensor $\\Delta\\boldsymbol{\\varepsilon}$ has only one independent non-zero component $\\Delta\\varepsilon_{xy}=0.01$. In matrix form:\n$$ \\Delta\\boldsymbol{\\varepsilon} = \\begin{pmatrix} 0  0.01  0 \\\\ 0.01  0  0 \\\\ 0  0  0 \\end{pmatrix} $$\nThe trace of the strain increment is $\\text{tr}(\\Delta\\boldsymbol{\\varepsilon}) = 0$. This means the strain increment is purely deviatoric, i.e., $\\Delta\\boldsymbol{\\varepsilon}^{\\text{dev}} = \\Delta\\boldsymbol{\\varepsilon}$.\n\n**2.1. Elastic Predictor**\n\nIn the predictor step, we assume the material response is purely elastic. The trial state is computed by assuming the plastic strain increment is zero, $\\Delta\\boldsymbol{\\varepsilon}^{p} = \\boldsymbol{0}$.\nThe trial stress increment is calculated from Hooke's law. Since the strain is purely deviatoric, the stress response will also be purely deviatoric. The deviatoric stress-strain relation is $\\boldsymbol{s} = 2G \\boldsymbol{\\varepsilon}^{\\text{dev}}$.\nThe trial deviatoric stress $\\boldsymbol{s}^{\\text{trial}}$ is:\n$$\\boldsymbol{s}^{\\text{trial}} = 2G \\Delta\\boldsymbol{\\varepsilon}^{\\text{dev}} = 2G \\Delta\\boldsymbol{\\varepsilon}$$\nSince $\\boldsymbol{\\sigma}_{n}=\\boldsymbol{0}$, the total trial stress is $\\boldsymbol{\\sigma}^{\\text{trial}} = \\boldsymbol{s}^{\\text{trial}}$. The only non-zero components are:\n$$ s^{\\text{trial}}_{xy} = s^{\\text{trial}}_{yx} = 2G \\Delta\\varepsilon_{xy} = 2 \\left(\\frac{1050}{13} \\times 10^9 \\right) (0.01) = \\frac{21}{13} \\times 10^9 \\, \\text{Pa} $$\nNext, we compute the von Mises equivalent stress, which is the norm of the deviatoric stress tensor, $\\|\\boldsymbol{s}^{\\text{trial}}\\|=\\sqrt{\\boldsymbol{s}^{\\text{trial}}:\\boldsymbol{s}^{\\text{trial}}}$:\n$$ \\|\\boldsymbol{s}^{\\text{trial}}\\| = \\sqrt{\\sum_{i,j} (s^{\\text{trial}}_{ij})^2} = \\sqrt{(s^{\\text{trial}}_{xy})^2 + (s^{\\text{trial}}_{yx})^2} = \\sqrt{2 (s^{\\text{trial}}_{xy})^2} = \\sqrt{2} |s^{\\text{trial}}_{xy}| $$\n$$ \\|\\boldsymbol{s}^{\\text{trial}}\\| = \\sqrt{2} \\left(\\frac{21}{13} \\times 10^9\\right) = \\frac{21\\sqrt{2}}{13} \\times 10^9 \\, \\text{Pa} $$\nWe check for yielding by evaluating the yield function at the trial state. Since $\\kappa_n=0$, the yield stress is $\\sigma_y(\\kappa_n)=\\sigma_{y0}$.\n$$ f^{\\text{trial}} = \\|\\boldsymbol{s}^{\\text{trial}}\\| - \\sqrt{\\frac{2}{3}} \\sigma_{y0} $$\nUsing the given values $\\sigma_{y0}=0.45\\times 10^{9} = \\frac{9}{20} \\times 10^{9}$ Pa:\n$$ \\sqrt{\\frac{2}{3}} \\sigma_{y0} = \\sqrt{\\frac{2}{3}} \\left( \\frac{9}{20} \\times 10^9 \\right) = \\frac{3\\sqrt{6}}{20} \\times 10^9 \\, \\text{Pa} $$\nNumerically, $\\|\\boldsymbol{s}^{\\text{trial}}\\| \\approx 2.284 \\times 10^9$ Pa and $\\sqrt{2/3}\\,\\sigma_{y0} \\approx 0.367 \\times 10^9$ Pa.\nSince $\\|\\boldsymbol{s}^{\\text{trial}}\\|  \\sqrt{2/3}\\,\\sigma_{y0}$, we have $f^{\\text{trial}}  0$. The trial state is outside the yield surface, so plastic deformation occurs, and a plastic correction is required.\n\n**2.2. Plastic Corrector**\n\nThe plastic corrector step projects the trial stress back to the updated yield surface. The updated stress at step $n+1$ is given by:\n$$ \\boldsymbol{s}_{n+1} = \\boldsymbol{s}^{\\text{trial}} - 2G \\Delta\\boldsymbol{\\varepsilon}^p $$\nThe associative flow rule is $\\Delta\\boldsymbol{\\varepsilon}^p = \\Delta\\lambda \\frac{\\partial f}{\\partial \\boldsymbol{\\sigma}}$. For the von Mises yield function, this derivative is the unit normal to the yield surface:\n$$ \\frac{\\partial f}{\\partial \\boldsymbol{\\sigma}} = \\frac{\\boldsymbol{s}}{\\|\\boldsymbol{s}\\|} = \\boldsymbol{N} $$\nThe closest-point projection algorithm gives that the direction of the plastic return is radial, so $\\boldsymbol{N}_{n+1} = \\boldsymbol{N}^{\\text{trial}} = \\frac{\\boldsymbol{s}^{\\text{trial}}}{\\|\\boldsymbol{s}^{\\text{trial}}\\|}$. Thus:\n$$ \\boldsymbol{s}_{n+1} = \\boldsymbol{s}^{\\text{trial}} - 2G \\Delta\\lambda \\frac{\\boldsymbol{s}^{\\text{trial}}}{\\|\\boldsymbol{s}^{\\text{trial}}\\|} = \\left(1 - \\frac{2G \\Delta\\lambda}{\\|\\boldsymbol{s}^{\\text{trial}}\\|}\\right) \\boldsymbol{s}^{\\text{trial}} $$\nTaking the norm of this equation gives:\n$$ \\|\\boldsymbol{s}_{n+1}\\| = \\|\\boldsymbols^{\\text{trial}}\\| - 2G \\Delta\\lambda $$\nThe consistency condition at step $n+1$ requires $f(\\boldsymbol{\\sigma}_{n+1}, \\kappa_{n+1}) = 0$, which implies:\n$$ \\|\\boldsymbol{s}_{n+1}\\| = \\sqrt{\\frac{2}{3}} \\sigma_y(\\kappa_{n+1}) $$\nUsing the linear hardening law $\\sigma_y(\\kappa_{n+1}) = \\sigma_{y0} + H\\kappa_{n+1}$ and the hardening variable update $\\kappa_{n+1} = \\kappa_n + \\Delta\\kappa = 0 + \\sqrt{\\frac{2}{3}}\\Delta\\lambda$, we have:\n$$ \\|\\boldsymbol{s}_{n+1}\\| = \\sqrt{\\frac{2}{3}} \\left( \\sigma_{y0} + H\\sqrt{\\frac{2}{3}}\\Delta\\lambda \\right) = \\sqrt{\\frac{2}{3}}\\sigma_{y0} + \\frac{2}{3}H\\Delta\\lambda $$\nEquating the two expressions for $\\|\\boldsymbol{s}_{n+1}\\|$ allows us to solve for the plastic multiplier $\\Delta\\lambda$:\n$$ \\|\\boldsymbol{s}^{\\text{trial}}\\| - 2G \\Delta\\lambda = \\sqrt{\\frac{2}{3}}\\sigma_{y0} + \\frac{2}{3}H\\Delta\\lambda $$\n$$ \\|\\boldsymbol{s}^{\\text{trial}}\\| - \\sqrt{\\frac{2}{3}}\\sigma_{y0} = \\left( 2G + \\frac{2}{3}H \\right) \\Delta\\lambda $$\nThe left side is the trial yield function, $f^{\\text{trial}}$. So,\n$$ \\Delta\\lambda = \\frac{f^{\\text{trial}}}{2G + \\frac{2}{3}H} = \\frac{\\|\\boldsymbol{s}^{\\text{trial}}\\| - \\sqrt{\\frac{2}{3}}\\sigma_{y0}}{2G + \\frac{2}{3}H} $$\nWe now substitute the numerical values in their exact forms.\nNumerator: $f^{\\text{trial}} = \\left( \\frac{21\\sqrt{2}}{13} - \\frac{3\\sqrt{6}}{20} \\right) \\times 10^9$ Pa.\nDenominator: using $H=2.5 \\times 10^9 = \\frac{5}{2} \\times 10^9$ Pa,\n$$ 2G + \\frac{2}{3}H = \\left( 2 \\cdot \\frac{1050}{13} + \\frac{2}{3} \\cdot \\frac{5}{2} \\right) \\times 10^9 = \\left( \\frac{2100}{13} + \\frac{5}{3} \\right) \\times 10^9 = \\left( \\frac{6300+65}{39} \\right) \\times 10^9 = \\frac{6365}{39} \\times 10^9 \\, \\text{Pa} $$\nNow, we compute $\\Delta\\lambda$:\n$$ \\Delta\\lambda = \\frac{\\left( \\frac{21\\sqrt{2}}{13} - \\frac{3\\sqrt{6}}{20} \\right) \\times 10^9}{\\frac{6365}{39} \\times 10^9} = \\frac{39}{6365} \\left( \\frac{420\\sqrt{2} - 39\\sqrt{6}}{260} \\right) $$\nThis expression is complicated. A more direct path is:\n$$ \\Delta\\lambda = \\frac{39}{6365} \\left( \\frac{21\\sqrt{2}}{13} - \\frac{3\\sqrt{6}}{20} \\right) = \\frac{3 \\cdot 21\\sqrt{2}}{6365} - \\frac{39 \\cdot 3\\sqrt{6}}{6365 \\cdot 20} = \\frac{63\\sqrt{2}}{6365} - \\frac{117\\sqrt{6}}{127300} $$\nCreating a common denominator of $127300$:\n$$ \\Delta\\lambda = \\frac{20 \\cdot 63\\sqrt{2} - 117\\sqrt{6}}{127300} = \\frac{1260\\sqrt{2} - 117\\sqrt{6}}{127300} $$\n\n**2.3. Compute Final Quantities**\nWith $\\Delta\\lambda$, we can find the other requested quantities.\n\n**Plastic Strain Increment Component $\\Delta\\varepsilon^{p}_{xy}$**:\nThe plastic strain increment is $\\Delta\\boldsymbol{\\varepsilon}^{p} = \\Delta\\lambda \\boldsymbol{N}^{\\text{trial}} = \\Delta\\lambda \\frac{\\boldsymbol{s}^{\\text{trial}}}{\\|\\boldsymbol{s}^{\\text{trial}}\\|}$.\n$$ \\boldsymbol{N}^{\\text{trial}} = \\frac{1}{\\sqrt{2}s^{\\text{trial}}_{xy}} \\begin{pmatrix} 0  s^{\\text{trial}}_{xy}  0 \\\\ s^{\\text{trial}}_{xy}  0  0 \\\\ 0  0  0 \\end{pmatrix} = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 0  1  0 \\\\ 1  0  0 \\\\ 0  0  0 \\end{pmatrix} $$\nThe requested component is:\n$$ \\Delta\\varepsilon^{p}_{xy} = \\Delta\\lambda \\frac{1}{\\sqrt{2}} = \\frac{1}{\\sqrt{2}} \\left( \\frac{1260\\sqrt{2} - 117\\sqrt{6}}{127300} \\right) = \\frac{1260 - 117\\sqrt{3}}{127300} $$\n\n**Hardening Increment $\\Delta\\kappa$**:\nThe update is given by $\\Delta\\kappa = \\sqrt{\\frac{2}{3}}\\Delta\\lambda$.\n$$ \\Delta\\kappa = \\sqrt{\\frac{2}{3}} \\left( \\frac{1260\\sqrt{2} - 117\\sqrt{6}}{127300} \\right) = \\frac{\\sqrt{2}}{\\sqrt{3}} \\frac{1260\\sqrt{2} - 117\\sqrt{3 \\cdot 2}}{127300} = \\frac{2 \\cdot 1260 - 117\\sqrt{2}\\sqrt{2}\\sqrt{3}}{127300\\sqrt{3}} $$\n$$ \\Delta\\kappa = \\frac{2520 - 234\\sqrt{3}}{127300\\sqrt{3}} = \\frac{\\sqrt{3}(2520 - 234\\sqrt{3})}{381900} = \\frac{2520\\sqrt{3} - 702}{381900} $$\nSimplifying by dividing numerator and denominator by common factors ($2\\cdot3=6$):\n$$ \\Delta\\kappa = \\frac{420\\sqrt{3} - 117}{63650} $$\n\n**Verification of Yield Condition $f_{n+1}$**:\nThe plastic multiplier $\\Delta\\lambda$ was derived specifically to satisfy the consistency condition $f_{n+1} = 0$. By construction, substituting the derived $\\Delta\\lambda$ back into the equations for $\\|\\boldsymbol{s}_{n+1}\\|$ and $\\sigma_y(\\kappa_{n+1})$ will result in $\\|\\boldsymbol{s}_{n+1}\\| = \\sqrt{2/3} \\sigma_y(\\kappa_{n+1})$. Therefore, $f_{n+1} = 0$ must hold exactly.\n\n**Summary of Results**:\n1.  $\\Delta\\lambda = \\frac{1260\\sqrt{2} - 117\\sqrt{6}}{127300}$\n2.  $\\Delta\\varepsilon^{p}_{xy} = \\frac{1260 - 117\\sqrt{3}}{127300}$\n3.  $\\Delta\\kappa = \\frac{420\\sqrt{3} - 117}{63650}$\n4.  $f_{n+1} = 0$\n\nThese expressions are exact and cannot be simplified further.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{1260\\sqrt{2} - 117\\sqrt{6}}{127300}  \\frac{1260 - 117\\sqrt{3}}{127300}  \\frac{420\\sqrt{3} - 117}{63650}  0\n\\end{pmatrix}\n}\n$$", "id": "3556863"}, {"introduction": "Having mastered the basic mechanics, we now turn to the geometric interpretation of the algorithm, which is crucial for building intuition. This exercise explores the return mapping process in the pressure-invariant ($p$) versus deviatoric-invariant ($q$) stress space, a standard framework for geomaterials [@problem_id:3556917]. By analyzing a non-associated Drucker-Prager model, you will demonstrate why the stress correction path is not necessarily perpendicular to the yield surface, a key feature distinguishing many geological materials.", "problem": "Consider a small-strain isotropic elastoplastic soil under triaxial-type stress states, characterized by the stress invariants $p = \\tfrac{1}{3}\\,\\mathrm{tr}\\,\\boldsymbol{\\sigma}$ and $q = \\sqrt{\\tfrac{3}{2}\\,\\boldsymbol{s}:\\boldsymbol{s}}$, where $\\boldsymbol{s} = \\boldsymbol{\\sigma} - p\\,\\boldsymbol{I}$ is the deviatoric stress. Let the elastic response be linear isotropic with bulk modulus $K$ and shear modulus $G$. The plasticity model is defined by a yield function $f(p,q;H)=0$ and a (possibly non-associated) plastic potential $g(p,q)$, with the incremental plastic flow rule (Prandtl–Reuss type) $d\\boldsymbol{\\varepsilon}^{p} = d\\lambda\\,\\partial g/\\partial \\boldsymbol{\\sigma}$, where $d\\lambda \\ge 0$ is the plastic multiplier. The scalar plastic strain invariants are $d\\varepsilon_{v}^{p} = \\mathrm{tr}\\,d\\boldsymbol{\\varepsilon}^{p}$ and $d\\varepsilon_{s}^{p} = \\sqrt{\\tfrac{2}{3}\\,d\\boldsymbol{\\varepsilon}_{\\mathrm{dev}}^{p} : d\\boldsymbol{\\varepsilon}_{\\mathrm{dev}}^{p}}$, with $d\\boldsymbol{\\varepsilon}_{\\mathrm{dev}}^{p} = d\\boldsymbol{\\varepsilon}^{p} - \\tfrac{1}{3}d\\varepsilon_{v}^{p}\\boldsymbol{I}$.\n\nAssume a Drucker–Prager type yield surface $f(p,q;H) = q + M\\,p - \\sigma_{y}(H)$ with $M0$, and a non-associated linear plastic potential $g(p,q) = q + m\\,p$ with $m \\neq M$. Consider a trial state $(p_{\\mathrm{tr}},q_{\\mathrm{tr}})$ lying outside the yield surface, $f(p_{\\mathrm{tr}},q_{\\mathrm{tr}};H)0$. A single return-mapping corrector step adjusts the stress by $\\Delta\\boldsymbol{\\sigma}$ to a state $(p,q)$ satisfying $f(p,q;H)=0$, while holding the total strain fixed during the corrector. \n\nUsing only the standard small-strain kinematics, the given elastic moduli, and the definitions of the invariants and flow rule (no other specialized formulas), do the following:\n\n1) Derive the direction of the stress corrector in the $(p,q)$ plane and show that, when $g\\neq f$, the projection path in $(p,q)$ space is oblique with respect to the Euclidean normal to the yield surface. In particular, obtain the ratio $\\Delta q / \\Delta p$ in terms of $K$, $G$, and the partial derivatives $\\partial g/\\partial p$ and $\\partial g/\\partial q$, and compare this to the components of the Euclidean normal to $f(p,q;H)=0$.\n\n2) Using the tensorial flow rule and the definitions of the invariants, compute the plastic volumetric and equivalent shear strain increments $\\Delta \\varepsilon_{v}^{p}$ and $\\Delta \\varepsilon_{s}^{p}$ in terms of the plastic multiplier increment $\\Delta \\lambda$ for the given plastic potential $g(p,q) = q + m\\,p$.\n\nExpress your final answer as a single row matrix containing $\\Delta \\varepsilon_{v}^{p}$ and $\\Delta \\varepsilon_{s}^{p}$. No numerical values are required. Do not include units in the final answer.", "solution": "The problem is first validated against the specified criteria.\n\n### Step 1: Extract Givens\n- Stress invariants: $p = \\tfrac{1}{3}\\,\\mathrm{tr}\\,\\boldsymbol{\\sigma}$ and $q = \\sqrt{\\tfrac{3}{2}\\,\\boldsymbol{s}:\\boldsymbol{s}}$.\n- Deviatoric stress: $\\boldsymbol{s} = \\boldsymbol{\\sigma} - p\\,\\boldsymbol{I}$.\n- Elastic response: Linear isotropic with bulk modulus $K$ and shear modulus $G$.\n- Plasticity model: Yield function $f(p,q;H)=0$, plastic potential $g(p,q)$.\n- Flow rule: $d\\boldsymbol{\\varepsilon}^{p} = d\\lambda\\,\\partial g/\\partial \\boldsymbol{\\sigma}$, with $d\\lambda \\ge 0$.\n- Plastic strain invariants: $d\\varepsilon_{v}^{p} = \\mathrm{tr}\\,d\\boldsymbol{\\varepsilon}^{p}$ and $d\\varepsilon_{s}^{p} = \\sqrt{\\tfrac{2}{3}\\,d\\boldsymbol{\\varepsilon}_{\\mathrm{dev}}^{p} : d\\boldsymbol{\\varepsilon}_{\\mathrm{dev}}^{p}}$.\n- Deviatoric plastic strain increment: $d\\boldsymbol{\\varepsilon}_{\\mathrm{dev}}^{p} = d\\boldsymbol{\\varepsilon}^{p} - \\tfrac{1}{3}d\\varepsilon_{v}^{p}\\boldsymbol{I}$.\n- Yield function: $f(p,q;H) = q + M\\,p - \\sigma_{y}(H)$ with $M0$.\n- Plastic potential: $g(p,q) = q + m\\,p$ with $m \\neq M$.\n- Trial state: $(p_{\\mathrm{tr}},q_{\\mathrm{tr}})$ is outside the yield surface, $f(p_{\\mathrm{tr}},q_{\\mathrm{tr}};H)0$.\n- Corrector step: The total strain is held fixed, i.e., the total strain increment $\\Delta\\boldsymbol{\\varepsilon} = \\boldsymbol{0}$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem statement is consistent with the standard theory of rate-independent small-strain elastoplasticity used in computational geomechanics. All provided definitions, such as stress invariants, the flow rule, and the specific forms of the Drucker-Prager yield function and plastic potential, are standard in the field. The task involves deriving relationships within this established framework, which is a formalizable and well-posed scientific problem. The language is objective and precise. No flaws related to scientific soundness, completeness, objectivity, or verifiability are detected.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete solution will be provided.\n\n---\n\nThe solution is divided into two parts as requested.\n\n### Part 1: Direction of the Stress Corrector\n\nThe return mapping corrector step is performed at constant total strain. This implies that the total strain increment is zero:\n$$\n\\Delta\\boldsymbol{\\varepsilon} = \\mathbf{0}\n$$\nThe total strain increment is the sum of the elastic and plastic increments:\n$$\n\\Delta\\boldsymbol{\\varepsilon} = \\Delta\\boldsymbol{\\varepsilon}^{e} + \\Delta\\boldsymbol{\\varepsilon}^{p} = \\mathbf{0} \\implies \\Delta\\boldsymbol{\\varepsilon}^{e} = -\\Delta\\boldsymbol{\\varepsilon}^{p}\n$$\nThe incremental elastic stress-strain relationship is $\\Delta\\boldsymbol{\\sigma} = \\boldsymbol{C}^{e} : \\Delta\\boldsymbol{\\varepsilon}^{e}$, where $\\boldsymbol{C}^{e}$ is the isotropic elastic stiffness tensor. The stress corrector $\\Delta\\boldsymbol{\\sigma}$ is therefore:\n$$\n\\Delta\\boldsymbol{\\sigma} = -\\boldsymbol{C}^{e} : \\Delta\\boldsymbol{\\varepsilon}^{p}\n$$\nThe plastic strain increment is given by the flow rule:\n$$\n\\Delta\\boldsymbol{\\varepsilon}^{p} = \\Delta\\lambda\\,\\frac{\\partial g}{\\partial \\boldsymbol{\\sigma}}\n$$\nwhere $\\Delta\\lambda$ is the finite plastic multiplier increment for the step. The plastic potential $g$ is a function of the stress invariants $p$ and $q$. Using the chain rule, we can write:\n$$\n\\frac{\\partial g}{\\partial \\boldsymbol{\\sigma}} = \\frac{\\partial g}{\\partial p}\\frac{\\partial p}{\\partial \\boldsymbol{\\sigma}} + \\frac{\\partial g}{\\partial q}\\frac{\\partial q}{\\partial \\boldsymbol{\\sigma}}\n$$\nThe derivatives of the invariants with respect to the stress tensor $\\boldsymbol{\\sigma}$ are:\n$$\n\\frac{\\partial p}{\\partial \\boldsymbol{\\sigma}} = \\frac{1}{3}\\boldsymbol{I} \\quad \\text{and} \\quad \\frac{\\partial q}{\\partial \\boldsymbol{\\sigma}} = \\frac{3}{2q}\\boldsymbol{s}\n$$\nwhere $\\boldsymbol{I}$ is the second-order identity tensor and $\\boldsymbol{s}$ is the deviatoric stress tensor.\nThus, the plastic flow direction tensor is:\n$$\n\\frac{\\partial g}{\\partial \\boldsymbol{\\sigma}} = \\frac{\\partial g}{\\partial p}\\frac{1}{3}\\boldsymbol{I} + \\frac{\\partial g}{\\partial q}\\frac{3}{2q}\\boldsymbol{s}\n$$\nThe stress corrector is then:\n$$\n\\Delta\\boldsymbol{\\sigma} = -\\Delta\\lambda\\,\\boldsymbol{C}^{e} : \\left( \\frac{\\partial g}{\\partial p}\\frac{1}{3}\\boldsymbol{I} + \\frac{\\partial g}{\\partial q}\\frac{3}{2q}\\boldsymbol{s} \\right)\n$$\nFor an isotropic elastic material, the action of $\\boldsymbol{C}^e$ on second-order tensors can be expressed using the bulk modulus $K$ and shear modulus $G$ as $\\boldsymbol{C}^e : \\boldsymbol{I} = 3K \\cdot \\frac{1}{3}\\boldsymbol{I} = K\\boldsymbol{I}$ and $\\boldsymbol{C}^e : \\boldsymbol{s} = 2G\\boldsymbol{s}$. Substituting these into the expression for $\\Delta\\boldsymbol{\\sigma}$ yields:\n$$\n\\Delta\\boldsymbol{\\sigma} = -\\Delta\\lambda \\left( \\frac{\\partial g}{\\partial p} K\\boldsymbol{I} + \\frac{\\partial g}{\\partial q} \\frac{3}{2q} (2G\\boldsymbol{s}) \\right) = -\\Delta\\lambda \\left( K \\frac{\\partial g}{\\partial p} \\boldsymbol{I} + \\frac{3G}{q} \\frac{\\partial g}{\\partial q} \\boldsymbol{s} \\right)\n$$\nThe change in mean stress, $\\Delta p$, is one-third of the trace of $\\Delta\\boldsymbol{\\sigma}$:\n$$\n\\Delta p = \\frac{1}{3}\\mathrm{tr}(\\Delta\\boldsymbol{\\sigma}) = \\frac{1}{3}\\mathrm{tr}\\left[-\\Delta\\lambda \\left( K \\frac{\\partial g}{\\partial p} \\boldsymbol{I} + \\frac{3G}{q} \\frac{\\partial g}{\\partial q} \\boldsymbol{s} \\right)\\right]\n$$\nSince $\\mathrm{tr}(\\boldsymbol{I})=3$ and $\\mathrm{tr}(\\boldsymbol{s})=0$, this simplifies to:\n$$\n\\Delta p = -\\frac{\\Delta\\lambda}{3} \\left( K \\frac{\\partial g}{\\partial p} \\cdot 3 \\right) = -K \\Delta\\lambda \\frac{\\partial g}{\\partial p}\n$$\nThe change in deviatoric stress $\\Delta \\boldsymbol{s}$ is found by subtracting the hydrostatic part from the total stress change: $\\Delta \\boldsymbol{s} = \\Delta\\boldsymbol{\\sigma} - \\Delta p \\boldsymbol{I}$.\n$$\n\\Delta\\boldsymbol{s} = \\left[-\\Delta\\lambda \\left( K \\frac{\\partial g}{\\partial p} \\boldsymbol{I} + \\frac{3G}{q} \\frac{\\partial g}{\\partial q} \\boldsymbol{s} \\right)\\right] - \\left(-K \\Delta\\lambda \\frac{\\partial g}{\\partial p}\\right)\\boldsymbol{I} = -\\Delta\\lambda \\frac{3G}{q} \\frac{\\partial g}{\\partial q} \\boldsymbol{s}\n$$\nThe change in the deviatoric stress invariant, $\\Delta q$, can be approximated for a small step by $dq = \\frac{\\partial q}{\\partial \\boldsymbol{\\sigma}} : d\\boldsymbol{\\sigma} = \\frac{3}{2q}\\boldsymbol{s} : d\\boldsymbol{\\sigma}$. The deviatoric part of $d\\boldsymbol{\\sigma}$ is $d\\boldsymbol{s}$, so $dq = \\frac{3}{2q}\\boldsymbol{s} : d\\boldsymbol{s}$. Applying this to finite increments:\n$$\n\\Delta q \\approx \\frac{3}{2q}\\boldsymbol{s} : \\Delta\\boldsymbol{s} = \\frac{3}{2q}\\boldsymbol{s} : \\left(-\\Delta\\lambda \\frac{3G}{q} \\frac{\\partial g}{\\partial q} \\boldsymbol{s}\\right) = -\\frac{9G\\Delta\\lambda}{2q^2} \\frac{\\partial g}{\\partial q} (\\boldsymbol{s}:\\boldsymbol{s})\n$$\nUsing the definition $q^2 = \\frac{3}{2}\\boldsymbol{s}:\\boldsymbol{s}$, we have $\\boldsymbol{s}:\\boldsymbol{s} = \\frac{2}{3}q^2$. Substituting this in:\n$$\n\\Delta q = -\\frac{9G\\Delta\\lambda}{2q^2} \\frac{\\partial g}{\\partial q} \\left(\\frac{2}{3}q^2\\right) = -3G \\Delta\\lambda \\frac{\\partial g}{\\partial q}\n$$\nThe ratio $\\Delta q / \\Delta p$ defines the slope of the stress corrector path in the $(p,q)$ plane:\n$$\n\\frac{\\Delta q}{\\Delta p} = \\frac{-3G \\Delta\\lambda \\frac{\\partial g}{\\partial q}}{-K \\Delta\\lambda \\frac{\\partial g}{\\partial p}} = \\frac{3G}{K} \\frac{\\partial g / \\partial q}{\\partial g / \\partial p}\n$$\nThe Euclidean normal to the yield surface $f(p,q;H) = q + M p - \\sigma_y(H) = 0$ is given by the gradient vector $\\nabla f = (\\frac{\\partial f}{\\partial p}, \\frac{\\partial f}{\\partial q}) = (M, 1)$. The slope of the normal direction in the $(p,q)$ plane is $\\frac{1}{M}$.\n\nThe direction of the stress correction $(\\Delta p, \\Delta q)$ is normal to the yield surface if the path's slope equals the normal's slope:\n$$\n\\frac{\\Delta q}{\\Delta p} = \\frac{1}{M} \\implies \\frac{3G}{K} \\frac{\\partial g / \\partial q}{\\partial g / \\partial p} = \\frac{1}{M}\n$$\nFor the given plastic potential $g(p,q)=q+mp$, we have $\\partial g/\\partial p = m$ and $\\partial g/\\partial q = 1$. The condition for normality becomes:\n$$\n\\frac{3G}{K} \\frac{1}{m} = \\frac{1}{M} \\implies 3GM = Km\n$$\nThe problem specifies a non-associated flow rule, meaning $m \\neq M$. Further, the condition $3G=K$ is a specific material property relation that is not generally true. Therefore, the condition $3GM=Km$ is not satisfied in general. This demonstrates that for a non-associated flow rule, the return path in $(p,q)$ space is oblique to the Euclidean normal of the yield surface.\n\n### Part 2: Plastic Strain Increments\n\nWe need to compute the plastic volumetric strain increment $\\Delta \\varepsilon_{v}^{p}$ and the equivalent plastic shear strain increment $\\Delta \\varepsilon_{s}^{p}$.\n\nThe plastic volumetric strain increment is defined as $d\\varepsilon_{v}^{p} = \\mathrm{tr}(d\\boldsymbol{\\varepsilon}^{p})$. Using the flow rule:\n$$\nd\\varepsilon_{v}^{p} = \\mathrm{tr}\\left(d\\lambda\\,\\frac{\\partial g}{\\partial \\boldsymbol{\\sigma}}\\right) = d\\lambda\\,\\mathrm{tr}\\left(\\frac{\\partial g}{\\partial p}\\frac{1}{3}\\boldsymbol{I} + \\frac{\\partial g}{\\partial q}\\frac{3}{2q}\\boldsymbol{s}\\right)\n$$\n$$\nd\\varepsilon_{v}^{p} = d\\lambda\\left(\\frac{\\partial g}{\\partial p}\\frac{1}{3}\\mathrm{tr}(\\boldsymbol{I}) + \\frac{\\partial g}{\\partial q}\\frac{3}{2q}\\mathrm{tr}(\\boldsymbol{s})\\right) = d\\lambda\\left(\\frac{\\partial g}{\\partial p}\\frac{3}{3} + 0\\right) = d\\lambda\\,\\frac{\\partial g}{\\partial p}\n$$\nFor the given plastic potential $g(p,q) = q+mp$, we have $\\partial g/\\partial p = m$. Thus, for a finite increment $\\Delta\\lambda$:\n$$\n\\Delta \\varepsilon_{v}^{p} = m\\,\\Delta\\lambda\n$$\nThe equivalent plastic shear strain increment is $d\\varepsilon_{s}^{p} = \\sqrt{\\tfrac{2}{3}\\,d\\boldsymbol{\\varepsilon}_{\\mathrm{dev}}^{p} : d\\boldsymbol{\\varepsilon}_{\\mathrm{dev}}^{p}}$. First, we find the deviatoric plastic strain increment, $d\\boldsymbol{\\varepsilon}_{\\mathrm{dev}}^{p} = d\\boldsymbol{\\varepsilon}^p - \\tfrac{1}{3}d\\varepsilon_v^p\\boldsymbol{I}$:\n$$\nd\\boldsymbol{\\varepsilon}_{\\mathrm{dev}}^{p} = d\\lambda\\left(\\frac{\\partial g}{\\partial p}\\frac{1}{3}\\boldsymbol{I} + \\frac{\\partial g}{\\partial q}\\frac{3}{2q}\\boldsymbol{s}\\right) - \\frac{1}{3}\\left(d\\lambda\\frac{\\partial g}{\\partial p}\\right)\\boldsymbol{I} = d\\lambda\\,\\frac{\\partial g}{\\partial q}\\frac{3}{2q}\\boldsymbol{s}\n$$\nNow we compute the inner product $d\\boldsymbol{\\varepsilon}_{\\mathrm{dev}}^{p} : d\\boldsymbol{\\varepsilon}_{\\mathrm{dev}}^{p}$:\n$$\nd\\boldsymbol{\\varepsilon}_{\\mathrm{dev}}^{p} : d\\boldsymbol{\\varepsilon}_{\\mathrm{dev}}^{p} = \\left(d\\lambda\\,\\frac{\\partial g}{\\partial q}\\frac{3}{2q}\\boldsymbol{s}\\right) : \\left(d\\lambda\\,\\frac{\\partial g}{\\partial q}\\frac{3}{2q}\\boldsymbol{s}\\right) = (d\\lambda)^2 \\left(\\frac{\\partial g}{\\partial q}\\right)^2 \\frac{9}{4q^2} (\\boldsymbol{s}:\\boldsymbol{s})\n$$\nSubstituting $\\boldsymbol{s}:\\boldsymbol{s} = \\frac{2}{3}q^2$:\n$$\nd\\boldsymbol{\\varepsilon}_{\\mathrm{dev}}^{p} : d\\boldsymbol{\\varepsilon}_{\\mathrm{dev}}^{p} = (d\\lambda)^2 \\left(\\frac{\\partial g}{\\partial q}\\right)^2 \\frac{9}{4q^2} \\left(\\frac{2}{3}q^2\\right) = (d\\lambda)^2 \\left(\\frac{\\partial g}{\\partial q}\\right)^2 \\frac{3}{2}\n$$\nFinally, we calculate $d\\varepsilon_{s}^{p}$:\n$$\nd\\varepsilon_{s}^{p} = \\sqrt{\\frac{2}{3}\\left[(d\\lambda)^2 \\left(\\frac{\\partial g}{\\partial q}\\right)^2 \\frac{3}{2}\\right]} = \\sqrt{(d\\lambda)^2 \\left(\\frac{\\partial g}{\\partial q}\\right)^2} = d\\lambda \\left|\\frac{\\partial g}{\\partial q}\\right|\n$$\nFor the given plastic potential $g(p,q) = q+mp$, we have $\\partial g/\\partial q = 1$. Thus, for a finite increment $\\Delta\\lambda$:\n$$\n\\Delta\\varepsilon_{s}^{p} = \\Delta\\lambda\\,|1| = \\Delta\\lambda\n$$\nThe two requested quantities are $\\Delta \\varepsilon_{v}^{p} = m\\,\\Delta\\lambda$ and $\\Delta \\varepsilon_{s}^{p} = \\Delta\\lambda$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\nm\\,\\Delta\\lambda  \\Delta\\lambda\n\\end{pmatrix}\n}\n$$", "id": "3556917"}, {"introduction": "Our final exercise advances from single, smooth yield surfaces to the more general case of multi-surface plasticity. You are tasked with designing and implementing an active-set algorithm to solve the closest point projection problem for a polyhedral yield domain, which is common in models for jointed rock or advanced soil plasticity [@problem_id:3556874]. This practice bridges theory and application by requiring you to translate the Karush-Kuhn-Tucker (KKT) optimality conditions into a robust computational code.", "problem": "Consider a small-strain, rate-independent, associative, multi-surface plasticity model at the material-point level. The stress vector is denoted by $\\boldsymbol{\\sigma} \\in \\mathbb{R}^n$, the elastic stiffness tensor (represented here as a symmetric positive definite matrix in Voigt notation) by $\\mathbf{C} \\in \\mathbb{R}^{n \\times n}$, and the collection of yield functions by $\\{f_i(\\boldsymbol{\\sigma},\\boldsymbol{\\alpha})\\}_{i=1}^m$. The internal variables are collectively denoted by $\\boldsymbol{\\alpha}$. The admissible set is defined by the intersection of the elastic domains associated with the yield functions, namely $\\mathcal{F} := \\{\\boldsymbol{\\sigma} \\in \\mathbb{R}^n \\mid f_i(\\boldsymbol{\\sigma},\\boldsymbol{\\alpha}) \\le 0 \\ \\text{for all} \\ i=1,\\dots,m\\}$. Assume perfect plasticity for the computational task (no hardening), and consider linear multi-surface yield functions of the form $f_i(\\boldsymbol{\\sigma}) = \\boldsymbol{a}_i^\\top \\boldsymbol{\\sigma} - c_i$, where $\\boldsymbol{a}_i \\in \\mathbb{R}^n$ and $c_i \\in \\mathbb{R}$.\n\nStarting from fundamental principles of small-strain linear elasticity and associative plasticity with the normality rule, the local update problem for a given elastic trial stress $\\boldsymbol{\\sigma}^{\\mathrm{tr}}$ is posed as the Closest Point Projection problem:\n$$\n\\min_{\\boldsymbol{\\sigma} \\in \\mathbb{R}^n} \\ \\frac{1}{2}(\\boldsymbol{\\sigma} - \\boldsymbol{\\sigma}^{\\mathrm{tr}})^\\top \\mathbf{C}^{-1} (\\boldsymbol{\\sigma} - \\boldsymbol{\\sigma}^{\\mathrm{tr}}) \\quad \\text{subject to} \\quad f_i(\\boldsymbol{\\sigma}) \\le 0 \\quad \\text{for all} \\ i=1,\\dots,m.\n$$\nThe Karush–Kuhn–Tucker (KKT) conditions require stationarity, primal feasibility, dual feasibility, and complementary slackness. The algorithmic design must select and update an active set of constraints whose equalities define the current projection, and must remove any constraints leading to negative plastic multipliers in the KKT conditions.\n\nYour task is to:\n- Formulate the local problem starting from the fundamental base of small-strain linear elasticity, the normality rule of associative plasticity, and the Kuhn–Tucker conditions. Specialize the formulation to the polyhedral case $f_i(\\boldsymbol{\\sigma}) = \\boldsymbol{a}_i^\\top \\boldsymbol{\\sigma} - c_i$ under perfect plasticity to obtain a solvable quadratic program with linear inequality constraints.\n- Design an active set selection scheme for the Closest Point Projection that:\n  1. Starts from the elastic trial state,\n  2. Detects violation(s) of the yield constraints,\n  3. Solves the reduced KKT system for a candidate active set,\n  4. Removes constraints with negative Lagrange multipliers,\n  5. Adds the most violated inactive constraint until all constraints are satisfied and all active multipliers are nonnegative.\n- Implement a complete program that, for each test case provided below, computes the projected stress $\\boldsymbol{\\sigma}$ that solves the local problem, and returns the indices of the active set (using one-based indexing) at convergence.\n\nAll stresses must be expressed in Pascals ($\\mathrm{Pa}$). Angles are not involved. The final program output format must be a single line containing the results for all test cases as a comma-separated list enclosed in square brackets, where each test case result is a list of the form $[\\sigma_1,\\sigma_2,\\sigma_3,[i_1,i_2,\\dots]]$ with the stress components in $\\mathrm{Pa}$ and the active indices as integers.\n\nUse $n = 3$ and the following test suite. For each case, use the specified elastic stiffness $\\mathbf{C}$, yield facet normals $\\boldsymbol{a}_i$, thresholds $c_i$, and the elastic trial stress $\\boldsymbol{\\sigma}^{\\mathrm{tr}}$:\n\n- Case $1$ (happy path, elastic): \n  - $\\mathbf{C} = \\operatorname{diag}(2\\times 10^{11},1.5\\times 10^{11},1\\times 10^{11})$,\n  - $\\boldsymbol{a}_1 = [1,0,0]^\\top$, $c_1 = 1.0\\times 10^8$,\n  - $\\boldsymbol{a}_2 = [0,1,0]^\\top$, $c_2 = 1.2\\times 10^8$,\n  - $\\boldsymbol{a}_3 = [0,0,1]^\\top$, $c_3 = 6.0\\times 10^7$,\n  - $\\boldsymbol{a}_4 = [0.5,0.5,0]^\\top$, $c_4 = 2.0\\times 10^8$,\n  - $\\boldsymbol{\\sigma}^{\\mathrm{tr}} = [8.0\\times 10^7,9.0\\times 10^7,5.0\\times 10^7]^\\top$.\n\n- Case $2$ (single active constraint):\n  - $\\mathbf{C} = \\operatorname{diag}(2\\times 10^{11},1.5\\times 10^{11},1\\times 10^{11})$,\n  - $\\boldsymbol{a}_1 = [1,0,0]^\\top$, $c_1 = 1.0\\times 10^8$,\n  - $\\boldsymbol{a}_2 = [0,1,0]^\\top$, $c_2 = 1.2\\times 10^8$,\n  - $\\boldsymbol{a}_3 = [0,0,1]^\\top$, $c_3 = 6.0\\times 10^7$,\n  - $\\boldsymbol{a}_4 = [0.5,0.5,0]^\\top$, $c_4 = 2.0\\times 10^8$,\n  - $\\boldsymbol{\\sigma}^{\\mathrm{tr}} = [1.5\\times 10^8,1.0\\times 10^8,4.0\\times 10^7]^\\top$.\n\n- Case $3$ (multiple active constraints):\n  - $\\mathbf{C} = \\operatorname{diag}(2\\times 10^{11},1.5\\times 10^{11},1\\times 10^{11})$,\n  - $\\boldsymbol{a}_1 = [1,0,0]^\\top$, $c_1 = 1.0\\times 10^8$,\n  - $\\boldsymbol{a}_2 = [0,1,0]^\\top$, $c_2 = 1.2\\times 10^8$,\n  - $\\boldsymbol{a}_3 = [0,0,1]^\\top$, $c_3 = 6.0\\times 10^7$,\n  - $\\boldsymbol{a}_4 = [0.5,0.5,0]^\\top$, $c_4 = 2.0\\times 10^8$,\n  - $\\boldsymbol{\\sigma}^{\\mathrm{tr}} = [1.7\\times 10^8,1.5\\times 10^8,7.0\\times 10^7]^\\top$.\n\n- Case $4$ (boundary condition, zero plastic correction):\n  - $\\mathbf{C} = \\operatorname{diag}(2\\times 10^{11},1.5\\times 10^{11},1\\times 10^{11})$,\n  - $\\boldsymbol{a}_1 = [1,0,0]^\\top$, $c_1 = 1.0\\times 10^8$,\n  - $\\boldsymbol{a}_2 = [0,1,0]^\\top$, $c_2 = 1.2\\times 10^8$,\n  - $\\boldsymbol{a}_3 = [0,0,1]^\\top$, $c_3 = 6.0\\times 10^7$,\n  - $\\boldsymbol{a}_4 = [0.5,0.5,0]^\\top$, $c_4 = 2.0\\times 10^8$,\n  - $\\boldsymbol{\\sigma}^{\\mathrm{tr}} = [1.0\\times 10^8,9.0\\times 10^7,6.0\\times 10^7]^\\top$.\n\n- Case $5$ (oblique facet only active):\n  - $\\mathbf{C} = \\operatorname{diag}(2\\times 10^{11},1.5\\times 10^{11},1\\times 10^{11})$,\n  - $\\boldsymbol{a}_1 = [1,0,0]^\\top$, $c_1 = 3.0\\times 10^8$,\n  - $\\boldsymbol{a}_2 = [0,1,0]^\\top$, $c_2 = 3.0\\times 10^8$,\n  - $\\boldsymbol{a}_3 = [0,0,1]^\\top$, $c_3 = 3.0\\times 10^8$,\n  - $\\boldsymbol{a}_4 = [0.5,0.5,0]^\\top$, $c_4 = 2.0\\times 10^8$,\n  - $\\boldsymbol{\\sigma}^{\\mathrm{tr}} = [2.5\\times 10^8,2.5\\times 10^8,2.0\\times 10^7]^\\top$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element corresponds to one test case and is itself a list of the form $[\\sigma_1,\\sigma_2,\\sigma_3,[i_1,i_2,\\dots]]$ with stresses in $\\mathrm{Pa}$ and active indices as integers.", "solution": "The local stress update for associative, multi-surface plasticity can be derived from fundamental principles. In small-strain linear elasticity, with elastic stiffness $\\mathbf{C}$, the elastic predictor (trial) stress is computed as $\\boldsymbol{\\sigma}^{\\mathrm{tr}} = \\mathbf{C} : (\\boldsymbol{\\varepsilon}_n + \\Delta \\boldsymbol{\\varepsilon} - \\boldsymbol{\\varepsilon}^p_n)$, where $\\boldsymbol{\\varepsilon}_n$ is the strain at the start of the increment, $\\Delta \\boldsymbol{\\varepsilon}$ is the strain increment, and $\\boldsymbol{\\varepsilon}^p_n$ is the plastic strain at the start of the increment. If $\\boldsymbol{\\sigma}^{\\mathrm{tr}}$ violates one or more yield constraints, a plastic correction is required.\n\nIn associative plasticity, the plastic flow direction is governed by the normality rule, \n$$\n\\dot{\\boldsymbol{\\varepsilon}}^p = \\sum_{i=1}^m \\dot{\\lambda}_i \\frac{\\partial f_i}{\\partial \\boldsymbol{\\sigma}},\n$$\nwhere $\\dot{\\lambda}_i \\ge 0$ are plastic multipliers and $f_i(\\boldsymbol{\\sigma},\\boldsymbol{\\alpha}) \\le 0$ are yield functions. The Kuhn–Tucker conditions enforce\n$$\n\\dot{\\lambda}_i \\ge 0,\\quad f_i(\\boldsymbol{\\sigma},\\boldsymbol{\\alpha}) \\le 0,\\quad \\dot{\\lambda}_i \\, f_i(\\boldsymbol{\\sigma},\\boldsymbol{\\alpha}) = 0,\n$$\nensuring that plastic flow occurs only if a yield function is active and tight. For rate-independent perfect plasticity over a time step, one can formulate the incremental update as a variational inequality or, equivalently, as a projection problem: find the stress $\\boldsymbol{\\sigma}$ closest to the elastic predictor $\\boldsymbol{\\sigma}^{\\mathrm{tr}}$ in the metric induced by $\\mathbf{C}^{-1}$, subject to the yield constraints.\n\nThis leads to the Closest Point Projection problem:\n$$\n\\min_{\\boldsymbol{\\sigma} \\in \\mathbb{R}^n} \\ \\frac{1}{2}(\\boldsymbol{\\sigma} - \\boldsymbol{\\sigma}^{\\mathrm{tr}})^\\top \\mathbf{C}^{-1} (\\boldsymbol{\\sigma} - \\boldsymbol{\\sigma}^{\\mathrm{tr}}) \\quad \\text{s.t.} \\quad f_i(\\boldsymbol{\\sigma}) \\le 0 \\ \\forall i.\n$$\nFor linear multi-surface yield functions $f_i(\\boldsymbol{\\sigma}) = \\boldsymbol{a}_i^\\top \\boldsymbol{\\sigma} - c_i$, the constraints define a convex polyhedron (intersection of half-spaces), and the objective is strictly convex due to the positive definiteness of $\\mathbf{C}$. The KKT conditions for this quadratic program are:\n- Stationarity:\n$$\n\\mathbf{C}^{-1} (\\boldsymbol{\\sigma} - \\boldsymbol{\\sigma}^{\\mathrm{tr}}) + \\sum_{i=1}^m \\lambda_i \\boldsymbol{a}_i = \\boldsymbol{0},\n$$\nwhere $\\lambda_i \\ge 0$ are Lagrange multipliers.\n- Primal feasibility: $f_i(\\boldsymbol{\\sigma}) \\le 0$ for all $i$.\n- Dual feasibility: $\\lambda_i \\ge 0$ for all $i$.\n- Complementary slackness: $\\lambda_i f_i(\\boldsymbol{\\sigma}) = 0$ for all $i$.\n\nFrom stationarity, one obtains\n$$\n\\boldsymbol{\\sigma} = \\boldsymbol{\\sigma}^{\\mathrm{tr}} - \\mathbf{C}\\sum_{i=1}^m \\lambda_i \\boldsymbol{a}_i.\n$$\nLet $\\mathcal{A} \\subset \\{1,\\dots,m\\}$ denote the active set (constraints that are tight). For $j \\in \\mathcal{A}$, we impose $\\boldsymbol{a}_j^\\top \\boldsymbol{\\sigma} - c_j = 0$. Substituting the stationarity expression yields the linear system for the active multipliers:\n$$\n\\sum_{k \\in \\mathcal{A}} \\left(\\boldsymbol{a}_j^\\top \\mathbf{C} \\boldsymbol{a}_k \\right) \\lambda_k = \\boldsymbol{a}_j^\\top \\boldsymbol{\\sigma}^{\\mathrm{tr}} - c_j, \\quad \\text{for all} \\ j \\in \\mathcal{A}.\n$$\nIn matrix form, if $\\mathbf{A}_{\\mathcal{A}}$ collects the active normals columnwise, the Gram matrix $\\mathbf{G}_{\\mathcal{A}}$ has entries $G_{jk} = \\boldsymbol{a}_j^\\top \\mathbf{C} \\boldsymbol{a}_k$, and the right-hand side is $r_j = \\boldsymbol{a}_j^\\top \\boldsymbol{\\sigma}^{\\mathrm{tr}} - c_j$. Solving $\\mathbf{G}_{\\mathcal{A}} \\boldsymbol{\\lambda}_{\\mathcal{A}} = \\boldsymbol{r}_{\\mathcal{A}}$ gives the active multipliers. The projected stress then follows as\n$$\n\\boldsymbol{\\sigma} = \\boldsymbol{\\sigma}^{\\mathrm{tr}} - \\mathbf{C}\\sum_{k \\in \\mathcal{A}} \\lambda_k \\boldsymbol{a}_k.\n$$\n\nAn active set algorithm proceeds as follows:\n1. Initialize the active set $\\mathcal{A}$ based on the most violated constraint(s) at $\\boldsymbol{\\sigma}^{\\mathrm{tr}}$, or start empty if no violations are present within tolerance.\n2. Given $\\mathcal{A}$, solve the linear system for $\\boldsymbol{\\lambda}_{\\mathcal{A}}$.\n3. If any $\\lambda_k  0$ for $k \\in \\mathcal{A}$, remove the most negative multiplier’s constraint from $\\mathcal{A}$ and resolve. This enforces dual feasibility.\n4. With the computed $\\boldsymbol{\\sigma}$, check all inactive constraints. If any are violated, add the most violated constraint to $\\mathcal{A}$ and repeat.\n5. Stop when all constraints are satisfied (within a numerical tolerance) and all active multipliers are nonnegative. At this point, the KKT conditions are satisfied, and the solution is the unique minimizer.\n\nFor the provided test suite, each case uses $n = 3$ components, a diagonal elastic stiffness $\\mathbf{C} = \\operatorname{diag}(2\\times 10^{11},1.5\\times 10^{11},1\\times 10^{11})$, and linear yield facets. The algorithm outputs, for each case, the final stress components $\\sigma_1, \\sigma_2, \\sigma_3$ in $\\mathrm{Pa}$ and the one-based indices of the active set at convergence:\n- Case $1$ (elastic): No constraint is violated; the projection is the identity, and the active set is empty.\n- Case $2$ (single facet): Only the first facet is violated; the projection enforces $\\boldsymbol{a}_1^\\top \\boldsymbol{\\sigma} = c_1$ with a nonnegative multiplier, updating only the first stress component.\n- Case $3$ (multiple facets): The first three axial facets are violated; the projection enforces all three equalities simultaneously, each with a nonnegative multiplier, producing a stress at the intersection of the three planes.\n- Case $4$ (boundary): The trial stress lies on one or more yield planes but does not violate any constraint; the KKT conditions admit zero multipliers, so the trial stress is returned, and the active set is empty.\n- Case $5$ (oblique facet only): Axial bounds are loose (high $c_i$), but the oblique facet restricts the average of the first two components; only the oblique facet becomes active and tight.\n\nThe program implements this active set scheme, handles numerical tolerance, and prints a single line containing lists of the form $[\\sigma_1,\\sigma_2,\\sigma_3,[i_1,i_2,\\dots]]$ for the five cases, with stresses in $\\mathrm{Pa}$ and integer active indices.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef closest_point_projection(C, a_list, c_list, sigma_tr, tol=1e-8):\n    \"\"\"\n    Active-set closest point projection for polyhedral yield surfaces.\n    Minimize 0.5*(sigma - sigma_tr)^T C^{-1} (sigma - sigma_tr)\n    subject to a_i^T sigma - c_i = 0.\n\n    Parameters:\n        C: (n,n) SPD numpy array (elastic stiffness).\n        a_list: list of numpy arrays, each of shape (n,), constraint normals.\n        c_list: list of floats, thresholds.\n        sigma_tr: numpy array of shape (n,), trial stress.\n        tol: numerical tolerance in stress units (Pa).\n\n    Returns:\n        sigma: projected stress, numpy array shape (n,)\n        active_indices: list of 1-based indices of active constraints\n    \"\"\"\n    n = C.shape[0]\n    m = len(a_list)\n    # Helper: evaluate constraint values f_i(sigma) = a_i^T sigma - c_i\n    def fvals(sigma):\n        return np.array([float(a.dot(sigma) - c) for a, c in zip(a_list, c_list)])\n\n    f_tr = fvals(sigma_tr)\n    # Determine an absolute tolerance based on magnitudes present\n    scale = max(np.max(np.abs(f_tr)), np.max(np.abs(c_list)), 1.0)\n    abstol = tol * scale\n\n    # If trial state is feasible within tolerance, return it\n    if np.all(f_tr = abstol):\n        return sigma_tr.copy(), []\n\n    # Active set initialization: add the most violated constraint\n    violated = np.where(f_tr  abstol)[0]\n    if violated.size == 0:\n        return sigma_tr.copy(), []  # Should not happen due to earlier check\n    active = [int(violated[np.argmax(f_tr[violated])])]\n    sigma = sigma_tr.copy()\n\n    # Active-set iterations\n    max_iters = 100\n    for _ in range(max_iters):\n        if len(active) == 0:\n            # No active constraints, return current sigma\n            return sigma.copy(), []\n\n        # Build Gram matrix G and rhs for active set\n        A_active = [a_list[i] for i in active]\n        c_active = [c_list[i] for i in active]\n        p = len(A_active)\n        G = np.zeros((p, p))\n        rhs = np.zeros(p)\n        for j in range(p):\n            rhs[j] = float(A_active[j].dot(sigma_tr) - c_active[j])\n            for k in range(p):\n                G[j, k] = float(A_active[j].dot(C.dot(A_active[k])))\n\n        # Solve for lambda; if singular, use least squares\n        try:\n            lam = np.linalg.solve(G, rhs)\n        except np.linalg.LinAlgError:\n            lam, *_ = np.linalg.lstsq(G, rhs, rcond=None)\n\n        # Dual feasibility: remove constraints with negative lambda\n        min_lam = np.min(lam) if lam.size  0 else 0.0\n        if min_lam  -abstol:\n            # Remove the most negative lambda constraint\n            remove_idx = int(np.argmin(lam))\n            del active[remove_idx]\n            continue\n\n        # Update sigma from stationarity\n        correction = np.zeros(n)\n        for k in range(p):\n            correction += lam[k] * A_active[k]\n        sigma = sigma_tr - C.dot(correction)\n\n        # Check constraints\n        f = fvals(sigma)\n        # If any inactive constraint is violated, add the most violated\n        inactive_mask = np.ones(m, dtype=bool)\n        inactive_mask[active] = False\n        violated_inactive = np.where((f  abstol)  inactive_mask)[0]\n        if violated_inactive.size  0:\n            add_idx = int(violated_inactive[np.argmax(f[violated_inactive])])\n            active.append(add_idx)\n            continue\n\n        # All constraints satisfied and active multipliers nonnegative\n        # Clean active set: keep only those that are (near) tight\n        # but report the set that participated in KKT (one-based indexing)\n        active_one_based = [i + 1 for i in active]\n        return sigma.copy(), active_one_based\n\n    # Fallback if iteration limit reached\n    active_one_based = [i + 1 for i in active]\n    return sigma.copy(), active_one_based\n\ndef format_results(results):\n    # Produce a compact single-line list string without spaces\n    def fmt_item(x):\n        if isinstance(x, list):\n            return \"[\" + \",\".join(fmt_item(y) for y in x) + \"]\"\n        elif isinstance(x, (float, np.floating)):\n            # Print as integer if close to integer, else as float with full precision\n            return str(float(x))\n        elif isinstance(x, (int, np.integer)):\n            return str(int(x))\n        else:\n            # Fallback\n            return str(x)\n    return \"[\" + \",\".join(fmt_item(r) for r in results) + \"]\"\n\ndef solve():\n    # Define the test cases from the problem statement.\n    C = np.diag([2.0e11, 1.5e11, 1.0e11])\n\n    # Case 1\n    a_list1 = [np.array([1.0, 0.0, 0.0]),\n               np.array([0.0, 1.0, 0.0]),\n               np.array([0.0, 0.0, 1.0]),\n               np.array([0.5, 0.5, 0.0])]\n    c_list1 = [1.0e8, 1.2e8, 6.0e7, 2.0e8]\n    sigma_tr1 = np.array([8.0e7, 9.0e7, 5.0e7])\n\n    # Case 2\n    a_list2 = a_list1\n    c_list2 = c_list1\n    sigma_tr2 = np.array([1.5e8, 1.0e8, 4.0e7])\n\n    # Case 3\n    a_list3 = a_list1\n    c_list3 = c_list1\n    sigma_tr3 = np.array([1.7e8, 1.5e8, 7.0e7])\n\n    # Case 4\n    a_list4 = a_list1\n    c_list4 = c_list1\n    sigma_tr4 = np.array([1.0e8, 9.0e7, 6.0e7])\n\n    # Case 5 (oblique facet only active)\n    a_list5 = [np.array([1.0, 0.0, 0.0]),\n               np.array([0.0, 1.0, 0.0]),\n               np.array([0.0, 0.0, 1.0]),\n               np.array([0.5, 0.5, 0.0])]\n    c_list5 = [3.0e8, 3.0e8, 3.0e8, 2.0e8]\n    sigma_tr5 = np.array([2.5e8, 2.5e8, 2.0e7])\n\n    test_cases = [\n        (C, a_list1, c_list1, sigma_tr1),\n        (C, a_list2, c_list2, sigma_tr2),\n        (C, a_list3, c_list3, sigma_tr3),\n        (C, a_list4, c_list4, sigma_tr4),\n        (C, a_list5, c_list5, sigma_tr5),\n    ]\n\n    results = []\n    for C_case, a_list, c_list, sigma_tr in test_cases:\n        sigma, active = closest_point_projection(C_case, a_list, c_list, sigma_tr, tol=1e-10)\n        # Collect result as [sigma1, sigma2, sigma3, [active indices]]\n        results.append([float(sigma[0]), float(sigma[1]), float(sigma[2]), active])\n\n    # Final print statement in the exact required format.\n    print(format_results(results))\n\nsolve()\n```", "id": "3556874"}]}