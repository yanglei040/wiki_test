{"hands_on_practices": [{"introduction": "To build a robust understanding of the Newton-Raphson scheme, we begin with the fundamental mechanics of a single iteration. This practice strips the method down to its mathematical core, focusing on a simple two-degree-of-freedom system [@problem_id:3526509]. By manually forming the tangent matrix (Jacobian) and solving the linearized system for the displacement increment, you will gain hands-on experience with the essential operations that form the heart of every Newton-Raphson solver.", "problem": "A two-degree-of-freedom nonlinear equilibrium problem in computational geomechanics is characterized by the residual vector $\\mathbf{r}(\\mathbf{u}) \\in \\mathbb{R}^{2}$, where $\\mathbf{u} = \\begin{bmatrix} u_{1} \\\\ u_{2} \\end{bmatrix}$ represents generalized displacements. The equilibrium condition requires $\\mathbf{r}(\\mathbf{u}) = \\mathbf{0}$, with the residual defined by\n$$\n\\mathbf{r}(\\mathbf{u}) = \\begin{bmatrix}\nu_{1}^{2} + u_{2} - 3 \\\\\n\\sin(u_{1}) + u_{2}^{3} - 1\n\\end{bmatrix}.\n$$\nWithin the Full Newton-Raphson scheme, the tangent matrix (also called the consistent Jacobian or tangent stiffness) is defined as $ \\mathbf{K}_{t}(\\mathbf{u}) = \\dfrac{\\partial \\mathbf{r}}{\\partial \\mathbf{u}}(\\mathbf{u})$, and each iteration solves the linearized equilibrium update $\\mathbf{K}_{t}(\\mathbf{u}^{(i)}) \\, \\Delta \\mathbf{u}^{(i)} = -\\mathbf{r}(\\mathbf{u}^{(i)})$. In contrast, the Modified Newton-Raphson scheme freezes the tangent matrix across iterations while still updating the residual, but both schemes coincide at the first iteration when starting from the same initial guess.\n\nStarting from the initial guess $\\mathbf{u}^{(0)} = \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix}$, perform one Full Newton-Raphson iteration:\n- Explicitly form the tangent matrix $\\mathbf{K}_{t}(\\mathbf{u}^{(0)})$ by linearizing $\\mathbf{r}(\\mathbf{u})$.\n- Solve for the increment $\\Delta \\mathbf{u}^{(0)}$ in the linear system $\\mathbf{K}_{t}(\\mathbf{u}^{(0)}) \\, \\Delta \\mathbf{u}^{(0)} = -\\mathbf{r}(\\mathbf{u}^{(0)})$.\n\nExpress the final answer as a single analytic expression for the row vector $\\Delta \\mathbf{u}^{(0)}$ using standard mathematical functions, without numerical rounding and without units.", "solution": "The problem is scientifically grounded, well-posed, objective, and contains all necessary information for a unique solution. Therefore, it is deemed valid. We proceed with the solution by applying one iteration of the Full Newton-Raphson scheme.\n\nThe problem defines a nonlinear system of equations $\\mathbf{r}(\\mathbf{u}) = \\mathbf{0}$, where the displacement vector is $\\mathbf{u} = \\begin{bmatrix} u_{1} \\\\ u_{2} \\end{bmatrix}$ and the residual vector is\n$$\n\\mathbf{r}(\\mathbf{u}) = \\begin{bmatrix} r_1(\\mathbf{u}) \\\\ r_2(\\mathbf{u}) \\end{bmatrix} = \\begin{bmatrix}\nu_{1}^{2} + u_{2} - 3 \\\\\n\\sin(u_{1}) + u_{2}^{3} - 1\n\\end{bmatrix}.\n$$\nThe Full Newton-Raphson method is an iterative procedure to find the root of $\\mathbf{r}(\\mathbf{u})$. Each iteration refines the current guess $\\mathbf{u}^{(i)}$ by computing an increment $\\Delta \\mathbf{u}^{(i)}$ and updating the solution as $\\mathbf{u}^{(i+1)} = \\mathbf{u}^{(i)} + \\Delta \\mathbf{u}^{(i)}$. The increment is found by solving the linear system\n$$\n\\mathbf{K}_{t}(\\mathbf{u}^{(i)}) \\, \\Delta \\mathbf{u}^{(i)} = -\\mathbf{r}(\\mathbf{u}^{(i)}),\n$$\nwhere $\\mathbf{K}_{t}(\\mathbf{u})$ is the tangent matrix (Jacobian) of the residual vector $\\mathbf{r}(\\mathbf{u})$.\n\nWe are asked to perform one iteration starting from the initial guess $\\mathbf{u}^{(0)} = \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix}$.\n\nFirst, we evaluate the residual vector $\\mathbf{r}$ at the initial guess $\\mathbf{u}^{(0)}$:\n$$\n\\mathbf{r}(\\mathbf{u}^{(0)}) = \\begin{bmatrix}\n(1)^{2} + (0) - 3 \\\\\n\\sin(1) + (0)^{3} - 1\n\\end{bmatrix} = \\begin{bmatrix}\n-2 \\\\\n\\sin(1) - 1\n\\end{bmatrix}.\n$$\n\nSecond, we formulate the tangent matrix $\\mathbf{K}_{t}(\\mathbf{u})$ by taking the partial derivatives of the components of $\\mathbf{r}(\\mathbf{u})$ with respect to the components of $\\mathbf{u}$:\n$$\n\\mathbf{K}_{t}(\\mathbf{u}) = \\frac{\\partial \\mathbf{r}}{\\partial \\mathbf{u}}(\\mathbf{u}) = \\begin{bmatrix}\n\\frac{\\partial r_1}{\\partial u_1} & \\frac{\\partial r_1}{\\partial u_2} \\\\\n\\frac{\\partial r_2}{\\partial u_1} & \\frac{\\partial r_2}{\\partial u_2}\n\\end{bmatrix}.\n$$\nThe individual partial derivatives are:\n$$\n\\frac{\\partial r_1}{\\partial u_1} = \\frac{\\partial}{\\partial u_1}(u_{1}^{2} + u_{2} - 3) = 2u_{1}\n$$\n$$\n\\frac{\\partial r_1}{\\partial u_2} = \\frac{\\partial}{\\partial u_2}(u_{1}^{2} + u_{2} - 3) = 1\n$$\n$$\n\\frac{\\partial r_2}{\\partial u_1} = \\frac{\\partial}{\\partial u_1}(\\sin(u_{1}) + u_{2}^{3} - 1) = \\cos(u_{1})\n$$\n$$\n\\frac{\\partial r_2}{\\partial u_2} = \\frac{\\partial}{\\partial u_2}(\\sin(u_{1}) + u_{2}^{3} - 1) = 3u_{2}^{2}\n$$\nThus, the tangent matrix is:\n$$\n\\mathbf{K}_{t}(\\mathbf{u}) = \\begin{bmatrix}\n2u_{1} & 1 \\\\\n\\cos(u_{1}) & 3u_{2}^{2}\n\\end{bmatrix}.\n$$\n\nThird, we evaluate this tangent matrix at the initial guess $\\mathbf{u}^{(0)} = \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix}$:\n$$\n\\mathbf{K}_{t}(\\mathbf{u}^{(0)}) = \\begin{bmatrix}\n2(1) & 1 \\\\\n\\cos(1) & 3(0)^{2}\n\\end{bmatrix} = \\begin{bmatrix}\n2 & 1 \\\\\n\\cos(1) & 0\n\\end{bmatrix}.\n$$\nThe determinant of this matrix is $\\det(\\mathbf{K}_{t}(\\mathbf{u}^{(0)})) = (2)(0) - (1)(\\cos(1)) = -\\cos(1)$. Since $1$ is not an odd multiple of $\\frac{\\pi}{2}$, $\\cos(1) \\neq 0$, so the matrix is invertible and a unique solution for the increment exists.\n\nFinally, we solve the linear system for the increment $\\Delta \\mathbf{u}^{(0)} = \\begin{bmatrix} \\Delta u_{1}^{(0)} \\\\ \\Delta u_{2}^{(0)} \\end{bmatrix}$:\n$$\n\\mathbf{K}_{t}(\\mathbf{u}^{(0)}) \\, \\Delta \\mathbf{u}^{(0)} = -\\mathbf{r}(\\mathbf{u}^{(0)})\n$$\n$$\n\\begin{bmatrix}\n2 & 1 \\\\\n\\cos(1) & 0\n\\end{bmatrix}\n\\begin{bmatrix}\n\\Delta u_{1}^{(0)} \\\\\n\\Delta u_{2}^{(0)}\n\\end{bmatrix}\n= -\\begin{bmatrix}\n-2 \\\\\n\\sin(1) - 1\n\\end{bmatrix}\n= \\begin{bmatrix}\n2 \\\\\n1 - \\sin(1)\n\\end{bmatrix}.\n$$\nThis matrix equation corresponds to the following system of two linear equations:\n$$\n\\begin{cases}\n2\\Delta u_{1}^{(0)} + \\Delta u_{2}^{(0)} = 2 & (1) \\\\\n\\cos(1)\\Delta u_{1}^{(0)} = 1 - \\sin(1) & (2)\n\\end{cases}\n$$\nFrom equation $(2)$, we solve for $\\Delta u_{1}^{(0)}$:\n$$\n\\Delta u_{1}^{(0)} = \\frac{1 - \\sin(1)}{\\cos(1)} = \\frac{1}{\\cos(1)} - \\frac{\\sin(1)}{\\cos(1)} = \\sec(1) - \\tan(1).\n$$\nSubstituting this expression into equation $(1)$ allows us to solve for $\\Delta u_{2}^{(0)}$:\n$$\n2(\\sec(1) - \\tan(1)) + \\Delta u_{2}^{(0)} = 2\n$$\n$$\n\\Delta u_{2}^{(0)} = 2 - 2(\\sec(1) - \\tan(1)) = 2(1 - \\sec(1) + \\tan(1)).\n$$\nThe resulting displacement increment is the vector $\\Delta \\mathbf{u}^{(0)} = \\begin{bmatrix} \\sec(1) - \\tan(1) \\\\ 2(1 - \\sec(1) + \\tan(1)) \\end{bmatrix}$. The problem requests the answer as a row vector.", "answer": "$$\n\\boxed{\\begin{pmatrix} \\sec(1) - \\tan(1) & 2(1 - \\sec(1) + \\tan(1)) \\end{pmatrix}}\n$$", "id": "3526509"}, {"introduction": "Moving from pure mathematics to engineering application, this next practice demonstrates how the abstract residual vector $\\mathbf{r}(\\mathbf{u})$ is constructed in a real-world scenario [@problem_id:3526513]. We will analyze a one-dimensional bar with a nonlinear material response, a common situation in geomechanics. This exercise guides you through deriving the internal and external force vectors using Finite Element principles, showing how their imbalance—the residual—drives the Newton-Raphson solution towards equilibrium.", "problem": "A straight, prismatic, one-dimensional bar of length $L$ and constant cross-sectional area $A$ is subjected to a uniform body force $b$ along its axis. The bar is discretized into two equal-length linear two-node elements with nodes at coordinates $x_{1}=0$, $x_{2}=L/2$, and $x_{3}=L$. The left end is fixed, so $u_{1}=0$, and the right end is traction-free. The material obeys a nonlinear stress-strain relation $\\sigma(\\varepsilon)=E\\,\\varepsilon+\\alpha\\,\\varepsilon^{3}$ under small strain $\\varepsilon=\\mathrm{d}u/\\mathrm{d}x$. Use the Galerkin Finite Element Method (FEM) and the principle of virtual work to construct the assembled global residual vector $\\mathbf{r}(\\mathbf{u})$ on the free degrees of freedom (nodes $2$ and $3$), where $\\mathbf{r}(\\mathbf{u})=\\mathbf{f}_{\\mathrm{ext}}(\\mathbf{u})-\\mathbf{f}_{\\mathrm{int}}(\\mathbf{u})$. Then, for the following data, evaluate $\\mathbf{r}(\\mathbf{u}^{(0)})$ at the given initial displacement iterate and compute its Euclidean norm:\n- $L=2\\,\\mathrm{m}$, $A=1.0\\times 10^{-2}\\,\\mathrm{m}^{2}$, $E=5.0\\times 10^{10}\\,\\mathrm{Pa}$, $\\alpha=1.0\\times 10^{17}\\,\\mathrm{Pa}$,\n- $b=2.0\\times 10^{4}\\,\\mathrm{N/m}^{3}$ (constant along the bar),\n- $u_{1}=0\\,\\mathrm{m}$, $\\mathbf{u}^{(0)}=\\begin{pmatrix}u_{2}^{(0)}\\\\ u_{3}^{(0)}\\end{pmatrix}=\\begin{pmatrix}5.0\\times 10^{-4}\\,\\mathrm{m}\\\\ 1.2\\times 10^{-3}\\,\\mathrm{m}\\end{pmatrix}$,\n- no applied tractions on $x=L$.\n\nAssume linear shape functions over each element and exact numerical quadrature for the constant-strain, constant-body-force contributions. Derive $\\mathbf{r}(\\mathbf{u})$ symbolically in terms of element strains and stresses and assemble it onto the free degrees of freedom. Then evaluate $\\mathbf{r}(\\mathbf{u}^{(0)})$ using the given numbers. Finally, compute the scalar $2$-norm $\\|\\mathbf{r}(\\mathbf{u}^{(0)})\\|_{2}$. Express the final scalar value in newtons (N) and round your answer to four significant figures.", "solution": "The problem is validated as scientifically grounded, well-posed, objective, and complete. It represents a standard application of the nonlinear Finite Element Method (FEM) in solid mechanics.\n\nThe analysis begins with the principle of virtual work, which states that for a body in equilibrium, the virtual work done by external forces is equal to the virtual work done by internal stresses for any kinematically admissible virtual displacement field. For a one-dimensional bar, this is expressed as:\n$$\n\\int_{0}^{L} \\delta \\varepsilon \\, \\sigma \\, A \\, \\mathrm{d}x = \\int_{0}^{L} \\delta u \\, b \\, A \\, \\mathrm{d}x + [\\delta u \\, T]_{x=L}\n$$\nwhere $\\delta u$ is the virtual displacement, $\\delta \\varepsilon = \\mathrm{d}(\\delta u)/\\mathrm{d}x$ is the virtual strain, $\\sigma$ is the Cauchy stress, $b$ is the body force per unit volume, $A$ is the cross-sectional area, and $T$ is the traction at the boundary $x=L$. The problem states the right end is traction-free, so $T=0$.\n\nThe problem is discretized into two linear two-node elements of equal length $L_e = L/2$. For a generic element `e`, the displacement field $u^{(e)}(x)$ is interpolated from the nodal displacements $u_1^{(e)}$ and $u_2^{(e)}$ using linear shape functions $N_1(x)$ and $N_2(x)$:\n$$\nu^{(e)}(x) = N_1(x) u_1^{(e)} + N_2(x) u_2^{(e)} = \\mathbf{N}^{(e)} \\mathbf{u}^{(e)}\n$$\nFor a linear element, the strain $\\varepsilon^{(e)} = \\mathrm{d}u^{(e)}/\\mathrm{d}x$ is constant. The strain-displacement relationship is given by:\n$$\n\\varepsilon^{(e)} = \\frac{\\mathrm{d}\\mathbf{N}^{(e)}}{\\mathrm{d}x} \\mathbf{u}^{(e)} = \\mathbf{B}^{(e)} \\mathbf{u}^{(e)}\n$$\nFor an element of length $L_e$, the $\\mathbf{B}$ matrix is:\n$$\n\\mathbf{B}^{(e)} = \\begin{pmatrix} -\\frac{1}{L_e} & \\frac{1}{L_e} \\end{pmatrix}\n$$\nTherefore, the constant strain in the element is $\\varepsilon^{(e)} = (u_2^{(e)} - u_1^{(e)})/L_e$.\n\nThe FEM formulation expresses the principle of virtual work in terms of a residual vector $\\mathbf{r}$ which must be zero at equilibrium: $\\mathbf{r}(\\mathbf{u}) = \\mathbf{f}_{\\mathrm{ext}} - \\mathbf{f}_{\\mathrm{int}} = \\mathbf{0}$.\n\nThe internal force vector for an element, $\\mathbf{f}_{\\mathrm{int}}^{(e)}$, is derived from the internal virtual work:\n$$\n\\delta \\mathbf{u}^{(e)T} \\mathbf{f}_{\\mathrm{int}}^{(e)} = \\int_{L_e} \\delta\\varepsilon^{(e)} \\sigma^{(e)} A \\, \\mathrm{d}x = \\int_{L_e} (\\mathbf{B}^{(e)} \\delta\\mathbf{u}^{(e)})^T \\sigma^{(e)} A \\, \\mathrm{d}x\n$$\nSince $\\sigma^{(e)}$, $A$, and $\\mathbf{B}^{(e)}$ are constant within the element, the integral becomes:\n$$\n\\mathbf{f}_{\\mathrm{int}}^{(e)} = (\\mathbf{B}^{(e)})^T \\sigma^{(e)} A L_e = \\begin{pmatrix} -1/L_e \\\\ 1/L_e \\end{pmatrix} \\sigma^{(e)} A L_e = A \\sigma^{(e)} \\begin{pmatrix} -1 \\\\ 1 \\end{pmatrix}\n$$\nThe external force vector from the body force $b$, $\\mathbf{f}_{\\mathrm{ext}}^{(e)}$, is:\n$$\n\\mathbf{f}_{\\mathrm{ext}}^{(e)} = \\int_{L_e} (\\mathbf{N}^{(e)})^T b A \\, \\mathrm{d}x = b A \\int_{L_e} \\begin{pmatrix} N_1(x) \\\\ N_2(x) \\end{pmatrix} \\mathrm{d}x = \\frac{b A L_e}{2} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}\n$$\nThe material follows the nonlinear stress-strain relation $\\sigma(\\varepsilon) = E\\varepsilon + \\alpha \\varepsilon^3$.\n\nThe bar is discretized into two elements:\n- Element 1: nodes $1$ and $2$. Length $L_e = L/2$. Nodal displacements $\\mathbf{u}^{(1)} = \\begin{pmatrix} u_1 \\\\ u_2 \\end{pmatrix}$.\n- Element 2: nodes $2$ and $3$. Length $L_e = L/2$. Nodal displacements $\\mathbf{u}^{(2)} = \\begin{pmatrix} u_2 \\\\ u_3 \\end{pmatrix}$.\n\nThe strains in the elements are:\n$$\n\\varepsilon_1 = \\frac{u_2 - u_1}{L/2} = \\frac{2(u_2 - u_1)}{L}\n$$\n$$\n\\varepsilon_2 = \\frac{u_3 - u_2}{L/2} = \\frac{2(u_3 - u_2)}{L}\n$$\nThe corresponding stresses are $\\sigma_1 = E\\varepsilon_1 + \\alpha\\varepsilon_1^3$ and $\\sigma_2 = E\\varepsilon_2 + \\alpha\\varepsilon_2^3$.\n\nWe assemble the global internal and external force vectors for the free degrees of freedom, which are $u_2$ and $u_3$ (since $u_1=0$).\nThe global external force vector $\\mathbf{f}_{\\mathrm{ext}}$:\n- On node 2: contribution from element 1 (node 2) and element 2 (node 1) is $\\frac{bAL_e}{2} + \\frac{bAL_e}{2} = bAL_e = \\frac{bAL}{2}$.\n- On node 3: contribution from element 2 (node 2) is $\\frac{bAL_e}{2} = \\frac{bAL}{4}$.\nSo, $\\mathbf{f}_{\\mathrm{ext}} = \\begin{pmatrix} \\frac{bAL}{2} \\\\ \\frac{bAL}{4} \\end{pmatrix}$.\n\nThe global internal force vector $\\mathbf{f}_{\\mathrm{int}}(\\mathbf{u})$:\n- On node 2: contribution from element 1 (node 2) and element 2 (node 1) is $A\\sigma_1 + (-A\\sigma_2) = A(\\sigma_1 - \\sigma_2)$.\n- On node 3: contribution from element 2 (node 2) is $A\\sigma_2$.\nSo, $\\mathbf{f}_{\\mathrm{int}}(\\mathbf{u}) = \\begin{pmatrix} A(\\sigma_1 - \\sigma_2) \\\\ A\\sigma_2 \\end{pmatrix}$.\n\nThe residual vector for the free DOFs is $\\mathbf{r}(\\mathbf{u}) = \\mathbf{f}_{\\mathrm{ext}} - \\mathbf{f}_{\\mathrm{int}}(\\mathbf{u})$:\n$$\n\\mathbf{r}(\\mathbf{u}) = \\begin{pmatrix} r_2 \\\\ r_3 \\end{pmatrix} = \\begin{pmatrix} \\frac{bAL}{2} - A(\\sigma_1 - \\sigma_2) \\\\ \\frac{bAL}{4} - A\\sigma_2 \\end{pmatrix}\n$$\nThis is the symbolic form of the residual vector.\n\nNow we evaluate the residual $\\mathbf{r}(\\mathbf{u}^{(0)})$ for the given initial displacement iterate $\\mathbf{u}^{(0)} = \\begin{pmatrix} u_2^{(0)} \\\\ u_3^{(0)} \\end{pmatrix} = \\begin{pmatrix} 5.0 \\times 10^{-4} \\\\ 1.2 \\times 10^{-3} \\end{pmatrix}$ m.\nGiven data: $L=2\\,\\mathrm{m}$, $A=1.0\\times 10^{-2}\\,\\mathrm{m}^{2}$, $E=5.0\\times 10^{10}\\,\\mathrm{Pa}$, $\\alpha=1.0\\times 10^{17}\\,\\mathrm{Pa}$, $b=2.0\\times 10^{4}\\,\\mathrm{N/m}^{3}$, $u_1=0\\,\\mathrm{m}$.\n\nFirst, calculate the strains at the initial iterate:\n$$\n\\varepsilon_1^{(0)} = \\frac{2(u_2^{(0)} - u_1)}{L} = \\frac{2(5.0 \\times 10^{-4} - 0)}{2} = 5.0 \\times 10^{-4}\n$$\n$$\n\\varepsilon_2^{(0)} = \\frac{2(u_3^{(0)} - u_2^{(0)})}{L} = \\frac{2(1.2 \\times 10^{-3} - 5.0 \\times 10^{-4})}{2} = 7.0 \\times 10^{-4}\n$$\nNext, calculate the corresponding stresses:\n$$\n\\sigma_1^{(0)} = E\\varepsilon_1^{(0)} + \\alpha(\\varepsilon_1^{(0)})^3 = (5.0 \\times 10^{10})(5.0 \\times 10^{-4}) + (1.0 \\times 10^{17})(5.0 \\times 10^{-4})^3\n$$\n$$\n\\sigma_1^{(0)} = 2.5 \\times 10^7 + (1.0 \\times 10^{17})(125 \\times 10^{-12}) = 2.5 \\times 10^7 + 1.25 \\times 10^7 = 3.75 \\times 10^7\\,\\mathrm{Pa}\n$$\n$$\n\\sigma_2^{(0)} = E\\varepsilon_2^{(0)} + \\alpha(\\varepsilon_2^{(0)})^3 = (5.0 \\times 10^{10})(7.0 \\times 10^{-4}) + (1.0 \\times 10^{17})(7.0 \\times 10^{-4})^3\n$$\n$$\n\\sigma_2^{(0)} = 3.5 \\times 10^7 + (1.0 \\times 10^{17})(343 \\times 10^{-12}) = 3.5 \\times 10^7 + 3.43 \\times 10^7 = 6.93 \\times 10^7\\,\\mathrm{Pa}\n$$\nNow, calculate the external force vector:\n$$\n\\mathbf{f}_{\\mathrm{ext}} = \\begin{pmatrix} \\frac{(2.0 \\times 10^4)(1.0 \\times 10^{-2})(2)}{2} \\\\ \\frac{(2.0 \\times 10^4)(1.0 \\times 10^{-2})(2)}{4} \\end{pmatrix} = \\begin{pmatrix} 200 \\\\ 100 \\end{pmatrix}\\,\\mathrm{N}\n$$\nCalculate the internal force vector at the initial iterate:\n$$\n\\mathbf{f}_{\\mathrm{int}}(\\mathbf{u}^{(0)}) = \\begin{pmatrix} (1.0 \\times 10^{-2})(3.75 \\times 10^7 - 6.93 \\times 10^7) \\\\ (1.0 \\times 10^{-2})(6.93 \\times 10^7) \\end{pmatrix} = \\begin{pmatrix} -318000 \\\\ 693000 \\end{pmatrix}\\,\\mathrm{N}\n$$\nFinally, compute the residual vector:\n$$\n\\mathbf{r}(\\mathbf{u}^{(0)}) = \\mathbf{f}_{\\mathrm{ext}} - \\mathbf{f}_{\\mathrm{int}}(\\mathbf{u}^{(0)}) = \\begin{pmatrix} 200 \\\\ 100 \\end{pmatrix} - \\begin{pmatrix} -318000 \\\\ 693000 \\end{pmatrix} = \\begin{pmatrix} 318200 \\\\ -692900 \\end{pmatrix}\\,\\mathrm{N}\n$$\nThe last step is to compute the Euclidean norm ($2$-norm) of the residual vector:\n$$\n\\|\\mathbf{r}(\\mathbf{u}^{(0)})\\|_2 = \\sqrt{(318200)^2 + (-692900)^2} = \\sqrt{101251240000 + 480110410000}\n$$\n$$\n\\|\\mathbf{r}(\\mathbf{u}^{(0)})\\|_2 = \\sqrt{581361650000} \\approx 762470.753\\,\\mathrm{N}\n$$\nRounding to four significant figures, we get $7.625 \\times 10^5\\,\\mathrm{N}$.", "answer": "$$\\boxed{7.625 \\times 10^5}$$", "id": "3526513"}, {"introduction": "A key advantage of the full Newton-Raphson method is its rapid, quadratic rate of convergence near a solution. This final practice provides a crucial skill: how to verify this theoretical behavior from the output of a numerical simulation [@problem_id:3526519]. Using a sequence of residual norms from a hypothetical geomechanical simulation, you will derive and apply a method to estimate the observed convergence order, a vital diagnostic tool for debugging and validating nonlinear finite element codes.", "problem": "A drained triaxial compression increment is solved using a nonlinear finite element (FE) model of an elastoplastic soil obeying a pressure-dependent yield condition. The discrete static equilibrium is written as the residual equation $\\mathbf{r}(\\mathbf{u}) = \\mathbf{f}_{\\mathrm{int}}(\\mathbf{u}) - \\mathbf{f}_{\\mathrm{ext}} = \\mathbf{0}$, where $\\mathbf{u}$ is the global displacement vector, $\\mathbf{f}_{\\mathrm{int}}(\\mathbf{u})$ is the internal force vector, and $\\mathbf{f}_{\\mathrm{ext}}$ is the external force vector. Two iterative schemes are considered: the full Newton-Raphson method with the consistent elastoplastic tangent updated every iteration, and the modified Newton-Raphson method with the tangent matrix frozen at its value at the start of the load step.\n\nYou are given the Euclidean norms of the residual for the full Newton-Raphson iterations at a fixed load increment:\n$k=0: \\|\\mathbf{r}(\\mathbf{u}^{(0)})\\| = 1.0 \\times 10^{-1}$,\n$k=1: \\|\\mathbf{r}(\\mathbf{u}^{(1)})\\| = 1.0 \\times 10^{-2}$,\n$k=2: \\|\\mathbf{r}(\\mathbf{u}^{(2)})\\| = 1.0 \\times 10^{-4}$,\n$k=3: \\|\\mathbf{r}(\\mathbf{u}^{(3)})\\| = 1.0 \\times 10^{-8}$.\n\nStarting from first principles, use the definition of local convergence order $p$ based on the asymptotic model $\\|\\mathbf{r}(\\mathbf{u}^{(k+1)})\\| \\approx C \\|\\mathbf{r}(\\mathbf{u}^{(k)})\\|^{p}$ for some constant $C>0$ near the solution, and the linearization of the residual about the exact solution, to derive a computable estimator for the observed order $p$ from three consecutive iterates. Then, using the data above for the full Newton-Raphson scheme, compute the observed $p$.\n\nRound your final numerical answer to $4$ significant figures. The final reported value is dimensionless. In your reasoning, also state whether the observed behavior is compatible with quadratic, superlinear, or linear convergence in the sense of the local order $p$, but report only the estimated $p$ as your final answer.", "solution": "The problem requires the derivation of a computable estimator for the local order of convergence, $p$, and its calculation for a given set of residual norms from a full Newton-Raphson (FNR) scheme.\n\nThe analysis of convergence is typically formulated in terms of the error in the solution vector, $\\mathbf{e}^{(k)} = \\mathbf{u}^{(k)} - \\mathbf{u}^*$, where $\\mathbf{u}^{(k)}$ is the iterate at step $k$ and $\\mathbf{u}^*$ is the exact solution satisfying $\\mathbf{r}(\\mathbf{u}^*) = \\mathbf{0}$. The order of convergence, $p$, is defined by the asymptotic relationship:\n$$ \\|\\mathbf{e}^{(k+1)}\\| \\approx C_e \\|\\mathbf{e}^{(k)}\\|^p $$\nfor some constant $C_e > 0$ as $k \\to \\infty$.\n\nThe problem provides data for the Euclidean norm of the residual vector, $\\|\\mathbf{r}(\\mathbf{u}^{(k)})\\|$, and posits a similar relationship:\n$$ \\|\\mathbf{r}(\\mathbf{u}^{(k+1)})\\| \\approx C \\|\\mathbf{r}(\\mathbf{u}^{(k)})\\|^p $$\nTo justify this model, we linearize the residual function $\\mathbf{r}(\\mathbf{u})$ about the exact solution $\\mathbf{u}^*$. Using a first-order Taylor series expansion, we have:\n$$ \\mathbf{r}(\\mathbf{u}^{(k)}) = \\mathbf{r}(\\mathbf{u}^*) + \\left. \\frac{\\partial \\mathbf{r}}{\\partial \\mathbf{u}} \\right|_{\\mathbf{u}=\\mathbf{u}^*} (\\mathbf{u}^{(k)} - \\mathbf{u}^*) + O(\\|\\mathbf{u}^{(k)}-\\mathbf{u}^*\\|^2) $$\nThe term $\\frac{\\partial \\mathbf{r}}{\\partial \\mathbf{u}}$ is the tangent stiffness matrix, $\\mathbf{K}_T(\\mathbf{u})$. At the solution $\\mathbf{u}^*$, we have $\\mathbf{r}(\\mathbf{u}^*) = \\mathbf{0}$. Thus, for an iterate $\\mathbf{u}^{(k)}$ sufficiently close to $\\mathbf{u}^*$, we can write:\n$$ \\mathbf{r}(\\mathbf{u}^{(k)}) \\approx \\mathbf{K}_T(\\mathbf{u}^*) (\\mathbf{u}^{(k)} - \\mathbf{u}^*) = \\mathbf{K}_T^* \\mathbf{e}^{(k)} $$\nAssuming the tangent stiffness matrix at the solution, $\\mathbf{K}_T^*$, is non-singular, we can take the vector norms of both sides. This relates the norm of the residual to the norm of the error:\n$$ \\|\\mathbf{r}(\\mathbf{u}^{(k)})\\| \\approx \\|\\mathbf{K}_T^* \\mathbf{e}^{(k)}\\| \\le \\|\\mathbf{K}_T^*\\| \\|\\mathbf{e}^{(k)}\\| $$\nAnd similarly, $\\|\\mathbf{e}^{(k)}\\| = \\|(\\mathbf{K}_T^*)^{-1} \\mathbf{r}(\\mathbf{u}^{(k)})\\| \\le \\|(\\mathbf{K}_T^*)^{-1}\\| \\|\\mathbf{r}(\\mathbf{u}^{(k)})\\|$. This establishes that, in the vicinity of the solution, the norm of the residual is proportional to the norm of the error, i.e., $\\|\\mathbf{r}(\\mathbf{u}^{(k)})\\| \\propto \\|\\mathbf{e}^{(k)}\\|$. Let us write this as $\\|\\mathbf{r}(\\mathbf{u}^{(k)})\\| \\approx C_r \\|\\mathbf{e}^{(k)}\\|$ for some constant $C_r > 0$.\n\nSubstituting this relationship into the definition of convergence order for the error vector:\n$$ \\frac{\\|\\mathbf{r}(\\mathbf{u}^{(k+1)})\\|}{C_r} \\approx C_e \\left(\\frac{\\|\\mathbf{r}(\\mathbf{u}^{(k)})\\|}{C_r}\\right)^p $$\n$$ \\|\\mathbf{r}(\\mathbf{u}^{(k+1)})\\| \\approx (C_e C_r^{1-p}) \\|\\mathbf{r}(\\mathbf{u}^{(k)})\\|^p $$\nThis confirms the assumed model $\\|\\mathbf{r}(\\mathbf{u}^{(k+1)})\\| \\approx C \\|\\mathbf{r}(\\mathbf{u}^{(k)})\\|^p$, where the constant $C$ is given by $C_e C_r^{1-p}$. This derivation from first principles legitimizes using the sequence of residual norms to estimate the order of convergence.\n\nNow, we derive the computable estimator for $p$. Let $R_k = \\|\\mathbf{r}(\\mathbf{u}^{(k)})\\|$. From the model, we have two relations for consecutive iterations $k$ and $k+1$:\n$$ R_{k+1} \\approx C R_k^p $$\n$$ R_k \\approx C R_{k-1}^p $$\nThese relations are valid when the iteration is close to the solution, so the asymptotic behavior holds. To eliminate the unknown constant $C$, we take the natural logarithm of both equations:\n$$ \\ln(R_{k+1}) \\approx \\ln(C) + p \\ln(R_k) $$\n$$ \\ln(R_k) \\approx \\ln(C) + p \\ln(R_{k-1}) $$\nSubtracting the second logarithmic equation from the first yields:\n$$ \\ln(R_{k+1}) - \\ln(R_k) \\approx p (\\ln(R_k) - \\ln(R_{k-1})) $$\nUsing the property of logarithms, $\\ln(a) - \\ln(b) = \\ln(a/b)$, we can write:\n$$ \\ln\\left(\\frac{R_{k+1}}{R_k}\\right) \\approx p \\ln\\left(\\frac{R_k}{R_{k-1}}\\right) $$\nSolving for $p$, we obtain the estimator for the observed order of convergence from three consecutive iterates $(k-1, k, k+1)$:\n$$ p \\approx \\frac{\\ln(R_{k+1} / R_k)}{\\ln(R_k / R_{k-1})} $$\nNext, we use the provided data for the full Newton-Raphson scheme to compute $p$. The given residual norms are:\n$R_0 = \\|\\mathbf{r}(\\mathbf{u}^{(0)})\\| = 1.0 \\times 10^{-1}$\n$R_1 = \\|\\mathbf{r}(\\mathbf{u}^{(1)})\\| = 1.0 \\times 10^{-2}$\n$R_2 = \\|\\mathbf{r}(\\mathbf{u}^{(2)})\\| = 1.0 \\times 10^{-4}$\n$R_3 = \\|\\mathbf{r}(\\mathbf{u}^{(3)})\\| = 1.0 \\times 10^{-8}$\n\nWe can compute an estimate for $p$ using the latest three available iterates, which are for $k=1, 2, 3$. This corresponds to setting $k=2$ in our derived formula.\n$$ p \\approx \\frac{\\ln(R_3 / R_2)}{\\ln(R_2 / R_1)} $$\nFirst, we compute the ratios of the norms:\n$$ \\frac{R_3}{R_2} = \\frac{1.0 \\times 10^{-8}}{1.0 \\times 10^{-4}} = 10^{-4} $$\n$$ \\frac{R_2}{R_1} = \\frac{1.0 \\times 10^{-4}}{1.0 \\times 10^{-2}} = 10^{-2} $$\nSubstituting these values into the estimator for $p$:\n$$ p \\approx \\frac{\\ln(10^{-4})}{\\ln(10^{-2})} = \\frac{-4 \\ln(10)}{-2 \\ln(10)} = 2 $$\nThe computed observed order of convergence is exactly $p=2$.\n\nThis result is consistent with the theory of the Newton-Raphson method. An order of convergence $p=2$ signifies quadratic convergence. For a nonlinear system $\\mathbf{r}(\\mathbf{u})=\\mathbf{0}$, the FNR method with a consistently derived tangent matrix $\\mathbf{K}_T = \\frac{\\partial \\mathbf{r}}{\\partial \\mathbf{u}}$ is expected to exhibit quadratic convergence in the vicinity of a simple root. The provided data for the elastoplastic model, which is a highly nonlinear problem, shows this ideal behavior, indicating that the chosen load increment and starting guess $\\mathbf{u}^{(0)}$ were appropriate to fall within the basin of attraction and that the consistent tangent was correctly implemented. The convergence behavior is therefore classified as quadratic.\n\nThe final answer must be reported to $4$ significant figures.\n$$ p = 2.000 $$", "answer": "$$\n\\boxed{2.000}\n$$", "id": "3526519"}]}