{"hands_on_practices": [{"introduction": "To describe soil behavior in a way that is independent of how we orient our coordinate system, we use stress invariants. This exercise will guide you through the fundamental process of calculating the key invariants—mean effective stress $p'$, deviatoric stress $q$, and the Lode angle $\\theta$—from a general 3D stress tensor. Mastering this transformation is the first step toward working with any advanced constitutive model, including those based on the Critical State Line and State Boundary Surface. [@problem_id:3514410]", "problem": "A soil element in an axis system aligned with laboratory coordinates is subjected to the symmetric effective stress tensor $\\boldsymbol{\\sigma'}$ (effective Cauchy stress) in kilopascals given by\n$$\n\\boldsymbol{\\sigma'} \\,=\\, \\begin{pmatrix}\n450  35  -20 \\\\\n35  380  15 \\\\\n-20  15  310\n\\end{pmatrix} \\, .\n$$\nIn the framework of the Critical State Line (CSL) and the State Boundary Surface (SBS) in Haigh–Westergaard stress space, the location of a stress state is described by the mean effective stress $p'$, the generalized shear stress magnitude $q$, and the Lode angle $\\theta$ that parameterizes the position on the deviatoric section. Starting from core definitions of stress invariants and deviatoric stress, compute the triplet $(p', q, \\theta)$ for the given $\\boldsymbol{\\sigma'}$, where $p'$ is the first invariant of $\\boldsymbol{\\sigma'}$ divided by three, $q$ is the shear magnitude associated with the second deviatoric invariant of $\\boldsymbol{\\sigma'}$, and $\\theta$ is the signed Lode angle consistent with a three-dimensional description of the deviatoric section of the SBS. Use the soil mechanics convention in which triaxial compression corresponds to $\\theta = \\pi/6$, triaxial extension corresponds to $\\theta = -\\pi/6$, and pure shear corresponds to $\\theta = 0$.\n\nThen, using $\\theta$, determine which meridian (triaxial compression, triaxial extension, or intermediate) the stress state is closest to by comparing absolute angular distances to $\\theta = \\pi/6$, $\\theta = -\\pi/6$, and $\\theta = 0$.\n\nReport $p'$ and $q$ in $\\mathrm{kPa}$ and $\\theta$ in radians. Round $p'$ and $q$ to four significant figures and $\\theta$ to three significant figures. In your final boxed answer, present only the numerical row matrix containing $(p', q, \\theta)$ in that order, without units. Provide your meridian classification in your reasoning but do not include it in the boxed answer.", "solution": "The problem requires the computation of the stress invariants $(p', q, \\theta)$ for the given effective stress tensor $\\boldsymbol{\\sigma'}$. The quantities are the mean effective stress $p'$, the generalized shear stress $q$, and the Lode angle $\\theta$.\n\nThe given effective stress tensor is:\n$$\n\\boldsymbol{\\sigma'} \\,=\\, \\begin{pmatrix}\n450  35  -20 \\\\\n35  380  15 \\\\\n-20  15  310\n\\end{pmatrix} \\, \\mathrm{kPa}\n$$\n\nFirst, we compute the mean effective stress $p'$, which is defined as one-third of the first invariant of the stress tensor, $I_1(\\boldsymbol{\\sigma'})$. The first invariant is the trace of the tensor.\n$$\nI_1(\\boldsymbol{\\sigma'}) = \\mathrm{tr}(\\boldsymbol{\\sigma'}) = \\sigma'_{11} + \\sigma'_{22} + \\sigma'_{33}\n$$\n$$\nI_1(\\boldsymbol{\\sigma'}) = 450 + 380 + 310 = 1140 \\, \\mathrm{kPa}\n$$\nTherefore, the mean effective stress is:\n$$\np' = \\frac{1}{3} I_1(\\boldsymbol{\\sigma'}) = \\frac{1140}{3} = 380 \\, \\mathrm{kPa}\n$$\n\nNext, we compute the generalized shear stress $q$. This requires the deviatoric stress tensor, $\\boldsymbol{s'}$, which is defined as $\\boldsymbol{s'} = \\boldsymbol{\\sigma'} - p'\\boldsymbol{I}$, where $\\boldsymbol{I}$ is the $3 \\times 3$ identity matrix.\n$$\n\\boldsymbol{s'} = \\begin{pmatrix}\n450  35  -20 \\\\\n35  380  15 \\\\\n-20  15  310\n\\end{pmatrix} - 380 \\begin{pmatrix}\n1  0  0 \\\\\n0  1  0 \\\\\n0  0  1\n\\end{pmatrix}\n$$\n$$\n\\boldsymbol{s'} = \\begin{pmatrix}\n450 - 380  35  -20 \\\\\n35  380 - 380  15 \\\\\n-20  15  310 - 380\n\\end{pmatrix} = \\begin{pmatrix}\n70  35  -20 \\\\\n35  0  15 \\\\\n-20  15  -70\n\\end{pmatrix} \\, \\mathrm{kPa}\n$$\nThe generalized shear stress $q$ is defined in terms of the second invariant of the deviatoric stress tensor, $J_2$.\n$$\nJ_2 = \\frac{1}{2} \\mathrm{tr}(\\boldsymbol{s'}^2) = \\frac{1}{2} s'_{ij} s'_{ji} = \\frac{1}{2} \\left( (s'_{11})^2 + (s'_{22})^2 + (s'_{33})^2 + 2\\left((s'_{12})^2 + (s'_{23})^2 + (s'_{31})^2\\right) \\right)\n$$\nSubstituting the components of $\\boldsymbol{s'}$:\n$$\nJ_2 = \\frac{1}{2} \\left( 70^2 + 0^2 + (-70)^2 + 2(35^2 + 15^2 + (-20)^2) \\right)\n$$\n$$\nJ_2 = \\frac{1}{2} \\left( 4900 + 4900 + 2(1225 + 225 + 400) \\right) = \\frac{1}{2} \\left( 9800 + 2(1850) \\right)\n$$\n$$\nJ_2 = \\frac{1}{2} (9800 + 3700) = \\frac{13500}{2} = 6750 \\, \\mathrm{kPa}^2\n$$\nThe generalized shear stress $q$ is defined as:\n$$\nq = \\sqrt{3 J_2} = \\sqrt{3 \\times 6750} = \\sqrt{20250} = \\sqrt{2025 \\times 10} = 45\\sqrt{10} \\, \\mathrm{kPa}\n$$\nNumerically, $q \\approx 142.3025 \\, \\mathrm{kPa}$.\n\nTo find the Lode angle $\\theta$, we first compute the third invariant of the deviatoric stress tensor, $J_3 = \\det(\\boldsymbol{s'})$.\n$$\nJ_3 = \\det \\begin{pmatrix}\n70  35  -20 \\\\\n35  0  15 \\\\\n-20  15  -70\n\\end{pmatrix}\n$$\n$$\nJ_3 = 70(0 \\cdot (-70) - 15 \\cdot 15) - 35(35 \\cdot (-70) - 15 \\cdot (-20)) - 20(35 \\cdot 15 - 0 \\cdot (-20))\n$$\n$$\nJ_3 = 70(-225) - 35(-2450 + 300) - 20(525)\n$$\n$$\nJ_3 = -15750 - 35(-2150) - 10500 = -15750 + 75250 - 10500 = 49000 \\, \\mathrm{kPa}^3\n$$\nThe Lode angle $\\theta$ is defined such that it conforms to the given conventions for triaxial compression ($\\theta = \\pi/6$) and triaxial extension ($\\theta = -\\pi/6$). The appropriate formula is:\n$$\n\\sin(3\\theta) = \\frac{3\\sqrt{3}}{2} \\frac{J_3}{(J_2)^{3/2}}\n$$\nWe compute the argument of the arcsin function:\n$$\n\\frac{3\\sqrt{3}}{2} \\frac{J_3}{(J_2)^{3/2}} = \\frac{3\\sqrt{3}}{2} \\frac{49000}{(6750)^{3/2}} = \\frac{3\\sqrt{3} \\times 49000}{2 \\times (6750 \\sqrt{6750})} = \\frac{147000\\sqrt{3}}{2 \\times 101250\\sqrt{30}} = \\frac{147000\\sqrt{3}}{202500\\sqrt{30}} = \\frac{1470}{2025\\sqrt{10}}\n$$\nSimplifying the fraction $\\frac{1470}{2025} = \\frac{98}{135}$.\n$$\n\\sin(3\\theta) = \\frac{98}{135\\sqrt{10}} \\approx 0.2295535\n$$\nSolving for $\\theta$:\n$$\n3\\theta = \\arcsin\\left(\\frac{98}{135\\sqrt{10}}\\right) \\approx \\arcsin(0.2295535) \\approx 0.231575 \\, \\mathrm{rad}\n$$\n$$\n\\theta = \\frac{1}{3} \\arcsin\\left(\\frac{98}{135\\sqrt{10}}\\right) \\approx \\frac{0.231575}{3} \\approx 0.077192 \\, \\mathrm{rad}\n$$\nRounding the results to the specified precision:\n- $p'$ to four significant figures: $380.0 \\, \\mathrm{kPa}$.\n- $q$ to four significant figures: $142.3 \\, \\mathrm{kPa}$.\n- $\\theta$ to three significant figures: $0.0772 \\, \\mathrm{rad}$.\n\nThe triplet of stress invariants is $(p', q, \\theta) \\approx (380.0, 142.3, 0.0772)$.\n\nFinally, we determine which meridian the stress state is closest to by comparing the absolute angular distance of our calculated $\\theta$ to the meridians for triaxial compression ($\\theta_{TC} = \\pi/6$), triaxial extension ($\\theta_{TE} = -\\pi/6$), and pure shear ($\\theta_{PS} = 0$).\n$$\n\\theta \\approx 0.0772 \\, \\mathrm{rad}\n$$\n$$\n\\theta_{TC} = \\frac{\\pi}{6} \\approx 0.5236 \\, \\mathrm{rad}\n$$\n$$\n\\theta_{TE} = -\\frac{\\pi}{6} \\approx -0.5236 \\, \\mathrm{rad}\n$$\n$$\n\\theta_{PS} = 0 \\, \\mathrm{rad}\n$$\nThe absolute angular distances are:\n- Distance to TC meridian: $|\\theta - \\theta_{TC}| \\approx |0.0772 - 0.5236| = 0.4464 \\, \\mathrm{rad}$.\n- Distance to TE meridian: $|\\theta - \\theta_{TE}| \\approx |0.0772 - (-0.5236)| = 0.6008 \\, \\mathrm{rad}$.\n- Distance to PS meridian: $|\\theta - \\theta_{PS}| \\approx |0.0772 - 0| = 0.0772 \\, \\mathrm{rad}$.\n\nThe smallest distance is to the pure shear meridian ($\\theta = 0$). Thus, the given stress state is closest to the pure shear or intermediate meridian.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n380.0  142.3  0.0772\n\\end{pmatrix}\n}\n$$", "id": "3514410"}, {"introduction": "The predictive power of critical state models hinges on a few key material parameters, such as the stress ratio $M$ and the specific volume parameter $\\Gamma$. This practice challenges you to step into the role of a computational modeler, where you'll derive and implement estimators to recover these parameters from synthetic simulation data. By accounting for realistic noise structures, you will learn how to use statistical methods like Weighted Least Squares to perform robust model calibration, a crucial skill for bridging theory and application. [@problem_id:3514412]", "problem": "You are tasked with formulating and solving an inverse problem in computational geomechanics to identify critical state parameters from synthetic data representing discrete element method (DEM) triaxial simulations. The macroscopic critical state line and normal compression relation are defined at the element scale by the critical state soil mechanics framework through two core definitions: the deviatoric stress relation $q = M p'$ and the specific volume relation $v = \\Gamma - \\lambda \\ln p'$, where $q$ and $p'$ are stresses, $v$ is specific volume, $M$ and $\\Gamma$ are dimensionless material parameters, and $\\lambda$ is the slope of the normal compression line in $(v, \\ln p')$ space. In this problem, these relations are treated as constitutive definitions, and the goal is to recover the macroscopic parameters $M$ and $\\Gamma$ from noisy synthetic data generated by a forward model that includes micro-mechanical influences.\n\nYou must proceed from first principles of inverse problems and least squares estimation, accounting for measurement error structure consistent with the data generation. Your algorithm must produce robust estimates that are reproducible and physically interpretable.\n\nAssume the following forward modeling assumptions for synthetic DEM-like data generation:\n- Stresses $q$ and $p'$ are in kilopascals (kPa). Specific volume $v$ is dimensionless. Parameters $M$ and $\\Gamma$ are dimensionless.\n- The true baseline macro-parameters are $M_0 = 1.2$, $\\Gamma_0 = 1.95$, and $\\lambda = 0.12$.\n- Micro-parameters are the particle friction coefficient $\\mu$ (dimensionless) and the normal contact stiffness $k_n$ (in newton per meter, N/m). The reference values are $\\mu_{\\mathrm{ref}} = 0.5$ and $k_{\\mathrm{ref}} = 10^5$.\n- Micro-to-macro sensitivity is modeled as linear in $\\mu$ and logarithmic in $k_n$ using the following effective parameters:\n  $$M_{\\mathrm{eff}}(\\mu, k_n) = M_0 + s_\\mu \\left(\\mu - \\mu_{\\mathrm{ref}}\\right) + s_k \\ln\\!\\left(\\frac{k_n}{k_{\\mathrm{ref}}}\\right),$$\n  $$\\Gamma_{\\mathrm{eff}}(\\mu, k_n) = \\Gamma_0 + t_\\mu \\left(\\mu - \\mu_{\\mathrm{ref}}\\right) + t_k \\ln\\!\\left(\\frac{k_n}{k_{\\mathrm{ref}}}\\right),$$\n  with fixed sensitivity coefficients $s_\\mu = 0.6$, $s_k = 0.03$, $t_\\mu = -0.02$, and $t_k = -0.01$.\n- For each test case, $N$ data points are generated at mean effective stresses\n  $$p'_i \\in \\{50, 75, 100, 150, 200, 250, 300, 350, 400\\}\\ \\text{kPa},$$\n  forming an array of $N = 9$ values (units kPa).\n- The corresponding noiseless macroscopic responses are\n  $$q_i^{\\ast} = M_{\\mathrm{eff}}(\\mu, k_n)\\, p'_i,$$\n  $$v_i^{\\ast} = \\Gamma_{\\mathrm{eff}}(\\mu, k_n) - \\lambda \\ln p'_i.$$\n- Additive noise is applied to reflect realistic heteroscedasticity:\n  $$q_i = q_i^{\\ast} + \\varepsilon_{q,i}, \\quad \\varepsilon_{q,i} \\sim \\mathcal{N}\\left(0, \\sigma_q^2\\, (p'_i)^2\\right), \\quad \\sigma_q = 0.02,$$\n  $$v_i = v_i^{\\ast} + \\varepsilon_{v,i}, \\quad \\varepsilon_{v,i} \\sim \\mathcal{N}\\left(0, \\sigma_v^2\\right), \\quad \\sigma_v = 0.005.$$\n  All randomness must be generated deterministically using a fixed seed equal to $42$ for reproducibility. Use the natural logarithm for $\\ln(\\cdot)$.\n\nYour tasks:\n1. For each test case, derive from first principles and implement an estimator for $M$ by solving a weighted least squares problem for the model $q_i \\approx M p'_i$ that accounts for the non-constant variance of $\\varepsilon_{q,i}$. Your derivation must start from the principle of minimizing the sum of squared residuals weighted by the inverse noise variance, and must not assume any closed-form shortcut. Express the final estimator you implement as the solution to the corresponding normal equations.\n2. For each test case, derive from first principles and implement an estimator for $\\Gamma$ by solving an ordinary least squares problem for the model $v_i \\approx \\Gamma - \\lambda \\ln p'_i$ under the assumption of constant variance of $\\varepsilon_{v,i}$. Show how to transform this to an intercept-only estimation problem and derive the corresponding estimator from the minimization of the sum of squared residuals.\n\nTest suite:\n- Use the following five micro-parameter cases to explore macro sensitivity:\n  - Case A (reference): $(\\mu, k_n) = (0.5, 10^5)$.\n  - Case B (low friction): $(\\mu, k_n) = (0.3, 10^5)$.\n  - Case C (high friction): $(\\mu, k_n) = (0.7, 10^5)$.\n  - Case D (low stiffness): $(\\mu, k_n) = (0.5, 3 \\times 10^4)$.\n  - Case E (high stiffness): $(\\mu, k_n) = (0.5, 10^6)$.\n\nComputational requirements:\n- Implement the synthetic data generation strictly according to the model above with the exact constants provided, the stress units in kPa, and the fixed random seed $42$.\n- Implement the inverse estimators as derived in Tasks $1$ and $2$. Do not use black-box regression routines; compute the estimators directly from the normal equations.\n- For each case, report the recovered parameters $(\\widehat{M}, \\widehat{\\Gamma})$ as dimensionless numbers.\n\nFinal output format:\n- Your program should produce a single line of output containing the results for the five test cases as a comma-separated list enclosed in square brackets.\n- The list must contain $10$ floating-point numbers in the order $[\\widehat{M}_A, \\widehat{\\Gamma}_A, \\widehat{M}_B, \\widehat{\\Gamma}_B, \\widehat{M}_C, \\widehat{\\Gamma}_C, \\widehat{M}_D, \\widehat{\\Gamma}_D, \\widehat{M}_E, \\widehat{\\Gamma}_E]$.\n- Each number must be rounded to $5$ decimal places.\n- All reported values are dimensionless. No other text should be printed.\n\nNotes:\n- Ensure scientific realism by keeping to the provided stress range in kPa and by using the specified noise structure.\n- Angles are not used in this problem.\n- Do not express any result as a percentage; all outputs must be raw decimal numbers.\n\nThe program must be entirely self-contained and require no input. It must execute deterministically and produce the final output line exactly as specified.", "solution": "The problem requires the formulation and solution of an inverse problem to determine two macroscopic parameters of a critical state soil model, $M$ and $\\Gamma$, from synthetic data. The synthetic data are generated to mimic the output of discrete element method (DEM) triaxial simulations, including micromechanical sensitivities and realistic measurement noise. The solution involves deriving estimators for $M$ and $\\Gamma$ from first principles of least squares estimation and implementing them to recover the parameters for several test cases.\n\nThe problem's structure is as follows: first, a forward model generates synthetic data $(p'_i, q_i, v_i)$ for $i=1, \\dots, N$. This data combines a deterministic constitutive relationship with stochastic noise. Second, an inverse model is applied to this noisy data to estimate the constitutive parameters.\n\nThe forward model defines the effective macroscopic parameters $M_{\\mathrm{eff}}$ and $\\Gamma_{\\mathrm{eff}}$ as functions of micro-parameters $\\mu$ and $k_n$:\n$$ M_{\\mathrm{eff}}(\\mu, k_n) = M_0 + s_\\mu (\\mu - \\mu_{\\mathrm{ref}}) + s_k \\ln\\!\\left(\\frac{k_n}{k_{\\mathrm{ref}}}\\right) $$\n$$ \\Gamma_{\\mathrm{eff}}(\\mu, k_n) = \\Gamma_0 + t_\\mu (\\mu - \\mu_{\\mathrm{ref}}) + t_k \\ln\\!\\left(\\frac{k_n}{k_{\\mathrm{ref}}}\\right) $$\nThe noiseless data points $(p'_i, q_i^*, v_i^*)$ lie on the critical state line and normal compression line:\n$$ q_i^{\\ast} = M_{\\mathrm{eff}} p'_i $$\n$$ v_i^{\\ast} = \\Gamma_{\\mathrm{eff}} - \\lambda \\ln p'_i $$\nFinally, noisy observations $q_i$ and $v_i$ are generated by adding zero-mean Gaussian noise with specified variance structures:\n$$ q_i = q_i^{\\ast} + \\varepsilon_{q,i}, \\quad \\varepsilon_{q,i} \\sim \\mathcal{N}\\left(0, \\sigma_q^2 (p'_i)^2\\right) $$\n$$ v_i = v_i^{\\ast} + \\varepsilon_{v,i}, \\quad \\varepsilon_{v,i} \\sim \\mathcal{N}\\left(0, \\sigma_v^2\\right) $$\n\nThe inversion task is to estimate $M_{\\mathrm{eff}}$ and $\\Gamma_{\\mathrm{eff}}$ from the noisy data sets $(p'_i, q_i)$ and $(p'_i, v_i)$, respectively. We will denote the estimators as $\\widehat{M}$ and $\\widehat{\\Gamma}$.\n\n**1. Estimation of the Stress Ratio Parameter $M$**\n\nThe model for the deviatoric stress is $q_i \\approx M p'_i$. The noise term $\\varepsilon_{q,i}$ has a variance, $\\text{Var}(\\varepsilon_{q,i}) = \\sigma_q^2 (p'_i)^2$, that depends on the independent variable $p'_i$. This property is known as heteroscedasticity. The appropriate estimation method for such a linear model is Weighted Least Squares (WLS). The principle of WLS is to minimize the sum of squared residuals, where each residual is weighted by the inverse of its error variance.\n\nThe objective function to minimize with respect to the parameter $M$ is:\n$$ S(M) = \\sum_{i=1}^{N} w_i (q_i - M p'_i)^2 $$\nThe optimal weights $w_i$ are the inverse of the error variances: $w_i = 1/\\text{Var}(\\varepsilon_{q,i}) = 1/(\\sigma_q^2 (p'_i)^2)$. Substituting these weights, the objective function becomes:\n$$ S(M) = \\sum_{i=1}^{N} \\frac{1}{\\sigma_q^2 (p'_i)^2} (q_i - M p'_i)^2 $$\nTo find the estimator $\\widehat{M}$ that minimizes $S(M)$, we differentiate $S(M)$ with respect to $M$ and set the result to zero:\n$$ \\frac{dS}{dM} = \\frac{d}{dM} \\sum_{i=1}^{N} \\frac{1}{\\sigma_q^2 (p'_i)^2} (q_i - M p'_i)^2 = 0 $$\n$$ \\sum_{i=1}^{N} \\frac{1}{\\sigma_q^2 (p'_i)^2} \\cdot 2(q_i - M p'_i) \\cdot (-p'_i) = 0 $$\nThe constant factor $-2/\\sigma_q^2$ can be removed, yielding:\n$$ \\sum_{i=1}^{N} \\frac{p'_i}{(p'_i)^2} (q_i - M p'_i) = \\sum_{i=1}^{N} \\frac{1}{p'_i} (q_i - M p'_i) = 0 $$\nDistributing the sum and solving for the estimator $\\widehat{M}$:\n$$ \\sum_{i=1}^{N} \\frac{q_i}{p'_i} - \\sum_{i=1}^{N} \\frac{\\widehat{M} p'_i}{p'_i} = 0 $$\n$$ \\sum_{i=1}^{N} \\frac{q_i}{p'_i} - \\sum_{i=1}^{N} \\widehat{M} = 0 $$\n$$ \\sum_{i=1}^{N} \\frac{q_i}{p'_i} - N \\widehat{M} = 0 $$\nThis yields the final expression for the WLS estimator for $M$:\n$$ \\widehat{M} = \\frac{1}{N} \\sum_{i=1}^{N} \\frac{q_i}{p'_i} $$\nThis result can be derived formally from the normal equations for WLS. For the model $\\mathbf{q} = \\mathbf{X}\\beta + \\varepsilon$ with $\\mathbf{X} = [p'_1, \\dots, p'_N]^T$ and $\\beta = [M]$, the solution is $\\widehat{\\beta} = (\\mathbf{X}^T \\mathbf{W} \\mathbf{X})^{-1} \\mathbf{X}^T \\mathbf{W} \\mathbf{q}$, where $\\mathbf{W} = \\text{diag}(w_i)$. The calculations shown above are equivalent to solving this system. The implementation will compute this simple arithmetic mean of the ratios $q_i/p'_i$.\n\n**2. Estimation of the Specific Volume Parameter $\\Gamma$**\n\nThe model for the specific volume is $v_i \\approx \\Gamma - \\lambda \\ln p'_i$. The parameter $\\lambda$ is given as a constant ($\\lambda = 0.12$). The noise term $\\varepsilon_{v,i}$ has a constant variance, $\\text{Var}(\\varepsilon_{v,i}) = \\sigma_v^2$. This is a homoscedastic model, for which Ordinary Least Squares (OLS) is the appropriate method.\n\nTo simplify the estimation, we can rearrange the model to isolate the unknown parameter $\\Gamma$. We define a new dependent variable, $y_i$, as:\n$$ y_i = v_i + \\lambda \\ln p'_i $$\nSubstituting this into the model equation, we obtain an intercept-only model:\n$$ y_i \\approx \\Gamma $$\nThe statistical model for $y_i$ is $y_i = \\Gamma + \\varepsilon_{v,i}$. The task reduces to estimating the mean of the observations $y_i$. The OLS estimator $\\widehat{\\Gamma}$ is found by minimizing the sum of squared residuals:\n$$ S(\\Gamma) = \\sum_{i=1}^{N} (y_i - \\Gamma)^2 $$\nDifferentiating with respect to $\\Gamma$ and setting the result to zero gives the normal equation for this problem:\n$$ \\frac{dS}{d\\Gamma} = \\frac{d}{d\\Gamma} \\sum_{i=1}^{N} (y_i - \\Gamma)^2 = \\sum_{i=1}^{N} -2(y_i - \\Gamma) = 0 $$\n$$ \\sum_{i=1}^{N} (y_i - \\Gamma) = 0 $$\n$$ \\sum_{i=1}^{N} y_i - \\sum_{i=1}^{N} \\Gamma = 0 $$\n$$ \\sum_{i=1}^{N} y_i - N \\Gamma = 0 $$\nSolving for the estimator $\\widehat{\\Gamma}$:\n$$ \\widehat{\\Gamma} = \\frac{1}{N} \\sum_{i=1}^{N} y_i $$\nSubstituting the definition of $y_i$ back gives the final estimator:\n$$ \\widehat{\\Gamma} = \\frac{1}{N} \\sum_{i=1}^{N} (v_i + \\lambda \\ln p'_i) $$\nThis estimator is simply the sample mean of the transformed variable $y_i$. The implementation will calculate this mean for each test case.\n\nThe overall algorithm for each test case is:\n1.  Calculate the ground-truth effective parameters $M_{\\mathrm{eff}}$ and $\\Gamma_{\\mathrm{eff}}$ based on the given micro-parameters $(\\mu, k_n)$.\n2.  Generate the set of $N=9$ noiseless data points $(q_i^*, v_i^*)$ at the specified stress levels $p'_i$.\n3.  Add the specified heteroscedastic noise to $q_i^*$ and homoscedastic noise to $v_i^*$ using a fixed random seed for reproducibility. This yields the synthetic measurement data $(q_i, v_i)$.\n4.  Apply the derived estimator $\\widehat{M} = \\frac{1}{N} \\sum (q_i/p'_i)$ to the $(p'_i, q_i)$ data.\n5.  Apply the derived estimator $\\widehat{\\Gamma} = \\frac{1}{N} \\sum (v_i + \\lambda \\ln p'_i)$ to the $(p'_i, v_i)$ data.\n6.  The resulting pair $(\\widehat{M}, \\widehat{\\Gamma})$ constitutes the solution for that test case. This is repeated for all five cases.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves an inverse problem to identify critical state parameters from synthetic data.\n    The solution involves generating synthetic data based on a forward model and then\n    recovering the parameters using Weighted Least Squares for M and Ordinary Least\n    Squares for Gamma, as derived from first principles.\n    \"\"\"\n\n    # --- 1. Define Constants and Forward Model Parameters ---\n    M0 = 1.2\n    Gamma0 = 1.95\n    lambda_val = 0.12\n    mu_ref = 0.5\n    k_ref = 1e5\n    s_mu = 0.6\n    s_k = 0.03\n    t_mu = -0.02\n    t_k = -0.01\n    sigma_q = 0.02\n    sigma_v = 0.005\n    RANDOM_SEED = 42\n\n    # Stress levels for data generation (in kPa)\n    p_prime = np.array([50., 75., 100., 150., 200., 250., 300., 350., 400.])\n    N = len(p_prime)\n\n    # Test suite of micro-parameters\n    test_cases = [\n        (0.5, 1e5),          # Case A (reference)\n        (0.3, 1e5),          # Case B (low friction)\n        (0.7, 1e5),          # Case C (high friction)\n        (0.5, 3e4),          # Case D (low stiffness)\n        (0.5, 1e6)           # Case E (high stiffness)\n    ]\n\n    # Initialize random number generator for reproducibility\n    rng = np.random.default_rng(RANDOM_SEED)\n\n    results = []\n    \n    # --- 2. Process Each Test Case ---\n    for mu, k_n in test_cases:\n        \n        # --- 2a. Generate Synthetic Data ---\n        \n        # Calculate effective macro-parameters based on micro-parameters\n        M_eff = M0 + s_mu * (mu - mu_ref) + s_k * np.log(k_n / k_ref)\n        Gamma_eff = Gamma0 + t_mu * (mu - mu_ref) + t_k * np.log(k_n / k_ref)\n        \n        # Generate noiseless data\n        q_star = M_eff * p_prime\n        v_star = Gamma_eff - lambda_val * np.log(p_prime)\n        \n        # Generate heteroscedastic noise for q\n        std_dev_q = sigma_q * p_prime\n        epsilon_q = rng.normal(0, std_dev_q, size=N)\n        \n        # Generate homoscedastic noise for v\n        epsilon_v = rng.normal(0, sigma_v, size=N)\n        \n        # Add noise to generate synthetic measurements\n        q_measured = q_star + epsilon_q\n        v_measured = v_star + epsilon_v\n        \n        # --- 2b. Inverse Problem: Estimate M and Gamma ---\n        \n        # Estimate M using the derived Weighted Least Squares estimator\n        # Model: q_i = M * p'_i\n        # Estimator: M_hat = (1/N) * sum(q_i / p'_i)\n        # This is the solution to the normal equations for the WLS problem.\n        M_hat = np.mean(q_measured / p_prime)\n        \n        # Estimate Gamma using the derived Ordinary Least Squares estimator\n        # Model: v_i = Gamma - lambda * ln(p'_i)\n        # Rearranged model: y_i = v_i + lambda * ln(p'_i) = Gamma\n        # Estimator: Gamma_hat = mean(y_i)\n        y = v_measured + lambda_val * np.log(p_prime)\n        Gamma_hat = np.mean(y)\n        \n        results.extend([M_hat, Gamma_hat])\n        \n    # --- 3. Format and Print Final Output ---\n    # The output format must be a list of 10 floats, rounded to 5 decimal places.\n    formatted_results = [f'{x:.5f}' for x in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n\n```", "id": "3514412"}, {"introduction": "In large-scale numerical simulations, we need automated methods to interpret the state of the material at thousands of points and time steps. This practice focuses on a common challenge: creating a robust algorithm to detect when the soil has reached its critical state. You will translate the theoretical definitions—a constant stress ratio and zero plastic volume change—into a practical detection code, learning how to filter out numerical noise and transients to make reliable judgments. [@problem_id:3514403]", "problem": "You are given a sequence of incremental stress–strain response data at a single integration point of a finite element, represented by arrays of mean effective stress $p'$ (in $\\mathrm{kPa}$), deviatoric stress $q$ (in $\\mathrm{kPa}$), and plastic volumetric strain increment $d\\varepsilon_v^p$ (dimensionless). The goal is to implement automatic detection of the Critical State Line (CSL) by monitoring two indicators and applying robust thresholds that avoid false positives in finite element simulations. Critical State Line (CSL) and State Boundary Surface (SBS) are concepts from critical state soil mechanics: at the critical state, $q$ and $p'$ satisfy a constant stress ratio relation controlled by frictional resistance, and the plastic volumetric increment tends to zero.\n\nFundamental base and definitions:\n- The mean effective stress $p'$ and deviatoric stress $q$ are stress invariants used to characterize soil response. The CSL is characterized by a constant stress ratio parameter $M$ (dimensionless), such that at the critical state the stress pair lies on a line in the $(p',q)$ plane. We define a normalized CSL deviation at increment index $t$ by\n$$\n\\phi_t = \\frac{\\left| q_t - M\\,p'_t \\right|}{\\max\\left(p'_t,\\,p_{\\mathrm{floor}}\\right)},\n$$\nwhere $p_{\\mathrm{floor}}$ is a lower bound to prevent division by small $p'$.\n- The magnitude of the plastic volumetric strain increment is\n$$\nv_t = \\left| d\\varepsilon_{v,t}^p \\right|.\n$$\n- Robust detection should require persistence and smoothness to avoid false positives that could arise from numerical noise, transient spikes, or vanishing confinement. To this end, detection is declared if there exists a contiguous window of $k$ increments that satisfies all of the following:\n    1. $\\phi_t \\le \\tau_{\\mathrm{CSL}}$ for all increments in the window.\n    2. $v_t \\le \\tau_{\\mathrm{vol}}$ for all increments in the window.\n    3. $p'_t \\ge p_{\\mathrm{det,min}}$ for all increments in the window.\n    4. The spread of CSL deviation within the window is bounded by\n    $$\n    \\max(\\phi_t \\text{ over window}) - \\min(\\phi_t \\text{ over window}) \\le s_{\\max}.\n    $$\n\nThresholds and parameters to use in all test cases:\n- CSL deviation tolerance $\\tau_{\\mathrm{CSL}} = 0.03$ (dimensionless).\n- Volumetric increment tolerance $\\tau_{\\mathrm{vol}} = 5\\times 10^{-7}$ (dimensionless).\n- Normalization floor $p_{\\mathrm{floor}} = 10.0$ $\\mathrm{kPa}$.\n- Minimum detection confinement $p_{\\mathrm{det,min}} = 20.0$ $\\mathrm{kPa}$.\n- Persistence length $k = 3$ increments.\n- Smoothness bound $s_{\\max} = 0.015$ (dimensionless).\n\nDetection rule output:\n- For each test case, output a boolean that is $True$ if a window of $k$ consecutive increments exists that satisfies all four conditions above, and $False$ otherwise.\n\nAngle units do not apply in this problem. Stress values must be handled in $\\mathrm{kPa}$ and strain increments are dimensionless.\n\nTest suite:\nProvide results for the following $6$ test cases. Each case consists of a parameter $M$ (dimensionless), and arrays $p'$ (in $\\mathrm{kPa}$), $q$ (in $\\mathrm{kPa}$), and $d\\varepsilon_v^p$ (dimensionless). The arrays are ordered sequences of increments; apply the detection criteria over contiguous windows of length $k$.\n\n- Case $1$ (happy path; sustained approach to CSL with vanishing $d\\varepsilon_v^p$):\n    - $M = 1.25$\n    - $p' = [50,\\,60,\\,70,\\,80,\\,90,\\,100,\\,100,\\,100]$\n    - $q = [1.25\\cdot 50 + 5,\\,1.25\\cdot 60 + 3,\\,1.25\\cdot 70 + 2.8,\\,1.25\\cdot 80 + 2.4,\\,1.25\\cdot 90 + 1.8,\\,1.25\\cdot 100 + 1.5,\\,1.25\\cdot 100 + 1.2,\\,1.25\\cdot 100 + 1.0]$\n    - $d\\varepsilon_v^p = [-8\\times 10^{-6},\\,-6\\times 10^{-6},\\,-4\\times 10^{-6},\\,-2\\times 10^{-6},\\,-1\\times 10^{-6},\\,-5\\times 10^{-7},\\,-4\\times 10^{-7},\\,-3\\times 10^{-7}]$\n- Case $2$ (low confinement; avoid false positives via $p' \\ge p_{\\mathrm{det,min}}$ requirement):\n    - $M = 1.25$\n    - $p' = [8,\\,9,\\,10,\\,12,\\,15]$\n    - $q = [1.25\\cdot 8 + 0.2,\\,1.25\\cdot 9 + 0.225,\\,1.25\\cdot 10 + 0.25,\\,1.25\\cdot 12 + 0.3,\\,1.25\\cdot 15 + 0.3]$\n    - $d\\varepsilon_v^p = [-3\\times 10^{-7},\\,-3\\times 10^{-7},\\,-3\\times 10^{-7},\\,-3\\times 10^{-7},\\,-3\\times 10^{-7}]$\n- Case $3$ (transient near-CSL without persistence in $d\\varepsilon_v^p$):\n    - $M = 1.2$\n    - $p' = [80,\\,80,\\,80,\\,80,\\,80]$\n    - $q = [1.2\\cdot 80 + 2.5,\\,1.2\\cdot 80 + 2.0,\\,1.2\\cdot 80 + 1.8,\\,1.2\\cdot 80 + 4.0,\\,1.2\\cdot 80 + 3.8]$\n    - $d\\varepsilon_v^p = [-4\\times 10^{-6},\\,-6\\times 10^{-6},\\,-4\\times 10^{-7},\\,-6\\times 10^{-6},\\,-6\\times 10^{-6}]$\n- Case $4$ (near CSL in stress space but not at critical state due to non-vanishing $d\\varepsilon_v^p$):\n    - $M = 1.3$\n    - $p' = [70,\\,80,\\,90,\\,100]$\n    - $q = [1.3\\cdot 70 + 1.0,\\,1.3\\cdot 80 + 1.0,\\,1.3\\cdot 90 + 1.0,\\,1.3\\cdot 100 + 1.0]$\n    - $d\\varepsilon_v^p = [1\\times 10^{-5},\\,1\\times 10^{-5},\\,8\\times 10^{-6},\\,7\\times 10^{-6}]$\n- Case $5$ (boundary case; equality to thresholds should count as detection):\n    - $M = 1.25$\n    - $p' = [100,\\,100,\\,100]$\n    - $q = [1.25\\cdot 100 + 3.0,\\,1.25\\cdot 100 + 3.0,\\,1.25\\cdot 100 + 3.0]$\n    - $d\\varepsilon_v^p = [-5\\times 10^{-7},\\,-5\\times 10^{-7},\\,-5\\times 10^{-7}]$\n- Case $6$ (noisy CSL deviation within window; rejected by smoothness bound):\n    - $M = 1.25$\n    - $p' = [90,\\,95,\\,100,\\,100,\\,100]$\n    - $q = [1.25\\cdot 90 + 5.0,\\,1.25\\cdot 95 + 3.0,\\,1.25\\cdot 100 + 2.0,\\,1.25\\cdot 100 + 1.0,\\,1.25\\cdot 100 + 2.8]$\n    - $d\\varepsilon_v^p = [-1\\times 10^{-6},\\,-8\\times 10^{-7},\\,-3\\times 10^{-7},\\,-3\\times 10^{-7},\\,-3\\times 10^{-7}]$\n\nOutput specification:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[result_1,result_2,\\dots,result_6]$), where each $result_i$ is a boolean indicating detection for the corresponding test case.\n\nImplement the detection according to the definitions and thresholds above. The program must be self-contained and must not require any user input.", "solution": "The problem requires the implementation of a robust algorithm to detect the attainment of the Critical State Line (CSL) from incremental stress-strain data in a computational geomechanics context. The detection must be based on four specific conditions applied over a contiguous window of data to ensure persistence and smoothness, thereby avoiding false positives.\n\nThe fundamental physical principles are that at the critical state, a soil element deforms at constant volume and constant stress. The stress state, defined by the mean effective stress $p'$ and deviatoric stress $q$, lies on the CSL, which is a line in the $(p', q)$ plane defined by the constant stress ratio $M$: $q = M p'$. The deformation at constant volume implies that the plastic volumetric strain increment $d\\varepsilon_v^p$ approaches zero.\n\nThe algorithm will systematically verify these principles using the given data and thresholds. For each test case, we are given the CSL parameter $M$, and time series of $p'_t$, $q_t$, and $d\\varepsilon_{v,t}^p$. The detection logic is based on analyzing a sliding window of $k=3$ consecutive increments.\n\nFirst, we define and compute two key indicators for each increment $t$:\n1.  The normalized CSL deviation, $\\phi_t$, measures how far the stress state $(p'_t, q_t)$ is from the CSL. It is given by\n    $$\n    \\phi_t = \\frac{\\left| q_t - M\\,p'_t \\right|}{\\max\\left(p'_t,\\,p_{\\mathrm{floor}}\\right)}\n    $$\n    where $p_{\\mathrm{floor}} = 10.0\\,\\mathrm{kPa}$ is a normalization floor to handle low confinement stresses. A small $\\phi_t$ indicates proximity to the CSL.\n\n2.  The magnitude of the plastic volumetric strain increment, $v_t$, quantifies the rate of volume change. It is given by\n    $$\n    v_t = \\left| d\\varepsilon_{v,t}^p \\right|\n    $$\n    A small $v_t$ indicates that the material is approaching a state of constant volume deformation.\n\nWith these indicators, the detection rule is as follows: a critical state is detected if there exists at least one contiguous window of $k=3$ increments that simultaneously satisfies all four of the following conditions:\n1.  **CSL Deviation Condition**: $\\phi_t \\le \\tau_{\\mathrm{CSL}}$ for all $t$ in the window. The threshold is $\\tau_{\\mathrm{CSL}} = 0.03$.\n2.  **Volumetric Strain Condition**: $v_t \\le \\tau_{\\mathrm{vol}}$ for all $t$ in the window. The threshold is $\\tau_{\\mathrm{vol}} = 5 \\times 10^{-7}$.\n3.  **Confinement Condition**: $p'_t \\ge p_{\\mathrm{det,min}}$ for all $t$ in the window. The minimum confinement is $p_{\\mathrm{det,min}} = 20.0\\,\\mathrm{kPa}$. This prevents spurious detection at near-zero stress.\n4.  **Smoothness Condition**: $\\max(\\phi_t \\text{ over window}) - \\min(\\phi_t \\text{ over window}) \\le s_{\\max}$. This ensures the CSL deviation is not overly noisy within the window, with a maximum spread of $s_{\\max} = 0.015$.\n\nThe algorithmic procedure is to iterate through all possible windows of size $k=3$ for each test case. For a sequence of $N$ increments, the windows are indexed from $[0, 1, 2]$ to $[N-3, N-2, N-1]$. If any single window satisfies all four criteria, the result for the test case is `True`. If all windows are checked and none satisfy the criteria, the result is `False`.\n\nLet us illustrate with two examples:\n\n**Case 1 (Successful Detection):**\nGiven $M=1.25$ and the arrays for $p'$, $q$, and $d\\varepsilon_v^p$.\nThe sequences of $\\phi_t$ and $v_t$ are calculated as:\n$\\phi = [0.1, 0.05, 0.04, 0.03, 0.02, 0.015, 0.012, 0.01]$\n$v = [8 \\times 10^{-6}, 6 \\times 10^{-6}, 4 \\times 10^{-6}, 2 \\times 10^{-6}, 1 \\times 10^{-6}, 5 \\times 10^{-7}, 4 \\times 10^{-7}, 3 \\times 10^{-7}]$\n\nWe test the last possible window, covering increments $t=5, 6, 7$.\n- Window data:\n  - $p' = [100, 100, 100]\\,\\mathrm{kPa}$\n  - $\\phi = [0.015, 0.012, 0.01]$\n  - $v = [5 \\times 10^{-7}, 4 \\times 10^{-7}, 3 \\times 10^{-7}]$\n\n- Checking conditions:\n  1. $\\phi_t \\le 0.03$: All values $[0.015, 0.012, 0.01]$ are $\\le 0.03$. (Pass)\n  2. $v_t \\le 5 \\times 10^{-7}$: All values $[5 \\times 10^{-7}, 4 \\times 10^{-7}, 3 \\times 10^{-7}]$ are $\\le 5 \\times 10^{-7}$. (Pass)\n  3. $p'_t \\ge 20.0\\,\\mathrm{kPa}$: All values are $100.0\\,\\mathrm{kPa}$, which is $\\ge 20.0\\,\\mathrm{kPa}$. (Pass)\n  4. Smoothness: $\\max(\\phi) - \\min(\\phi) = 0.015 - 0.01 = 0.005$. This is $\\le s_{\\max}=0.015$. (Pass)\n\nSince all four conditions are met, detection is successful for Case 1. Result: `True`.\n\n**Case 6 (Failure due to Smoothness):**\nGiven $M=1.25$ and the arrays for $p'$, $q$, and $d\\varepsilon_v^p$.\nThe calculated indicator sequences are:\n$\\phi \\approx [0.0556, 0.0316, 0.02, 0.01, 0.028]$\n$v = [1 \\times 10^{-6}, 8 \\times 10^{-7}, 3 \\times 10^{-7}, 3 \\times 10^{-7}, 3 \\times 10^{-7}]$\n\nThe first two windows fail the $\\phi_t \\le\\tau_{\\mathrm{CSL}}$ condition. We examine the final window, covering increments $t=2, 3, 4$.\n- Window data:\n  - $p' = [100, 100, 100]\\,\\mathrm{kPa}$\n  - $\\phi = [0.02, 0.01, 0.028]$\n  - $v = [3 \\times 10^{-7}, 3 \\times 10^{-7}, 3 \\times 10^{-7}]$\n\n- Checking conditions:\n  1. $\\phi_t \\le 0.03$: All values $[0.02, 0.01, 0.028]$ are $\\le 0.03$. (Pass)\n  2. $v_t \\le 5 \\times 10^{-7}$: All values are $3 \\times 10^{-7}$, which is $\\le 5 \\times 10^{-7}$. (Pass)\n  3. $p'_t \\ge 20.0\\,\\mathrm{kPa}$: All values are $100.0\\,\\mathrm{kPa}$, which is $\\ge 20.0\\,\\mathrm{kPa}$. (Pass)\n  4. Smoothness: $\\max(\\phi) - \\min(\\phi) = 0.028 - 0.01 = 0.018$. This is not $\\le s_{\\max}=0.015$. (Fail)\n\nBecause the smoothness condition fails, this window is rejected. As no other window satisfies all conditions, detection fails for Case 6. Result: `False`.\n\nThis systematic, multi-condition check across a sliding window provides a robust method for CSL detection, as intended. The implementation will follow this logic for all provided test cases.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run CSL detection on all test cases and print results.\n    \"\"\"\n    \n    # Thresholds and parameters\n    params = {\n        'tau_csl': 0.03,\n        'tau_vol': 5e-7,\n        'p_floor': 10.0,\n        'p_det_min': 20.0,\n        'k': 3,\n        's_max': 0.015,\n    }\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1 (happy path)\n        {\n            'M': 1.25,\n            'p_prime': np.array([50., 60., 70., 80., 90., 100., 100., 100.]),\n            'q': np.array([1.25*50+5, 1.25*60+3, 1.25*70+2.8, 1.25*80+2.4, 1.25*90+1.8, 1.25*100+1.5, 1.25*100+1.2, 1.25*100+1.0]),\n            'd_eps_v_p': np.array([-8e-6, -6e-6, -4e-6, -2e-6, -1e-6, -5e-7, -4e-7, -3e-7]),\n        },\n        # Case 2 (low confinement)\n        {\n            'M': 1.25,\n            'p_prime': np.array([8., 9., 10., 12., 15.]),\n            'q': np.array([1.25*8+0.2, 1.25*9+0.225, 1.25*10+0.25, 1.25*12+0.3, 1.25*15+0.3]),\n            'd_eps_v_p': np.array([-3e-7, -3e-7, -3e-7, -3e-7, -3e-7]),\n        },\n        # Case 3 (transient near-CSL)\n        {\n            'M': 1.2,\n            'p_prime': np.array([80., 80., 80., 80., 80.]),\n            'q': np.array([1.2*80+2.5, 1.2*80+2.0, 1.2*80+1.8, 1.2*80+4.0, 1.2*80+3.8]),\n            'd_eps_v_p': np.array([-4e-6, -6e-6, -4e-7, -6e-6, -6e-6]),\n        },\n        # Case 4 (non-vanishing d_eps_v_p)\n        {\n            'M': 1.3,\n            'p_prime': np.array([70., 80., 90., 100.]),\n            'q': np.array([1.3*70+1.0, 1.3*80+1.0, 1.3*90+1.0, 1.3*100+1.0]),\n            'd_eps_v_p': np.array([1e-5, 1e-5, 8e-6, 7e-6]),\n        },\n        # Case 5 (boundary case)\n        {\n            'M': 1.25,\n            'p_prime': np.array([100., 100., 100.]),\n            'q': np.array([1.25*100+3.0, 1.25*100+3.0, 1.25*100+3.0]),\n            'd_eps_v_p': np.array([-5e-7, -5e-7, -5e-7]),\n        },\n        # Case 6 (noisy, fails smoothness)\n        {\n            'M': 1.25,\n            'p_prime': np.array([90., 95., 100., 100., 100.]),\n            'q': np.array([1.25*90+5.0, 1.25*95+3.0, 1.25*100+2.0, 1.25*100+1.0, 1.25*100+2.8]),\n            'd_eps_v_p': np.array([-1e-6, -8e-7, -3e-7, -3e-7, -3e-7]),\n        },\n    ]\n\n    def check_csl_detection(case, params):\n        \"\"\"\n        Checks for CSL detection for a single case.\n        \"\"\"\n        M = case['M']\n        p_prime = case['p_prime']\n        q = case['q']\n        d_eps_v_p = case['d_eps_v_p']\n        \n        k = params['k']\n        tau_csl = params['tau_csl']\n        tau_vol = params['tau_vol']\n        p_floor = params['p_floor']\n        p_det_min = params['p_det_min']\n        s_max = params['s_max']\n\n        num_increments = len(p_prime)\n        if num_increments  k:\n            return False\n\n        # Calculate indicator arrays\n        phi = np.abs(q - M * p_prime) / np.maximum(p_prime, p_floor)\n        v = np.abs(d_eps_v_p)\n\n        # Sliding window check\n        for i in range(num_increments - k + 1):\n            window_slice = slice(i, i + k)\n            \n            p_window = p_prime[window_slice]\n            phi_window = phi[window_slice]\n            v_window = v[window_slice]\n\n            # 1. CSL deviation condition\n            cond1 = np.all(phi_window = tau_csl)\n            \n            # 2. Volumetric strain condition\n            cond2 = np.all(v_window = tau_vol)\n\n            # 3. Confinement condition\n            cond3 = np.all(p_window >= p_det_min)\n\n            # 4. Smoothness condition\n            spread = np.max(phi_window) - np.min(phi_window)\n            cond4 = spread = s_max\n            \n            if cond1 and cond2 and cond3 and cond4:\n                return True\n        \n        return False\n\n    results = []\n    for case in test_cases:\n        result = check_csl_detection(case, params)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3514403"}]}