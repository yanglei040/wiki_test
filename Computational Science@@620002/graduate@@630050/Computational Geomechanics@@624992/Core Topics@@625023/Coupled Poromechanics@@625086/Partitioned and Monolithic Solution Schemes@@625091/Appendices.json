{"hands_on_practices": [{"introduction": "Moving from continuum theory to computational implementation requires a firm grasp of discretization. This first practice provides a foundational exercise in deriving the discrete algebraic systems for a coupled poromechanical problem from first principles [@problem_id:3548409]. By constructing the monolithic Jacobian matrix and then relating its blocks to the operators used in a sequential staggered scheme, you will gain a concrete understanding of how these two distinct solution strategies emerge from the same underlying physics.", "problem": "Consider a small-strain, one-dimensional, saturated poroelastic bar of length $L$ and cross-sectional area $A$, composed of a linear elastic solid with Young’s modulus $E$ and Biot coefficient $\\alpha$. The pore fluid has viscosity $\\mu$, the skeletal and fluid compressibilities are lumped into a specific storage coefficient $s$ (with units $\\mathrm{Pa}^{-1}$), and the formation has intrinsic permeability $k$. The end $x=0$ is mechanically fixed and fluid-impermeable. The end $x=L$ is mechanically loaded by an external force $F_{\\text{ext}}$ and hydraulically connected to an external reservoir at pressure zero through a leakage boundary of characteristic length $l_b$ so that the volumetric flux at $x=L$ obeys a Robin-type law. Assume small-strain kinematics and the quasi-static Biot theory with linear constitutive relations. The governing field equations are the balance of linear momentum and the mass conservation of fluid:\n$$\n\\frac{\\partial}{\\partial x}\\left(\\sigma' - \\alpha p\\right) + b = 0, \\quad s\\,\\dot{p} + \\alpha\\,\\dot{\\epsilon} - \\frac{\\partial}{\\partial x}\\left(\\frac{k}{\\mu}\\frac{\\partial p}{\\partial x}\\right) = 0,\n$$\nwith $\\sigma' = E\\,\\epsilon$ and $\\epsilon = \\frac{\\partial u}{\\partial x}$. The leakage boundary flux at $x=L$ is $q_b = \\frac{k A}{\\mu l_b} p$.\n\nAdopt a minimal Galerkin discretization that assumes a uniform strain $\\epsilon$ and a spatially constant pore pressure $p$ over the bar so that the discrete unknowns reduce to the tip displacement $u^{n+1}$ at time $t^{n+1}$ (with $u^{n}=u(t^{n})$ given) and the uniform pressure $p^{n+1}$ (with $p^{n}=p(t^{n})$ given). Use backward Euler time integration over a step of size $\\Delta t$ for the mass conservation equation. From first principles (the field equations and constitutive laws above), construct the monolithic semi-discrete residual vector $r = [r_u; r_p]$ at time $t^{n+1}$ and the associated block Jacobian\n$$\nJ = \\begin{bmatrix} K_{uu}  K_{up} \\\\ K_{pu}  K_{pp} \\end{bmatrix},\n$$\nmaking explicit each block in terms of the physical parameters. Then, consider a sequential staggered (Gauss–Seidel) scheme in which, at iteration $k$, the mechanics subproblem is solved for $u^{k+1}$ with $p^k$ held fixed, followed by the flow subproblem solved for $p^{k+1}$ with $u^{k+1}$ held fixed. Derive the linear fixed-point mapping for the pressure update of the form\n$$\np^{k+1} = \\mathcal{A} + T\\,p^{k},\n$$\nand give the expression of the iteration matrix $T$ in terms of the Jacobian blocks. For the one-degree-of-freedom setting described here, the spectral radius $\\rho(T)$ reduces to $|T|$.\n\nUsing the following physically plausible parameters:\n- $E = 8.0 \\times 10^{9}\\ \\mathrm{Pa}$,\n- $\\alpha = 0.6$,\n- $A = 1.0 \\times 10^{-2}\\ \\mathrm{m}^{2}$,\n- $L = 2.0\\ \\mathrm{m}$,\n- $s = 5.0 \\times 10^{-10}\\ \\mathrm{Pa}^{-1}$,\n- $k = 1.0 \\times 10^{-12}\\ \\mathrm{m}^{2}$,\n- $\\mu = 1.0 \\times 10^{-3}\\ \\mathrm{Pa}\\cdot \\mathrm{s}$,\n- $l_b = 1.0 \\times 10^{-1}\\ \\mathrm{m}$,\n- $\\Delta t = 1.0 \\times 10^{3}\\ \\mathrm{s}$,\n- $F_{\\text{ext}} = 5.0 \\times 10^{5}\\ \\mathrm{N}$,\n- $u^{n} = 0$ and $p^{n} = 0$,\ncompute the spectral radius $\\rho(T)$ of the staggered iteration matrix. Express your final answer as a dimensionless number rounded to four significant figures.", "solution": "The problem requires the derivation of the monolithic system and the staggered iteration matrix for a simplified one-degree-of-freedom poroelastic model. The final goal is to compute the spectral radius of the iteration matrix for a given set of parameters.\n\n### 1. Discretization of State Variables\nFollowing the minimal Galerkin approach, the continuous fields are simplified to a single degree of freedom for displacement and pressure:\n- The displacement at the tip is $u(L) = u$. Since $u(0)=0$, the uniform strain over the bar is $\\epsilon = \\frac{u}{L}$.\n- The pore pressure is spatially constant, $p(x) = p$.\n\n### 2. Derivation of Semi-Discrete Residuals\nThe governing equations are integrated over the domain to form the residual equations for the unknowns $u$ and $p$ at time $t^{n+1}$.\n\n**Mechanical Residual ($r_u$)**\nThe weak form of the momentum balance, integrated over the volume $V=AL$, yields the algebraic force balance at the tip:\n$$ \\int_V \\delta\\epsilon (\\sigma' - \\alpha p) dV = F_{ext} \\delta u $$\nWith constant fields and $\\delta\\epsilon = \\delta u/L$, this simplifies to:\n$$ \\frac{\\delta u}{L} \\left(E \\frac{u}{L} - \\alpha p\\right) AL = F_{ext} \\delta u $$\nThe residual for the mechanics equation is thus:\n$$ r_u(u,p) = \\frac{EA}{L}u - \\alpha A p - F_{ext} = 0 $$\n\n**Flow Residual ($r_p$)**\nThe weak form of the mass conservation equation, integrated over the volume and applying the divergence theorem, becomes:\n$$ \\int_V \\delta p (s\\dot{p} + \\alpha\\dot{\\epsilon}) dV + [\\delta p A q_x]_0^L = 0 $$\nWith the impermeable boundary at $x=0$ ($q_x(0)=0$) and the leakage boundary at $x=L$ ($A q_x(L) = \\frac{kA}{\\mu l_b} p$), and constant fields:\n$$ \\delta p (s\\dot{p} + \\alpha\\dot{\\epsilon})AL + \\delta p \\frac{kA}{\\mu l_b} p = 0 $$\nApplying backward Euler time integration ($\\dot{p} \\approx \\frac{p - p^n}{\\Delta t}$, $\\dot{\\epsilon} \\approx \\frac{u - u^n}{L\\Delta t}$), we get the flow residual:\n$$ r_p(u,p) = \\frac{\\alpha A}{\\Delta t}u + \\left(\\frac{sAL}{\\Delta t} + \\frac{kA}{\\mu l_b}\\right)p - \\left(\\frac{\\alpha A u^n}{\\Delta t} + \\frac{sAL p^n}{\\Delta t}\\right) = 0 $$\n\n### 3. Monolithic Jacobian Matrix\nThe Jacobian matrix $J$ of the residual vector $\\mathbf{r} = [r_u, r_p]^T$ with respect to the unknowns $\\mathbf{x} = [u, p]^T$ is composed of the following blocks:\n- $K_{uu} = \\frac{\\partial r_u}{\\partial u} = \\frac{EA}{L}$\n- $K_{up} = \\frac{\\partial r_u}{\\partial p} = -\\alpha A$\n- $K_{pu} = \\frac{\\partial r_p}{\\partial u} = \\frac{\\alpha A}{\\Delta t}$\n- $K_{pp} = \\frac{\\partial r_p}{\\partial p} = \\frac{sAL}{\\Delta t} + \\frac{kA}{\\mu l_b}$\n\n### 4. Staggered Iteration and Spectral Radius\nFor a Gauss-Seidel staggered scheme, the pressure update from iteration $k$ to $k+1$ follows the fixed-point mapping $p^{k+1} = \\mathcal{A} + T p^k$. The iteration matrix $T$ is derived by substituting the mechanics update into the flow update:\n1. Mechanics: $u^{k+1} = K_{uu}^{-1}(f_u - K_{up}p^k)$\n2. Flow: $p^{k+1} = K_{pp}^{-1}(f_p - K_{pu}u^{k+1})$\nSubstitution yields the iteration matrix:\n$$ T = K_{pp}^{-1} K_{pu} K_{uu}^{-1} K_{up} = \\frac{K_{pu} K_{up}}{K_{uu} K_{pp}} $$\nThe spectral radius $\\rho(T)$ for this scalar case is $|T|$:\n$$ \\rho(T) = \\left| \\frac{(\\frac{\\alpha A}{\\Delta t})(-\\alpha A)}{(\\frac{EA}{L})(\\frac{sAL}{\\Delta t} + \\frac{kA}{\\mu l_b})} \\right| = \\frac{\\alpha^2 L}{E\\Delta t \\left(\\frac{sL}{\\Delta t} + \\frac{k}{\\mu l_b}\\right)} $$\n\n### 5. Numerical Calculation\nSubstituting the given parameters into the expression for $\\rho(T)$:\n- Denominator term 1: $\\frac{sL}{\\Delta t} = \\frac{(5.0 \\times 10^{-10})(2.0)}{1.0 \\times 10^{3}} = 1.0 \\times 10^{-12}\\ \\mathrm{m \\cdot Pa^{-1} \\cdot s^{-1}}$\n- Denominator term 2: $\\frac{k}{\\mu l_b} = \\frac{1.0 \\times 10^{-12}}{(1.0 \\times 10^{-3})(1.0 \\times 10^{-1})} = 1.0 \\times 10^{-8}\\ \\mathrm{m \\cdot Pa^{-1} \\cdot s^{-1}}$\n- Numerator: $\\alpha^2 L = (0.6)^2 (2.0) = 0.72\\ \\mathrm{m}$\n- Full Denominator: $E\\Delta t \\left(\\frac{sL}{\\Delta t} + \\frac{k}{\\mu l_b}\\right) = (8.0 \\times 10^{9})(1.0 \\times 10^{3})(1.0 \\times 10^{-12} + 1.0 \\times 10^{-8}) = 8.0008 \\times 10^4\\ \\mathrm{m}$\nThe spectral radius is:\n$$ \\rho(T) = \\frac{0.72}{8.0008 \\times 10^4} \\approx 8.9991 \\times 10^{-6} $$\nRounded to four significant figures, the result is $8.999 \\times 10^{-6}$.", "answer": "$$\\boxed{8.999 \\times 10^{-6}}$$", "id": "3548409"}, {"introduction": "While partitioned schemes are often simpler to implement than monolithic ones, their convergence is not guaranteed. This practice isolates the core algebraic structure of a coupled system to reveal the mathematical origin of potential instabilities in staggered solution schemes [@problem_id:3548366]. Through a rigorous error-propagation analysis, you will derive the precise condition under which a block Gauss-Seidel iteration diverges, providing a crucial theoretical insight that you will then verify with a short numerical program.", "problem": "Consider the one-dimensional, small-strain, linear poromechanics of a saturated column, discretized to a single dominant mode under uniform loading and kinematics. After consistent nondimensionalization over a reference height and area, the semi-discrete algebraic equilibrium of the coupled mechanics and fluid subsystem can be represented by the $2 \\times 2$ linear system\n$$\n\\begin{bmatrix}\nK_{uu}  \\alpha \\\\\n\\alpha  M\n\\end{bmatrix}\n\\begin{bmatrix}\nu \\\\\np\n\\end{bmatrix}\n=\n\\begin{bmatrix}\nf_u \\\\\nf_p\n\\end{bmatrix},\n$$\nwhere $u$ is the scalar displacement amplitude, $p$ is the scalar pore pressure amplitude, $K_{uu} \\gt 0$ is the effective (dimensionless) stiffness associated with the drained solid response, $\\alpha \\in (0,1]$ is the Biot coefficient (dimensionless), and $M \\gt 0$ is the effective (dimensionless) pressure-block stiffness dominated by storage effects. The nondimensionalization ensures that all quantities are dimensionless, so no units are required for any quantity in this problem.\n\nA partitioned staggered (block Gauss–Seidel) scheme proceeds by alternately solving the mechanics subproblem with the current pressure held fixed, followed by solving the fluid subproblem with the updated displacement held fixed. Let the iteration index be $k$. The staggered updates at iteration $k+1$ are defined as\n$$\nK_{uu}\\,u^{(k+1)} + \\alpha\\,p^{(k)} = f_u,\n\\quad\n\\alpha\\,u^{(k+1)} + M\\,p^{(k+1)} = f_p.\n$$\nIn contrast, a monolithic scheme directly solves the full $2 \\times 2$ system in a single step.\n\nTask 1 (Derivation): Starting from the staggered updates and using only the fundamental properties of linear algebra and fixed-point iteration, derive the error-propagation relation for the staggered scheme. Show that the error amplification from one staggered iteration to the next is governed by a scalar eigenvalue (spectral radius) that depends only on $K_{uu}$, $M$, and $\\alpha$. Conclude rigorously under what condition the staggered scheme diverges. Express all intermediate symbols in LaTeX, and do not use any shortcut formula not obtained by first principles.\n\nTask 2 (Numerical validation on a saturated column analogue): Implement a program that verifies the analytical result numerically for a saturated column reduced to this single-mode model. To this end:\n\n- Initialize with $u^{(0)} = 0$ and $p^{(0)} = 0$.\n- Use a fixed right-hand side $f_u = 1$ and $f_p = 0$ for all tests.\n- Perform exactly two staggered iterations to obtain $p^{(1)}$ and $p^{(2)}$.\n- Compute the measured error-amplification ratio\n$$\nr_{\\mathrm{meas}} = \\frac{\\left|p^{(2)} - p^{(1)}\\right|}{\\left|p^{(1)} - p^{(0)}\\right|}.\n$$\n- Classify a test as “convergent” if $r_{\\mathrm{meas}} \\lt 1$, and “divergent” otherwise.\n\nTest Suite: Evaluate your program on the following four parameter sets, chosen to exercise the stable “happy path”, a near-boundary slow case, the boundary case, and a strongly unstable case. All parameters are dimensionless.\n\n1. Case A: $\\alpha = 1$, $M = 1$, $K_{uu} = 4$.\n2. Case B: $\\alpha = 1$, $M = 1$, $K_{uu} = \\dfrac{1}{0.99}$.\n3. Case C: $\\alpha = 1$, $M = 1$, $K_{uu} = 1$.\n4. Case D: $\\alpha = 1$, $M = 1$, $K_{uu} = \\dfrac{1}{1.44}$.\n\nAnswer Specification and Final Output Format: Your program must produce a single line of output containing the convergence outcomes of the staggered scheme for the four test cases, in order A, B, C, D, as a comma-separated list enclosed in square brackets (e.g., $[x_A,x_B,x_C,x_D]$). Each $x_i$ must be a boolean ($\\mathrm{True}$ or $\\mathrm{False}$), where $\\mathrm{True}$ indicates convergence and $\\mathrm{False}$ indicates divergence. Because the problem is fully nondimensionalized, no physical units are involved anywhere in the program or its outputs.", "solution": "The task is divided into two parts: a theoretical derivation of the convergence properties of the staggered scheme, and a numerical validation of the derived theory.\n\n### Task 1: Derivation of the Error-Propagation Relation\n\nThe objective is to analyze the convergence of the partitioned staggered scheme by deriving its error-propagation relation. Let $(u, p)$ represent the exact solution to the monolithic system, which satisfies:\n$$K_{uu} u + \\alpha p = f_u$$\n$$\\alpha u + M p = f_p$$\nThe staggered scheme is an iterative process defined by the updates at iteration $k+1$:\n$$K_{uu}\\,u^{(k+1)} + \\alpha\\,p^{(k)} = f_u \\quad (1)$$\n$$\\alpha\\,u^{(k+1)} + M\\,p^{(k+1)} = f_p \\quad (2)$$\nLet the errors in displacement and pressure at iteration $k$ be defined as $e_u^{(k)} = u^{(k)} - u$ and $e_p^{(k)} = p^{(k)} - p$. The iterates can be expressed in terms of the exact solution and the error: $u^{(k)} = u + e_u^{(k)}$ and $p^{(k)} = p + e_p^{(k)}$.\n\nWe substitute these error definitions into the staggered update equations. Starting with equation $(1)$:\n$$K_{uu}(u + e_u^{(k+1)}) + \\alpha(p + e_p^{(k)}) = f_u$$\nExpanding the terms gives:\n$$K_{uu}u + K_{uu}e_u^{(k+1)} + \\alpha p + \\alpha e_p^{(k)} = f_u$$\nWe can group the terms corresponding to the exact solution:\n$$(K_{uu}u + \\alpha p) + K_{uu}e_u^{(k+1)} + \\alpha e_p^{(k)} = f_u$$\nSince $K_{uu}u + \\alpha p = f_u$, this simplifies to the error relation for the first subproblem:\n$$K_{uu}e_u^{(k+1)} + \\alpha e_p^{(k)} = 0$$\nSolving for the displacement error at iteration $k+1$, we get:\n$$e_u^{(k+1)} = -\\frac{\\alpha}{K_{uu}} e_p^{(k)} \\quad (3)$$\nThis equation shows how the pressure error from the previous iteration, $e_p^{(k)}$, propagates into the displacement error of the current iteration, $e_u^{(k+1)}$.\n\nNext, we substitute the error definitions into the second staggered update equation, equation $(2)$:\n$$\\alpha(u + e_u^{(k+1)}) + M(p + e_p^{(k+1)}) = f_p$$\nExpanding the terms gives:\n$$\\alpha u + \\alpha e_u^{(k+1)} + M p + M e_p^{(k+1)} = f_p$$\nGrouping the terms for the exact solution:\n$$(\\alpha u + M p) + \\alpha e_u^{(k+1)} + M e_p^{(k+1)} = f_p$$\nSince $\\alpha u + M p = f_p$, this simplifies to the error relation for the second subproblem:\n$$\\alpha e_u^{(k+1)} + M e_p^{(k+1)} = 0$$\nSolving for the pressure error at iteration $k+1$:\n$$e_p^{(k+1)} = -\\frac{\\alpha}{M} e_u^{(k+1)} \\quad (4)$$\n\nWe now have a system of two equations, $(3)$ and $(4)$, relating the errors. To find the overall error propagation from one iteration to the next, we substitute the expression for $e_u^{(k+1)}$ from $(3)$ into $(4)$:\n$$e_p^{(k+1)} = -\\frac{\\alpha}{M} \\left( -\\frac{\\alpha}{K_{uu}} e_p^{(k)} \\right)$$\nThis simplifies to the final error-propagation relation for the pressure error:\n$$e_p^{(k+1)} = \\left( \\frac{\\alpha^2}{M K_{uu}} \\right) e_p^{(k)}$$\nThis is a fixed-point iteration for the error $e_p$. The error at each step is amplified by a scalar factor, which is the spectral radius (eigenvalue) $\\lambda$ of the iteration matrix for this $2 \\times 2$ system:\n$$\\lambda = \\frac{\\alpha^2}{M K_{uu}}$$\nFor a fixed-point iteration to converge, the magnitude of the spectral radius must be strictly less than $1$. The scheme diverges if the magnitude of the spectral radius is greater than or equal to $1$. Given that all parameters $K_{uu}$, $M$, and $\\alpha$ are positive, the spectral radius $\\lambda$ is also positive. Therefore, the condition is on the value of $\\lambda$ itself.\n\nThe staggered scheme converges if $\\lambda  1$:\n$$\\frac{\\alpha^2}{M K_{uu}}  1 \\implies \\alpha^2  M K_{uu}$$\nConversely, the staggered scheme diverges if $\\lambda \\ge 1$. The rigorous condition for divergence is therefore:\n$$\\frac{\\alpha^2}{M K_{uu}} \\ge 1 \\implies \\alpha^2 \\ge M K_{uu}$$\n\n### Task 2: Numerical Validation\n\nThe analytical result is validated numerically by implementing the staggered scheme for the given test cases. The logic involves performing two iterations and computing the measured error amplification ratio, $r_{\\mathrm{meas}}$, which serves as a numerical estimate of the spectral radius $\\lambda$.\n\nThe required steps are:\n1. Initialize $u^{(0)}=0$, $p^{(0)}=0$, $f_u=1$, $f_p=0$.\n2. Compute $(u^{(1)}, p^{(1)})$ using $(u^{(0)}, p^{(0)})$.\n   From equation $(1)$: $K_{uu}u^{(1)} + \\alpha p^{(0)} = f_u \\implies K_{uu}u^{(1)} + 0 = 1 \\implies u^{(1)} = \\frac{1}{K_{uu}}$.\n   From equation $(2)$: $\\alpha u^{(1)} + M p^{(1)} = f_p \\implies \\alpha(\\frac{1}{K_{uu}}) + M p^{(1)} = 0 \\implies p^{(1)} = -\\frac{\\alpha}{M K_{uu}}$.\n3. Compute $(u^{(2)}, p^{(2)})$ using $(u^{(1)}, p^{(1)})$.\n   From equation $(1)$: $K_{uu}u^{(2)} + \\alpha p^{(1)} = f_u \\implies u^{(2)} = \\frac{f_u - \\alpha p^{(1)}}{K_{uu}} = \\frac{1 - \\alpha(-\\frac{\\alpha}{M K_{uu}})}{K_{uu}} = \\frac{1}{K_{uu}}(1 + \\frac{\\alpha^2}{M K_{uu}})$.\n   From equation $(2)$: $\\alpha u^{(2)} + M p^{(2)} = f_p \\implies p^{(2)} = \\frac{-\\alpha u^{(2)}}{M} = -\\frac{\\alpha}{M K_{uu}}(1 + \\frac{\\alpha^2}{M K_{uu}})$.\n4. Compute the ratio $r_{\\mathrm{meas}} = \\frac{|p^{(2)} - p^{(1)}|}{|p^{(1)} - p^{(0)}|}$.\n   The denominator is $|p^{(1)} - p^{(0)}| = |-\\frac{\\alpha}{M K_{uu}} - 0| = \\frac{\\alpha}{M K_{uu}}$.\n   The numerator is $|p^{(2)} - p^{(1)}| = |-\\frac{\\alpha}{M K_{uu}}(1 + \\frac{\\alpha^2}{M K_{uu}}) - (-\\frac{\\alpha}{M K_{uu}})| = |-\\frac{\\alpha}{M K_{uu}} - \\frac{\\alpha^3}{(M K_{uu})^2} + \\frac{\\alpha}{M K_{uu}}| = \\frac{\\alpha^3}{(M K_{uu})^2}$.\n   Thus, $r_{\\mathrm{meas}} = \\frac{\\alpha^3 / (M K_{uu})^2}{\\alpha / (M K_{uu})} = \\frac{\\alpha^2}{M K_{uu}}$.\n   This confirms that the numerical measurement of the amplification ratio is identical to the theoretically derived spectral radius $\\lambda$.\n5. Classify the scheme as \"convergent\" if $r_{\\mathrm{meas}}  1$ and \"divergent\" otherwise. This corresponds to checking if $\\frac{\\alpha^2}{M K_{uu}}  1$.\n\nThe provided Python code implements this logic for the specified test suite.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the numerical validation for the given test cases.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Each case is a tuple (alpha, M, K_uu).\n    test_cases = [\n        (1.0, 1.0, 4.0),                      # Case A\n        (1.0, 1.0, 1.0 / 0.99),             # Case B\n        (1.0, 1.0, 1.0),                      # Case C\n        (1.0, 1.0, 1.0 / 1.44)              # Case D\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        alpha, M, K_uu = case\n        \n        # Initialize parameters and variables for the simulation.\n        f_u = 1.0\n        f_p = 0.0\n        \n        # Initial conditions for iteration k=0\n        p_0 = 0.0\n        \n        # --- Perform Staggered Iteration 1 (to get p_1) ---\n        # Solve for displacement u_1 using p_0.\n        # K_uu * u_1 + alpha * p_0 = f_u\n        u_1 = (f_u - alpha * p_0) / K_uu\n        \n        # Solve for pressure p_1 using u_1.\n        # alpha * u_1 + M * p_1 = f_p\n        p_1 = (f_p - alpha * u_1) / M\n        \n        # --- Perform Staggered Iteration 2 (to get p_2) ---\n        # Solve for displacement u_2 using p_1.\n        # K_uu * u_2 + alpha * p_1 = f_u\n        u_2 = (f_u - alpha * p_1) / K_uu\n        \n        # Solve for pressure p_2 using u_2.\n        # alpha * u_2 + M * p_2 = f_p\n        p_2 = (f_p - alpha * u_2) / M\n        \n        # --- Compute the measured error-amplification ratio ---\n        # r_meas = |p^(2) - p^(1)| / |p^(1) - p^(0)|\n        numerator = abs(p_2 - p_1)\n        denominator = abs(p_1 - p_0)\n\n        # The denominator is |p_1 - p_0| = |-alpha/(M*K_uu)|.\n        # Since alpha, M, K_uu  0, the denominator is non-zero.\n        # A check for denominator == 0 is good practice but not strictly required here.\n        if denominator == 0:\n            # This case corresponds to immediate convergence (starting at the fixed point).\n            # The error amplification is zero.\n            r_meas = 0.0\n        else:\n            r_meas = numerator / denominator\n\n        # --- Classify the result ---\n        # Convergent if r_meas  1, divergent otherwise.\n        is_convergent = r_meas  1.0\n        results.append(is_convergent)\n\n    # Final print statement in the exact required format.\n    # The str() of a boolean is 'True' or 'False' with a capital letter.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3548366"}, {"introduction": "The stability of a partitioned solution is not only dependent on the strength of the physical coupling but also on the properties of the chosen numerical integrators. This final exercise explores the critical role that time discretization plays in the stability of a staggered scheme for dynamic poroelasticity [@problem_id:3548431]. By analyzing the amplification factors of different schemes, you will learn how the choice of methods like Newmark, backward Euler, or BDF2 can fundamentally alter the convergence and accuracy of a simulation, a key consideration for designing robust computational tools.", "problem": "A one-dimensional, small-strain, linearized Biot poroelastic continuum is governed, in terms of the displacement field $u(x,t)$ and the pore pressure field $p(x,t)$, by the momentum balance and mass conservation\n$$\\rho\\,\\ddot{u} = \\frac{\\partial}{\\partial x}\\big(E\\,\\frac{\\partial u}{\\partial x} - \\alpha\\,p\\big), \\qquad S\\,\\dot{p} + \\alpha\\,\\frac{\\partial \\dot{u}}{\\partial x} - D\\,\\frac{\\partial^{2} p}{\\partial x^{2}} = 0,$$\nwhere $\\rho$ is the mass density, $E$ is the Young’s modulus, $\\alpha$ is the Biot coefficient, $S$ is the storativity, and $D = \\kappa/\\mu$ is the hydraulic diffusivity with $\\kappa$ the permeability and $\\mu$ the dynamic viscosity. Consider spatial Fourier modes $u(x,t) = U(t)\\,\\exp(i k x)$ and $p(x,t) = P(t)\\,\\exp(i k x)$ with real wavenumber $k0$, which reduce the field equations to the modal system\n$$\\rho\\,\\ddot{U} + E\\,k^{2} U + i\\,\\alpha\\,k\\,P = 0, \\qquad S\\,\\dot{P} + i\\,\\alpha\\,k\\,\\dot{U} + D\\,k^{2} P = 0.$$\nWe study a staggered (Gauss–Seidel) partitioned time-integration in which the mechanical subproblem is advanced first using the Newmark–beta method (Newmark average acceleration with parameters $\\beta = \\tfrac{1}{4}$, $\\gamma = \\tfrac{1}{2}$) and the pressure subproblem is advanced second using either backward Euler or the second-order Backward Differentiation Formula (BDF2). In the mechanical step, the coupling term $i\\,\\alpha\\,k\\,P$ is treated explicitly at the previous pressure time level, and in the flow step, the coupling term $i\\,\\alpha\\,k\\,\\dot{U}$ is treated using the updated mechanical velocity. Derive the one-step amplification relations for the modal amplitudes by eliminating the acceleration variable and expressing $U^{n+1}$, $\\dot{U}^{n+1}$, and $P^{n+1}$ in terms of $U^{n}$, $\\dot{U}^{n}$, $P^{n}$ (and $P^{n-1}$ in the BDF2 case).\n\nThen, to isolate the role of the time integrator on the pressure mode, specialize to the drained limit $\\alpha=0$ and to nondimensional parameters $E k^{2} = 1$, $\\rho = 1$, $S = 1$, $D k^{2} = 1$, and a nondimensional time step $\\Delta t = 0.1$. In this limit, the pressure subproblem reduces to a linear scalar test equation, for which the amplification factor of backward Euler is a single root and that of BDF2 is determined by a quadratic characteristic equation. Compute the ratio of the magnitudes of the pressure-mode amplification factors for backward Euler and BDF2 at these parameters. Round your answer to four significant figures. No units are required.", "solution": "The problem is addressed in two parts. First, we derive the general amplification relations for the coupled system. Second, we specialize to the uncoupled drained limit and compute the required ratio of amplification factors.\n\n### Part 1: Derivation of the Amplification Relations\n\nThe staggered time-stepping scheme advances the mechanical and fluid subproblems sequentially.\n\n**Mechanical Subproblem:**\nThe mechanical ODE is $\\rho\\,\\ddot{U} + E\\,k^{2} U = -i\\,\\alpha\\,k\\,P$. We convert this to a first-order system by defining the state vector $\\mathbf{y}_M = \\begin{pmatrix} U  \\dot{U} \\end{pmatrix}^T$. Let $V = \\dot{U}$, then $\\dot{V} = \\ddot{U}$.\nThe system is:\n$$ \\frac{d}{dt}\\begin{pmatrix} U \\\\ V \\end{pmatrix} = \\begin{pmatrix} 0  1 \\\\ -E k^2/\\rho  0 \\end{pmatrix} \\begin{pmatrix} U \\\\ V \\end{pmatrix} + \\begin{pmatrix} 0 \\\\ -i\\alpha k/\\rho \\end{pmatrix} P $$\nThis has the form $\\dot{\\mathbf{y}}_M = \\mathbf{A}_M \\mathbf{y}_M + \\mathbf{f}_P(P)$. The Newmark average acceleration scheme ($\\beta=\\frac{1}{4}, \\gamma=\\frac{1}{2}$) is equivalent to the trapezoidal rule for this first-order system. The coupling term is treated explicitly at time level $n$. The discretized equation is:\n$$ \\mathbf{y}_M^{n+1} = \\mathbf{y}_M^n + \\frac{\\Delta t}{2} \\left( (\\mathbf{A}_M \\mathbf{y}_M^n + \\mathbf{f}_P(P^n)) + (\\mathbf{A}_M \\mathbf{y}_M^{n+1} + \\mathbf{f}_P(P^n)) \\right) $$\nRearranging to solve for $\\mathbf{y}_M^{n+1}$:\n$$ \\left(\\mathbf{I} - \\frac{\\Delta t}{2}\\mathbf{A}_M\\right) \\mathbf{y}_M^{n+1} = \\left(\\mathbf{I} + \\frac{\\Delta t}{2}\\mathbf{A}_M\\right) \\mathbf{y}_M^n + \\Delta t \\mathbf{f}_P(P^n) $$\nLet $\\omega_0^2 = E k^2 / \\rho$. The matrix $\\mathbf{A}_M$ is $\\begin{pmatrix} 0  1 \\\\ -\\omega_0^2  0 \\end{pmatrix}$.\n$$ \\mathbf{I} - \\frac{\\Delta t}{2}\\mathbf{A}_M = \\begin{pmatrix} 1  -\\frac{\\Delta t}{2} \\\\ \\frac{\\omega_0^2 \\Delta t}{2}  1 \\end{pmatrix} $$\nThe determinant is $1 + \\frac{\\omega_0^2 \\Delta t^2}{4}$. The inverse is:\n$$ \\left(\\mathbf{I} - \\frac{\\Delta t}{2}\\mathbf{A}_M\\right)^{-1} = \\frac{1}{1 + \\frac{\\omega_0^2 \\Delta t^2}{4}} \\begin{pmatrix} 1  \\frac{\\Delta t}{2} \\\\ -\\frac{\\omega_0^2 \\Delta t}{2}  1 \\end{pmatrix} $$\nThe update for the mechanical variables is $\\mathbf{y}_M^{n+1} = \\left(\\mathbf{I} - \\frac{\\Delta t}{2}\\mathbf{A}_M\\right)^{-1} \\left[ \\left(\\mathbf{I} + \\frac{\\Delta t}{2}\\mathbf{A}_M\\right) \\mathbf{y}_M^n + \\Delta t \\begin{pmatrix} 0 \\\\ -i\\alpha k/\\rho \\end{pmatrix} P^n \\right]$.\nLet's write out the expressions for $U^{n+1}$ and $\\dot{U}^{n+1} (=V^{n+1})$:\n$$ \\begin{pmatrix} U^{n+1} \\\\ \\dot{U}^{n+1} \\end{pmatrix} = \\frac{1}{1 + \\frac{\\omega_0^2 \\Delta t^2}{4}} \\begin{pmatrix} 1  \\frac{\\Delta t}{2} \\\\ -\\frac{\\omega_0^2 \\Delta t}{2}  1 \\end{pmatrix} \\left[ \\begin{pmatrix} 1  \\frac{\\Delta t}{2} \\\\ -\\frac{\\omega_0^2 \\Delta t}{2}  1 \\end{pmatrix} \\begin{pmatrix} U^n \\\\ \\dot{U}^n \\end{pmatrix} + \\Delta t \\begin{pmatrix} 0 \\\\ -\\frac{i\\alpha k}{\\rho} \\end{pmatrix} P^n \\right] $$\n$$ \\begin{pmatrix} U^{n+1} \\\\ \\dot{U}^{n+1} \\end{pmatrix} = \\frac{1}{1 + \\frac{\\omega_0^2 \\Delta t^2}{4}} \\left[ \\begin{pmatrix} 1 - \\frac{\\omega_0^2 \\Delta t^2}{4}  \\Delta t \\\\ -\\omega_0^2 \\Delta t  1 - \\frac{\\omega_0^2 \\Delta t^2}{4} \\end{pmatrix} \\begin{pmatrix} U^n \\\\ \\dot{U}^n \\end{pmatrix} - \\frac{i\\alpha k \\Delta t}{\\rho} \\begin{pmatrix} \\frac{\\Delta t}{2} \\\\ 1 \\end{pmatrix} P^n \\right] $$\nThis provides the amplification relations for $U^{n+1}$ and $\\dot{U}^{n+1}$.\n\n**Pressure Subproblem:**\nThe pressure ODE is $S\\,\\dot{P} + D\\,k^{2} P = -i\\,\\alpha\\,k\\,\\dot{U}$. This is advanced using the newly computed velocity $\\dot{U}^{n+1}$.\n\nCase 1: Backward Euler (BE)\nThe BE discretization is $\\frac{P^{n+1} - P^n}{\\Delta t} = f(t^{n+1}, P^{n+1})$. Here, $f(t, P) = \\frac{1}{S}(-D k^2 P - i \\alpha k \\dot{U})$.\n$$ S \\frac{P^{n+1} - P^n}{\\Delta t} + D k^2 P^{n+1} = -i \\alpha k \\dot{U}^{n+1} $$\nSolving for $P^{n+1}$:\n$$ (S + \\Delta t D k^2) P^{n+1} = S P^n - i \\alpha k \\Delta t \\dot{U}^{n+1} $$\n$$ P^{n+1} = \\frac{S}{S + \\Delta t D k^2} P^n - \\frac{i \\alpha k \\Delta t}{S + \\Delta t D k^2} \\dot{U}^{n+1} $$\n\nCase 2: BDF2\nThe BDF2 discretization is $\\frac{3P^{n+1} - 4P^n + P^{n-1}}{2\\Delta t} = f(t^{n+1}, P^{n+1})$.\n$$ S \\frac{3P^{n+1} - 4P^n + P^{n-1}}{2\\Delta t} + D k^2 P^{n+1} = -i \\alpha k \\dot{U}^{n+1} $$\nSolving for $P^{n+1}$:\n$$ \\left(\\frac{3S}{2\\Delta t} + D k^2\\right) P^{n+1} = \\frac{S(4P^n - P^{n-1})}{2\\Delta t} - i \\alpha k \\dot{U}^{n+1} $$\n$$ \\left(\\frac{3S}{2} + \\Delta t D k^2\\right) P^{n+1} = 2S P^n - \\frac{S}{2} P^{n-1} - i \\alpha k \\Delta t \\dot{U}^{n+1} $$\n$$ P^{n+1} = \\frac{2S P^n - \\frac{S}{2} P^{n-1} - i \\alpha k \\Delta t \\dot{U}^{n+1}}{\\frac{3S}{2} + \\Delta t D k^2} $$\nThese equations constitute the full set of one-step amplification relations as requested.\n\n### Part 2: Calculation of the Ratio of Amplification Factors\n\nWe now specialize to the drained limit, $\\alpha=0$, where the equations uncouple. The pressure subproblem becomes autonomous:\n$$ S\\,\\dot{P} + D\\,k^{2} P = 0 \\quad \\implies \\quad \\dot{P} = -\\frac{D k^2}{S} P $$\nThis is the standard linear scalar test equation $\\dot{y} = \\lambda y$ with $\\lambda = -\\frac{D k^2}{S}$.\nWe are given the nondimensional parameters $S=1$, $D k^2=1$, and $\\Delta t = 0.1$.\nThus, the equation is $\\dot{P} = -P$, so $\\lambda = -1$.\n\n**Backward Euler Amplification Factor:**\nThe BE discretization of $\\dot{P} = -P$ is:\n$$ \\frac{P^{n+1} - P^n}{\\Delta t} = -P^{n+1} $$\n$$ P^{n+1}(1 + \\Delta t) = P^n $$\nThe amplification factor, $g_{BE} = P^{n+1}/P^n$, is:\n$$ g_{BE} = \\frac{1}{1 + \\Delta t} $$\nFor $\\Delta t = 0.1$, the magnitude is:\n$$ |g_{BE}| = \\frac{1}{1 + 0.1} = \\frac{1}{1.1} $$\n\n**BDF2 Amplification Factor:**\nThe BDF2 discretization of $\\dot{P} = -P$ is:\n$$ \\frac{3P^{n+1} - 4P^n + P^{n-1}}{2\\Delta t} = -P^{n+1} $$\n$$ (3 + 2\\Delta t) P^{n+1} - 4P^n + P^{n-1} = 0 $$\nTo find the amplification factors, we assume a solution of the form $P^n = g^n$. Substituting this into the difference equation yields the characteristic equation for $g$:\n$$ (3 + 2\\Delta t) g^2 - 4g + 1 = 0 $$\nSubstituting $\\Delta t = 0.1$:\n$$ (3 + 2(0.1)) g^2 - 4g + 1 = 0 $$\n$$ 3.2 g^2 - 4g + 1 = 0 $$\nWe solve this quadratic equation for the roots $g_{1,2}$:\n$$ g = \\frac{-(-4) \\pm \\sqrt{(-4)^2 - 4(3.2)(1)}}{2(3.2)} = \\frac{4 \\pm \\sqrt{16 - 12.8}}{6.4} = \\frac{4 \\pm \\sqrt{3.2}}{6.4} $$\nThe two roots are:\n$$ g_1 = \\frac{4 + \\sqrt{3.2}}{6.4} \\approx 0.9045085 $$\n$$ g_2 = \\frac{4 - \\sqrt{3.2}}{6.4} \\approx 0.3454915 $$\nFor a multi-step method, the amplification factor that governs the long-term behavior is the root with the largest magnitude (the principal root). In this case, both roots are real and positive, so the amplification factor is $g_{BDF2} = g_1$.\n$$ |g_{BDF2}| = \\frac{4 + \\sqrt{3.2}}{6.4} $$\n\n**Ratio Calculation:**\nThe problem asks for the ratio of the magnitudes of the amplification factors for backward Euler and BDF2. We calculate $\\frac{|g_{BE}|}{|g_{BDF2}|}$:\n$$ \\text{Ratio} = \\frac{\\frac{1}{1.1}}{\\frac{4 + \\sqrt{3.2}}{6.4}} = \\frac{6.4}{1.1(4 + \\sqrt{3.2})} $$\nNumerically:\n$$ \\sqrt{3.2} \\approx 1.78885438 $$\n$$ \\text{Ratio} = \\frac{6.4}{1.1(4 + 1.78885438)} = \\frac{6.4}{1.1(5.78885438)} = \\frac{6.4}{6.36773982} \\approx 1.0050668 $$\nRounding the result to four significant figures, we get $1.005$.", "answer": "$$\\boxed{1.005}$$", "id": "3548431"}]}