{"hands_on_practices": [{"introduction": "The power of the finite element method rests on its systematic procedure for translating discrete nodal displacements into continuous strain and stress fields. This foundational exercise guides you through this essential pipeline for the quadratic serendipity ($S_2$) element. By deriving shape function gradients and constructing the strain-displacement matrix $B$, you will gain a first-principles understanding of how element-level kinematics are formulated, providing the bedrock for all subsequent analysis. [@problem_id:3558296]", "problem": "Consider the quadratic serendipity family $S_2$ on the reference square element $\\hat{\\Omega} = \\{(\\xi,\\eta)\\,|\\, -1 \\le \\xi \\le 1,\\,-1 \\le \\eta \\le 1\\}$. The $S_2$ element has $8$ nodes: $4$ corners and $4$ mid-side nodes. Let the node numbering and reference coordinates be\n$1:(-1,-1)$, $2:(1,-1)$, $3:(1,1)$, $4:(-1,1)$, $5:(0,-1)$, $6:(1,0)$, $7:(0,1)$, $8:(-1,0)$.\nIn the Finite Element Method (FEM), the shape functions $N_i(\\xi,\\eta)$ of the $S_2$ element are quadratic polynomials that satisfy the Kronecker-delta property at these nodes and the partition of unity. \n\nTask:\n- Starting from the core definitions of isoparametric interpolation and the reference shape function properties, derive explicit formulas for the gradients $\\nabla_{\\hat{\\Omega}} N_i(\\xi,\\eta) = \\left[\\frac{\\partial N_i}{\\partial \\xi}(\\xi,\\eta),\\,\\frac{\\partial N_i}{\\partial \\eta}(\\xi,\\eta)\\right]$ for all $i \\in \\{1,\\dots,8\\}$ on the reference element.\n- Using the isoparametric concept, show how to compute the strain–displacement matrix $B$ for two-dimensional small-strain kinematics (plane strain) under the mapping $\\boldsymbol{x}(\\xi,\\eta) = \\sum_{i=1}^{8} N_i(\\xi,\\eta)\\,\\boldsymbol{x}_i$, where $\\boldsymbol{x}_i = (x_i,y_i)$ are the physical coordinates of the element nodes. Base your derivation on the chain rule and the Jacobian matrix $\\boldsymbol{J} = \\frac{\\partial(x,y)}{\\partial(\\xi,\\eta)}$.\n- Then, consider the isoparametric mapping to the physical quadrilateral with nodes placed at the following coordinates (in meters): \n$1:(-2,-1)$, $2:(2,-1)$, $3:(2,1)$, $4:(-2,1)$, $5:(0,-1)$, $6:(2,0)$, $7:(0,1)$, $8:(-2,0)$. Show the evaluation of $\\boldsymbol{J}$ and $\\boldsymbol{J}^{-1}$ at the element center $(\\xi,\\eta)=(0,0)$.\n- For a geomechanical analysis in plane strain, the strain–displacement matrix $B(\\xi,\\eta)$ is defined so that the engineering strains $\\boldsymbol{\\varepsilon} = [\\varepsilon_{x},\\,\\varepsilon_{y},\\,\\gamma_{xy}]^{\\mathsf{T}}$ satisfy $\\boldsymbol{\\varepsilon} = B\\,\\boldsymbol{u}$, where $\\boldsymbol{u}$ stacks the nodal displacement components $u_{i,x}$ and $u_{i,y}$ for $i=1,\\dots,8$. Using your $B$ at $(\\xi,\\eta)=(0,0)$, evaluate the shear strain $\\gamma_{xy}$ at the element center for the nodal displacement field (in meters)\n$u_{1,x}=0$, $u_{1,y}=0$, $u_{2,x}=0$, $u_{2,y}=0$, $u_{3,x}=0$, $u_{3,y}=0$, $u_{4,x}=0$, $u_{4,y}=0$, $u_{5,x}=1\\times 10^{-3}$, $u_{5,y}=0$, $u_{6,x}=0$, $u_{6,y}=3\\times 10^{-3}$, $u_{7,x}=2\\times 10^{-3}$, $u_{7,y}=0$, $u_{8,x}=0$, $u_{8,y}=-1\\times 10^{-3}$. \n\nRound your final numeric answer for $\\gamma_{xy}$ to $4$ significant figures. Strain is dimensionless; express the answer as a pure number (no units).", "solution": "The problem asks for a multi-step analysis involving an $8$-node quadratic serendipity element ($S_2$) in the context of the Finite Element Method (FEM) for a two-dimensional plane strain geomechanical problem. The tasks are to: $1$) derive the gradients of the shape functions on the reference element, $2$) establish the formulation for the strain-displacement matrix $B$, $3$) compute the Jacobian matrix $\\boldsymbol{J}$ for a specific physical element, and $4$) calculate the shear strain $\\gamma_{xy}$ at the element center for a given displacement field.\n\n**Part 1: Gradients of the $S_2$ Shape Functions**\n\nThe $S_2$ element has $8$ nodes on the reference square $\\hat{\\Omega} = [-1, 1] \\times [-1, 1]$. There are $4$ corner nodes and $4$ midside nodes. The shape functions $N_i(\\xi, \\eta)$ are defined such that $N_i$ is $1$ at node $i$ and $0$ at all other nodes.\n\nThe corner nodes are $i \\in \\{1, 2, 3, 4\\}$. Their shape functions are given by the general formula:\n$$N_i(\\xi, \\eta) = \\frac{1}{4}(1+\\xi_i\\xi)(1+\\eta_i\\eta)(\\xi_i\\xi + \\eta_i\\eta - 1)$$\nwhere $(\\xi_i, \\eta_i)$ are the coordinates of corner node $i$. The partial derivatives with respect to $\\xi$ and $\\eta$ are:\n$$\\frac{\\partial N_i}{\\partial \\xi} = \\frac{1}{4}\\xi_i(1+\\eta_i\\eta)(2\\xi_i\\xi+\\eta_i\\eta) = \\frac{1}{4}(1+\\eta_i\\eta)(2\\xi+\\xi_i\\eta_i\\eta)$$\n$$\\frac{\\partial N_i}{\\partial \\eta} = \\frac{1}{4}\\eta_i(1+\\xi_i\\xi)(2\\eta_i\\eta+\\xi_i\\xi) = \\frac{1}{4}(1+\\xi_i\\xi)(2\\eta+\\eta_i\\xi_i\\xi)$$\n\nThe midside nodes are $i \\in \\{5, 6, 7, 8\\}$. Their shape functions are given by:\nFor nodes on sides $\\xi_i=0$ (nodes $5, 7$): $N_i(\\xi, \\eta) = \\frac{1}{2}(1-\\xi^2)(1+\\eta_i\\eta)$\nFor nodes on sides $\\eta_i=0$ (nodes $6, 8$): $N_i(\\xi, \\eta) = \\frac{1}{2}(1+\\xi_i\\xi)(1-\\eta^2)$\n\nThe partial derivatives for the midside nodes are:\nFor $i=5$ with $(\\xi_5, \\eta_5) = (0, -1)$: $N_5 = \\frac{1}{2}(1-\\xi^2)(1-\\eta)$\n$$\\frac{\\partial N_5}{\\partial \\xi} = -\\xi(1-\\eta), \\quad \\frac{\\partial N_5}{\\partial \\eta} = -\\frac{1}{2}(1-\\xi^2)$$\nFor $i=6$ with $(\\xi_6, \\eta_6) = (1, 0)$: $N_6 = \\frac{1}{2}(1+\\xi)(1-\\eta^2)$\n$$\\frac{\\partial N_6}{\\partial \\xi} = \\frac{1}{2}(1-\\eta^2), \\quad \\frac{\\partial N_6}{\\partial \\eta} = -(1+\\xi)\\eta$$\nFor $i=7$ with $(\\xi_7, \\eta_7) = (0, 1)$: $N_7 = \\frac{1}{2}(1-\\xi^2)(1+\\eta)$\n$$\\frac{\\partial N_7}{\\partial \\xi} = -\\xi(1+\\eta), \\quad \\frac{\\partial N_7}{\\partial \\eta} = \\frac{1}{2}(1-\\xi^2)$$\nFor $i=8$ with $(\\xi_8, \\eta_8) = (-1, 0)$: $N_8 = \\frac{1}{2}(1-\\xi)(1-\\eta^2)$\n$$\\frac{\\partial N_8}{\\partial \\xi} = -\\frac{1}{2}(1-\\eta^2), \\quad \\frac{\\partial N_8}{\\partial \\eta} = -(1-\\xi)\\eta$$\n\n**Part 2: Strain-Displacement Matrix $B$**\n\nIn the isoparametric formulation, both the geometry and the displacement field are interpolated using the same shape functions. The physical coordinates $(x,y)$ and displacement components $(u,v)$ are given by:\n$$x(\\xi, \\eta) = \\sum_{i=1}^{8} N_i(\\xi, \\eta) x_i, \\quad y(\\xi, \\eta) = \\sum_{i=1}^{8} N_i(\\xi, \\eta) y_i$$\n$$u(\\xi, \\eta) = \\sum_{i=1}^{8} N_i(\\xi, \\eta) u_{i,x}, \\quad v(\\xi, \\eta) = \\sum_{i=1}^{8} N_i(\\xi, \\eta) u_{i,y}$$\nFor small-strain kinematics, the engineering strains are $\\varepsilon_x = \\frac{\\partial u}{\\partial x}$, $\\varepsilon_y = \\frac{\\partial v}{\\partial y}$, and $\\gamma_{xy} = \\frac{\\partial u}{\\partial y} + \\frac{\\partial v}{\\partial x}$. In matrix form:\n$$\\boldsymbol{\\varepsilon} = \\begin{Bmatrix} \\varepsilon_x \\\\ \\varepsilon_y \\\\ \\gamma_{xy} \\end{Bmatrix} = \\begin{bmatrix} \\frac{\\partial}{\\partial x} & 0 \\\\ 0 & \\frac{\\partial}{\\partial y} \\\\ \\frac{\\partial}{\\partial y} & \\frac{\\partial}{\\partial x} \\end{bmatrix} \\begin{Bmatrix} u \\\\ v \\end{Bmatrix} = \\boldsymbol{L} \\boldsymbol{u}$$\nThe derivatives with respect to physical coordinates $(x, y)$ are related to derivatives with respect to reference coordinates $(\\xi, \\eta)$ by the chain rule, involving the Jacobian matrix $\\boldsymbol{J}$:\n$$\\begin{Bmatrix} \\frac{\\partial}{\\partial \\xi} \\\\ \\frac{\\partial}{\\partial \\eta} \\end{Bmatrix} = \\begin{bmatrix} \\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\xi} \\\\ \\frac{\\partial x}{\\partial \\eta} & \\frac{\\partial y}{\\partial \\eta} \\end{bmatrix} \\begin{Bmatrix} \\frac{\\partial}{\\partial x} \\\\ \\frac{\\partial}{\\partial y} \\end{Bmatrix} = \\boldsymbol{J}^{\\mathsf{T}} \\begin{Bmatrix} \\frac{\\partial}{\\partial x} \\\\ \\frac{\\partial}{\\partial y} \\end{Bmatrix}$$\nwhere the standard Jacobian matrix is defined as $\\boldsymbol{J} = \\frac{\\partial(x,y)}{\\partial(\\xi,\\eta)} = \\begin{bmatrix} \\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial x}{\\partial \\eta} \\\\ \\frac{\\partial y}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\eta} \\end{bmatrix}$. Inverting the relationship gives:\n$$\\begin{Bmatrix} \\frac{\\partial}{\\partial x} \\\\ \\frac{\\partial}{\\partial y} \\end{Bmatrix} = (\\boldsymbol{J}^{\\mathsf{T}})^{-1} \\begin{Bmatrix} \\frac{\\partial}{\\partial \\xi} \\\\ \\frac{\\partial}{\\partial \\eta} \\end{Bmatrix} = (\\boldsymbol{J}^{-1})^{\\mathsf{T}} \\begin{Bmatrix} \\frac{\\partial}{\\partial \\xi} \\\\ \\frac{\\partial}{\\partial \\eta} \\end{Bmatrix}$$\nUsing the displacement interpolation, the strains can be related to the nodal displacements $\\boldsymbol{u}$. The relation is $\\boldsymbol{\\varepsilon} = \\boldsymbol{B} \\boldsymbol{u}$, where $\\boldsymbol{B}$ is the $3 \\times 16$ strain-displacement matrix, which is a concatenation of $3 \\times 2$ matrices $\\boldsymbol{B}_i$:\n$$\\boldsymbol{B} = [\\boldsymbol{B}_1, \\boldsymbol{B}_2, \\dots, \\boldsymbol{B}_8]$$\nEach $\\boldsymbol{B}_i$ matrix is given by:\n$$\\boldsymbol{B}_i = \\begin{bmatrix} \\frac{\\partial N_i}{\\partial x} & 0 \\\\ 0 & \\frac{\\partial N_i}{\\partial y} \\\\ \\frac{\\partial N_i}{\\partial y} & \\frac{\\partial N_i}{\\partial x} \\end{bmatrix}$$\nwhere the physical derivatives of the shape functions are calculated as:\n$$\\begin{Bmatrix} \\frac{\\partial N_i}{\\partial x} \\\\ \\frac{\\partial N_i}{\\partial y} \\end{Bmatrix} = (\\boldsymbol{J}^{-1})^{\\mathsf{T}} \\begin{Bmatrix} \\frac{\\partial N_i}{\\partial \\xi} \\\\ \\frac{\\partial N_i}{\\partial \\eta} \\end{Bmatrix}$$\n\n**Part 3: Evaluation of $\\boldsymbol{J}$ and $\\boldsymbol{J}^{-1}$ at $(\\xi, \\eta) = (0,0)$**\n\nFirst, we evaluate the gradients of the shape functions at the element center $(\\xi, \\eta) = (0,0)$:\nFor corner nodes $i \\in \\{1,2,3,4\\}$:\n$$\\frac{\\partial N_i}{\\partial \\xi}(0,0) = 0, \\quad \\frac{\\partial N_i}{\\partial \\eta}(0,0) = 0$$\nFor midside nodes $i \\in \\{5,6,7,8\\}$:\n$$\\frac{\\partial N_5}{\\partial \\xi}(0,0) = 0, \\quad \\frac{\\partial N_5}{\\partial \\eta}(0,0) = -\\frac{1}{2}$$\n$$\\frac{\\partial N_6}{\\partial \\xi}(0,0) = \\frac{1}{2}, \\quad \\frac{\\partial N_6}{\\partial \\eta}(0,0) = 0$$\n$$\\frac{\\partial N_7}{\\partial \\xi}(0,0) = 0, \\quad \\frac{\\partial N_7}{\\partial \\eta}(0,0) = \\frac{1}{2}$$\n$$\\frac{\\partial N_8}{\\partial \\xi}(0,0) = -\\frac{1}{2}, \\quad \\frac{\\partial N_8}{\\partial \\eta}(0,0) = 0$$\n\nThe components of the Jacobian matrix $\\boldsymbol{J}$ are:\n$J_{11} = \\frac{\\partial x}{\\partial \\xi} = \\sum_{i=1}^{8} \\frac{\\partial N_i}{\\partial \\xi} x_i $, $J_{12} = \\frac{\\partial x}{\\partial \\eta} = \\sum_{i=1}^{8} \\frac{\\partial N_i}{\\partial \\eta} x_i$\n$J_{21} = \\frac{\\partial y}{\\partial \\xi} = \\sum_{i=1}^{8} \\frac{\\partial N_i}{\\partial \\xi} y_i$, $J_{22} = \\frac{\\partial y}{\\partial \\eta} = \\sum_{i=1}^{8} \\frac{\\partial N_i}{\\partial \\eta} y_i$\n\nUsing the given physical coordinates $\\boldsymbol{x}_i=(x_i, y_i)$ and the derivatives at $(0,0)$:\n$J_{11}(0,0) = x_6 \\frac{\\partial N_6}{\\partial \\xi}(0,0) + x_8 \\frac{\\partial N_8}{\\partial \\xi}(0,0) = (2)(\\frac{1}{2}) + (-2)(-\\frac{1}{2}) = 1+1=2$\n$J_{12}(0,0) = x_5 \\frac{\\partial N_5}{\\partial \\eta}(0,0) + x_7 \\frac{\\partial N_7}{\\partial \\eta}(0,0) = (0)(-\\frac{1}{2}) + (0)(\\frac{1}{2}) = 0$\n$J_{21}(0,0) = y_6 \\frac{\\partial N_6}{\\partial \\xi}(0,0) + y_8 \\frac{\\partial N_8}{\\partial \\xi}(0,0) = (0)(\\frac{1}{2}) + (0)(-\\frac{1}{2}) = 0$\n$J_{22}(0,0) = y_5 \\frac{\\partial N_5}{\\partial \\eta}(0,0) + y_7 \\frac{\\partial N_7}{\\partial \\eta}(0,0) = (-1)(-\\frac{1}{2}) + (1)(\\frac{1}{2}) = \\frac{1}{2}+\\frac{1}{2}=1$\n\nSo, the Jacobian matrix and its inverse at the center are:\n$$\\boldsymbol{J}(0,0) = \\begin{bmatrix} 2 & 0 \\\\ 0 & 1 \\end{bmatrix}, \\quad \\boldsymbol{J}^{-1}(0,0) = \\begin{bmatrix} \\frac{1}{2} & 0 \\\\ 0 & 1 \\end{bmatrix}$$\n\n**Part 4: Shear Strain Calculation**\n\nThe shear strain is $\\gamma_{xy} = \\frac{\\partial u}{\\partial y} + \\frac{\\partial v}{\\partial x}$. Using the interpolation functions:\n$$\\gamma_{xy} = \\sum_{i=1}^{8} u_{i,x} \\frac{\\partial N_i}{\\partial y} + \\sum_{i=1}^{8} u_{i,y} \\frac{\\partial N_i}{\\partial x}$$\nWe evaluate this at $(\\xi, \\eta) = (0,0)$. First, we find the physical derivatives of $N_i$ at this point. Because $\\boldsymbol{J}(0,0)$ is symmetric, $(\\boldsymbol{J}^{-1})^{\\mathsf{T}} = \\boldsymbol{J}^{-1}$ at this specific point.\n$$\\begin{Bmatrix} \\frac{\\partial N_i}{\\partial x}(0,0) \\\\ \\frac{\\partial N_i}{\\partial y}(0,0) \\end{Bmatrix} = \\boldsymbol{J}^{-1}(0,0) \\begin{Bmatrix} \\frac{\\partial N_i}{\\partial \\xi}(0,0) \\\\ \\frac{\\partial N_i}{\\partial \\eta}(0,0) \\end{Bmatrix} = \\begin{bmatrix} \\frac{1}{2} & 0 \\\\ 0 & 1 \\end{bmatrix} \\begin{Bmatrix} \\frac{\\partial N_i}{\\partial \\xi}(0,0) \\\\ \\frac{\\partial N_i}{\\partial \\eta}(0,0) \\end{Bmatrix} = \\begin{Bmatrix} \\frac{1}{2}\\frac{\\partial N_i}{\\partial \\xi}(0,0) \\\\ \\frac{\\partial N_i}{\\partial \\eta}(0,0) \\end{Bmatrix}$$\nSo, at the center, $\\gamma_{xy}$ is:\n$$\\gamma_{xy}(0,0) = \\sum_{i=1}^{8} u_{i,x} \\left(\\frac{\\partial N_i}{\\partial \\eta}(0,0)\\right) + \\sum_{i=1}^{8} u_{i,y} \\left(\\frac{1}{2}\\frac{\\partial N_i}{\\partial \\xi}(0,0)\\right)$$\nThe nodal displacements are zero for nodes $1, 2, 3, 4$. The non-zero displacements are:\n$u_{5,x}=1\\times 10^{-3}$, $u_{5,y}=0$\n$u_{6,x}=0$, $u_{6,y}=3\\times 10^{-3}$\n$u_{7,x}=2\\times 10^{-3}$, $u_{7,y}=0$\n$u_{8,x}=0$, $u_{8,y}=-1\\times 10^{-3}$\n\nThe first summation term becomes (only nodes $5$ and $7$ have non-zero $\\frac{\\partial N_i}{\\partial \\eta}$ and non-zero $u_{i,x}$):\n$$\\sum u_{i,x} \\frac{\\partial N_i}{\\partial \\eta} = u_{5,x}\\frac{\\partial N_5}{\\partial \\eta}(0,0) + u_{7,x}\\frac{\\partial N_7}{\\partial \\eta}(0,0)$$\n$$= (1 \\times 10^{-3})(-\\frac{1}{2}) + (2 \\times 10^{-3})(\\frac{1}{2}) = (-0.5 + 1.0) \\times 10^{-3} = 0.5 \\times 10^{-3}$$\nThe second summation term becomes (only nodes $6$ and $8$ have non-zero $\\frac{\\partial N_i}{\\partial \\xi}$ and non-zero $u_{i,y}$):\n$$\\sum u_{i,y} \\left(\\frac{1}{2}\\frac{\\partial N_i}{\\partial \\xi}\\right) = u_{6,y}\\left(\\frac{1}{2}\\frac{\\partial N_6}{\\partial \\xi}(0,0)\\right) + u_{8,y}\\left(\\frac{1}{2}\\frac{\\partial N_8}{\\partial \\xi}(0,0)\\right)$$\n$$= (3 \\times 10^{-3})\\left(\\frac{1}{2}\\cdot\\frac{1}{2}\\right) + (-1 \\times 10^{-3})\\left(\\frac{1}{2}\\cdot(-\\frac{1}{2})\\right)$$\n$$= (3 \\times 10^{-3})(\\frac{1}{4}) + (-1 \\times 10^{-3})(-\\frac{1}{4}) = (0.75 + 0.25) \\times 10^{-3} = 1.0 \\times 10^{-3}$$\nThe total shear strain is the sum of these two contributions:\n$$\\gamma_{xy}(0,0) = (0.5 \\times 10^{-3}) + (1.0 \\times 10^{-3}) = 1.5 \\times 10^{-3}$$\nThe problem requires the answer to be rounded to $4$ significant figures.\n$$\\gamma_{xy}(0,0) = 0.001500 = 1.500 \\times 10^{-3}$$", "answer": "$$\\boxed{1.500 \\times 10^{-3}}$$", "id": "3558296"}, {"introduction": "Computational efficiency often involves trade-offs, and in FEM, reduced integration is a prime example. While using fewer integration points can significantly speed up calculations, it can also fail to detect certain deformation patterns, leading to non-physical behavior. This practice challenges you to explore this phenomenon by constructing a \"zero-energy\" or \"hourglass\" mode for an $S_2$ element, a specific deformation that produces no strain at the integration point and thus no resisting force. [@problem_id:3558309] Understanding these modes is critical for correctly using under-integrated elements in practical simulations.", "problem": "Consider the small-strain, plane strain, linear elastic response of a homogeneous, isotropic soil discretized by a single serendipity family order two ($S_2$) quadrilateral isoparametric finite element. The element occupies the square reference domain $[-1,1]\\times[-1,1]$ in the parent coordinates $(\\xi,\\eta)$, and for this problem the isoparametric mapping is the identity, so the physical coordinates $(x,y)$ coincide with $(\\xi,\\eta)$. The element has eight nodes: four corner nodes located at $(\\xi,\\eta)=(-1,-1),(1,-1),(1,1),(-1,1)$ and four mid-side nodes located at $(\\xi,\\eta)=(0,-1),(1,0),(0,1),(-1,0)$. Each node carries two displacement degrees of freedom, $u_x$ and $u_y$. The interpolation uses the standard $S_2$ serendipity shape functions.\n\nThe strain tensor $\\boldsymbol{\\varepsilon}$ is defined by the small-strain kinematics, namely $\\boldsymbol{\\varepsilon}=\\operatorname{sym}(\\nabla \\boldsymbol{u})$, and the strain energy density is $W(\\boldsymbol{\\varepsilon})=\\tfrac{1}{2}\\,\\boldsymbol{\\varepsilon}^{\\mathsf{T}}\\boldsymbol{D}\\,\\boldsymbol{\\varepsilon}$, where $\\boldsymbol{D}$ is the symmetric, positive definite elasticity matrix for plane strain. The element stiffness is to be computed by reduced integration using the $1\\times 1$ Gauss quadrature rule (a single Gauss point at $(\\xi,\\eta)=(0,0)$ with weight $2\\times 2$ on the reference square), so the strain energy depends only on the strain evaluated at $(\\xi,\\eta)=(0,0)$.\n\nUsing only the definitions above and the standard $S_2$ serendipity shape functions, derive the strain-displacement relation at the Gauss point $(\\xi,\\eta)=(0,0)$ and show how reduced integration can admit displacement patterns with zero strain energy (hourglass modes). Then, restrict attention to a displacement pattern in which all nodal degrees of freedom are zero except for the horizontal displacements at the right and left mid-side nodes, with $(\\xi,\\eta)=(1,0)$ and $(\\xi,\\eta)=(-1,0)$, respectively. Denote these two nonzero degrees of freedom by $u_{6x}=A$ and $u_{8x}=rA$, where $A\\neq 0$ is an arbitrary amplitude and $r$ is a real-valued ratio. Determine the value of $r$ such that the strain energy computed by the $1\\times 1$ quadrature rule is exactly zero. Express your final answer as a single real number. No rounding is required and no physical units are to be reported.", "solution": "The total strain energy, $U$, of the finite element is given by the integral of the strain energy density, $W(\\boldsymbol{\\varepsilon})$, over the element's area, $A_{e}$. Since the problem specifies plane strain conditions, we consider energy per unit thickness. The isoparametric mapping is the identity, so the physical coordinates $(x,y)$ are identical to the parent coordinates $(\\xi,\\eta)$, and the determinant of the Jacobian matrix is $|\\boldsymbol{J}|=1$. The integral is thus:\n$$U = \\int_{A_e} W(\\boldsymbol{\\varepsilon}) \\, dA = \\int_{-1}^{1} \\int_{-1}^{1} W(\\boldsymbol{\\varepsilon}(\\xi, \\eta)) \\, d\\xi \\, d\\eta$$\nThe problem specifies that the element stiffness, and thus the strain energy, is computed using a $1 \\times 1$ Gauss quadrature rule. This rule approximates the integral by evaluating the integrand at the center of the reference domain, $(\\xi, \\eta) = (0,0)$, and multiplying by the appropriate weight, which for the reference square $[-1,1]\\times[-1,1]$ is $2 \\times 2 = 4$.\n$$U \\approx 4 \\cdot W(\\boldsymbol{\\varepsilon}(0,0))$$\nThe strain energy density is defined as $W(\\boldsymbol{\\varepsilon}) = \\frac{1}{2}\\boldsymbol{\\varepsilon}^{\\mathsf{T}}\\boldsymbol{D}\\,\\boldsymbol{\\varepsilon}$, where $\\boldsymbol{D}$ is the symmetric, positive definite elasticity matrix. Since $\\boldsymbol{D}$ is positive definite, $W(\\boldsymbol{\\varepsilon})$ is zero if and only if the strain tensor $\\boldsymbol{\\varepsilon}$ is the zero tensor. Consequently, the strain energy approximated by the reduced integration scheme is zero if and only if the strain tensor evaluated at the Gauss point is zero:\n$$\\boldsymbol{\\varepsilon}(0,0) = \\mathbf{0}$$\nTo evaluate this condition, we must first establish the strain-displacement relationship at $(\\xi, \\eta) = (0,0)$. The displacement field $\\boldsymbol{u}(\\xi,\\eta)$ is interpolated from the nodal displacements $\\boldsymbol{d}_i$ using the $S_2$ serendipity shape functions $N_i(\\xi, \\eta)$:\n$$\\boldsymbol{u}(\\xi,\\eta) = \\begin{pmatrix} u_x(\\xi,\\eta) \\\\ u_y(\\xi,\\eta) \\end{pmatrix} = \\sum_{i=1}^{8} N_i(\\xi, \\eta) \\begin{pmatrix} u_{ix} \\\\ u_{iy} \\end{pmatrix}$$\nThe small-strain tensor components in the $(x,y)$ coordinate system, which coincides with $(\\xi,\\eta)$, are:\n$$\\varepsilon_{xx} = \\frac{\\partial u_x}{\\partial x} = \\frac{\\partial u_x}{\\partial \\xi} = \\sum_{i=1}^{8} \\frac{\\partial N_i}{\\partial \\xi} u_{ix}$$\n$$\\varepsilon_{yy} = \\frac{\\partial u_y}{\\partial y} = \\frac{\\partial u_y}{\\partial \\eta} = \\sum_{i=1}^{8} \\frac{\\partial N_i}{\\partial \\eta} u_{iy}$$\n$$\\gamma_{xy} = \\frac{\\partial u_x}{\\partial y} + \\frac{\\partial u_y}{\\partial x} = \\frac{\\partial u_x}{\\partial \\eta} + \\frac{\\partial u_y}{\\partial \\xi} = \\sum_{i=1}^{8} \\left( \\frac{\\partial N_i}{\\partial \\eta} u_{ix} + \\frac{\\partial N_i}{\\partial \\xi} u_{iy} \\right)$$\nThese expressions must be evaluated at the Gauss point $(\\xi, \\eta) = (0,0)$. This requires the derivatives of the $S_2$ shape functions at this point. The shape functions for the $8$-node serendipity element are:\nFor corner nodes $i=1,2,3,4$ at $(\\xi_i, \\eta_i)$ where $\\xi_i, \\eta_i \\in \\{-1, 1\\}$: $N_i = \\frac{1}{4}(1+\\xi\\xi_i)(1+\\eta\\eta_i)(\\xi\\xi_i+\\eta\\eta_i-1)$.\nFor mid-side nodes $i=5,7$ at $(0, \\eta_i)$ where $\\eta_i \\in \\{-1, 1\\}$: $N_i = \\frac{1}{2}(1-\\xi^2)(1+\\eta\\eta_i)$.\nFor mid-side nodes $i=6,8$ at $(\\xi_i, 0)$ where $\\xi_i \\in \\{-1, 1\\}$: $N_i = \\frac{1}{2}(1+\\xi\\xi_i)(1-\\eta^2)$.\n\nThe partial derivatives of these shape functions evaluated at $(\\xi, \\eta) = (0,0)$ are:\nFor all corner nodes ($i=1,2,3,4$):\n$$\\frac{\\partial N_i}{\\partial \\xi}\\bigg|_{(0,0)}=0, \\quad \\frac{\\partial N_i}{\\partial \\eta}\\bigg|_{(0,0)}=0$$\nFor mid-side nodes ($i=5,6,7,8$):\n\\begin{itemize}\n    \\item Node $5$ at $(0,-1)$: $\\frac{\\partial N_5}{\\partial \\xi}\\big|_{(0,0)}=0$, $\\frac{\\partial N_5}{\\partial \\eta}\\big|_{(0,0)}=-\\frac{1}{2}$\n    \\item Node $6$ at $(1,0)$: $\\frac{\\partial N_6}{\\partial \\xi}\\big|_{(0,0)}=\\frac{1}{2}$, $\\frac{\\partial N_6}{\\partial \\eta}\\big|_{(0,0)}=0$\n    \\item Node $7$ at $(0,1)$: $\\frac{\\partial N_7}{\\partial \\xi}\\big|_{(0,0)}=0$, $\\frac{\\partial N_7}{\\partial \\eta}\\big|_{(0,0)}=\\frac{1}{2}$\n    \\item Node $8$ at $(-1,0)$: $\\frac{\\partial N_8}{\\partial \\xi}\\big|_{(0,0)}=-\\frac{1}{2}$, $\\frac{\\partial N_8}{\\partial \\eta}\\big|_{(0,0)}=0$\n\\end{itemize}\nSubstituting these derivatives into the strain expressions reveals that the strain at the center depends only on the displacements of the mid-side nodes:\n$$\\varepsilon_{xx}(0,0) = \\frac{1}{2}u_{6x} - \\frac{1}{2}u_{8x}$$\n$$\\varepsilon_{yy}(0,0) = -\\frac{1}{2}u_{5y} + \\frac{1}{2}u_{7y}$$\n$$\\gamma_{xy}(0,0) = -\\frac{1}{2}u_{5x} + \\frac{1}{2}u_{7x} + \\frac{1}{2}u_{6y} - \\frac{1}{2}u_{8y}$$\nThis result demonstrates how reduced integration admits hourglass modes. Any combination of nodal displacements that results in zero strain at the center will have zero computed strain energy, even if the element is deforming. For instance, any displacement pattern involving only the corner nodes yields $\\boldsymbol{\\varepsilon}(0,0)=\\mathbf{0}$ and is thus a zero-energy (hourglass) mode under this integration scheme.\n\nThe problem requires analyzing a specific displacement pattern where all nodal degrees of freedom are zero except for two:\n$$u_{6x} = A \\quad (\\text{at node } 6, (\\xi,\\eta)=(1,0))$$\n$$u_{8x} = rA \\quad (\\text{at node } 8, (\\xi,\\eta)=(-1,0))$$\nHere, $A \\neq 0$ and $r$ is a real-valued ratio. For this specific mode, all other nodal displacements are zero.\nSubstituting these specific nodal displacements into the strain equations at $(\\xi,\\eta)=(0,0)$:\n$$\\varepsilon_{xx}(0,0) = \\frac{1}{2}(A) - \\frac{1}{2}(rA) = \\frac{A}{2}(1-r)$$\n$$\\varepsilon_{yy}(0,0) = 0$$\n$$\\gamma_{xy}(0,0) = 0$$\nThe strain tensor at the Gauss point is therefore:\n$$\\boldsymbol{\\varepsilon}(0,0) = \\begin{pmatrix} \\frac{A}{2}(1-r) \\\\ 0 \\\\ 0 \\end{pmatrix}$$\nFor the computed strain energy to be zero, this strain tensor must be the zero vector. This requires its only potentially non-zero component to be zero:\n$$\\frac{A}{2}(1-r) = 0$$\nGiven that $A \\neq 0$, the equation is satisfied only if:\n$$1-r = 0$$\nSolving for $r$ yields:\n$$r = 1$$\nThus, for the specified displacement pattern to be a zero-energy (hourglass) mode under $1 \\times 1$ Gauss quadrature, the ratio $r$ must be equal to $1$. This corresponds to a displacement field $u_x = A(1-\\eta^2)$ and $u_y=0$, which is a classic bending-type hourglass mode for this element.", "answer": "$$\\boxed{1}$$", "id": "3558309"}, {"introduction": "A fundamental assumption of the isoparametric formulation is that the mapping from the ideal parent element to the physical element is geometrically valid. However, severely distorted meshes can violate this assumption, leading to catastrophic simulation failure. This exercise demonstrates this critical limit by guiding you to find the precise amount of geometric \"warping\" that causes the mapping to invert, signified by a zero or negative Jacobian determinant. [@problem_id:3558295] By diagnosing this failure, you will develop a deeper appreciation for the importance of mesh quality and the need for robust meshing strategies in computational geomechanics.", "problem": "In plane-strain computational geomechanics, consider an isoparametric mapping from the bi-unit square in the parent coordinates $(\\xi,\\eta)\\in[-1,1]\\times[-1,1]$ to the physical $(x,y)$-plane using the standard quadratic serendipity eight-node family (denote this family by $S_2$). Let the physical coordinates of the four corner nodes be\n$$\n\\mathbf{x}_1=(0,0),\\quad \\mathbf{x}_2=(2,0),\\quad \\mathbf{x}_3=(-s,2),\\quad \\mathbf{x}_4=(0,2),\n$$\nwith $s>0$ a scalar “warp amplitude” parameter with units of meters. The four midside nodes are placed at the physical midpoints of the corresponding edges, that is,\n$$\n\\mathbf{x}_5=\\frac{\\mathbf{x}_1+\\mathbf{x}_2}{2},\\quad \\mathbf{x}_6=\\frac{\\mathbf{x}_2+\\mathbf{x}_3}{2},\\quad \\mathbf{x}_7=\\frac{\\mathbf{x}_3+\\mathbf{x}_4}{2},\\quad \\mathbf{x}_8=\\frac{\\mathbf{x}_4+\\mathbf{x}_1}{2}.\n$$\nUsing only the foundational definition of the isoparametric map $\\mathbf{x}(\\xi,\\eta)=\\sum_{i=1}^{8}N_i(\\xi,\\eta)\\,\\mathbf{x}_i$ with the standard quadratic serendipity ($S_2$) shape functions $N_i(\\xi,\\eta)$, and the definition of the Jacobian matrix $\\mathbf{J}(\\xi,\\eta)=\\partial\\mathbf{x}/\\partial(\\xi,\\eta)$, derive the Jacobian determinant at the element center $(\\xi,\\eta)=(0,0)$ as a function of $s$, and determine the smallest positive warp amplitude $s=s_{\\mathrm{crit}}$ (in meters) for which the center Jacobian determinant vanishes. Then, based on first principles of isoparametric mappings and element geometry, briefly discuss why $s>s_{\\mathrm{crit}}$ implies a locally negative Jacobian in this construction and outline two distinct remedial strategies (either mesh quality improvements or alternative mapping choices) to avoid such local inversion in practice.\n\nExpress your final numerical result for $s_{\\mathrm{crit}}$ in meters. No rounding is necessary; provide the exact value.", "solution": "The problem requires the derivation of the Jacobian determinant for an eight-node quadratic serendipity element at its center, determination of the critical warp parameter $s_{\\mathrm{crit}}$ that makes this determinant zero, and a discussion of the implications and remedies.\n\nThe solution proceeds in four stages:\n1.  Define the element geometry and the shape functions with their derivatives.\n2.  Calculate the components of the Jacobian matrix $\\mathbf{J}(\\xi,\\eta)$ at the element center $(\\xi,\\eta)=(0,0)$.\n3.  Derive the Jacobian determinant $\\det(\\mathbf{J}(0,0))$ as a function of $s$ and solve for $s_{\\mathrm{crit}}$.\n4.  Discuss the meaning of a negative Jacobian and propose remedial strategies.\n\n**1. Element Geometry and Shape Function Derivatives**\n\nThe mapping from the parent domain $(\\xi,\\eta)$ to the physical domain $(x,y)$ is given by the isoparametric relation:\n$$\n\\mathbf{x}(\\xi,\\eta) = \\sum_{i=1}^{8} N_i(\\xi,\\eta)\\,\\mathbf{x}_i\n$$\nwhere $N_i$ are the shape functions for the $S_2$ family and $\\mathbf{x}_i=(x_i, y_i)$ are the nodal coordinates. The standard parent coordinates $(\\xi_i, \\eta_i)$ for the eight nodes are:\nCorner nodes: $\\mathbf{x}_1 \\leftrightarrow (-1,-1)$, $\\mathbf{x}_2 \\leftrightarrow (1,-1)$, $\\mathbf{x}_3 \\leftrightarrow (1,1)$, $\\mathbf{x}_4 \\leftrightarrow (-1,1)$.\nMidside nodes: $\\mathbf{x}_5 \\leftrightarrow (0,-1)$, $\\mathbf{x}_6 \\leftrightarrow (1,0)$, $\\mathbf{x}_7 \\leftrightarrow (0,1)$, $\\mathbf{x}_8 \\leftrightarrow (-1,0)$.\n\nThe physical coordinates are given as:\n$\\mathbf{x}_1 = (0,0)$\n$\\mathbf{x}_2 = (2,0)$\n$\\mathbf{x}_3 = (-s,2)$\n$\\mathbf{x}_4 = (0,2)$\nThe midside nodes are at the physical midpoints of the edges:\n$\\mathbf{x}_5 = \\frac{\\mathbf{x}_1+\\mathbf{x}_2}{2} = \\frac{(0,0)+(2,0)}{2} = (1,0)$\n$\\mathbf{x}_6 = \\frac{\\mathbf{x}_2+\\mathbf{x}_3}{2} = \\frac{(2,0)+(-s,2)}{2} = (1-\\frac{s}{2}, 1)$\n$\\mathbf{x}_7 = \\frac{\\mathbf{x}_3+\\mathbf{x}_4}{2} = \\frac{(-s,2)+(0,2)}{2} = (-\\frac{s}{2}, 2)$\n$\\mathbf{x}_8 = \\frac{\\mathbf{x}_4+\\mathbf{x}_1}{2} = \\frac{(0,2)+(0,0)}{2} = (0,1)$\n\nThe Jacobian matrix is defined as:\n$$\n\\mathbf{J}(\\xi,\\eta) = \\frac{\\partial(x,y)}{\\partial(\\xi,\\eta)} = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial x}{\\partial \\eta} \\\\ \\frac{\\partial y}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix} = \\begin{pmatrix} \\sum_{i=1}^{8} \\frac{\\partial N_i}{\\partial \\xi} x_i & \\sum_{i=1}^{8} \\frac{\\partial N_i}{\\partial \\eta} x_i \\\\ \\sum_{i=1}^{8} \\frac{\\partial N_i}{\\partial \\xi} y_i & \\sum_{i=1}^{8} \\frac{\\partial N_i}{\\partial \\eta} y_i \\end{pmatrix}\n$$\nA key property of the standard serendipity shape functions is that the derivatives of the corner node shape functions ($N_1, N_2, N_3, N_4$) are zero at the element center $(\\xi,\\eta)=(0,0)$. The derivatives of the midside node shape functions ($N_5, N_6, N_7, N_8$) at the center are non-zero and are given by:\n$$\n\\begin{array}{c|c|c}\ni & \\frac{\\partial N_i}{\\partial \\xi}\\Big|_{(0,0)} & \\frac{\\partial N_i}{\\partial \\eta}\\Big|_{(0,0)} \\\\\n\\hline\n5 & 0 & -1/2 \\\\\n6 & 1/2 & 0 \\\\\n7 & 0 & 1/2 \\\\\n8 & -1/2 & 0 \\\\\n\\end{array}\n$$\n\n**2. Jacobian Matrix at the Element Center**\n\nUsing the derivatives above, the components of the Jacobian matrix at $(\\xi,\\eta) = (0,0)$ are calculated as follows. The sums reduce to only include terms from the midside nodes.\n\n$\\frac{\\partial x}{\\partial \\xi}\\Big|_{(0,0)} = \\sum_{i=5}^{8} \\frac{\\partial N_i}{\\partial \\xi} x_i = \\frac{\\partial N_6}{\\partial \\xi}x_6 + \\frac{\\partial N_8}{\\partial \\xi}x_8 = \\frac{1}{2}\\left(1-\\frac{s}{2}\\right) + \\left(-\\frac{1}{2}\\right)(0) = \\frac{1}{2}-\\frac{s}{4}$.\n\n$\\frac{\\partial x}{\\partial \\eta}\\Big|_{(0,0)} = \\sum_{i=5}^{8} \\frac{\\partial N_i}{\\partial \\eta} x_i = \\frac{\\partial N_5}{\\partial \\eta}x_5 + \\frac{\\partial N_7}{\\partial \\eta}x_7 = \\left(-\\frac{1}{2}\\right)(1) + \\frac{1}{2}\\left(-\\frac{s}{2}\\right) = -\\frac{1}{2}-\\frac{s}{4}$.\n\n$\\frac{\\partial y}{\\partial \\xi}\\Big|_{(0,0)} = \\sum_{i=5}^{8} \\frac{\\partial N_i}{\\partial \\xi} y_i = \\frac{\\partial N_6}{\\partial \\xi}y_6 + \\frac{\\partial N_8}{\\partial \\xi}y_8 = \\frac{1}{2}(1) + \\left(-\\frac{1}{2}\\right)(1) = 0$.\n\n$\\frac{\\partial y}{\\partial \\eta}\\Big|_{(0,0)} = \\sum_{i=5}^{8} \\frac{\\partial N_i}{\\partial \\eta} y_i = \\frac{\\partial N_5}{\\partial \\eta}y_5 + \\frac{\\partial N_7}{\\partial \\eta}y_7 = \\left(-\\frac{1}{2}\\right)(0) + \\frac{1}{2}(2) = 1$.\n\nThe Jacobian matrix at the center is:\n$$\n\\mathbf{J}(0,0) = \\begin{pmatrix} \\frac{1}{2} - \\frac{s}{4} & -\\frac{1}{2} - \\frac{s}{4} \\\\ 0 & 1 \\end{pmatrix}\n$$\n\n**3. Jacobian Determinant and Critical Warp Amplitude**\n\nThe Jacobian determinant at the center is:\n$$\n\\det(\\mathbf{J}(0,0)) = \\left(\\frac{1}{2} - \\frac{s}{4}\\right)(1) - \\left(-\\frac{1}{2} - \\frac{s}{4}\\right)(0) = \\frac{1}{2} - \\frac{s}{4}\n$$\nThe mapping becomes invalid when the Jacobian determinant vanishes or becomes negative. The critical warp amplitude $s_{\\mathrm{crit}}$ is the smallest positive value of $s$ for which the determinant is zero.\n$$\n\\det(\\mathbf{J}(0,0)) = 0 \\implies \\frac{1}{2} - \\frac{s}{4} = 0\n$$\nSolving for $s$:\n$$\n\\frac{s}{4} = \\frac{1}{2} \\implies s = 2\n$$\nThus, the critical warp amplitude is $s_{\\mathrm{crit}} = 2$ meters.\n\n**4. Discussion of Negative Jacobian and Remedial Strategies**\n\nFor a valid one-to-one isoparametric mapping, the Jacobian determinant must be positive everywhere within the element, $\\det(\\mathbf{J}) > 0$. The determinant represents the local ratio of differential area in the physical space to that in the parent space, $dA = \\det(\\mathbf{J}) d\\xi d\\eta$. A positive determinant ensures that the orientation of the local coordinate system is preserved.\n\nIn this construction, the determinant $\\det(\\mathbf{J}(0,0)) = \\frac{1}{2} - \\frac{s}{4}$ is a continuous function of $s$. When $s > s_{\\mathrm{crit}}=2$, the determinant becomes negative. For instance, if $s=4$, $\\det(\\mathbf{J}(0,0)) = \\frac{1}{2} - \\frac{4}{4} = -0.5$. A negative determinant implies a local inversion or \"folding\" of the element geometry. Geometrically, the term $\\frac{\\partial x}{\\partial \\xi}|_{(0,0)} = \\frac{1}{2} - \\frac{s}{4}$ becomes negative for $s>2$. This means that along the element's centerline ($\\eta=0$), an increase in the parent coordinate $\\xi$ (moving from the side with node $8$ to the side with node $6$) results in a decrease in the physical coordinate $x$. The element geometry becomes self-penetrating, which is physically and mathematically invalid for a continuum body.\n\nTwo distinct remedial strategies to avoid such local inversion are:\n\n1.  **Mesh Quality Improvement:** This approach focuses on altering the mesh to prevent severe distortions.\n    *   **Node Repositioning (Smoothing):** The primary cause of the invalid element is the extreme position of corner node $\\mathbf{x}_3=(-s,2)$. A mesh generation or smoothing algorithm could be employed to reposition this node (i.e., reduce the value of $s$ below $s_{\\mathrm{crit}}$) to ensure all elements in the mesh have a positive Jacobian determinant. This is the most common approach in practice.\n    *   **Mesh Refinement:** The single, highly distorted quadrilateral can be replaced by multiple, smaller, and better-shaped elements. For example, the domain could be subdivided into two triangular elements or four smaller quadrilateral elements. This increases the number of degrees of freedom but can represent the intended geometry without producing invalid elements.\n\n2.  **Alternative Formulation or Element Choice:** This approach modifies the finite element formulation itself rather than the mesh geometry.\n    *   **Sub-parametric Formulation:** One can use lower-order shape functions for the geometric mapping than for the field variable approximation. For instance, using a linear geometric map (based only on the four corner nodes) with quadratic shape functions for the solution field. The element sides would be straight. This is a sub-parametric element. However, for a sufficiently large $s$, the quadrilateral defined by the four corner nodes becomes self-intersecting (a \"crossed quadrilateral\"), which would still be invalid even with a linear map.\n    *   **Use of Lower-Order or More Robust Elements:** Simpler elements are often more resistant to distortion. A mesh of four-node linear quadrilaterals ($Q_1$) or three-node linear triangles (CST) could be used. These elements have a lower tendency to fail due to nodal positioning, at the cost of reduced accuracy per element, particularly in bending.", "answer": "$$\\boxed{2}$$", "id": "3558295"}]}