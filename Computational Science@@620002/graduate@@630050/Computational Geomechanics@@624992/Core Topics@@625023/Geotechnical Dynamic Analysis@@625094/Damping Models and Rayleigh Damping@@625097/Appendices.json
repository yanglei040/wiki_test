{"hands_on_practices": [{"introduction": "The most common method for defining Rayleigh damping coefficients involves targeting specific damping ratios at two key modal frequencies. This exercise provides fundamental practice in this calibration process, guiding you through the calculation of the $\\alpha$ and $\\beta$ coefficients. By then calculating the damping at other frequencies, you will directly observe the inherent frequency-dependent nature of the Rayleigh model [@problem_id:3515209].", "problem": "A vertically propagating shear-wave soil column is modeled using the linear elastodynamic equation of motion in the time domain, with proportional damping constructed as a linear combination of the mass matrix and the stiffness matrix. Consider the finite element semi-discrete system with displacement vector $u(t)$, mass matrix $M$, stiffness matrix $K$, and damping matrix $C$, and assume classical proportional damping in the form of a Rayleigh model. The modal damping ratio $\\xi$ is defined for each mode through the single-degree-of-freedom reduction of the equations of motion in modal coordinates. The soil column is tuned so that the first two natural modes, with frequencies $f_{1}=3\\,\\mathrm{Hz}$ and $f_{2}=9\\,\\mathrm{Hz}$, both have modal damping ratio $\\xi=0.05$ under this Rayleigh damping assumption. Using the angular frequency definition $\\omega=2\\pi f$, determine the two Rayleigh coefficients $\\alpha$ and $\\beta$ that achieve this tuning. Then, compute the resulting damping ratios at $f=0.5\\,\\mathrm{Hz}$ and $f=30\\,\\mathrm{Hz}$ implied by these coefficients.\n\nProvide all four results as exact analytic expressions without rounding. Express $\\alpha$ in $\\mathrm{s}^{-1}$, $\\beta$ in $\\mathrm{s}$, and the damping ratios $\\xi$ as dimensionless decimals or fractions. In your final boxed answer, list the four quantities in the order $\\alpha$, $\\beta$, $\\xi(f=0.5\\,\\mathrm{Hz})$, $\\xi(f=30\\,\\mathrm{Hz})$.", "solution": "The user wants me to solve a problem in computational geomechanics. Here's my plan to validate and solve it.\n\n### Step 1: Extract Givens\nThe problem provides the following information:\n-   The system is governed by the linear elastodynamic equation of motion for a semi-discrete finite element system: $M\\ddot{u} + C\\dot{u} + Ku = F(t)$.\n-   The damping matrix $C$ is defined by the proportional (Rayleigh) damping model: $C = \\alpha M + \\beta K$.\n-   The modal damping ratio $\\xi$ for a mode with angular frequency $\\omega$ is given by the relation for a single-degree-of-freedom system, which for Rayleigh damping is $\\xi(\\omega) = \\frac{1}{2} \\left( \\frac{\\alpha}{\\omega} + \\beta\\omega \\right)$.\n-   The first natural frequency is $f_1 = 3\\,\\mathrm{Hz}$, and its corresponding modal damping ratio is $\\xi_1 = 0.05$.\n-   The second natural frequency is $f_2 = 9\\,\\mathrm{Hz}$, and its corresponding modal damping ratio is $\\xi_2 = 0.05$.\n-   The relationship between angular frequency $\\omega$ and frequency $f$ is $\\omega = 2\\pi f$.\n-   The tasks are to determine the Rayleigh coefficients $\\alpha$ and $\\beta$, and then to compute the damping ratios $\\xi$ at two other frequencies: $f = 0.5\\,\\mathrm{Hz}$ and $f = 30\\,\\mathrm{Hz}$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is validated against the required criteria:\n-   **Scientifically Grounded**: The problem is firmly rooted in the classical theory of structural dynamics and computational mechanics. The linear equation of motion and the Rayleigh damping model are standard, widely-used concepts in engineering and geomechanics. All premises are factually and scientifically sound.\n-   **Well-Posed**: The problem requires finding two unknowns, $\\alpha$ and $\\beta$, using two independent equations derived from the given conditions at two distinct frequencies. This constitutes a well-posed system of two linear equations in two variables. The subsequent calculation of damping ratios at other frequencies is a direct application of the derived model. A unique, stable, and meaningful solution exists.\n-   **Objective**: The problem is stated using precise, unambiguous, and quantitative language. There are no subjective elements or opinions.\n-   **Completeness and Consistency**: All necessary data and definitions are provided. The given values are physically reasonable for a soil dynamics problem. There are no internal contradictions.\n-   **Other Flaws**: The problem is not metaphorical, trivial, or unverifiable. It is a standard application of established theory.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. The solution process will now be executed.\n\n---\n\nThe relationship between the modal damping ratio $\\xi_n$ and the modal angular frequency $\\omega_n$ for a system with Rayleigh damping is given by:\n$$ \\xi_n = \\frac{1}{2} \\left( \\frac{\\alpha}{\\omega_n} + \\beta\\omega_n \\right) $$\nwhere $\\alpha$ and $\\beta$ are the Rayleigh damping coefficients.\n\nFirst, we convert the given frequencies $f_1$ and $f_2$ into angular frequencies $\\omega_1$ and $\\omega_2$ using the formula $\\omega = 2\\pi f$:\n$$ \\omega_1 = 2\\pi f_1 = 2\\pi (3\\,\\mathrm{Hz}) = 6\\pi\\,\\mathrm{rad/s} $$\n$$ \\omega_2 = 2\\pi f_2 = 2\\pi (9\\,\\mathrm{Hz}) = 18\\pi\\,\\mathrm{rad/s} $$\n\nWe are given that the damping ratio is $\\xi = 0.05$ for both of these modes. This provides a system of two linear equations for the two unknowns $\\alpha$ and $\\beta$:\n$$ 0.05 = \\frac{1}{2} \\left( \\frac{\\alpha}{6\\pi} + \\beta(6\\pi) \\right) \\quad \\text{(1)} $$\n$$ 0.05 = \\frac{1}{2} \\left( \\frac{\\alpha}{18\\pi} + \\beta(18\\pi) \\right) \\quad \\text{(2)} $$\n\nMultiplying both equations by $2$ gives:\n$$ 0.10 = \\frac{\\alpha}{6\\pi} + 6\\pi\\beta $$\n$$ 0.10 = \\frac{\\alpha}{18\\pi} + 18\\pi\\beta $$\n\nThis is a linear system in $\\alpha$ and $\\beta$. To solve it, we can express it in matrix form or use substitution/elimination. Let's use a general algebraic solution. For two frequencies $\\omega_i$ and $\\omega_j$ with the same damping ratio $\\xi$:\n$$ 2\\xi = \\frac{\\alpha}{\\omega_i} + \\beta\\omega_i $$\n$$ 2\\xi = \\frac{\\alpha}{\\omega_j} + \\beta\\omega_j $$\nSolving this system yields the general formulas for $\\alpha$ and $\\beta$:\n$$ \\alpha = \\frac{2\\xi \\omega_i \\omega_j}{\\omega_i + \\omega_j} $$\n$$ \\beta = \\frac{2\\xi}{\\omega_i + \\omega_j} $$\n\nNow, we substitute $\\xi=0.05$, $\\omega_1=6\\pi$, and $\\omega_2=18\\pi$ into these formulas. For $\\beta$:\n$$ \\beta = \\frac{2(0.05)}{6\\pi + 18\\pi} = \\frac{0.1}{24\\pi} = \\frac{1}{240\\pi}\\,\\mathrm{s} $$\nFor $\\alpha$:\n$$ \\alpha = \\frac{2(0.05)(6\\pi)(18\\pi)}{6\\pi + 18\\pi} = \\frac{0.1 \\cdot 108\\pi^2}{24\\pi} = \\frac{10.8\\pi}{24} $$\nTo express this as an exact fraction, we write $10.8$ as $\\frac{108}{10}$:\n$$ \\alpha = \\frac{108\\pi}{10 \\cdot 24} = \\frac{108\\pi}{240} $$\nDividing the numerator and denominator by their greatest common divisor, which is $24$:\n$$ \\alpha = \\frac{108 \\div 12}{240 \\div 12}\\pi = \\frac{9\\pi}{20}\\,\\mathrm{s}^{-1} $$\nSo, the Rayleigh coefficients are $\\alpha = \\frac{9\\pi}{20}$ and $\\beta = \\frac{1}{240\\pi}$.\n\nNext, we compute the damping ratios at $f_3 = 0.5\\,\\mathrm{Hz}$ and $f_4 = 30\\,\\mathrm{Hz}$.\nFirst, we find the corresponding angular frequencies:\n$$ \\omega_3 = 2\\pi f_3 = 2\\pi (0.5) = \\pi\\,\\mathrm{rad/s} $$\n$$ \\omega_4 = 2\\pi f_4 = 2\\pi (30) = 60\\pi\\,\\mathrm{rad/s} $$\n\nNow, we use the damping ratio formula $\\xi(\\omega) = \\frac{1}{2} \\left( \\frac{\\alpha}{\\omega} + \\beta\\omega \\right)$ with our calculated $\\alpha$ and $\\beta$.\n\nFor $f_3 = 0.5\\,\\mathrm{Hz}$ ($\\omega_3 = \\pi$):\n$$ \\xi(f=0.5\\,\\mathrm{Hz}) = \\frac{1}{2} \\left( \\frac{9\\pi/20}{\\pi} + \\frac{1}{240\\pi} \\cdot \\pi \\right) $$\n$$ \\xi(f=0.5\\,\\mathrm{Hz}) = \\frac{1}{2} \\left( \\frac{9}{20} + \\frac{1}{240} \\right) $$\nTo add the fractions, we find a common denominator, which is $240$.\n$$ \\xi(f=0.5\\,\\mathrm{Hz}) = \\frac{1}{2} \\left( \\frac{9 \\cdot 12}{20 \\cdot 12} + \\frac{1}{240} \\right) = \\frac{1}{2} \\left( \\frac{108}{240} + \\frac{1}{240} \\right) = \\frac{1}{2} \\left( \\frac{109}{240} \\right) = \\frac{109}{480} $$\n\nFor $f_4 = 30\\,\\mathrm{Hz}$ ($\\omega_4 = 60\\pi$):\n$$ \\xi(f=30\\,\\mathrm{Hz}) = \\frac{1}{2} \\left( \\frac{9\\pi/20}{60\\pi} + \\frac{1}{240\\pi} \\cdot 60\\pi \\right) $$\n$$ \\xi(f=30\\,\\mathrm{Hz}) = \\frac{1}{2} \\left( \\frac{9}{20 \\cdot 60} + \\frac{60}{240} \\right) = \\frac{1}{2} \\left( \\frac{9}{1200} + \\frac{1}{4} \\right) $$\nTo add the fractions, we find a common denominator, which is $1200$.\n$$ \\xi(f=30\\,\\mathrm{Hz}) = \\frac{1}{2} \\left( \\frac{9}{1200} + \\frac{300}{1200} \\right) = \\frac{1}{2} \\left( \\frac{309}{1200} \\right) = \\frac{309}{2400} $$\nThis fraction can be simplified by dividing the numerator and denominator by their greatest common divisor, which is $3$.\n$$ \\xi(f=30\\,\\mathrm{Hz}) = \\frac{309 \\div 3}{2400 \\div 3} = \\frac{103}{800} $$\n\nThe four required quantities are:\n1.  $\\alpha = \\frac{9\\pi}{20}$\n2.  $\\beta = \\frac{1}{240\\pi}$\n3.  $\\xi(f=0.5\\,\\mathrm{Hz}) = \\frac{109}{480}$\n4.  $\\xi(f=30\\,\\mathrm{Hz}) = \\frac{103}{800}$", "answer": "$$ \\boxed{\\begin{pmatrix} \\frac{9\\pi}{20} & \\frac{1}{240\\pi} & \\frac{109}{480} & \\frac{103}{800} \\end{pmatrix}} $$", "id": "3515209"}, {"introduction": "While two-point calibration is simple, real soil damping measured from laboratory tests is often represented by a continuous curve over a frequency spectrum. This practice advances to a more realistic scenario where the goal is to find the optimal Rayleigh coefficients that best fit a target damping curve using a least-squares method. This task highlights the approximative nature of the Rayleigh model and introduces a quantitative way to assess the goodness-of-fit [@problem_id:3515294].", "problem": "A continuum soil specimen is represented in a discrete form by a second-order linear dynamical system governed by the equation of motion $M\\ddot{u} + C\\dot{u} + Ku = f_{\\text{ext}}$, where $M$ is the mass matrix, $K$ is the stiffness matrix, $C$ is the damping matrix, $u$ is the displacement vector, and $f_{\\text{ext}}$ is the external force vector. Assume a classical Rayleigh damping model in which $C = a_0 M + a_1 K$, where $a_0$ and $a_1$ are real scalars to be determined. Consider linear free-vibration and modal analysis assumptions standard in computational geomechanics.\n\nDefine the target soil damping ratio curve $\\zeta_{\\text{target}}(\\omega)$ as a scalar function of circular frequency $\\omega$ (in $\\mathrm{rad/s}$), representing small-strain cyclic test observations for the soil. Over a frequency band $[\\omega_L,\\omega_H]$, determine the Rayleigh damping parameters $(a_0,a_1)$ (with $a_0$ in $\\mathrm{s^{-1}}$ and $a_1$ in $\\mathrm{s}$) that minimize the squared error functional\n$$\nJ(a_0,a_1) = \\int_{\\omega_L}^{\\omega_H}\\left(\\zeta_{\\text{Rayleigh}}(\\omega) - \\zeta_{\\text{target}}(\\omega)\\right)^2\\,\\mathrm{d}\\omega,\n$$\nwhere $\\zeta_{\\text{Rayleigh}}(\\omega)$ is the modal damping ratio implied by the Rayleigh damping model under standard modal reduction. You must derive $\\zeta_{\\text{Rayleigh}}(\\omega)$ starting from the equation of motion, the definition of Rayleigh damping, and the modal relations between effective modal mass and stiffness for an undamped mode of circular frequency $\\omega$.\n\nFor the optimal $(a_0,a_1)$, additionally compute the equal-contribution frequency\n$$\n\\omega_{\\mathrm{eq}} = \\sqrt{\\frac{a_0}{a_1}},\n$$\nin $\\mathrm{rad/s}$, defined as the frequency at which the mass-proportional and stiffness-proportional components contribute equally to the Rayleigh modal damping ratio. If $a_0 \\le 0$ or $a_1 \\le 0$, set $\\omega_{\\mathrm{eq}}$ to not-a-number.\n\nAlso quantify the quality of fit by computing:\n- The root-mean-square error over the band,\n$$\ne_{\\mathrm{rms}} = \\sqrt{\\frac{1}{\\omega_H-\\omega_L}\\int_{\\omega_L}^{\\omega_H}\\left(\\zeta_{\\text{Rayleigh}}(\\omega) - \\zeta_{\\text{target}}(\\omega)\\right)^2\\,\\mathrm{d}\\omega},\n$$\ndimensionless.\n- The maximum absolute error over the band, defined as the supremum of $\\left|\\zeta_{\\text{Rayleigh}}(\\omega) - \\zeta_{\\text{target}}(\\omega)\\right|$ for $\\omega \\in [\\omega_L,\\omega_H]$, approximated numerically on a sufficiently fine grid, dimensionless.\n\nYour program must implement the minimization analytically via the normal equations arising from least-squares projection of $\\zeta_{\\text{target}}(\\omega)$ onto the span of the frequency-dependent Rayleigh basis functions implied by the derivation, and must evaluate the necessary integrals numerically with adequate accuracy.\n\nUse the following test suite. For each case, the target damping curve and the frequency band are specified. All damping ratios are dimensionless; all frequencies are in $\\mathrm{rad/s}$.\n\n- Case 1 (baseline constant target, broad band):\n  - $\\zeta_{\\text{target}}(\\omega) = 0.05$,\n  - $\\omega_L = 1$, $\\omega_H = 100$.\n- Case 2 (monotone increasing saturation target, medium band):\n  - $\\zeta_{\\text{target}}(\\omega) = \\zeta_0 + (\\zeta_\\infty - \\zeta_0)\\frac{\\omega}{\\omega + \\omega_c}$, with $\\zeta_0 = 0.02$, $\\zeta_\\infty = 0.08$, $\\omega_c = 30$,\n  - $\\omega_L = 5$, $\\omega_H = 100$.\n- Case 3 (peaked target, broad-low band):\n  - $\\zeta_{\\text{target}}(\\omega) = \\zeta_{\\text{base}} + \\zeta_{\\text{amp}}\\frac{\\omega}{\\omega_p}\\exp\\!\\left(1 - \\frac{\\omega}{\\omega_p}\\right)$, with $\\zeta_{\\text{base}} = 0.02$, $\\zeta_{\\text{amp}} = 0.06$, $\\omega_p = 20$,\n  - $\\omega_L = 1$, $\\omega_H = 50$.\n- Case 4 (narrow band, mildly varying target):\n  - $\\zeta_{\\text{target}}(\\omega) = \\zeta_0 + \\frac{\\beta}{1 + \\left(\\frac{\\omega}{\\omega_c}\\right)^2}$, with $\\zeta_0 = 0.03$, $\\beta = 0.04$, $\\omega_c = 21$,\n  - $\\omega_L = 20$, $\\omega_H = 22$.\n\nFor each test case, your program must:\n- Derive and use $\\zeta_{\\text{Rayleigh}}(\\omega)$ based on fundamental relations,\n- Compute the optimal $(a_0,a_1)$ in $\\mathrm{s^{-1}}$ and $\\mathrm{s}$, respectively,\n- Compute $\\omega_{\\mathrm{eq}}$ in $\\mathrm{rad/s}$ (set to not-a-number if $a_0 \\le 0$ or $a_1 \\le 0$),\n- Compute $e_{\\mathrm{rms}}$ (dimensionless),\n- Compute the maximum absolute error over $[\\omega_L,\\omega_H]$ (dimensionless).\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, concatenating the five values per case in the following order:\n$$\n[a_0^{(1)}, a_1^{(1)}, \\omega_{\\mathrm{eq}}^{(1)}, e_{\\mathrm{rms}}^{(1)}, e_{\\max}^{(1)}, a_0^{(2)}, a_1^{(2)}, \\omega_{\\mathrm{eq}}^{(2)}, e_{\\mathrm{rms}}^{(2)}, e_{\\max}^{(2)}, a_0^{(3)}, a_1^{(3)}, \\omega_{\\mathrm{eq}}^{(3)}, e_{\\mathrm{rms}}^{(3)}, e_{\\max}^{(3)}, a_0^{(4)}, a_1^{(4)}, \\omega_{\\mathrm{eq}}^{(4)}, e_{\\mathrm{rms}}^{(4)}, e_{\\max}^{(4)}],\n$$\nwhere superscripts denote the case number. All $a_0$ entries must be in $\\mathrm{s^{-1}}$, all $a_1$ entries in $\\mathrm{s}$, all $\\omega_{\\mathrm{eq}}$ entries in $\\mathrm{rad/s}$, and all errors must be dimensionless. Angles (frequencies) are in radians per second. The final numeric outputs must be floats. If a case yields $a_0 \\le 0$ or $a_1 \\le 0$, print $\\mathrm{NaN}$ for $\\omega_{\\mathrm{eq}}$ for that case.", "solution": "The problem requires the determination of optimal Rayleigh damping parameters $(a_0, a_1)$ by minimizing the integrated squared error between a target damping ratio curve $\\zeta_{\\text{target}}(\\omega)$ and the Rayleigh damping curve $\\zeta_{\\text{Rayleigh}}(\\omega)$ over a specified frequency band $[\\omega_L, \\omega_H]$. This is a classical least-squares problem in the context of structural dynamics.\n\nFirst, we must derive the expression for the Rayleigh modal damping ratio, $\\zeta_{\\text{Rayleigh}}(\\omega)$. The equation of motion for a linear multi-degree-of-freedom system is given as $M\\ddot{u} + C\\dot{u} + Ku = f_{\\text{ext}}$. Under the assumption of linear free-vibration and modal analysis, we consider the undamped eigenvalue problem, $K\\phi_i = \\omega_i^2 M\\phi_i$, where $\\omega_i$ is the $i$-th natural circular frequency and $\\phi_i$ is the corresponding mode shape.\n\nBy applying modal transformation $u(t) = \\sum_i \\phi_i q_i(t)$, and leveraging the orthogonality of mode shapes with respect to the mass and stiffness matrices, the system of coupled equations decouples into a set of independent SDOF (single-degree-of-freedom) equations, one for each mode $i$:\n$$\nM_i \\ddot{q}_i(t) + C_i \\dot{q}_i(t) + K_i q_i(t) = F_i(t)\n$$\nwhere $M_i = \\phi_i^T M \\phi_i$ is the modal mass, $K_i = \\phi_i^T K \\phi_i$ is the modal stiffness, and $C_i = \\phi_i^T C \\phi_i$ is the modal damping. The modal stiffness and mass are related by $K_i = \\omega_i^2 M_i$.\n\nThe standard form of an SDOF equation is $\\ddot{q}_i + 2\\zeta_i\\omega_i \\dot{q}_i + \\omega_i^2 q_i = F_i/M_i$. By comparing the coefficients, the modal damping ratio $\\zeta_i$ is defined as:\n$$\n\\zeta_i = \\frac{C_i}{2\\omega_i M_i}\n$$\nThe problem specifies a Rayleigh damping matrix $C = a_0 M + a_1 K$. Substituting this into the expression for the modal damping coefficient $C_i$:\n$$\nC_i = \\phi_i^T (a_0 M + a_1 K) \\phi_i = a_0 (\\phi_i^T M \\phi_i) + a_1 (\\phi_i^T K \\phi_i) = a_0 M_i + a_1 K_i\n$$\nSubstituting $K_i = \\omega_i^2 M_i$, we get $C_i = a_0 M_i + a_1 (\\omega_i^2 M_i) = (a_0 + a_1 \\omega_i^2) M_i$.\nNow, we substitute this expression for $C_i$ back into the formula for the modal damping ratio $\\zeta_i$:\n$$\n\\zeta_i = \\frac{(a_0 + a_1 \\omega_i^2) M_i}{2\\omega_i M_i} = \\frac{a_0 + a_1 \\omega_i^2}{2\\omega_i} = \\frac{a_0}{2\\omega_i} + \\frac{a_1 \\omega_i}{2}\n$$\nThe problem considers the damping ratio as a continuous function of frequency $\\omega$, not limited to discrete modal frequencies. Thus, we generalize the modal damping ratio to a function of $\\omega$:\n$$\n\\zeta_{\\text{Rayleigh}}(\\omega) = \\frac{a_0}{2\\omega} + \\frac{a_1 \\omega}{2}\n$$\n\nNext, we solve the minimization problem. We need to find the scalars $a_0$ and $a_1$ that minimize the functional $J(a_0, a_1)$:\n$$\nJ(a_0, a_1) = \\int_{\\omega_L}^{\\omega_H} \\left( \\zeta_{\\text{Rayleigh}}(\\omega) - \\zeta_{\\text{target}}(\\omega) \\right)^2 \\mathrm{d}\\omega = \\int_{\\omega_L}^{\\omega_H} \\left( \\frac{a_0}{2\\omega} + \\frac{a_1\\omega}{2} - \\zeta_{\\text{target}}(\\omega) \\right)^2 \\mathrm{d}\\omega\n$$\nTo find the minimum, we set the partial derivatives of $J$ with respect to $a_0$ and $a_1$ to zero, which yields the normal equations of the least-squares problem.\n$$\n\\frac{\\partial J}{\\partial a_0} = \\int_{\\omega_L}^{\\omega_H} 2 \\left( \\frac{a_0}{2\\omega} + \\frac{a_1\\omega}{2} - \\zeta_{\\text{target}}(\\omega) \\right) \\left( \\frac{1}{2\\omega} \\right) \\mathrm{d}\\omega = 0\n$$\n$$\n\\frac{\\partial J}{\\partial a_1} = \\int_{\\omega_L}^{\\omega_H} 2 \\left( \\frac{a_0}{2\\omega} + \\frac{a_1\\omega}{2} - \\zeta_{\\text{target}}(\\omega) \\right) \\left( \\frac{\\omega}{2} \\right) \\mathrm{d}\\omega = 0\n$$\nSimplifying and rearranging these two equations gives a linear system for $(a_0, a_1)$:\n$$\na_0 \\left( \\int_{\\omega_L}^{\\omega_H} \\frac{1}{\\omega^2} \\mathrm{d}\\omega \\right) + a_1 \\left( \\int_{\\omega_L}^{\\omega_H} 1 \\mathrm{d}\\omega \\right) = \\int_{\\omega_L}^{\\omega_H} \\frac{2\\zeta_{\\text{target}}(\\omega)}{\\omega} \\mathrm{d}\\omega\n$$\n$$\na_0 \\left( \\int_{\\omega_L}^{\\omega_H} 1 \\mathrm{d}\\omega \\right) + a_1 \\left( \\int_{\\omega_L}^{\\omega_H} \\omega^2 \\mathrm{d}\\omega \\right) = \\int_{\\omega_L}^{\\omega_H} 2\\omega \\zeta_{\\text{target}}(\\omega) \\mathrm{d}\\omega\n$$\nThis system can be written in matrix form $A \\mathbf{x} = \\mathbf{b}$, where $\\mathbf{x} = [a_0, a_1]^T$:\n$$\n\\begin{bmatrix}\n\\int_{\\omega_L}^{\\omega_H} \\frac{1}{\\omega^2} \\mathrm{d}\\omega & \\int_{\\omega_L}^{\\omega_H} 1 \\mathrm{d}\\omega \\\\\n\\int_{\\omega_L}^{\\omega_H} 1 \\mathrm{d}\\omega & \\int_{\\omega_L}^{\\omega_H} \\omega^2 \\mathrm{d}\\omega\n\\end{bmatrix}\n\\begin{Bmatrix} a_0 \\\\ a_1 \\end{Bmatrix}\n=\n\\begin{Bmatrix}\n\\int_{\\omega_L}^{\\omega_H} \\frac{2\\zeta_{\\text{target}}(\\omega)}{\\omega} \\mathrm{d}\\omega \\\\\n\\int_{\\omega_L}^{\\omega_H} 2\\omega \\zeta_{\\text{target}}(\\omega) \\mathrm{d}\\omega\n\\end{Bmatrix}\n$$\nThe integrals forming the coefficient matrix $A$ can be evaluated analytically:\n$A_{11} = \\int_{\\omega_L}^{\\omega_H} \\frac{1}{\\omega^2} \\mathrm{d}\\omega = \\left[-\\frac{1}{\\omega}\\right]_{\\omega_L}^{\\omega_H} = \\frac{1}{\\omega_L} - \\frac{1}{\\omega_H}$\n$A_{12} = A_{21} = \\int_{\\omega_L}^{\\omega_H} 1 \\mathrm{d}\\omega = [\\omega]_{\\omega_L}^{\\omega_H} = \\omega_H - \\omega_L$\n$A_{22} = \\int_{\\omega_L}^{\\omega_H} \\omega^2 \\mathrm{d}\\omega = \\left[\\frac{\\omega^3}{3}\\right]_{\\omega_L}^{\\omega_H} = \\frac{\\omega_H^3 - \\omega_L^3}{3}$\n\nThe integrals on the right-hand side vector $\\mathbf{b}$ involve the target function $\\zeta_{\\text{target}}(\\omega)$ and are computed numerically using quadrature, as they generally do not have simple analytical solutions.\n$b_1 = \\int_{\\omega_L}^{\\omega_H} \\frac{2\\zeta_{\\text{target}}(\\omega)}{\\omega} \\mathrm{d}\\omega$\n$b_2 = \\int_{\\omega_L}^{\\omega_H} 2\\omega \\zeta_{\\text{target}}(\\omega) \\mathrm{d}\\omega$\n\nThe system $A \\mathbf{x} = \\mathbf{b}$ is solved for $\\mathbf{x} = [a_0, a_1]^T$ to obtain the optimal parameters. Once $(a_0, a_1)$ are found, the required metrics are calculated:\n\n1.  The equal-contribution frequency $\\omega_{\\mathrm{eq}}$ is the frequency at which the mass-proportional term $\\frac{a_0}{2\\omega}$ and stiffness-proportional term $\\frac{a_1\\omega}{2}$ are equal.\n    $$\n    \\frac{a_0}{2\\omega_{\\mathrm{eq}}} = \\frac{a_1\\omega_{\\mathrm{eq}}}{2} \\implies \\omega_{\\mathrm{eq}}^2 = \\frac{a_0}{a_1} \\implies \\omega_{\\mathrm{eq}} = \\sqrt{\\frac{a_0}{a_1}}\n    $$\n    This is only defined for $a_0 > 0$ and $a_1 > 0$. If either is non-positive, $\\omega_{\\mathrm{eq}}$ is set to not-a-number (NaN).\n\n2.  The root-mean-square error $e_{\\mathrm{rms}}$ is given by:\n    $$\n    e_{\\mathrm{rms}} = \\sqrt{\\frac{J(a_0, a_1)}{\\omega_H - \\omega_L}} = \\sqrt{\\frac{1}{\\omega_H-\\omega_L}\\int_{\\omega_L}^{\\omega_H}\\left(\\zeta_{\\text{Rayleigh}}(\\omega) - \\zeta_{\\text{target}}(\\omega)\\right)^2\\,\\mathrm{d}\\omega}\n    $$\n    The integral is computed numerically using the determined optimal $a_0$ and $a_1$.\n\n3.  The maximum absolute error $e_{\\max}$ is:\n    $$\n    e_{\\max} = \\sup_{\\omega \\in [\\omega_L, \\omega_H]} \\left|\\zeta_{\\text{Rayleigh}}(\\omega) - \\zeta_{\\text{target}}(\\omega)\\right|\n    $$\n    This is approximated by evaluating the absolute error on a fine uniform grid of frequencies across the interval $[\\omega_L, \\omega_H]$ and finding the maximum value.\n\nThe implementation will follow these steps, using numerical quadrature for the integrals and a linear algebra solver for the normal equations.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import quad\n\ndef solve():\n    \"\"\"\n    Computes optimal Rayleigh damping parameters and error metrics for a suite of test cases.\n    \"\"\"\n\n    def solve_case(zeta_target_func, omega_L, omega_H):\n        \"\"\"\n        Solves for a single test case.\n\n        Args:\n            zeta_target_func (callable): The target damping ratio function zeta_target(omega).\n            omega_L (float): The lower bound of the frequency band [rad/s].\n            omega_H (float): The upper bound of the frequency band [rad/s].\n\n        Returns:\n            tuple: A 5-tuple containing (a0, a1, omega_eq, e_rms, e_max).\n        \"\"\"\n        # 1. Analytically compute the coefficient matrix A for the normal equations.\n        # A_11 = integral(1/w^2) dw\n        A11 = 1.0 / omega_L - 1.0 / omega_H\n        # A_12 = A_21 = integral(1) dw\n        A12 = omega_H - omega_L\n        A21 = A12\n        # A_22 = integral(w^2) dw\n        A22 = (omega_H**3 - omega_L**3) / 3.0\n        \n        A = np.array([[A11, A12], [A21, A22]])\n\n        # 2. Numerically compute the right-hand side vector b.\n        # Integrands for b1 and b2\n        integrand_b1 = lambda w: 2.0 * zeta_target_func(w) / w\n        integrand_b2 = lambda w: 2.0 * w * zeta_target_func(w)\n\n        b1, _ = quad(integrand_b1, omega_L, omega_H, limit=200)\n        b2, _ = quad(integrand_b2, omega_L, omega_H, limit=200)\n        \n        b = np.array([b1, b2])\n\n        # 3. Solve the linear system A * x = b for x = [a0, a1].\n        try:\n            a0, a1 = np.linalg.solve(A, b)\n        except np.linalg.LinAlgError:\n            # This should not happen for valid physical bands [omega_L, omega_H]\n            return (np.nan, np.nan, np.nan, np.nan, np.nan)\n\n        # 4. Calculate the equal-contribution frequency, omega_eq.\n        if a0 > 0 and a1 > 0:\n            omega_eq = np.sqrt(a0 / a1)\n        else:\n            omega_eq = np.nan\n\n        # 5. Define the resulting Rayleigh damping function.\n        zeta_rayleigh_func = lambda w: a0 / (2.0 * w) + a1 * w / 2.0\n\n        # 6. Calculate the root-mean-square error, e_rms.\n        squared_error_integrand = lambda w: (zeta_rayleigh_func(w) - zeta_target_func(w))**2\n        J, _ = quad(squared_error_integrand, omega_L, omega_H, limit=200)\n        e_rms = np.sqrt(J / (omega_H - omega_L))\n        \n        # 7. Calculate the maximum absolute error, e_max, on a fine grid.\n        # Use a sufficiently fine grid for numerical approximation of supremum.\n        num_points = 100001 \n        omega_grid = np.linspace(omega_L, omega_H, num_points)\n        error_values = np.abs(zeta_rayleigh_func(omega_grid) - zeta_target_func(omega_grid))\n        e_max = np.max(error_values)\n\n        return (a0, a1, omega_eq, e_rms, e_max)\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"zeta_target\": lambda w: 0.05,\n            \"omega_L\": 1.0,\n            \"omega_H\": 100.0,\n        },\n        {\n            \"zeta_target\": lambda w, z0=0.02, zi=0.08, wc=30.0: z0 + (zi - z0) * w / (w + wc),\n            \"omega_L\": 5.0,\n            \"omega_H\": 100.0,\n        },\n        {\n            \"zeta_target\": lambda w, zb=0.02, za=0.06, wp=20.0: zb + za * (w / wp) * np.exp(1.0 - w / wp),\n            \"omega_L\": 1.0,\n            \"omega_H\": 50.0,\n        },\n        {\n            \"zeta_target\": lambda w, z0=0.03, beta=0.04, wc=21.0: z0 + beta / (1.0 + (w / wc)**2),\n            \"omega_L\": 20.0,\n            \"omega_H\": 22.0,\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        case_results = solve_case(case[\"zeta_target\"], case[\"omega_L\"], case[\"omega_H\"])\n        results.extend(case_results)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3515294"}, {"introduction": "A key challenge in computational dynamics is ensuring that numerical models are not just stable, but also physically meaningful. This exercise explores a critical pitfall of stiffness-proportional damping ($a_1 K$), where non-physical, high-frequency modes associated with small mesh elements can become excessively damped. Through this hands-on coding problem, you will diagnose this issue and implement an advanced, scale-aware damping strategy to create a more robust and physically sound simulation [@problem_id:3515256].", "problem": "Consider small-strain, one-dimensional axial vibrations of a heterogeneous elastic bar discretized by two-node linear finite elements. The governing semidiscrete equation of motion is obtained from the linear momentum balance and the Galerkin finite element method, resulting in the second-order ordinary differential equation $M \\ddot{u}(t) + C \\dot{u}(t) + K u(t) = 0$, where $M$ is the symmetric positive-definite mass matrix, $K$ is the symmetric positive-definite stiffness matrix, $C$ is the damping matrix, and $u(t)$ is the vector of nodal displacements. Under Rayleigh damping, the damping matrix is defined by $C = a_0 M + a_1 K$, with $a_0$ and $a_1$ being nonnegative scalars. In this problem, you will set $a_0 = 0$ to isolate the stiffness-proportional contribution. You will derive the modal damping ratios to study how the stiffness-proportional term $a_1 K$ disproportionately damps high-frequency mesh-dependent modes in strongly heterogeneous meshes, and then propose and implement a scale-aware strategy $a_1(h)$ that adapts to the local element length $h$.\n\nStart from the fundamental base:\n- Newtonâ€™s second law $m \\ddot{x} = \\sum F$ for a material particle and its continuum generalization.\n- The finite element discretization of a one-dimensional axial bar, with element stiffness $K_e$ and consistent mass $M_e$ obtained from energy principles and inertia, respectively.\n\nAssume a bar of length $L$, cross-sectional area $A$, elastic modulus $E$, and mass density $\\rho$. Let the axial wave speed be $c = \\sqrt{E / \\rho}$. Impose fixed-fixed (Dirichlet) boundary conditions at both ends, so there are no rigid body modes. Let each element $e$ have length $h_e$, stiffness matrix $K_e = \\dfrac{E A}{h_e} \\begin{bmatrix} 1 & -1 \\\\ -1 & 1 \\end{bmatrix}$, and consistent mass matrix $M_e = \\dfrac{\\rho A h_e}{6} \\begin{bmatrix} 2 & 1 \\\\ 1 & 2 \\end{bmatrix}$. Assemble $M$ and $K$ in the usual way. Let $\\omega_m$ and $\\phi_m$ be, respectively, the $m$-th undamped natural angular frequency and mode shape obtained from the generalized eigenproblem $K \\phi_m = \\omega_m^2 M \\phi_m$.\n\nTasks:\n1. Derive, from first principles, the expression for the modal damping ratio $\\zeta_m$ under Rayleigh damping with $a_0 = 0$ as a function of $\\omega_m$, $M$, $K$, and $C$. Your derivation must only use the stated fundamental base and modal orthogonality, and must not assume or quote any pre-known closed-form Rayleigh damping ratio formula.\n2. Show analytically why the stiffness-proportional damping contribution leads to increased modal damping for higher $\\omega_m$ and explain the mesh-dependence of the highest frequencies (e.g., how $\\omega$ scales with $h$ in a one-dimensional mesh).\n3. Propose a scale-aware damping scheme with element-wise coefficients $a_1(h_e)$ such that, for the highest wavelength resolvable by each element (characterized by a wavenumber $\\beta / h_e$), the stiffness-proportional modal damping contribution does not exceed a cap $\\zeta_{\\mathrm{cap}}$. Select $\\beta = \\pi$ and justify this selection based on the first axial continuum mode in a segment. Derive the explicit formula for $a_1(h_e)$ using only the base relations and dimensional consistency.\n\nNumerical study:\n- Use the following physical parameters: $L = 10\\,\\mathrm{m}$, $A = 1\\,\\mathrm{m}^2$, $E = 50 \\times 10^{6}\\,\\mathrm{Pa}$, and $\\rho = 2000\\,\\mathrm{kg/m^3}$. Compute the wave speed $c$ and report all angular frequencies in $\\mathrm{rad/s}$, and all damping ratios as dimensionless decimals.\n- Adopt $a_0 = 0$ throughout. Define a global constant $a_1$ by requiring that the stiffness-proportional modal damping ratio equals $\\zeta_{\\mathrm{design}} = 0.02$ at the continuum reference frequency $\\omega_{\\mathrm{design}} = \\dfrac{\\pi c}{L}$. The constant $a_1$ must be derived from first principles.\n- Define a cap $\\zeta_{\\mathrm{cap}} = 0.05$ and your scale-aware $a_1(h_e)$ so that, for each element $e$, its element-level reference frequency $\\omega_e^{\\mathrm{ref}} = \\dfrac{\\pi c}{h_e}$ yields a stiffness-proportional modal damping ratio equal to $\\zeta_{\\mathrm{cap}}$.\n\nTest suite (three meshes):\n- Case $1$ (uniform): $N = 40$ elements with $h_e = \\dfrac{L}{N}$ for all $e$.\n- Case $2$ (moderately heterogeneous): $N = 40$ elements; first $N_1 = 20$ elements occupy the first $10\\%$ of the bar and have $h_e = \\dfrac{0.1 L}{N_1}$; remaining $N_2 = 20$ elements occupy the last $90\\%$ with $h_e = \\dfrac{0.9 L}{N_2}$.\n- Case $3$ (extremely heterogeneous): $N = 40$ elements; one element at the left end has $h_e = 10^{-3} L$, and the remaining $N_2 = 39$ elements split the remaining length uniformly with $h_e = \\dfrac{L - 10^{-3} L}{N_2}$.\n\nFor each case:\n- Assemble $M$ and $K$, apply fixed-fixed boundary conditions by eliminating the boundary degrees of freedom, and solve the generalized eigenproblem for all modes.\n- Normalize each eigenvector $\\phi_m$ such that $\\phi_m^\\top M \\phi_m = 1$.\n- Compute the modal damping ratios $\\zeta_m^{\\mathrm{const}}$ for the constant-$a_1$ strategy using $C = a_1 K$, and $\\zeta_m^{\\mathrm{scale}}$ for the scale-aware strategy using $C = \\sum_e a_1(h_e) K_e$ assembled at the global level.\n- Let $Q$ be the number of modes in the upper quartile (highest $25\\%$ of $\\omega_m$ values). Compute the maximum modal damping ratio over these $Q$ highest-frequency modes for both strategies, $\\max(\\zeta_m^{\\mathrm{const}})$ and $\\max(\\zeta_m^{\\mathrm{scale}})$, and define the disproportion factor $r = \\dfrac{\\max(\\zeta_m^{\\mathrm{const}})}{\\max(\\zeta_m^{\\mathrm{scale}})}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[r_1,r_2,r_3]$), where $r_i$ is the disproportion factor for Case $i$ computed as described. All angular frequencies must be in $\\mathrm{rad/s}$ and all damping ratios must be dimensionless decimals.", "solution": "The user-provided problem is evaluated as valid according to the specified criteria. It is scientifically grounded in linear elastodynamics and the finite element method, well-posed with a complete and consistent setup, and expressed in objective, formal language. The problem presents a non-trivial challenge in computational mechanics that is verifiable through the requested derivations and numerical study.\n\n### Part 1: Derivation of Modal Damping Ratio, $\\zeta_m$\n\nThe governing semidiscrete equation of motion for the system is given by:\n$$M \\ddot{u}(t) + C \\dot{u}(t) + K u(t) = 0$$\nwhere $M$ and $K$ are the symmetric positive-definite mass and stiffness matrices, respectively, and $u(t)$ is the vector of nodal displacements.\n\nThe undamped natural frequencies, $\\omega_m$, and mode shapes, $\\phi_m$, are the solutions to the generalized eigenproblem:\n$$K \\phi_m = \\omega_m^2 M \\phi_m$$\nThe mode shapes $\\phi_m$ form a basis for the displacement vector $u(t)$. Therefore, we can express the solution as a linear combination of these modes, a technique known as modal superposition:\n$$u(t) = \\sum_m \\phi_m q_m(t)$$\nwhere $q_m(t)$ are the time-dependent modal coordinates (or generalized coordinates). Substituting this into the equation of motion yields:\n$$M \\sum_m \\phi_m \\ddot{q}_m(t) + C \\sum_m \\phi_m \\dot{q}_m(t) + K \\sum_m \\phi_m q_m(t) = 0$$\nWe can project this equation onto the $n$-th mode shape by pre-multiplying by $\\phi_n^\\top$:\n$$\\phi_n^\\top M \\sum_m \\phi_m \\ddot{q}_m(t) + \\phi_n^\\top C \\sum_m \\phi_m \\dot{q}_m(t) + \\phi_n^\\top K \\sum_m \\phi_m q_m(t) = 0$$\nDue to the property of modal orthogonality with respect to the mass and stiffness matrices, we have:\n$$\\phi_n^\\top M \\phi_m = \\delta_{nm} M_m^*$$\n$$\\phi_n^\\top K \\phi_m = \\delta_{nm} K_m^*$$\nwhere $\\delta_{nm}$ is the Kronecker delta, and $M_m^*$ and $K_m^*$ are the modal mass and modal stiffness for mode $m$, respectively. If the eigenvectors $\\phi_m$ are normalized such that $\\phi_m^\\top M \\phi_m = 1$, then $M_m^* = 1$ and $K_m^* = \\omega_m^2$.\n\nApplying these orthogonality relations, the equation for each mode $m=n$ becomes decoupled:\n$$(\\phi_m^\\top M \\phi_m) \\ddot{q}_m + (\\phi_m^\\top C \\phi_m) \\dot{q}_m + (\\phi_m^\\top K \\phi_m) q_m = 0$$\nLet's define the modal damping as $C_m^* = \\phi_m^\\top C \\phi_m$. The equation simplifies to:\n$$M_m^* \\ddot{q}_m + C_m^* \\dot{q}_m + K_m^* q_m = 0$$\nDividing by the modal mass $M_m^*$ and recalling that $\\omega_m^2 = K_m^*/M_m^*$, we obtain:\n$$\\ddot{q}_m + \\frac{C_m^*}{M_m^*} \\dot{q}_m + \\omega_m^2 q_m = 0$$\nThis is the standard form of a damped single-degree-of-freedom oscillator, $\\ddot{x} + 2\\zeta_m\\omega_m \\dot{x} + \\omega_m^2 x = 0$. By comparing the two equations, we identify the term $2\\zeta_m\\omega_m$:\n$$2\\zeta_m\\omega_m = \\frac{C_m^*}{M_m^*} = \\frac{\\phi_m^\\top C \\phi_m}{\\phi_m^\\top M \\phi_m}$$\nThe problem specifies stiffness-proportional damping, $C = a_1 K$, with $a_0 = 0$. Substituting this into the expression for $C_m^*$:\n$$C_m^* = \\phi_m^\\top (a_1 K) \\phi_m = a_1 (\\phi_m^\\top K \\phi_m) = a_1 K_m^*$$\nNow we can write the expression for $2\\zeta_m\\omega_m$:\n$$2\\zeta_m\\omega_m = \\frac{a_1 K_m^*}{M_m^*} = a_1 \\omega_m^2$$\nSolving for the modal damping ratio, $\\zeta_m$, we find:\n$$\\zeta_m = \\frac{a_1 \\omega_m^2}{2\\omega_m} = \\frac{a_1 \\omega_m}{2}$$\nThis is the derived expression for the modal damping ratio for stiffness-proportional damping.\n\n### Part 2: Analysis of Stiffness-Proportional Damping\n\nThe derived expression $\\zeta_m = \\dfrac{a_1 \\omega_m}{2}$ shows that the modal damping ratio is linearly proportional to the natural angular frequency $\\omega_m$. This means that higher-frequency modes experience significantly higher damping than low-frequency modes.\n\nThe connection to mesh dependence arises from the nature of the highest frequencies in a finite element discretization. The highest frequency a mesh can resolve is related to the smallest element size, $h_{\\mathrm{min}}$. For a one-dimensional problem, the shortest resolvable wavelength, $\\lambda_{\\mathrm{min}}$, is on the order of the element size, typically $\\lambda_{\\mathrm{min}} \\approx 2h_e$ for a linear element. The angular frequency is related to the wave speed $c$ and wavelength $\\lambda$ by $\\omega = \\dfrac{2\\pi c}{\\lambda}$. Therefore, the maximum frequency supported by the mesh scales inversely with the minimum element size:\n$$\\omega_{\\mathrm{max}} \\propto \\frac{c}{h_{\\mathrm{min}}}$$\nAs a mesh is refined, $h_{\\mathrm{min}} \\to 0$, causing $\\omega_{\\mathrm{max}} \\to \\infty$. In a heterogeneous mesh with very small elements, these elements introduce spurious, non-physical high-frequency modes (often called \"mesh modes\"). According to the formula for $\\zeta_m$, these spurious modes will be assigned very large, artificial damping ratios. This excessive damping of high-frequency components can be numerically detrimental, as it may remove more energy than is physically realistic and can impose severe restrictions on the time step size in explicit time integration schemes.\n\n### Part 3: Scale-Aware Damping Scheme\n\nTo counteract the disproportional damping of high-frequency modes, we propose a scale-aware damping coefficient, $a_1(h_e)$, which adapts to the local element length $h_e$. The goal is to constrain the amount of damping contributed by each element.\n\nThe problem suggests capping the damping ratio at $\\zeta_{\\mathrm{cap}}$ for a characteristic frequency associated with the element. This characteristic frequency is defined as $\\omega_e^{\\mathrm{ref}} = \\dfrac{\\pi c}{h_e}$. This choice is physically motivated: it corresponds to the fundamental frequency of a continuous bar of length $h_e$ with fixed-fixed or free-free ends. The corresponding wavenumber is $k = \\omega/c = \\pi/h_e$, which matches the problem's specification of $\\beta/h_e$ with $\\beta=\\pi$. This represents the smallest-scale physical wave (a half-sine wave with $\\lambda = 2h_e$) that a single element can represent.\n\nWe apply the damping ratio formula at the element level using this reference frequency:\n$$\\zeta_{\\mathrm{cap}} = \\frac{a_1(h_e) \\omega_e^{\\mathrm{ref}}}{2}$$\nSubstituting the expression for $\\omega_e^{\\mathrm{ref}}$:\n$$\\zeta_{\\mathrm{cap}} = \\frac{a_1(h_e)}{2} \\left( \\frac{\\pi c}{h_e} \\right)$$\nSolving for the element-wise coefficient $a_1(h_e)$ gives the explicit formula for the scale-aware scheme:\n$$a_1(h_e) = \\frac{2 \\zeta_{\\mathrm{cap}} h_e}{\\pi c}$$\nWith this scheme, the global damping matrix $C$ is assembled from element-level contributions:\n$$C = \\sum_{e} C_e = \\sum_{e} a_1(h_e) K_e$$\nThis ensures that excessively small elements, which would otherwise introduce spuriously high damping, will have a proportionally smaller coefficient $a_1(h_e)$, thus capping the artificial damping effect.\n\n### Numerical Study Preparations\n\nThe physical parameters are $L = 10\\,\\mathrm{m}$, $A = 1\\,\\mathrm{m}^2$, $E = 50 \\times 10^{6}\\,\\mathrm{Pa}$, and $\\rho = 2000\\,\\mathrm{kg/m^3}$.\nThe axial wave speed is $c = \\sqrt{E/\\rho} = \\sqrt{50 \\times 10^6 / 2000} = \\sqrt{25000} = 50\\sqrt{10}\\,\\mathrm{m/s}$.\n\nThe constant coefficient $a_1$ is determined by setting $\\zeta = \\zeta_{\\mathrm{design}} = 0.02$ at the reference frequency $\\omega_{\\mathrm{design}} = \\dfrac{\\pi c}{L}$.\nUsing $\\zeta = \\dfrac{a_1 \\omega}{2}$:\n$$0.02 = \\frac{a_1}{2} \\left( \\frac{\\pi c}{L} \\right) \\implies a_1 = \\frac{0.04 L}{\\pi c}$$\n\nThe scale-aware coefficient $a_1(h_e)$ is determined by setting $\\zeta = \\zeta_{\\mathrm{cap}} = 0.05$ at the element reference frequency $\\omega_e^{\\mathrm{ref}} = \\dfrac{\\pi c}{h_e}$. As derived previously:\n$$a_1(h_e) = \\frac{2 \\zeta_{\\mathrm{cap}} h_e}{\\pi c} = \\frac{0.1 h_e}{\\pi c}$$\n\nThe requested disproportion factor is $r = \\dfrac{\\max(\\zeta_m^{\\mathrm{const}})}{\\max(\\zeta_m^{\\mathrm{scale}})}$ computed over the highest $25\\%$ of frequencies for each mesh.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import eigh\n\ndef solve():\n    \"\"\"\n    Solves the problem of scale-aware Rayleigh damping in a 1D elastic bar.\n    \"\"\"\n    # Physical and numerical parameters\n    L = 10.0  # m\n    A = 1.0  # m^2\n    E = 50.0e6  # Pa\n    rho = 2000.0  # kg/m^3\n    N_elements = 40\n\n    zeta_design = 0.02\n    zeta_cap = 0.05\n\n    # Derived constants\n    c_wave = np.sqrt(E / rho)\n    omega_design = np.pi * c_wave / L\n\n    # Constant damping coefficient a1\n    a1_const = (2.0 * zeta_design) / omega_design\n\n    # --- Test Cases ---\n    \n    # Case 1: Uniform mesh\n    nodes_c1 = np.linspace(0, L, N_elements + 1)\n    \n    # Case 2: Moderately heterogeneous mesh\n    N1 = 20\n    N2 = 20\n    nodes_c2_part1 = np.linspace(0, 0.1 * L, N1 + 1)\n    nodes_c2_part2 = np.linspace(0.1 * L, L, N2 + 1)\n    nodes_c2 = np.unique(np.concatenate((nodes_c2_part1, nodes_c2_part2)))\n\n    # Case 3: Extremely heterogeneous mesh\n    N1_c3 = 1\n    N2_c3 = N_elements - N1_c3\n    h1_c3 = 1e-3 * L\n    nodes_c3_part1 = np.array([0, h1_c3])\n    nodes_c3_part2 = np.linspace(h1_c3, L, N2_c3 + 1)\n    nodes_c3 = np.unique(np.concatenate((nodes_c3_part1, nodes_c3_part2)))\n    \n    test_cases = [\n        {\"name\": \"Uniform\", \"nodes\": nodes_c1},\n        {\"name\": \"Moderate\", \"nodes\": nodes_c2},\n        {\"name\": \"Extreme\", \"nodes\": nodes_c3},\n    ]\n\n    results = []\n\n    for case in test_cases:\n        nodes = case[\"nodes\"]\n        num_nodes = len(nodes)\n        num_dofs = num_nodes\n        num_elements = num_nodes - 1\n\n        # Initialize global matrices\n        M = np.zeros((num_dofs, num_dofs))\n        K = np.zeros((num_dofs, num_dofs))\n        C_scale = np.zeros((num_dofs, num_dofs))\n\n        # Assemble matrices\n        for e in range(num_elements):\n            node_i, node_j = e, e + 1\n            h_e = nodes[node_j] - nodes[node_i]\n\n            # Element matrices\n            k_e = (E * A / h_e) * np.array([[1, -1], [-1, 1]])\n            m_e = (rho * A * h_e / 6.0) * np.array([[2, 1], [1, 2]])\n\n            # Scale-aware damping coefficient\n            a1_he = (2.0 * zeta_cap * h_e) / (np.pi * c_wave)\n            c_e_scale = a1_he * k_e\n\n            # Assemble into global matrices\n            global_dofs = np.array([node_i, node_j])\n            M[np.ix_(global_dofs, global_dofs)] += m_e\n            K[np.ix_(global_dofs, global_dofs)] += k_e\n            C_scale[np.ix_(global_dofs, global_dofs)] += c_e_scale\n\n        # Apply fixed-fixed boundary conditions\n        internal_dofs = slice(1, -1)\n        M_bc = M[internal_dofs, internal_dofs]\n        K_bc = K[internal_dofs, internal_dofs]\n        C_scale_bc = C_scale[internal_dofs, internal_dofs]\n        \n        # Solve generalized eigenvalue problem: K*phi = omega^2*M*phi\n        # eigh returns M-orthonormalized eigenvectors, such that phi.T @ M @ phi = I\n        eigvals, eigvecs = eigh(K_bc, M_bc)\n        \n        # Frequencies are sorted in ascending order\n        omega_m = np.sqrt(eigvals)\n\n        # Number of modes in the upper quartile\n        num_internal_dofs = num_dofs - 2\n        Q = int(np.ceil(0.25 * num_internal_dofs))\n\n        # --- Compute Modal Damping Ratios ---\n        \n        # 1. Constant a1 strategy\n        # zeta = a1 * omega / 2\n        zeta_const = (a1_const * omega_m) / 2.0\n        max_zeta_const = np.max(zeta_const[-Q:])\n\n        # 2. Scale-aware a1(h) strategy\n        # zeta = (phi.T @ C @ phi) / (2 * omega)\n        # Note: Since eigvecs are M-orthonormalized, K_modal = phi.T @ K @ phi = diag(omega^2)\n        # However, C_scale is not diagonal in the modal basis.\n        zeta_scale = np.zeros_like(omega_m)\n        for m in range(num_internal_dofs):\n            phi_m = eigvecs[:, m]\n            C_modal_m = phi_m.T @ C_scale_bc @ phi_m\n            if omega_m[m] > 1e-9: # Avoid division by zero for rigid body modes (none here)\n                zeta_scale[m] = C_modal_m / (2.0 * omega_m[m])\n        \n        max_zeta_scale = np.max(zeta_scale[-Q:])\n        \n        # Compute disproportion factor\n        r = max_zeta_const / max_zeta_scale\n        results.append(r)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{res:.6f}' for res in results)}]\")\n\nsolve()\n```", "id": "3515256"}]}