{"hands_on_practices": [{"introduction": "Understanding how wave energy partitions at material boundaries is a cornerstone of geophysics and geotechnical site characterization. This foundational exercise guides you through the derivation of reflection ($R$) and transmission ($T$) coefficients for a shear wave impinging on a soil interface, based on fundamental principles of continuity. By applying these principles, you will not only calculate how much energy is reflected versus transmitted but also verify the law of conservation of energy for the system, a critical step in validating any physical model [@problem_id:3570860].", "problem": "A plane, time-harmonic, horizontally polarized shear (SH) wave propagates obliquely in a soft, homogeneous, isotropic, perfectly elastic soil layer (medium $1$) and impinges on a welded planar interface with a stiff, homogeneous, isotropic, perfectly elastic half-space (medium $2$). The interface is at $z=0$, the soil layer occupies $z<0$, and the half-space occupies $z>0$. Let the coordinate $z$ be positive downward. The wave is incident from medium $1$ at an incidence angle $\\theta_1$ measured from the interface normal (the $+z$-axis). Assume no intrinsic attenuation and no mode conversion (pure SH motion).\n\nMaterial properties are:\n- Medium $1$ (soft soil): density $\\,\\rho_1 = 1700\\,\\mathrm{kg/m^3}\\,$ and shear-wave speed $\\,\\beta_1 = 250\\,\\mathrm{m/s}\\,$.\n- Medium $2$ (stiff half-space): density $\\,\\rho_2 = 2200\\,\\mathrm{kg/m^3}\\,$ and shear-wave speed $\\,\\beta_2 = 400\\,\\mathrm{m/s}\\,$.\n\nTake the angle of incidence as $\\theta_1 = 30^{\\circ}$ (degrees). You may use the following fundamental bases:\n- Linear momentum balance (dynamic equilibrium) and Hooke’s law for linear elasticity.\n- Plane-wave kinematics $\\,u_y(\\mathbf{x},t) = \\Re\\{A \\exp[i(\\mathbf{k}\\cdot\\mathbf{x}-\\omega t)]\\}\\,$ and the constitutive relation for SH motion $\\,\\tau_{yz} = \\mu\\,\\partial u_y/\\partial z\\,$, where $\\mu = \\rho \\beta^2$.\n- Continuity of tangential displacement and shear traction across the interface.\n- Conservation of the horizontal wavenumber (Snell’s law).\n\nDefine the plane-wave reflection and transmission coefficients for displacement amplitude as $\\,R = A_r/A_i\\,$ and $\\,T = A_t/A_i\\,$, where $A_i$, $A_r$, and $A_t$ are the incident, reflected, and transmitted displacement amplitudes, respectively.\n\nCompute $R$ and $T$ for this configuration, and then evaluate the energy-balance expression\n$$\\mathcal{E} \\equiv |R|^2 + \\left(\\frac{Z_2 \\cos\\theta_2}{Z_1 \\cos\\theta_1}\\right)|T|^2,$$\nwhere $\\,Z_j = \\rho_j \\beta_j\\,$ and $\\theta_2$ is the transmission angle in medium $2$ determined by Snell’s law. Report the value of $\\,\\mathcal{E}\\,$ as a single number, unitless, rounded to four significant figures. Angles are to be treated in degrees.", "solution": "The problem statement is validated as scientifically grounded, well-posed, and objective. It describes a standard physical scenario of shear wave reflection and transmission at an elastic interface, for which a unique and meaningful solution exists. All necessary parameters and governing principles are provided, and there are no internal contradictions or factual inaccuracies.\n\nThe problem asks for the evaluation of an energy-balance expression for a horizontally polarized shear (SH) wave incident on a planar interface between two elastic media.\n\nLet the interface be the plane $z=0$. Medium $1$ occupies $z<0$ and medium $2$ occupies $z>0$. The displacement field $u_y(x,z,t)$ is purely in the $y$-direction. The total wave field in medium $1$ is the superposition of the incident and reflected waves, while the field in medium $2$ consists of the transmitted wave.\n\nThe incident wave in medium $1$ is given by\n$$u_i(x,z,t) = A_i \\exp[i(k_x x + k_{z1} z - \\omega t)]$$\nThe reflected wave in medium $1$ is\n$$u_r(x,z,t) = A_r \\exp[i(k_x x - k_{z1} z - \\omega t)]$$\nThe transmitted wave in medium $2$ is\n$$u_t(x,z,t) = A_t \\exp[i(k_x x + k_{z2} z - \\omega t)]$$\nwhere $A_i$, $A_r$, and $A_t$ are the complex amplitudes of the incident, reflected, and transmitted waves, respectively. The angular frequency is $\\omega$. The horizontal wavenumber $k_x$ is conserved across the interface. The vertical wavenumbers are $k_{z1}$ in medium $1$ and $k_{z2}$ in medium $2$.\n\nThe wavenumbers are related to the incidence angle $\\theta_1$ and transmission angle $\\theta_2$ (both measured from the normal, i.e., the $z$-axis) as:\n$$k_x = k_1 \\sin\\theta_1 = k_2 \\sin\\theta_2$$\n$$k_{z1} = k_1 \\cos\\theta_1$$\n$$k_{z2} = k_2 \\cos\\theta_2$$\nwhere $k_j = \\omega/\\beta_j$ is the total wavenumber in medium $j$ ($j=1,2$) and $\\beta_j$ is the shear-wave speed. The conservation of $k_x$ leads to Snell's law:\n$$\\frac{\\sin\\theta_1}{\\beta_1} = \\frac{\\sin\\theta_2}{\\beta_2}$$\n\nAt the welded interface ($z=0$), two boundary conditions must be satisfied:\n$1$. Continuity of displacement: The total displacement in medium $1$ must equal the displacement in medium $2$.\n$$u_i(x,0,t) + u_r(x,0,t) = u_t(x,0,t)$$\nSubstituting the wave forms and canceling the common exponential term $\\exp[i(k_x x - \\omega t)]$ gives:\n$$A_i + A_r = A_t$$\nDividing by $A_i$ and using the definitions $R = A_r/A_i$ and $T = A_t/A_i$, we obtain the first equation:\n$$1 + R = T$$\n\n$2$. Continuity of shear traction: The shear traction $\\tau_{yz}$ must be continuous across the interface. The constitutive relation is $\\tau_{yz} = \\mu (\\partial u_y / \\partial z)$, where $\\mu = \\rho \\beta^2$ is the shear modulus.\nIn medium $1$, the total traction is $\\tau_{yz,1} = \\mu_1 \\frac{\\partial}{\\partial z}(u_i + u_r) = \\mu_1(i k_{z1} u_i - i k_{z1} u_r)$.\nIn medium $2$, the traction is $\\tau_{yz,2} = \\mu_2 \\frac{\\partial u_t}{\\partial z} = \\mu_2(i k_{z2} u_t)$.\nEquating the tractions at $z=0$:\n$$\\mu_1 k_{z1} (A_i - A_r) = \\mu_2 k_{z2} A_t$$\nSubstitute $k_{zj} = (\\omega/\\beta_j)\\cos\\theta_j$ and $\\mu_j = \\rho_j \\beta_j^2$:\n$$\\rho_1 \\beta_1^2 \\left(\\frac{\\omega}{\\beta_1}\\cos\\theta_1\\right) (A_i - A_r) = \\rho_2 \\beta_2^2 \\left(\\frac{\\omega}{\\beta_2}\\cos\\theta_2\\right) A_t$$\nThis simplifies to:\n$$(\\rho_1 \\beta_1 \\cos\\theta_1) (A_i - A_r) = (\\rho_2 \\beta_2 \\cos\\theta_2) A_t$$\nDefining the shear wave impedance $Z_j = \\rho_j \\beta_j$, the equation becomes:\n$$Z_1 \\cos\\theta_1 (A_i - A_r) = Z_2 \\cos\\theta_2 A_t$$\nDividing by $A_i$ gives the second equation:\n$$Z_1 \\cos\\theta_1 (1 - R) = Z_2 \\cos\\theta_2 T$$\n\nWe now solve the system of two equations for $R$ and $T$:\n$$1 + R = T$$\n$$Z_1 \\cos\\theta_1 (1 - R) = Z_2 \\cos\\theta_2 T$$\nSubstitute the first equation into the second:\n$$Z_1 \\cos\\theta_1 (1 - R) = Z_2 \\cos\\theta_2 (1 + R)$$\n$$Z_1 \\cos\\theta_1 - R Z_1 \\cos\\theta_1 = Z_2 \\cos\\theta_2 + R Z_2 \\cos\\theta_2$$\n$$R (Z_1 \\cos\\theta_1 + Z_2 \\cos\\theta_2) = Z_1 \\cos\\theta_1 - Z_2 \\cos\\theta_2$$\nThus, the reflection coefficient is:\n$$R = \\frac{Z_1 \\cos\\theta_1 - Z_2 \\cos\\theta_2}{Z_1 \\cos\\theta_1 + Z_2 \\cos\\theta_2}$$\nAnd the transmission coefficient is:\n$$T = 1 + R = 1 + \\frac{Z_1 \\cos\\theta_1 - Z_2 \\cos\\theta_2}{Z_1 \\cos\\theta_1 + Z_2 \\cos\\theta_2} = \\frac{2 Z_1 \\cos\\theta_1}{Z_1 \\cos\\theta_1 + Z_2 \\cos\\theta_2}$$\n\nThe problem requires the evaluation of the energy-balance expression:\n$$\\mathcal{E} \\equiv |R|^2 + \\left(\\frac{Z_2 \\cos\\theta_2}{Z_1 \\cos\\theta_1}\\right)|T|^2$$\nThis expression represents the conservation of energy flux normal to the interface. The first term is the reflection coefficient of energy flux, and the second is the transmission coefficient of energy flux. For a lossless system, their sum must be unity. We will demonstrate this analytically.\nFor convenience, let $Z'_1 = Z_1 \\cos\\theta_1$ and $Z'_2 = Z_2 \\cos\\theta_2$. The coefficients are $R = (Z'_1 - Z'_2) / (Z'_1 + Z'_2)$ and $T = 2Z'_1 / (Z'_1 + Z'_2)$. All physical parameters ($\\rho_j, \\beta_j$) are real, and as long as no total internal reflection occurs, $\\cos\\theta_2$ is real. The given parameters are $\\beta_1=250\\,\\mathrm{m/s}$, $\\beta_2=400\\,\\mathrm{m/s}$, $\\theta_1=30^{\\circ}$. Snell's law gives $\\sin\\theta_2 = (\\beta_2/\\beta_1)\\sin\\theta_1 = (400/250)\\sin(30^{\\circ}) = 1.6 \\times 0.5 = 0.8$. Since $|\\sin\\theta_2| < 1$, the angle $\\theta_2$ is real, so $R$ and $T$ are real-valued. Thus, $|R|^2 = R^2$ and $|T|^2 = T^2$.\n\nSubstituting the expressions for $R$ and $T$ into $\\mathcal{E}$:\n$$\\mathcal{E} = \\left(\\frac{Z'_1 - Z'_2}{Z'_1 + Z'_2}\\right)^2 + \\left(\\frac{Z'_2}{Z'_1}\\right)\\left(\\frac{2Z'_1}{Z'_1 + Z'_2}\\right)^2$$\n$$\\mathcal{E} = \\frac{(Z'_1 - Z'_2)^2}{(Z'_1 + Z'_2)^2} + \\frac{Z'_2}{Z'_1} \\frac{4(Z'_1)^2}{(Z'_1 + Z'_2)^2}$$\nSimplifying the second term:\n$$\\mathcal{E} = \\frac{(Z'_1)^2 - 2Z'_1Z'_2 + (Z'_2)^2}{(Z'_1 + Z'_2)^2} + \\frac{4Z'_1Z'_2}{(Z'_1 + Z'_2)^2}$$\nCombining the fractions over the common denominator:\n$$\\mathcal{E} = \\frac{(Z'_1)^2 - 2Z'_1Z'_2 + (Z'_2)^2 + 4Z'_1Z'_2}{(Z'_1 + Z'_2)^2}$$\n$$\\mathcal{E} = \\frac{(Z'_1)^2 + 2Z'_1Z'_2 + (Z'_2)^2}{(Z'_1 + Z'_2)^2}$$\nThe numerator is the expansion of $(Z'_1 + Z'_2)^2$:\n$$\\mathcal{E} = \\frac{(Z'_1 + Z'_2)^2}{(Z'_1 + Z'_2)^2} = 1$$\nThis confirms that the energy-balance expression is identically equal to $1$, reflecting the principle of conservation of energy for this lossless system. The numerical values provided in the problem are consistent with this physical principle.\n\nThe problem asks for the numerical value of $\\mathcal{E}$ rounded to four significant figures. Since $\\mathcal{E}$ is analytically $1$, its value is exactly $1$. Expressed to four significant figures, this is $1.000$.", "answer": "$$\\boxed{1.000}$$", "id": "3570860"}, {"introduction": "While analytical solutions provide essential physical insight, most real-world geomechanical problems require numerical methods like the Finite Element Method (FEM). However, discretizing the wave equation introduces numerical artifacts, most notably 'numerical dispersion,' where the simulated wave speed becomes frequency-dependent. This practice delves into the heart of computational wave mechanics by deriving the numerical dispersion relation for a simple 1D finite element model, revealing how discretization impacts accuracy and how to determine the necessary mesh resolution to trust your simulation results [@problem_id:3570882].", "problem": "Consider one-dimensional ($1$D) shear-wave propagation in a homogeneous, linear elastic soil of density $\\rho$ and shear modulus $G$. The shear-wave displacement $u(x,t)$ satisfies the second-order hyperbolic partial differential equation $\\rho\\,\\frac{\\partial^{2} u}{\\partial t^{2}} = G\\,\\frac{\\partial^{2} u}{\\partial x^{2}}$, where the shear-wave speed is $c_{s} = \\sqrt{G/\\rho}$. Discretize the spatial domain by a uniform mesh of size $h$ using the standard Galerkin Finite Element Method (FEM) with two-node linear shape functions and the consistent mass matrix. Assume an infinite, uniform mesh so that a Bloch-form traveling wave ansatz is admissible.\n\nStarting from the foregoing partial differential equation and the standard Galerkin semidiscrete formulation, derive the semi-discrete numerical dispersion relation connecting the nondimensional angular frequency $\\Omega = \\omega h / c_{s}$ and the nondimensional wavenumber $K = k h$ for a harmonic solution of the form $u_{j}(t) = U \\exp\\!\\big(i (j K - \\Omega\\, c_{s} t / h)\\big)$, where $j$ indexes the nodes. Using this dispersion relation, define the numerical phase velocity $c_{p}^{\\text{num}}(K) = \\omega/k = c_{s}\\,\\Omega/K$ and explicitly express the relative phase-velocity error $\\varepsilon_{p}(K) = c_{p}^{\\text{num}}(K)/c_{s} - 1 = \\Omega(K)/K - 1$ as a function of $K$. All angles must be treated in radians.\n\nFinally, let the number of finite elements per wavelength be $n_{e} = \\lambda / h$, so that $K = 2\\pi/n_{e}$. Determine the minimum integer $n_{e}$ such that the relative phase-velocity error satisfies $\\varepsilon_{p}(2\\pi/n_{e}) \\le 0.01$. Report the minimum integer number of elements per wavelength. No units are required for the final answer.", "solution": "The problem requires the derivation of the numerical dispersion relation for one-dimensional shear-wave propagation using the Galerkin Finite Element Method (FEM) with linear elements, and then to use this relation to find the minimum number of elements per wavelength, $n_e$, to keep the relative phase-velocity error below a specified tolerance.\n\nFirst, we validate the problem statement.\nThe problem provides the governing partial differential equation (PDE) for $1$D shear-wave propagation:\n$\\rho\\,\\frac{\\partial^{2} u}{\\partial t^{2}} = G\\,\\frac{\\partial^{2} u}{\\partial x^{2}}$\nwhere $\\rho$ is the density, $G$ is the shear modulus, and $u(x,t)$ is the shear displacement. The exact shear-wave speed is $c_{s} = \\sqrt{G/\\rho}$. The spatial domain is discretized using a uniform mesh of size $h$, and the standard Galerkin FEM with two-node linear shape functions and a consistent mass matrix is employed. An infinite mesh is assumed, admitting a Bloch-form traveling wave solution $u_{j}(t) = U \\exp\\!\\big(i (j K - \\Omega\\, c_{s} t / h)\\big)$, where $j$ is the node index, $K = k h$ is the nondimensional wavenumber, and $\\Omega = \\omega h / c_{s}$ is the nondimensional angular frequency. The task is to derive the relative phase-velocity error $\\varepsilon_{p}(K) = c_{p}^{\\text{num}}(K)/c_{s} - 1 = \\Omega(K)/K - 1$ and find the minimum integer $n_{e} = \\lambda/h = 2\\pi/K$ such that $\\varepsilon_{p}(2\\pi/n_{e}) \\le 0.01$.\n\nThe problem is scientifically grounded, based on the standard wave equation and FEM. It is well-posed, objective, and self-contained. All terms are clearly defined, and no contradictions are present. The idealization of an infinite mesh is a standard procedure for numerical dispersion analysis. The problem is therefore valid.\n\nWe begin by establishing the Galerkin weak form of the PDE. For an arbitrary test function $w(x)$, the weak form over a single finite element of length $h$ (from $x_j$ to $x_{j+1}$) is:\n$$ \\int_{x_j}^{x_{j+1}} w \\left( \\rho \\frac{\\partial^2 u}{\\partial t^2} - G \\frac{\\partial^2 u}{\\partial x^2} \\right) dx = 0 $$\nIntegrating the second term by parts yields:\n$$ \\int_{x_j}^{x_{j+1}} \\left( w \\rho \\frac{\\partial^2 u}{\\partial t^2} + \\frac{\\partial w}{\\partial x} G \\frac{\\partial u}{\\partial x} \\right) dx - \\left[ w G \\frac{\\partial u}{\\partial x} \\right]_{x_j}^{x_{j+1}} = 0 $$\nIn the Galerkin method, the displacement field $u(x,t)$ and the test function $w(x)$ are approximated using the same shape functions. For a two-node linear element, let the local coordinate be $\\zeta = (x-x_{j})/h \\in [0, 1]$. The displacement is approximated as $u(\\zeta, t) = N_j(\\zeta) u_j(t) + N_{j+1}(\\zeta) u_{j+1}(t)$, where the shape functions are $N_j(\\zeta) = 1-\\zeta$ and $N_{j+1}(\\zeta) = \\zeta$.\nIn matrix form, $u(\\zeta, t) = \\mathbf{N}(\\zeta) \\mathbf{u}_e(t)$, with $\\mathbf{N} = \\begin{pmatrix} 1-\\zeta & \\zeta \\end{pmatrix}$ and $\\mathbf{u}_e = \\begin{pmatrix} u_j(t) & u_{j+1}(t) \\end{pmatrix}^T$. The test functions are similarly chosen as $w(x) = \\mathbf{N}(\\zeta) \\mathbf{w}_e$, where $\\mathbf{w}_e$ is a vector of arbitrary nodal values.\nSubstituting these approximations into the weak form for one element gives the element equation $\\mathbf{M}_e \\ddot{\\mathbf{u}}_e + \\mathbf{K}_e \\mathbf{u}_e = \\mathbf{f}_e$, where $\\mathbf{f}_e$ represents the boundary terms from integration by parts. The element consistent mass matrix $\\mathbf{M}_e$ and stiffness matrix $\\mathbf{K}_e$ are:\n$$ \\mathbf{M}_e = \\int_{0}^{1} \\rho (\\mathbf{N}(\\zeta))^T \\mathbf{N}(\\zeta) \\, h \\, d\\zeta $$\n$$ \\mathbf{K}_e = \\int_{0}^{1} G \\left(\\frac{d\\mathbf{N}}{dx}\\right)^T \\frac{d\\mathbf{N}}{dx} \\, h \\, d\\zeta = \\int_{0}^{1} G \\left(\\frac{1}{h}\\frac{d\\mathbf{N}}{d\\zeta}\\right)^T \\left(\\frac{1}{h}\\frac{d\\mathbf{N}}{d\\zeta}\\right) \\, h \\, d\\zeta = \\frac{G}{h} \\int_{0}^{1} (\\mathbf{N}'(\\zeta))^T \\mathbf{N}'(\\zeta) \\, d\\zeta $$\nThe components of $\\mathbf{N}'(\\zeta)$ are $\\frac{dN_j}{d\\zeta}=-1$ and $\\frac{dN_{j+1}}{d\\zeta}=1$.\nComputing the integrals gives:\n$$ \\mathbf{M}_e = \\rho h \\int_0^1 \\begin{pmatrix} (1-\\zeta)^2 & \\zeta(1-\\zeta) \\\\ \\zeta(1-\\zeta) & \\zeta^2 \\end{pmatrix} d\\zeta = \\frac{\\rho h}{6} \\begin{pmatrix} 2 & 1 \\\\ 1 & 2 \\end{pmatrix} $$\n$$ \\mathbf{K}_e = \\frac{G}{h} \\int_0^1 \\begin{pmatrix} (-1)^2 & (-1)(1) \\\\ (1)(-1) & (1)^2 \\end{pmatrix} d\\zeta = \\frac{G}{h} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix} $$\nFor an infinite mesh, we assemble the equation for a generic interior node $j$ by summing contributions from the two adjacent elements (element $j-1$ spanning nodes $j-1, j$ and element $j$ spanning nodes $j, j+1$). The inter-element boundary terms cancel upon assembly. The resulting semi-discretized equation for node $j$ is:\n$$ \\frac{\\rho h}{6} (\\ddot{u}_{j-1} + 4\\ddot{u}_j + \\ddot{u}_{j+1}) + \\frac{G}{h} (-u_{j-1} + 2u_j - u_{j+1}) = 0 $$\nWe now substitute the given harmonic wave ansatz $u_j(t) = U \\exp(i(jK - \\omega t))$. The second time derivative is $\\ddot{u}_j(t) = -\\omega^2 u_j(t)$. Substituting this and the ansatz into the equation for node $j$:\n$$ -\\omega^2 \\frac{\\rho h}{6} \\left( e^{i(j-1)K} + 4e^{ijK} + e^{i(j+1)K} \\right) + \\frac{G}{h} \\left( -e^{i(j-1)K} + 2e^{ijK} - e^{i(j+1)K} \\right) = 0 $$\nDividing by the common factor $e^{ijK}$ gives:\n$$ -\\omega^2 \\frac{\\rho h}{6} (e^{-iK} + 4 + e^{iK}) + \\frac{G}{h} (-e^{-iK} + 2 - e^{iK}) = 0 $$\nUsing Euler's identity $e^{iK} + e^{-iK} = 2\\cos(K)$, the equation simplifies to:\n$$ -\\omega^2 \\frac{\\rho h}{6} (2\\cos(K) + 4) + \\frac{G}{h} (-2\\cos(K) + 2) = 0 $$\nSolving for $\\omega^2$:\n$$ \\omega^2 \\rho h (2 + \\cos(K))/3 = \\frac{2G}{h} (1 - \\cos(K)) $$\n$$ \\omega^2 = \\frac{6G}{\\rho h^2} \\frac{1 - \\cos(K)}{2 + \\cos(K)} $$\nUsing $c_s^2 = G/\\rho$, we get the numerical dispersion relation:\n$$ \\omega^2 = c_s^2 \\frac{6}{h^2} \\frac{1 - \\cos(K)}{2 + \\cos(K)} $$\nTo obtain the nondimensional form, we use $\\Omega = \\omega h / c_s$:\n$$ \\Omega^2 = \\frac{\\omega^2 h^2}{c_s^2} = \\frac{6(1-\\cos(K))}{2+\\cos(K)} $$\nThe numerical phase velocity is $c_{p}^{\\text{num}} = \\omega/k$. Using $\\omega = \\Omega c_s / h$ and $k = K/h$, we have $c_{p}^{\\text{num}} = (\\Omega c_s / h) / (K/h) = c_s \\Omega/K$.\nThe relative phase-velocity error is defined as $\\varepsilon_{p}(K) = c_{p}^{\\text{num}}/c_s - 1$:\n$$ \\varepsilon_{p}(K) = \\frac{\\Omega(K)}{K} - 1 = \\frac{1}{K} \\sqrt{\\frac{6(1-\\cos(K))}{2+\\cos(K)}} - 1 $$\nWe need to find the minimum integer $n_e$ such that $\\varepsilon_{p}(K) \\le 0.01$ for $K=2\\pi/n_e$. The inequality is:\n$$ \\frac{1}{2\\pi/n_e} \\sqrt{\\frac{6(1-\\cos(2\\pi/n_e))}{2+\\cos(2\\pi/n_e)}} - 1 \\le 0.01 $$\nLet $K = 2\\pi/n_e$. The inequality becomes $\\frac{\\Omega(K)}{K} \\le 1.01$. Squaring both sides:\n$$ \\left(\\frac{\\Omega(K)}{K}\\right)^2 = \\frac{6(1-\\cos(K))}{K^2(2+\\cos(K))} \\le (1.01)^2 = 1.0201 $$\nThe function on the left is a decreasing function of $n_e$ (or an increasing function of $K$ for small $K$). We need to find the minimum integer $n_e$ that satisfies the condition. We can test integer values of $n_e$.\nFor a Taylor series expansion of $\\varepsilon_{p}(K)$ around $K=0$, we find $\\varepsilon_{p}(K) \\approx K^2/24$. An estimate for $n_e$ is found by solving $(2\\pi/n_e)^2/24 \\approx 0.01$, which gives $n_e \\approx \\sqrt{(2\\pi)^2/(0.24)} \\approx 12.8$. This suggests the answer is likely $13$.\n\nLet's test $n_e=12$:\n$K = 2\\pi/12 = \\pi/6$.\n$\\cos(\\pi/6) = \\sqrt{3}/2$.\n$$ \\varepsilon_p(\\pi/6) = \\frac{6}{\\pi} \\sqrt{\\frac{6(1-\\sqrt{3}/2)}{2+\\sqrt{3}/2}} - 1 = \\frac{6}{\\pi} \\sqrt{\\frac{6(2-\\sqrt{3})}{4+\\sqrt{3}}} - 1 $$\nNumerically, $\\sqrt{3} \\approx 1.73205$, $\\pi \\approx 3.14159$.\n$$ \\varepsilon_p(\\pi/6) \\approx \\frac{6}{3.14159} \\sqrt{\\frac{6(2-1.73205)}{4+1.73205}} - 1 \\approx 1.90986 \\sqrt{\\frac{1.6077}{5.73205}} - 1 $$\n$$ \\varepsilon_p(\\pi/6) \\approx 1.90986 \\sqrt{0.28048} - 1 \\approx 1.90986 \\times 0.5296 - 1 \\approx 1.0113 - 1 = 0.0113 $$\nSince $0.0113 > 0.01$, $n_e=12$ is insufficient.\n\nLet's test $n_e=13$:\n$K=2\\pi/13$. We need to compute $\\varepsilon_p(2\\pi/13) = \\frac{13}{2\\pi} \\sqrt{\\frac{6(1-\\cos(2\\pi/13))}{2+\\cos(2\\pi/13)}} - 1$.\n$2\\pi/13 \\approx 0.483307$ radians.\n$\\cos(2\\pi/13) \\approx 0.885451$.\n$$ \\varepsilon_p(2\\pi/13) \\approx \\frac{13}{2 \\times 3.14159} \\sqrt{\\frac{6(1 - 0.885451)}{2 + 0.885451}} - 1 \\approx 2.0690 \\sqrt{\\frac{6(0.114549)}{2.885451}} - 1 $$\n$$ \\varepsilon_p(2\\pi/13) \\approx 2.0690 \\sqrt{\\frac{0.687294}{2.885451}} - 1 \\approx 2.0690 \\sqrt{0.23819} - 1 $$\n$$ \\varepsilon_p(2\\pi/13) \\approx 2.0690 \\times 0.48805 - 1 \\approx 1.0097 - 1 = 0.0097 $$\nSince $0.0097 \\le 0.01$, $n_e=13$ is sufficient.\nAs the error decreases with increasing $n_e$, the minimum integer number of elements per wavelength is $13$.", "answer": "$$ \\boxed{13} $$", "id": "3570882"}, {"introduction": "Building on fundamental wave physics and an awareness of numerical artifacts, we can now tackle complex, evolving systems. This advanced practice simulates a time-lapse geophysical survey by coupling a chemical precipitation model with viscoelastic wave propagation to monitor soil stiffening due to cementation. You will explore how changes in the soil's microstructure over time alter its macroscopic wave response, providing a powerful example of how computational geomechanics is used to model and interpret dynamic subsurface processes [@problem_id:3570852].", "problem": "Consider a one-dimensional plane-wave propagation problem in an isotropic soil undergoing time-lapse stiffening due to reactive cementation. The soil skeleton is modeled as a linear viscoelastic Kelvin–Voigt solid with separate volumetric and shear viscosities. Cementation increases stiffness over time through precipitation. The goal is to couple a precipitation kinetics model that alters the bulk modulus and shear modulus and quantify how the resulting time-lapse stiffness increase changes wave dispersion over a time window of several weeks.\n\nFundamental base:\n- Conservation of linear momentum: for small strains and an isotropic medium, the balance of linear momentum for displacement fields is governed by the relation between stress and strain-rate and the inertial term.\n- Kelvin–Voigt linear viscoelasticity: stress responds to strain and strain-rate through elastic moduli and viscosities. Let the bulk modulus be denoted by $K$ and the shear modulus by $G$. Introduce volumetric viscosity $\\eta_{b}$ and shear viscosity $\\eta_{s}$, such that both longitudinal (compressional) and transverse (shear) waves exhibit frequency-dependent behavior and attenuation.\n- Plane wave ansatz: consider harmonic plane waves of angular frequency $\\omega$ and wavenumber $k$, with displacement fields varying as $e^{i(\\omega t - k x)}$.\n\nCementation kinetics and stiffness mapping:\n- Define a scalar cementation state variable $c(t)$ that evolves according to first-order precipitation kinetics\n$$\\frac{dc}{dt} = k_{p}\\left(c_{\\mathrm{sat}} - c\\right),$$\nwith initial condition $c(0) = c_{0}$, precipitation rate constant $k_{p}$, and saturation level $c_{\\mathrm{sat}}$. This is a widely used and physically reasonable saturation kinetics law in reactive transport and cementation at the scale of weeks.\n- Map the evolving cementation to the bulk and shear moduli as\n$$K(t) = K_{0} + \\Delta K_{\\max}\\left(\\frac{c(t)}{c_{\\mathrm{sat}}}\\right)^{m_{K}}, \\quad G(t) = G_{0} + \\Delta G_{\\max}\\left(\\frac{c(t)}{c_{\\mathrm{sat}}}\\right)^{m_{G}},$$\nwhere $K_{0}$ and $G_{0}$ are initial moduli, $\\Delta K_{\\max}$ and $\\Delta G_{\\max}$ are maximum increases attainable at full saturation, and $m_{K}$, $m_{G}$ are nonlinearity exponents controlling the sensitivity to $c(t)$.\n\nWave quantities to compute:\n- Use angular frequency $\\omega = 2\\pi f$, where $f$ is frequency in hertz.\n- Given density $\\rho$, volumetric viscosity $\\eta_{b}$, and shear viscosity $\\eta_{s}$, compute the complex moduli relevant to longitudinal and transverse waves and use the plane-wave dispersion relations derived from the Kelvin–Voigt constitutive model and linear momentum balance to obtain the complex wavenumbers and the corresponding phase velocities. From these, define a dispersion metric at time $t$ that compares phase velocities at a high frequency $f_{\\mathrm{hi}}$ and a low frequency $f_{\\mathrm{lo}}$:\n$$D_{S}(t) = \\frac{v_{S}(f_{\\mathrm{hi}}, t)}{v_{S}(f_{\\mathrm{lo}}, t)} - 1, \\quad D_{P}(t) = \\frac{v_{P}(f_{\\mathrm{hi}}, t)}{v_{P}(f_{\\mathrm{lo}}, t)} - 1.$$\nThese $D_{S}$ and $D_{P}$ are dimensionless decimal quantities.\n\nTasks:\n- Starting from the conservation of linear momentum and the Kelvin–Voigt constitutive equations for an isotropic material, derive the plane-wave dispersion relations for shear and compressional waves, and use them to compute the phase velocities $v_{S}(f,t)$ and $v_{P}(f,t)$ as functions of frequency and time.\n- Solve the precipitation kinetics to obtain $c(t)$ and thus $K(t)$ and $G(t)$ over the time window of interest.\n- Using the above, compute $D_{S}(0)$, $D_{S}(T)$, $D_{P}(0)$, and $D_{P}(T)$ for a specified duration $T$ (in weeks). Report the changes $\\Delta D_{S} = D_{S}(T) - D_{S}(0)$ and $\\Delta D_{P} = D_{P}(T) - D_{P}(0)$.\n\nUnits and numerical specifications:\n- Moduli $K$ and $G$ are in pascals ($\\mathrm{Pa}$).\n- Density $\\rho$ is in kilograms per cubic meter ($\\mathrm{kg/m^{3}}$).\n- Viscosities $\\eta_{b}$ and $\\eta_{s}$ are in pascal-second ($\\mathrm{Pa\\cdot s}$).\n- Frequency $f$ is in hertz ($\\mathrm{Hz}$), and angular frequency $\\omega$ is in radians per second.\n- Time is specified in weeks and must be converted to seconds with $1$ week $=$ $604800$ seconds.\n- The dispersion metrics $D_{S}$ and $D_{P}$ must be expressed as decimal numbers without a percentage sign, rounded to six decimal places.\n\nTest suite:\nUse the following four scientifically plausible test cases, each defined by a parameter tuple\n$\\left(K_{0}, G_{0}, \\Delta K_{\\max}, \\Delta G_{\\max}, m_{K}, m_{G}, c_{0}, c_{\\mathrm{sat}}, k_{p}, \\rho, \\eta_{s}, \\eta_{b}, T, f_{\\mathrm{lo}}, f_{\\mathrm{hi}}\\right)$ with specified units as above and $T$ in weeks:\n\n- Case $1$ (happy path, moderate precipitation and viscosities):\n$\\left(5.0\\times 10^{7}, 3.0\\times 10^{7}, 3.0\\times 10^{7}, 2.0\\times 10^{7}, 1.0, 1.0, 0.1, 1.0, 1.5\\times 10^{-6}, 2000.0, 1.0\\times 10^{8}, 5.0\\times 10^{8}, 4, 10, 500\\right)$.\n\n- Case $2$ (boundary, no precipitation):\n$\\left(5.0\\times 10^{7}, 3.0\\times 10^{7}, 3.0\\times 10^{7}, 2.0\\times 10^{7}, 1.0, 1.0, 0.1, 1.0, 0.0, 2000.0, 1.0\\times 10^{8}, 5.0\\times 10^{8}, 4, 10, 500\\right)$.\n\n- Case $3$ (fast precipitation, stronger nonlinearity, lighter soil, higher viscosities):\n$\\left(5.0\\times 10^{7}, 2.0\\times 10^{7}, 7.0\\times 10^{7}, 6.0\\times 10^{7}, 2.0, 2.0, 0.05, 0.8, 4.0\\times 10^{-6}, 1800.0, 2.0\\times 10^{8}, 1.0\\times 10^{9}, 4, 10, 500\\right)$.\n\n- Case $4$ (edge, very high viscosities):\n$\\left(5.0\\times 10^{7}, 3.0\\times 10^{7}, 3.0\\times 10^{7}, 2.0\\times 10^{7}, 1.0, 1.0, 0.1, 1.0, 1.5\\times 10^{-6}, 2000.0, 1.0\\times 10^{10}, 1.0\\times 10^{11}, 4, 10, 500\\right)$.\n\nProgram requirements:\n- Implement the cementation kinetics and Kelvin–Voigt plane-wave dispersion relations to compute the phase velocities $v_{S}(f,t)$ and $v_{P}(f,t)$ at $t = 0$ and $t = T$ weeks for $f_{\\mathrm{lo}} = 10$ and $f_{\\mathrm{hi}} = 500$.\n- For each case, output a pair of floats $\\left[\\Delta D_{S}, \\Delta D_{P}\\right]$ rounded to six decimal places, where $\\Delta D_{S} = D_{S}(T) - D_{S}(0)$ and $\\Delta D_{P} = D_{P}(T) - D_{P}(0)$.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list of the four case results, each enclosed in square brackets, with no spaces, for example $\\left[[a_{1},b_{1}],[a_{2},b_{2}],[a_{3},b_{3}],[a_{4},b_{4}]\\right]$, where $a_{i}$ and $b_{i}$ are the rounded decimals defined above. Ensure the printed line has exactly this bracketed and comma-separated format.", "solution": "The problem is found to be valid as it is scientifically grounded in the principles of continuum mechanics and wave physics, is well-posed with a complete set of parameters and clear objectives, and is formulated objectively without ambiguity. We may, therefore, proceed with a formal solution.\n\nThe solution is developed in three stages. First, we solve the precipitation kinetics to describe the time-evolution of the soil's elastic moduli. Second, we derive the dispersion relations for viscoelastic plane waves. Third, we combine these results to compute the required dispersion metrics.\n\n**1. Cementation Kinetics and Stiffness Evolution**\n\nThe state of cementation is described by a scalar variable $c(t)$, which evolves according to the first-order rate law:\n$$\n\\frac{dc}{dt} = k_{p}(c_{\\mathrm{sat}} - c)\n$$\nwith the initial condition $c(0) = c_{0}$. This is a separable first-order linear ordinary differential equation. We can solve it by rearranging and integrating:\n$$\n\\int_{c_0}^{c(t)} \\frac{dc'}{c_{\\mathrm{sat}} - c'} = \\int_0^t k_p dt'\n$$\nThis yields:\n$$\n-\\ln\\left(\\frac{c_{\\mathrm{sat}} - c(t)}{c_{\\mathrm{sat}} - c_{0}}\\right) = k_p t\n$$\nSolving for $c(t)$, we obtain the explicit time evolution of the cementation state:\n$$\nc(t) = c_{\\mathrm{sat}} - (c_{\\mathrm{sat}} - c_{0}) e^{-k_p t}\n$$\nThis function, $c(t)$, dictates the time-dependent stiffening of the soil. The bulk modulus $K(t)$ and shear modulus $G(t)$ are given by the provided power-law mappings:\n$$\nK(t) = K_{0} + \\Delta K_{\\max}\\left(\\frac{c(t)}{c_{\\mathrm{sat}}}\\right)^{m_{K}}\n$$\n$$\nG(t) = G_{0} + \\Delta G_{\\max}\\left(\\frac{c(t)}{c_{\\mathrm{sat}}}\\right)^{m_{G}}\n$$\nThese equations are valid under the assumption that $c_{\\mathrm{sat}} > 0$, which holds for all test cases.\n\n**2. Plane Wave Dispersion in a Kelvin-Voigt Medium**\n\nThe constitutive equation for a linear, isotropic Kelvin-Voigt solid relates stress $\\boldsymbol{\\sigma}$ to strain $\\boldsymbol{\\varepsilon}$ and strain-rate $\\dot{\\boldsymbol{\\varepsilon}}$:\n$$\n\\boldsymbol{\\sigma} = K(\\nabla \\cdot \\mathbf{u})\\mathbf{I} + 2G\\boldsymbol{\\varepsilon}^{\\text{dev}} + \\eta_b(\\nabla \\cdot \\dot{\\mathbf{u}})\\mathbf{I} + 2\\eta_s\\dot{\\boldsymbol{\\varepsilon}}^{\\text{dev}}\n$$\nwhere $\\mathbf{u}$ is the displacement vector, $\\mathbf{I}$ is the identity tensor, and $\\boldsymbol{\\varepsilon}^{\\text{dev}}$ is the deviatoric part of the strain tensor. For a harmonic plane wave, the displacement has the form $\\mathbf{u} = \\mathbf{U}_0 e^{i(\\omega t - \\mathbf{k} \\cdot \\mathbf{x})}$, where $\\omega$ is the angular frequency and $\\mathbf{k}$ is the wave vector. For such waves, the time derivative operator $\\frac{\\partial}{\\partial t}$ is equivalent to multiplication by $i\\omega$. The constitutive law can be simplified by defining complex, frequency-dependent moduli:\n$$\nK^*(\\omega, t) = K(t) + i\\omega\\eta_b\n$$\n$$\nG^*(\\omega, t) = G(t) + i\\omega\\eta_s\n$$\nThe conservation of linear momentum, neglecting body forces, is $\\nabla \\cdot \\boldsymbol{\\sigma} = \\rho \\frac{\\partial^2 \\mathbf{u}}{\\partial t^2}$. Substituting the complex modulus form of the constitutive law into the momentum equation leads to the wave equation. For a plane wave propagating along the $x$-axis, this equation can be decomposed for longitudinal (P-wave) and transverse (S-wave) motion.\n\n**For S-waves (transverse motion):**\nThe governing equation is:\n$$\nG^*(\\omega, t) \\frac{\\partial^2 u_y}{\\partial x^2} = \\rho \\frac{\\partial^2 u_y}{\\partial t^2}\n$$\nSubstituting the plane wave ansatz $u_y(x,t) = U_y e^{i(\\omega t - k_S x)}$ yields the dispersion relation:\n$$\nG^*(\\omega, t) (-k_S^2) = \\rho (-\\omega^2)\n$$\n$$\nk_S^2(\\omega, t) = \\frac{\\rho \\omega^2}{G^*(\\omega, t)} = \\frac{\\rho \\omega^2}{G(t) + i\\omega\\eta_s}\n$$\n\n**For P-waves (longitudinal motion):**\nThe governing equation involves the longitudinal modulus $M^* = K^* + \\frac{4}{3}G^*$:\n$$\nM^*(\\omega, t) \\frac{\\partial^2 u_x}{\\partial x^2} = \\rho \\frac{\\partial^2 u_x}{\\partial t^2}\n$$\nSubstituting the plane wave ansatz $u_x(x,t) = U_x e^{i(\\omega t - k_P x)}$ yields the dispersion relation:\n$$\nM^*(\\omega, t) (-k_P^2) = \\rho (-\\omega^2)\n$$\n$$\nk_P^2(\\omega, t) = \\frac{\\rho \\omega^2}{M^*(\\omega, t)} = \\frac{\\rho \\omega^2}{K(t) + \\frac{4}{3}G(t) + i\\omega(\\eta_b + \\frac{4}{3}\\eta_s)}\n$$\n\n**3. Phase Velocity Calculation**\n\nThe phase velocity $v$ is defined as $v = \\omega / \\text{Re}(k)$, where $k$ is the complex wavenumber. Let's find a general expression for $\\text{Re}(k)$ from $k^2 = \\rho\\omega^2 / M_{complex}$, where $M_{complex} = M_{real} + iM_{imag}$.\n$$\nk = \\omega \\sqrt{\\frac{\\rho}{M_{real} + iM_{imag}}} = \\omega\\sqrt{\\rho} \\left( \\frac{M_{real} - iM_{imag}}{M_{real}^2 + M_{imag}^2} \\right)^{1/2}\n$$\nBy converting the complex number in the parentheses to polar form and taking the square root, we find the real part of $k$ to be:\n$$\n\\text{Re}(k) = \\omega \\sqrt{\\frac{\\rho \\left(\\sqrt{M_{real}^2 + M_{imag}^2} + M_{real}\\right)}{2(M_{real}^2 + M_{imag}^2)}}\n$$\nThe phase velocity is therefore:\n$$\nv = \\frac{\\omega}{\\text{Re}(k)} = \\sqrt{\\frac{2 \\left(M_{real}^2 + M_{imag}^2\\right)}{\\rho \\left(\\sqrt{M_{real}^2 + M_{imag}^2} + M_{real}\\right)}}\n$$\nThis general formula allows us to compute the phase velocities for both S- and P-waves by substituting the appropriate real and imaginary parts of the relevant complex modulus.\n\nFor S-waves:\n$M_{real,S}(t) = G(t)$\n$M_{imag,S}(\\omega) = \\omega\\eta_s$\n$v_S(f,t) = \\sqrt{\\frac{2(G(t)^2 + (\\omega\\eta_s)^2)}{\\rho(\\sqrt{G(t)^2 + (\\omega\\eta_s)^2} + G(t))}}$, with $\\omega=2\\pi f$.\n\nFor P-waves:\n$M_{real,P}(t) = K(t) + \\frac{4}{3}G(t)$\n$M_{imag,P}(\\omega) = \\omega(\\eta_b + \\frac{4}{3}\\eta_s)$\n$v_P(f,t) = \\sqrt{\\frac{2(M_{real,P}(t)^2 + M_{imag,P}(\\omega)^2)}{\\rho(\\sqrt{M_{real,P}(t)^2 + M_{imag,P}(\\omega)^2} + M_{real,P}(t))}}$, with $\\omega=2\\pi f$.\n\n**Computational Procedure**\n\nFor each test case, we perform the following steps:\n1.  Convert the duration $T$ from weeks to seconds: $T_{sec} = T \\times 604800$.\n2.  Calculate the dispersion metrics $D_S(0)$ and $D_P(0)$ at time $t=0$. This involves computing $K(0)$ and $G(0)$, then calculating $v_S$ and $v_P$ at frequencies $f_{lo}$ and $f_{hi}$.\n3.  Calculate the dispersion metrics $D_S(T)$ and $D_P(T)$ at time $t=T_{sec}$. This involves computing $c(T_{sec})$, then $K(T_{sec})$ and $G(T_{sec})$, and subsequently the phase velocities.\n4.  Compute the changes $\\Delta D_S = D_S(T) - D_S(0)$ and $\\Delta D_P = D_P(T) - D_P(0)$.\n5.  The results are rounded to six decimal places as required. The implementation is provided in the final answer.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the wave propagation problem for all test cases.\n    \"\"\"\n    \n    # Conversion factor from weeks to seconds\n    WEEKS_TO_SECONDS = 604800.0\n\n    test_cases = [\n        # Case 1 (happy path)\n        (5.0e7, 3.0e7, 3.0e7, 2.0e7, 1.0, 1.0, 0.1, 1.0, 1.5e-6, 2000.0, 1.0e8, 5.0e8, 4, 10, 500),\n        # Case 2 (no precipitation)\n        (5.0e7, 3.0e7, 3.0e7, 2.0e7, 1.0, 1.0, 0.1, 1.0, 0.0, 2000.0, 1.0e8, 5.0e8, 4, 10, 500),\n        # Case 3 (fast precipitation, nonlinear)\n        (5.0e7, 2.0e7, 7.0e7, 6.0e7, 2.0, 2.0, 0.05, 0.8, 4.0e-6, 1800.0, 2.0e8, 1.0e9, 4, 10, 500),\n        # Case 4 (very high viscosities)\n        (5.0e7, 3.0e7, 3.0e7, 2.0e7, 1.0, 1.0, 0.1, 1.0, 1.5e-6, 2000.0, 1.0e10, 1.0e11, 4, 10, 500),\n    ]\n\n    def get_phase_velocity(omega, m_real, m_imag_comp, rho):\n        \"\"\"\n        Calculates phase velocity based on the derived general formula.\n        m_imag_comp = M_imag / omega\n        \"\"\"\n        m_imag = omega * m_imag_comp\n        m_real_sq = m_real**2\n        m_imag_sq = m_imag**2\n        \n        numerator = 2 * (m_real_sq + m_imag_sq)\n        denominator = rho * (np.sqrt(m_real_sq + m_imag_sq) + m_real)\n        \n        # Handle potential division by zero if denominator is zero (e.g. rho=0).\n        if denominator == 0:\n            return 0.0\n            \n        return np.sqrt(numerator / denominator)\n\n    def get_dispersion_metrics_at_time(t, params):\n        \"\"\"\n        Computes the dispersion metrics D_S and D_P at a specific time t.\n        \"\"\"\n        k0, g0, dk_max, dg_max, mk, mg, c0, csat, kp, rho, eta_s, eta_b, _, f_lo, f_hi = params\n\n        # 1. Calculate cementation state c(t)\n        if kp == 0:\n            c_t = c0\n        else:\n            c_t = csat - (csat - c0) * np.exp(-kp * t)\n        \n        # 2. Calculate time-dependent moduli K(t) and G(t)\n        # Handle the case where csat might be 0, though not in test data.\n        c_ratio = c_t / csat if csat != 0 else 0.0\n        k_t = k0 + dk_max * (c_ratio ** mk)\n        g_t = g0 + dg_max * (c_ratio ** mg)\n\n        omega_lo = 2 * np.pi * f_lo\n        omega_hi = 2 * np.pi * f_hi\n        \n        # 3. S-wave calculations\n        m_real_s = g_t\n        m_imag_per_omega_s = eta_s\n        v_s_lo = get_phase_velocity(omega_lo, m_real_s, m_imag_per_omega_s, rho)\n        v_s_hi = get_phase_velocity(omega_hi, m_real_s, m_imag_per_omega_s, rho)\n        \n        ds = (v_s_hi / v_s_lo - 1) if v_s_lo != 0 else 0.0\n\n        # 4. P-wave calculations\n        m_real_p = k_t + (4/3) * g_t\n        m_imag_per_omega_p = eta_b + (4/3) * eta_s\n        v_p_lo = get_phase_velocity(omega_lo, m_real_p, m_imag_per_omega_p, rho)\n        v_p_hi = get_phase_velocity(omega_hi, m_real_p, m_imag_per_omega_p, rho)\n\n        dp = (v_p_hi / v_p_lo - 1) if v_p_lo != 0 else 0.0\n\n        return ds, dp\n\n    results = []\n    for case in test_cases:\n        T_weeks = case[12]\n        T_sec = T_weeks * WEEKS_TO_SECONDS\n\n        ds_0, dp_0 = get_dispersion_metrics_at_time(0.0, case)\n        ds_T, dp_T = get_dispersion_metrics_at_time(T_sec, case)\n\n        delta_ds = ds_T - ds_0\n        delta_dp = dp_T - dp_0\n        \n        results.append([delta_ds, delta_dp])\n\n    # Format output string exactly as required, with rounding to 6 decimal places.\n    formatted_results = [f\"[{res[0]:.6f},{res[1]:.6f}]\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n\n```", "id": "3570852"}]}