{"hands_on_practices": [{"introduction": "The Zeldovich approximation elegantly separates the evolution of cosmic structure into a time-dependent universal growth factor, $D(a)$, and a time-independent spatial displacement field, $\\boldsymbol{s}(\\boldsymbol{q})$. This exercise focuses on the temporal component, the engine driving the growth of structure. By starting from the fundamental equations governing a $\\Lambda$CDM universe, you will derive and numerically compute the linear growth factor, gaining hands-on experience with the dynamics of cosmic expansion and gravitational instability that underpin the entire model [@problem_id:3500913].", "problem": "Consider the use of the Zel'dovich approximation in numerical cosmology, where the comoving displacement field is proportional to the linear growth factor $D(a)$ of density perturbations, with $a$ denoting the cosmic scale factor. Starting from first principles appropriate to a spatially flat Lambda Cold Dark Matter (ΛCDM) cosmology, derive and implement a numerical computation of the normalized linear growth factor $D(a)$ as follows.\n\nBegin with the background dynamics described by the Friedmann equation for a spatially flat universe, the matter density scaling, and the linear perturbation growth equation:\n- The Hubble parameter $H(a)$ satisfies $H^{2}(a) = H_{0}^{2}\\left[\\Omega_{m0} a^{-3} + \\Omega_{\\Lambda 0}\\right]$ with $\\Omega_{\\Lambda 0} = 1 - \\Omega_{m0}$.\n- The matter density obeys $\\rho_{m}(a) = \\rho_{m0} a^{-3}$.\n- The linear growth factor $D(a)$ evolves according to the second-order ordinary differential equation in cosmic time $t$:\n$$\\frac{d^{2}D}{dt^{2}} + 2 H(a) \\frac{dD}{dt} - 4\\pi G \\rho_{m}(a) D = 0.$$\n\nYour tasks are:\n1. Derive an integral representation for the growing-mode solution $D(a)$ up to an overall multiplicative constant by transforming the differential equation from derivatives with respect to $t$ to derivatives with respect to $a$, identifying one decaying-mode solution, and constructing the growing-mode solution via reduction of order.\n2. Using the derived integral representation, implement a numerical algorithm to compute a dimensionless, normalized growth factor $\\tilde{D}(a)$ such that $\\tilde{D}(1) = 1$. You must explicitly avoid any dependence on the absolute value of $H_{0}$ (the Hubble constant today) by working with the dimensionless Hubble function $E(a) \\equiv H(a)/H_{0}$.\n3. Ensure numerical robustness near the lower integration limit by handling the integrable singular behavior as $a' \\to 0$ in a scientifically sound manner.\n\nAll quantities in this problem are dimensionless, so no physical units appear in the final answer. Angles are not involved. The final numerical outputs must be dimensionless floating-point numbers.\n\nTest Suite:\nCompute $\\tilde{D}(a)$ for the following parameter sets $(\\Omega_{m0}, a)$:\n- $(0.3, 0.5)$\n- $(0.3, 1.0)$\n- $(0.3, 2.0)$\n- $(1.0, 0.1)$\n- $(1.0, 1.0)$\n- $(1.0, 2.0)$\n- $(0.99, 0.01)$\n- $(0.01, 0.5)$\n\nYou must implement a program that evaluates $\\tilde{D}(a)$ for each test case and produces a single line of output containing the results as a comma-separated list enclosed in square brackets (for example, \"[result1,result2,...]\"). Each list element must be a floating-point number.\n\nYour program must be self-contained, require no input, and use a numerically stable quadrature method. The final answers should be floats and dimensionless.", "solution": "The user-provided problem is assessed to be **valid**. It is a scientifically sound, well-posed, and complete problem in physical cosmology that requires both analytical derivation and numerical implementation. The problem statement is grounded in the standard $\\Lambda$CDM cosmological model and asks for the computation of a fundamental quantity, the linear growth factor, using established mathematical techniques.\n\n### Derivation of the Linear Growth Factor\n\nThe objective is to find the growing-mode solution to the linear perturbation growth equation and implement its numerical computation. The derivation proceeds in four steps: transforming the differential equation, identifying a known solution, constructing the second solution via reduction of order, and formulating a normalized, dimensionless expression suitable for numerical work.\n\n#### Step 1: Transformation of the Governing Equation\nThe evolution of the linear growth factor $D$ is described by the second-order ordinary differential equation (ODE) in cosmic time $t$:\n$$\n\\frac{d^{2}D}{dt^{2}} + 2 H(a) \\frac{dD}{dt} - 4\\pi G \\rho_{m}(a) D = 0.\n$$\nHere, $a$ is the cosmic scale factor, $H(a) = \\dot{a}/a$ is the Hubble parameter, $G$ is the gravitational constant, and $\\rho_m(a)$ is the background matter density. To solve this, we transform the independent variable from $t$ to $a$. Using the chain rule, the time derivatives are:\n$$\n\\frac{d}{dt} = \\frac{da}{dt} \\frac{d}{da} = \\dot{a} \\frac{d}{da} = a H(a) \\frac{d}{da}.\n$$\n$$\n\\frac{d^2}{dt^2} = (aH) \\frac{d}{da} \\left( aH \\frac{d}{da} \\right) = aH \\left( H + a \\frac{dH}{da} \\right) \\frac{d}{da} + (aH)^2 \\frac{d^2}{da^2}.\n$$\nSubstituting these into the ODE yields:\n$$\n(aH)^2 \\frac{d^2D}{da^2} + \\left( aH^2 + a^2 H \\frac{dH}{da} \\right) \\frac{dD}{da} + 2H(a) \\left( aH \\frac{dD}{da} \\right) - 4\\pi G \\rho_m(a) D = 0.\n$$\nThis simplifies to:\n$$\n\\frac{d^2D}{da^2} + \\left( \\frac{1}{a} + \\frac{1}{H} \\frac{dH}{da} + \\frac{2}{a} \\right) \\frac{dD}{da} - \\frac{4\\pi G \\rho_m(a)}{a^2 H(a)^2} D = 0.\n$$\nFor a flat $\\Lambda$CDM universe, the Friedmann equation is $H^2(a) = H_0^2 \\left[ \\Omega_{m0} a^{-3} + (1-\\Omega_{m0}) \\right]$. Also, the critical density today is $\\rho_{c0} = 3H_0^2 / (8\\pi G)$, and $\\rho_m(a) = \\rho_{m0} a^{-3} = \\Omega_{m0} \\rho_{c0} a^{-3}$. Using these relations, the coefficient of $D$ becomes:\n$$\n\\frac{4\\pi G \\rho_m(a)}{a^2 H(a)^2} = \\frac{4\\pi G (\\Omega_{m0} \\frac{3H_0^2}{8\\pi G} a^{-3})}{a^2 H(a)^2} = \\frac{3}{2a^2} \\frac{H_0^2 \\Omega_{m0} a^{-3}}{H(a)^2} = \\frac{3}{2a^2} \\Omega_m(a),\n$$\nwhere $\\Omega_m(a) = \\frac{\\Omega_{m0} a^{-3}}{H(a)^2/H_0^2}$ is the matter density parameter at scale factor $a$. The transformed ODE is:\n$$\n\\frac{d^2D}{da^2} + \\left( \\frac{3}{a} + \\frac{1}{H}\\frac{dH}{da} \\right) \\frac{dD}{da} - \\frac{3}{2a^2} \\Omega_m(a) D = 0.\n$$\n\n#### Step 2: Solution by Reduction of Order\nThis is a second-order linear homogeneous ODE. If one solution, $D_1(a)$, is known, a second linearly independent solution, $D_2(a)$, can be found using reduction of order. A known solution to the original ODE in time is the decaying mode, which can be shown to be $D_1(t) \\propto H(a(t))$. Thus, we take $D_1(a) = H(a)$ as one solution.\n\nWith one solution $D_1(a) = H(a)$, the second solution is given by the formula:\n$$\nD_2(a) = D_1(a) \\int^a \\frac{W(a')}{D_1(a')^2} da',\n$$\nwhere the Wronskian, $W(a')$, satisfies Abel's identity. For an ODE of the form $y'' + P(x)y' + Q(x)y = 0$, the Wronskian is $W(x) \\propto \\exp(-\\int P(x) dx)$. In our case, $P(a) = \\frac{3}{a} + \\frac{1}{H}\\frac{dH}{da}$.\n$$\n\\int P(a) da = \\int \\left( \\frac{3}{a} + \\frac{H'(a)}{H(a)} \\right) da = 3\\ln(a) + \\ln(H(a)) = \\ln(a^3 H(a)).\n$$\nSo, the Wronskian is $W(a) \\propto \\exp(-\\ln(a^3 H(a))) = \\frac{1}{a^3 H(a)}$. Substituting $D_1 = H$ and the Wronskian into the formula for $D_2$:\n$$\nD_2(a) \\propto H(a) \\int_0^a \\frac{1/(a'^3 H(a'))}{H(a')^2} da' = H(a) \\int_0^a \\frac{da'}{a'^3 H(a')^3}.\n$$\nThe general solution is a linear combination of the decaying mode ($D_1 \\propto H(a)$) and the growing mode ($D_2$). The growing mode solution is thus:\n$$\nD_+(a) = C \\cdot H(a) \\int_0^a \\frac{da'}{a'^3 H(a')^3},\n$$\nwhere $C$ is an arbitrary constant.\n\n#### Step 3: Numerical Formulation\nTo implement a numerical solution, we make the expression dimensionless and independent of $H_0$. We define the dimensionless Hubble function $E(a) = H(a)/H_0 = \\sqrt{\\Omega_{m0} a^{-3} + (1-\\Omega_{m0})}$. Substituting $H(a) = H_0 E(a)$ into the expression for $D_+(a)$:\n$$\nD_+(a) = C \\cdot (H_0 E(a)) \\int_0^a \\frac{da'}{a'^3 (H_0 E(a'))^3} = C \\frac{H_0}{H_0^3} E(a) \\int_0^a \\frac{da'}{a'^3 E(a')^3}.\n$$\nThe factors of $H_0$ can be absorbed into a new constant, yielding an unnormalized growth factor $D_{un}(a)$:\n$$\nD_{un}(a) = E(a) \\int_0^a \\frac{da'}{a'^3 E(a')^3}.\n$$\nThe problem requires a normalized growth factor $\\tilde{D}(a)$ such that $\\tilde{D}(1)=1$. This is achieved by dividing by the value of the unnormalized function at $a=1$:\n$$\n\\tilde{D}(a) = \\frac{D_{un}(a)}{D_{un}(1)} = \\frac{E(a) \\int_0^a \\frac{da'}{a'^3 E(a')^3}}{E(1) \\int_0^1 \\frac{da'}{a'^3 E(a')^3}}.\n$$\nThis is the final expression to be computed.\n\n#### Step 4: Handling the Integrand at Small Scale Factors\nThe problem states to handle the integrable singular behavior near $a' \\to 0$. The integrand is $I(a') = 1/(a'^3 E(a')^3)$. Naively evaluating this for very small $a'$ can cause numerical overflow because $E(a') \\propto a'^{-3/2}$, leading to terms like $a'^{-9/2}$. To create a numerically stable form, we rewrite the integrand:\n$$\nE(a')^2 = \\Omega_{m0} a'^{-3} + \\Omega_{\\Lambda 0} = a'^{-3}(\\Omega_{m0} + \\Omega_{\\Lambda 0} a'^3).\n$$\nSo, $E(a')^3 = a'^{-9/2}(\\Omega_{m0} + \\Omega_{\\Lambda 0} a'^3)^{3/2}$. The integrand becomes:\n$$\nI(a') = \\frac{1}{a'^3 \\left[ a'^{-9/2}(\\Omega_{m0} + \\Omega_{\\Lambda 0} a'^3)^{3/2} \\right]} = \\frac{a'^{-3} a'^{9/2}}{(\\Omega_{m0} + \\Omega_{\\Lambda 0} a'^3)^{3/2}} = \\frac{a'^{3/2}}{(\\Omega_{m0} + \\Omega_{\\Lambda 0} a'^3)^{3/2}}.\n$$\nThis rewritten form is numerically robust. As $a' \\to 0$, the numerator goes to $0$ and the denominator approaches $\\Omega_{m0}^{3/2}$ (for $\\Omega_{m0} > 0$), so the integrand itself goes to $0$. This avoids any floating-point overflow issues and allows for stable numerical quadrature from the lower limit of $0$. For the special case $\\Omega_{m0}=1$, the expression for $\\tilde{D}(a)$ simplifies analytically to $\\tilde{D}(a)=a$. This provides a valuable cross-check for the numerical implementation.\n\nThe numerical solution will be implemented in Python using the `scipy.integrate.quad` function for high-precision quadrature.", "answer": "```python\nimport numpy as np\nfrom scipy.integrate import quad\n\ndef solve():\n    \"\"\"\n    Derives and computes the normalized linear growth factor D(a) for a flat\n    LambdaCDM cosmology.\n    \"\"\"\n\n    # Test cases: tuples of (Omega_m0, scale_factor_a)\n    test_cases = [\n        (0.3, 0.5),\n        (0.3, 1.0),\n        (0.3, 2.0),\n        (1.0, 0.1),\n        (1.0, 1.0),\n        (1.0, 2.0),\n        (0.99, 0.01),\n        (0.01, 0.5),\n    ]\n\n    results = []\n    for omega_m0, a in test_cases:\n        result = calculate_growth_factor(omega_m0, a)\n        results.append(result)\n\n    # Print the final results in the specified format\n    print(f\"[{','.join(f'{r:.8f}' for r in results)}]\")\n\n\ndef calculate_growth_factor(omega_m0, a):\n    \"\"\"\n    Calculates the normalized growth factor D_tilde(a) such that D_tilde(1) = 1.\n\n    Args:\n        omega_m0 (float): Matter density parameter today.\n        a (float): The cosmic scale factor.\n\n    Returns:\n        float: The value of the normalized growth factor D_tilde(a).\n    \"\"\"\n\n    # For the Einstein-de Sitter case (omega_m0 = 1), the growth factor is\n    # analytically known to be D(a) propto a. After normalization D(1)=1,\n    # we get D_tilde(a) = a. This is more accurate than numerical integration.\n    if np.isclose(omega_m0, 1.0):\n        return a\n\n    omega_l0 = 1.0 - omega_m0\n\n    # The integrand is rewritten for numerical stability near a_prime -> 0.\n    # Original form: 1 / (a_prime**3 * E(a_prime)**3)\n    # Stable form: a_prime**(3/2) / (omega_m0 + omega_l0 * a_prime**3)**(3/2)\n    def integrand(a_prime, om0, ol0):\n        if a_prime == 0:\n            return 0.0\n        numerator = a_prime**1.5\n        denominator = (om0 + ol0 * a_prime**3)**1.5\n        return numerator / denominator\n\n    # Dimensionless Hubble parameter E(a) = H(a)/H0\n    def E_func(a_val, om0, ol0):\n        if a_val == 0:\n            return np.inf\n        return np.sqrt(om0 * a_val**-3 + ol0)\n\n    # Numerator part of the D_tilde(a) expression\n    # D_un_num = E(a) * integral from 0 to a\n    integral_num, err_num = quad(integrand, 0, a, args=(omega_m0, omega_l0))\n    D_un_num = E_func(a, omega_m0, omega_l0) * integral_num\n    \n    # Denominator part of the D_tilde(a) expression (for normalization)\n    # D_un_den = E(1) * integral from 0 to 1\n    integral_den, err_den = quad(integrand, 0, 1.0, args=(omega_m0, omega_l0))\n    # E(1) = sqrt(omega_m0 + omega_l0) = sqrt(1) = 1\n    D_un_den = 1.0 * integral_den \n                                \n    # Handle the case where the denominator might be zero (though unlikely for omega_m0 > 0)\n    if D_un_den == 0:\n        # This case suggests no growth, physically corresponds to omega_m0=0.\n        return 0.0 \n\n    return D_un_num / D_un_den\n\nif __name__ == '__main__':\n    solve()\n```", "id": "3500913"}, {"introduction": "With an understanding of how perturbations grow over time, we can now address the central prediction of the Zeldovich approximation: the formation of the first gravitationally collapsed objects. This event, known as shell-crossing or caustic formation, marks the breakdown of the linear density field and the birth of nonlinear structure. This practice challenges you to analytically determine the precise moment of collapse by relating the growth factor $D(a)$ to the geometric properties of the initial displacement field, encoded in the eigenvalues of the deformation tensor [@problem_id:3500966].", "problem": "Consider a pressureless, self-gravitating Cold Dark Matter (CDM) fluid evolving in an Einstein–de Sitter (EdS) universe. In the Zel'dovich approximation, each fluid element labeled by its Lagrangian coordinate $\\boldsymbol{q}$ follows a trajectory given by the comoving mapping $\\boldsymbol{x}(\\boldsymbol{q},a) = \\boldsymbol{q} + D(a)\\,\\boldsymbol{s}(\\boldsymbol{q})$, where $a$ is the cosmological scale factor, $D(a)$ is the linear growth factor, and $\\boldsymbol{s}(\\boldsymbol{q})$ is an irrotational displacement field. Let the local (symmetric) deformation tensor be $d_{ij}(\\boldsymbol{q}) \\equiv \\partial s_i / \\partial q_j$, with real eigenvalues $\\{\\lambda_1,\\lambda_2,\\lambda_3\\}$ ordered as $\\lambda_1 \\le \\lambda_2 \\le \\lambda_3  0$. Using only mass conservation in comoving coordinates and the fact that the first shell-crossing (caustic) occurs when the Lagrangian-to-Eulerian mapping becomes singular, determine the scale factor $a_{\\rm sc}$ at which the first caustic forms, expressed in terms of the eigenvalues $\\{\\lambda_i\\}$. Assume the linear growth factor in an Einstein–de Sitter universe satisfies $D(a) \\propto a$ and is normalized so that $D(1)=1$. Your final answer must be a single closed-form analytic expression for $a_{\\rm sc}$ in terms of $\\lambda_1$, $\\lambda_2$, and $\\lambda_3$ (no units).", "solution": "The problem asks for the scale factor $a_{\\rm sc}$ at which the first caustic, or shell-crossing, occurs in the Zel'dovich approximation for a pressureless fluid in an Einstein-de Sitter universe.\n\nThe starting point is the Zel'dovich approximation, which provides a mapping from the initial (Lagrangian) comoving coordinates $\\boldsymbol{q}$ of a fluid element to its Eulerian comoving coordinates $\\boldsymbol{x}$ at a later time, parameterized by the scale factor $a$. This mapping is given as:\n$$\n\\boldsymbol{x}(\\boldsymbol{q}, a) = \\boldsymbol{q} + D(a)\\,\\boldsymbol{s}(\\boldsymbol{q})\n$$\nHere, $D(a)$ is the linear growth factor, which describes the time evolution of linear density perturbations, and $\\boldsymbol{s}(\\boldsymbol{q})$ is the time-independent displacement field.\n\nA caustic, or shell-crossing, occurs when initially distinct fluid elements meet at the same spatial position. Mathematically, this corresponds to the point where the mapping from Lagrangian to Eulerian coordinates becomes singular. The singularity of the mapping is determined by its Jacobian matrix, $J_{ij}$. The mapping is singular if and only if the determinant of the Jacobian matrix is zero.\n\nThe components of the Jacobian matrix are given by $J_{ij} = \\frac{\\partial x_i}{\\partial q_j}$. Using the given mapping, we compute the partial derivatives:\n$$\nJ_{ij}(\\boldsymbol{q}, a) = \\frac{\\partial}{\\partial q_j} \\left( q_i + D(a)\\,s_i(\\boldsymbol{q}) \\right)\n$$\nThe derivative of the first term is the Kronecker delta, $\\frac{\\partial q_i}{\\partial q_j} = \\delta_{ij}$. The second term involves the derivative of the displacement field. The problem defines the local deformation tensor as $d_{ij}(\\boldsymbol{q}) \\equiv \\frac{\\partial s_i}{\\partial q_j}$. Therefore, the Jacobian matrix becomes:\n$$\nJ_{ij}(\\boldsymbol{q}, a) = \\delta_{ij} + D(a)\\,d_{ij}(\\boldsymbol{q})\n$$\nIn matrix notation, this can be written as:\n$$\n\\boldsymbol{J} = \\boldsymbol{I} + D(a)\\,\\boldsymbol{d}\n$$\nwhere $\\boldsymbol{I}$ is the $3 \\times 3$ identity matrix and $\\boldsymbol{d}$ is the deformation tensor matrix.\n\nThe condition for shell-crossing is that the mapping becomes singular, which means $\\det(\\boldsymbol{J}) = 0$.\n$$\n\\det(\\boldsymbol{I} + D(a)\\,\\boldsymbol{d}) = 0\n$$\nTo evaluate this determinant, we consider the eigenvalues of the matrices involved. The problem states that the deformation tensor $\\boldsymbol{d}$ is a real symmetric matrix with eigenvalues $\\{\\lambda_1, \\lambda_2, \\lambda_3\\}$. Let $\\boldsymbol{v}_1, \\boldsymbol{v}_2, \\boldsymbol{v}_3$ be the corresponding orthonormal eigenvectors. For any eigenvector $\\boldsymbol{v}_k$ of $\\boldsymbol{d}$ with eigenvalue $\\lambda_k$, we have $\\boldsymbol{d}\\boldsymbol{v}_k = \\lambda_k \\boldsymbol{v}_k$.\n\nWe can find the eigenvalues of the Jacobian matrix $\\boldsymbol{J}$ by applying it to the eigenvectors of $\\boldsymbol{d}$:\n$$\n\\boldsymbol{J}\\boldsymbol{v}_k = (\\boldsymbol{I} + D(a)\\,\\boldsymbol{d})\\boldsymbol{v}_k = \\boldsymbol{I}\\boldsymbol{v}_k + D(a)\\,\\boldsymbol{d}\\boldsymbol{v}_k = \\boldsymbol{v}_k + D(a)\\lambda_k\\boldsymbol{v}_k = (1 + D(a)\\lambda_k)\\boldsymbol{v}_k\n$$\nThis shows that the eigenvectors of $\\boldsymbol{d}$ are also the eigenvectors of $\\boldsymbol{J}$, and the eigenvalues of $\\boldsymbol{J}$ are $\\{1+D(a)\\lambda_1, 1+D(a)\\lambda_2, 1+D(a)\\lambda_3\\}$.\n\nThe determinant of a matrix is the product of its eigenvalues. Therefore, the determinant of the Jacobian is:\n$$\n\\det(\\boldsymbol{J}) = \\prod_{k=1}^{3} (1 + D(a)\\lambda_k) = (1 + D(a)\\lambda_1)(1 + D(a)\\lambda_2)(1 + D(a)\\lambda_3)\n$$\nThe shell-crossing condition $\\det(\\boldsymbol{J}) = 0$ is satisfied if and only if at least one of the factors is zero:\n$$\n1 + D(a)\\lambda_k = 0 \\quad \\text{for some } k \\in \\{1, 2, 3\\}\n$$\nThis gives the condition on the growth factor for shell-crossing to occur:\n$$\nD(a) = -\\frac{1}{\\lambda_k}\n$$\nThe problem specifies that the eigenvalues are all negative: $\\lambda_1 \\le \\lambda_2 \\le \\lambda_3  0$. This ensures that the values of $-1/\\lambda_k$ are all positive. Since the universe starts from a smooth state at early times (small $a$) and evolves towards structure formation, the growth factor $D(a)$ is a monotonically increasing function of $a$, starting from $D(a) \\approx 0$ for $a \\approx 0$. The *first* shell-crossing corresponds to the smallest scale factor $a$ that satisfies the condition. This, in turn, corresponds to the smallest positive value of $D(a)$ for which a singularity occurs. We must find the minimum of the possible values for $D(a)$:\n$$\nD(a_{\\rm sc}) = \\min \\left\\{ -\\frac{1}{\\lambda_1}, -\\frac{1}{\\lambda_2}, -\\frac{1}{\\lambda_3} \\right\\}\n$$\nGiven the ordering $\\lambda_1 \\le \\lambda_2 \\le \\lambda_3  0$, $\\lambda_1$ is the most negative eigenvalue. This means $|\\lambda_1| \\ge |\\lambda_2| \\ge |\\lambda_3|$. Taking the reciprocal of these positive absolute values reverses the inequalities:\n$$\n\\frac{1}{|\\lambda_1|} \\le \\frac{1}{|\\lambda_2|} \\le \\frac{1}{|\\lambda_3|}\n$$\nThis is equivalent to:\n$$\n-\\frac{1}{\\lambda_1} \\le -\\frac{1}{\\lambda_2} \\le -\\frac{1}{\\lambda_3}\n$$\nThe minimum value is therefore $-1/\\lambda_1$. The first shell-crossing occurs when the growth factor reaches this value:\n$$\nD(a_{\\rm sc}) = -\\frac{1}{\\lambda_1}\n$$\nThis corresponds physically to the collapse along the direction of the most negative eigenvalue (the principal axis of fastest compression).\n\nFinally, we use the specific form of the growth factor for an Einstein-de Sitter (EdS) universe. The problem states that $D(a) \\propto a$ and is normalized such that $D(1)=1$. Let $D(a) = C \\cdot a$ for some constant $C$. The normalization gives $D(1) = C \\cdot 1 = 1$, so $C=1$. Thus, for an EdS universe, the growth factor is simply $D(a) = a$.\n\nSubstituting this into our condition for the first caustic gives:\n$$\na_{\\rm sc} = -\\frac{1}{\\lambda_1}\n$$\nThis is the scale factor at which the first shell-crossing event takes place.", "answer": "$$\\boxed{-\\frac{1}{\\lambda_1}}$$", "id": "3500966"}, {"introduction": "The power of the Zeldovich approximation extends beyond simply predicting *when* collapse occurs; it also illuminates *how* it occurs, providing a remarkable explanation for the observed geometric patterns of the cosmic web. The local geometry of collapse—whether it forms a vast sheet, a dense filament, or a compact node—is determined by the number of axes collapsing simultaneously. This advanced exercise delves into the elegant mathematical framework of tensor invariants to connect these collapse geometries to the initial conditions, revealing how the blueprint for the cosmic web is encoded in the very fabric of the early universe [@problem_id:3500964].", "problem": "Consider the Zel'dovich approximation (ZA) for cold dark matter in an expanding universe, where the Eulerian position $\\boldsymbol{x}$ of a fluid element initially at Lagrangian coordinate $\\boldsymbol{q}$ is given by $\\boldsymbol{x}(\\boldsymbol{q},t)=\\boldsymbol{q}+D(t)\\,\\boldsymbol{s}(\\boldsymbol{q})$. Let the deformation tensor be $d_{ij}(\\boldsymbol{q}) = \\partial s_i / \\partial q_j$. Its three principal invariants are $I_{1}=\\mathrm{Tr}\\,d$, $I_{2}$ equal to the sum of the principal $2\\times 2$ minors, and $I_{3}=\\det d$. \n\nStarting from these definitions and the mapping from Lagrangian to Eulerian space in the Zel'dovich approximation, derive conditions on the invariants $I_{1}$, $I_{2}$, $I_{3}$ that ensure simultaneous collapse along multiple axes at the same value of the linear growth factor $D$. This requires the eigenvalues of the deformation tensor to be negative. Using only invariant-based reasoning (without choosing a particular basis), show how these conditions encode the local topology of the emerging cosmic web (sheet, filament, node) in terms of axis multiplicities of collapse.\n\nThen, for a region whose deformation tensor has invariant values $I_{1}=-1.4$, $I_{2}=0.60$, and $I_{3}=-0.072$, determine the earliest value $D_{\\star}$ of the linear growth factor for which two axes collapse simultaneously at the same location. Express your final answer as a dimensionless number and round to $4$ significant figures.", "solution": "In the Zel'dovich approximation (ZA), the Eulerian position $\\boldsymbol{x}$ is given by\n$$\n\\boldsymbol{x}(\\boldsymbol{q},t)=\\boldsymbol{q}+D(t)\\,\\boldsymbol{s}(\\boldsymbol{q}),\n$$\nwhere $D(t)$ is the linear growth factor and $\\boldsymbol{s}(\\boldsymbol{q})$ is the displacement field. The deformation tensor is $d_{ij}(\\boldsymbol{q}) = \\partial s_i / \\partial q_j$, which is symmetric and thus diagonalizable with real eigenvalues $\\lambda_{1},\\lambda_{2},\\lambda_{3}$. The local mapping from Lagrangian to Eulerian coordinates is characterized by the Jacobian matrix\n$$\n\\frac{\\partial x_{i}}{\\partial q_{j}}=\\delta_{ij}+D(t)\\,d_{ij}.\n$$\nIts determinant,\n$$\nJ(\\boldsymbol{q},t)=\\det\\left(\\delta_{ij}+D\\,d_{ij}\\right),\n$$\ngoverns the local volume change and the onset of shell crossing. Diagonalizing $d_{ij}$, the Jacobian determinant factors as\n$$\nJ=\\prod_{i=1}^{3}\\left(1+D\\,\\lambda_{i}\\right).\n$$\nCollapse along a single principal axis occurs when one factor vanishes, $1+D\\,\\lambda_{i}=0$, which requires a negative eigenvalue ($\\lambda_i  0$) and a growth factor $D = -1/\\lambda_i$. Simultaneous collapse along multiple axes requires that multiple factors vanish at the same $D$, which implies degeneracies among the negative eigenvalues of $d_{ij}$.\n\nWe express these conditions using invariants. The characteristic polynomial of $d_{ij}$ is\n$$\n\\chi(\\lambda)=\\lambda^{3}-I_{1}\\lambda^{2}+I_{2}\\lambda-I_{3} = 0,\n$$\nwhere $I_{1}=\\lambda_{1}+\\lambda_{2}+\\lambda_{3}$, $I_{2}=\\lambda_{1}\\lambda_{2}+\\lambda_{2}\\lambda_{3}+\\lambda_{3}\\lambda_{1}$, and $I_{3}=\\lambda_{1}\\lambda_{2}\\lambda_{3}$. Degeneracy of eigenvalues is signaled by a multiple root of $\\chi(\\lambda)$. A necessary and sufficient condition for a double eigenvalue $\\lambda=\\lambda_{\\mathrm{c}}$ is that $\\lambda_{\\mathrm{c}}$ is a common root of $\\chi(\\lambda)$ and its derivative\n$$\n\\chi'(\\lambda)=3\\lambda^{2}-2I_{1}\\lambda+I_{2} = 0.\n$$\nThus, simultaneous collapse along two axes occurs if and only if there exists a negative eigenvalue $\\lambda_{\\mathrm{c}}$ such that $\\chi'(\\lambda_{\\mathrm{c}})=0$ and $\\chi(\\lambda_{\\mathrm{c}})=0$. The collapse growth factor is then $D_{\\star}=-1/\\lambda_{\\mathrm{c}}$. Solving $\\chi'(\\lambda)=0$ gives the stationary values\n$$\n\\lambda_{\\pm}=\\frac{I_{1}\\pm\\sqrt{I_{1}^{2}-3I_{2}}}{3}.\n$$\nThese must be tested by substitution into $\\chi(\\lambda)=0$ to find the degenerate eigenvalue. The earliest collapse occurs for the least negative degenerate eigenvalue (i.e., the one with the smallest absolute value).\n\nTopology follows from the multiplicity of collapsing axes. One collapsing axis (one negative $\\lambda$) gives a sheet. Two (two negative $\\lambda$s) give a filament. Three (three negative $\\lambda$s) give a node. Simultaneous collapse means degeneracy in the eigenvalues.\n\nWe now evaluate $D_{\\star}$ for the given invariants $I_{1}=-1.4$, $I_{2}=0.60$, and $I_{3}=-0.072$. First, compute the argument of the square root:\n$$\nI_{1}^{2}-3I_{2}=(-1.4)^{2}-3\\times 0.60=1.96-1.80=0.16.\n$$\nThe stationary candidates for eigenvalues are\n$$\n\\lambda_{\\pm}=\\frac{-1.4\\pm\\sqrt{0.16}}{3} = \\frac{-1.4\\pm 0.4}{3}.\n$$\nThis gives $\\lambda_{+} = \\frac{-1.0}{3} = -1/3$ and $\\lambda_{-} = \\frac{-1.8}{3} = -0.6$. Both are negative and thus candidates for collapse.\n\nCheck which candidate is a double eigenvalue by enforcing $\\chi(\\lambda_{\\pm})=0$:\n$$\n\\chi(\\lambda)=\\lambda^{3}-(-1.4)\\,\\lambda^{2}+0.60\\,\\lambda-(-0.072) = \\lambda^{3}+1.4\\,\\lambda^{2}+0.60\\,\\lambda+0.072.\n$$\nFor $\\lambda=-0.6$:\n$$\n\\chi(-0.6)=(-0.6)^{3}+1.4(-0.6)^{2}+0.60(-0.6)+0.072=-0.216+1.4(0.36)-0.36+0.072=-0.216+0.504-0.36+0.072=0.\n$$\nSo $\\lambda_{\\mathrm{c}}=-0.6$ is a double eigenvalue. For $\\lambda=-1/3$:\n$$\n\\chi(-1/3)=(-1/3)^{3}+1.4(-1/3)^{2}+0.6(-1/3)+0.072 = -1/27 + 1.4/9 - 0.2 + 0.072 \\neq 0.\n$$\nThe eigenvalues of the deformation tensor are therefore $\\{-0.6, -0.6, -0.2\\}$ (since the sum must be $I_1 = -1.4$). The possible values for the growth factor at collapse are $D = -1/(-0.6) \\approx 1.667$ and $D = -1/(-0.2) = 5$. The earliest collapse, which corresponds to the smallest positive value of $D$, occurs for the double eigenvalue.\n$$\nD_{\\star}=\\frac{-1}{\\lambda_{\\mathrm{c}}}=\\frac{-1}{-0.6}=\\frac{5}{3}\\approx 1.666\\ldots\n$$\nRounded to $4$ significant figures, this is $1.667$. At this value of the growth factor, two axes collapse simultaneously, indicating the formation of a filamentary structure.", "answer": "$$\\boxed{1.667}$$", "id": "3500964"}]}