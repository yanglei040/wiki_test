{"hands_on_practices": [{"introduction": "To build a solid foundation, we begin with an analytical exploration of the simplest cosmological model for structure formation: the Einstein–de Sitter (EdS) universe. This exercise strips away the complexities of dark energy and curvature, allowing for an exact solution to the linear perturbation equation. By solving this problem [@problem_id:3496911], you will analytically derive the two fundamental solutions for the evolution of density perturbations—the growing and decaying modes—and quantify how the decaying mode becomes negligible as the universe expands.", "problem": "Consider a spatially flat, pressureless matter-dominated Einstein–de Sitter universe embedded in the Friedmann–Lemaître–Robertson–Walker (FLRW) metric with scale factor $a(t)$. Linear sub-horizon density perturbations $\\delta(\\boldsymbol{x}, t)$ in this background obey the Newtonian linear evolution equation\n$$\\ddot{\\delta} + 2 H \\dot{\\delta} - 4 \\pi G \\rho \\,\\delta = 0,$$\nwhere $H(t) = \\dot{a}/a$ is the Hubble parameter, $\\rho(t)$ is the background matter density, and $G$ is Newton’s gravitational constant. Using only the Friedmann equation for a flat matter-only universe,\n$$H^{2}(t) = \\frac{8 \\pi G}{3}\\,\\rho(t),$$\nand the continuity equation for pressureless matter, derive the general behavior in time of the two independent solutions to the above perturbation equation. Then re-express the decaying mode solution as a function of the scale factor $a$ and determine its power-law scaling with $a$. Finally, quantify how the amplitude of the decaying mode, relative to the growing mode, changes between $a=10^{-3}$ and $a=1$ by computing the multiplicative suppression factor\n$$\\frac{\\left[\\delta_{\\text{dec}}(a)/\\delta_{\\text{grow}}(a)\\right]_{a=1}}{\\left[\\delta_{\\text{dec}}(a)/\\delta_{\\text{grow}}(a)\\right]_{a=10^{-3}}}.$$\nProvide the suppression factor as a single exact analytic expression with no rounding and no units.", "solution": "The problem statement has been critically validated and is deemed sound. It is scientifically grounded, well-posed, objective, and internally consistent, representing a standard exercise in physical cosmology. All necessary physical laws and model specifications are provided to derive a unique and meaningful solution. We may therefore proceed with the derivation.\n\nThe central task is to solve the linear ordinary differential equation for sub-horizon density perturbations, $\\delta$, in an Einstein–de Sitter universe:\n$$\n\\ddot{\\delta} + 2 H \\dot{\\delta} - 4 \\pi G \\rho \\,\\delta = 0\n$$\nThe coefficients $H(t)$ and $\\rho(t)$ are determined by the background cosmology. For a spatially flat, pressureless matter-dominated universe, the Friedmann equation is given as:\n$$\nH^{2} = \\left(\\frac{\\dot{a}}{a}\\right)^{2} = \\frac{8 \\pi G}{3}\\,\\rho\n$$\nThe continuity equation for pressureless matter ($P=0$) is $\\dot{\\rho} + 3 H \\rho = 0$. This can be rewritten as $\\frac{d\\rho}{\\rho} = -3 \\frac{da}{a}$, which integrates to give the evolution of the background matter density:\n$$\n\\rho(t) \\propto a(t)^{-3}\n$$\nSubstituting this into the Friedmann equation:\n$$\n\\left(\\frac{\\dot{a}}{a}\\right)^{2} \\propto a^{-3} \\implies \\dot{a}^{2} \\propto a^{-1} \\implies \\dot{a} \\propto a^{-1/2}\n$$\nThis differential equation for the scale factor, $a(t)$, can be solved by separation of variables:\n$$\na^{1/2} da \\propto dt \\implies \\int a^{1/2} da \\propto \\int dt \\implies \\frac{2}{3} a^{3/2} \\propto t\n$$\nChoosing the initial time such that the integration constant is zero, we find the characteristic time evolution of the scale factor in an Einstein–de Sitter universe:\n$$\na(t) \\propto t^{2/3}\n$$\nFrom this, we can express the Hubble parameter $H(t)$ and the density term $4 \\pi G \\rho$ explicitly as functions of time $t$. Let $a(t) = C t^{2/3}$ for some constant $C$.\nThe Hubble parameter is:\n$$\nH(t) = \\frac{\\dot{a}}{a} = \\frac{\\frac{2}{3} C t^{-1/3}}{C t^{2/3}} = \\frac{2}{3t}\n$$\nUsing the Friedmann equation, we can express the density term as:\n$$\n4 \\pi G \\rho = \\frac{3}{2} H^{2} = \\frac{3}{2} \\left(\\frac{2}{3t}\\right)^{2} = \\frac{3}{2} \\left(\\frac{4}{9t^2}\\right) = \\frac{2}{3t^2}\n$$\nNow, we substitute these time-dependent coefficients into the perturbation evolution equation:\n$$\n\\ddot{\\delta} + 2 \\left(\\frac{2}{3t}\\right) \\dot{\\delta} - \\left(\\frac{2}{3t^2}\\right) \\delta = 0\n$$\n$$\n\\ddot{\\delta} + \\frac{4}{3t} \\dot{\\delta} - \\frac{2}{3t^2} \\delta = 0\n$$\nThis is a second-order linear homogeneous differential equation of the Euler-Cauchy type. We seek power-law solutions of the form $\\delta(t) \\propto t^{n}$. Substituting this ansatz and its derivatives, $\\dot{\\delta} \\propto n t^{n-1}$ and $\\ddot{\\delta} \\propto n(n-1) t^{n-2}$, into the equation yields:\n$$\nn(n-1)t^{n-2} + \\frac{4}{3t} (n t^{n-1}) - \\frac{2}{3t^2} (t^n) = 0\n$$\nDividing by $t^{n-2}$ gives the characteristic equation for the exponent $n$:\n$$\nn(n-1) + \\frac{4}{3}n - \\frac{2}{3} = 0\n$$\n$$\nn^2 - n + \\frac{4}{3}n - \\frac{2}{3} = 0\n$$\n$$\nn^2 + \\frac{1}{3}n - \\frac{2}{3} = 0\n$$\nMultiplying by $3$ to clear the denominators, we obtain a simple quadratic equation:\n$$\n3n^2 + n - 2 = 0\n$$\nThis can be factored as $(3n - 2)(n + 1) = 0$. The two roots are:\n$$\nn_1 = \\frac{2}{3} \\quad \\text{and} \\quad n_2 = -1\n$$\nThese exponents correspond to the two independent solutions for the time evolution of the density perturbation:\n1.  The growing mode: $\\delta_{\\text{grow}}(t) \\propto t^{2/3}$\n2.  The decaying mode: $\\delta_{\\text{dec}}(t) \\propto t^{-1}$\n\nThe general solution is a linear combination of these two modes: $\\delta(t) = C_1 t^{2/3} + C_2 t^{-1}$.\n\nNext, we re-express these solutions as a function of the scale factor $a$. We have the relation $a(t) \\propto t^{2/3}$, which implies $t \\propto a^{3/2}$.\nThe growing mode becomes:\n$$\n\\delta_{\\text{grow}}(a) \\propto (a^{3/2})^{2/3} = a^1\n$$\nThe decaying mode becomes:\n$$\n\\delta_{\\text{dec}}(a) \\propto (a^{3/2})^{-1} = a^{-3/2}\n$$\nThe power-law scaling of the decaying mode with the scale factor $a$ is thus $a^{-3/2}$.\n\nFinally, we must quantify the suppression of the decaying mode relative to the growing mode as the universe expands from $a=10^{-3}$ to $a=1$. We define the ratio of the amplitudes of the decaying mode to the growing mode as $R(a)$:\n$$\nR(a) = \\frac{\\delta_{\\text{dec}}(a)}{\\delta_{\\text{grow}}(a)}\n$$\nLet $\\delta_{\\text{dec}}(a) = K_2 a^{-3/2}$ and $\\delta_{\\text{grow}}(a) = K_1 a^1$, where $K_1$ and $K_2$ are constants determined by initial conditions. The ratio is:\n$$\nR(a) = \\frac{K_2 a^{-3/2}}{K_1 a^1} = \\frac{K_2}{K_1} a^{-3/2 - 1} = \\frac{K_2}{K_1} a^{-5/2}\n$$\nThe problem asks for the multiplicative suppression factor, which is the ratio of this quantity at $a=1$ to its value at $a=10^{-3}$:\n$$\n\\text{Suppression Factor} = \\frac{R(a=1)}{R(a=10^{-3})} = \\frac{\\left(\\frac{K_2}{K_1}\\right) (1)^{-5/2}}{\\left(\\frac{K_2}{K_1}\\right) (10^{-3})^{-5/2}}\n$$\nThe constants cancel, leaving:\n$$\n\\text{Suppression Factor} = \\frac{1}{(10^{-3})^{-5/2}} = \\frac{1}{10^{(-3) \\times (-5/2)}} = \\frac{1}{10^{15/2}} = 10^{-15/2}\n$$\nThis is the exact analytic expression for the suppression factor.", "answer": "$$\\boxed{10^{-15/2}}$$", "id": "3496911"}, {"introduction": "While the EdS model provides crucial intuition, a realistic description of our universe must include dark energy, as in the $\\Lambda$CDM model. In this more complex scenario, exact analytical solutions for the growth factor are not available. This practice [@problem_id:3496886] introduces a powerful technique used throughout theoretical physics: asymptotic analysis. By examining the behavior of the growth rate equation in the nearly matter-dominated regime, you will derive the famous and remarkably accurate approximation $f(a) \\simeq \\Omega_{\\rm m}(a)^{\\gamma}$ and determine the theoretical value of the growth index $\\gamma$.", "problem": "Consider the linear growth of matter density perturbations in a spatially flat Lambda Cold Dark Matter (ΛCDM) cosmology. Let the linear growth factor be denoted by $D(a)$ and the linear growth rate be defined as $f(a) \\equiv \\frac{d \\ln D}{d \\ln a}$. In linear theory, the logarithmic growth rate $f(a)$ obeys the differential equation\n$$\nf' + f^{2} + \\left(2 + \\frac{d \\ln H}{d \\ln a}\\right) f = \\frac{3}{2} \\Omega_{\\rm m}(a),\n$$\nwhere the prime denotes differentiation with respect to $\\ln a$, $H(a)$ is the Hubble parameter as a function of scale factor $a$, and $\\Omega_{\\rm m}(a)$ is the matter density parameter as a function of $a$.\n\nIn a flat ΛCDM background with present-day parameters $\\Omega_{{\\rm m},0}$ and $\\Omega_{\\Lambda,0}$ satisfying $\\Omega_{{\\rm m},0} + \\Omega_{\\Lambda,0} = 1$, the background expansion is given by\n$$\nE(a) \\equiv \\frac{H(a)}{H_{0}} = \\left[\\Omega_{{\\rm m},0} a^{-3} + \\Omega_{\\Lambda,0}\\right]^{1/2}, \\quad \\Omega_{\\rm m}(a) = \\frac{\\Omega_{{\\rm m},0} a^{-3}}{E(a)^{2}}.\n$$\nStarting from these definitions and the growth-rate equation above, perform an asymptotic analysis around the matter-dominated regime $\\Omega_{\\rm m}(a) \\to 1$ to obtain the approximate relation $f(a) \\simeq \\Omega_{\\rm m}(a)^{\\gamma}$ with a constant exponent $\\gamma$ (independent of $a$). Determine the value of $\\gamma$ by expanding consistently to first order in the small parameter $\\epsilon \\equiv 1 - \\Omega_{\\rm m}(a)$ and enforcing the growth-rate equation order by order.\n\nExpress your final answer for $\\gamma$ as an exact rational number. No rounding is required and no units are to be reported.", "solution": "The user wants to solve a problem in numerical cosmology, which involves finding the exponent $\\gamma$ of the linear growth factor. My first step is to validate the problem statement.\n\n### Step 1: Extract Givens\nThe problem provides the following data and definitions for a spatially flat Lambda Cold Dark Matter (ΛCDM) cosmology:\n- The linear growth factor is denoted by $D(a)$.\n- The linear growth rate is defined as $f(a) \\equiv \\frac{d \\ln D}{d \\ln a}$.\n- The differential equation governing the growth rate is:\n$$\nf' + f^{2} + \\left(2 + \\frac{d \\ln H}{d \\ln a}\\right) f = \\frac{3}{2} \\Omega_{\\rm m}(a)\n$$\nwhere a prime denotes differentiation with respect to $\\ln a$.\n- The Hubble parameter evolution is given by:\n$$\nE(a) \\equiv \\frac{H(a)}{H_{0}} = \\left[\\Omega_{{\\rm m},0} a^{-3} + \\Omega_{\\Lambda,0}\\right]^{1/2}\n$$\nwith the condition for a flat universe $\\Omega_{{\\rm m},0} + \\Omega_{\\Lambda,0} = 1$.\n- The matter density parameter as a function of scale factor $a$ is:\n$$\n\\Omega_{\\rm m}(a) = \\frac{\\Omega_{{\\rm m},0} a^{-3}}{E(a)^{2}}\n$$\n- The task is to find the constant exponent $\\gamma$ in the approximate relation $f(a) \\simeq \\Omega_{\\rm m}(a)^{\\gamma}$ by performing an asymptotic analysis around the matter-dominated regime, where $\\Omega_{\\rm m}(a) \\to 1$.\n- The method specified is to expand all terms to first order in the small parameter $\\epsilon \\equiv 1 - \\Omega_{\\rm m}(a)$.\n- The final answer for $\\gamma$ must be an exact rational number.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded. The equations provided are the standard, correct equations describing the evolution of linear density perturbations in a ΛCDM universe. The differential equation for $f(a)$ is a classical result derived from the combination of the continuity, Euler, and Poisson equations for a pressureless fluid in an expanding FRW background. The definitions for $H(a)$ and $\\Omega_{\\rm m}(a)$ are also standard for this cosmological model.\nThe problem is well-posed. It asks for a specific, calculable parameter, $\\gamma$, using a clearly defined approximation scheme ($f \\simeq \\Omega_{\\rm m}^{\\gamma}$) and a specified mathematical procedure (first-order expansion in a small parameter). The context, the matter-dominated limit, is physically meaningful.\nThe problem is objective, using precise and standard terminology from physical cosmology. It is self-contained, providing all necessary information. There are no contradictions, no pseudo-profound claims, and the calculation is non-trivial.\n\n### Step 3: Verdict and Action\nThe problem is valid. I will now proceed to the solution.\n\nThe goal is to determine the value of the exponent $\\gamma$ in the approximation $f(a) \\simeq \\Omega_{\\rm m}(a)^{\\gamma}$ by expanding the governing differential equation around the matter-dominated limit, $\\Omega_{\\rm m}(a) \\to 1$. We define the small parameter $\\epsilon \\equiv 1 - \\Omega_{\\rm m}(a)$. The analysis will be performed by expanding each term of the differential equation to first order in $\\epsilon$.\n\nThe governing equation is:\n$$\nf' + f^{2} + \\left(2 + \\frac{d \\ln H}{d \\ln a}\\right) f = \\frac{3}{2} \\Omega_{\\rm m}(a)\n$$\nwhere $f' \\equiv \\frac{df}{d\\ln a}$.\n\nFirst, we expand the terms involving $f(a)$ in powers of $\\epsilon$:\nThe approximation for $f$ is $f(a) = \\Omega_{\\rm m}(a)^{\\gamma} = (1-\\epsilon)^{\\gamma}$. Using a Taylor expansion for small $\\epsilon$:\n$$\nf(a) \\approx 1 - \\gamma\\epsilon + O(\\epsilon^2)\n$$\nSquaring this gives:\n$$\nf(a)^2 \\approx (1 - \\gamma\\epsilon)^2 = 1 - 2\\gamma\\epsilon + \\gamma^2\\epsilon^2 \\approx 1 - 2\\gamma\\epsilon + O(\\epsilon^2)\n$$\nNext, we determine the term $f'$. By the chain rule, $f' = \\frac{df}{d\\ln a} = \\frac{df}{d\\Omega_{\\rm m}} \\frac{d\\Omega_{\\rm m}}{d\\ln a}$.\nFrom $f = \\Omega_{\\rm m}^{\\gamma}$, we have $\\frac{df}{d\\Omega_{\\rm m}} = \\gamma \\Omega_{\\rm m}^{\\gamma-1}$.\nWe must find an expression for $\\frac{d\\Omega_{\\rm m}}{d\\ln a}$. Starting from the definition $\\Omega_{\\rm m}(a) = \\frac{\\Omega_{{\\rm m},0} a^{-3}}{\\Omega_{{\\rm m},0} a^{-3} + \\Omega_{\\Lambda,0}}$:\n$$\n\\frac{d\\Omega_{\\rm m}}{d\\ln a} = \\frac{d}{d\\ln a} \\left[ \\frac{\\Omega_{{\\rm m},0} a^{-3}}{\\Omega_{{\\rm m},0} a^{-3} + \\Omega_{\\Lambda,0}} \\right]\n$$\nLet $x = \\ln a$. Then $a^{-3} = \\exp(-3x)$.\n$$\n\\frac{d\\Omega_{\\rm m}}{dx} = \\frac{d}{dx} \\left[ \\frac{\\Omega_{{\\rm m},0} \\exp(-3x)}{\\Omega_{{\\rm m},0} \\exp(-3x) + \\Omega_{\\Lambda,0}} \\right]\n$$\nUsing the quotient rule:\n$$\n\\frac{d\\Omega_{\\rm m}}{dx} = \\frac{-3\\Omega_{{\\rm m},0} \\exp(-3x)(\\Omega_{{\\rm m},0} \\exp(-3x) + \\Omega_{\\Lambda,0}) - \\Omega_{{\\rm m},0} \\exp(-3x)(-3\\Omega_{{\\rm m},0} \\exp(-3x))}{(\\Omega_{{\\rm m},0} \\exp(-3x) + \\Omega_{\\Lambda,0})^2}\n$$\n$$\n\\frac{d\\Omega_{\\rm m}}{dx} = \\frac{-3\\Omega_{{\\rm m},0}\\Omega_{\\Lambda,0}\\exp(-3x)}{(\\Omega_{{\\rm m},0} \\exp(-3x) + \\Omega_{\\Lambda,0})^2} = -3 \\left( \\frac{\\Omega_{{\\rm m},0} a^{-3}}{E(a)^2} \\right) \\left( \\frac{\\Omega_{\\Lambda,0}}{E(a)^2} \\right) = -3\\Omega_{\\rm m}(a)\\Omega_{\\Lambda}(a)\n$$\nSince $\\Omega_{\\Lambda}(a) = 1 - \\Omega_{\\rm m}(a)$, we have $\\frac{d\\Omega_{\\rm m}}{d\\ln a} = -3\\Omega_{\\rm m}(a)(1 - \\Omega_{\\rm m}(a))$.\nNow we can write $f'$:\n$$\nf' = (\\gamma \\Omega_{\\rm m}^{\\gamma-1})(-3\\Omega_{\\rm m}(1-\\Omega_{\\rm m})) = -3\\gamma \\Omega_{\\rm m}^{\\gamma} (1-\\Omega_{\\rm m})\n$$\nIn terms of $\\epsilon$:\n$$\nf' = -3\\gamma (1-\\epsilon)^{\\gamma} \\epsilon \\approx -3\\gamma (1) \\epsilon = -3\\gamma\\epsilon + O(\\epsilon^2)\n$$\nNext, we evaluate the Hubble-dependent term, $\\frac{d \\ln H}{d \\ln a}$. We have $H(a)^2 = H_0^2 E(a)^2 = H_0^2(\\Omega_{{\\rm m},0} a^{-3} + \\Omega_{\\Lambda,0})$. Taking the logarithm gives $2\\ln H = 2\\ln H_0 + \\ln(\\Omega_{{\\rm m},0} a^{-3} + \\Omega_{\\Lambda,0})$. Differentiating with respect to $\\ln a$:\n$$\n2\\frac{d\\ln H}{d\\ln a} = \\frac{1}{\\Omega_{{\\rm m},0} a^{-3} + \\Omega_{\\Lambda,0}} \\frac{d}{d\\ln a}(\\Omega_{{\\rm m},0} a^{-3}) = \\frac{-3\\Omega_{{\\rm m},0} a^{-3}}{\\Omega_{{\\rm m},0} a^{-3} + \\Omega_{\\Lambda,0}} = -3\\Omega_{\\rm m}(a)\n$$\nThus,\n$$\n\\frac{d \\ln H}{d \\ln a} = -\\frac{3}{2}\\Omega_{\\rm m}(a) = -\\frac{3}{2}(1-\\epsilon)\n$$\nThe coefficient of $f$ in the main equation is therefore:\n$$\n2 + \\frac{d \\ln H}{d \\ln a} = 2 - \\frac{3}{2}(1-\\epsilon) = 2 - \\frac{3}{2} + \\frac{3}{2}\\epsilon = \\frac{1}{2} + \\frac{3}{2}\\epsilon\n$$\nNow we substitute all the expanded terms back into the differential equation:\n$$\nf' + f^{2} + \\left(2 + \\frac{d \\ln H}{d \\ln a}\\right) f = \\frac{3}{2} \\Omega_{\\rm m}(a)\n$$\n$$\n(-3\\gamma\\epsilon) + (1 - 2\\gamma\\epsilon) + \\left(\\frac{1}{2} + \\frac{3}{2}\\epsilon\\right) (1 - \\gamma\\epsilon) = \\frac{3}{2}(1-\\epsilon)\n$$\nWe expand the product, keeping terms up to first order in $\\epsilon$:\n$$\n\\left(\\frac{1}{2} + \\frac{3}{2}\\epsilon\\right) (1 - \\gamma\\epsilon) = \\frac{1}{2} - \\frac{\\gamma}{2}\\epsilon + \\frac{3}{2}\\epsilon - \\frac{3\\gamma}{2}\\epsilon^2 \\approx \\frac{1}{2} + \\left(\\frac{3}{2} - \\frac{\\gamma}{2}\\right)\\epsilon\n$$\nSubstituting this into the equation:\n$$\n-3\\gamma\\epsilon + 1 - 2\\gamma\\epsilon + \\frac{1}{2} + \\left(\\frac{3}{2} - \\frac{\\gamma}{2}\\right)\\epsilon = \\frac{3}{2} - \\frac{3}{2}\\epsilon\n$$\nNow, we collect terms of the same order in $\\epsilon$.\nZeroth order ($O(\\epsilon^0)$):\n$$\n1 + \\frac{1}{2} = \\frac{3}{2}\n$$\nThis is an identity, $\\frac{3}{2} = \\frac{3}{2}$, which confirms the consistency of the zeroth-order approximation ($f=1$ for $\\Omega_{\\rm m}=1$).\nFirst order ($O(\\epsilon^1)$):\nWe collect all coefficients of $\\epsilon$:\n$$\n-3\\gamma - 2\\gamma + \\frac{3}{2} - \\frac{\\gamma}{2} = -\\frac{3}{2}\n$$\nNow, we solve this linear equation for $\\gamma$:\n$$\n-5\\gamma - \\frac{\\gamma}{2} = -\\frac{3}{2} - \\frac{3}{2}\n$$\n$$\n-\\frac{10\\gamma}{2} - \\frac{\\gamma}{2} = -3\n$$\n$$\n-\\frac{11\\gamma}{2} = -3\n$$\n$$\n11\\gamma = 6\n$$\n$$\n\\gamma = \\frac{6}{11}\n$$\nThe value of the exponent is $\\frac{6}{11}$. This is a well-known result for the growth index in a ΛCDM cosmology.", "answer": "$$\n\\boxed{\\frac{6}{11}}\n$$", "id": "3496886"}, {"introduction": "Having derived an analytical approximation for the growth rate, the next step is to assess its accuracy against the \"ground truth\" provided by a full numerical solution. This computational exercise [@problem_id:3496854] bridges theory and practice, requiring you to implement a numerical solver for the growth factor's differential equation in a $\\Lambda$CDM cosmology. By comparing your numerical result for the growth rate $f(a)$ with the approximation $f(a) \\simeq \\Omega_{\\rm m}(a)^{0.55}$, you will gain hands-on experience in validating theoretical models and quantifying the precision of widely used fitting functions.", "problem": "Consider linear perturbation theory for a spatially flat Cold Dark Matter plus Cosmological Constant model, where the cosmic scale factor is denoted by $a$, the Hubble parameter by $H(a)$, and the present-day matter density parameter by $\\Omega_{\\rm m0}$. The linear growth factor $D(a)$ evolves according to the second-order ordinary differential equation derived from the Newtonian limit of General Relativity (GR) coupled to the Friedmann–Lemaître–Robertson–Walker background, expressed in terms of the variable $x=\\ln a$ as\n$$\n\\frac{d^2 D}{dx^2} + \\left[2 + \\frac{d \\ln H}{d \\ln a}\\right] \\frac{d D}{dx} - \\frac{3}{2}\\,\\Omega_{\\rm m}(a)\\, D = 0,\n$$\nwhere the matter fraction $\\Omega_{\\rm m}(a)$ is defined by\n$$\n\\Omega_{\\rm m}(a) = \\frac{\\Omega_{\\rm m0}\\, a^{-3}}{\\Omega_{\\rm m0}\\, a^{-3} + \\Omega_{\\Lambda 0}},\n$$\nwith $\\Omega_{\\Lambda 0} = 1 - \\Omega_{\\rm m0}$ for spatial flatness, and\n$$\n\\frac{d \\ln H}{d \\ln a} = -\\frac{3}{2}\\,\\Omega_{\\rm m}(a)\n$$\nfollows from $H^2(a) \\propto \\Omega_{\\rm m0}\\, a^{-3} + \\Omega_{\\Lambda 0}$ in a flat Cosmological Constant (Lambda) background.\n\nDefine the linear growth rate $f(a)$ by\n$$\nf(a) = \\frac{d \\ln D}{d \\ln a}.\n$$\nAn often-used approximation is $f(a) \\simeq \\Omega_{\\rm m}(a)^{\\gamma}$ with a constant index $\\gamma$. Your task is to quantify the fractional error of this approximation with $\\gamma = 0.55$ across the redshift interval $0  z  2$ for $\\Omega_{\\rm m0} = 0.3$ by comparing against the numerically integrated solution for $f(a)$ obtained from the differential equation above.\n\nUse the following fundamental base in your derivation and implementation:\n- The background expansion law for a spatially flat Cosmological Constant plus matter universe, $H^2(a) \\propto \\Omega_{\\rm m0}\\, a^{-3} + \\Omega_{\\Lambda 0}$ with $\\Omega_{\\Lambda 0} = 1 - \\Omega_{\\rm m0}$.\n- The linear growth factor equation for $D(a)$ in terms of $x=\\ln a$ given above.\n- The definition $f(a) = \\left(d \\ln D / d \\ln a\\right)$.\n\nDo not introduce any shortcut formulas that bypass these bases. Explicitly obtain $f(a)$ by numerically integrating the second-order ordinary differential equation for $D(a)$ and evaluating $f(a) = \\left(\\frac{d D}{dx}\\right)/D$ from the numerical solution.\n\nInitial condition specification:\n- Choose $a_{\\rm ini} = 10^{-3}$ and impose the matter-dominated asymptotic scaling $D(a) \\propto a$ at early times by setting $D(a_{\\rm ini}) = a_{\\rm ini}$ and $\\left.\\frac{d D}{dx}\\right|_{a_{\\rm ini}} = D(a_{\\rm ini})$. This ensures $f(a_{\\rm ini}) \\to 1$ consistent with $D \\propto a$ when $a \\ll 1$.\n\nDefine the fractional error at a given $a$ as\n$$\n\\varepsilon(a) = \\frac{f_{\\rm approx}(a) - f_{\\rm true}(a)}{f_{\\rm true}(a)},\n$$\nwhere $f_{\\rm approx}(a) = \\Omega_{\\rm m}(a)^{\\gamma}$ and $f_{\\rm true}(a)$ is obtained from the numerical solution.\n\nNumerically evaluate the error over the redshift range $z \\in [0,2]$ where $a = 1/(1+z)$. Construct two uniform grids in $z$:\n- A fine grid with $N_{\\rm fine} = 401$ points including endpoints $z=0$ and $z=2$.\n- A coarse grid with $N_{\\rm coarse} = 41$ points including endpoints $z=0$ and $z=2$.\n\nTest Suite and required metrics:\n- Test $1$ (happy path): Compute the maximum absolute fractional error $\\max_{0z2} |\\varepsilon|$ on the fine grid, excluding the endpoints $z=0$ and $z=2$ from the maximization.\n- Test $2$ (resolution robustness): Compute the maximum absolute fractional error $\\max_{0z2} |\\varepsilon|$ on the coarse grid, excluding the endpoints $z=0$ and $z=2$ from the maximization.\n- Test $3$ (boundary condition at late time): Compute the signed fractional error $\\varepsilon$ at $z=0$.\n- Test $4$ (boundary condition at the edge of the interval): Compute the signed fractional error $\\varepsilon$ at $z=2$.\n\nAll outputs are dimensionless and must be expressed as decimal numbers (no percentage sign). Your program must produce a single line of output containing the results as a comma-separated list enclosed in square brackets in the order $[\\text{Test }1,\\text{ Test }2,\\text{ Test }3,\\text{ Test }4]$. For example, the output format must be exactly like $[\\varepsilon_1,\\varepsilon_2,\\varepsilon_3,\\varepsilon_4]$.", "solution": "The user wants to validate the problem statement and, if it is valid, provide a solution.\n\n### Step 1: Extract Givens\n- **Model**: Spatially flat Cold Dark Matter plus Cosmological Constant ($\\Lambda$CDM) universe.\n- **Governing Equation**: The linear growth factor $D$ as a function of $x = \\ln a$ evolves according to:\n$$\n\\frac{d^2 D}{dx^2} + \\left[2 + \\frac{d \\ln H}{d \\ln a}\\right] \\frac{d D}{dx} - \\frac{3}{2}\\,\\Omega_{\\rm m}(a)\\, D = 0\n$$\n- **Definitions and Relations**:\n    - Matter density parameter at scale factor $a$: \n    $$\n    \\Omega_{\\rm m}(a) = \\frac{\\Omega_{\\rm m0}\\, a^{-3}}{\\Omega_{\\rm m0}\\, a^{-3} + \\Omega_{\\Lambda 0}}\n    $$\n    - Flatness condition: $\\Omega_{\\Lambda 0} = 1 - \\Omega_{\\rm m0}$.\n    - Hubble parameter evolution: \n    $$\n    \\frac{d \\ln H}{d \\ln a} = -\\frac{3}{2}\\,\\Omega_{\\rm m}(a)\n    $$\n    - Linear growth rate:\n    $$\n    f(a) = \\frac{d \\ln D}{d \\ln a}\n    $$\n- **Approximation**: The growth rate is approximated as $f_{\\rm approx}(a) = \\Omega_{\\rm m}(a)^{\\gamma}$.\n- **Parameters**: \n    - Present-day matter density parameter: $\\Omega_{\\rm m0} = 0.3$.\n    - Growth index for approximation: $\\gamma = 0.55$.\n- **Initial Conditions**:\n    - Initial scale factor: $a_{\\rm ini} = 10^{-3}$.\n    - Initial growth factor: $D(a_{\\rm ini}) = a_{\\rm ini}$.\n    - Initial growth factor derivative: $\\left.\\frac{d D}{dx}\\right|_{a_{\\rm ini}} = D(a_{\\rm ini})$.\n- **Task**: Calculate the fractional error $\\varepsilon(a) = \\frac{f_{\\rm approx}(a) - f_{\\rm true}(a)}{f_{\\rm true}(a)}$ over the redshift range $z \\in [0, 2]$, where $a = 1/(1+z)$.\n- **Evaluation Grids**:\n    - Fine grid: $N_{\\rm fine} = 401$ uniform points in $z$ from $z=0$ to $z=2$.\n    - Coarse grid: $N_{\\rm coarse} = 41$ uniform points in $z$ from $z=0$ to $z=2$.\n- **Required Metrics**:\n    1. Maximum absolute fractional error $\\max_{0z2} |\\varepsilon|$ on the fine grid (endpoints excluded).\n    2. Maximum absolute fractional error $\\max_{0z2} |\\varepsilon|$ on the coarse grid (endpoints excluded).\n    3. Signed fractional error $\\varepsilon$ at $z=0$.\n    4. Signed fractional error $\\varepsilon$ at $z=2$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is subjected to a rigorous validation check.\n\n- **Scientifically Grounded**: The problem is fundamentally sound. The equations for the background expansion ($H(a)$), matter density ($\\Omega_{\\rm m}(a)$), and a simplified form of the Mészáros equation for the linear growth factor ($D(a)$) are cornerstones of modern cosmology and linear perturbation theory. The parameter values ($\\Omega_{\\rm m0}=0.3$) are consistent with current cosmological constraints.\n- **Well-Posed**: The problem is well-posed. It describes a second-order linear ordinary differential equation (ODE) with a complete set of initial conditions, forming a standard initial value problem (IVP). A unique, stable solution is guaranteed to exist.\n- **Objective**: The problem is stated in precise, objective, and quantitative terms. All tasks are clearly defined calculations.\n- **Incompleteness or Contradiction**: The problem is self-contained and free of contradictions. All necessary equations, parameters, and initial conditions are provided. The initial conditions, $D(a_{\\rm ini}) \\propto a_{\\rm ini}$ and $f(a_{\\rm ini}) = 1$, are physically motivated and correctly select the growing mode solution in the early, matter-dominated universe.\n- **Unrealistic or Infeasible**: The setup is realistic. The numerical integration is a standard task in computational cosmology. The redshift range and parameter choices are physically relevant.\n- **Ill-Posed or Poorly Structured**: The problem is well-structured and leads to a unique, meaningful solution.\n- **Other Flaws**: The problem is not trivial, pseudo-profound, or unverifiable. It represents a standard, meaningful exercise in numerical cosmology.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. A solution will be provided.\n\n### Solution Derivation\n\nThe goal is to numerically solve for the linear growth factor $D(a)$ and its derivative to find the true growth rate $f_{\\rm true}(a)$, then compare it to the approximation $f_{\\rm approx}(a) = \\Omega_{\\rm m}(a)^\\gamma$.\n\n**1. Formulating the ODE for Numerical Integration**\n\nWe first substitute the expression for $\\frac{d \\ln H}{d \\ln a}$ into the governing ODE for $D(x)$:\n$$\n\\frac{d^2 D}{dx^2} + \\left[2 - \\frac{3}{2}\\,\\Omega_{\\rm m}(a)\\right] \\frac{d D}{dx} - \\frac{3}{2}\\,\\Omega_{\\rm m}(a)\\, D = 0\n$$\nwhere $x = \\ln a$ and $\\Omega_{\\rm m}(a)$ is given by:\n$$\n\\Omega_{\\rm m}(a) = \\frac{\\Omega_{\\rm m0}\\, a^{-3}}{\\Omega_{\\rm m0}\\, a^{-3} + 1 - \\Omega_{\\rm m0}}\n$$\nTo solve this second-order ODE numerically, we convert it into a system of two first-order ODEs. Let the state vector be $Y(x) = [Y_1, Y_2]^T = [D(x), dD/dx]^T$. The system is:\n$$\n\\frac{dY}{dx} = \\begin{pmatrix} dY_1/dx \\\\ dY_2/dx \\end{pmatrix} = \\begin{pmatrix} Y_2 \\\\ \\left[\\frac{3}{2}\\,\\Omega_{\\rm m}(e^x) - 2\\right] Y_2 + \\frac{3}{2}\\,\\Omega_{\\rm m}(e^x)\\, Y_1 \\end{pmatrix}\n$$\nThis system can be integrated using a standard IVP solver.\n\n**2. Setting Up the Integration**\n\nThe integration will proceed in the variable $x = \\ln a$. The initial conditions are specified at $a_{\\rm ini} = 10^{-3}$, which corresponds to an initial $x$ of $x_{\\rm ini} = \\ln(10^{-3})$.\nThe state vector at this point is $Y(x_{\\rm ini})$:\n- $Y_1(x_{\\rm ini}) = D(a_{\\rm ini}) = a_{\\rm ini} = 10^{-3}$.\n- $Y_2(x_{\\rm ini}) = \\frac{dD}{dx}\\Big|_{x_{\\rm ini}} = D(a_{\\rm ini}) = 10^{-3}$.\nThe integration range must cover the redshift interval $z \\in [0, 2]$. This corresponds to $a \\in [1/3, 1]$ and $x \\in [\\ln(1/3), 0]$. The integration will run from $x_{\\rm ini} \\approx -6.907$ up to $x = 0$.\n\nWe will construct a grid of evaluation points `t_eval` for the solver, comprising $x_{\\rm ini}$ and all $x$ values corresponding to the union of the fine and coarse $z$-grids. This ensures the solution is computed exactly at all required points.\n\n**3. Calculating the Fractional Error**\n\nAfter solving the ODE system, we obtain the numerical solutions for $D(x)$ and $dD/dx$ at each point in `t_eval`. The \"true\" growth rate is then calculated as:\n$$\nf_{\\rm true}(a) = \\frac{d \\ln D}{d \\ln a} = \\frac{1}{D(x)} \\frac{dD}{dx}\n$$\nThe approximate growth rate is:\n$$\nf_{\\rm approx}(a) = \\Omega_{\\rm m}(a)^{\\gamma}\n$$\nwith $\\gamma = 0.55$. The fractional error $\\varepsilon(a)$ is then computed at each grid point:\n$$\n\\varepsilon(a) = \\frac{f_{\\rm approx}(a) - f_{\\rm true}(a)}{f_{\\rm true}(a)}\n$$\n\n**4. Extracting the Required Metrics**\n\nThe numerical solution provides the error $\\varepsilon$ at all points on the combined grid. From this, we extract:\n- The error values corresponding to the fine and coarse grids.\n- The maximum of the absolute errors on the interior of each grid ($z \\in (0, 2)$).\n- The signed error at the boundary points $z=0$ and $z=2$.\n\nThe implementation will use `scipy.integrate.solve_ivp` for the numerical integration and `numpy` for array manipulations. The results for the fine and coarse grids are efficiently retrieved from the master solution by using `numpy.interp` as a robust lookup mechanism, since the evaluation points for the grids are a subset of the points passed to the solver.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Solves the linear growth factor ODE, computes the growth rate, and evaluates\n    the fractional error of the f ~ Omega_m^gamma approximation.\n    \"\"\"\n    \n    # 1. Define cosmological and problem parameters\n    Omega_m0 = 0.3\n    Omega_L0 = 1.0 - Omega_m0\n    gamma = 0.55\n    a_ini = 1e-3\n\n    # 2. Define the grids for evaluation\n    N_fine = 401\n    N_coarse = 41\n    z_fine = np.linspace(0.0, 2.0, N_fine)\n    z_coarse = np.linspace(0.0, 2.0, N_coarse)\n    \n    # Create a single, sorted, unique grid of all z-points for one master integration\n    z_combined = np.union1d(z_fine, z_coarse)\n\n    # Convert z grids to x = ln(a) grids for the ODE solver\n    # Note: a = 1 / (1 + z)\n    x_ini = np.log(a_ini)\n    x_combined = np.log(1.0 / (1.0 + z_combined))\n    \n    # The solver requires a sorted array of evaluation times (t_eval)\n    x_eval = np.unique(np.concatenate(([x_ini], x_combined)))\n\n    # 3. Define the system of first-order ODEs\n    # Y = [D, dD/dx]\n    def ode_system(x, Y, Om0, OL0):\n        \"\"\"\n        Defines the ODE system dY/dx for the linear growth factor.\n        x: independent variable, ln(a)\n        Y: state vector [D, dD/dx]\n        Om0, OL0: cosmological parameters\n        \"\"\"\n        D, dDdx = Y\n        \n        # Calculate Omega_m(a) at the given x = ln(a)\n        # Omega_m(a) = (Om0 * a^-3) / (Om0 * a^-3 + OL0)\n        # Use a = exp(x) -> a^-3 = exp(-3x) for numerical stability\n        num = Om0 * np.exp(-3.0 * x)\n        den = num + OL0\n        Omega_m_a = num / den\n        \n        # Second derivative from the rearranged growth equation:\n        # d^2D/dx^2 = -[2 - 1.5*Omega_m(a)]*(dD/dx) + 1.5*Omega_m(a)*D\n        d2Ddx2 = -(2.0 - 1.5 * Omega_m_a) * dDdx + 1.5 * Omega_m_a * D\n        \n        return [dDdx, d2Ddx2]\n\n    # 4. Set initial conditions and solve the ODE\n    # Initial conditions for matter-dominated growing mode: D=a, dD/dx=D\n    y_ini = np.array([a_ini, a_ini])\n    x_span = [x_ini, 0.0] # Integrate from x_ini up to today (x=0)\n    \n    sol = solve_ivp(\n        ode_system,\n        x_span,\n        y_ini,\n        method='RK45',\n        t_eval=x_eval,\n        args=(Omega_m0, Omega_L0),\n        rtol=1e-9,  # High precision for accurate error calculation\n        atol=1e-12\n    )\n\n    # 5. Calculate true and approximate growth rates and the fractional error\n    # The solution is returned at x_eval points, which is sol.t\n    x_solution = sol.t\n    D_solution = sol.y[0]\n    dDdx_solution = sol.y[1]\n    \n    # True growth rate: f_true = (dD/dx) / D\n    f_true = dDdx_solution / D_solution\n    \n    # Approximate growth rate: f_approx = Omega_m(a)^gamma\n    a_solution = np.exp(x_solution)\n    Omega_m_solution = (Omega_m0 * a_solution**-3) / (Omega_m0 * a_solution**-3 + Omega_L0)\n    f_approx = Omega_m_solution**gamma\n    \n    # Fractional error\n    errors = (f_approx - f_true) / f_true\n\n    # 6. Extract metrics for test cases by mapping solution back to z-grids\n    # Use np.interp as a robust lookup, since x_eval contains all our points.\n    # np.interp requires xp to be increasing, which sol.t is.\n    # The x-grids corresponding to z-grids are decreasing, so we flip them.\n    \n    x_fine = np.log(1.0 / (1.0 + z_fine))\n    errors_fine = np.interp(np.flip(x_fine), x_solution, errors)\n    errors_fine = np.flip(errors_fine) # Flip back to match z_fine ordering\n    \n    x_coarse = np.log(1.0 / (1.0 + z_coarse))\n    errors_coarse = np.interp(np.flip(x_coarse), x_solution, errors)\n    errors_coarse = np.flip(errors_coarse) # Flip back to match z_coarse ordering\n\n    # Test 1: Max absolute error on fine grid interior (0  z  2)\n    max_err_fine = np.max(np.abs(errors_fine[1:-1]))\n    \n    # Test 2: Max absolute error on coarse grid interior (0  z  2)\n    max_err_coarse = np.max(np.abs(errors_coarse[1:-1]))\n\n    # Test 3: Signed error at z=0\n    # This corresponds to the first element of z_fine and errors_fine\n    err_z0 = errors_fine[0]\n\n    # Test 4: Signed error at z=2\n    # This corresponds to the last element of z_fine and errors_fine\n    err_z2 = errors_fine[-1]\n\n    results = [max_err_fine, max_err_coarse, err_z0, err_z2]\n\n    # 7. Print the final results in the required format\n    # Example format: [0.0152,-0.01,0.005,-0.002]\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3496854"}]}