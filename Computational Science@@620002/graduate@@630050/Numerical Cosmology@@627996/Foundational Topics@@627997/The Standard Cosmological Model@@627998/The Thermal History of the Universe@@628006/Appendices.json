{"hands_on_practices": [{"introduction": "We begin by tackling one of the most fundamental relationships in cosmology: the evolution of cosmic time $t$ as a function of temperature $T$. This practice requires you to derive and numerically solve the differential equation governing $t(T)$ from first principles, accounting for the changing number of relativistic species during key epochs like the QCD crossover and electron-positron annihilation. By comparing your precise numerical result to a simplified power-law estimate, you will directly quantify how entropy injection from particle annihilation distorts the universe's thermal history and alters the \"cosmic clock\".", "problem": "You are tasked with writing a complete, runnable program that numerically computes the cosmic time as a function of temperature, denoted by $t(T)$, across the Quantum Chromodynamics (QCD) crossover and electron-positron annihilation ($e^\\pm$) transitions in the early universe. You must compare the numerically computed $t(T)$ to a naive power-law estimate and quantify the distortion introduced by the temperature dependence of the effective degrees of freedom.\n\nThe foundational starting point is the radiation-dominated Friedmann-Lemaître-Robertson-Walker (FLRW) cosmology with the following fundamental laws and core definitions:\n\n- The Friedmann equation for a spatially flat universe, $H^2 = \\frac{8\\pi G_N}{3}\\rho$, where $H$ is the Hubble expansion rate, $G_N$ is Newton’s constant, and $\\rho$ is the energy density.\n- For a relativistic plasma, the energy density is $\\rho(T) = \\frac{\\pi^2}{30} g_*(T) T^4$, where $g_*(T)$ is the effective number of relativistic energy degrees of freedom and $T$ is the photon temperature.\n- The comoving entropy density is conserved, $s(T) a^3 = \\text{constant}$, where $s(T) = \\frac{2\\pi^2}{45} g_s(T) T^3$ is the entropy density and $g_s(T)$ is the effective number of relativistic entropy degrees of freedom, and $a$ is the scale factor.\n\nUsing these definitions, the program must derive from first principles the temperature-time relation by combining the Friedmann equation with entropy conservation. Specifically, you must obtain $dt/dT$ in terms of $H(T)$, $T$, $g_s(T)$, and $dg_s/dT$, starting from the above fundamentals without relying on pre-provided target formulas.\n\nThe temperature dependence of $g_*(T)$ and $g_s(T)$ must be modeled by smooth, scientifically plausible crossover functions that capture the QCD and $e^\\pm$ transitions (and the muon annihilation) via hyperbolic tangent steps. Define the transition shaping function\n$$\nS(T; T_0, \\Delta T) = \\frac{1}{2}\\left[1 + \\tanh\\!\\left(\\frac{T_0 - T}{\\Delta T}\\right)\\right],\n$$\nwhich varies smoothly from $0$ at $T \\gg T_0$ to $1$ at $T \\ll T_0$. Use the following parameter values and reference degrees of freedom:\n\n- QCD crossover: $T_0^{\\mathrm{qcd}} = 155\\,\\mathrm{MeV}$, $\\Delta T^{\\mathrm{qcd}} = 50\\,\\mathrm{MeV}$.\n- Muon annihilation: $T_0^{\\mu} = 105\\,\\mathrm{MeV}$, $\\Delta T^{\\mu} = 20\\,\\mathrm{MeV}$.\n- Electron-positron annihilation: $T_0^{e} = 0.5\\,\\mathrm{MeV}$, $\\Delta T^{e} = 0.2\\,\\mathrm{MeV}$.\n- High-temperature baseline: $g_{\\mathrm{high}} = 61.75$.\n- Post-QCD baseline: $g_{\\mathrm{qcd}} = 17.25$.\n- Post-muon baseline: $g_{\\mu} = 10.75$.\n- Post-$e^\\pm$ baselines: $g_{*,e} = 3.36$ for the energy degrees and $g_{s,e} = 3.909$ for the entropy degrees.\n\nConstruct the energy and entropy degree functions as\n$$\ng_*(T) = g_{\\mathrm{high}} - \\left(g_{\\mathrm{high}} - g_{\\mathrm{qcd}}\\right) S(T; T_0^{\\mathrm{qcd}}, \\Delta T^{\\mathrm{qcd}})\n- \\left(g_{\\mathrm{qcd}} - g_{\\mu}\\right) S(T; T_0^{\\mu}, \\Delta T^{\\mu})\n- \\left(g_{\\mu} - g_{*,e}\\right) S(T; T_0^{e}, \\Delta T^{e}),\n$$\n$$\ng_s(T) = g_{\\mathrm{high}} - \\left(g_{\\mathrm{high}} - g_{\\mathrm{qcd}}\\right) S(T; T_0^{\\mathrm{qcd}}, \\Delta T^{\\mathrm{qcd}})\n- \\left(g_{\\mathrm{qcd}} - g_{\\mu}\\right) S(T; T_0^{\\mu}, \\Delta T^{\\mu})\n- \\left(g_{\\mu} - g_{s,e}\\right) S(T; T_0^{e}, \\Delta T^{e}).\n$$\nDerive and use $dg_s/dT$ consistent with the above $S(T)$.\n\nUse natural units with $\\hbar = c = k_B = 1$ inside the derivation and computation of $t(T)$, and convert to International System of Units (SI) seconds at the end using the conversion factor $1\\,\\mathrm{MeV}^{-1} = 6.582119569\\times 10^{-22}\\,\\mathrm{s}$. Use $G_N = 1/M_\\mathrm{Pl}^2$ with the (non-reduced) Planck mass $M_\\mathrm{Pl} = 1.2209\\times 10^{22}\\,\\mathrm{MeV}$.\n\nDefine the naive power-law estimate $t_{\\mathrm{naive}}(T)$ by assuming $g_s(T)$ is constant and $g_*(T)$ does not vary along the thermal trajectory; take $g_*$ fixed to the value at the final temperature $T$ for each test case, and perform the appropriate integral in temperature from a high-temperature reference $T_{\\mathrm{ref}}$ down to $T$.\n\nYour program must compute the dimensionless distortion\n$$\nD(T) = \\frac{t_{\\mathrm{true}}(T)}{t_{\\mathrm{naive}}(T)} - 1,\n$$\nwhere $t_{\\mathrm{true}}(T)$ is obtained by numerically integrating the derived $dt/dT$ (including the $g_s(T)$ and $g_*(T)$ variations) from $T_{\\mathrm{ref}}$ down to $T$ in $\\mathrm{MeV}$, and $t_{\\mathrm{naive}}(T)$ is computed under the above naive assumptions. All times must be expressed in seconds.\n\nImplement the following test suite using temperatures in megaelectronvolts (MeV):\n- Reference temperature: $T_{\\mathrm{ref}} = 5000\\,\\mathrm{MeV}$.\n- Target temperatures: $T \\in \\{150\\,\\mathrm{MeV}, 100\\,\\mathrm{MeV}, 20\\,\\mathrm{MeV}, 1\\,\\mathrm{MeV}, 0.1\\,\\mathrm{MeV}\\}$.\n\nDesign for coverage:\n- $T = 150\\,\\mathrm{MeV}$ probes the QCD crossover regime.\n- $T = 100\\,\\mathrm{MeV}$ probes the post-QCD, pre-muon annihilation regime.\n- $T = 20\\,\\mathrm{MeV}$ probes between muon and $e^\\pm$ transitions.\n- $T = 1\\,\\mathrm{MeV}$ probes just before $e^\\pm$ annihilation.\n- $T = 0.1\\,\\mathrm{MeV}$ probes well after $e^\\pm$ annihilation.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,result3,result4,result5]\"). Each result must be the distortion $D(T)$ rounded to six decimal places. No other output is permitted.", "solution": "The problem requires the numerical computation of the cosmic time-temperature relation, $t(T)$, during the radiation-dominated era, accounting for the temperature-dependent effective degrees of freedom, $g_*(T)$ and $g_s(T)$. The result is to be compared with a naive estimate to quantify the distortion. The solution proceeds in two main stages: first, the derivation of the governing differential equation for $t(T)$ from first principles, and second, the design of a numerical algorithm to solve it.\n\n### Derivation of the Time-Temperature Relation\n\nThe evolution of the universe is governed by the Friedmann equation. For a spatially flat, radiation-dominated universe, this is:\n$$\nH^2 = \\left(\\frac{1}{a}\\frac{da}{dt}\\right)^2 = \\frac{8\\pi G_N}{3}\\rho(T)\n$$\nwhere $H$ is the Hubble parameter, $a$ is the scale factor, $G_N$ is Newton's gravitational constant, and $\\rho(T)$ is the energy density of the relativistic plasma. The energy density is given by:\n$$\n\\rho(T) = \\frac{\\pi^2}{30} g_*(T) T^4\n$$\nwhere $g_*(T)$ is the effective number of relativistic energy degrees of freedom and $T$ is the photon temperature. All calculations are performed in natural units ($\\hbar = c = k_B = 1$). Using the provided relation $G_N = 1/M_\\mathrm{Pl}^2$, where $M_\\mathrm{Pl} = 1.2209\\times 10^{22}\\,\\mathrm{MeV}$ is the non-reduced Planck mass, the Hubble parameter becomes:\n$$\nH(T) = \\sqrt{\\frac{8\\pi}{3 M_\\mathrm{Pl}^2} \\frac{\\pi^2}{30} g_*(T) T^4} = \\frac{T^2}{M_\\mathrm{Pl}} \\sqrt{\\frac{4\\pi^3 g_*(T)}{45}}\n$$\n\nThe second fundamental principle is the conservation of comoving entropy. The total entropy in a comoving volume, $S = s(T)a^3$, is constant. This implies its time derivative is zero:\n$$\n\\frac{d}{dt}(s a^3) = \\frac{ds}{dt}a^3 + s \\left(3a^2 \\frac{da}{dt}\\right) = 0\n$$\nUsing the chain rule, $\\frac{ds}{dt} = \\frac{ds}{dT}\\frac{dT}{dt}$, and the definition of the Hubble parameter, $H = \\frac{1}{a}\\frac{da}{dt}$, we find:\n$$\n\\frac{ds}{dT}\\frac{dT}{dt} a^3 + 3Hsa^3 = 0 \\implies \\frac{dT}{dt} = -3H \\frac{s}{ds/dT}\n$$\nThe entropy density $s(T)$ is given by $s(T) = \\frac{2\\pi^2}{45} g_s(T) T^3$. Its derivative with respect to temperature is:\n$$\n\\frac{ds}{dT} = \\frac{2\\pi^2}{45} \\left( \\frac{dg_s}{dT}T^3 + g_s(T) \\cdot 3T^2 \\right) = s(T) \\left( \\frac{1}{g_s(T)}\\frac{dg_s}{dT} + \\frac{3}{T} \\right)\n$$\nSubstituting this into the expression for $\\frac{dT}{dt}$:\n$$\n\\frac{dT}{dt} = -3H \\frac{s(T)}{s(T) \\left( \\frac{1}{g_s(T)}\\frac{dg_s}{dT} + \\frac{3}{T} \\right)} = -3H \\left( \\frac{T g_s(T)}{T \\frac{dg_s}{dT} + 3g_s(T)} \\right) = -HT \\left( \\frac{1}{1 + \\frac{T}{3g_s(T)}\\frac{dg_s}{dT}} \\right)\n$$\nWe seek the rate of change of time with respect to temperature, $\\frac{dt}{dT}$, which is the reciprocal of $\\frac{dT}{dt}$:\n$$\n\\frac{dt}{dT} = -\\frac{1}{HT} \\left( 1 + \\frac{T}{3g_s(T)}\\frac{dg_s}{dT} \\right)\n$$\nSubstituting the derived expression for $H(T)$, we obtain the final differential equation for the true time evolution, $t_{\\mathrm{true}}(T)$:\n$$\n\\frac{dt}{dT}\\bigg|_{\\mathrm{true}} = - \\frac{M_\\mathrm{Pl}}{T^3} \\sqrt{\\frac{45}{4\\pi^3 g_*(T)}} \\left( 1 + \\frac{T}{3g_s(T)}\\frac{dg_s}{dT} \\right)\n$$\nThe elapsed time from a reference temperature $T_{\\mathrm{ref}}$ to a final temperature $T$ is found by integrating this expression:\n$$\nt_{\\mathrm{true}}(T) = \\int_{T_{\\mathrm{ref}}}^{T} \\frac{dt}{dT'}\\bigg|_{\\mathrm{true}} dT'\n$$\n\n### Naive Power-Law Estimate\nThe naive estimate, $t_{\\mathrm{naive}}(T)$, assumes that $g_s$ is constant (so $\\frac{dg_s}{dT} = 0$) and that $g_*$ is constant, fixed at its value at the final temperature, $g_*(T_{\\text{final}})$. Under these assumptions, the differential equation simplifies considerably:\n$$\n\\frac{dt}{dT}\\bigg|_{\\mathrm{naive}} = - \\frac{M_\\mathrm{Pl}}{T^3} \\sqrt{\\frac{45}{4\\pi^3 g_*(T_{\\text{final}})}}\n$$\nThis ODE can be integrated analytically from $T_{\\mathrm{ref}}$ to $T_{\\text{final}}$:\n$$\nt_{\\mathrm{naive}}(T_{\\text{final}}) = \\int_{T_{\\mathrm{ref}}}^{T_{\\text{final}}} \\left( - \\frac{M_\\mathrm{Pl}}{T'^3} \\sqrt{\\frac{45}{4\\pi^3 g_*(T_{\\text{final}})}} \\right) dT' = \\frac{M_\\mathrm{Pl}}{2} \\sqrt{\\frac{45}{4\\pi^3 g_*(T_{\\text{final}})}} \\left( \\frac{1}{T_{\\text{final}}^2} - \\frac{1}{T_{\\text{ref}}^2} \\right)\n$$\n\n### Degrees of Freedom and Derivatives\nThe functions $g_*(T)$ and $g_s(T)$ are constructed using the provided shaping function $S(T; T_0, \\Delta T) = \\frac{1}{2}\\left[1 + \\tanh\\!\\left(\\frac{T_0 - T}{\\Delta T}\\right)\\right]$. To evaluate the integrand for $t_{\\mathrm{true}}$, we need the analytic derivative of $g_s(T)$. The derivative of the shaping function is:\n$$\n\\frac{dS}{dT}(T; T_0, \\Delta T) = \\frac{d}{dT}\\left[\\frac{1}{2}\\left(1 + \\tanh\\left(\\frac{T_0 - T}{\\Delta T}\\right)\\right)\\right] = -\\frac{1}{2\\Delta T} \\mathrm{sech}^2\\left(\\frac{T_0 - T}{\\Delta T}\\right)\n$$\nSince $g_s(T)$ is a linear combination of $S$ functions for the various transitions (QCD, muon, electron), its derivative $\\frac{dg_s}{dT}$ is the corresponding linear combination of $\\frac{dS}{dT}$ terms.\n\n### Numerical Implementation\nThe solution algorithm is as follows:\n1.  Define all physical constants ($M_\\mathrm{Pl}$, MeV-to-s conversion factor) and model parameters ($T_0, \\Delta T$, and baseline $g$ values for each transition).\n2.  Implement functions for $g_*(T)$, $g_s(T)$, and its analytical derivative $\\frac{dg_s}{dT}(T)$ based on the provided formulas.\n3.  For each target temperature $T_f$ in the test suite:\n    a. Numerically compute $t_{\\mathrm{true}}(T_f)$ by integrating $\\frac{dt}{dT}|_{\\mathrm{true}}$ from $T_{\\mathrm{ref}}$ to $T_f$. Since numerical integrators like `scipy.integrate.quad` typically require the lower limit to be less than the upper limit, we compute $t_{\\mathrm{true}}(T_f) = -\\int_{T_f}^{T_{\\mathrm{ref}}} \\frac{dt}{dT'}|_{\\mathrm{true}} dT' = \\int_{T_f}^{T_{\\mathrm{ref}}} \\left(-\\frac{dt}{dT'}|_{\\mathrm{true}}\\right) dT'$. The result is obtained in units of $\\mathrm{MeV}^{-1}$ and converted to seconds.\n    b. Analytically compute $t_{\\mathrm{naive}}(T_f)$ using its derived formula, where $g_*(T_{\\text{final}})$ is evaluated at $T_f$. The result is also obtained in $\\mathrm{MeV}^{-1}$ and converted to seconds.\n    c. Calculate the dimensionless distortion $D(T_f) = \\frac{t_{\\mathrm{true}}(T_f)}{t_{\\mathrm{naive}}(T_f)} - 1$.\n4.  Collect the distortion values, round them to six decimal places, and format the output as a comma-separated list in square brackets.\nThis procedure ensures a rigorous comparison between the accurate model and the simplified naive estimate, revealing the impact of entropy-releasing processes on the thermal history of the universe.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import integrate\n\ndef solve():\n    \"\"\"\n    Computes the distortion D(T) in the cosmic time-temperature relation\n    for a set of target temperatures in the early universe.\n    \"\"\"\n    # Define constants and parameters as per the problem statement\n    # Natural units: h_bar = c = k_B = 1\n    \n    # Physical constants\n    M_PL = 1.2209e22  # Non-reduced Planck mass in MeV\n    MEV_TO_S = 6.582119569e-22  # Conversion factor from MeV^-1 to s\n\n    # Transition parameters (T0 in MeV, dT in MeV)\n    T0_QCD, DT_QCD = 155.0, 50.0\n    T0_MU, DT_MU = 105.0, 20.0\n    T0_E, DT_E = 0.5, 0.2\n\n    # Degrees of freedom (g) baselines\n    G_HIGH = 61.75\n    G_QCD = 17.25\n    G_MU = 10.75\n    G_STAR_E = 3.36\n    G_S_E = 3.909\n\n    # Pre-calculate differences for g* and gs calculations\n    DG_QCD = G_HIGH - G_QCD\n    DG_MU = G_QCD - G_MU\n    DG_STAR_E = G_MU - G_STAR_E\n    DG_S_E = G_MU - G_S_E\n    \n    # Test suite parameters\n    T_REF = 5000.0  # Reference temperature in MeV\n    TARGET_TEMPS = [150.0, 100.0, 20.0, 1.0, 0.1] # Target temperatures in MeV\n\n    # --- Helper functions ---\n\n    def S(T, T0, dT):\n        \"\"\"Transition shaping function S(T; T0, dT).\"\"\"\n        return 0.5 * (1.0 + np.tanh((T0 - T) / dT))\n\n    def g_star(T):\n        \"\"\"Effective number of relativistic energy degrees of freedom g_*(T).\"\"\"\n        s_qcd = S(T, T0_QCD, DT_QCD)\n        s_mu = S(T, T0_MU, DT_MU)\n        s_e = S(T, T0_E, DT_E)\n        return G_HIGH - DG_QCD * s_qcd - DG_MU * s_mu - DG_STAR_E * s_e\n\n    def g_s(T):\n        \"\"\"Effective number of relativistic entropy degrees of freedom g_s(T).\"\"\"\n        s_qcd = S(T, T0_QCD, DT_QCD)\n        s_mu = S(T, T0_MU, DT_MU)\n        s_e = S(T, T0_E, DT_E)\n        return G_HIGH - DG_QCD * s_qcd - DG_MU * s_mu - DG_S_E * s_e\n\n    def dS_dT(T, T0, dT):\n        \"\"\"Derivative of the shaping function S with respect to T.\"\"\"\n        # sech(x)^2 = 1/cosh(x)^2\n        arg = (T0 - T) / dT\n        return -1.0 / (2.0 * dT * np.cosh(arg)**2)\n\n    def dg_s_dT(T):\n        \"\"\"Derivative of g_s(T) with respect to T.\"\"\"\n        dsdt_qcd = dS_dT(T, T0_QCD, DT_QCD)\n        dsdt_mu = dS_dT(T, T0_MU, DT_MU)\n        dsdt_e = dS_dT(T, T0_E, DT_E)\n        return -DG_QCD * dsdt_qcd - DG_MU * dsdt_mu - DG_S_E * dsdt_e\n    \n    # --- Integrand for dt/dT_true ---\n    # We compute -dt/dT, which is positive, and integrate from T_final to T_ref\n    # to get t_true = t(T_final) - t(T_ref).\n    \n    # Constant part of the expression for dt/dT: M_Pl * sqrt(45 / (4*pi^3))\n    const_integrand_part = M_PL * np.sqrt(45.0 / (4.0 * np.pi**3))\n\n    def true_integrand(T):\n        \"\"\"The function -dt/dT to be integrated for t_true.\"\"\"\n        g_star_val = g_star(T)\n        g_s_val = g_s(T)\n        dg_s_dT_val = dg_s_dT(T)\n        \n        term1 = const_integrand_part / (T**3 * np.sqrt(g_star_val))\n        term2 = 1.0 + (T / (3.0 * g_s_val)) * dg_s_dT_val\n        \n        return term1 * term2\n\n    results = []\n    for T_final in TARGET_TEMPS:\n        # --- 1. Calculate t_true ---\n        # Integrate from T_final (lower limit) to T_ref (upper limit).\n        integral_result, _ = integrate.quad(true_integrand, T_final, T_REF)\n        t_true_mev_inv = integral_result\n        t_true_s = t_true_mev_inv * MEV_TO_S\n\n        # --- 2. Calculate t_naive ---\n        g_star_final = g_star(T_final)\n        \n        # Coefficient for the naive calculation\n        c_naive = (M_PL / 2.0) * np.sqrt(45.0 / (4.0 * np.pi**3 * g_star_final))\n        \n        t_naive_mev_inv = c_naive * (1.0 / T_final**2 - 1.0 / T_REF**2)\n        t_naive_s = t_naive_mev_inv * MEV_TO_S\n\n        # --- 3. Calculate the distortion D(T) ---\n        distortion = t_true_s / t_naive_s - 1.0\n        results.append(f\"{distortion:.6f}\")\n        \n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "3499024"}, {"introduction": "Building on our understanding of the overall thermal history, we now zoom in on the last major entropy-transfer event: the annihilation of electrons and positrons. This exercise is a detailed numerical investigation into how this process permanently sets the temperature ratio of neutrinos to photons, $T_{\\nu}/T_{\\gamma}$, and the effective number of neutrino species, $N_{\\rm eff}$. You will implement the thermodynamics of a relativistic Fermi gas from scratch and even incorporate leading-order QED corrections, revealing the level of precision required to connect theory with modern cosmological data.", "problem": "Build a complete, runnable program that numerically computes the final neutrino-to-photon temperature ratio and the effective number of neutrino species after electron-positron annihilation for a set of test cases, by incorporating Quantum Electrodynamics (QED)-modified thermodynamics into the interacting plasma. The physical scenario is that of the early universe around electron-positron annihilation, with instantaneous decoupling of neutrinos at a specified decoupling temperature. The result must be dimensionless and reported as real numbers.\n\nThe fundamental base you must use is: conservation of comoving entropy in any sector that remains in local thermal equilibrium, relativistic kinetic theory for ideal Fermi-Dirac and Bose-Einstein gases, and the definition of the effective number of neutrino species. Start from these bases only. Do not use pre-tabulated fitting formulas for the final neutrino-to-photon temperature ratio or the final effective number of neutrino species. You must derive and implement the necessary thermodynamic integrals from first principles.\n\nAssumptions and definitions to implement:\n- Use natural units with Boltzmann constant, speed of light, and reduced Planck constant set to unity, so that temperature is an energy. Express temperatures in megaelectronvolts (MeV). All outputs are pure numbers without units.\n- Electrons and positrons are assumed to be in local thermal equilibrium with photons until a specified decoupling temperature $T_{\\mathrm{dec}}$, after which neutrinos free-stream and photons plus electron-positron pairs remain in equilibrium while pairs annihilate into photons.\n- Instantaneous decoupling is assumed at $T_{\\mathrm{dec}}$, meaning neutrinos share the common plasma temperature at $T_{\\mathrm{dec}}$ and subsequently cool adiabatically with the scale factor.\n- For the ideal thermodynamics (no QED correction), the entropy density $s$ of a species with energy density $\\rho$ and pressure $P$ at temperature $T$ is $s = (\\rho + P)/T$. For photons, with $g_{\\gamma} = 2$, $s_{\\gamma}(T) = \\frac{2 \\pi^2}{45} g_{\\gamma} T^3$. For an ideal Fermi-Dirac gas of electrons and positrons with total internal degrees of freedom $g_{e^\\pm} = 4$ and mass $m_e$, the energy density and pressure at temperature $T$ are to be computed from the integrals\n$$\n\\rho_{e^\\pm}(T) = \\frac{g_{e^\\pm}}{2 \\pi^2} T^4 \\int_{0}^{\\infty} \\mathrm{d}y \\, \\frac{y^2 \\sqrt{y^2 + z^2}}{\\exp\\!\\left(\\sqrt{y^2 + z^2}\\right) + 1},\n\\quad\nP_{e^\\pm}(T) = \\frac{g_{e^\\pm}}{6 \\pi^2} T^4 \\int_{0}^{\\infty} \\mathrm{d}y \\, \\frac{y^4/\\sqrt{y^2 + z^2}}{\\exp\\!\\left(\\sqrt{y^2 + z^2}\\right) + 1},\n$$\nwhere $z = m_e/T$ and $y = p/T$ is the dimensionless momentum. Then $s_{e^\\pm}(T) = \\left(\\rho_{e^\\pm}(T) + P_{e^\\pm}(T)\\right)/T$.\n- The effective entropy degrees of freedom of the interacting plasma sector, $g_{s,\\gamma e}(T)$, are defined by $s_{\\gamma e}(T) \\equiv s_{\\gamma}(T) + s_{e^\\pm}(T) = \\frac{2 \\pi^2}{45} g_{s,\\gamma e}(T) T^3$.\n- QED-modified thermodynamics must be included as a perturbative, leading-order correction to the entropy density of the interacting sector. Implement the following minimal, conservative and physically motivated ansatz:\n    1. Define the ultrarelativistic electron-positron entropy density (ideal, no mass) as $s_{e^\\pm}^{\\mathrm{UR}}(T) = \\frac{2 \\pi^2}{45} \\left(\\frac{7}{8}\\right) g_{e^\\pm} T^3$.\n    2. Define the electron-positron ultrarelativistic weight $w(T) = s_{e^\\pm}(T) / s_{e^\\pm}^{\\mathrm{UR}}(T)$.\n    3. The QED-corrected interacting sector entropy is $s_{\\gamma e}^{\\mathrm{QED}}(T) = s_{\\gamma e}^{\\mathrm{ideal}}(T) \\left[ 1 + \\left( \\frac{\\alpha}{\\pi} \\right) c_0 \\, w(T) \\right]$, where $\\alpha$ is the electromagnetic fine-structure constant and $c_0 = -\\frac{5}{4}$. This captures the leading-order reduction in the thermodynamic potentials at high temperature and vanishes when pairs have annihilated, through $w(T)$.\n    4. From $s_{\\gamma e}^{\\mathrm{QED}}(T)$, define $g_{s,\\gamma e}^{\\mathrm{QED}}(T)$ via $s_{\\gamma e}^{\\mathrm{QED}}(T) = \\frac{2 \\pi^2}{45} g_{s,\\gamma e}^{\\mathrm{QED}}(T) T^3$.\n- From comoving entropy conservation in the interacting sector after neutrino decoupling and the separate adiabatic cooling of neutrinos, derive the final neutrino-to-photon temperature ratio solely in terms of $g_{s,\\gamma e}(T_{\\mathrm{dec}})$ and the photon-only $g_{s,\\gamma}(T) = 2$. You must obtain a general expression and then evaluate it numerically.\n- Define the effective number of neutrino species $N_{\\mathrm{eff}}$ by the standard relation\n$$\n\\rho_{\\nu} \\equiv N_{\\mathrm{eff}} \\left(\\frac{7}{8}\\right) \\left( \\frac{4}{11} \\right)^{4/3} \\rho_{\\gamma},\n$$\nand compute $N_{\\mathrm{eff}}$ consistent with your $T_{\\nu}/T_{\\gamma}$ for a given $N_{\\nu}$ of standard-model like neutrino species. Your definition must reduce to $N_{\\mathrm{eff}} = N_{\\nu}$ if $T_{\\nu}/T_{\\gamma} = \\left(\\frac{4}{11}\\right)^{1/3}$.\n\nConstants to use:\n- Electron mass $m_e = 0.51099895\\,\\mathrm{MeV}$.\n- Fine-structure constant $\\alpha = 1/137.035999084$.\n- Internal degrees of freedom $g_{\\gamma} = 2$ and $g_{e^\\pm} = 4$.\n\nRequired numerical implementation details:\n- You must evaluate the required Fermi-Dirac integrals numerically with sufficient accuracy to resolve subpercent corrections near $T \\sim \\mathcal{O}(\\mathrm{MeV})$. You are free to choose any stable and convergent quadrature method available in the specified environment.\n- All quantities are pure numbers; no units should appear in the output.\n- For reproducibility, in the QED-corrected case, implement exactly the ansatz specified above; do not substitute any alternative correction model.\n\nTest suite:\nYour program must compute results for the following five cases, each specified as a tuple $(T_{\\mathrm{dec}}, \\mathrm{include\\_QED}, N_{\\nu})$:\n- Case $1$: $(2.0, \\mathrm{True}, 3.0)$.\n- Case $2$: $(2.0, \\mathrm{False}, 3.0)$.\n- Case $3$: $(20.0, \\mathrm{True}, 3.0)$.\n- Case $4$: $(0.3, \\mathrm{True}, 3.0)$.\n- Case $5$: $(2.0, \\mathrm{True}, 2.5)$.\n\nOutput specification:\n- For each case, compute the pair $\\left[T_{\\nu}/T_{\\gamma}, N_{\\mathrm{eff}}\\right]$ using your derived expressions and numerical integrals.\n- Round each real number to $6$ decimal places.\n- Your program should produce a single line of output containing the results as a comma-separated list of lists with no spaces, in the exact format\n$[\\,[x_1,y_1],[x_2,y_2],[x_3,y_3],[x_4,y_4],[x_5,y_5]\\,]$,\nwhere $x_i$ and $y_i$ are the rounded values for case $i$. For example, a syntactically correct line looks like $[[0.713766,3.000000],[\\dots]]$.\n\nScientific realism and constraints:\n- Ensure that your implementation strictly follows the definitions above and respects conservation of comoving entropy.\n- Do not include any formula in your code or derivation that directly states the final result for $T_{\\nu}/T_{\\gamma}$ or $N_{\\mathrm{eff}}$ without deriving it from the fundamental bases described earlier.\n- Keep all calculations numerically stable across the entire test suite, especially for the boundary case $T_{\\mathrm{dec}} = 0.3$ where electron-positron pairs are already nonrelativistic.\n\nYour final deliverable must be a single, standalone, runnable program that performs these computations and prints the single required output line.", "solution": "The problem requires the computation of the final neutrino-to-photon temperature ratio, $T_{\\nu}/T_{\\gamma}$, and the effective number of neutrino species, $N_{\\mathrm{eff}}$, following electron-positron annihilation in the early universe. This is to be done from first principles, incorporating an optional leading-order QED correction. The solution is derived in three main steps:\n1.  Derivation of the temperature ratio $T_{\\nu}/T_{\\gamma}$ from the conservation of comoving entropy.\n2.  Calculation of the effective number of entropy degrees of freedom, $g_{s,\\gamma e}$, for the interacting photon-electron-positron plasma, including the specified QED correction.\n3.  Derivation of $N_{\\mathrm{eff}}$ from its standard definition and the calculated temperature ratio.\n\nWe work in natural units where $\\hbar=c=k_B=1$.\n\n**1. Derivation of the Final Temperature Ratio $T_{\\nu}/T_{\\gamma}$**\n\nThe core principle is the conservation of entropy in a comoving volume for any system in local thermal equilibrium. We assume that at a decoupling temperature $T_{\\mathrm{dec}}$, neutrinos decouple from the primordial plasma, which consists of photons, electrons, and positrons. After decoupling, the neutrino sector and the photon-electron-positron ($\\gamma e^\\pm$) sector evolve separately, each conserving its own comoving entropy.\n\nLet $S=sa^3$ be the comoving entropy, where $s$ is the entropy density and $a$ is the scale factor of the universe.\nFor the $\\gamma e^\\pm$ plasma, its comoving entropy is conserved from the moment of neutrino decoupling ($T=T_{\\mathrm{dec}}$) until far after electron-positron annihilation ($T_{\\gamma} \\ll m_e$).\n$$ S_{\\gamma e}(T_{\\mathrm{dec}}) = S_{\\gamma e, \\mathrm{final}} $$\n$$ s_{\\gamma e}(T_{\\mathrm{dec}}) a(T_{\\mathrm{dec}})^3 = s_{\\gamma}(T_{\\gamma}) a(T_{\\gamma})^3 $$\nHere, $s_{\\gamma e}(T)$ is the entropy density of the $\\gamma e^\\pm$ plasma at temperature $T$, and $s_{\\gamma}(T_{\\gamma})$ is the entropy density of the residual photon gas at its final temperature $T_{\\gamma}$. The final plasma consists only of photons because all electron-positron pairs have annihilated.\n\nThe entropy density of a collection of species in thermal equilibrium at temperature $T$ can be expressed in terms of the effective number of entropy degrees of freedom, $g_s(T)$, as:\n$$ s(T) = \\frac{2\\pi^2}{45} g_s(T) T^3 $$\nApplying this to our entropy conservation equation:\n$$ \\frac{2\\pi^2}{45} g_{s,\\gamma e}(T_{\\mathrm{dec}}) T_{\\mathrm{dec}}^3 a(T_{\\mathrm{dec}})^3 = \\frac{2\\pi^2}{45} g_{s,\\gamma}(T_{\\gamma}) T_{\\gamma}^3 a(T_{\\gamma})^3 $$\nwhere $g_{s,\\gamma e}(T_{\\mathrm{dec}})$ is the effective number of entropy degrees of freedom of the $\\gamma e^\\pm$ plasma at $T_{\\mathrm{dec}}$, and $g_{s,\\gamma}(T_{\\gamma})$ is that of the photon gas. For a pure photon gas, $g_{s,\\gamma}(T_{\\gamma}) = g_{\\gamma} = 2$. This simplifies to:\n$$ g_{s,\\gamma e}(T_{\\mathrm{dec}}) (T_{\\mathrm{dec}} a(T_{\\mathrm{dec}}))^3 = g_{\\gamma} (T_{\\gamma} a(T_{\\gamma}))^3 $$\nNeutrinos, being decoupled, are assumed to be free-streaming and relativistic. Their entropy is also conserved, which implies that their temperature scales inversely with the scale factor, $T_{\\nu} \\propto 1/a$. Therefore, the quantity $T_{\\nu} a$ is constant. At decoupling, $T_{\\nu}(T_{\\mathrm{dec}}) = T_{\\mathrm{dec}}$. Thus, for any subsequent time when the scale factor is $a(T_{\\gamma})$ and the neutrino temperature is $T_{\\nu}$, we have:\n$$ T_{\\mathrm{dec}} a(T_{\\mathrm{dec}}) = T_{\\nu} a(T_{\\gamma}) $$\nSubstituting $T_{\\mathrm{dec}} a(T_{\\mathrm{dec}})$ from the neutrino cooling relation into the $\\gamma e^\\pm$ entropy conservation equation:\n$$ g_{s,\\gamma e}(T_{\\mathrm{dec}}) (T_{\\nu} a(T_{\\gamma}))^3 = g_{\\gamma} (T_{\\gamma} a(T_{\\gamma}))^3 $$\n$$ g_{s,\\gamma e}(T_{\\mathrm{dec}}) T_{\\nu}^3 a(T_{\\gamma})^3 = g_{\\gamma} T_{\\gamma}^3 a(T_{\\gamma})^3 $$\nSolving for the final temperature ratio $T_{\\nu}/T_{\\gamma}$:\n$$ \\frac{T_{\\nu}}{T_{\\gamma}} = \\left( \\frac{g_{\\gamma}}{g_{s,\\gamma e}(T_{\\mathrm{dec}})} \\right)^{1/3} $$\nWith $g_{\\gamma}=2$, the final expression to be computed is:\n$$ \\frac{T_{\\nu}}{T_{\\gamma}} = \\left( \\frac{2}{g_{s,\\gamma e}(T_{\\mathrm{dec}})} \\right)^{1/3} $$\n\n**2. Calculation of $g_{s,\\gamma e}(T_{\\mathrm{dec}})$**\n\nThe key task is to compute $g_{s,\\gamma e}(T_{\\mathrm{dec}})$, which depends on whether QED corrections are included.\n\n**Ideal Gas Case (No QED corrections):**\nThe total entropy density of the ideal $\\gamma e^\\pm$ plasma is $s_{\\gamma e}^{\\mathrm{ideal}}(T) = s_{\\gamma}(T) + s_{e^\\pm}(T)$. By definition, $s_{\\gamma e}^{\\mathrm{ideal}}(T) = \\frac{2\\pi^2}{45} g_{s,\\gamma e}^{\\mathrm{ideal}}(T) T^3$.\nThis gives:\n$$ g_{s,\\gamma e}^{\\mathrm{ideal}}(T) = \\frac{45}{2\\pi^2 T^3} \\left( s_{\\gamma}(T) + s_{e^\\pm}(T) \\right) $$\nWith $s_{\\gamma}(T) = \\frac{2\\pi^2}{45} g_{\\gamma} T^3$, this becomes:\n$$ g_{s,\\gamma e}^{\\mathrm{ideal}}(T) = g_{\\gamma} + \\frac{45}{2\\pi^2 T^3} s_{e^\\pm}(T) $$\nThe entropy density for electrons and positrons ($e^\\pm$) is given by $s_{e^\\pm}(T) = (\\rho_{e^\\pm}(T) + P_{e^\\pm}(T))/T$. The energy density $\\rho_{e^\\pm}$ and pressure $P_{e^\\pm}$ are given by the integrals:\n$$ \\rho_{e^\\pm}(T) = \\frac{g_{e^\\pm}}{2 \\pi^2} T^4 I_{\\rho}(z), \\quad P_{e^\\pm}(T) = \\frac{g_{e^\\pm}}{6 \\pi^2} T^4 I_{P}(z) $$\nwhere $z=m_e/T$ and the dimensionless integrals are:\n$$ I_{\\rho}(z) = \\int_{0}^{\\infty} \\mathrm{d}y \\, \\frac{y^2 \\sqrt{y^2 + z^2}}{\\exp\\left(\\sqrt{y^2 + z^2}\\right) + 1}, \\quad I_{P}(z) = \\int_{0}^{\\infty} \\mathrm{d}y \\, \\frac{y^4/\\sqrt{y^2 + z^2}}{\\exp\\left(\\sqrt{y^2 + z^2}\\right) + 1} $$\nThus, $s_{e^\\pm}(T) = \\frac{g_{e^\\pm} T^3}{6\\pi^2} (3 I_{\\rho}(z) + I_P(z))$. Substituting this into the expression for $g_{s,\\gamma e}^{\\mathrm{ideal}}$:\n$$ g_{s,\\gamma e}^{\\mathrm{ideal}}(T) = g_{\\gamma} + \\frac{45}{2\\pi^2 T^3} \\left( \\frac{g_{e^\\pm} T^3}{6\\pi^2} [3 I_{\\rho}(z) + I_P(z)] \\right) = g_{\\gamma} + \\frac{15 g_{e^\\pm}}{4\\pi^4} [3 I_{\\rho}(z) + I_P(z)] $$\nUsing the given values $g_{\\gamma}=2$ and $g_{e^\\pm}=4$:\n$$ g_{s,\\gamma e}^{\\mathrm{ideal}}(T) = 2 + \\frac{15}{\\pi^4} [3 I_{\\rho}(m_e/T) + I_P(m_e/T)] $$\n\n**QED-Corrected Case:**\nThe problem specifies a particular ansatz for the QED correction. The corrected entropy density is:\n$$ s_{\\gamma e}^{\\mathrm{QED}}(T) = s_{\\gamma e}^{\\mathrm{ideal}}(T) \\left[ 1 + \\left( \\frac{\\alpha}{\\pi} \\right) c_0 \\, w(T) \\right] $$\nwhere $\\alpha$ is the fine-structure constant, $c_0 = -5/4$, and $w(T)$ is a weight factor defined as the ratio of the actual $e^\\pm$ entropy density to its ultra-relativistic form:\n$$ w(T) = \\frac{s_{e^\\pm}(T)}{s_{e^\\pm}^{\\mathrm{UR}}(T)} $$\nThe ultra-relativistic entropy density is $s_{e^\\pm}^{\\mathrm{UR}}(T) = \\frac{2\\pi^2}{45} \\left(\\frac{7}{8}\\right) g_{e^\\pm} T^3$. Substituting the expressions for the entropy densities:\n$$ w(T) = \\frac{\\frac{g_{e^\\pm} T^3}{6\\pi^2} [3 I_{\\rho}(z) + I_P(z)]}{\\frac{2\\pi^2}{45} \\frac{7}{8} g_{e^\\pm} T^3} = \\frac{1}{6\\pi^2} \\frac{45 \\cdot 8}{14\\pi^2} [3 I_{\\rho}(z) + I_P(z)] = \\frac{30}{7\\pi^4} [3 I_{\\rho}(z) + I_P(z)] $$\nThe QED-corrected effective degrees of freedom, $g_{s,\\gamma e}^{\\mathrm{QED}}(T)$, are defined by $s_{\\gamma e}^{\\mathrm{QED}}(T) = \\frac{2\\pi^2}{45} g_{s,\\gamma e}^{\\mathrm{QED}}(T) T^3$. This leads directly to:\n$$ g_{s,\\gamma e}^{\\mathrm{QED}}(T) = g_{s,\\gamma e}^{\\mathrm{ideal}}(T) \\left[ 1 + \\left( \\frac{\\alpha}{\\pi} \\right) c_0 \\, w(T) \\right] $$\nThis is the value to be used in the denominator of the $T_{\\nu}/T_{\\gamma}$ expression when QED corrections are enabled.\n\n**3. Derivation of $N_{\\mathrm{eff}}$**\n\nThe effective number of neutrino species, $N_{\\mathrm{eff}}$, is defined by the relation:\n$$ \\rho_{\\nu, \\mathrm{total}} \\equiv N_{\\mathrm{eff}} \\left(\\frac{7}{8}\\right) \\left( \\frac{4}{11} \\right)^{4/3} \\rho_{\\gamma} $$\nHere, $\\rho_{\\nu, \\mathrm{total}}$ is the total energy density of all neutrino species, and $\\rho_{\\gamma}$ is the energy density of photons. We compute these in the final state ($T \\ll m_e$). Assuming $N_{\\nu}$ species of standard-model-like neutrinos (and antineutrinos), each being a relativistic fermion gas with $g=2$ degrees of freedom (particle+antiparticle), their total energy density is:\n$$ \\rho_{\\nu, \\mathrm{total}} = N_{\\nu} \\times \\left( \\frac{7}{8} \\frac{\\pi^2}{15} T_{\\nu}^4 \\right) $$\nThe photon energy density is that of a relativistic boson gas with $g_{\\gamma}=2$:\n$$ \\rho_{\\gamma} = \\frac{\\pi^2}{15} T_{\\gamma}^4 $$\nSubstituting these into the definition of $N_{\\mathrm{eff}}$:\n$$ N_{\\nu} \\frac{7}{8} \\frac{\\pi^2}{15} T_{\\nu}^4 = N_{\\mathrm{eff}} \\frac{7}{8} \\left( \\frac{4}{11} \\right)^{4/3} \\frac{\\pi^2}{15} T_{\\gamma}^4 $$\nSolving for $N_{\\mathrm{eff}}$:\n$$ N_{\\mathrm{eff}} = N_{\\nu} \\left( \\frac{T_{\\nu}}{T_{\\gamma}} \\right)^4 \\left( \\frac{11}{4} \\right)^{4/3} $$\nThis expression allows us to compute $N_{\\mathrm{eff}}$ from the number of neutrino species $N_{\\nu}$ and our previously derived temperature ratio $T_{\\nu}/T_{\\gamma}$.\n\n**Numerical Procedure:**\nFor each test case $(T_{\\mathrm{dec}}, \\mathrm{include\\_QED}, N_{\\nu})$:\n1.  Calculate $z=m_e/T_{\\mathrm{dec}}$.\n2.  Numerically compute the integrals $I_{\\rho}(z)$ and $I_P(z)$ using quadrature.\n3.  Compute $g_{s,\\gamma e}^{\\mathrm{ideal}}(T_{\\mathrm{dec}})$ using its derived formula.\n4.  If `include_QED` is true, compute $w(T_{\\mathrm{dec}})$ and then $g_{s,\\gamma e}^{\\mathrm{QED}}(T_{\\mathrm{dec}})$. Set $g_s = g_{s,\\gamma e}^{\\mathrm{QED}}(T_{\\mathrm{dec}})$. Otherwise, set $g_s = g_{s,\\gamma e}^{\\mathrm{ideal}}(T_{\\mathrm{dec}})$.\n5.  Calculate the temperature ratio $T_{\\nu}/T_{\\gamma} = (2/g_s)^{1/3}$.\n6.  Calculate $N_{\\mathrm{eff}}$ using its derived formula.\n7.  Round and store the results.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import integrate\n\ndef solve():\n    \"\"\"\n    Computes the final neutrino-to-photon temperature ratio and the effective\n    number of neutrino species after e+- annihilation, based on entropy conservation\n    and a specified QED correction model.\n    \"\"\"\n    \n    # Constants in specified units (MeV for mass and temperature)\n    m_e = 0.51099895  # electron mass in MeV\n    alpha = 1.0 / 137.035999084  # fine-structure constant\n    g_gamma = 2.0  # photon degrees of freedom\n    g_e = 4.0  # electron+positron degrees of freedom\n    c0 = -5.0 / 4.0  # coefficient for QED correction ansatz\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (2.0, True, 3.0),\n        (2.0, False, 3.0),\n        (20.0, True, 3.0),\n        (0.3, True, 3.0),\n        (2.0, True, 2.5),\n    ]\n\n    # Memoization cache for integrals to avoid re-computation\n    integral_cache = {}\n\n    def get_thermo_integrals(z):\n        \"\"\"\n        Numerically computes and returns the thermodynamic integrals I_rho and I_p\n        for a given z = m_e/T. Uses memoization for efficiency.\n        \"\"\"\n        if z in integral_cache:\n            return integral_cache[z]\n\n        # Integrand for energy density rho\n        def integrand_rho(y, z_val):\n            # The integrand can be zero for y=0, which is fine\n            if y == 0:\n                return 0.0\n            energy_term = np.sqrt(y**2 + z_val**2)\n            # Use log-exp trick for numerical stability if energy_term is large\n            if energy_term  700: # np.exp(709) is around max float\n                return 0.0\n            return y**2 * energy_term / (np.exp(energy_term) + 1.0)\n\n        # Integrand for pressure P\n        def integrand_p(y, z_val):\n            # Integrand is zero at y=0, avoiding division by zero\n            if y == 0:\n                return 0.0\n            energy_term = np.sqrt(y**2 + z_val**2)\n            if energy_term  700:\n                return 0.0\n            return (y**4 / energy_term) / (np.exp(energy_term) + 1.0)\n            \n        # Perform numerical integration using scipy.integrate.quad\n        I_rho, _ = integrate.quad(integrand_rho, 0, np.inf, args=(z,))\n        I_p, _ = integrate.quad(integrand_p, 0, np.inf, args=(z,))\n        \n        integral_cache[z] = (I_rho, I_p)\n        return I_rho, I_p\n\n    results = []\n    for case in test_cases:\n        T_dec, include_QED, N_nu = case\n        \n        z = m_e / T_dec\n        \n        # 1. Compute thermodynamic integrals\n        I_rho_val, I_p_val = get_thermo_integrals(z)\n        \n        # Common term in g_s and w\n        integral_combo = 3.0 * I_rho_val + I_p_val\n\n        # 2. Compute g_s_ideal\n        # g_s_ideal = g_gamma + (15 * g_e) / (4 * pi^4) * (3*I_rho + I_p)\n        g_s_contrib_e = (15.0 * g_e) / (4.0 * np.pi**4) * integral_combo\n        g_s_ideal = g_gamma + g_s_contrib_e\n        \n        g_s_final = g_s_ideal\n        \n        # 3. Apply QED correction if requested\n        if include_QED:\n            # w(T) = (30 / (7 * pi^4)) * (3*I_rho + I_p)\n            w = (30.0 / (7.0 * np.pi**4)) * integral_combo\n            \n            # g_s_QED = g_s_ideal * [1 + (alpha/pi) * c0 * w]\n            correction_factor = 1.0 + (alpha / np.pi) * c0 * w\n            g_s_qed = g_s_ideal * correction_factor\n            g_s_final = g_s_qed\n\n        # 4. Compute final temperature ratio\n        # T_nu / T_gamma = (g_gamma / g_s_final)^(1/3)\n        T_ratio = (g_gamma / g_s_final)**(1.0 / 3.0)\n        \n        # 5. Compute effective number of neutrino species\n        # N_eff = N_nu * (T_nu/T_gamma)^4 * (11/4)^(4/3)\n        N_eff = N_nu * (T_ratio**4) * (11.0 / 4.0)**(4.0 / 3.0)\n        \n        # Append rounded results for this case\n        results.append([round(T_ratio, 6), round(N_eff, 6)])\n\n    # Final print statement in the exact required format.\n    # The format is a string representation of a list of lists.\n    # Ex: [[0.713766,3.000000],[...]] without spaces\n    result_str = \",\".join([f\"[{res[0]},{res[1]}]\" for res in results])\n    print(f\"[{result_str}]\")\n\nsolve()\n```", "id": "3499106"}, {"introduction": "We conclude by shifting our focus to a later era, the epoch of recombination, and exploring how its physical state is tied to the universe's fundamental parameters. This analytical exercise challenges you to use the Saha equation to determine how the free electron fraction $x_e$ responds to variations in the baryon density, $\\Omega_b h^2$, and the primordial helium fraction, $Y_p$. The technique of implicit differentiation, or linear response, is a cornerstone of cosmological parameter inference, providing the essential link between theoretical models and observational constraints from the CMB.", "problem": "Consider the hydrogen recombination epoch of the early universe at a fixed redshift $z_{\\star}$ in the regime where thermodynamic equilibrium between matter and radiation holds and the ionization state of hydrogen is well described by the Saha equation. Assume that helium has already become neutral by $z_{\\star}$ so that it does not contribute free electrons, and that the photon temperature scales adiabatically with redshift, $T(z)=T_{0}(1+z)$, with $T_{0}$ held fixed. Define the free-electron fraction relative to hydrogen nuclei as $x_{e}(z)\\equiv n_{e}(z)/n_{H}(z)$, where $n_{H}(z)$ is the number density of hydrogen nuclei. Let the primordial helium mass fraction be $Y_{p}$, the present-day physical baryon density parameter be $\\Omega_{b}h^{2}$, and the effective number of relativistic neutrino species be $N_{\\rm eff}$.\n\nIn the Saha-equilibrium regime for hydrogen, the ionization balance is given implicitly by an equation of the form\n$$\nF\\!\\left(x_{e};\\,n_{H},T\\right)\\equiv \\frac{x_{e}^{2}}{1-x_{e}}-\\frac{A(T)}{n_{H}}=0,\n$$\nwhere $A(T)$ is a known function of $T$ containing constants of nature and the hydrogen ionization energy. You may treat $A(T)$ as independent of the cosmological parameters except through its explicit dependence on $T$, and you may assume $T$ is independent of $\\Omega_{b}h^{2}$, $Y_{p}$, and $N_{\\rm eff}$ at fixed $z_{\\star}$ under the conditions stated. The hydrogen number density can be written as $n_{H}(z)=(1-Y_{p})\\,\\bar{n}_{b}(z)$ with the baryon number density $\\bar{n}_{b}(z)$ proportional to $\\Omega_{b}h^{2}(1+z)^{3}$.\n\nUsing linear response (implicit differentiation) around a fiducial cosmological model with parameters $\\left\\{(\\Omega_{b}h^{2})^{\\star},\\,Y_{p}^{\\star},\\,N_{\\rm eff}^{\\star}\\right\\}$ at the fixed redshift $z_{\\star}$, derive closed-form analytic expressions for the parameter derivatives $\\partial x_{e}/\\partial(\\Omega_{b}h^{2})$, $\\partial x_{e}/\\partial Y_{p}$, and $\\partial x_{e}/\\partial N_{\\rm eff}$ evaluated at the fiducial model. Express your final result as a single row matrix containing the three derivatives, in terms of the fiducial quantities $x_{e}^{\\star}\\equiv x_{e}(z_{\\star})$, $(\\Omega_{b}h^{2})^{\\star}$, and $Y_{p}^{\\star}$. No numerical evaluation is required. State your final answer as a closed-form analytic expression. Do not include units in your final answer.", "solution": "The problem statement has been validated and is found to be scientifically grounded, well-posed, and self-consistent. It presents a standard problem in physical cosmology that can be solved using established mathematical methods. We may therefore proceed with the derivation.\n\nThe core of the problem lies in the implicit definition of the free-electron fraction, $x_e$, through the Saha equation at a fixed redshift $z_{\\star}$:\n$$\nF\\!\\left(x_{e};\\,n_{H},T\\right)\\equiv \\frac{x_{e}^{2}}{1-x_{e}}-\\frac{A(T)}{n_{H}}=0\n$$\nHere, $x_e$ is implicitly a function of the cosmological parameters $\\boldsymbol{\\lambda} = \\{\\Omega_b h^2, Y_p, N_{\\rm eff}\\}$ through the hydrogen number density $n_H$. The temperature $T$ at the fixed redshift $z_{\\star}$ is given by $T(z_{\\star}) = T_0(1+z_{\\star})$ and is assumed to be independent of these cosmological parameters. Consequently, the function $A(T)$ is also independent of these parameters.\n\nTo find the derivatives $\\partial x_e / \\partial \\lambda_i$ for each parameter $\\lambda_i \\in \\boldsymbol{\\lambda}$, we use the technique of implicit differentiation. The total differential of $F$ must be zero:\n$$\ndF = \\frac{\\partial F}{\\partial x_e} dx_e + \\sum_i \\frac{\\partial F}{\\partial \\lambda_i} d\\lambda_i = 0\n$$\nFrom this, the partial derivative of $x_e$ with respect to a single parameter $\\lambda$ is given by:\n$$\n\\frac{\\partial x_e}{\\partial \\lambda} = -\\left(\\frac{\\partial F}{\\partial x_e}\\right)^{-1} \\frac{\\partial F}{\\partial \\lambda}\n$$\nFirst, we compute the partial derivative of $F$ with respect to $x_e$:\n$$\n\\frac{\\partial F}{\\partial x_e} = \\frac{\\partial}{\\partial x_e} \\left( \\frac{x_e^2}{1-x_e} \\right) = \\frac{2x_e(1-x_e) - x_e^2(-1)}{(1-x_e)^2} = \\frac{2x_e - 2x_e^2 + x_e^2}{(1-x_e)^2} = \\frac{x_e(2-x_e)}{(1-x_e)^2}\n$$\nNext, we compute the partial derivative of $F$ with respect to a generic parameter $\\lambda$. Since $A(T)$ is constant with respect to the parameters at fixed $z_{\\star}$, the derivative only acts on the $n_H$ term:\n$$\n\\frac{\\partial F}{\\partial \\lambda} = \\frac{\\partial}{\\partial \\lambda} \\left( -\\frac{A(T)}{n_H} \\right) = -A(T) \\left( -\\frac{1}{n_H^2} \\right) \\frac{\\partial n_H}{\\partial \\lambda} = \\frac{A(T)}{n_H^2} \\frac{\\partial n_H}{\\partial \\lambda}\n$$\nWe can simplify this by substituting for $A(T)$ using the original Saha equation, $A(T) = n_H \\frac{x_e^2}{1-x_e}$:\n$$\n\\frac{\\partial F}{\\partial \\lambda} = \\frac{1}{n_H^2} \\left( n_H \\frac{x_e^2}{1-x_e} \\right) \\frac{\\partial n_H}{\\partial \\lambda} = \\frac{x_e^2}{(1-x_e) n_H} \\frac{\\partial n_H}{\\partial \\lambda}\n$$\nCombining these results, we obtain a general expression for the desired derivatives:\n$$\n\\frac{\\partial x_e}{\\partial \\lambda} = -\\left( \\frac{x_e(2-x_e)}{(1-x_e)^2} \\right)^{-1} \\left( \\frac{x_e^2}{(1-x_e) n_H} \\frac{\\partial n_H}{\\partial \\lambda} \\right) = -\\frac{(1-x_e)^2}{x_e(2-x_e)} \\frac{x_e^2}{(1-x_e)} \\frac{1}{n_H} \\frac{\\partial n_H}{\\partial \\lambda}\n$$\nThis simplifies to:\n$$\n\\frac{\\partial x_e}{\\partial \\lambda} = - \\frac{x_e(1-x_e)}{2-x_e} \\left( \\frac{1}{n_H} \\frac{\\partial n_H}{\\partial \\lambda} \\right)\n$$\nNow, we must determine the dependence of $n_H$ on each parameter. The hydrogen number density at redshift $z$ is $n_H(z) = (1-Y_p)\\bar{n}_b(z)$, where the total baryon number density $\\bar{n}_b(z)$ is proportional to $\\Omega_b h^2 (1+z)^3$. Let the constant of proportionality be $C_{\\rho}$, giving $\\bar{n}_b(z) = C_{\\rho} (\\Omega_b h^2) (1+z)^3$. At our fixed redshift $z_{\\star}$, we can write:\n$$\nn_H = C_{\\rho} (1+z_{\\star})^3 (1-Y_p) (\\Omega_b h^2)\n$$\nWe can now compute the logarithmic derivative of $n_H$ for each parameter.\n\n1.  **Derivative with respect to $\\Omega_b h^2$:**\n    The partial derivative of $n_H$ with respect to $\\Omega_b h^2$ is:\n    $$\n    \\frac{\\partial n_H}{\\partial (\\Omega_b h^2)} = C_{\\rho} (1+z_{\\star})^3 (1-Y_p) = \\frac{n_H}{\\Omega_b h^2}\n    $$\n    Therefore, the logarithmic derivative is $\\frac{1}{n_H} \\frac{\\partial n_H}{\\partial (\\Omega_b h^2)} = \\frac{1}{\\Omega_b h^2}$.\n    Substituting this into our general expression for $\\partial x_e/\\partial\\lambda$:\n    $$\n    \\frac{\\partial x_e}{\\partial (\\Omega_b h^2)} = - \\frac{x_e(1-x_e)}{2-x_e} \\frac{1}{\\Omega_b h^2}\n    $$\n\n2.  **Derivative with respect to $Y_p$:**\n    The partial derivative of $n_H$ with respect to $Y_p$ is:\n    $$\n    \\frac{\\partial n_H}{\\partial Y_p} = C_{\\rho} (1+z_{\\star})^3 (\\Omega_b h^2) (-1) = -\\frac{n_H}{1-Y_p}\n    $$\n    Therefore, the logarithmic derivative is $\\frac{1}{n_H} \\frac{\\partial n_H}{\\partial Y_p} = -\\frac{1}{1-Y_p}$.\n    Substituting this into our general expression:\n    $$\n    \\frac{\\partial x_e}{\\partial Y_p} = - \\frac{x_e(1-x_e)}{2-x_e} \\left( -\\frac{1}{1-Y_p} \\right) = \\frac{x_e(1-x_e)}{(2-x_e)(1-Y_p)}\n    $$\n\n3.  **Derivative with respect to $N_{\\rm eff}$:**\n    According to the problem statement, the expression for $n_H = C_{\\rho} (1+z_{\\star})^3 (1-Y_p) (\\Omega_b h^2)$ does not depend on $N_{\\rm eff}$. The temperature $T$ at fixed $z_{\\star}$ is also stated to be independent of $N_{\\rm eff}$. Therefore, within the specified model, $x_e$ at fixed $z_{\\star}$ has no dependence on $N_{\\rm eff}$.\n    Formally,\n    $$\n    \\frac{\\partial n_H}{\\partial N_{\\rm eff}} = 0\n    $$\n    which implies:\n    $$\n    \\frac{\\partial x_e}{\\partial N_{\\rm eff}} = - \\frac{x_e(1-x_e)}{2-x_e} \\left( \\frac{1}{n_H} \\cdot 0 \\right) = 0\n    $$\n\nFinally, we evaluate these expressions at the fiducial cosmological model, replacing the parameters with their fiducial values, denoted by a superscript $\\star$:\n$$\n\\left. \\frac{\\partial x_e}{\\partial (\\Omega_b h^2)} \\right|_{\\star} = - \\frac{x_e^{\\star}(1-x_e^{\\star})}{(2-x_e^{\\star})(\\Omega_b h^2)^{\\star}}\n$$\n$$\n\\left. \\frac{\\partial x_e}{\\partial Y_p} \\right|_{\\star} = \\frac{x_e^{\\star}(1-x_e^{\\star})}{(2-x_e^{\\star})(1-Y_p^{\\star})}\n$$\n$$\n\\left. \\frac{\\partial x_e}{\\partial N_{\\rm eff}} \\right|_{\\star} = 0\n$$\nThe problem requests the final result as a single row matrix containing these three derivatives.", "answer": "$$\n\\boxed{\\begin{pmatrix} - \\frac{x_e^{\\star}(1-x_e^{\\star})}{(2-x_e^{\\star})(\\Omega_b h^2)^{\\star}}  \\frac{x_e^{\\star}(1-x_e^{\\star})}{(2-x_e^{\\star})(1-Y_p^{\\star})}  0 \\end{pmatrix}}\n$$", "id": "3499136"}]}