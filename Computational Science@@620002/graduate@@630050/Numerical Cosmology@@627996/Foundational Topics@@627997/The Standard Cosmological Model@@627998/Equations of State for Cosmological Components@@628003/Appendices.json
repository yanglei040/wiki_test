{"hands_on_practices": [{"introduction": "Understanding the impact of a dynamic dark energy component begins with its most fundamental consequence: the evolution of its energy density, $\\rho_{\\mathrm{de}}(a)$. This practice focuses on deriving this evolution from first principles by integrating the cosmological continuity equation for the popular Chevallier-Polarski-Linder (CPL) parameterization. Mastering this analytical derivation is a crucial first step before building more complex numerical models, as it provides a direct look into how the equation of state shapes the cosmic background [@problem_id:3470586].", "problem": "In a spatially homogeneous and isotropic Friedmann–Lemaître–Robertson–Walker (FLRW) universe, energy–momentum conservation for a perfect fluid component implies the continuity equation $\\,\\dot{\\rho} + 3 H (\\rho + p) = 0\\,$, where $\\rho$ is the energy density, $p$ is the pressure, and $H$ is the Hubble parameter with $H = \\dot{a}/a$ and $a$ the scale factor. Consider a dark-energy–like component whose pressure satisfies $p = w(a)\\,\\rho$ with equation-of-state parameter given by the Chevallier–Polarski–Linder (CPL) parameterization $\\,w(a) = w_0 + w_a(1 - a)\\,$, where $w_0$ and $w_a$ are constants. Assume the normalization $a_0 = 1$ today and the boundary condition $\\,\\rho(a=1) = \\rho_0\\,$, where $\\rho_0$ is a constant. \n\nStarting only from the energy–momentum conservation law and the definitions above, derive the closed-form analytic expression for the energy density $\\,\\rho(a)\\,$ as a function of $a$ for this CPL parameterization. Express your final result as a single analytic expression in terms of $a$, $w_0$, $w_a$, and $\\rho_0$.", "solution": "The problem is to derive the energy density $\\rho(a)$ for a cosmological component described by the Chevallier–Polarski–Linder (CPL) parameterization of the equation of state, starting from the energy–momentum conservation law in a Friedmann–Lemaître–Robertson–Walker (FLRW) universe.\n\nThe validation of the problem statement proceeds as follows:\n1.  **Extract Givens**:\n    -   Continuity Equation: $\\dot{\\rho} + 3 H (\\rho + p) = 0$\n    -   Hubble Parameter: $H = \\frac{\\dot{a}}{a}$\n    -   Equation of State: $p = w(a)\\rho$\n    -   CPL Parameterization: $w(a) = w_0 + w_a(1 - a)$\n    -   Normalization: $a_0 = 1$\n    -   Boundary Condition: $\\rho(a=1) = \\rho_0$\n\n2.  **Validate**:\n    -   **Scientifically Grounded**: The problem is built upon standard, fundamental equations of physical cosmology (FLRW metric, continuity equation) and a widely used phenomenological model (CPL parameterization). It is scientifically sound.\n    -   **Well-Posed**: The problem is a first-order ordinary differential equation with a given boundary condition. This constitutes a well-posed initial value problem, which is expected to have a unique and stable solution. All terms are clearly and unambiguously defined.\n    -   **Objective**: The problem is stated using formal mathematical and physical language, free of subjectivity or ambiguity.\n\n3.  **Verdict**:\n    -   The problem is deemed valid as it is self-contained, scientifically sound, and well-posed. We may proceed with the solution.\n\nThe derivation begins with the continuity equation for a perfect fluid in an FLRW universe:\n$$\n\\dot{\\rho} + 3 H (\\rho + p) = 0\n$$\nwhere the dot denotes differentiation with respect to cosmological time $t$. We are given the relation $p = w(a)\\rho$. Substituting this into the continuity equation yields:\n$$\n\\dot{\\rho} + 3 H (\\rho + w(a)\\rho) = 0\n$$\n$$\n\\dot{\\rho} + 3 H \\rho (1 + w(a)) = 0\n$$\nThe Hubble parameter is defined as $H = \\frac{\\dot{a}}{a}$. Substituting this definition gives:\n$$\n\\dot{\\rho} + 3 \\frac{\\dot{a}}{a} \\rho (1 + w(a)) = 0\n$$\nThe goal is to find $\\rho$ as a function of the scale factor $a$, so we must change the independent variable from time $t$ to scale factor $a$. Using the chain rule, the time derivative of $\\rho$ can be expressed as:\n$$\n\\dot{\\rho} = \\frac{d\\rho}{dt} = \\frac{d\\rho}{da} \\frac{da}{dt} = \\frac{d\\rho}{da} \\dot{a}\n$$\nSubstituting this into our equation:\n$$\n\\frac{d\\rho}{da} \\dot{a} + 3 \\frac{\\dot{a}}{a} \\rho (1 + w(a)) = 0\n$$\nFor a non-static universe, $\\dot{a} \\neq 0$, so we can divide the entire equation by $\\dot{a}$:\n$$\n\\frac{d\\rho}{da} + \\frac{3}{a} \\rho (1 + w(a)) = 0\n$$\nThis is a first-order linear ordinary differential equation, which is also separable. We rearrange the terms to separate the variables $\\rho$ and $a$:\n$$\n\\frac{d\\rho}{\\rho} = -3 \\frac{1 + w(a)}{a} da\n$$\nTo find the specific solution for $\\rho(a)$, we integrate this equation. The integration limits are determined by the given boundary condition: at $a=1$, the density is $\\rho_0$. We integrate from the state $(a=1, \\rho=\\rho_0)$ to a general state $(a, \\rho(a))$:\n$$\n\\int_{\\rho_0}^{\\rho(a)} \\frac{d\\rho'}{\\rho'} = -3 \\int_{1}^{a} \\frac{1 + w(a')}{a'} da'\n$$\nThe integral on the left side is:\n$$\n\\left[ \\ln(\\rho') \\right]_{\\rho_0}^{\\rho(a)} = \\ln(\\rho(a)) - \\ln(\\rho_0) = \\ln\\left(\\frac{\\rho(a)}{\\rho_0}\\right)\n$$\nFor the integral on the right side, we substitute the CPL parameterization $w(a) = w_0 + w_a(1-a)$:\n$$\n-3 \\int_{1}^{a} \\frac{1 + [w_0 + w_a(1-a')]}{a'} da' = -3 \\int_{1}^{a} \\frac{1 + w_0 + w_a - w_a a'}{a'} da'\n$$\nWe can split the integrand into two parts:\n$$\n-3 \\int_{1}^{a} \\left( \\frac{1 + w_0 + w_a}{a'} - w_a \\right) da'\n$$\nPerforming the integration gives:\n$$\n-3 \\left[ (1 + w_0 + w_a) \\ln(a') - w_a a' \\right]_{1}^{a}\n$$\nEvaluating the expression at the limits of integration ($a'=a$ and $a'=1$):\n$$\n-3 \\left( \\left((1 + w_0 + w_a) \\ln(a) - w_a a\\right) - \\left((1 + w_0 + w_a) \\ln(1) - w_a(1)\\right) \\right)\n$$\nSince $\\ln(1) = 0$, this simplifies to:\n$$\n-3 \\left( (1 + w_0 + w_a) \\ln(a) - w_a a + w_a \\right) = -3 \\left( (1 + w_0 + w_a) \\ln(a) - w_a(a-1) \\right)\n$$\nNow, equating the results from the left and right side integrations:\n$$\n\\ln\\left(\\frac{\\rho(a)}{\\rho_0}\\right) = -3 (1 + w_0 + w_a) \\ln(a) - 3(-w_a(a-1))\n$$\n$$\n\\ln\\left(\\frac{\\rho(a)}{\\rho_0}\\right) = -3(1 + w_0 + w_a) \\ln(a) + 3 w_a(a-1)\n$$\nTo solve for $\\rho(a)$, we exponentiate both sides:\n$$\n\\frac{\\rho(a)}{\\rho_0} = \\exp\\left( -3(1 + w_0 + w_a) \\ln(a) + 3 w_a(a-1) \\right)\n$$\nUsing the properties of logarithms and exponentials, $\\exp(x+y) = \\exp(x)\\exp(y)$ and $\\exp(c \\ln(x)) = x^c$:\n$$\n\\frac{\\rho(a)}{\\rho_0} = \\exp(\\ln(a^{-3(1 + w_0 + w_a)})) \\cdot \\exp(3 w_a(a-1))\n$$\n$$\n\\frac{\\rho(a)}{\\rho_0} = a^{-3(1 + w_0 + w_a)} \\exp(3 w_a(a-1))\n$$\nFinally, multiplying by $\\rho_0$ gives the expression for the energy density $\\rho(a)$. To align the form with the term $(1-a)$ in the definition of $w(a)$, we can write $3w_a(a-1)$ as $-3w_a(1-a)$:\n$$\n\\rho(a) = \\rho_0 a^{-3(1 + w_0 + w_a)} \\exp(-3w_a(1-a))\n$$\nThis is the closed-form analytic expression for the energy density as a function of the scale factor $a$ for the CPL parameterization.", "answer": "$$\\boxed{\\rho_0 a^{-3(1 + w_0 + w_a)} \\exp(-3w_a(1-a))}$$", "id": "3470586"}, {"introduction": "With the evolution of dark energy density in hand, we can explore its impact on observable cosmological quantities. This exercise challenges you to build a numerical solver that propagates the Friedmann equations to compute the expansion history, $H(z)$, and simultaneously solves the linear growth equation to track the formation of large-scale structures. By comparing models with a dynamic equation of state to the standard $\\Lambda$CDM baseline [@problem_id:3470597], you will gain practical experience in simulating cosmic evolution and quantifying the observational signatures of dark energy.", "problem": "You are to design and implement a numerical program that propagates the background cosmology and linear growth of matter density perturbations for a spatially flat Universe with a dark energy component described by the Chevallier–Polarski–Linder (CPL) equation of state. The model specifies a time-dependent equation of state parameter $w(a)$ via $w(a)=w_0+w_a(1-a)$. Your tasks must start from fundamental relations and be derived step by step without using any shortcut formulas beyond those fundamental bases.\n\nFundamental bases you must use:\n- Friedmann equation for a spatially flat Universe: $H^2(a)=\\dfrac{8\\pi G}{3}\\left(\\rho_r(a)+\\rho_m(a)+\\rho_{\\mathrm{de}}(a)\\right)$, with present-day density parameters $H_0$, $\\Omega_{r0}$, $\\Omega_{m0}$, and $\\Omega_{\\mathrm{de}0}=1-\\Omega_{m0}-\\Omega_{r0}$.\n- Conservation equation for dark energy: $\\dfrac{d\\rho_{\\mathrm{de}}}{da}=-3\\dfrac{1+w(a)}{a}\\rho_{\\mathrm{de}}(a)$.\n- Linear growth equation for sub-horizon cold dark matter perturbations in cosmic time $t$: $\\ddot{D}+2H\\dot{D}-4\\pi G\\rho_m D=0$, where $D(a)$ is the growing-mode linear growth factor.\n\nFrom these bases:\n1. Derive $\\rho_{\\mathrm{de}}(a)/\\rho_{\\mathrm{de}0}$ for the CPL form $w(a)=w_0+w_a(1-a)$ by integrating the conservation equation.\n2. Express $H(a)$ using the Friedmann equation with $\\rho_r(a)=\\rho_{r0}a^{-4}$, $\\rho_m(a)=\\rho_{m0}a^{-3}$, and your result for $\\rho_{\\mathrm{de}}(a)$. Define the dimensionless expansion rate $E(a)=H(a)/H_0$.\n3. Recast the linear growth equation using the change of variable $x=\\ln a$ into an ordinary differential equation in $x$, and provide initial conditions appropriate to a matter-dominated regime. State these initial conditions explicitly and justify them from the asymptotic behavior of the growing mode.\n4. Implement a numerical integrator that, given parameters $(w_0,w_a)$, computes:\n   - The Hubble parameter $H(z)$ at specified redshifts $z$ using your derived $H(a)$, with $a=1/(1+z)$. The Hubble parameter must be understood in units of $\\mathrm{km\\ s^{-1}\\ Mpc^{-1}}$, but your program will report only dimensionless ratios as specified below.\n   - The linear growth factor $D(a)$ by solving the growth equation in $x=\\ln a$ from an initial scale factor $a_{\\mathrm{ini}}$ in the matter-dominated era up to $a=1$, and the logarithmic growth rate $f(a)=\\dfrac{d\\ln D}{d\\ln a}$ evaluated at $a=1$.\n\nComparison to baseline:\n- Adopt a baseline model corresponding to the cosmological constant case with $w_0=-1$ and $w_a=0$ (the baseline $\\Lambda$ Cold Dark Matter model). For each test case, compute the fractional differences in the Hubble expansion rate at the target redshifts relative to this baseline, and the difference in the present-day logarithmic growth rate $f(a=1)$ relative to the baseline.\n\nCosmological parameters to use (apply exactly these values in your computation):\n- $H_0=67.66\\ \\mathrm{km\\ s^{-1}\\ Mpc^{-1}}$,\n- $\\Omega_{m0}=0.315$,\n- $\\Omega_{r0}=9.2\\times 10^{-5}$,\n- spatial flatness $\\Omega_{k0}=0$, hence $\\Omega_{\\mathrm{de}0}=1-\\Omega_{m0}-\\Omega_{r0}$.\n\nNumerical specifications and initial conditions:\n- Work with the variable $x=\\ln a$ to integrate the growth equation. Choose an initial scale factor $a_{\\mathrm{ini}}$ in the matter-dominated era, specifically $a_{\\mathrm{ini}}=10^{-3}$, set $D(a_{\\mathrm{ini}})=a_{\\mathrm{ini}}$ and $\\frac{dD}{dx}(a_{\\mathrm{ini}})=D(a_{\\mathrm{ini}})$, consistent with the growing-mode solution $D\\propto a$ in matter domination.\n- Use the redshift set $\\{z=1,\\ z=2\\}$ as comparison points for $H(z)$.\n\nTest suite:\n- Three $(w_0,w_a)$ pairs to evaluate:\n  1. $w_0=-1$, $w_a=0$ (baseline),\n  2. $w_0=-0.9$, $w_a=0.2$ (mildly evolving equation of state),\n  3. $w_0=-1.1$, $w_a=0.3$ (phantom present-day with positive evolution).\n- For each pair, compute a list of three outputs:\n  - $\\left[\\dfrac{H_{\\mathrm{model}}(z=1)-H_{\\Lambda\\mathrm{CDM}}(z=1)}{H_{\\Lambda\\mathrm{CDM}}(z=1)},\\ \\dfrac{H_{\\mathrm{model}}(z=2)-H_{\\Lambda\\mathrm{CDM}}(z=2)}{H_{\\Lambda\\mathrm{CDM}}(z=2)},\\ f_{\\mathrm{model}}(a=1)-f_{\\Lambda\\mathrm{CDM}}(a=1)\\right]$.\n- Each of the three numbers in the list must be reported as a decimal rounded to six places. These outputs are dimensionless. Do not include any unit in the output.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list of the three lists, enclosed in a single pair of square brackets, with no spaces. For example: \"[[x11,x12,x13],[x21,x22,x23],[x31,x32,x33]]\", where each $x_{ij}$ is a decimal number with six places as specified above.\n\nAngle units are not involved. Do not report percentages; all outputs are pure decimals as described.", "solution": "The problem is valid as it is scientifically grounded in the standard model of cosmology, well-posed with sufficient information for a unique solution, and stated objectively. It represents a standard numerical task in physical cosmology. The following steps detail the derivation and implementation plan.\n\n### Step 1: Derivation of the Dark Energy Density Evolution\nThe evolution of the dark energy density $\\rho_{\\mathrm{de}}$ is governed by the conservation equation:\n$$\n\\frac{d\\rho_{\\mathrm{de}}}{da} = -3\\frac{1+w(a)}{a}\\rho_{\\mathrm{de}}(a)\n$$\nThis is a first-order linear ordinary differential equation (ODE) that can be solved by separation of variables. We integrate from the present day ($a=1$, where $\\rho_{\\mathrm{de}} = \\rho_{\\mathrm{de}0}$) to an arbitrary scale factor $a$:\n$$\n\\int_{\\rho_{\\mathrm{de}0}}^{\\rho_{\\mathrm{de}}(a)} \\frac{d\\rho'_{\\mathrm{de}}}{\\rho'_{\\mathrm{de}}} = -3 \\int_1^a \\frac{1+w(a')}{a'} da'\n$$\n$$\n\\ln\\left(\\frac{\\rho_{\\mathrm{de}}(a)}{\\rho_{\\mathrm{de}0}}\\right) = -3 \\int_1^a \\frac{1+w(a')}{a'} da'\n$$\nSubstituting the Chevallier–Polarski–Linder (CPL) parameterization $w(a) = w_0 + w_a(1-a)$:\n$$\n\\ln\\left(\\frac{\\rho_{\\mathrm{de}}(a)}{\\rho_{\\mathrm{de}0}}\\right) = -3 \\int_1^a \\frac{1+w_0+w_a(1-a')}{a'} da' = -3 \\int_1^a \\left(\\frac{1+w_0+w_a}{a'} - w_a\\right) da'\n$$\nPerforming the integration:\n$$\n\\ln\\left(\\frac{\\rho_{\\mathrm{de}}(a)}{\\rho_{\\mathrm{de}0}}\\right) = -3 \\left[ (1+w_0+w_a)\\ln(a') - w_a a' \\right]_1^a\n$$\n$$\n\\ln\\left(\\frac{\\rho_{\\mathrm{de}}(a)}{\\rho_{\\mathrm{de}0}}\\right) = -3 \\left\\{ \\left((1+w_0+w_a)\\ln(a) - w_a a\\right) - \\left((1+w_0+w_a)\\ln(1) - w_a(1)\\right) \\right\\}\n$$\n$$\n\\ln\\left(\\frac{\\rho_{\\mathrm{de}}(a)}{\\rho_{\\mathrm{de}0}}\\right) = -3(1+w_0+w_a)\\ln(a) + 3w_a(a-1)\n$$\nExponentiating both sides yields the desired expression for the dark energy density ratio:\n$$\n\\frac{\\rho_{\\mathrm{de}}(a)}{\\rho_{\\mathrm{de}0}} = e^{-3(1+w_0+w_a)\\ln(a) + 3w_a(a-1)} = a^{-3(1+w_0+w_a)} e^{3w_a(a-1)}\n$$\n\n### Step 2: Derivation of the Hubble Parameter $H(a)$\nThe Friedmann equation for a spatially flat Universe is:\n$$\nH^2(a) = \\frac{8\\pi G}{3} \\left(\\rho_r(a) + \\rho_m(a) + \\rho_{\\mathrm{de}}(a)\\right)\n$$\nAt the present day ($a=1$), this becomes $H_0^2 = \\frac{8\\pi G}{3} \\rho_{c,0}$, where $\\rho_{c,0}$ is the critical density today. The density parameters are defined as $\\Omega_{i0} = \\rho_{i0} / \\rho_{c,0}$. We can express the evolution of each component's density relative to the present-day critical density:\n- Radiation: $\\rho_r(a) = \\rho_{r0} a^{-4} = \\Omega_{r0} \\rho_{c,0} a^{-4}$\n- Matter: $\\rho_m(a) = \\rho_{m0} a^{-3} = \\Omega_{m0} \\rho_{c,0} a^{-3}$\n- Dark Energy: $\\rho_{\\mathrm{de}}(a) = \\rho_{\\mathrm{de}0} \\left(\\frac{\\rho_{\\mathrm{de}}(a)}{\\rho_{\\mathrm{de}0}}\\right) = \\Omega_{\\mathrm{de}0} \\rho_{c,0} a^{-3(1+w_0+w_a)} e^{3w_a(a-1)}$\n\nSubstituting these into the Friedmann equation:\n$$\nH^2(a) = \\frac{8\\pi G}{3} \\rho_{c,0} \\left( \\Omega_{r0} a^{-4} + \\Omega_{m0} a^{-3} + \\Omega_{\\mathrm{de}0} a^{-3(1+w_0+w_a)} e^{3w_a(a-1)} \\right)\n$$\nDividing by $H_0^2$ gives the square of the dimensionless expansion rate, $E(a) = H(a)/H_0$:\n$$\nE^2(a) = \\Omega_{r0} a^{-4} + \\Omega_{m0} a^{-3} + \\Omega_{\\mathrm{de}0} a^{-3(1+w_0+w_a)} e^{3w_a(a-1)}\n$$\nwhere $\\Omega_{\\mathrm{de}0} = 1 - \\Omega_{m0} - \\Omega_{r0}$ due to the spatial flatness assumption ($\\Omega_{k0}=0$).\n\n### Step 3: Recasting the Linear Growth Equation\nThe linear growth equation for matter perturbations $D$ is given in cosmic time $t$:\n$$\n\\ddot{D} + 2H\\dot{D} - 4\\pi G\\rho_m D = 0\n$$\nwhere dots denote derivatives with respect to $t$. We change the independent variable to $x = \\ln a$. The chain rule for time derivatives is $\\frac{d}{dt} = \\frac{dx}{dt}\\frac{d}{dx} = \\frac{\\dot{a}}{a}\\frac{d}{dx} = H\\frac{d}{dx}$.\nLetting $D' = dD/dx$ and $D'' = d^2D/dx^2$:\n- $\\dot{D} = H D'$\n- $\\ddot{D} = \\frac{d}{dt}(HD') = \\dot{H}D' + H\\dot{D'} = (H\\frac{dH}{dx})D' + H(HD'') = H\\frac{dH}{dx}D' + H^2D''$\n\nSubstituting these into the growth equation:\n$$\n\\left(H\\frac{dH}{dx}D' + H^2D''\\right) + 2H(HD') - 4\\pi G\\rho_m D = 0\n$$\nDividing by $H^2$:\n$$\nD'' + \\left(\\frac{1}{H}\\frac{dH}{dx} + 2\\right)D' - \\frac{4\\pi G\\rho_m}{H^2} D = 0\n$$\nWe simplify the coefficients. The coefficient of $D'$ is:\n$$\n\\frac{1}{H}\\frac{dH}{dx} + 2 = \\frac{d\\ln H}{dx} + 2 = \\frac{1}{2}\\frac{d\\ln(H^2)}{dx} + 2 = \\frac{1}{2}\\frac{d\\ln(E^2)}{dx} + 2\n$$\nThe coefficient of $D$ is:\n$$\n-\\frac{4\\pi G\\rho_m}{H^2} = -\\frac{4\\pi G\\rho_m}{\\frac{8\\pi G}{3}(\\rho_r+\\rho_m+\\rho_{de})} = -\\frac{3}{2} \\frac{\\rho_m(a)}{\\rho_{tot}(a)} = -\\frac{3}{2}\\Omega_m(a)\n$$\nwhere $\\Omega_m(a) = \\frac{\\Omega_{m0}a^{-3}}{E^2(a)}$. The final ODE in $x = \\ln a$ is:\n$$\nD''(x) + \\left(2 + \\frac{1}{2E^2(x)}\\frac{dE^2(x)}{dx}\\right) D'(x) - \\frac{3}{2}\\frac{\\Omega_{m0}e^{-3x}}{E^2(x)} D(x) = 0\n$$\n\n**Initial Conditions:** In the early, matter-dominated era ($a \\ll 1$), the growing mode solution to the growth equation is $D(a) \\propto a$. We choose a normalization such that $D(a) = a$. The initial conditions are set at $a_{\\mathrm{ini}}=10^{-3}$, corresponding to $x_{\\mathrm{ini}} = \\ln(10^{-3})$.\n1. $D(x_{\\mathrm{ini}}) = a_{\\mathrm{ini}} = 10^{-3}$.\n2. The derivative is $D'(x) = \\frac{dD}{d\\ln a} = a\\frac{dD}{da} = a\\frac{d(a)}{da} = a$. Thus, $D'(x_{\\mathrm{ini}}) = a_{\\mathrm{ini}} = 10^{-3}$.\nThese initial conditions, $D(a_{\\mathrm{ini}}) = a_{\\mathrm{ini}}$ and $D'(a_{\\mathrm{ini}}) = a_{\\mathrm{ini}}$, are appropriate for the growing-mode solution deep in the matter-dominated epoch.\n\n### Step 4: Numerical Implementation Plan\nThe solution requires implementing a numerical integrator for the second-order ODE derived above. We will convert it into a system of two first-order ODEs. Let $Y(x) = [D(x), D'(x)]^T$. The system is:\n$$\n\\frac{dY}{dx} = \\begin{pmatrix} D'(x) \\\\ D''(x) \\end{pmatrix} = \\begin{pmatrix} Y_2(x) \\\\ -\\left(2 + \\frac{1}{2E^2}\\frac{dE^2}{dx}\\right) Y_2(x) + \\frac{3}{2}\\frac{\\Omega_{m0}e^{-3x}}{E^2} Y_1(x) \\end{pmatrix}\n$$\nThe term $\\frac{dE^2}{dx}$ is calculated analytically:\n$$\n\\frac{dE^2}{dx} = a\\frac{dE^2}{da} = a\\frac{d}{da}\\left( \\Omega_{r0} a^{-4} + \\Omega_{m0} a^{-3} + \\Omega_{\\mathrm{de}0} f_{\\mathrm{de}}(a) \\right)\n$$\n$$\n\\frac{dE^2}{dx} = -4\\Omega_{r0}a^{-4} - 3\\Omega_{m0}a^{-3} + \\Omega_{\\mathrm{de}0} a \\frac{df_{\\mathrm{de}}}{da}\n$$\nFrom the conservation equation, $a \\frac{df_{\\mathrm{de}}}{da} = -3(1+w(a))f_{\\mathrm{de}}(a)$. Therefore:\n$$\n\\frac{dE^2}{dx} = -4\\Omega_{r0}a^{-4} - 3\\Omega_{m0}a^{-3} - 3(1+w(a))\\Omega_{\\mathrm{de}0}f_{\\mathrm{de}}(a)\n$$\nThis system will be integrated from $x_{\\mathrm{ini}} = \\ln(10^{-3})$ to $x_{\\mathrm{f}} = \\ln(1) = 0$ using `scipy.integrate.solve_ivp`. At the final step, we evaluate the logarithmic growth rate $f(a=1) = \\frac{d\\ln D}{d\\ln a}\\bigg|_{a=1} = \\frac{D'(x=0)}{D(x=0)}$.\nFor each of the three test cases $(w_0, w_a)$, we will:\n1.  Calculate $H(z)$ at $z=1$ and $z=2$ using $H(z) = H_0 E(a=1/(1+z))$. Note that for fractional differences, the $H_0$ term cancels, so we only need $E(z)$.\n2.  Solve the growth ODE to find $f(a=1)$.\n3.  The results will then be compared to the baseline $\\Lambda$CDM model $(w_0=-1, w_a=0)$ to compute the specified fractional and absolute differences.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Solves for cosmological observables for different dark energy models.\n    \"\"\"\n    \n    # Cosmological parameters\n    OMEGA_M0 = 0.315\n    OMEGA_R0 = 9.2e-5\n    OMEGA_DE0 = 1.0 - OMEGA_M0 - OMEGA_R0\n    \n    # Numerical specifications\n    A_INI = 1e-3\n    REDSHIFTS = np.array([1.0, 2.0])\n    \n    # Test suite: (w0, wa) pairs\n    test_cases = [\n        (-1.0, 0.0),      # Case 1: Baseline LambdaCDM\n        (-0.9, 0.2),      # Case 2: Mildly evolving\n        (-1.1, 0.3),      # Case 3: Phantom\n    ]\n\n    def E_squared(a, w0, wa):\n        \"\"\"\n        Computes the squared dimensionless Hubble parameter E^2(a).\n        \"\"\"\n        de_term = OMEGA_DE0 * (a ** (-3.0 * (1.0 + w0 + wa))) * np.exp(3.0 * wa * (a - 1.0))\n        return OMEGA_R0 * a**-4.0 + OMEGA_M0 * a**-3.0 + de_term\n\n    def get_observables(w0, wa):\n        \"\"\"\n        Calculates H(z) ratios and f(a=1) for a given CPL model.\n        \"\"\"\n        # Calculate E(z) = H(z)/H0\n        a_vals_z = 1.0 / (1.0 + REDSHIFTS)\n        E_vals = np.sqrt([E_squared(a, w0, wa) for a in a_vals_z])\n\n        # Define the ODE system for the growth factor D(x), where x = ln(a)\n        # Y = [D, D']\n        def growth_ode(x, y, w0_param, wa_param):\n            a = np.exp(x)\n            D_val, D_prime = y\n            \n            # Equation of state at scale factor a\n            w_a = w0_param + wa_param * (1.0 - a)\n            \n            # Dark energy density contribution to E^2\n            de_term_in_e2 = OMEGA_DE0 * (a ** (-3.0 * (1.0 + w0_param + wa_param))) * np.exp(3.0 * wa_param * (a - 1.0))\n            \n            # E^2(a)\n            e2_val = OMEGA_R0 * a**-4.0 + OMEGA_M0 * a**-3.0 + de_term_in_e2\n            \n            # Derivative of E^2 with respect to x=ln(a)\n            # d(E^2)/dx = a * d(E^2)/da\n            de2_dx = -4.0 * OMEGA_R0 * a**-4.0 \\\n                     -3.0 * OMEGA_M0 * a**-3.0 \\\n                     -3.0 * (1.0 + w_a) * de_term_in_e2\n\n            # The second-order ODE for D(x)\n            # D'' + (2 + 1/(2*E^2) * d(E^2)/dx) * D' - (3/2 * Omega_m(a)) * D = 0\n            # Omega_m(a) = Omega_m0 * a^-3 / E^2\n            D_double_prime = - (2.0 + 0.5 * de2_dx / e2_val) * D_prime \\\n                             + 1.5 * (OMEGA_M0 * a**-3.0) / e2_val * D_val\n                             \n            return [D_prime, D_double_prime]\n\n        # Initial conditions at a_ini in the matter-dominated era\n        x_ini = np.log(A_INI)\n        D_ini = A_INI\n        D_prime_ini = A_INI\n        y0 = [D_ini, D_prime_ini]\n\n        # Integration range from x_ini to x_final = ln(1) = 0\n        x_span = [x_ini, 0.0]\n        \n        # We only need the solution at the final point a=1 (x=0)\n        sol = solve_ivp(growth_ode, x_span, y0, args=(w0, wa), t_eval=[0.0], method='RK45', rtol=1e-8, atol=1e-8)\n        \n        # Final state Y(x=0) = [D(a=1), D'(a=1)]\n        D_final, D_prime_final = sol.y[:, -1]\n        \n        # Logarithmic growth rate f(a) = d(ln D) / d(ln a) = D' / D\n        f_a1 = D_prime_final / D_final\n        \n        return E_vals[0], E_vals[1], f_a1\n\n    # Calculate baseline LCDM results\n    E_lcdm_z1, E_lcdm_z2, f_lcdm_a1 = get_observables(w0=-1.0, wa=0.0)\n\n    # Store results for all test cases\n    final_results = []\n    \n    for w0_model, wa_model in test_cases:\n        E_model_z1, E_model_z2, f_model_a1 = get_observables(w0_model, wa_model)\n        \n        # Fractional difference in H(z) (which is same as fractional diff in E(z))\n        h_frac_z1 = (E_model_z1 - E_lcdm_z1) / E_lcdm_z1\n        h_frac_z2 = (E_model_z2 - E_lcdm_z2) / E_lcdm_z2\n        \n        # Absolute difference in f(a=1)\n        f_diff_a1 = f_model_a1 - f_lcdm_a1\n        \n        case_results = [\n            f\"{h_frac_z1:.6f}\",\n            f\"{h_frac_z2:.6f}\",\n            f\"{f_diff_a1:.6f}\"\n        ]\n        final_results.append(f\"[{','.join(case_results)}]\")\n\n    # Print the final output in the specified format\n    print(f\"[{','.join(final_results)}]\")\n\nsolve()\n```", "id": "3470597"}, {"introduction": "While simple parameterizations are useful for dark energy, other cosmological components like massive neutrinos require a more detailed treatment rooted in statistical mechanics. This practice moves beyond simple fluid descriptions to compute the energy density and pressure of neutrinos directly from their Fermi-Dirac phase-space distribution. By implementing a numerical quadrature and validating your results against known physical limits [@problem_id:3470587], you will develop the skills to model components whose equation of state is not a simple function of time but is determined by their evolving thermal properties.", "problem": "Implement a complete program that computes the energy density $ \\rho(a) $ and pressure $ p(a) $ of a single massive neutrino species in a spatially flat Friedmann–Robertson–Walker (FRW) universe by performing a numerical quadrature over the equilibrium Fermi–Dirac phase-space distribution, and validates the numerical results against the ultra-relativistic and nonrelativistic limiting cases.\n\nYou must start from the following fundamental base:\n- The physical energy density and pressure of a decoupled species with isotropic phase-space distribution $ f $ are, by definition,\n$$\n\\rho = g \\int \\frac{d^3 k}{(2\\pi)^3}\\, E(k)\\, f,\\qquad\np = g \\int \\frac{d^3 k}{(2\\pi)^3}\\, \\frac{k^2}{3 E(k)}\\, f,\n$$\nwhere $ g $ is the internal degrees of freedom, $ k $ is the physical momentum magnitude, and $ E(k) = \\sqrt{k^2 + m^2} $ with $ m $ the particle mass.\n- For a decoupled neutrino in kinetic equilibrium with zero chemical potential, the equilibrium Fermi–Dirac distribution in terms of the comoving momentum $ q $ is $ f_0(q) = 1/(\\exp(q)+1) $, where $ q \\equiv a k / T_{\\nu 0} $ and $ T_{\\nu 0} $ is the present-day neutrino temperature. The present-day neutrino temperature is $ T_{\\nu 0} = \\left(\\frac{4}{11}\\right)^{1/3} T_{\\gamma 0} $, with photon temperature $ T_{\\gamma 0} $. You must take $ T_{\\gamma 0} = 2.7255\\,\\mathrm{K} $ and use Boltzmann’s constant $ k_{\\mathrm{B}} = 8.617333262145\\times 10^{-5}\\,\\mathrm{eV/K} $ to express temperatures in electronvolts. Work in natural units where $ c = \\hbar = k_{\\mathrm{B}} = 1 $, so that $ \\rho $ and $ p $ are in units of $ \\mathrm{eV}^4 $.\n- Consider a single Majorana neutrino species including particle and antiparticle, so take $ g = 2 $.\n\nFrom these definitions, derive expressions suitable for numerical quadrature as functions of the scale factor $ a $ and mass $ m $ using $ f_0(q) $ and the change of variables from physical momentum to comoving momentum. Implement a numerical quadrature that evaluates $ \\rho(a) $ and $ p(a) $ with high relative accuracy for a wide range of $ a $ and $ m $.\n\nDefine the equation-of-state parameter $ w(a) \\equiv p(a)/\\rho(a) $. Validate your code by comparing to the following analytically known limits derived from the same base:\n- Ultra-relativistic (UR) limit $ a m / T_{\\nu 0} \\to 0 $: $ w \\to 1/3 $ and $ \\rho / T^4 \\to g \\times \\frac{7}{8}\\times \\frac{\\pi^2}{30} $, where $ T(a) \\equiv T_{\\nu 0}/a $.\n- Nonrelativistic (NR) limit $ a m / T_{\\nu 0} \\to \\infty $: $ w \\to 0 $ with leading behavior $ w \\approx \\frac{1}{3} \\frac{\\int_0^\\infty dq\\, q^4 f_0(q)}{\\int_0^\\infty dq\\, q^2 f_0(q)} \\left(\\frac{T_{\\nu 0}}{a m}\\right)^2 $, and $ \\rho(a) \\approx \\frac{g\\, m\\, T_{\\nu 0}^3}{2\\pi^2 a^3} \\int_0^\\infty dq\\, q^2 f_0(q) $.\n\nYour program must:\n- Use numerical quadrature to compute $ \\rho(a) $ and $ p(a) $ from first principles.\n- Compute $ w(a) $ and appropriate validation errors for the limiting cases as specified below.\n- Express all intermediate energies and temperatures in $ \\mathrm{eV} $, and $ \\rho $ and $ p $ in $ \\mathrm{eV}^4 $. The final reported $ w $ and error metrics are dimensionless.\n\nImplement and run the following test suite of parameter values:\n- Test $ 1 $ (UR): $ a = 10^{-8} $, $ m = 0.1\\,\\mathrm{eV} $. Report:\n  - $ w_1 $,\n  - the relative error of $ w $ from $ 1/3 $, i.e., $ \\left| w_1 - \\frac{1}{3} \\right| / \\left(\\frac{1}{3}\\right) $,\n  - the relative error of $ \\rho / T^4 $ from $ g \\times \\frac{7}{8}\\times \\frac{\\pi^2}{30} $.\n- Test $ 2 $ (NR): $ a = 1 $, $ m = 0.1\\,\\mathrm{eV} $. Report:\n  - $ w_2 $,\n  - the relative error of $ w $ from the leading-order NR asymptotic $ w_{\\mathrm{NR,LO}} = \\frac{1}{3} \\frac{\\int dq\\, q^4 f_0}{\\int dq\\, q^2 f_0}\\left(\\frac{T_{\\nu 0}}{a m}\\right)^2 $,\n  - the relative error of $ \\rho $ from the leading-order NR asymptotic $ \\rho_{\\mathrm{NR,LO}} = \\frac{g\\, m\\, T_{\\nu 0}^3}{2\\pi^2 a^3} \\int dq\\, q^2 f_0 $.\n- Test $ 3 $ (massless boundary): $ a = 1 $, $ m = 0\\,\\mathrm{eV} $. Report:\n  - $ w_3 $,\n  - the relative error of $ w $ from $ 1/3 $,\n  - the relative error of $ \\rho / T^4 $ from $ g \\times \\frac{7}{8}\\times \\frac{\\pi^2}{30} $.\n- Test $ 4 $ (intermediate): $ a = T_{\\nu 0}/m $ with $ m = 0.1\\,\\mathrm{eV} $. Report:\n  - $ w_4 $ only.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $ [\\text{result}_1,\\text{result}_2,\\text{result}_3] $) in the exact order:\n$ [w_1,\\ \\mathrm{relErr}(w_1,\\tfrac{1}{3}),\\ \\mathrm{relErr}(\\rho_1/T^4, g\\times \\tfrac{7}{8}\\times \\tfrac{\\pi^2}{30}),\\ w_2,\\ \\mathrm{relErr}(w_2, w_{\\mathrm{NR,LO}}),\\ \\mathrm{relErr}(\\rho_2,\\rho_{\\mathrm{NR,LO}}),\\ w_3,\\ \\mathrm{relErr}(w_3,\\tfrac{1}{3}),\\ \\mathrm{relErr}(\\rho_3/T^4, g\\times \\tfrac{7}{8}\\times \\tfrac{\\pi^2}{30}),\\ w_4] $.\n\nAll angles, if any appear, must be in radians. All fractions must be represented as decimals in the final output, not with a percent sign. Ensure numerical quadrature tolerances are sufficiently tight that all relative errors reported are meaningful (not dominated by numerical noise).", "solution": "The objective is to compute the energy density $\\rho(a)$ and pressure $p(a)$ for a single massive neutrino species in a Friedmann–Robertson–Walker (FRW) universe. We will start from the provided first principles, derive expressions suitable for numerical integration, and then implement a program to compute these quantities and validate them against known analytical limits.\n\nFirst, we establish the necessary physical constants in the required units of electronvolts ($\\mathrm{eV}$), adhering to the natural units convention ($c=\\hbar=k_{\\mathrm{B}}=1$).\nThe present-day photon temperature is given as $T_{\\gamma 0} = 2.7255\\,\\mathrm{K}$. Using the provided value for Boltzmann's constant, $k_{\\mathrm{B}} = 8.617333262145\\times 10^{-5}\\,\\mathrm{eV/K}$, we convert this to electronvolts:\n$$\nT_{\\gamma 0, \\mathrm{eV}} = k_{\\mathrm{B}} T_{\\gamma 0} = (8.617333262145\\times 10^{-5}\\,\\mathrm{eV/K}) \\times (2.7255\\,\\mathrm{K}) \\approx 2.34865 \\times 10^{-4}\\,\\mathrm{eV}\n$$\nThe present-day neutrino temperature, $T_{\\nu 0}$, is related to the photon temperature by $T_{\\nu 0} = (4/11)^{1/3} T_{\\gamma 0}$. In electronvolts, this is:\n$$\nT_{\\nu 0} = \\left(\\frac{4}{11}\\right)^{1/3} T_{\\gamma 0, \\mathrm{eV}} \\approx 0.713766 \\times (2.34865 \\times 10^{-4}\\,\\mathrm{eV}) \\approx 1.94537 \\times 10^{-4}\\,\\mathrm{eV}\n$$\nThe number of internal degrees of freedom for a single Majorana neutrino species (including its antiparticle) is given as $g=2$.\n\nThe fundamental definitions for energy density $\\rho$ and pressure $p$ for a species with an isotropic phase-space distribution $f$ are:\n$$\n\\rho = g \\int \\frac{d^3 k}{(2\\pi)^3}\\, E(k)\\, f, \\qquad\np = g \\int \\frac{d^3 k}{(2\\pi)^3}\\, \\frac{k^2}{3 E(k)}\\, f\n$$\nwhere $k$ is the physical momentum magnitude and $E(k) = \\sqrt{k^2 + m^2}$ is the energy. For an isotropic distribution, the momentum-space volume element is $d^3 k = 4\\pi k^2 dk$.\n\nThe problem states that neutrinos are decoupled and follow the equilibrium Fermi–Dirac distribution $f_0(q) = 1/(\\exp(q)+1)$, where $q$ is the dimensionless comoving momentum, defined as $q = ak/T_{\\nu 0}$. Here, $a$ is the cosmological scale factor. To evaluate the integrals, we must perform a change of variables from physical momentum $k$ to comoving momentum $q$:\n$$\nk = q \\frac{T_{\\nu 0}}{a} \\implies dk = \\frac{T_{\\nu 0}}{a} dq\n$$\nThe momentum-space volume element becomes:\n$$\nd^3 k = 4\\pi k^2 dk = 4\\pi \\left(q \\frac{T_{\\nu 0}}{a}\\right)^2 \\left(\\frac{T_{\\nu 0}}{a} dq\\right) = 4\\pi \\left(\\frac{T_{\\nu 0}}{a}\\right)^3 q^2 dq\n$$\nThe energy $E(k)$ can also be expressed in terms of $q$, $a$, and $m$:\n$$\nE(k) = \\sqrt{k^2 + m^2} = \\sqrt{\\left(q \\frac{T_{\\nu 0}}{a}\\right)^2 + m^2} = \\frac{T_{\\nu 0}}{a} \\sqrt{q^2 + \\left(\\frac{am}{T_{\\nu 0}}\\right)^2}\n$$\nLet us define the dimensionless parameter $x \\equiv am/T_{\\nu 0}$, which characterizes the transition from the ultra-relativistic ($x \\ll 1$) to the non-relativistic ($x \\gg 1$) regime. The energy is then $E(q) = (T_{\\nu 0}/a)\\sqrt{q^2 + x^2}$.\n\nSubstituting these expressions into the integrals for $\\rho$ and $p$:\n$$\n\\rho(a, m) = g \\int_0^\\infty \\frac{4\\pi q^2 dq}{(2\\pi)^3} \\left(\\frac{T_{\\nu 0}}{a}\\right)^3 \\left(\\frac{T_{\\nu 0}}{a} \\sqrt{q^2 + x^2}\\right) \\frac{1}{e^q+1}\n$$\n$$\np(a, m) = g \\int_0^\\infty \\frac{4\\pi q^2 dq}{(2\\pi)^3} \\left(\\frac{T_{\\nu 0}}{a}\\right)^3 \\frac{(q T_{\\nu 0}/a)^2}{3 (T_{\\nu 0}/a) \\sqrt{q^2 + x^2}} \\frac{1}{e^q+1}\n$$\nSimplifying the prefactors yields the final expressions suitable for numerical quadrature:\n$$\n\\rho(a, m) = \\frac{g}{2\\pi^2} \\left(\\frac{T_{\\nu 0}}{a}\\right)^4 \\int_0^\\infty dq\\, q^2 \\sqrt{q^2 + x^2} \\frac{1}{e^q+1}\n$$\n$$\np(a, m) = \\frac{g}{6\\pi^2} \\left(\\frac{T_{\\nu 0}}{a}\\right)^4 \\int_0^\\infty dq\\, \\frac{q^4}{\\sqrt{q^2 + x^2}} \\frac{1}{e^q+1}\n$$\nThese equations form the basis of our numerical computation. The equation of state parameter is $w(a, m) = p(a, m)/\\rho(a, m)$.\n\nFor validation, we consider the analytical limits.\nIn the ultra-relativistic (UR) limit, $x = am/T_{\\nu 0} \\to 0$. The expressions simplify to:\n$$\n\\rho_{\\mathrm{UR}}(a) = \\frac{g}{2\\pi^2} \\left(\\frac{T_{\\nu 0}}{a}\\right)^4 \\int_0^\\infty \\frac{q^3}{e^q+1} dq\n$$\n$$\np_{\\mathrm{UR}}(a) = \\frac{g}{6\\pi^2} \\left(\\frac{T_{\\nu 0}}{a}\\right)^4 \\int_0^\\infty \\frac{q^3}{e^q+1} dq = \\frac{1}{3}\\rho_{\\mathrm{UR}}(a)\n$$\nThis immediately gives $w_{\\mathrm{UR}} = 1/3$. The integral is a standard Fermi-Dirac integral: $\\int_0^\\infty \\frac{q^3}{e^q+1}dq = \\frac{7\\pi^4}{120}$. With the neutrino temperature at scale factor $a$ defined as $T(a) = T_{\\nu 0}/a$, we get:\n$$\n\\rho_{\\mathrm{UR}}(a) = \\frac{g T(a)^4}{2\\pi^2} \\frac{7\\pi^4}{120} = g T(a)^4 \\frac{7\\pi^2}{240} = g T(a)^4 \\left(\\frac{7}{8}\\frac{\\pi^2}{30}\\right)\n$$\nThis matches the provided validation formula.\n\nIn the non-relativistic (NR) limit, $x = am/T_{\\nu 0} \\to \\infty$. We use Taylor expansions for the energy term: $\\sqrt{q^2+x^2} = x\\sqrt{1+q^2/x^2} \\approx x(1 + q^2/(2x^2))$.\nThe leading-order term for $\\rho$ is:\n$$\n\\rho(a, m) \\approx \\frac{g}{2\\pi^2} \\left(\\frac{T_{\\nu 0}}{a}\\right)^4 \\int_0^\\infty dq\\, q^2 (x) \\frac{1}{e^q+1} = \\frac{g m T_{\\nu 0}^3}{2\\pi^2 a^3} \\int_0^\\infty \\frac{q^2}{e^q+1} dq\n$$\nThis expression is denoted $\\rho_{\\mathrm{NR,LO}}$ and matches the problem's definition.\nFor pressure, $1/\\sqrt{q^2+x^2} \\approx 1/x$.\n$$\np(a, m) \\approx \\frac{g}{6\\pi^2} \\left(\\frac{T_{\\nu 0}}{a}\\right)^4 \\int_0^\\infty dq\\, \\frac{q^4}{x} \\frac{1}{e^q+1} = \\frac{g T_{\\nu 0}^5}{6\\pi^2 a^5 m} \\int_0^\\infty \\frac{q^4}{e^q+1} dq\n$$\nThe equation of state parameter $w=p/\\rho$ is then approximated by the ratio of these expressions:\n$$\nw_{\\mathrm{NR,LO}} = \\frac{\\frac{g T_{\\nu 0}^5}{6\\pi^2 a^5 m} \\int \\frac{q^4}{e^q+1} dq}{\\frac{g m T_{\\nu 0}^3}{2\\pi^2 a^3} \\int \\frac{q^2}{e^q+1} dq} = \\frac{1}{3} \\left(\\frac{T_{\\nu 0}}{am}\\right)^2 \\frac{\\int_0^\\infty \\frac{q^4}{e^q+1}dq}{\\int_0^\\infty \\frac{q^2}{e^q+1}dq}\n$$\nThis also matches the provided formula for $w_{\\mathrm{NR,LO}}$. The definite integrals involving $q^2$ and $q^4$ will be computed numerically to high precision.\n\nThe algorithm for the program will be:\n1. Define all physical and mathematical constants.\n2. Implement functions for the integrands of $\\rho$ and $p$.\n3. For each test case $(a, m)$:\n   a. Compute the parameter $x = am/T_{\\nu 0}$.\n   b. Use a numerical quadrature routine (`scipy.integrate.quad`) to evaluate the integrals for $\\rho$ and $p$.\n   c. Assemble the full values of $\\rho(a,m)$ and $p(a,m)$.\n   d. Calculate the equation of state parameter $w = p/\\rho$.\n   e. For validation cases, compute the analytical approximations and the corresponding relative errors.\n4. Collect and print the results in the specified format.", "answer": "```python\nimport numpy as np\nfrom scipy.integrate import quad\n\ndef solve():\n    \"\"\"\n    Computes neutrino energy density, pressure, and equation of state,\n    and validates against analytical limits.\n    \"\"\"\n    # Physical constants\n    K_B = 8.617333262145e-5  # eV/K\n    T_GAMMA0_K = 2.7255  # K\n    G_NU = 2.0  # Degrees of freedom for one Majorana neutrino species\n\n    # Derived constants in eV\n    T_GAMMA0_EV = K_B * T_GAMMA0_K\n    T_NU0_EV = (4.0 / 11.0)**(1.0 / 3.0) * T_GAMMA0_EV\n\n    # Test cases from the problem statement\n    # Format: (a, m_eV, test_type)\n    test_cases_params = [\n        (1e-8, 0.1, 'UR'),\n        (1.0, 0.1, 'NR'),\n        (1.0, 0.0, 'Massless'),\n        (T_NU0_EV / 0.1, 0.1, 'Intermediate'),\n    ]\n\n    results = []\n\n    # Pre-calculate integrals for analytical limits with high precision\n    # Use lambda functions for the Fermi-Dirac distribution integrands\n    f0 = lambda q: 1.0 / (np.exp(q) + 1.0)\n    try:\n        integral_q2f0, _ = quad(lambda q: q**2 * f0(q), 0, np.inf)\n        integral_q3f0, _ = quad(lambda q: q**3 * f0(q), 0, np.inf)\n        integral_q4f0, _ = quad(lambda q: q**4 * f0(q), 0, np.inf)\n    except Exception as e:\n        print(f\"Error during pre-calculation of integrals: {e}\")\n        return\n\n    # UR limit constant for rho/T^4\n    # rho_ur / T^4 = g * (7/8) * (pi^2/30)\n    rho_over_T4_ur_analytic = G_NU * (7.0 / 8.0) * (np.pi**2 / 30.0)\n    \n    # Loop through test cases\n    for i, (a, m_ev, test_type) in enumerate(test_cases_params):\n        x = a * m_ev / T_NU0_EV\n        \n        # Integrands for rho and p. Handle m=0 case separately for numerical stability.\n        if m_ev == 0.0:\n            rho_integrand = lambda q: q**3 * f0(q)\n            p_integrand = lambda q: q**3 * f0(q) / 3.0\n            prefactor = G_NU / (2.0 * np.pi**2) * (T_NU0_EV / a)**4\n        else:\n            sqrt_term = lambda q: np.sqrt(q**2 + x**2)\n            rho_integrand = lambda q: q**2 * sqrt_term(q) * f0(q)\n            p_integrand = lambda q: q**4 / (3.0 * sqrt_term(q)) * f0(q)\n            prefactor = G_NU / (2.0 * np.pi**2) * (T_NU0_EV / a)**4\n\n        # Perform numerical quadrature\n        try:\n            rel_tol = 1e-13\n            abs_tol = 0\n            integral_rho, _ = quad(rho_integrand, 0, np.inf, epsabs=abs_tol, epsrel=rel_tol)\n            integral_p, _ = quad(p_integrand, 0, np.inf, epsabs=abs_tol, epsrel=rel_tol)\n        except Exception as e:\n            print(f\"Error during quadrature for test case {i+1}: {e}\")\n            continue\n\n        # Calculate rho, p, and w\n        rho = prefactor * integral_rho\n        p = prefactor * integral_p\n        w = p / rho if rho != 0 else 0\n\n        if test_type == 'UR':\n            # Report w, relErr(w, 1/3), relErr(rho/T^4, ...)\n            w_val = w\n            \n            w_analytic = 1.0/3.0\n            rel_err_w = np.abs(w_val - w_analytic) / w_analytic\n            \n            T_nu_a = T_NU0_EV / a\n            rho_over_T4_numeric = rho / T_nu_a**4\n            rel_err_rho = np.abs(rho_over_T4_numeric - rho_over_T4_ur_analytic) / rho_over_T4_ur_analytic\n            \n            results.extend([w_val, rel_err_w, rel_err_rho])\n\n        elif test_type == 'NR':\n            # Report w, relErr(w, w_nr_lo), relErr(rho, rho_nr_lo)\n            w_val = w\n            \n            # NR leading order approximations\n            w_nr_lo = (1.0 / 3.0) * (integral_q4f0 / integral_q2f0) * (T_NU0_EV / (a * m_ev))**2\n            rho_nr_lo = (G_NU * m_ev * T_NU0_EV**3) / (2.0 * np.pi**2 * a**3) * integral_q2f0\n\n            rel_err_w = np.abs(w_val - w_nr_lo) / w_nr_lo\n            rel_err_rho = np.abs(rho - rho_nr_lo) / rho_nr_lo\n            \n            results.extend([w_val, rel_err_w, rel_err_rho])\n\n        elif test_type == 'Massless':\n            # Report w, relErr(w, 1/3), relErr(rho/T^4, ...)\n            w_val = w\n            \n            w_analytic = 1.0/3.0\n            # For m=0, w should be exactly 1/3, error is due to numerical precision.\n            rel_err_w = np.abs(w_val - w_analytic) / w_analytic\n            \n            # This is also an exact UR case.\n            T_nu_a = T_NU0_EV / a\n            rho_over_T4_numeric = rho / T_nu_a**4\n            rel_err_rho = np.abs(rho_over_T4_numeric - rho_over_T4_ur_analytic) / rho_over_T4_ur_analytic\n            \n            results.extend([w_val, rel_err_w, rel_err_rho])\n\n        elif test_type == 'Intermediate':\n            # Report w only\n            w_val = w\n            results.append(w_val)\n    \n    # Print final results in the required format\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == '__main__':\n    solve()\n```", "id": "3470587"}]}