{"hands_on_practices": [{"introduction": "Understanding the derivative is fundamental, but often we must approximate it numerically. This first practice introduces the three most common finite difference formulas: forward, backward, and central difference. By applying them to a simple function, you will quantitatively compare their accuracy and see firsthand why the symmetric structure of the central difference formula typically yields a much smaller truncation error [@problem_id:2191753].", "problem": "Consider the function $f(x) = x \\exp(-x)$. We are interested in approximating its derivative, $f'(x)$, at the point $x_0 = 1$. The quality of an approximation is measured by its absolute error, defined as the absolute difference between the approximated value and the true value of the derivative.\n\nYou are to compare three common finite difference formulas for approximating the derivative:\n1.  **Forward Difference Approximation**: $D_f(x_0, h) = \\frac{f(x_0+h) - f(x_0)}{h}$\n2.  **Backward Difference Approximation**: $D_b(x_0, h) = \\frac{f(x_0) - f(x_0-h)}{h}$\n3.  **Central Difference Approximation**: $D_c(x_0, h) = \\frac{f(x_0+h) - f(x_0-h)}{2h}$\n\nLet $E_f$, $E_b$, and $E_c$ be the absolute errors corresponding to the forward, backward, and central difference approximations, respectively, when using a step size of $h = 0.1$.\n\nCalculate the value of the ratio $R = \\frac{E_f + E_b}{E_c}$. Round your final answer to three significant figures.", "solution": "We begin with $f(x) = x \\exp(-x)$. Its derivative is obtained by the product rule:\n$$\nf'(x) = \\exp(-x) + x \\frac{d}{dx}\\big(\\exp(-x)\\big) = \\exp(-x) - x \\exp(-x) = \\exp(-x)\\,(1 - x).\n$$\nAt $x_{0} = 1$, this gives\n$$\nf'(1) = \\exp(-1)\\,(1 - 1) = 0.\n$$\nHence, for any finite difference approximation $D$, the absolute error at $x_{0}=1$ is simply the absolute value of the approximation:\n$$\nE_{f} = |D_{f}(1,h)|,\\quad E_{b} = |D_{b}(1,h)|,\\quad E_{c} = |D_{c}(1,h)|.\n$$\n\nWith $h = 0.1$, compute the three finite differences using $f(x) = x \\exp(-x)$:\n- Forward difference:\n$$\nD_{f}(1,h) = \\frac{f(1+h) - f(1)}{h} = \\frac{(1.1)\\exp(-1.1) - \\exp(-1)}{0.1}.\n$$\n- Backward difference:\n$$\nD_{b}(1,h) = \\frac{f(1) - f(1-h)}{h} = \\frac{\\exp(-1) - (0.9)\\exp(-0.9)}{0.1}.\n$$\n- Central difference:\n$$\nD_{c}(1,h) = \\frac{f(1+h) - f(1-h)}{2h} = \\frac{(1.1)\\exp(-1.1) - (0.9)\\exp(-0.9)}{0.2}.\n$$\n\nFactor $\\exp(-1)$ by writing $\\exp(-1.1) = \\exp(-1)\\exp(-0.1)$ and $\\exp(-0.9) = \\exp(-1)\\exp(0.1)$. Define $t = \\exp(0.1)$ so that $\\exp(-0.1) = 1/t$. Then\n$$\nD_{f}(1,h) = \\frac{\\exp(-1)}{0.1}\\left(1.1\\,\\frac{1}{t} - 1 \\right),\\quad\nD_{b}(1,h) = \\frac{\\exp(-1)}{0.1}\\left(1 - 0.9\\,t \\right),\n$$\n$$\nD_{c}(1,h) = \\frac{\\exp(-1)}{0.2}\\left(1.1\\,\\frac{1}{t} - 0.9\\,t \\right).\n$$\nLet\n$$\nA = 1.1\\,\\frac{1}{t} - 1,\\quad B = 1 - 0.9\\,t,\\quad C = 1.1\\,\\frac{1}{t} - 0.9\\,t.\n$$\nThen\n$$\nE_{f} = \\frac{\\exp(-1)}{0.1}\\,|A|,\\quad E_{b} = \\frac{\\exp(-1)}{0.1}\\,|B|,\\quad E_{c} = \\frac{\\exp(-1)}{0.2}\\,|C|.\n$$\nTherefore, the ratio simplifies to\n$$\nR = \\frac{E_{f} + E_{b}}{E_{c}} = \\frac{\\frac{\\exp(-1)}{0.1}(|A|+|B|)}{\\frac{\\exp(-1)}{0.2}|C|} = 2\\,\\frac{|A|+|B|}{|C|}.\n$$\n\nNumerically, with $t = \\exp(0.1) \\approx 1.1051701859880927$ and $1/t = \\exp(-0.1) \\approx 0.9048374180359596$,\n$$\nA = 1.1\\cdot 0.9048374180359596 - 1 \\approx -0.00467884016044447,\\quad |A| \\approx 0.00467884016044447,\n$$\n$$\nB = 1 - 0.9\\cdot 1.1051701859880927 \\approx 0.00534683261071661,\\quad |B| \\approx 0.00534683261071661,\n$$\n$$\nC = 1.1\\cdot 0.9048374180359596 - 0.9\\cdot 1.1051701859880927 \\approx 0.000667992450272143,\\quad |C| \\approx 0.000667992450272143.\n$$\nHence,\n$$\nR = 2\\,\\frac{0.00467884016044447 + 0.00534683261071661}{0.000667992450272143} \\approx \\frac{0.02005134554232216}{0.000667992450272143} \\approx 30.0173.\n$$\nRounded to three significant figures,\n$$\nR \\approx 30.0.\n$$", "answer": "$$\\boxed{30.0}$$", "id": "2191753"}, {"introduction": "The principles of numerical differentiation extend beyond the first derivative. Many applications in science and engineering, such as analyzing concavity in optimization or solving partial differential equations in physics, require approximating the second derivative. This exercise demonstrates how to apply the standard central difference formula for the second derivative, using the ubiquitous Gaussian function as a practical test case to evaluate its accuracy [@problem_id:2191757].", "problem": "A central task in numerical analysis is to approximate derivatives of functions when an analytical derivative is either unknown or too complex to compute. Consider the Gaussian function, given by $f(x) = \\exp(-x^{2})$, which is fundamental in probability theory, signal processing, and quantum mechanics.\n\nWe wish to approximate the second derivative of this function at its peak, located at $x=0$. For this task, we will use the standard three-point central difference formula for the second derivative, which is defined as:\n$$ f_{\\text{approx}}''(x) = \\frac{f(x+h) - 2f(x) + f(x-h)}{h^{2}} $$\nwhere $h$ is a small step size.\n\nUsing a step size of $h=0.1$, calculate the absolute error of this numerical approximation at $x=0$. The absolute error is defined as the absolute difference between the exact analytical value of the second derivative and the value obtained from the numerical formula, i.e., $|f''(0) - f_{\\text{approx}}''(0)|$.\n\nExpress your final answer as a single real number rounded to four significant figures.", "solution": "We are given $f(x)=\\exp(-x^{2})$ and the three-point central difference formula for the second derivative:\n$$\nf_{\\text{approx}}''(x)=\\frac{f(x+h)-2f(x)+f(x-h)}{h^{2}}.\n$$\nWe need the absolute error at $x=0$ with $h=0.1$, defined as $|f''(0)-f_{\\text{approx}}''(0)|$.\n\nFirst, compute the exact second derivative. Using the chain rule and product rule:\n$$\nf'(x)=\\frac{d}{dx}\\left(\\exp(-x^{2})\\right)=-2x\\,\\exp(-x^{2}),\n$$\n$$\nf''(x)=\\frac{d}{dx}\\left(-2x\\,\\exp(-x^{2})\\right)=-2\\,\\exp(-x^{2})+(-2x)\\,\\frac{d}{dx}\\left(\\exp(-x^{2})\\right).\n$$\nSince $\\frac{d}{dx}\\left(\\exp(-x^{2})\\right)=-2x\\,\\exp(-x^{2})$, we obtain\n$$\nf''(x)=-2\\,\\exp(-x^{2})+4x^{2}\\,\\exp(-x^{2})=(-2+4x^{2})\\,\\exp(-x^{2}).\n$$\nEvaluating at $x=0$ gives\n$$\nf''(0)=(-2+0)\\exp(0)=-2.\n$$\n\nNext, compute the numerical approximation at $x=0$ with $h=0.1$. Since $f$ is even, $f(h)=f(-h)=\\exp(-h^{2})$ and $f(0)=\\exp(0)=1$. Therefore,\n$$\nf_{\\text{approx}}''(0)=\\frac{\\exp(-h^{2})-2\\cdot 1+\\exp(-h^{2})}{h^{2}}=\\frac{2\\exp(-h^{2})-2}{h^{2}}.\n$$\nWith $h=0.1$, we have $h^{2}=0.01$, so\n$$\nf_{\\text{approx}}''(0)=\\frac{2\\exp(-0.01)-2}{0.01}=200\\left(\\exp(-0.01)-1\\right).\n$$\n\nThe absolute error is\n$$\n\\left|f''(0)-f_{\\text{approx}}''(0)\\right|=\\left|-2-200\\left(\\exp(-0.01)-1\\right)\\right|.\n$$\nCompute $\\exp(-0.01)\\approx 0.990049833749168$, hence\n$$\n200\\left(\\exp(-0.01)-1\\right)\\approx 200(-0.009950166250832)=-1.9900332501664,\n$$\nand thus\n$$\n\\left|-2-(-1.9900332501664)\\right|=\\left|-0.0099667498336\\right|=0.0099667498336.\n$$\nRounding to four significant figures yields $0.009967$.", "answer": "$$\\boxed{0.009967}$$", "id": "2191757"}, {"introduction": "In theory, we can make the approximation error arbitrarily small by shrinking the step size $h$. In practice, computers use finite-precision arithmetic, leading to a crucial trade-off: smaller $h$ values reduce the mathematical truncation error but amplify the numerical round-off error due to catastrophic cancellation. This advanced practice explores this fundamental conflict, demonstrating how to analyze the total error to find an optimal step size $h^*$ that balances these two competing effects in a realistic financial application [@problem_id:2415137].", "problem": "Consider the continuously compounded price of a fixed-coupon bond as a function of the continuously compounded yield $y$:\n$$\nP(y) \\;=\\; \\sum_{k=1}^{N} c_k \\, e^{-y t_k},\n$$\nwhere $t_k$ are payment times (in years) and $c_k$ are the corresponding cash flows. Let the bond have face value $F=100$, annual coupon rate $c=0.05$, maturity $T=10$ years, and semiannual payments ($m=2$), so that $N=mT=20$, $t_k = k/m$ for $k=1,\\ldots,20$, $c_k = 2.5$ for $k=1,\\ldots,19$, and $c_{20} = 102.5$. Let $y_0 = 0.03$.\n\nSuppose you estimate the derivative $P'(y_0)$ by the forward-difference formula\n$$\nD_h \\;=\\; \\frac{P(y_0 + h) - P(y_0)}{h},\n$$\ncomputed in standard double-precision floating point arithmetic, modeled by the relative error bound $|\\delta|\\le \\epsilon_{mach}$ for each arithmetic operation, with $\\epsilon_{mach} \\approx 1.11 \\times 10^{-16}$.\n\nWhich of the following statements are correct? Select all that apply.\n\nA. For sufficiently small $h$, the dominant floating-point rounding error in $D_h$ behaves like $O\\!\\left(\\dfrac{\\epsilon_{mach}\\,|P(y_0)|}{h}\\right)$ due to subtracting nearly equal numbers, a phenomenon known as catastrophic cancellation.\n\nB. The truncation error of the forward-difference approximation $D_h$ is $O(h^2)$ with a leading constant depending on $P^{(3)}(y_0)$.\n\nC. Balancing leading truncation and rounding errors gives an asymptotic optimal step size of the form $h^* \\asymp \\sqrt{\\dfrac{\\epsilon_{mach}\\,|P(y_0)|}{|P''(y_0)|}}$.\n\nD. For the specified bond at $y_0=0.03$ in double precision with $\\epsilon_{mach} \\approx 1.11 \\times 10^{-16}$, the order of magnitude of $h^*$ that minimizes the leading-order total error is closest to $10^{-9}$.\n\nE. Switching to a central-difference derivative would eliminate catastrophic cancellation entirely for all $h$.", "solution": "We begin from first principles: the forward-difference formula is defined by\n$$\nD_h \\;=\\; \\frac{P(y_0+h)-P(y_0)}{h}.\n$$\nBy Taylor’s theorem about $y_0$, for some $\\xi$ between $y_0$ and $y_0+h$,\n$$\nP(y_0+h) \\;=\\; P(y_0) \\;+\\; h\\,P'(y_0) \\;+\\; \\frac{h^2}{2}\\,P''(\\xi).\n$$\nSubstituting into $D_h$ and subtracting $P'(y_0)$ yields the truncation (discretization) error\n$$\nD_h - P'(y_0) \\;=\\; \\frac{h}{2}\\,P''(\\xi),\n$$\nso the truncation error is $O(h)$ with leading behavior $\\frac{h}{2} P''(y_0)$ as $h \\to 0$.\n\nNext, we model floating-point rounding. Under the standard relative error model, each evaluated quantity is perturbed by a multiplicative factor $(1+\\delta)$ with $|\\delta|\\le \\epsilon_{mach}$. Let the computed values be\n$$\n\\widehat{P(y_0+h)} = P(y_0+h)(1+\\delta_1), \\quad \\widehat{P(y_0)} = P(y_0)(1+\\delta_2),\n$$\nwith $|\\delta_1|,|\\delta_2| \\le \\epsilon_{mach}$. The computed numerator of the forward difference is\n$$\n\\widehat{P(y_0+h)} - \\widehat{P(y_0)} \\;=\\; \\big(P(y_0+h) - P(y_0)\\big) \\;+\\; \\delta_1 P(y_0+h) \\;-\\; \\delta_2 P(y_0).\n$$\nDividing by $h$ gives an additive rounding error term\n$$\n\\frac{\\delta_1 P(y_0+h) - \\delta_2 P(y_0)}{h}.\n$$\nFor small $h$, $P(y_0+h) \\approx P(y_0)$, so the difference $P(y_0+h)-P(y_0)$ in the numerator is small, and the term $\\frac{\\delta_1 P(y_0+h) - \\delta_2 P(y_0)}{h}$ is on the order of\n$$\nO\\!\\left(\\frac{\\epsilon_{mach}\\,|P(y_0)|}{h}\\right).\n$$\nThis is the hallmark of catastrophic cancellation: subtraction of nearly equal large quantities reduces significant digits, amplifying relative rounding error by roughly $1/h$ in the derivative quotient.\n\nCombining truncation and rounding, the leading-order total error can be expressed as\n$$\nE(h) \\;\\approx\\; \\frac{h}{2}\\,|P''(y_0)| \\;+\\; C\\,\\frac{\\epsilon_{mach}\\,|P(y_0)|}{h},\n$$\nwhere $C$ is a modest constant reflecting details of the floating-point evaluation and algebraic rearrangements. Minimizing this leading-order model with respect to $h$ gives\n$$\n\\frac{d}{dh}\\left(\\frac{h}{2}|P''(y_0)| + C\\,\\frac{\\epsilon_{mach}\\,|P(y_0)|}{h}\\right)=0\n\\;\\Rightarrow\\;\n\\frac{1}{2}|P''(y_0)| - C\\,\\frac{\\epsilon_{mach}\\,|P(y_0)|}{h^2}=0,\n$$\nso\n$$\nh^* \\;=\\; \\sqrt{\\frac{2C\\,\\epsilon_{mach}\\,|P(y_0)|}{|P''(y_0)|}}\n\\;\\asymp\\; \\sqrt{\\frac{\\epsilon_{mach}\\,|P(y_0)|}{|P''(y_0)|}},\n$$\nwhere $\\asymp$ indicates equality up to a constant factor.\n\nWe now evaluate $|P(y_0)|$ and $|P''(y_0)|$ for the specified bond. With continuous compounding and semiannual payment times $t_k = k/2$, $k=1,\\ldots,20$, we have\n$$\nP(y_0) \\;=\\; \\sum_{k=1}^{19} 2.5\\,e^{-0.03\\, (k/2)} \\;+\\; 102.5\\,e^{-0.03 \\cdot 10}.\n$$\nLet $r = e^{-0.03/2} = e^{-0.015} \\approx 0.98511194$. The first sum is a geometric series:\n$$\n\\sum_{k=1}^{19} 2.5\\,r^k \\;=\\; 2.5\\,r\\,\\frac{1-r^{19}}{1-r}.\n$$\nUsing $1-r \\approx 0.01488806$, $r^{19} = e^{-0.015\\cdot 19} = e^{-0.285} \\approx 0.7520$, we obtain\n$$\n\\sum_{k=1}^{19} 2.5\\,r^k \\;\\approx\\; 2.5 \\times 0.98511194 \\times \\frac{1-0.7520}{0.01488806} \\;\\approx\\; 41.02.\n$$\nThe final cash flow term is\n$$\n102.5\\,e^{-0.3} \\;\\approx\\; 102.5 \\times 0.740818 \\;\\approx\\; 75.93.\n$$\nHence\n$$\nP(y_0) \\;\\approx\\; 41.02 + 75.93 \\;\\approx\\; 116.95.\n$$\n\nNext, compute\n$$\nP''(y) \\;=\\; \\sum_{k=1}^{N} c_k\\, t_k^2\\, e^{-y t_k}.\n$$\nThus, at $y_0=0.03$,\n$$\nP''(y_0) \\;=\\; \\sum_{k=1}^{19} 2.5 \\left(\\frac{k}{2}\\right)^2 e^{-0.03\\,(k/2)} \\;+\\; 102.5 \\cdot 10^2 \\cdot e^{-0.3}.\n$$\nThe final term evaluates to\n$$\n102.5 \\cdot 100 \\cdot e^{-0.3} \\;\\approx\\; 102.5 \\times 100 \\times 0.740818 \\;\\approx\\; 7593.38.\n$$\nA direct summation of the coupon terms gives approximately\n$$\n\\sum_{k=1}^{19} 2.5 \\left(\\frac{k}{2}\\right)^2 e^{-0.03\\,(k/2)} \\;\\approx\\; 1242.46,\n$$\nso\n$$\nP''(y_0) \\;\\approx\\; 7593.38 + 1242.46 \\;\\approx\\; 8835.84.\n$$\nTherefore,\n$$\n\\frac{|P(y_0)|}{|P''(y_0)|} \\;\\approx\\; \\frac{116.95}{8835.84} \\;\\approx\\; 1.32 \\times 10^{-2}.\n$$\nWith $\\epsilon_{mach} \\approx 1.11 \\times 10^{-16}$, we have\n$$\n\\epsilon_{mach}\\,\\frac{|P(y_0)|}{|P''(y_0)|} \\;\\approx\\; 1.47 \\times 10^{-18},\n$$\nso\n$$\nh^* \\;\\asymp\\; \\sqrt{1.47 \\times 10^{-18}} \\;\\approx\\; 1.21 \\times 10^{-9},\n$$\nand including the constant $\\sqrt{2C}$ (with $C$ of order $1$) would keep $h^*$ on the order of $10^{-9}$. Thus the order of magnitude closest to $10^{-9}$ is correct.\n\nWe now assess each option:\n\nA. The rounding error analysis above shows the dominant term behaves like $O\\!\\left(\\dfrac{\\epsilon_{mach}\\,|P(y_0)|}{h}\\right)$ for small $h$, arising from subtracting nearly equal large quantities. Verdict: Correct.\n\nB. The forward-difference truncation error from Taylor’s theorem is $O(h)$ with leading term $\\frac{h}{2}P''(y_0)$, not $O(h^2)$, and it depends on $P''(y_0)$, not $P^{(3)}(y_0)$. Verdict: Incorrect.\n\nC. Balancing $O(h)$ truncation and $O(\\epsilon_{mach}/h)$ rounding errors yields $h^* \\asymp \\sqrt{\\dfrac{\\epsilon_{mach}\\,|P(y_0)|}{|P''(y_0)|}}$ up to a constant factor, as derived. Verdict: Correct.\n\nD. Using the computed $P(y_0)$ and $P''(y_0)$ with $\\epsilon_{mach} \\approx 1.11 \\times 10^{-16}$ gives $h^*$ on the order of $10^{-9}$. Verdict: Correct.\n\nE. Central differences reduce truncation error to $O(h^2)$ but still involve subtracting nearly equal quantities $P(y_0+h)$ and $P(y_0-h)$, so rounding error remains of order $O\\!\\left(\\dfrac{\\epsilon_{mach}\\,|P(y_0)|}{h}\\right)$. Catastrophic cancellation is not eliminated for all $h$. Verdict: Incorrect.", "answer": "$$\\boxed{ACD}$$", "id": "2415137"}]}