{"hands_on_practices": [{"introduction": "Mastering any algorithm begins with understanding its core mechanics. This first exercise provides a direct, hands-on application of Gaussian elimination to a standard $3 \\times 3$ system of linear equations [@problem_id:23125]. By systematically applying row operations to achieve row echelon form, you will build the foundational skills necessary for solving more complex problems and appreciate the algorithm's methodical power.", "problem": "Consider the following system of linear equations in three variables $x, y,$ and $z$:\n$$\n\\begin{cases}\nx + y + z = 4 \\\\\n2x - y + z = 8 \\\\\nx - 2y - z = 1\n\\end{cases}\n$$\nUsing the method of Gaussian elimination, transform the system into row echelon form and determine the value of the variable $z$.", "solution": "We write the augmented matrix for the system:\n$$\n\\left[\n\\begin{array}{ccc|c}\n1 & 1 & 1 & 4 \\\\\n2 & -1 & 1 & 8 \\\\\n1 & -2 & -1 & 1\n\\end{array}\n\\right].\n$$\nStep 1: Eliminate $x$ from the second row via $R_2\\leftarrow R_2-2R_1$ and from the third row via $R_3\\leftarrow R_3-R_1$:\n$$\nR_2: (2-2\\cdot1,\\;-1-2\\cdot1,\\;1-2\\cdot1\\;|\\;8-2\\cdot4)\n=(0,\\,-3,\\,-1\\;|\\;0),\n$$\n$$\nR_3: (1-1,\\;-2-1,\\;-1-1\\;|\\;1-4)\n=(0,\\,-3,\\,-2\\;|\\;-3).\n$$\nThe matrix becomes\n$$\n\\left[\n\\begin{array}{ccc|c}\n1 & 1 & 1 & 4 \\\\\n0 & -3 & -1 & 0 \\\\\n0 & -3 & -2 & -3\n\\end{array}\n\\right].\n$$\nStep 2: Eliminate $y$ from the third row via $R_3\\leftarrow R_3-R_2$:\n$$\nR_3: (0-0,\\;-3-(-3),\\;-2-(-1)\\;|\\;-3-0)\n=(0,\\;0,\\;-1\\;|\\;-3).\n$$\nNow the matrix is in row echelon form:\n$$\n\\left[\n\\begin{array}{ccc|c}\n1 & 1 & 1 & 4 \\\\\n0 & -3 & -1 & 0 \\\\\n0 & 0 & -1 & -3\n\\end{array}\n\\right].\n$$\nFrom the third row we have\n$$\n-1\\cdot z=-3,\n$$\nhence\n$$\nz=3.\n$$", "answer": "$$\\boxed{3}$$", "id": "23125"}, {"introduction": "Gaussian elimination is more than just a tool for finding unique solutions; it is a powerful diagnostic method for understanding the nature of a linear system. This practice problem guides you through the process of identifying an inconsistent system—one with no solution at all [@problem_id:2175259]. Recognizing the tell-tale signs of inconsistency within the augmented matrix, such as a row that represents a contradiction like $0=c$ where $c \\neq 0$, is a crucial skill for model validation in economics and finance.", "problem": "Analyze the following system of linear equations and determine the nature of its solution set for the variables $x$, $y$, and $z$.\n\n$$\n\\begin{cases}\n\\phantom{1}x + \\phantom{1}y + z = 3 \\\\\n2x - \\phantom{1}y + 3z = 4 \\\\\n3x \\phantom{{}+0y} + 4z = 8\n\\end{cases}\n$$\n\nSelect the correct statement from the options below.\n\nA. The system has a unique solution.\n\nB. The system has infinitely many solutions with one free parameter.\n\nC. The system has infinitely many solutions with two free parameters.\n\nD. The system is inconsistent (has no solution).", "solution": "Let the system be\n$$\n\\begin{cases}\nx + y + z = 3, \\\\\n2x - y + 3z = 4, \\\\\n3x + 4z = 8.\n\\end{cases}\n$$\nFirst, check whether a unique solution is possible by computing the determinant of the coefficient matrix\n$$\nA=\\begin{pmatrix}\n1 & 1 & 1 \\\\\n2 & -1 & 3 \\\\\n3 & 0 & 4\n\\end{pmatrix}.\n$$\nCompute\n$$\n\\det(A)=1\\cdot\\det\\begin{pmatrix}-1 & 3 \\\\ 0 & 4\\end{pmatrix}\n-1\\cdot\\det\\begin{pmatrix}2 & 3 \\\\ 3 & 4\\end{pmatrix}\n+1\\cdot\\det\\begin{pmatrix}2 & -1 \\\\ 3 & 0\\end{pmatrix}.\n$$\nEvaluate each minor:\n$$\n\\det\\begin{pmatrix}-1 & 3 \\\\ 0 & 4\\end{pmatrix}=-4,\\quad\n\\det\\begin{pmatrix}2 & 3 \\\\ 3 & 4\\end{pmatrix}=8-9=-1,\\quad\n\\det\\begin{pmatrix}2 & -1 \\\\ 3 & 0\\end{pmatrix}=0-(-3)=3.\n$$\nThus\n$$\n\\det(A)=-4-(-1)+3=0.\n$$\nSince $\\det(A)=0$, the system does not have a unique solution; it either has infinitely many solutions or is inconsistent. To decide, test consistency by elimination.\n\nFrom the first equation, use elimination with the second and third:\n- Compute $(2)-(2)\\times(1)$:\n$$\n(2x - y + 3z) - 2(x + y + z) = 4 - 6 \\;\\Rightarrow\\; -3y + z = -2.\n$$\n- Compute $(3)-(3)\\times(1)$:\n$$\n(3x + 4z) - 3(x + y + z) = 8 - 9 \\;\\Rightarrow\\; -3y + z = -1.\n$$\nThese two derived equations,\n$$\n-3y + z = -2 \\quad \\text{and} \\quad -3y + z = -1,\n$$\nhave identical left-hand sides but different right-hand sides, which is impossible to satisfy simultaneously. Therefore, the system is inconsistent and has no solution.\n\nHence, the correct choice is D.", "answer": "$$\\boxed{D}$$", "id": "2175259"}, {"introduction": "The transition from theoretical algorithms to practical computation often reveals critical challenges, such as numerical instability. This advanced exercise, set in the context of no-arbitrage pricing, demonstrates how finite-precision arithmetic can lead to significant errors and even \"spurious arbitrage\" opportunities if Gaussian elimination is applied naively [@problem_id:2396422]. By comparing results with and without a pivoting strategy, you will gain a profound appreciation for why robust numerical methods are indispensable in computational finance.", "problem": "Consider a two-state, one-period economy with complete markets. Let $q_1$ and $q_2$ denote the Arrow–Debreu state prices (prices today of one unit of consumption delivered in state $1$ or state $2$, respectively). Under the no-arbitrage principle, the price $p_j$ of any traded asset $j$ with payoffs $x_{1j}$ and $x_{2j}$ across the two states satisfies the system\n$$\np_j \\;=\\; q_1 x_{1j} \\;+\\; q_2 x_{2j}, \\quad j \\in \\{1,2\\}.\n$$\nYou observe two traded assets with the following payoffs and prices (all monetary amounts are in dollars):\n- Asset $1$: payoff vector $(x_{11}, x_{21}) = (0.001234,\\, 1.000000)$ with price $p_1 = 1.001234$.\n- Asset $2$: payoff vector $(x_{12}, x_{22}) = (1.000000,\\, 1.000000)$ with price $p_2 = 2.000000$.\n\nAssume the market is arbitrage-free and complete. An analyst attempts to recover $(q_1, q_2)$ by solving the $2\\times 2$ linear system for $(q_1, q_2)$ using Gaussian elimination. However, the analyst uses arithmetic rounded to three significant figures at every intermediate step of the algorithm.\n\nTasks:\n1) Set up the linear system in the form $A \\boldsymbol{q} = \\boldsymbol{p}$ with\n$$\nA \\;=\\; \\begin{pmatrix}\n0.001234 & 1.000000 \\\\\n1.000000 & 1.000000\n\\end{pmatrix}, \n\\quad \n\\boldsymbol{q} \\;=\\; \\begin{pmatrix} q_1 \\\\ q_2 \\end{pmatrix}, \n\\quad \n\\boldsymbol{p} \\;=\\; \\begin{pmatrix} 1.001234 \\\\ 2.000000 \\end{pmatrix}.\n$$\n2) Perform Gaussian elimination without pivoting on the augmented matrix, carrying out all arithmetic (including each intermediate result) to three significant figures by rounding. Denote the resulting estimate by $(\\tilde{q}_1, \\tilde{q}_2)$.\n3) Using $(\\tilde{q}_1, \\tilde{q}_2)$, compute the model-implied no-arbitrage value $\\tilde{v}$ of an Arrow–Debreu security paying $(1, 0)$ across the two states.\n4) In the same arbitrage-free market, the observed market value $v$ of this Arrow–Debreu security is consistent with the true state prices that exactly solve the system above (so $v = q_1$). Using the data given, this observed $v$ equals $1.000000$. The analyst who used Gaussian elimination without pivoting would therefore claim a spurious arbitrage exists by shorting the observed security and buying its replicating portfolio at their model-implied value, with per-unit profit $\\pi = v - \\tilde{v}$.\n5) Now repeat the elimination with partial pivoting (always swapping to place the largest-magnitude available pivot on the diagonal before eliminating), again with three significant figures arithmetic at every step, to obtain $(\\hat{q}_1, \\hat{q}_2)$ and the corresponding $\\hat{v}$. Explain why this eliminates the spurious arbitrage.\n\nReport, as your final answer, the spurious arbitrage profit per unit $\\pi$ computed in step $4$, rounded to three significant figures. Express the final profit in dollars.", "solution": "The exact solution to the system is found by direct algebraic manipulation. Subtracting the first equation from the second gives $(1 - 0.001234)q_1 = 2 - 1.001234$, which simplifies to $0.998766 q_1 = 0.998766$, implying $q_1 = 1$. Substituting back gives $q_2 = 1$. The true state price vector is $(q_1, q_2) = (1, 1)$.\n\nWe now analyze the solution using finite-precision arithmetic.\n\n**Part 1: Gaussian Elimination without Pivoting**\n\nFirst, we set up the augmented matrix $[A|\\boldsymbol{p}]$ and round all entries to $3$ significant figures.\n$$\n[A|\\boldsymbol{p}] = \\left[ \\begin{array}{cc|c}\n0.001234 & 1.000000 & 1.001234 \\\\\n1.000000 & 1.000000 & 2.000000\n\\end{array} \\right] \\quad \\rightarrow \\quad \\left[ \\begin{array}{cc|c}\n0.00123 & 1.00 & 1.00 \\\\\n1.00 & 1.00 & 2.00\n\\end{array} \\right]\n$$\nThe pivot element is $a_{11} = 0.00123$. The multiplier for the second row is $m_{21} = \\frac{a_{21}}{a_{11}} = \\frac{1.00}{0.00123}$.\nCalculation: $1.00 \\div 0.00123 \\approx 813.008...$. Rounding to $3$ significant figures gives $m_{21} = 813$.\nWe perform the row operation $R_2 \\leftarrow R_2 - m_{21} R_1$.\nThe new elements of the second row are computed as follows:\n$a'_{22} = a_{22} - m_{21} \\times a_{12} = 1.00 - 813 \\times 1.00 = 1.00 - 813 = -812$.\n$p'_{2} = p_{2} - m_{21} \\times p_{1} = 2.00 - 813 \\times 1.00 = 2.00 - 813 = -811$.\nThe system becomes upper triangular:\n$$\n\\left[ \\begin{array}{cc|c}\n0.00123 & 1.00 & 1.00 \\\\\n0 & -812 & -811\n\\end{array} \\right]\n$$\nNow we perform back substitution to find the approximate solution $(\\tilde{q}_1, \\tilde{q}_2)$.\nFrom the second row: $-812 \\tilde{q}_2 = -811$.\n$\\tilde{q}_2 = \\frac{-811}{-812} \\approx 0.99876...$. Rounding to $3$ significant figures: $\\tilde{q}_2 = 0.999$.\nFrom the first row: $0.00123 \\tilde{q}_1 + 1.00 \\tilde{q}_2 = 1.00$.\nSubstituting $\\tilde{q}_2$: $0.00123 \\tilde{q}_1 + 1.00 \\times 0.999 = 1.00$.\nThe product $1.00 \\times 0.999 = 0.999$.\n$0.00123 \\tilde{q}_1 + 0.999 = 1.00$.\n$0.00123 \\tilde{q}_1 = 1.00 - 0.999 = 0.001$. This intermediate result has only $1$ significant figure.\n$\\tilde{q}_1 = \\frac{0.001}{0.00123} \\approx 0.81300...$. Rounding to $3$ significant figures: $\\tilde{q}_1 = 0.813$.\nThus, the solution without pivoting is $(\\tilde{q}_1, \\tilde{q}_2) = (0.813, 0.999)$.\n\nThe model-implied value of the Arrow-Debreu security paying $(1, 0)$ is $\\tilde{v} = 1 \\cdot \\tilde{q}_1 + 0 \\cdot \\tilde{q}_2 = \\tilde{q}_1 = 0.813$.\nThe true market value is $v = 1.000000$.\nThe spurious arbitrage profit is $\\pi = v - \\tilde{v} = 1.000 - 0.813 = 0.187$.\n\n**Part 2: Gaussian Elimination with Partial Pivoting**\n\nWe start with the same rounded augmented matrix:\n$$\n\\left[ \\begin{array}{cc|c}\n0.00123 & 1.00 & 1.00 \\\\\n1.00 & 1.00 & 2.00\n\\end{array} \\right]\n$$\nIn the first column, $|a_{21}| = 1.00 > |a_{11}| = 0.00123$. Therefore, we swap Row $1$ and Row $2$.\n$$\n\\left[ \\begin{array}{cc|c}\n1.00 & 1.00 & 2.00 \\\\\n0.00123 & 1.00 & 1.00\n\\end{array} \\right]\n$$\nThe pivot element is now $a_{11} = 1.00$. The multiplier is $m_{21} = \\frac{a_{21}}{a_{11}} = \\frac{0.00123}{1.00} = 0.00123$.\nWe perform the row operation $R_2 \\leftarrow R_2 - m_{21} R_1$.\nThe new elements of the second row are computed:\n$a'_{22} = a_{22} - m_{21} \\times a_{12} = 1.00 - 0.00123 \\times 1.00 = 1.00 - 0.00123 = 0.99877$. Rounding to $3$ significant figures gives $0.999$.\n$p'_{2} = p_{2} - m_{21} \\times p_{1} = 1.00 - 0.00123 \\times 2.00 = 1.00 - 0.00246 = 0.99754$. Rounding to $3$ significant figures gives $0.998$.\nThe system becomes:\n$$\n\\left[ \\begin{array}{cc|c}\n1.00 & 1.00 & 2.00 \\\\\n0 & 0.999 & 0.998\n\\end{array} \\right]\n$$\nWe perform back substitution for the solution $(\\hat{q}_1, \\hat{q}_2)$.\nFrom the second row: $0.999 \\hat{q}_2 = 0.998$.\n$\\hat{q}_2 = \\frac{0.998}{0.999} \\approx 0.99899...$. Rounding to $3$ significant figures: $\\hat{q}_2 = 0.999$.\nFrom the first row: $1.00 \\hat{q}_1 + 1.00 \\hat{q}_2 = 2.00$.\n$1.00 \\hat{q}_1 + 1.00 \\times 0.999 = 2.00$.\n$1.00 \\hat{q}_1 + 0.999 = 2.00$.\n$1.00 \\hat{q}_1 = 2.00 - 0.999 = 1.001$. Rounding to $3$ significant figures gives $1.00$.\n$1.00 \\hat{q}_1 = 1.00$, so $\\hat{q}_1 = 1.00$.\nThe solution with partial pivoting is $(\\hat{q}_1, \\hat{q}_2) = (1.00, 0.999)$.\n\nThe new model-implied value is $\\hat{v} = \\hat{q}_1 = 1.00$.\nThe arbitrage profit is now $\\hat{\\pi} = v - \\hat{v} = 1.00 - 1.00 = 0$.\n\n**Explanation**\n\nThe spurious arbitrage is a direct consequence of numerical instability in the Gaussian elimination algorithm without pivoting. The matrix $A$ has elements of vastly different magnitudes.\n\nWhen no pivoting is used, the small element $a_{11} = 0.00123$ is chosen as the pivot. This results in a very large multiplier, $m_{21} = 813$. During the elimination step $R_2 \\leftarrow R_2 - m_{21} R_1$, the original information in row $2$ is effectively destroyed by subtraction of a large number. The term $m_{21} \\times a_{12} = 813$ swamps the original value of $a_{22}=1.00$. This leads to catastrophic cancellation in the subsequent back-substitution step ($1.00 - 0.999 = 0.001$), where two nearly equal numbers are subtracted, resulting in a loss of significant figures from $3$ to $1$. The final result $\\tilde{q}_1 = 0.813$ is grossly inaccurate compared to the true value of $q_1 = 1$.\n\nPartial pivoting corrects this instability. By swapping rows, it ensures that the pivot element is the largest-magnitude element available in the column. In this case, $1.00$ becomes the pivot. This guarantees that the multiplier $m_{21} = 0.00123$ is small (specifically, $|m_{ij}| \\le 1$). When performing the elimination step, we subtract a small quantity, which preserves the significant digits of the original matrix entries. The resulting calculation is numerically stable, yielding $\\hat{q}_1 = 1.00$, which is accurate to the working precision of $3$ significant figures. This accurate state price leads to a model value $\\hat{v}$ that matches the observed market value $v$, correctly indicating the absence of arbitrage.", "answer": "$$\n\\boxed{0.187}\n$$", "id": "2396422"}]}