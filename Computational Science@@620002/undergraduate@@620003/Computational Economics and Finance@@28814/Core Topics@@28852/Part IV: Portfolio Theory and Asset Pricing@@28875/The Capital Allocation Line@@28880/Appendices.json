{"hands_on_practices": [{"introduction": "The Capital Allocation Line is built on the foundation of a risk-free asset, but what if this certainty only exists in nominal terms? This exercise [@problem_id:2438498] explores how stochastic inflation transforms a nominally risk-free Treasury bill into a risky asset when performance is measured in real, inflation-adjusted terms. By modeling inflation using a log-normal distribution, you will quantify the expected real return and its standard deviation, revealing the \"inflation risk\" that complicates even the safest investments and alters the very starting point of the CAL.", "problem": "An investor evaluates one-period portfolio choices in real (inflation-adjusted) terms. The nominal risk-free asset is a Treasury bill that pays a certain nominal simple return of $r_f^{N} = 0.03$ over the period. Let gross inflation be $I \\equiv 1 + \\pi$, where $\\ln I \\sim \\mathcal{N}(\\mu_I, \\sigma_I^2)$ with $\\mu_I = 0.02$ and $\\sigma_I = 0.04$. Assume $I$ is statistically independent of the nominal payoff of the Treasury bill and independent of the nominal return on any risky asset. The ex post real simple return on the Treasury bill is defined by $R_f^{\\text{real}} \\equiv \\dfrac{1 + r_f^{N}}{I} - 1$. The Capital Allocation Line (CAL), on a mean–standard deviation diagram in real terms, is the set of mean–variance combinations available by linearly combining the nominal Treasury bill and a risky market portfolio, both evaluated in real terms.\n\nWhich option correctly quantifies the expected value and standard deviation of $R_f^{\\text{real}}$ and states the implication for the $y$-intercept of the real CAL?\n\nA. $\\mathbb{E}[R_f^{\\text{real}}] \\approx r_f^{N} - \\mathbb{E}[\\pi] \\approx 0.0090$, $\\operatorname{sd}(R_f^{\\text{real}}) = 0$. The real CAL still intersects the $y$-axis sharply at approximately $0.90\\%$.\n\nB. $\\mathbb{E}[R_f^{\\text{real}}] = (1 + r_f^{N})\\,\\mathbb{E}\\!\\left[\\dfrac{1}{I}\\right] - 1 \\approx 0.0104$ and $\\operatorname{sd}(R_f^{\\text{real}}) = (1 + r_f^{N})\\sqrt{\\operatorname{Var}\\!\\left(\\dfrac{1}{I}\\right)} \\approx 0.0405$. Thus, the real “risk-free” point has positive horizontal dispersion; the $y$-intercept of the real CAL is not a sharp point on the $y$-axis but becomes a diffuse band centered near $1.04\\%$ with nonzero horizontal spread.\n\nC. $\\mathbb{E}[R_f^{\\text{real}}] = \\dfrac{1 + r_f^{N}}{1 + \\mathbb{E}[\\pi]} - 1 \\approx 0.0088$ and $\\operatorname{sd}(R_f^{\\text{real}}) \\approx 0.0400$. Inflation risk diversifies away in large portfolios, so the real CAL’s $y$-intercept is unaffected.\n\nD. $\\mathbb{E}[R_f^{\\text{real}}] = r_f^{N} = 0.03$ while $\\operatorname{sd}(R_f^{\\text{real}}) > 0$ due to inflation. The real CAL’s $y$-intercept remains at $3\\%$, but the CAL rotates to have a smaller slope as risky-asset volatility rises.", "solution": "The problem statement is a valid exercise in computational finance. It is scientifically grounded, well-posed, and objective. All necessary data and definitions for a unique solution are provided.\n\nThe problem asks for the expected value and standard deviation of the real simple return on a nominal Treasury bill, and the implication for the Capital Allocation Line (CAL) in real terms.\n\nFirst, we define and analyze the random variable for the real simple return, $R_f^{\\text{real}}$.\nGiven data:\nThe nominal risk-free simple return is $r_f^{N} = 0.03$.\nThe gross nominal return on the Treasury bill is therefore $1 + r_f^{N} = 1.03$, which is a constant.\nGross inflation is $I \\equiv 1 + \\pi$.\nThe distribution of the logarithm of gross inflation is given as $\\ln I \\sim \\mathcal{N}(\\mu_I, \\sigma_I^2)$, with parameters $\\mu_I = 0.02$ and $\\sigma_I = 0.04$.\nThis implies that $I$ follows a log-normal distribution.\nThe ex post real simple return on the Treasury bill is defined as:\n$$R_f^{\\text{real}} = \\frac{1 + r_f^{N}}{I} - 1 = \\frac{1.03}{I} - 1$$\nTo find the expected value and standard deviation of $R_f^{\\text{real}}$, we need the first two moments of the random variable $1/I$.\nLet $X = \\ln I$. We are given $X \\sim \\mathcal{N}(\\mu_I, \\sigma_I^2)$.\nThe variable of interest is $1/I = e^{-\\ln I} = e^{-X}$.\nSince $X$ is normally distributed, $-X$ is also normally distributed: $-X \\sim \\mathcal{N}(-\\mu_I, \\sigma_I^2)$.\nTherefore, $1/I$ is a log-normally distributed random variable.\n\nThe $k$-th moment of a log-normal variable $Y = e^W$, where $W \\sim \\mathcal{N}(\\mu_W, \\sigma_W^2)$, is given by $\\mathbb{E}[Y^k] = e^{k\\mu_W + \\frac{1}{2}k^2\\sigma_W^2}$.\nFor our variable $1/I$, the underlying normal variable is $W = -X$, with $\\mu_W = -\\mu_I = -0.02$ and $\\sigma_W = \\sigma_I = 0.04$.\n\nThe expected value of $1/I$ is the first moment ($k=1$):\n$$\\mathbb{E}\\left[\\frac{1}{I}\\right] = e^{1 \\cdot (-\\mu_I) + \\frac{1}{2}(1)^2\\sigma_I^2} = e^{-\\mu_I + \\frac{1}{2}\\sigma_I^2}$$\nPlugging in the given values:\n$$\\mathbb{E}\\left[\\frac{1}{I}\\right] = e^{-0.02 + \\frac{1}{2}(0.04)^2} = e^{-0.02 + \\frac{1}{2}(0.0016)} = e^{-0.02 + 0.0008} = e^{-0.0192}$$\n$$e^{-0.0192} \\approx 0.9809904$$\nNow, we can find the expected value of the real return:\n$$\\mathbb{E}[R_f^{\\text{real}}] = \\mathbb{E}\\left[\\frac{1.03}{I} - 1\\right] = 1.03 \\cdot \\mathbb{E}\\left[\\frac{1}{I}\\right] - 1$$\n$$\\mathbb{E}[R_f^{\\text{real}}] = 1.03 \\cdot e^{-0.0192} - 1 \\approx 1.03 \\cdot (0.9809904) - 1$$\n$$\\mathbb{E}[R_f^{\\text{real}}] \\approx 1.0104199 - 1 = 0.0104199 \\approx 0.0104$$\n\nNext, we calculate the standard deviation, $\\operatorname{sd}(R_f^{\\text{real}})$. First, we find the variance, $\\operatorname{Var}(R_f^{\\text{real}})$.\n$$\\operatorname{Var}(R_f^{\\text{real}}) = \\operatorname{Var}\\left(\\frac{1.03}{I} - 1\\right) = \\operatorname{Var}\\left(\\frac{1.03}{I}\\right) = (1.03)^2 \\operatorname{Var}\\left(\\frac{1}{I}\\right)$$\nThe variance of a log-normal variable $Y$ can be calculated as $\\operatorname{Var}(Y) = \\mathbb{E}[Y^2] - (\\mathbb{E}[Y])^2$.\nWe need the second moment of $1/I$ ($k=2$):\n$$\\mathbb{E}\\left[\\left(\\frac{1}{I}\\right)^2\\right] = e^{2 \\cdot (-\\mu_I) + \\frac{1}{2}(2)^2\\sigma_I^2} = e^{-2\\mu_I + 2\\sigma_I^2}$$\nPlugging in the values:\n$$\\mathbb{E}\\left[\\left(\\frac{1}{I}\\right)^2\\right] = e^{-2(0.02) + 2(0.04)^2} = e^{-0.04 + 2(0.0016)} = e^{-0.04 + 0.0032} = e^{-0.0368}$$\n$$e^{-0.0368} \\approx 0.9638703$$\nWe already found $(\\mathbb{E}[1/I])^2 = (e^{-0.0192})^2 = e^{-0.0384} \\approx (0.9809904)^2 \\approx 0.9623422$.\nSo, the variance of $1/I$ is:\n$$\\operatorname{Var}\\left(\\frac{1}{I}\\right) = \\mathbb{E}\\left[\\left(\\frac{1}{I}\\right)^2\\right] - \\left(\\mathbb{E}\\left[\\frac{1}{I}\\right]\\right)^2 = e^{-0.0368} - e^{-0.0384}$$\n$$\\operatorname{Var}\\left(\\frac{1}{I}\\right) \\approx 0.9638703 - 0.9623319 = 0.0015384$$\nNow, substitute this into the variance expression for $R_f^{\\text{real}}$:\n$$\\operatorname{Var}(R_f^{\\text{real}}) = (1.03)^2 \\cdot \\operatorname{Var}\\left(\\frac{1}{I}\\right) \\approx 1.0609 \\cdot (0.0015384) \\approx 0.0016321$$\nThe standard deviation is the square root of the variance:\n$$\\operatorname{sd}(R_f^{\\text{real}}) = \\sqrt{\\operatorname{Var}(R_f^{\\text{real}})} \\approx \\sqrt{0.0016321} \\approx 0.040399$$\nRounding to four decimal places, we get $\\operatorname{sd}(R_f^{\\text{real}}) \\approx 0.0404$.\n\nThe implication for the real CAL: In a standard mean-standard deviation diagram where one axis is expected return $\\mathbb{E}[R]$ and the other is standard deviation $\\operatorname{sd}(R)$, a risk-free asset is a point on the vertical axis (the $y$-axis), as its standard deviation is zero. The CAL is the line starting from this point and tangent to the efficient frontier of risky assets.\nIn this problem, the nominal Treasury bill is risk-free only in nominal terms. When its return is converted to real terms, it is subject to inflation risk. As we calculated, the standard deviation of its real return is $\\operatorname{sd}(R_f^{\\text{real}}) \\approx 0.0404$, which is non-zero.\nThus, in a real-term mean-standard deviation diagram, the Treasury bill is no longer a risk-free asset. It is a risky asset represented by the point $(\\sigma, \\mu) = (\\operatorname{sd}(R_f^{\\text{real}}), \\mathbb{E}[R_f^{\\text{real}}]) \\approx (0.0404, 0.0104)$.\nThis point is not on the $y$-axis. The \"real CAL,\" formed by combining this asset with a risky market portfolio, is a curve (a hyperbola, unless correlation is perfect) connecting two points in the risky $(\\sigma>0)$ plane. It does not have a $y$-intercept in the traditional sense of a risk-free rate. The foundation of the CAL has shifted from a risk-free point to a risky point.\n\nNow, we evaluate each option:\n\n**A. $\\mathbb{E}[R_f^{\\text{real}}] \\approx r_f^{N} - \\mathbb{E}[\\pi] \\approx 0.0090$, $\\operatorname{sd}(R_f^{\\text{real}}) = 0$. The real CAL still intersects the $y$-axis sharply at approximately $0.90\\%$.**\nThe calculation for the expected return uses the first-order Fisher approximation, which is less precise than the exact formula. More critically, it incorrectly states that the standard deviation of the real return is zero. Because inflation is uncertain, the real return on a nominal asset is uncertain. The implication for the CAL is also incorrect because the asset is not risk-free in real terms.\nVerdict: **Incorrect**.\n\n**B. $\\mathbb{E}[R_f^{\\text{real}}] = (1 + r_f^{N})\\,\\mathbb{E}\\!\\left[\\dfrac{1}{I}\\right] - 1 \\approx 0.0104$ and $\\operatorname{sd}(R_f^{\\text{real}}) = (1 + r_f^{N})\\sqrt{\\operatorname{Var}\\!\\left(\\dfrac{1}{I}\\right)} \\approx 0.0405$. Thus, the real “risk-free” point has positive horizontal dispersion; the $y$-intercept of the real CAL is not a sharp point on the $y$-axis but becomes a diffuse band centered near $1.04\\%$ with nonzero horizontal spread.**\nThe formula for the expected value is correct, and the numerical value $\\approx 0.0104$ matches our calculation. The formula for the standard deviation is also correct. Our calculation yielded $\\approx 0.0404$, which is extremely close to the provided value of $0.0405$; the minor difference is likely due to rounding in the problem's construction. The qualitative description of the implication is accurate: the so-called \"risk-free\" asset now has positive standard deviation (\"horizontal dispersion\"), and therefore is not a point on the $y$-axis. The description of this change as becoming a \"diffuse band\" is a non-technical but conceptually correct way to express that the certain risk-free anchor point is gone.\nVerdict: **Correct**.\n\n**C. $\\mathbb{E}[R_f^{\\text{real}}] = \\dfrac{1 + r_f^{N}}{1 + \\mathbb{E}[\\pi]} - 1 \\approx 0.0088$ and $\\operatorname{sd}(R_f^{\\text{real}}) \\approx 0.0400$. Inflation risk diversifies away in large portfolios, so the real CAL’s $y$-intercept is unaffected.**\nThe formula for the expected value is incorrect; it is an erroneous application of expectations, as $\\mathbb{E}[1/I] \\neq 1/\\mathbb{E}[I]$. The standard deviation value $0.0400$ is a common but less precise approximation ($\\operatorname{sd}(R_f^{\\text{real}}) \\approx \\sigma_I$). The statement that inflation risk diversifies away is fundamentally incorrect. Inflation is a source of systematic risk, as it affects the real value of all nominal contracts in an economy. It cannot be eliminated through portfolio diversification.\nVerdict: **Incorrect**.\n\n**D. $\\mathbb{E}[R_f^{\\text{real}}] = r_f^{N} = 0.03$ while $\\operatorname{sd}(R_f^{\\text{real}}) > 0$ due to inflation. The real CAL’s $y$-intercept remains at $3\\%$, but the CAL rotates to have a smaller slope as risky-asset volatility rises.**\nThis option incorrectly claims the expected real return equals the nominal risk-free rate, ignoring the effect of inflation entirely. While it correctly states that the standard deviation is greater than zero, the conclusion that the $y$-intercept remains at $3\\%$ is contradictory. If the standard deviation is positive, the point cannot be on the $y$-axis.\nVerdict: **Incorrect**.", "answer": "$$\\boxed{B}$$", "id": "2438498"}, {"introduction": "Standard financial models often assume that asset returns are independent from one day to the next, but in reality, return patterns can exhibit persistence. This problem [@problem_id:2438505] challenges you to build a more nuanced model by incorporating first-order autocorrelation, where an asset's return is partially correlated with its previous return. You will learn to correctly calculate the variance of a multi-period return in the presence of such time-series dependence, a critical skill for accurately assessing long-horizon risk and determining the true slope of the Capital Allocation Line.", "problem": "An investor evaluates a risky asset whose one-day arithmetic return, denoted by $r_{t}$ for day $t$, is covariance-stationary with $\\mathbb{E}[r_{t}] = \\mu_{d}$, $\\operatorname{Var}(r_{t}) = \\sigma_{d}^{2}$, and first-order autocorrelation $\\operatorname{Corr}(r_{t}, r_{t-1}) = \\rho$. Assume $\\operatorname{Cov}(r_{t}, r_{t-k}) = 0$ for all $k \\geq 2$. The investor’s single decision period is $n$ trading days, and for mean-variance analysis the one-period arithmetic return of the risky asset is defined as the $n$-day cumulative arithmetic return\n$$\nR_{n} \\equiv \\sum_{t=1}^{n} r_{t}.\n$$\nThe $n$-day risk-free simple return is a known constant $R_{f,n}$. The investor forms a portfolio by investing a fraction $y$ of wealth in the risky asset and $1-y$ in the risk-free asset for this one period. The capital allocation line (CAL) for this risky asset and the risk-free asset is the set of attainable pairs $\\big(\\sigma_{p}(y), \\mathbb{E}[R_{p}(y)]\\big)$ as $y$ varies, where $R_{p}(y)$ is the one-period portfolio arithmetic return and $\\sigma_{p}(y)$ is its standard deviation.\n\nGiven the parameters\n- $\\mu_{d} = 5 \\times 10^{-4}$,\n- $\\sigma_{d} = 10^{-2}$,\n- $\\rho = 0.2$,\n- $n = 20$,\n- $R_{f,n} = 2 \\times 10^{-3}$,\n\ncompute the slope of the capital allocation line, defined as\n$$\nS \\equiv \\frac{\\mathbb{E}[R_{n}] - R_{f,n}}{\\sigma_{n}},\n$$\nwhere $\\sigma_{n} \\equiv \\sqrt{\\operatorname{Var}(R_{n})}$ is the standard deviation of the $n$-day cumulative arithmetic return adjusted for the given autocorrelation.\n\nExpress the final numerical value of $S$ as a decimal and round your answer to four significant figures.", "solution": "The capital allocation line (CAL) describes all linear combinations of a risky asset and a risk-free asset over a single decision period. With one risky asset and one risk-free asset, the one-period portfolio arithmetic return is $R_{p}(y) = y R_{n} + (1-y) R_{f,n}$, so $\\mathbb{E}[R_{p}(y)] = R_{f,n} + y\\big(\\mathbb{E}[R_{n}] - R_{f,n}\\big)$ and $\\sigma_{p}(y) = |y|\\,\\sigma_{n}$ because the risk-free return is nonrandom. Therefore, the CAL has slope equal to the Sharpe ratio of the risky asset over the period:\n$$\nS = \\frac{\\mathbb{E}[R_{n}] - R_{f,n}}{\\sigma_{n}}.\n$$\n\nTo adjust for autocorrelation in the calculation of $\\sigma_{n}$, we start from the variance of a sum in a covariance-stationary process. By definition,\n$$\nR_{n} = \\sum_{t=1}^{n} r_{t}, \\quad \\mathbb{E}[R_{n}] = \\sum_{t=1}^{n} \\mathbb{E}[r_{t}] = n \\mu_{d}.\n$$\nThe variance is\n$$\n\\operatorname{Var}(R_{n}) = \\operatorname{Var}\\!\\Big(\\sum_{t=1}^{n} r_{t}\\Big) = \\sum_{t=1}^{n} \\operatorname{Var}(r_{t}) + 2 \\sum_{1 \\leq i < j \\leq n} \\operatorname{Cov}(r_{i}, r_{j}).\n$$\nLet $\\gamma_{k} \\equiv \\operatorname{Cov}(r_{t}, r_{t-k})$ for $k \\geq 0$. Under covariance stationarity, $\\gamma_{0} = \\sigma_{d}^{2}$ and, by the given assumptions, $\\gamma_{1} = \\rho \\sigma_{d}^{2}$ and $\\gamma_{k} = 0$ for all $k \\geq 2$. Then only lag-$0$ and lag-$1$ terms contribute:\n- There are $n$ lag-$0$ terms, summing to $n \\sigma_{d}^{2}$.\n- There are $(n-1)$ distinct lag-$1$ pairs $(i,j)$ with $j=i+1$ and each appears twice in the double sum due to symmetry across $(i,j)$ and $(j,i)$, contributing $2(n-1)\\gamma_{1} = 2(n-1)\\rho \\sigma_{d}^{2}$.\n\nTherefore,\n$$\n\\operatorname{Var}(R_{n}) = n \\sigma_{d}^{2} + 2(n-1)\\rho \\sigma_{d}^{2} = \\sigma_{d}^{2}\\Big[n + 2(n-1)\\rho\\Big],\n$$\nand\n$$\n\\sigma_{n} = \\sigma_{d}\\,\\sqrt{n + 2(n-1)\\rho}.\n$$\n\nNow substitute the given values:\n- $\\mu_{d} = 5 \\times 10^{-4}$,\n- $\\sigma_{d} = 10^{-2}$,\n- $\\rho = 0.2$,\n- $n = 20$,\n- $R_{f,n} = 2 \\times 10^{-3}$.\n\nCompute the mean:\n$$\n\\mathbb{E}[R_{n}] = n \\mu_{d} = 20 \\times 5 \\times 10^{-4} = 1.0 \\times 10^{-2}.\n$$\nCompute the standard deviation:\n$$\n\\sigma_{n} = 10^{-2} \\sqrt{20 + 2 \\times 19 \\times 0.2} = 10^{-2} \\sqrt{20 + 7.6} = 10^{-2} \\sqrt{27.6}.\n$$\nThus,\n$$\nS = \\frac{1.0 \\times 10^{-2} - 2 \\times 10^{-3}}{10^{-2} \\sqrt{27.6}} = \\frac{8.0 \\times 10^{-3}}{10^{-2} \\sqrt{27.6}} = \\frac{0.8}{\\sqrt{27.6}}.\n$$\nEvaluate numerically:\n$$\n\\sqrt{27.6} \\approx 5.2553,\\quad S \\approx \\frac{0.8}{5.2553} \\approx 0.1523.\n$$\nRounded to four significant figures, $S = 0.1523$.", "answer": "$$\\boxed{0.1523}$$", "id": "2438505"}, {"introduction": "While the theory of the tangency portfolio is elegant for two assets, its real power is revealed when applied to a broad universe of investment choices. This hands-on coding exercise [@problem_id:2438483] tasks you with bridging the gap between theory and computational practice by finding the optimal portfolio among 50 distinct risky assets. You will implement the full workflow, from constructing the covariance matrix to solving for the optimal weights of the tangency portfolio, providing a practical and scalable application of modern portfolio theory.", "problem": "You are given a universe of $50$ risky assets. Let $R$ denote the $50 \\times 50$ correlation matrix of asset returns, $\\sigma \\in \\mathbb{R}^{50}$ the vector of asset standard deviations, $\\mu \\in \\mathbb{R}^{50}$ the vector of expected returns (all expressed as decimals, not percentages), and $\\Sigma = D R D$ the covariance matrix with $D = \\operatorname{diag}(\\sigma)$. A risk-free rate $r_f \\in \\mathbb{R}$ is available (also expressed as a decimal). Consider the Capital Allocation Line (CAL), also known in equilibrium as the Capital Market Line (CML), formed by combinations of the risk-free asset and the tangency portfolio.\n\nDefine the tangency portfolio $w^\\star \\in \\mathbb{R}^{50}$ as the solution to the optimization problem that maximizes the Sharpe ratio, with short sales allowed and budget constraint:\n- maximize $(\\mu^\\top w - r_f)/\\sqrt{w^\\top \\Sigma w}$ over $w \\in \\mathbb{R}^{50}$,\n- subject to $\\mathbf{1}^\\top w = 1$, where $\\mathbf{1}$ is the vector of ones in $\\mathbb{R}^{50}$.\n\nLet the slope of the Capital Allocation Line (CAL) be $S = (\\mu^\\top w^\\star - r_f)/\\sqrt{(w^\\star)^\\top \\Sigma w^\\star}$. For any target standard deviation $\\bar{\\sigma} \\ge 0$, the expected return on the CAL is $E_{\\text{CAL}}(\\bar{\\sigma}) = r_f + S \\, \\bar{\\sigma}$.\n\nFor each test case below, you must:\n- construct $R$, $\\sigma$, $\\mu$, and $\\Sigma$ as specified;\n- compute the tangency portfolio $w^\\star$ for the given $r_f$ under the constraint $\\mathbf{1}^\\top w^\\star = 1$ with short selling allowed;\n- compute the CAL slope $S$ and the CAL expected returns $E_{\\text{CAL}}(\\bar{\\sigma})$ for the target standard deviations $\\bar{\\sigma} \\in \\{0.0, 0.05, 0.15\\}$.\n\nAll returns and standard deviations are unit-free decimals. Report all floating-point outputs rounded to $6$ decimal places.\n\nTest suite and data construction for each case:\n- For a given seed $s \\in \\mathbb{Z}$, define a random number generator using that seed. Generate a matrix $A \\in \\mathbb{R}^{50 \\times 50}$ with independent standard normal entries. Let $M = A A^\\top$. Define the correlation matrix by $R_{ij} = M_{ij}/\\sqrt{M_{ii} M_{jj}}$ for all $i,j$. Independently draw $\\sigma_i$ from the continuous uniform distribution on $[0.05, 0.35]$ for each $i \\in \\{1,\\dots,50\\}$. Independently draw $\\mu_i$ from the continuous uniform distribution on $[0.02, 0.18]$ for each $i \\in \\{1,\\dots,50\\}$. Set $D = \\operatorname{diag}(\\sigma)$ and $\\Sigma = D R D$.\n- Use the following test cases:\n    1. Case $1$: seed $s=7$, risk-free rate $r_f = 0.02$.\n    2. Case $2$: seed $s=11$, risk-free rate $r_f = 0.00$.\n    3. Case $3$: seed $s=13$, risk-free rate $r_f = -0.01$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. For each test case, output the list $[S, E_{\\text{CAL}}(0.0), E_{\\text{CAL}}(0.05), E_{\\text{CAL}}(0.15)]$ with each entry rounded to $6$ decimal places. The overall output must be a single list containing the three test case results in order. For example, the final output format must be:\n[[S1,E1_0.0,E1_0.05,E1_0.15],[S2,E2_0.0,E2_0.05,E2_0.15],[S3,E3_0.0,E3_0.05,E3_0.15]].", "solution": "The problem statement is validated as scientifically sound, well-posed, objective, and self-contained. It describes a standard problem in modern portfolio theory: the determination of the Capital Allocation Line (CAL). We shall proceed with a full derivation and computational solution.\n\nThe fundamental task is to find the \"tangency portfolio,\" which is the portfolio of risky assets that, when combined with a risk-free asset, offers the best risk-return trade-off. This portfolio is located at the point of tangency between the efficient frontier of risky assets and the line originating from the risk-free rate on the expected return-standard deviation plane. This line is the Capital Allocation Line. The slope of the CAL is the Sharpe ratio of the tangency portfolio.\n\nLet $w \\in \\mathbb{R}^{50}$ be the vector of weights for the 50 risky assets, such that the weights sum to one: $\\mathbf{1}^\\top w = 1$, where $\\mathbf{1}$ is a vector of ones. Short selling is permitted, so $w_i \\in \\mathbb{R}$. The expected return of such a portfolio is $E[R_p] = \\mu^\\top w$ and its variance is $\\sigma_p^2 = w^\\top \\Sigma w$, where $\\mu$ is the vector of expected returns, and $\\Sigma$ is the covariance matrix of asset returns.\n\nThe objective is to maximize the Sharpe ratio, $S_p$, of a portfolio of risky assets:\n$$ \\text{maximize}_{w} \\quad S_p(w) = \\frac{\\mu^\\top w - r_f}{\\sqrt{w^\\top \\Sigma w}} $$\nsubject to the budget constraint:\n$$ \\mathbf{1}^\\top w = 1 $$\nwhere $r_f$ is the risk-free rate of return.\n\nLet $\\mu_e = \\mu - r_f \\mathbf{1}$ be the vector of excess expected returns over the risk-free rate. The objective function becomes maximizing $(\\mu_e^\\top w)/\\sqrt{w^\\top \\Sigma w}$. It is a known result in portfolio theory that the solution to this problem is a portfolio whose weights $w$ are proportional to $\\Sigma^{-1} \\mu_e$. This can be formally shown by solving an equivalent optimization problem: minimize the variance $\\frac{1}{2} w^\\top \\Sigma w$ for a fixed level of excess return $\\mu_e^\\top w = C$ (for some constant $C > 0$). The Lagrangian for this equivalent problem is $\\mathcal{L}(w, \\lambda) = \\frac{1}{2} w^\\top \\Sigma w - \\lambda (\\mu_e^\\top w - C)$.\nTaking the derivative with respect to $w$ and setting it to zero gives the first-order condition:\n$$ \\frac{\\partial \\mathcal{L}}{\\partial w} = \\Sigma w - \\lambda \\mu_e = 0 $$\nAssuming $\\Sigma$ is invertible (which it will be with probability 1 by the specified construction), we find that any such optimal portfolio's weights are of the form:\n$$ w = \\lambda \\Sigma^{-1} \\mu_e $$\nThis implies that the weights of the tangency portfolio, $w^\\star$, are proportional to the vector we shall denote $w_{\\text{unscaled}} = \\Sigma^{-1} \\mu_e$.\n\nTo find the specific weights $w^\\star$ that satisfy the budget constraint $\\mathbf{1}^\\top w^\\star = 1$, we must normalize this unscaled weight vector. Let $k = \\mathbf{1}^\\top w_{\\text{unscaled}}$ be the sum of the unscaled weights. The normalized tangency portfolio weights are then:\n$$ w^\\star = \\frac{w_{\\text{unscaled}}}{k} = \\frac{\\Sigma^{-1} \\mu_e}{\\mathbf{1}^\\top (\\Sigma^{-1} \\mu_e)} = \\frac{\\Sigma^{-1} (\\mu - r_f \\mathbf{1})}{\\mathbf{1}^\\top \\Sigma^{-1} (\\mu - r_f \\mathbf{1})} $$\nComputationally, it is more numerically stable to solve the linear system $\\Sigma w_{\\text{unscaled}} = \\mu_e$ for $w_{\\text{unscaled}}$ rather than computing the inverse of $\\Sigma$ directly.\n\nOnce the tangency portfolio weights $w^\\star$ are determined, we can calculate its expected return $\\mu_p^\\star = \\mu^\\top w^\\star$ and standard deviation $\\sigma_p^\\star = \\sqrt{(w^\\star)^\\top \\Sigma w^\\star}$.\n\nThe slope of the Capital Allocation Line, $S$, is the Sharpe ratio of this tangency portfolio:\n$$ S = \\frac{\\mu_p^\\star - r_f}{\\sigma_p^\\star} = \\frac{\\mu^\\top w^\\star - r_f}{\\sqrt{(w^\\star)^\\top \\Sigma w^\\star}} $$\n\nFinally, the expected return on the CAL for a given target standard deviation $\\bar{\\sigma} \\ge 0$ is given by the linear relationship:\n$$ E_{\\text{CAL}}(\\bar{\\sigma}) = r_f + S \\cdot \\bar{\\sigma} $$\nThis formula describes the expected return of a complete portfolio formed by allocating a certain fraction of capital to the tangency portfolio and the remainder to the risk-free asset. For $\\bar{\\sigma} = 0.0$, the portfolio is 100% in the risk-free asset, and $E_{\\text{CAL}}(0.0) = r_f$.\n\nThe algorithm for each test case is as follows:\n1.  Initialize a random number generator with the given seed $s$.\n2.  Generate a $50 \\times 50$ matrix $A$ of standard normal random variates from $\\mathcal{N}(0, 1)$.\n3.  Compute $M = A A^\\top$.\n4.  Construct the correlation matrix $R$ where $R_{ij} = M_{ij} / \\sqrt{M_{ii} M_{jj}}$.\n5.  Generate the vector of standard deviations $\\sigma$ from $U(0.05, 0.35)$ and the vector of expected returns $\\mu$ from $U(0.02, 0.18)$.\n6.  Construct the covariance matrix $\\Sigma = D R D$, where $D = \\operatorname{diag}(\\sigma)$.\n7.  Compute the excess return vector $\\mu_e = \\mu - r_f \\mathbf{1}$.\n8.  Solve the linear system $\\Sigma w_{\\text{unscaled}} = \\mu_e$ for $w_{\\text{unscaled}}$.\n9.  Normalize the weights: $w^\\star = w_{\\text{unscaled}} / (\\mathbf{1}^\\top w_{\\text{unscaled}})$.\n10. Calculate the CAL slope $S = (\\mu^\\top w^\\star - r_f) / \\sqrt{(w^\\star)^\\top \\Sigma w^\\star}$.\n11. Calculate $E_{\\text{CAL}}(\\bar{\\sigma}) = r_f + S \\cdot \\bar{\\sigma}$ for $\\bar{\\sigma} \\in \\{0.0, 0.05, 0.15\\}$.\n12. Collate and round the results to 6 decimal places.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the Capital Allocation Line slope and expected returns for several test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (seed, risk-free rate)\n        (7, 0.02),\n        (11, 0.00),\n        (13, -0.01),\n    ]\n\n    target_sigmas = [0.0, 0.05, 0.15]\n    all_results = []\n    \n    for case in test_cases:\n        s, r_f = case\n        \n        # --- Start of calculation for one case ---\n        N = 50  # Number of assets\n        rng = np.random.default_rng(seed=s)\n\n        # Step 1: Generate asset parameters\n        # Generate random matrix A and use it to construct a valid correlation matrix R\n        A = rng.standard_normal((N, N))\n        M = A @ A.T\n\n        # R_ij = M_ij / sqrt(M_ii * M_jj)\n        diag_M = np.diag(M)\n        diag_M_inv_sqrt = np.diag(1.0 / np.sqrt(diag_M))\n        R = diag_M_inv_sqrt @ M @ diag_M_inv_sqrt\n\n        # Generate vectors for standard deviation and expected return\n        sigma_vec = rng.uniform(0.05, 0.35, N)\n        mu_vec = rng.uniform(0.02, 0.18, N)\n\n        # Construct covariance matrix Sigma = D * R * D\n        D = np.diag(sigma_vec)\n        Sigma = D @ R @ D\n\n        # Step 2: Compute the tangency portfolio\n        # Vector of excess returns over the risk-free rate\n        mu_e = mu_vec - r_f\n        \n        # Solve the linear system Sigma * w_unscaled = mu_e for unscaled weights.\n        # This is more numerically stable than inverting Sigma.\n        w_unscaled = np.linalg.solve(Sigma, mu_e)\n\n        # Normalize weights to sum to 1 to get the tangency portfolio weights\n        w_star = w_unscaled / np.sum(w_unscaled)\n\n        # Step 3: Compute the CAL slope S\n        # Calculate expected return and standard deviation of the tangency portfolio\n        mu_p_star = mu_vec.T @ w_star\n        sigma_p_star = np.sqrt(w_star.T @ Sigma @ w_star)\n\n        # The slope S is the Sharpe ratio of the tangency portfolio\n        S = (mu_p_star - r_f) / sigma_p_star\n\n        # Step 4: Compute CAL expected returns for target standard deviations\n        E_cal_values = [r_f + S * ts for ts in target_sigmas]\n        \n        # Collect the results for the current case: [S, E_CAL(0.0), E_CAL(0.05), E_CAL(0.15)]\n        case_result_list = [S] + E_cal_values\n        \n        # --- End of calculation for one case ---\n        all_results.append(case_result_list)\n\n    # Final print statement in the exact required format.\n    # Format: [[S1,E1_0.0,E1_0.05,E1_0.15],[S2,...],[S3,...]]\n    outer_parts = []\n    for res_list in all_results:\n        # Format each number to 6 decimal places\n        inner_parts = [f\"{val:.6f}\" for val in res_list]\n        outer_parts.append(f\"[{','.join(inner_parts)}]\")\n    \n    final_output_str = f\"[{','.join(outer_parts)}]\"\n\n    print(final_output_str)\n\nsolve()\n\n```", "id": "2438483"}]}