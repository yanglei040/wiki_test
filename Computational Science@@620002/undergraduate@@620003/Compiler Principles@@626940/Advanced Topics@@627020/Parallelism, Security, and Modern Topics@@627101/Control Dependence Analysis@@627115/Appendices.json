{"hands_on_practices": [{"introduction": "Understanding control dependence begins with mastering its formal definition, which can sometimes defy intuition. This first practice uses a simple sequence of conditional statements to explore the core concept based on postdominance. By analyzing this fundamental structure, you will clarify the precise conditions under which one statement's execution is formally controlled by a predicate, particularly highlighting why a statement that is always executed after a branch is not considered dependent on it [@problem_id:3632542].", "problem": "Consider the following straight-line fragment with two conditionals over the same boolean expression and a trailing statement:\nif (p) S1;\nif (¬p) S2;\nS3;\nAssume that $p$ has no side effects when evaluated; $S_1$, $S_2$, and $S_3$ are basic blocks that do not throw exceptions, do not perform abnormal control transfers, and always fall through to their successor. Model this fragment as a control flow graph (CFG) with an $Entry$ node, an $Exit$ node, and two distinct predicate nodes: $B_1$ for the first test of $p$ and $B_2$ for the second test of $\\lnot p$; the then-edges go to $S_1$ and $S_2$ respectively, and the else-edges fall through to the next statement in sequence.\n\nUsing the standard foundation for control dependence based on postdominance:\n- A node $X$ postdominates a node $Y$ if every path from $Y$ to $Exit$ contains $X$.\n- A node $X$ is control-dependent on a node $Y$ if $Y$ has at least two successors and $X$ postdominates some but not all of those successors.\n\nInterpret “control-dependent on $p$” to mean “control-dependent on one of the predicate nodes that evaluate $p$ or $\\lnot p$,” namely $B_1$ or $B_2$. Which of $S_1$, $S_2$, $S_3$ are control-dependent on $p$ in this sense?\n\nChoose the single best option:\nA. Only $S_1$\n\nB. Only $S_2$\n\nC. $S_1$ and $S_2$, but not $S_3$\n\nD. $S_1$, $S_2$, and $S_3$\n\nE. None of $S_1$, $S_2$, $S_3$", "solution": "The problem statement is a valid exercise in control dependence analysis, a standard topic in compiler theory. It provides a clear code fragment, a specific set of rules for constructing the corresponding control flow graph (CFG), and precise definitions for postdominance and control dependence. The problem is self-contained, logically consistent, and well-posed.\n\nThe solution proceeds in three steps:\n1.  Construction of the Control Flow Graph (CFG) as per the problem description.\n2.  Analysis of postdominance relationships within the CFG.\n3.  Application of the control dependence definition to determine the dependencies of statements `$S_1$`, `$S_2$`, and `$S_3$` on the predicate nodes `$B_1$` and `$B_2$`.\n\n**1. Control Flow Graph (CFG) Construction**\n\nThe problem specifies the program fragment and the structure of the CFG.\nProgram fragment:\n```\nif (p) S1;\nif (¬p) S2;\nS3;\n```\nThe nodes are `$Entry$`, `$B_1$` (for `if (p)`), `$S_1$`, `$B_2$` (for `if (¬p)`), `$S_2$`, `$S_3$`, and `$Exit$`. The edges are determined by the control flow and the fall-through behavior:\n\n-   `$Entry \\rightarrow B_1$`: Execution begins at the first conditional.\n-   `$B_1 \\xrightarrow{\\text{true}} S_1$`: If `$p$` is true, execute `$S_1$`.\n-   `$B_1 \\xrightarrow{\\text{false}} B_2$`: If `$p$` is false, skip `$S_1$` and fall through to the next statement, which starts at `$B_2$`.\n-   `$S_1 \\rightarrow B_2$`: After `$S_1$` executes, it falls through to the next statement, which starts at `$B_2$`.\n-   `$B_2 \\xrightarrow{\\text{true}} S_2$`: If `$\\lnot p$` is true (i.e., `$p$` is false), execute `$S_2$`.\n-   `$B_2 \\xrightarrow{\\text{false}} S_3$`: If `$\\lnot p$` is false (i.e., `$p$` is true), skip `$S_2$` and fall through to `$S_3$`.\n-   `$S_2 \\rightarrow S_3$`: After `$S_2$` executes, it falls through to `$S_3$`.\n-   `$S_3 \\rightarrow Exit$`: After `$S_3$` executes, the fragment terminates.\n\nWe can trace the two possible execution paths based on the value of `$p$`:\n-   If `$p$` is true: `$Entry \\rightarrow B_1 \\rightarrow S_1 \\rightarrow B_2 \\rightarrow S_3 \\rightarrow Exit$`.\n-   If `$p$` is false: `$Entry \\rightarrow B_1 \\rightarrow B_2 \\rightarrow S_2 \\rightarrow S_3 \\rightarrow Exit$`.\n\n**2. Postdominance Analysis**\n\nThe definition provided states: A node `$X$` postdominates a node `$Y$` if every path from `$Y$` to `$Exit$` contains `$X$`. We analyze the key postdominance relationships required for the control dependence check.\n\n-   **Postdominance of `$S_3$`**:\n    -   Any path from `$S_2$` must go through `$S_3$` (`$S_2 \\rightarrow S_3 \\rightarrow Exit$`). Thus, `$S_3$` postdominates `$S_2$`.\n    -   The paths from `$B_2$` are `$B_2 \\rightarrow S_2 \\rightarrow S_3 \\rightarrow Exit$` and `$B_2 \\rightarrow S_3 \\rightarrow Exit$`. Both contain `$S_3$`. Thus, `$S_3$` postdominates `$B_2$`.\n    -   Any path from `$S_1$` must go through `$B_2$` (`$S_1 \\rightarrow B_2 \\rightarrow ...$`), and we've established `$S_3$` postdominates `$B_2$`. Thus, `$S_3$` postdominates `$S_1$`.\n    -   The paths from `$B_1$` are `$B_1 \\rightarrow S_1 \\rightarrow B_2 \\rightarrow S_3 \\rightarrow Exit$` and `$B_1 \\rightarrow B_2 \\rightarrow S_2 \\rightarrow S_3 \\rightarrow Exit$`. Both contain `$S_3$`. Thus, `$S_3$` postdominates `$B_1$`.\n\n-   **Postdominance involving `$S_1$`**:\n    -   A path from `$B_1$` is `$B_1 \\rightarrow B_2 \\rightarrow ...$`. This path does not contain `$S_1$`. Therefore, `$S_1$` does not postdominate `$B_1$`.\n    -   A path from `$B_2$` is `$B_2 \\rightarrow S_2 \\rightarrow S_3 \\rightarrow Exit$`. This path does not contain `$S_1$`. Therefore, `$S_1$` does not postdominate `$B_2$`.\n\n-   **Postdominance involving `$S_2$`**:\n    -   A path from `$B_2$` is `$B_2 \\rightarrow S_3 \\rightarrow Exit$`. This path does not contain `$S_2$`. Therefore, `$S_2$` does not postdominate `$B_2$`.\n    -   A path from `$S_3$` is `$S_3 \\rightarrow Exit$`. This path does not contain `$S_2$`. Therefore, `$S_2$` does not postdominate `$S_3$`.\n\n**3. Control Dependence Analysis**\n\nThe definition provided states: A node `$X$` is control-dependent on a node `$Y$` if `$Y$` has at least two successors and `$X$` postdominates some but not all of those successors. We check this for each statement `$S_1, S_2, S_3$` with respect to predicates `$B_1$` and `$B_2$`.\n\n**Control Dependence on `$B_1$`**\n-   The predicate node is `$Y=B_1$`. Its successors are `$S_1$` (true branch) and `$B_2$` (false branch).\n\n-   Is `$S_1$` control-dependent on `$B_1$`? (`$X=S_1$`)\n    -   Does `$S_1$` postdominate `$S_1$`? Yes, trivially.\n    -   Does `$S_1$` postdominate `$B_2$`? No. There are paths from `$B_2$` to `$Exit$` that do not pass through `$S_1$`.\n    -   Since `$S_1$` postdominates one successor (`$S_1$`) but not the other (`$B_2$`), **`$S_1$` is control-dependent on `$B_1$`**.\n\n-   Is `$S_2$` control-dependent on `$B_1$`? (`$X=S_2$`)\n    -   Does `$S_2$` postdominate `$S_1$`? No. The path `$S_1 \\rightarrow B_2 \\rightarrow S_3 \\rightarrow Exit$` does not contain `$S_2$`.\n    -   Does `$S_2$` postdominate `$B_2$`? No. The path `$B_2 \\rightarrow S_3 \\rightarrow Exit$` does not contain `$S_2$`.\n    -   Since `$S_2$` postdominates neither successor, **`$S_2$` is not control-dependent on `$B_1$`**.\n\n-   Is `$S_3$` control-dependent on `$B_1$`? (`$X=S_3$`)\n    -   Does `$S_3$` postdominate `$S_1$`? Yes, as shown in the postdominance analysis.\n    -   Does `$S_3$` postdominate `$B_2$`? Yes, as shown in the postdominance analysis.\n    -   Since `$S_3$` postdominates *all* successors of `$B_1$`, **`$S_3$` is not control-dependent on `$B_1$`**.\n\n**Control Dependence on `$B_2$`**\n-   The predicate node is `$Y=B_2$`. Its successors are `$S_2$` (true branch for `$\\lnot p$`) and `$S_3$` (false branch for `$\\lnot p$`).\n\n-   Is `$S_1$` control-dependent on `$B_2$`? (`$X=S_1$`)\n    -   Does `$S_1$` postdominate `$S_2$`? No. The path `$S_2 \\rightarrow S_3 \\rightarrow Exit$` does not contain `$S_1$`.\n    -   Does `$S_1$` postdominate `$S_3$`? No. The path `$S_3 \\rightarrow Exit$` does not contain `$S_1$`.\n    -   Since `$S_1$` postdominates neither successor, **`$S_1$` is not control-dependent on `$B_2$`**.\n\n-   Is `$S_2$` control-dependent on `$B_2$`? (`$X=S_2$`)\n    -   Does `$S_2$` postdominate `$S_2$`? Yes, trivially.\n    -   Does `$S_2$` postdominate `$S_3$`? No. The path `$S_3 \\rightarrow Exit$` does not contain `$S_2$`.\n    -   Since `$S_2$` postdominates one successor (`$S_2$`) but not the other (`$S_3$`), **`$S_2$` is control-dependent on `$B_2$`**.\n\n-   Is `$S_3$` control-dependent on `$B_2$`? (`$X=S_3$`)\n    -   Does `$S_3$` postdominate `$S_2$`? Yes, as shown in the postdominance analysis.\n    -   Does `$S_3$` postdominate `$S_3$`? Yes, trivially.\n    -   Since `$S_3$` postdominates *all* successors of `$B_2$`, **`$S_3$` is not control-dependent on `$B_2$`**.\n\n**Conclusion**\n-   `$S_1$` is control-dependent on `$B_1$`.\n-   `$S_2$` is control-dependent on `$B_2$`.\n-   `$S_3$` is not control-dependent on `$B_1$` or `$B_2$`.\n\nThe question asks which statements are \"control-dependent on `$p$`\", meaning control-dependent on either `$B_1$` or `$B_2$`. Based on our analysis, these are `$S_1$` and `$S_2$`.\n\n**Option-by-Option Analysis**\n-   A. Only `$S_1$`: **Incorrect**. `$S_2$` is control-dependent on `$B_2$`.\n-   B. Only `$S_2$`: **Incorrect**. `$S_1$` is control-dependent on `$B_1$`.\n-   C. `$S_1$` and `$S_2$`, but not `$S_3$`: **Correct**. This matches our analysis. `$S_1$` is dependent on `$B_1$`, `$S_2$` is dependent on `$B_2$`, and `$S_3$` is dependent on neither because it is a postdominator of the join points.\n-   D. `$S_1$`, `$S_2$`, and `$S_3$`: **Incorrect**. `$S_3$` is not control-dependent on either predicate.\n-   E. None of `$S_1$`, `$S_2$`, `$S_3$`: **Incorrect**. `$S_1$` and `$S_2$` are control-dependent as shown.", "answer": "$$\\boxed{C}$$", "id": "3632542"}, {"introduction": "Real-world programs are rich with complex control structures like loops containing `break` and `continue` statements. This exercise challenges you to apply control dependence analysis to a more intricate Control Flow Graph (CFG) that models such a loop. Successfully solving this problem requires moving beyond simple inspection to a systematic application of the analysis, such as by constructing a postdominator tree, to accurately map dependencies in the presence of non-local control transfers [@problem_id:3632566].", "problem": "Consider the Control Flow Graph (CFG) of the loop described below. The loop guard is the predicate node $G$. The loop body contains straight-line statements $S_1, S_2, S_3, S_4, S_5, S_6$, a $continue$ statement $K$, and a $break$ statement $R$. There are two internal branch predicates inside the loop body, denoted $C_1$ and $C_2$. The unique exit node is $X$, and the unique entry node is $E$. The graph is reducible and has a single exit. The edges are as follows:\n- $E \\to G$.\n- $G \\xrightarrow{\\text{true}} S_1$, $G \\xrightarrow{\\text{false}} X$.\n- $S_1 \\to C_1$.\n- $C_1 \\xrightarrow{\\text{true}} S_2$, $C_1 \\xrightarrow{\\text{false}} S_3$.\n- $S_2 \\to K$, $K \\to G$.\n- $S_3 \\to C_2$.\n- $C_2 \\xrightarrow{\\text{true}} S_4$, $S_4 \\to R$, $R \\to X$.\n- $C_2 \\xrightarrow{\\text{false}} S_5$, $S_5 \\to S_6$, $S_6 \\to G$.\n\nAssume standard semantics: $continue$ transfers control directly to $G$ in the same loop iteration, and $break$ transfers control to $X$.\n\nStarting only from core definitions, use control dependence analysis to determine, for each of the three predicate nodes $G$, $C_1$, and $C_2$, which loop body statements are control-dependent on that predicate. Use the following foundational definitions.\n- A node $p$ postdominates a node $n$ if and only if every path from $n$ to the unique exit $X$ contains $p$.\n- The immediate postdominator $\\operatorname{idom}(n)$ of a node $n$ is the unique postdominator of $n$ that strictly postdominates $n$ and is closest to $n$ in the postdominator tree.\n- A node $Y$ is control-dependent on a node $X$ if and only if there exists a directed path from $X$ to $Y$ such that $Y$ postdominates every node on this path after $X$, and $Y$ does not postdominate $X$.\n\nCount only loop body statements among the set $\\{S_1, S_2, S_3, S_4, S_5, S_6, K, R\\}$; do not count $G$, $C_1$, or $C_2$ themselves. Report your final answer as the ordered triple of counts $(|CD(G)|, |CD(C_1)|, |CD(C_2)|)$, where $|CD(\\cdot)|$ denotes the number of loop body statements control-dependent on the given predicate. Express your final answer as a row matrix using the $\\operatorname{pmatrix}$ environment. No rounding is required, and no units are involved.", "solution": "The problem requires a control dependence analysis of a given Control Flow Graph (CFG). The analysis will be conducted by first establishing the postdominance relationships within the graph, constructing the postdominator tree, and then applying the formal definition of control dependence to the specified predicate nodes $G$, $C_1$, and $C_2$.\n\nFirst, we formalize the structure of the CFG. The set of nodes is $\\{E, G, S_1, C_1, S_2, K, S_3, C_2, S_4, R, S_5, S_6, X\\}$. The edges are given as:\n$E \\to G$\n$G \\to S_1$ (true branch)\n$G \\to X$ (false branch)\n$S_1 \\to C_1$\n$C_1 \\to S_2$ (true branch)\n$C_1 \\to S_3$ (false branch)\n$S_2 \\to K$\n$K \\to G$\n$S_3 \\to C_2$\n$C_2 \\to S_4$ (true branch)\n$C_2 \\to S_5$ (false branch)\n$S_4 \\to R$\n$R \\to X$\n$S_5 \\to S_6$\n$S_6 \\to G$\n\nThe core of the analysis relies on postdominance. A node $p$ postdominates a node $n$ if every path from $n$ to the unique exit node $X$ necessarily includes $p$. We denote the set of postdominators of $n$ as $\\operatorname{pdom}(n)$. By systematically analyzing all paths from each node to $X$, we determine these sets.\n\n- Paths from $R$ to $X$: The only path is $R \\to X$. Thus, $\\operatorname{pdom}(R) = \\{R, X\\}$.\n- Paths from $S_4$: The only path is $S_4 \\to R \\to X$. Thus, $\\operatorname{pdom}(S_4) = \\{S_4, R, X\\}$.\n- Paths from $S_6$: The only path is $S_6 \\to G \\to \\dots$. Any path from $G$ to $X$ can be taken. However, all paths from $S_6$ must first go through $G$. Therefore, $G$ postdominates $S_6$. $\\operatorname{pdom}(S_6) = \\{S_6, G, X\\}$.\n- Paths from $S_5$: The only path is $S_5 \\to S_6 \\to \\dots$. Thus, $S_6$ postdominates $S_5$. $\\operatorname{pdom}(S_5) = \\{S_5, S_6, G, X\\}$.\n- Paths from $K$: The only path is $K \\to G \\to \\dots$. Thus, $G$ postdominates $K$. $\\operatorname{pdom}(K) = \\{K, G, X\\}$.\n- Paths from $S_2$: The only path is $S_2 \\to K \\to \\dots$. Thus, $K$ postdominates $S_2$. $\\operatorname{pdom}(S_2) = \\{S_2, K, G, X\\}$.\n- Paths from $S_3$: The only path is $S_3 \\to C_2 \\to \\dots$. Thus, $C_2$ postdominates $S_3$. $\\operatorname{pdom}(S_3) = \\{S_3, C_2, X\\}$.\n- Paths from $S_1$: The only path is $S_1 \\to C_1 \\to \\dots$. Thus, $C_1$ postdominates $S_1$. $\\operatorname{pdom}(S_1) = \\{S_1, C_1, X\\}$.\n- Paths from $E$: The only path is $E \\to G \\to \\dots$. Thus, $G$ postdominates $E$. $\\operatorname{pdom}(E) = \\{E, G, X\\}$.\n- Paths from predicate nodes:\n  - From $G$: There is a direct path $G \\to X$ and paths through the loop body (e.g., $G \\to S_1 \\to C_1 \\to S_3 \\to C_2 \\to S_4 \\to R \\to X$). These paths have no common node except $G$ and $X$. Thus, $\\operatorname{pdom}(G) = \\{G, X\\}$.\n  - From $C_1$: The true branch leads to $S_2 \\to K \\to G$, and the false branch leads to $S_3 \\to C_2$. Paths from $G$ can exit directly at $X$. Paths from $C_2$ can exit via $R \\to X$. For example, the path $C_1 \\to S_2 \\to K \\to G \\to X$ and the path $C_1 \\to S_3 \\to C_2 \\to S_4 \\to R \\to X$ share no nodes other than $C_1$ and $X$. Thus, $\\operatorname{pdom}(C_1) = \\{C_1, X\\}$.\n  - From $C_2$: The true branch leads to $S_4 \\to R \\to X$, exiting the loop. The false branch leads to $S_5 \\to S_6 \\to G$, re-entering the loop structure. The paths $C_2 \\to S_4 \\to R \\to X$ and $C_2 \\to S_5 \\to S_6 \\to G \\to X$ share no nodes other than $C_2$ and $X$. Thus, $\\operatorname{pdom}(C_2) = \\{C_2, X\\}$.\n\nFrom the postdominator sets, we determine the immediate postdominator, $\\operatorname{idom}(n)$, for each node $n \\neq X$. This defines the postdominator tree, where the parent of a node $n$ is $\\operatorname{idom}(n)$.\n- $\\operatorname{idom}(E) = G$\n- $\\operatorname{idom}(G) = X$\n- $\\operatorname{idom}(S_1) = C_1$\n- $\\operatorname{idom}(C_1) = X$\n- $\\operatorname{idom}(S_2) = K$\n- $\\operatorname{idom}(K) = G$\n- $\\operatorname{idom}(S_3) = C_2$\n- $\\operatorname{idom}(C_2) = X$\n- $\\operatorname{idom}(S_4) = R$\n- $\\operatorname{idom}(R) = X$\n- $\\operatorname{idom}(S_5) = S_6$\n- $\\operatorname{idom}(S_6) = G$\n\nThe postdominator tree has root $X$ and the following parent-child relationships: $X$ is parent of $G, C_1, C_2, R$. $G$ is parent of $E, K, S_6$. $C_1$ is parent of $S_1$. $C_2$ is parent of $S_3$. $R$ is parent of $S_4$. $K$ is parent of $S_2$. $S_6$ is parent of $S_5$.\n\nNow we apply the definition of control dependence: A node $Y$ is control-dependent on a predicate $P$ if there exists a path from $P$ to $Y$ where $Y$ postdominates every node on the path after $P$, and $Y$ does not postdominate $P$.\nAn efficient method to find the set of nodes control-dependent on $P$, denoted $CD(P)$, is to consider each outbound edge $P \\to A$. The nodes on the postdominator tree path from $A$ up to, but not including, the least common ancestor $\\operatorname{lca}(P, A)$ in the tree are control-dependent on $P$.\n\n1.  Control Dependence on $G$:\n    - The predicate is $P=G$. It has two outgoing edges: $G \\to S_1$ and $G \\to X$.\n    - Edge $G \\to S_1$: $A=S_1$. In the postdominator tree, the path from $G$ to the root is $G \\to X$. The path from $S_1$ to the root is $S_1 \\to C_1 \\to X$. The least common ancestor is $\\operatorname{lca}(G, S_1) = X$. The nodes on the tree path from $S_1$ up to, but not including, $X$ are $\\{S_1, C_1\\}$.\n    - Edge $G \\to X$: $A=X$. $\\operatorname{lca}(G, X) = X$. The path from $X$ to $X$ is empty, yielding no dependencies.\n    - Thus, $CD(G) = \\{S_1, C_1\\}$. The set of loop body statements in $CD(G)$ is $\\{S_1, S_2, S_3, S_4, S_5, S_6, K, R\\} \\cap \\{S_1, C_1\\} = \\{S_1\\}$.\n    - The count is $|CD(G)| = 1$.\n\n2.  Control Dependence on $C_1$:\n    - The predicate is $P=C_1$. It has two outgoing edges: $C_1 \\to S_2$ and $C_1 \\to S_3$.\n    - Edge $C_1 \\to S_2$: $A=S_2$. The tree path from $C_1$ is $C_1 \\to X$. The tree path from $S_2$ is $S_2 \\to K \\to G \\to X$. $\\operatorname{lca}(C_1, S_2) = X$. The nodes on the tree path from $S_2$ up to $X$ are $\\{S_2, K, G\\}$.\n    - Edge $C_1 \\to S_3$: $A=S_3$. The tree path from $C_1$ is $C_1 \\to X$. The tree path from $S_3$ is $S_3 \\to C_2 \\to X$. $\\operatorname{lca}(C_1, S_3) = X$. The nodes on the tree path from $S_3$ up to $X$ are $\\{S_3, C_2\\}$.\n    - Combining these results, $CD(C_1) = \\{S_2, K, G\\} \\cup \\{S_3, C_2\\} = \\{S_2, S_3, K, G, C_2\\}$.\n    - The set of loop body statements in $CD(C_1)$ is $\\{S_1, \\dots, R\\} \\cap \\{S_2, S_3, K, G, C_2\\} = \\{S_2, S_3, K\\}$.\n    - The count is $|CD(C_1)| = 3$.\n\n3.  Control Dependence on $C_2$:\n    - The predicate is $P=C_2$. It has two outgoing edges: $C_2 \\to S_4$ and $C_2 \\to S_5$.\n    - Edge $C_2 \\to S_4$: $A=S_4$. The tree path from $C_2$ is $C_2 \\to X$. The tree path from $S_4$ is $S_4 \\to R \\to X$. $\\operatorname{lca}(C_2, S_4) = X$. The nodes on the tree path from $S_4$ up to $X$ are $\\{S_4, R\\}$.\n    - Edge $C_2 \\to S_5$: $A=S_5$. The tree path from $C_2$ is $C_2 \\to X$. The tree path from $S_5$ is $S_5 \\to S_6 \\to G \\to X$. $\\operatorname{lca}(C_2, S_5) = X$. The nodes on the tree path from $S_5$ up to $X$ are $\\{S_5, S_6, G\\}$.\n    - Combining these results, $CD(C_2) = \\{S_4, R\\} \\cup \\{S_5, S_6, G\\} = \\{S_4, S_5, S_6, R, G\\}$.\n    - The set of loop body statements in $CD(C_2)$ is $\\{S_1, \\dots, R\\} \\cap \\{S_4, S_5, S_6, R, G\\} = \\{S_4, S_5, S_6, R\\}$.\n    - The count is $|CD(C_2)| = 4$.\n\nThe ordered triple of counts $(|CD(G)|, |CD(C_1)|, |CD(C_2)|)$ is $(1, 3, 4)$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1  3  4\n\\end{pmatrix}\n}\n$$", "id": "3632566"}, {"introduction": "Multi-way branches, such as `switch` statements with fallthrough, introduce another layer of complexity to control flow. This final practice examines how control dependence captures these cascaded decisions. You will analyze a CFG that models a `switch` statement, distinguishing between dependencies on the main selector and dependencies arising from the decision to fall through from one case to the next, revealing how a single block can be governed by a chain of preceding choices [@problem_id:3632595].", "problem": "A compiler must reason about control dependence to place instructions safely during transformations. Consider the following abstract Control Flow Graph (CFG) for a multiway branch that models a programming language construct with fallthrough between cases. The CFG has an entry node and then a single selector node $S$ that implements a multiway dispatch to labels $L_{0}, L_{1}, L_{2}, L_{3}, L_{d}$. For each label $L_{i}$, there is an immediately following case-body basic block $X_{i}$; similarly $L_{d}$ is followed by the default case-body basic block $X_{d}$. After each case body, control proceeds as follows:\n- From $L_{0}$: $L_{0} \\rightarrow X_{0} \\rightarrow I_{0}$, where $I_{0}$ is a decision node with two successors: break target $B$ and fallthrough to $L_{1}$.\n- From $L_{1}$: $L_{1} \\rightarrow X_{1} \\rightarrow I_{1}$, where $I_{1}$ has two successors: break target $B$ and fallthrough to $L_{2}$.\n- From $L_{2}$: $L_{2} \\rightarrow X_{2} \\rightarrow I_{2}$, where $I_{2}$ has two successors: fallthrough to $L_{3}$ and break target $B$.\n- From $L_{3}$: $L_{3} \\rightarrow X_{3} \\rightarrow B$ (unconditional transfer to $B$).\n- From $L_{d}$: $L_{d} \\rightarrow X_{d} \\rightarrow B$ (unconditional transfer to $B$).\n\nThe break target $B$ then flows to a unique exit-of-switch node $Z$. There are no other edges besides those described. There is a single program exit reachable from $Z$, and all paths from $S$ eventually reach $Z$.\n\nUse the standard definitions: In a Control Flow Graph (CFG), a node $p$ postdominates a node $q$ if every path from $q$ to the exit passes through $p$. A node $Y$ is control dependent on a node $X$ if $Y$ postdominates at least one successor of $X$ but $Y$ does not postdominate $X$.\n\nDefine the sets:\n- $C_{S}$ as the set of all case-body basic blocks among $\\{X_{0}, X_{1}, X_{2}, X_{3}, X_{d}\\}$ that are control dependent on the selector node $S$.\n- $C_{F}$ as the set of all case-body basic blocks among $\\{X_{0}, X_{1}, X_{2}, X_{3}, X_{d}\\}$ that are control dependent on at least one prior fallthrough decision node $I_{j}$ coming from an earlier case label $L_{j}$ with $j  i$ (for $X_{i}$), i.e., a fallthrough originating from a lexically earlier case.\n\nCompute the value $N = |C_{S}| + |C_{F}|$. Provide the exact integer value of $N$. No rounding is required.", "solution": "The problem requires us to compute the value of $N = |C_{S}| + |C_{F}|$, where $C_{S}$ and $C_{F}$ are sets of case-body basic blocks that satisfy specific control dependence criteria in a given Control Flow Graph (CFG).\n\nFirst, we must establish the structure of the CFG and the relevant postdominance relationships. The CFG has a single entry, a selector node $S$, and a single exit path through nodes $B$ and $Z$. Let us denote the program's unique exit node as `Exit`. The structure implies that any path from any node described in the problem must eventually pass through $B$, then $Z$, to reach `Exit`.\n\nAccording to the provided definition, a node $p$ postdominates a node $q$ if every path from $q$ to `Exit` passes through $p$.\n\nThe definition of control dependence is also given: a node $Y$ is control dependent on a node $X$ if (1) $Y$ postdominates at least one successor of $X$, and (2) $Y$ does not postdominate $X$.\n\nWe will now compute the sets $C_S$ and $C_F$ by applying these definitions.\n\n**Calculation of $|C_{S}|$**\n\n$C_{S}$ is the set of basic blocks from $\\{X_{0}, X_{1}, X_{2}, X_{3}, X_{d}\\}$ that are control dependent on the selector node $S$. For each block $Y \\in \\{X_{0}, X_{1}, X_{2}, X_{3}, X_{d}\\}$, we check if it is control dependent on $X=S$.\n\nThe successors of $S$ are the label nodes $\\{L_{0}, L_{1}, L_{2}, L_{3}, L_{d}\\}$.\n\n1.  **Consider $Y = X_{0}$:**\n    -   Does $X_{0}$ postdominate at least one successor of $S$?\n        The only edge from $L_{0}$ is $L_{0} \\rightarrow X_{0}$. Therefore, every path from $L_{0}$ must pass through $X_{0}$. So, $X_{0}$ postdominates $L_{0}$. This satisfies the first condition.\n    -   Does $X_{0}$ postdominate $S$?\n        No. There is a path from $S$ to `Exit` that bypasses $X_{0}$, for example, $S \\rightarrow L_{1} \\rightarrow X_{1} \\rightarrow \\dots \\rightarrow B \\rightarrow Z \\rightarrow \\text{Exit}$. Thus, $X_{0}$ does not postdominate $S$. This satisfies the second condition.\n    -   Conclusion: $X_{0}$ is control dependent on $S$. So, $X_{0} \\in C_{S}$.\n\n2.  **Consider $Y = X_{1}$:**\n    -   Does $X_{1}$ postdominate at least one successor of $S$?\n        Yes. Every path from $L_{1}$ must pass through $X_{1}$ because of the edge $L_{1} \\rightarrow X_{1}$. So, $X_{1}$ postdominates $L_{1}$.\n    -   Does $X_{1}$ postdominate $S$?\n        No. The path $S \\rightarrow L_{0} \\rightarrow \\dots$ bypasses $X_{1}$.\n    -   Conclusion: $X_{1}$ is control dependent on $S$. So, $X_{1} \\in C_{S}$.\n\nBy identical reasoning, each case-body block $X_{i}$ (and $X_{d}$) is entered only from its corresponding label $L_{i}$ (or $L_{d}$), which is a successor of $S$.\n-   For $X_{2}$: $X_{2}$ postdominates $L_{2}$ but not $S$. So, $X_{2} \\in C_{S}$.\n-   For $X_{3}$: $X_{3}$ postdominates $L_{3}$ but not $S$. So, $X_{3} \\in C_{S}$.\n-   For $X_{d}$: $X_{d}$ postdominates $L_{d}$ but not $S$. So, $X_{d} \\in C_{S}$.\n\nTherefore, the set $C_{S}$ contains all five case-body blocks:\n$C_{S} = \\{X_{0}, X_{1}, X_{2}, X_{3}, X_{d}\\}$.\nThe cardinality is $|C_{S}| = 5$.\n\n**Calculation of $|C_{F}|$**\n\n$C_{F}$ is the set of all case-body basic blocks $X_{i}$ that are control dependent on at least one prior fallthrough decision node $I_{j}$ with $j  i$. The decision nodes are $I_{0}$, $I_{1}$, and $I_{2}$.\n\n1.  **Consider $X_{0}$:** There is no decision node $I_{j}$ with $j  0$. So, $X_{0} \\notin C_{F}$.\n\n2.  **Consider $X_{1}$:** We check for dependence on $I_{j}$ where $j  1$, which is only $I_{0}$.\n    -   Let $Y=X_{1}$ and $X=I_{0}$. The successors of $I_{0}$ are $B$ and $L_{1}$.\n    -   Does $X_{1}$ postdominate at least one successor of $I_{0}$?\n        Yes. Every path from $L_{1}$ must go through $X_{1}$. So, $X_{1}$ postdominates $L_{1}$.\n    -   Does $X_{1}$ postdominate $I_{0}$?\n        No. The path $I_{0} \\rightarrow B \\rightarrow Z \\rightarrow \\text{Exit}$ bypasses $X_{1}$.\n    -   Conclusion: $X_{1}$ is control dependent on $I_{0}$. So, $X_{1} \\in C_{F}$.\n\n3.  **Consider $X_{2}$:** We check for dependence on $I_{j}$ with $j  2$, i.e., $I_{0}$ and $I_{1}$.\n    -   Dependence on $I_{0}$: Let $Y=X_{2}$ and $X=I_{0}$. Successors of $I_{0}$ are $B$ and $L_{1}$. Does $X_{2}$ postdominate $L_{1}$? No. The path $L_{1} \\rightarrow X_{1} \\rightarrow I_{1} \\rightarrow B \\rightarrow Z \\rightarrow \\text{Exit}$ does not pass through $X_{2}$. Thus, $X_{2}$ is not control dependent on $I_{0}$.\n    -   Dependence on $I_{1}$: Let $Y=X_{2}$ and $X=I_{1}$. Successors of $I_{1}$ are $B$ and $L_{2}$.\n        -   Does $X_{2}$ postdominate at least one successor of $I_{1}$? Yes. Every path from $L_{2}$ is of the form $L_{2} \\rightarrow X_{2} \\rightarrow \\dots$. Thus, $X_{2}$ postdominates $L_{2}$.\n        -   Does $X_{2}$ postdominate $I_{1}$? No. The path $I_{1} \\rightarrow B \\rightarrow Z \\rightarrow \\text{Exit}$ bypasses $X_{2}$.\n    -   Conclusion: $X_{2}$ is control dependent on $I_{1}$. Since the condition is dependence on *at least one* prior node, $X_{2} \\in C_{F}$.\n\n4.  **Consider $X_{3}$:** We check for dependence on $I_{j}$ with $j  3$, i.e., $I_{0}$, $I_{1}$, and $I_{2}$.\n    -   Dependence on $I_{0}$: Let $Y=X_{3}, X=I_{0}$. Does $X_{3}$ postdominate $L_{1}$? No. A path from $L_{1}$ can go to $B$ via $I_{1}$, bypassing $X_{3}$. So not dependent on $I_{0}$.\n    -   Dependence on $I_{1}$: Let $Y=X_{3}, X=I_{1}$. Does $X_{3}$ postdominate $L_{2}$? No. The path $L_{2} \\rightarrow X_{2} \\rightarrow I_{2} \\rightarrow B \\rightarrow \\dots$ bypasses $X_{3}$. So not dependent on $I_{1}$.\n    -   Dependence on $I_{2}$: Let $Y=X_{3}, X=I_{2}$. Successors of $I_{2}$ are $L_{3}$ and $B$.\n        -   Does $X_{3}$ postdominate at least one successor of $I_{2}$? Yes. Every path from $L_{3}$ is $L_{3} \\rightarrow X_{3} \\rightarrow \\dots$. Thus, $X_{3}$ postdominates $L_{3}$.\n        -   Does $X_{3}$ postdominate $I_{2}$? No. The path $I_{2} \\rightarrow B \\rightarrow Z \\rightarrow \\text{Exit}$ bypasses $X_{3}$.\n    -   Conclusion: $X_{3}$ is control dependent on $I_{2}$. So, $X_{3} \\in C_{F}$.\n\n5.  **Consider $X_{d}$:** The problem defines $C_{F}$ for blocks $X_{i}$ with index $i$. The block $X_{d}$ does not have a numerical index that fits the $j  i$ pattern, and there are no fallthrough decision nodes prior to it in the lexical sense intended by the problem. Thus, $X_{d} \\notin C_{F}$.\n\nIn summary, the set $C_{F}$ is composed of the blocks whose execution is determined by a decision to fall through from a prior case.\n$C_{F} = \\{X_{1}, X_{2}, X_{3}\\}$.\nThe cardinality is $|C_{F}| = 3$.\n\n**Final Calculation**\n\nThe problem asks for $N = |C_{S}| + |C_{F}|$.\n$|C_{S}| = 5$\n$|C_{F}| = 3$\n$N = 5 + 3 = 8$.", "answer": "$$ \\boxed{8} $$", "id": "3632595"}]}